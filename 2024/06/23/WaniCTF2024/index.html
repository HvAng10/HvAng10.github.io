<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>WaniCTF2024 | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="周末了，复习小小暂停一下下，耍一哈CTF() 复习周摸摸鱼，跟虾饺皇的大佬们一起打，拿点贡献度()，下面某些题会存在一些参考成分，有点久没打了，思路有点卡壳了 难一点的GoogleCTF一进去，发现要谷歌账号，直接就下班了 发现比赛平台还开着，比赛地址 https:&#x2F;&#x2F;score.wanictf.org&#x2F;#&#x2F;challenge 按难度划分，应该是新生赛(官方标的，还是有一定难度的，可能这就是国外的">
<meta property="og:type" content="article">
<meta property="og:title" content="WaniCTF2024">
<meta property="og:url" content="https://hvang10.github.io/2024/06/23/WaniCTF2024/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="周末了，复习小小暂停一下下，耍一哈CTF() 复习周摸摸鱼，跟虾饺皇的大佬们一起打，拿点贡献度()，下面某些题会存在一些参考成分，有点久没打了，思路有点卡壳了 难一点的GoogleCTF一进去，发现要谷歌账号，直接就下班了 发现比赛平台还开着，比赛地址 https:&#x2F;&#x2F;score.wanictf.org&#x2F;#&#x2F;challenge 按难度划分，应该是新生赛(官方标的，还是有一定难度的，可能这就是国外的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2024-06-23T12:00:00.000Z">
<meta property="article:modified_time" content="2024-09-22T18:42:56.968Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2024/06/23/WaniCTF2024/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'WaniCTF2024',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-23 02:42:56'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">WaniCTF2024</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-06-23T12:00:00.000Z" title="Created 2024-06-23 20:00:00">2024-06-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-09-22T18:42:56.968Z" title="Updated 2024-09-23 02:42:56">2024-09-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">3.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>17mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="WaniCTF2024"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>周末了，复习小小暂停一下下，耍一哈CTF()</p>
<p>复习周摸摸鱼，跟虾饺皇的大佬们一起打，拿点贡献度()，下面某些题会存在一些参考成分，有点久没打了，思路有点卡壳了</p>
<p>难一点的GoogleCTF一进去，发现要谷歌账号，直接就下班了</p>
<p>发现比赛平台还开着，比赛地址<br />
<a target="_blank" rel="noopener" href="https://score.wanictf.org/#/challenge">https://score.wanictf.org/#/challenge</a></p>
<p>按难度划分，应该是新生赛(官方标的，还是有一定难度的，可能这就是国外的比赛吧)，有兴趣可以去看看</p>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="beginners_rsa"><a class="markdownIt-Anchor" href="#beginners_rsa"></a> beginners_rsa</h2>
<p>直接分解n</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">317903423385943473062528814030345176720578295695512495346444822768171649361480819163749494400347</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">enc = <span class="number">127075137729897107295787718796341877071536678034322988535029776806418266591167534816788125330265</span></span><br><span class="line">p = [<span class="number">9953162929836910171</span>, <span class="number">11771834931016130837</span>,</span><br><span class="line">     <span class="number">12109985960354612149</span>, <span class="number">13079524394617385153</span>, <span class="number">17129880600534041513</span>]</span><br><span class="line">phi = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> p:</span><br><span class="line">    phi *= i-<span class="number">1</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(enc, d, n)))</span><br></pre></td></tr></table></figure>
<h2 id="beginners_aes"><a class="markdownIt-Anchor" href="#beginners_aes"></a> beginners_aes</h2>
<p>爆破一下<code>key</code>和<code>iv</code>的一位，再校验flag</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line">enc = <span class="string">b&#x27;\x16\x97,\xa7\xfb_\xf3\x15.\x87jKRaF&amp;&quot;\xb6\xc4x\xf4.K\xd77j\xe5MLI_y\xd96\xf1$\xc5\xa3\x03\x990Q^\xc0\x17M2\x18&#x27;</span></span><br><span class="line">flag_hash = <span class="number">0x6a96111d69e015a07e96dcd141d31e7fc81c4420dbbef75aef5201809093210e</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    key = <span class="string">b&#x27;the_enc_key_is_&#x27;</span></span><br><span class="line">    iv = <span class="string">b&#x27;my_great_iv_is_&#x27;</span></span><br><span class="line">    key += urandom(<span class="number">1</span>)</span><br><span class="line">    iv += urandom(<span class="number">1</span>)</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    flag = cipher.decrypt(enc)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;FLAG&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        flag = <span class="string">b&#x27;FLAG&#123;7h3_f1r57_5t3p_t0_Crypt0!!&#125;&#x27;</span></span><br><span class="line">        <span class="comment"># 根据hash值校验，猜测是s/S/5</span></span><br><span class="line">        <span class="built_in">print</span>(sha256(flag).hexdigest())</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h2 id="replacement"><a class="markdownIt-Anchor" href="#replacement"></a> replacement</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line">enc = [...]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> enc:</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> printable:</span><br><span class="line">        p = <span class="built_in">ord</span>(p)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(md5(<span class="built_in">str</span>(p).encode()).hexdigest(), <span class="number">16</span>) == h:</span><br><span class="line">            flag += <span class="built_in">chr</span>(p)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="easy-calc"><a class="markdownIt-Anchor" href="#easy-calc"></a> Easy calc</h2>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, getPrime</span><br><span class="line">FLAG = os.getenvb(<span class="string">b&quot;FLAG&quot;</span>, <span class="string">b&quot;FAKE&#123;THIS_IS_NOT_THE_FLAG!!!!!!&#125;&quot;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m: <span class="built_in">bytes</span>, key: <span class="built_in">int</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)</span><br><span class="line">    key = long_to_bytes(key)</span><br><span class="line">    key = md5(key).digest()</span><br><span class="line">    cipher = AES.new(key, AES.MODE_CBC, iv=iv)</span><br><span class="line">    <span class="keyword">return</span> iv + cipher.encrypt(m)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">s, p</span>):</span><br><span class="line">    u = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(p):</span><br><span class="line">        u += p - i</span><br><span class="line">        u *= s</span><br><span class="line">        u %= p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> u</span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">s = random.randint(<span class="number">1</span>, p - <span class="number">1</span>)</span><br><span class="line">A = f(s, p)</span><br><span class="line">ciphertext = encrypt(FLAG, s).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;p = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;A = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;ciphertext = &#125;</span>&quot;</span>)</span><br><span class="line">p = <span class="number">108159532265181242371960862176089900437183046655107822712736597793129430067645352619047923366465213553080964155205008757015024406041606723580700542617009651237415277095236385696694741342539811786180063943404300498027896890240121098409649537982185247548732754713793214557909539077228488668731016501718242238229</span></span><br><span class="line">A = <span class="number">60804426023059829529243916100868813693528686280274100232668009387292986893221484159514697867975996653561494260686110180269479231384753818873838897508257692444056934156009244570713404772622837916262561177765724587140931364577707149626116683828625211736898598854127868638686640564102372517526588283709560663960</span></span><br><span class="line">ciphertext = <span class="string">&#x27;9fb749ef7467a5aff04ec5c751e7dceca4f3386987f252a2fc14a8970ff097a81fcb1a8fbe173465eecb74fb1a843383&#x27;</span></span><br></pre></td></tr></table></figure>
<p>先求s，推导过程中，仿佛梦回高中数列()<br />
一开始把式子展开了，将式子分成了两部分，导致处理起来不是我想要的过程，就像你在高考考场上做数列一样，明明很简单，为什么卡住了呢<br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>为方便书写，以下操作均在</mtext><msubsup><mi>Z</mi><mi>p</mi><mo lspace="0em" rspace="0em">∗</mo></msubsup><mtext>中进行</mtext></mrow><annotation encoding="application/x-tex">为方便书写，以下操作均在Z_{p}^{*}中进行</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.071804em;vertical-align:-0.383108em;"></span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">便</span><span class="mord cjk_fallback">书</span><span class="mord cjk_fallback">写</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">操</span><span class="mord cjk_fallback">作</span><span class="mord cjk_fallback">均</span><span class="mord cjk_fallback">在</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-2.4530000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∗</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mi>p</mi><mo>∗</mo><msup><mi>s</mi><mi>p</mi></msup><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>∗</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>−</mo><mn>2</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mn>3</mn><mo>∗</mo><msup><mi>s</mi><mn>3</mn></msup><mo>+</mo><mn>2</mn><mo>∗</mo><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><mi>s</mi></mrow><annotation encoding="application/x-tex">A=p*s^{p}+(p-1)*s^{p-1}+(p-2)*s^{p-2}+...+3*s^{3}+2*s^{2}+s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>A</mi><mo>=</mo><mi>p</mi><mo>∗</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><msup><mi>s</mi><mi>p</mi></msup><mo>+</mo><mo stretchy="false">(</mo><mi>p</mi><mo>−</mo><mn>2</mn><mo stretchy="false">)</mo><mo>∗</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mn>3</mn><mo>∗</mo><msup><mi>s</mi><mn>4</mn></msup><mo>+</mo><mn>2</mn><mo>∗</mo><msup><mi>s</mi><mn>3</mn></msup><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">sA=p*s^{p+1}+(p-1)*s^{p}+(p-2)*s^{p-1}+...+3*s^{4}+2*s^{3}+s^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>−</mo><mi>s</mi><mi>A</mi><mo>=</mo><mo>−</mo><mi>p</mi><mo>∗</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>+</mo><msup><mi>s</mi><mi>p</mi></msup><mo>+</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><mi>s</mi><mo>=</mo><msup><mi>s</mi><mi>p</mi></msup><mo>+</mo><msup><mi>s</mi><mrow><mi>p</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msup><mi>s</mi><mn>2</mn></msup><mo>+</mo><mi>s</mi><mo>=</mo><mi>s</mi><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>s</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A-sA=-p*s^{p+1}+s^{p}+s^{p-1}+...+s^{2}+s=s^{p}+s^{p-1}+...+s^{2}+s=s*(1-s^{p})/(1-s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord">−</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord">/</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>s</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>=</mo><mi>s</mi><mo>∗</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><msup><mi>s</mi><mi>p</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mo>−</mo><msup><mi>s</mi><mn>2</mn></msup><mtext>，费马小定理</mtext></mrow><annotation encoding="application/x-tex">A(1-s)^{2}=s*(1-s^{p})=s-s^{2}，费马小定理</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">费</span><span class="mord cjk_fallback">马</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">理</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><msup><mi>s</mi><mn>2</mn></msup><mo>−</mo><mo stretchy="false">(</mo><mn>2</mn><mi>A</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mi>s</mi><mo>+</mo><mi>A</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(A+1)*s^{2}-(2A+1)*s+A=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>肉眼可见</mtext><mi>s</mi><mo>=</mo><mn>1</mn><mtext>是一个解，由韦达定理可得，</mtext><mn>1</mn><mo>∗</mo><mi>s</mi><mo>=</mo><mi>A</mi><mo>∗</mo><mo stretchy="false">(</mo><mi>A</mi><mo>+</mo><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">肉眼可见s=1是一个解，由韦达定理可得，1*s=A*(A+1)^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">肉</span><span class="mord cjk_fallback">眼</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">见</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">韦</span><span class="mord cjk_fallback">达</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">理</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">，</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><code>return iv + cipher.encrypt(m)</code>，注意这段代码，需要把<code>iv</code>和<code>ciphertext</code>给分离出来</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">p = <span class="number">108159532265181242371960862176089900437183046655107822712736597793129430067645352619047923366465213553080964155205008757015024406041606723580700542617009651237415277095236385696694741342539811786180063943404300498027896890240121098409649537982185247548732754713793214557909539077228488668731016501718242238229</span></span><br><span class="line">A = <span class="number">60804426023059829529243916100868813693528686280274100232668009387292986893221484159514697867975996653561494260686110180269479231384753818873838897508257692444056934156009244570713404772622837916262561177765724587140931364577707149626116683828625211736898598854127868638686640564102372517526588283709560663960</span></span><br><span class="line">iv_cip = long_to_bytes(</span><br><span class="line">    <span class="number">0x9fb749ef7467a5aff04ec5c751e7dceca4f3386987f252a2fc14a8970ff097a81fcb1a8fbe173465eecb74fb1a843383</span>)</span><br><span class="line">ciphertext = iv_cip[<span class="number">16</span>:]</span><br><span class="line">iv = iv_cip[:<span class="number">16</span>]</span><br><span class="line">s = inverse(A+<span class="number">1</span>, p)*A % p</span><br><span class="line">key = long_to_bytes(s)</span><br><span class="line">key = md5(key).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv=iv)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(ciphertext))</span><br></pre></td></tr></table></figure>
<h2 id="speedy"><a class="markdownIt-Anchor" href="#speedy"></a> speedy()</h2>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotl</span>(<span class="params">x, y</span>):</span><br><span class="line">    x &amp;= <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line">    <span class="keyword">return</span> ((x &lt;&lt; y) | (x &gt;&gt; (<span class="number">64</span> - y))) &amp; <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyCipher</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, s0, s1</span>):</span><br><span class="line">        self.X = s0</span><br><span class="line">        self.Y = s1</span><br><span class="line">        self.mod = <span class="number">0xFFFFFFFFFFFFFFFF</span></span><br><span class="line">        self.BLOCK_SIZE = <span class="number">8</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_key_stream</span>(<span class="params">self</span>):</span><br><span class="line">        s0 = self.X</span><br><span class="line">        s1 = self.Y</span><br><span class="line">        <span class="built_in">sum</span> = (s0 + s1) &amp; self.mod</span><br><span class="line">        s1 ^= s0</span><br><span class="line">        key = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            key.append(<span class="built_in">sum</span> &amp; <span class="number">0xFF</span>)</span><br><span class="line">            <span class="built_in">sum</span> &gt;&gt;= <span class="number">8</span></span><br><span class="line"></span><br><span class="line">        self.X = (rotl(s0, <span class="number">24</span>) ^ s1 ^ (s1 &lt;&lt; <span class="number">16</span>)) &amp; self.mod</span><br><span class="line">        self.Y = rotl(s1, <span class="number">37</span>) &amp; self.mod</span><br><span class="line">        <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, pt: <span class="built_in">bytes</span></span>):</span><br><span class="line">        ct = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), self.BLOCK_SIZE):</span><br><span class="line">            ct += long_to_bytes(self.X)</span><br><span class="line">            key = self.get_key_stream()</span><br><span class="line">            block = pt[i:i+self.BLOCK_SIZE]</span><br><span class="line">            ct += <span class="built_in">bytes</span>([block[j] ^ key[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(block))])</span><br><span class="line">        <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s0 = bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line">s1 = bytes_to_long(os.urandom(<span class="number">8</span>))</span><br><span class="line"></span><br><span class="line">cipher = MyCipher(s0, s1)</span><br><span class="line">secret = <span class="string">b&#x27;FLAG&#123;&#x27;</span>+<span class="string">b&#x27;*&#x27;</span>*<span class="number">19</span>+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line">pt = pad(secret, <span class="number">8</span>)</span><br><span class="line">ct = cipher.encrypt(pt)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ct = <span class="subst">&#123;ct&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ct = <span class="string">b&#x27;&quot;G:F\xfe\x8f\xb0&lt;O\xc0\x91\xc8\xa6\x96\xc5\xf7N\xc7n\xaf8\x1c,\xcb\xebY&lt;z\xd7\xd8\xc0-\x08\x8d\xe9\x9e\xd8\xa51\xa8\xfbp\x8f\xd4\x13\xf5m\x8f\x02\xa3\xa9\x9e\xb7\xbb\xaf\xbd\xb9\xdf&amp;Y3\xf3\x80\xb8&#x27;</span></span><br></pre></td></tr></table></figure>
<p>是个流密码，一堆异或，但没怎么搞懂加密的逻辑(想反推)，有空再细细钻研一下吧</p>
<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1>
<h2 id="bad_worker"><a class="markdownIt-Anchor" href="#bad_worker"></a> Bad_Worker</h2>
<p>题目里的谷歌浏览器算不算一个提示呢<br />
查看页面源代码，有个要输出<code>FLAG.txt</code>的js文件，但是火狐这边没找到源代码捏，直接切换谷歌浏览器，把输出的<code>FLAG.txt</code>文件替换上去，保存，再点击按钮获取flag<br />
<img src="https://picx.zhimg.com/80/v2-7aa6f5cd1d47ee75bf50be6c2363c07d_1440w.png" alt="" /></p>
<h2 id="pow"><a class="markdownIt-Anchor" href="#pow"></a> pow</h2>
<p><strong>Proof of Work</strong>，看js代码好像是SHA-256的比较(?)</p>
<p>页面数字在不断增大，然后抓包，查看<code>Http History</code>，发现有令<code>progress</code>增加的字符数组，应该是符合条件了，如<code>['2862152']</code>和<code>['7844289']</code>等，抓包发送的话，手动连续发相同的包，一开始确实<code>progress</code>在增加，说明重复也是OK的，但后面发现不能这样做，会出现<code>rate limit exceeded</code>，应该是存在发包数量限制，短时间内发10个这样倒是没什么问题，总共要100万，这样一个数组都要10万了，手动生成是不可能的，可以借助一下控制台生成</p>
<p>从我们截获的包也知道，得发送字符串数组</p>
<p>可以在控制台验证一下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title function_">send</span>(<span class="number">2862152</span>);</span><br></pre></td></tr></table></figure>
<p>发现确实是要字符数组<br />
<img src="https://picx.zhimg.com/80/v2-ae2d04a34b4297a6d728e9cfb629819d_1440w.png" alt="" /></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> v=[<span class="string">&#x27;2862152&#x27;</span>,<span class="string">&#x27;7844289&#x27;</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">50000</span>;i++)&#123;</span><br><span class="line">    v.<span class="title function_">push</span>(<span class="string">&#x27;2862152&#x27;</span>);</span><br><span class="line">    v.<span class="title function_">push</span>(<span class="string">&#x27;7844289&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">    <span class="title function_">send</span>(v);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://pic1.zhimg.com/80/v2-500672c196a7c3b9e92a70b6013dbf71_1440w.png" alt="" /><br />
后面想了想，感觉也可以Python发包啊，但好像只是一个前端校验……<br />
<img src="https://picx.zhimg.com/80/v2-7455e348d4dc6ab2f2d46e084cc5798f_1440w.png" alt="" /></p>
<h2 id="one-day-one-letter"><a class="markdownIt-Anchor" href="#one-day-one-letter"></a> One Day One Letter</h2>
<p>题目里面翻到的js代码</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> contentserver = <span class="string">&#x27;web-one-day-one-letter-content-lz56g6.wanictf.org&#x27;</span></span><br><span class="line"><span class="keyword">const</span> timeserver = <span class="string">&#x27;web-one-day-one-letter-time-lz56g6.wanictf.org&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;https://&#x27;</span> + timeserver);</span><br><span class="line">        xhr.<span class="title function_">send</span>();</span><br><span class="line">        xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getContent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getTime</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">(<span class="params">time_info</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">            xhr.<span class="title function_">open</span>(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;https://&#x27;</span> + contentserver);</span><br><span class="line">            xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>)</span><br><span class="line">            <span class="keyword">const</span> body = &#123;</span><br><span class="line">                timestamp : time_info[<span class="string">&#x27;timestamp&#x27;</span>],</span><br><span class="line">                signature : time_info[<span class="string">&#x27;signature&#x27;</span>],</span><br><span class="line">                timeserver : timeserver</span><br><span class="line">            &#125;;</span><br><span class="line">            xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(body));</span><br><span class="line">            xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                    <span class="title function_">resolve</span>(xhr.<span class="property">response</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initialize</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">getContent</span>()</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">content</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;content&#x27;</span>).<span class="property">innerHTML</span> = content;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">initialize</span>();</span><br></pre></td></tr></table></figure>
<p><code>FLAG&#123;l???????????&#125;</code>，一天解锁一个flag位<br />
看上去是时间伪造，获取的是<code>timeserver</code>的时间，因为<code>timeserver</code>可控，所以可以构造恶意的<code>timeserver</code>来伪造我们想要的<code>timestamp</code></p>
<p>附件里面给了<code>timeserver</code>的配置文件，但得自己配一个证书，可能还需要一个域名(大佬文档里写的)，然后利用题目里面的js代码，请求<code>content-server</code>，大概过程就是这样的</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> http <span class="keyword">import</span> HTTPStatus</span><br><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> BaseHTTPRequestHandler, HTTPServer</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> Crypto.Hash <span class="keyword">import</span> SHA256</span><br><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> ECC</span><br><span class="line"><span class="keyword">from</span> Crypto.Signature <span class="keyword">import</span> DSS</span><br><span class="line"></span><br><span class="line">key = ECC.generate(curve=<span class="string">&#x27;p256&#x27;</span>)</span><br><span class="line">pubkey = key.public_key().export_key(<span class="built_in">format</span>=<span class="string">&#x27;PEM&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">HTTPRequestHandler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.path == <span class="string">&#x27;/pubkey&#x27;</span>:</span><br><span class="line">            self.send_response(HTTPStatus.OK)</span><br><span class="line">            self.send_header(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/plain; charset=utf-8&#x27;</span>)</span><br><span class="line">            self.send_header(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">            self.end_headers()</span><br><span class="line">            res_body = pubkey</span><br><span class="line">            self.wfile.write(res_body.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">            self.requestline</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            second=<span class="built_in">int</span>(time.time())%<span class="number">60</span> <span class="comment"># 1秒刷新一天</span></span><br><span class="line">            timestamp = <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            h = SHA256.new(timestamp)</span><br><span class="line">            signer = DSS.new(key, <span class="string">&#x27;fips-186-3&#x27;</span>)</span><br><span class="line">            signature = signer.sign(h)</span><br><span class="line">            self.send_response(HTTPStatus.OK)</span><br><span class="line">            self.send_header(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;text/json; charset=utf-8&#x27;</span>)</span><br><span class="line">            self.send_header(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">            self.end_headers()</span><br><span class="line">            res_body = json.dumps(&#123;<span class="string">&#x27;timestamp&#x27;</span> : timestamp.decode(<span class="string">&#x27;utf-8&#x27;</span>), <span class="string">&#x27;signature&#x27;</span>: signature.<span class="built_in">hex</span>()&#125;)</span><br><span class="line">            self.wfile.write(res_body.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line">andler = HTTPRequestHandler</span><br><span class="line">ttpd = HTTPServer((<span class="string">&#x27;&#x27;</span>, <span class="number">5001</span>), andler)</span><br><span class="line">ttpd.socket = ssl.wrap_socket(httpd.socket,certfile=<span class="string">&#x27;cert.pem&#x27;</span>,keyfile=<span class="string">&#x27;key.pem&#x27;</span>,server_side=<span class="literal">True</span>)</span><br><span class="line">ttpd.serve_forever()</span><br></pre></td></tr></table></figure>
<p>大佬写的包括证书配置的脚步<br />
一开始思路还算是比较清晰的，但要到配置那里就难搞了，没碰过这东西</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">        xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;https://&#x27;</span> + <span class="string">&#x27;server.com&#x27;</span>);</span><br><span class="line">        xhr.<span class="title function_">send</span>();</span><br><span class="line">        xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                <span class="title function_">resolve</span>(<span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">response</span>))</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getContent</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">getTime</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function">(<span class="params">time_info</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">            xhr.<span class="title function_">open</span>(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;https://&#x27;</span> + contentserver);</span><br><span class="line">            xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>)</span><br><span class="line">            <span class="keyword">const</span> body = &#123;</span><br><span class="line">                timestamp : time_info[<span class="string">&#x27;timestamp&#x27;</span>],</span><br><span class="line">                signature : time_info[<span class="string">&#x27;signature&#x27;</span>],</span><br><span class="line">                timeserver : <span class="string">&#x27;server.com&#x27;</span></span><br><span class="line">            &#125;;</span><br><span class="line">            xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(body));</span><br><span class="line">            xhr.<span class="property">onload</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">if</span>(xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">                    <span class="title function_">resolve</span>(xhr.<span class="property">response</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">initialize</span>(); <span class="comment">//调用12次</span></span><br></pre></td></tr></table></figure>
<h2 id="noscript"><a class="markdownIt-Anchor" href="#noscript"></a> Noscript()</h2>
<p>这个给了附件，应该可以本地起docker，但好像没什么思路……<br />
附件留着，看后面有没有机会跟师傅们的脚步复现一下或者到时再重新做一遍</p>
<h1 id="forensics"><a class="markdownIt-Anchor" href="#forensics"></a> Forensics</h1>
<h2 id="tiny_usb"><a class="markdownIt-Anchor" href="#tiny_usb"></a> tiny_usb</h2>
<p>7zip打开，就直接逃课了<br />
果然7zip是个好东西，一直点就行</p>
<h2 id="codebreaker"><a class="markdownIt-Anchor" href="#codebreaker"></a> codebreaker</h2>
<p>在线二维码工具<br />
<a target="_blank" rel="noopener" href="https://merri.cx/qrazybox/">https://merri.cx/qrazybox/</a><br />
<img src="https://picx.zhimg.com/80/v2-20ef50f23b3e468167d3c8c383f06f0b_1440w.png" alt="" /><br />
定位符需要自己设定一下，然后把能看到的用黑色填充，被污染的用透明(?)填充，最后直接使用工具<strong>Reed-Solomon Decoder</strong>进行decode<br />
<img src="https://picx.zhimg.com/80/v2-5687ef8847fc23683c73b3ab45c48f58_1440w.png" alt="" /><br />
啊，这也算取证吗？</p>
<h2 id="surveillance_of_sus"><a class="markdownIt-Anchor" href="#surveillance_of_sus"></a> Surveillance_of_sus</h2>
<p>下载<code>bmc-tools</code><br />
<a target="_blank" rel="noopener" href="https://github.com/ANSSI-FR/bmc-tools">https://github.com/ANSSI-FR/bmc-tools</a><br />
我下在了<code>kali</code>上面了，还得新建<code>cache</code>文件夹</p>
<p><code>bin</code>格式的<code>RDP Bitmap Chache</code>解析<br />
<code>python3 bmc-tools.py -s Cache_chal.bin -d cache</code></p>
<p>这题算良心，虽然650张图片，但是有效的<code>flag</code>图片都集中在一起了，而且比较容易看出来，然后再稍微猜测一下就可以出了<br />
<img src="https://picx.zhimg.com/80/v2-1dd888eaf1b64a837b810e51d2a27f2c_1440w.png" alt="" /><br />
<code>FLAG&#123;RDP_is_useful_yipeee&#125;</code></p>
<p>看这<code>flag</code>有<code>RDP</code>，后面一翻<br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/liu_si_yan/article/details/129951463">https://blog.csdn.net/liu_si_yan/article/details/129951463</a><br />
<strong>一种RDP缓存文件（*.bmc）取证分析方法</strong>，这里是<code>bin格式</code><br />
<strong>RdpCacheStitcher下载</strong><br />
<a target="_blank" rel="noopener" href="https://github.com/BSI-Bund/RdpCacheStitcher">https://github.com/BSI-Bund/RdpCacheStitcher</a><br />
最后成果<br />
<img src="https://picx.zhimg.com/80/v2-7ad4faf5353f29c62288d672b7ff92f3_1440w.png" alt="" /></p>
<h2 id="i_wanna_be_a_streamer"><a class="markdownIt-Anchor" href="#i_wanna_be_a_streamer"></a> I_wanna_be_a_streamer</h2>
<p><code>H264</code>流量提取，很多博客都有讲，<code>payload</code>设为96<br />
安装插件<a target="_blank" rel="noopener" href="https://github.com/hongch911/WiresharkPlugin">https://github.com/hongch911/WiresharkPlugin</a><br />
<img src="https://pica.zhimg.com/80/v2-37bbbdae2f90d8e448c31d58fb149075_1440w.png" alt="" /><br />
嘶，导出来的视频放不了，奇怪了<br />
然后下载了<code>VLC</code>进行转换，还是不行，过程应该是正确了的</p>
<h2 id="tiny_10px"><a class="markdownIt-Anchor" href="#tiny_10px"></a> tiny_10px</h2>
<p>分辨率<code>10*10</code>，也才<code>100bits</code>，图片大小<code>44kb</code>，我们知道<code>1kb=1024bits</code>，说明肯定藏东西了，<code>binwalk</code>没分离出东西，拖入虚拟机也正常(把<code>jpg</code>当<code>png</code>处理了，笑嘻了，别学)，一般的隐写也没见得，好像一般的思路就没了，而且图片像素这么小，肯定是跟这个有关系的，后面才发现<code>jpg</code>和<code>png</code>的宽高显示错误是不一样的，<code>png</code>是可以通过计算crc值或者拖入虚拟机查看报错来确认宽高是否有问题，<code>jpg</code>不能这样做，只能学学格式改改宽高了</p>
<p>010打开，起始头<code>FF C0</code>，<code>00 11 08</code>三个字节，高宽后四个字节，<code>00 0A 00 0A</code><br />
然后<code>00 9F 00 9F</code>可以正常显示<br />
<img src="https://picx.zhimg.com/80/v2-ea374112fbf092bf546dd4264402cf14_1440w.jpeg" alt="" /></p>
<h1 id="pwnable"><a class="markdownIt-Anchor" href="#pwnable"></a> Pwnable</h1>
<h2 id="nc"><a class="markdownIt-Anchor" href="#nc"></a> nc</h2>
<p>nc直接连，15+1=0x10</p>
<h1 id="reversing"><a class="markdownIt-Anchor" href="#reversing"></a> Reversing</h1>
<h2 id="lambda"><a class="markdownIt-Anchor" href="#lambda"></a> lambda</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.setrecursionlimit(<span class="number">10000000</span>)</span><br><span class="line">(<span class="keyword">lambda</span> _0: _0(<span class="built_in">input</span>))(<span class="keyword">lambda</span> _1: (<span class="keyword">lambda</span> _2: _2(<span class="string">&#x27;Enter the flag: &#x27;</span>))(<span class="keyword">lambda</span> _3: (<span class="keyword">lambda</span> _4: _4(_1(_3)))(<span class="keyword">lambda</span> _5: (<span class="keyword">lambda</span> _6: _6(<span class="string">&#x27;&#x27;</span>.join))(<span class="keyword">lambda</span> _7: (<span class="keyword">lambda</span> _8: _8(<span class="keyword">lambda</span> _9: _7((<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">12</span>) <span class="keyword">for</span> c <span class="keyword">in</span> _9))))(<span class="keyword">lambda</span> _10: (<span class="keyword">lambda</span> _11: _11(<span class="string">&#x27;&#x27;</span>.join))(<span class="keyword">lambda</span> _12: (<span class="keyword">lambda</span> _13: _13((<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">3</span>) <span class="keyword">for</span> c <span class="keyword">in</span> _10(_5))))(<span class="keyword">lambda</span> _14: (<span class="keyword">lambda</span> _15: _15(_12(_14)))(<span class="keyword">lambda</span> _16: (<span class="keyword">lambda</span> _17: _17(<span class="string">&#x27;&#x27;</span>.join))(<span class="keyword">lambda</span> _18: (<span class="keyword">lambda</span> _19: _19(<span class="keyword">lambda</span> _20: _18((<span class="built_in">chr</span>(<span class="number">123</span> ^ <span class="built_in">ord</span>(c)) <span class="keyword">for</span> c <span class="keyword">in</span> _20))))(<span class="keyword">lambda</span> _21: (<span class="keyword">lambda</span> _22: _22(<span class="string">&#x27;&#x27;</span>.join))(<span class="keyword">lambda</span> _23: (<span class="keyword">lambda</span> _24: _24((_21(c) <span class="keyword">for</span> c <span class="keyword">in</span> _16)))(<span class="keyword">lambda</span> _25: (<span class="keyword">lambda</span> _26: _26(_23(_25)))(<span class="keyword">lambda</span> _27: (<span class="keyword">lambda</span> _28: _28(<span class="string">&#x27;16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r&#x27;</span>))</span><br><span class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (<span class="keyword">lambda</span> _29: (<span class="keyword">lambda</span> _30: _30(<span class="string">&#x27;&#x27;</span>.join))(<span class="keyword">lambda</span> _31: (<span class="keyword">lambda</span> _32: _32((<span class="built_in">chr</span>(<span class="built_in">int</span>(c, <span class="number">36</span>) + <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> _29.split(<span class="string">&#x27;_&#x27;</span>))))(<span class="keyword">lambda</span> _33: (<span class="keyword">lambda</span> _34: _34(_31(_33)))(<span class="keyword">lambda</span> _35: (<span class="keyword">lambda</span> _36: _36(<span class="keyword">lambda</span> _37: <span class="keyword">lambda</span> _38: _37 == _38))(<span class="keyword">lambda</span> _39: (<span class="keyword">lambda</span> _40: _40(<span class="built_in">print</span>))(<span class="keyword">lambda</span> _41: (<span class="keyword">lambda</span> _42: _42(_39))(<span class="keyword">lambda</span> _43: (<span class="keyword">lambda</span> _44: _44(_27))(<span class="keyword">lambda</span> _45: (<span class="keyword">lambda</span> _46: _46(_43(_45)))(<span class="keyword">lambda</span> _47: (<span class="keyword">lambda</span> _48: _48(_35))(<span class="keyword">lambda</span> _49: (<span class="keyword">lambda</span> _50: _50(_47(_49)))(<span class="keyword">lambda</span> _51: (<span class="keyword">lambda</span> _52: _52(<span class="string">&#x27;Correct FLAG!&#x27;</span>))(<span class="keyword">lambda</span> _53: (<span class="keyword">lambda</span> _54: _54(<span class="string">&#x27;Incorrect&#x27;</span>))(<span class="keyword">lambda</span> _55: (<span class="keyword">lambda</span> _56: _56(_41(_53 <span class="keyword">if</span> _51 <span class="keyword">else</span> _55)))(<span class="keyword">lambda</span> _57: <span class="keyword">lambda</span> _58: _58)))))))))))))))))))))))))))</span><br></pre></td></tr></table></figure>
<p>丢给GPT</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_step_5</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(c, <span class="number">36</span>) + <span class="number">10</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s.split(<span class="string">&#x27;_&#x27;</span>))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_step_4</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="number">123</span> ^ <span class="built_in">ord</span>(c)) <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_step_3</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">3</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_step_2</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">12</span>) <span class="keyword">for</span> c <span class="keyword">in</span> s)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_step_1</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(s)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_flag</span>(<span class="params">encoded_flag</span>):</span><br><span class="line">    step_5 = reverse_step_5(encoded_flag)</span><br><span class="line">    step_4 = reverse_step_4(step_5)</span><br><span class="line">    step_3 = reverse_step_3(step_4)</span><br><span class="line">    step_2 = reverse_step_2(step_3)</span><br><span class="line">    step_1 = reverse_step_1(step_2)</span><br><span class="line">    <span class="keyword">return</span> step_1</span><br><span class="line">encoded_flag = <span class="string">&#x27;16_10_13_x_6t_4_1o_9_1j_7_9_1j_1o_3_6_c_1o_6r&#x27;</span></span><br><span class="line">decoded_flag = decode_flag(encoded_flag)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的flag:&quot;</span>, decoded_flag)</span><br></pre></td></tr></table></figure>
<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1>
<h2 id="jq-playground"><a class="markdownIt-Anchor" href="#jq-playground"></a> JQ Playground</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.tmpl&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>, methods=[<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">post</span>():</span><br><span class="line">    <span class="built_in">filter</span> = request.form[<span class="string">&quot;filter&quot;</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[i] filter :&quot;</span>, <span class="built_in">filter</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">filter</span>) &gt;= <span class="number">9</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.tmpl&quot;</span>, error=<span class="string">&quot;Filter is too long&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;;&quot;</span> <span class="keyword">in</span> <span class="built_in">filter</span> <span class="keyword">or</span> <span class="string">&quot;|&quot;</span> <span class="keyword">in</span> <span class="built_in">filter</span> <span class="keyword">or</span> <span class="string">&quot;&amp;&quot;</span> <span class="keyword">in</span> <span class="built_in">filter</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.tmpl&quot;</span>, error=<span class="string">&quot;Filter contains invalid character&quot;</span>)</span><br><span class="line">    command = <span class="string">&quot;jq &#x27;&#123;&#125;&#x27; test.json&quot;</span>.<span class="built_in">format</span>(<span class="built_in">filter</span>)</span><br><span class="line">    ret = subprocess.run(</span><br><span class="line">        command,</span><br><span class="line">        shell=<span class="literal">True</span>,</span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        encoding=<span class="string">&quot;utf-8&quot;</span>,</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;index.tmpl&quot;</span>, contents=ret.stdout, error=ret.stderr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">8000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>考察JQ，关键代码<code>command = &quot;jq '&#123;&#125;' test.json&quot;.format(filter)</code><br />
过滤了<code>;|&amp;</code><br />
语法</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">jq <span class="punctuation">[</span>options<span class="punctuation">]</span> &lt;jq filter&gt; <span class="punctuation">[</span>file...<span class="punctuation">]</span></span><br><span class="line">jq <span class="punctuation">[</span>options<span class="punctuation">]</span> --args &lt;jq filter&gt; <span class="punctuation">[</span>strings...<span class="punctuation">]</span></span><br><span class="line">jq <span class="punctuation">[</span>options<span class="punctuation">]</span> --jsonargs &lt;jq filter&gt; <span class="punctuation">[</span>JSON_TEXTS...<span class="punctuation">]</span></span><br></pre></td></tr></table></figure>
<p>选项</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line">-c               紧凑而不是漂亮的输出;</span><br><span class="line">-n               使用`<span class="literal"><span class="keyword">null</span></span>`作为单个输入值;</span><br><span class="line">-e               根据输出设置退出状态代码;</span><br><span class="line">-s               将所有输入读取（吸取）到数组中；应用过滤器;</span><br><span class="line">-r               输出原始字符串，而不是JSON文本;</span><br><span class="line">-R               读取原始字符串，而不是JSON文本;</span><br><span class="line">-C               为JSON着色;</span><br><span class="line">-M               单色（不要为JSON着色）;</span><br><span class="line">-S               在输出上排序对象的键;</span><br><span class="line">--tab            使用制表符进行缩进;</span><br><span class="line">--arg a v        将变量$a设置为value&lt;v&gt;;</span><br><span class="line">--argjson a v    将变量$a设置为JSON value&lt;v&gt;;</span><br><span class="line">--slurpfile a f  将变量$a设置为从&lt;f&gt;读取的JSON文本数组;</span><br><span class="line">--rawfile a f    将变量$a设置为包含&lt;f&gt;内容的字符串;</span><br><span class="line">--args           其余参数是字符串参数，而不是文件;</span><br><span class="line">--jsonargs       其余的参数是JSON参数，而不是文件;</span><br><span class="line">--               终止参数处理;</span><br></pre></td></tr></table></figure>
<p>奇怪，输入<code>-r</code>或者<code>-R</code>都没有反应，难道是因为读的是<code>test.json</code>?<br />
看了师傅的wp，输入的是<code>' -R /*'</code>，注意前面有空格，单引号闭合<br />
就成了<code>jq '' -R /*'' test.json</code><br />
嘶，感觉可以，但好像又不是很懂(?)</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2024/06/23/WaniCTF2024/">https://hvang10.github.io/2024/06/23/WaniCTF2024/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/07/01/UIUCTF2024/" title="UIUCTF2024"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">UIUCTF2024</div></div></a></div><div class="next-post pull-right"><a href="/2024/06/15/%E5%85%B3%E4%BA%8ECBC%E5%AD%97%E8%8A%82%E7%BF%BB%E8%BD%AC%E6%94%BB%E5%87%BB/" title="关于CBC字节翻转攻击"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">关于CBC字节翻转攻击</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">35</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">1.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#beginners_rsa"><span class="toc-number">1.1.</span> <span class="toc-text"> beginners_rsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#beginners_aes"><span class="toc-number">1.2.</span> <span class="toc-text"> beginners_aes</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#replacement"><span class="toc-number">1.3.</span> <span class="toc-text"> replacement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easy-calc"><span class="toc-number">1.4.</span> <span class="toc-text"> Easy calc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#speedy"><span class="toc-number">1.5.</span> <span class="toc-text"> speedy()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#bad_worker"><span class="toc-number">2.1.</span> <span class="toc-text"> Bad_Worker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#pow"><span class="toc-number">2.2.</span> <span class="toc-text"> pow</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#one-day-one-letter"><span class="toc-number">2.3.</span> <span class="toc-text"> One Day One Letter</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#noscript"><span class="toc-number">2.4.</span> <span class="toc-text"> Noscript()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#forensics"><span class="toc-number">3.</span> <span class="toc-text"> Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#tiny_usb"><span class="toc-number">3.1.</span> <span class="toc-text"> tiny_usb</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#codebreaker"><span class="toc-number">3.2.</span> <span class="toc-text"> codebreaker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#surveillance_of_sus"><span class="toc-number">3.3.</span> <span class="toc-text"> Surveillance_of_sus</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#i_wanna_be_a_streamer"><span class="toc-number">3.4.</span> <span class="toc-text"> I_wanna_be_a_streamer</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#tiny_10px"><span class="toc-number">3.5.</span> <span class="toc-text"> tiny_10px</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pwnable"><span class="toc-number">4.</span> <span class="toc-text"> Pwnable</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#nc"><span class="toc-number">4.1.</span> <span class="toc-text"> nc</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reversing"><span class="toc-number">5.</span> <span class="toc-text"> Reversing</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#lambda"><span class="toc-number">5.1.</span> <span class="toc-text"> lambda</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">6.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#jq-playground"><span class="toc-number">6.1.</span> <span class="toc-text"> JQ Playground</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/10/pcb2024-WriteUp/" title="pcb2024-WriteUp">pcb2024-WriteUp</a><time datetime="2024-11-10T09:25:26.000Z" title="Created 2024-11-10 17:25:26">2024-11-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/07/SageMath10-x%E6%9C%80%E6%96%B0%E7%89%88%E5%AE%89%E8%A3%85%E6%8C%87%E5%BC%95/" title="SageMath10.x最新版安装指引">SageMath10.x最新版安装指引</a><time datetime="2024-11-06T17:47:23.000Z" title="Created 2024-11-07 01:47:23">2024-11-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/05/SHCTF2024-WriteUp/" title="SHCTF2024-WriteUp">SHCTF2024-WriteUp</a><time datetime="2024-11-04T17:40:17.000Z" title="Created 2024-11-05 01:40:17">2024-11-05</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/11/04/%E7%BD%91%E9%BC%8E%E6%9D%AF2024%E9%9D%92%E9%BE%99%E7%BB%84&amp;&amp;%E5%BC%BA%E7%BD%91%E6%9D%AF2024-WriteUp/" title="网鼎杯2024青龙组&amp;&amp;强网杯2024-WriteUp">网鼎杯2024青龙组&amp;&amp;强网杯2024-WriteUp</a><time datetime="2024-11-04T14:44:50.000Z" title="Created 2024-11-04 22:44:50">2024-11-04</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/31/MoeCTF2024-WriteUp/" title="MoeCTF2024 WriteUp">MoeCTF2024 WriteUp</a><time datetime="2024-10-31T12:55:11.000Z" title="Created 2024-10-31 20:55:11">2024-10-31</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>