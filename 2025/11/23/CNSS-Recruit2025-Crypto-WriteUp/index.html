<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CNSS-Recruit2025-Crypto-WriteUp | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Crypto  ğŸŒŸæ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­ MNZWK327L5SW6ZDGOJ2GQZLPMNPWS5LOPNWG25DUL5ZF6X3ZN5XV65LBNJXHG43XMNSW62DXNRXWG4C7OB4V63TPL56Q&#x3D;&#x3D;&#x3D;&#x3D; Base32 + (Fence&#x3D;3) cnss&#123;welcome_to_the_world_of_crypto_hope_you_can_join_us&amp;#1">
<meta property="og:type" content="article">
<meta property="og:title" content="CNSS-Recruit2025-Crypto-WriteUp">
<meta property="og:url" content="https://hvang10.github.io/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="Crypto  ğŸŒŸæ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­ MNZWK327L5SW6ZDGOJ2GQZLPMNPWS5LOPNWG25DUL5ZF6X3ZN5XV65LBNJXHG43XMNSW62DXNRXWG4C7OB4V63TPL56Q&#x3D;&#x3D;&#x3D;&#x3D; Base32 + (Fence&#x3D;3) cnss&#123;welcome_to_the_world_of_crypto_hope_you_can_join_us&amp;#1">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2025-11-23T03:00:00.000Z">
<meta property="article:modified_time" content="2025-11-23T07:21:39.995Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CNSS-Recruit2025-Crypto-WriteUp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-11-23 15:21:39'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">CNSS-Recruit2025-Crypto-WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-11-23T03:00:00.000Z" title="Created 2025-11-23 11:00:00">2025-11-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-11-23T07:21:39.995Z" title="Updated 2025-11-23 15:21:39">2025-11-23</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">6.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>33mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="CNSS-Recruit2025-Crypto-WriteUp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> Crypto</h1>
<h2 id="æ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­"><a class="markdownIt-Anchor" href="#æ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­"></a> ğŸŒŸæ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­</h2>
<p><code>MNZWK327L5SW6ZDGOJ2GQZLPMNPWS5LOPNWG25DUL5ZF6X3ZN5XV65LBNJXHG43XMNSW62DXNRXWG4C7OB4V63TPL56Q====</code></p>
<p><strong>Base32</strong> + <strong>(Fence=3)</strong><br />
<code>cnss&#123;welcome_to_the_world_of_crypto_hope_you_can_join_us&#125;</code></p>
<h2 id="æ³¢å…°æ¥å®¢"><a class="markdownIt-Anchor" href="#æ³¢å…°æ¥å®¢"></a> ğŸæ³¢å…°æ¥å®¢</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag11</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">m = bytes_to_long(flag11)</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#RSA is the most commonly used asymmetric encryption, you can study it clearly</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 857160393763200018136243293304734832626469366898671548658063982128301976510619912965430915666613801166650348101081196429027045093249075734871210100148502</span></span><br><span class="line"><span class="string">p = 13144680786411281909389708068802789151202603464528138622729955260404242510138660030278439234468305471409260753796094593554849276654701859454461337034174099</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>å•ç´ æ•°RSAï¼Œphi=p-1</strong><br />
å¤ªç®€å•å°±ä¸æ”¾ä»£ç äº†<br />
<code>cnss&#123;welcome_to_the_world_of_number_theory&#125;</code></p>
<h2 id="è´é˜¿æœµè‰åˆ‡çš„ä¼ è¯´"><a class="markdownIt-Anchor" href="#è´é˜¿æœµè‰åˆ‡çš„ä¼ è¯´"></a> ğŸª„è´é˜¿æœµè‰åˆ‡çš„ä¼ è¯´</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Beatrices_magic <span class="keyword">import</span> magic_of_love</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag10</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = prod([magic_of_love(<span class="string">&#x27;This function can find a 512-bit prime within the consecutive digits of Ï€, and you will never be able to decrypt it!&#x27;</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)])</span><br><span class="line">m = bytes_to_long(flag10)</span><br><span class="line"><span class="keyword">assert</span> m &lt; n</span><br><span class="line">c = power_mod(m, <span class="number">0x10001</span>, n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output10.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>\n&#x27;</span>)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">n = 521918091937867626454155236624054544603510014039284694091636699437510894391152159211125227423542579838154927599065336125096528001249561366603662452297166996584681134504824972567965819751814858534655055084423547289276630393826952546685534329235118520697172050439155214602603881552385389099474083637082166573036865307157645837184525760963062765716230623357954202242424789293750862836579062199128743608184334985642380401359931662411542641662525882519015888888152718325353530420919100598407845631758819769876654881166740227951871744111204484767596423474757389815535953291982473519122137034530070651746586885076335553540700572697842608743426749662045740260754604875331910940467862656556013856400735800258067377736544159184376805934344571975446770537058595274440355028547881344205554402726825306139031704869478515819223028865435892887668130594346970335394289274650157484920887903423491772068385257952792337043832826461986365683321</span></span><br><span class="line"><span class="string">c = 459551483703398969753583509531156753644834356994813274637718869401770559618414838203635094684391673443234656865447628776624317350837495974978140684572398589157547348990178078284470951181081027372730225337943341978361779537898715003764518073079546174747729803505861949752589995848366196573243164634829553158093887746572161845602226954758541479519080294093286689766767449360598345571320518741821108090435338536630509932993229075615206434774578764078184331827963144487808801131957283893003259264922902700862655251047873003145835458015801076344223798970767266322778905512791112615303289850362924887105863748039809266973137138293737758372194503724596551602550703162050906442611755576947937309195772803617436971835647038618852514871688085575259922642871036768937712536129329294607754153502344983130258047646801229084104924162171527038601693128642395022554302792717460774515300980203494167056499312325186874022086701501029428210810</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>æ‰¾åœ†å‘¨ç‡å°æ•°éƒ¨åˆ†ä¸­çš„<strong>6ä¸ª512bitsçš„ç´ æ•°</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://share.note.youdao.com/ynoteshare/index.html?id=9cb62a1e8927dfebf7f1fec2e618f8a3">åœ†å‘¨ç‡å°æ•°ä¸€ç™¾ä¸‡ä½</a></li>
<li><a target="_blank" rel="noopener" href="https://introcs.cs.princeton.edu/java/data/pi-10million.txt">ä¸€åƒä¸‡ä½</a></li>
</ul>
<p>å®é™…ä¸Šèƒ½æ‰¾å‡º<strong>å‰3ä¸ªå› å­</strong>å°±å¤Ÿäº†(åªè¦<code>m</code>å°äº<strong>å½“å‰é€‰æ‹©çš„n=pqr</strong>å³å¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸è§„çš„åº”ç”¨ï¼Œæœ‰çš„æ—¶å€™æ˜¯ä¸éœ€è¦çŸ¥é“å…¨éƒ¨å› å­æ‰èƒ½æ±‚çš„ï¼Œmå°äºå½“å‰é€‰æ‹©çš„æ¨¡æ•°å³å¯)ï¼ŒåŒºé—´åº”è¯¥åœ¨<code>1w-100w</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">521918091937867626454155236624054544603510014039284694091636699437510894391152159211125227423542579838154927599065336125096528001249561366603662452297166996584681134504824972567965819751814858534655055084423547289276630393826952546685534329235118520697172050439155214602603881552385389099474083637082166573036865307157645837184525760963062765716230623357954202242424789293750862836579062199128743608184334985642380401359931662411542641662525882519015888888152718325353530420919100598407845631758819769876654881166740227951871744111204484767596423474757389815535953291982473519122137034530070651746586885076335553540700572697842608743426749662045740260754604875331910940467862656556013856400735800258067377736544159184376805934344571975446770537058595274440355028547881344205554402726825306139031704869478515819223028865435892887668130594346970335394289274650157484920887903423491772068385257952792337043832826461986365683321</span></span><br><span class="line">c = <span class="number">459551483703398969753583509531156753644834356994813274637718869401770559618414838203635094684391673443234656865447628776624317350837495974978140684572398589157547348990178078284470951181081027372730225337943341978361779537898715003764518073079546174747729803505861949752589995848366196573243164634829553158093887746572161845602226954758541479519080294093286689766767449360598345571320518741821108090435338536630509932993229075615206434774578764078184331827963144487808801131957283893003259264922902700862655251047873003145835458015801076344223798970767266322778905512791112615303289850362924887105863748039809266973137138293737758372194503724596551602550703162050906442611755576947937309195772803617436971835647038618852514871688085575259922642871036768937712536129329294607754153502344983130258047646801229084104924162171527038601693128642395022554302792717460774515300980203494167056499312325186874022086701501029428210810</span></span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_prime_factors_in_pi</span>(<span class="params">pi_digits_file, prime_digit_length, num_factors_to_find=<span class="number">6</span></span>):</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;å¼€å§‹åœ¨æ–‡ä»¶ &#x27;<span class="subst">&#123;pi_digits_file&#125;</span>&#x27; ä¸­æœç´¢ <span class="subst">&#123;prime_digit_length&#125;</span> ä½çš„ç´ æ•°å› å­...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;ç›®æ ‡æ˜¯æ‰¾åˆ° <span class="subst">&#123;num_factors_to_find&#125;</span> ä¸ªå› å­ã€‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(pi_digits_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            pi_str = f.read()</span><br><span class="line"></span><br><span class="line">        found_factors = []</span><br><span class="line">        current_n = n</span><br><span class="line">        start_pos = <span class="number">0</span></span><br><span class="line">        global_start_time = time.time()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(found_factors) &lt; num_factors_to_find:</span><br><span class="line">            factor_found_in_this_pass = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(pi_str) - start_pos &lt; prime_digit_length:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;\nPiæ–‡ä»¶å‰©ä½™ä½æ•°ä¸è¶³ï¼Œæ— æ³•ç»§ç»­æœç´¢ã€‚&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(</span><br><span class="line">                <span class="string">f&quot;\n--- æ­£åœ¨æœç´¢ç¬¬ <span class="subst">&#123;<span class="built_in">len</span>(found_factors) + <span class="number">1</span>&#125;</span> ä¸ªå› å­ (å‰©ä½™ n çš„ä½æ•°: <span class="subst">&#123;current_n.bit_length()&#125;</span>) ---&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ä»Ï€å°æ•°ç¬¬ <span class="subst">&#123;start_pos + <span class="number">1</span>&#125;</span> ä½å¼€å§‹æœç´¢...&quot;</span>)</span><br><span class="line"></span><br><span class="line">            pass_start_time = time.time()</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start_pos, <span class="built_in">len</span>(pi_str) - prime_digit_length + <span class="number">1</span>):</span><br><span class="line">                candidate_str = pi_str[i: i + prime_digit_length]</span><br><span class="line">                candidate_num = gmpy2.mpz(candidate_str)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> gmpy2.is_prime(candidate_num):</span><br><span class="line">                    <span class="keyword">if</span> current_n % candidate_num == <span class="number">0</span>:</span><br><span class="line">                        factor = candidate_num</span><br><span class="line">                        found_factors.append(factor)</span><br><span class="line"></span><br><span class="line">                        pass_end_time = time.time()</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;æˆåŠŸæ‰¾åˆ°ç¬¬ <span class="subst">&#123;<span class="built_in">len</span>(found_factors)&#125;</span> ä¸ªç´ æ•°å› å­ï¼&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;å› å­: <span class="subst">&#123;factor&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;å®ƒä½äºÏ€å°æ•°éƒ¨åˆ†çš„ç¬¬ <span class="subst">&#123;i + <span class="number">1</span>&#125;</span> ä½å¼€å§‹ã€‚&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(</span><br><span class="line">                            <span class="string">f&quot;æŸ¥æ‰¾æ­¤å› å­ç”¨æ—¶: <span class="subst">&#123;pass_end_time - pass_start_time:<span class="number">.4</span>f&#125;</span> ç§’&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span>*<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">                        current_n //= factor</span><br><span class="line">                        start_pos = i + <span class="number">1</span></span><br><span class="line">                        factor_found_in_this_pass = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">                        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> factor_found_in_this_pass:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nåœ¨ä»ä½ç½® <span class="subst">&#123;start_pos + <span class="number">1</span>&#125;</span> å¼€å§‹çš„å‰©ä½™Piæ•°å­—ä¸­æœªæ‰¾åˆ°æ›´å¤šå› å­ã€‚&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        global_end_time = time.time()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;#&quot;</span>*<span class="number">50</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;æ‰€æœ‰æœç´¢å®Œæˆã€‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;æ€»ç”¨æ—¶: <span class="subst">&#123;global_end_time - global_start_time:<span class="number">.4</span>f&#125;</span> ç§’&quot;</span>)</span><br><span class="line">        phi = <span class="number">1</span></span><br><span class="line">        N = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> found_factors:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;å…±æ‰¾åˆ° <span class="subst">&#123;<span class="built_in">len</span>(found_factors)&#125;</span> ä¸ªå› å­:&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(found_factors):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  å› å­ <span class="subst">&#123;i+<span class="number">1</span>&#125;</span>: <span class="subst">&#123;factor&#125;</span>&quot;</span>)</span><br><span class="line">                phi *= (factor - <span class="number">1</span>)</span><br><span class="line">                N *= factor</span><br><span class="line">            d = inverse(e, phi)</span><br><span class="line">            flag = <span class="built_in">pow</span>(c, d, N)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;è®¡ç®—å¾—åˆ°çš„ flag: <span class="subst">&#123;long_to_bytes(flag).decode()&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;æœªæ‰¾åˆ°ä»»ä½•å› å­ã€‚&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;#&quot;</span>*<span class="number">50</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> found_factors</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;é”™è¯¯ï¼šæ‰¾ä¸åˆ°æ–‡ä»¶ &#x27;<span class="subst">&#123;pi_digits_file&#125;</span>&#x27;ã€‚è¯·ç¡®ä¿æ–‡ä»¶å­˜åœ¨äºæ­£ç¡®çš„ä½ç½®ã€‚&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">found_factors_list = find_prime_factors_in_pi(</span><br><span class="line">    pi_digits_file=<span class="string">&quot;pai.txt&quot;</span>,</span><br><span class="line">    prime_digit_length=<span class="number">155</span>,</span><br><span class="line">    num_factors_to_find=<span class="number">6</span></span><br><span class="line">)</span><br><span class="line"><span class="comment"># cnss&#123;Umineko is a good game, If you&#x27;ve played this game, I might consider giving you some extra points (just kidding, but the game is really fun!)&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ï¸november-rain"><a class="markdownIt-Anchor" href="#ï¸november-rain"></a> ğŸŒ§ï¸November Rain</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span>  flag8</span><br><span class="line">iv = long_to_bytes(<span class="built_in">int</span>(flag8.strip(<span class="string">b&#x27;cnss&#123;&#x27;</span>).strip(<span class="string">b&#x27;&#125;&#x27;</span>)))</span><br><span class="line">key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">hint = os.urandom(<span class="number">4</span>) * <span class="number">8</span></span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(hint) ^ bytes_to_long(key))</span><br><span class="line">msg = <span class="string">b&#x27;CNSS is a big happy family, and we hope you can successfully join us. CNSS-chan has been looking forward to your arrival :))))!!&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypto</span>(<span class="params">message</span>):</span><br><span class="line">    aes = AES.new(key,AES.MODE_CBC,iv)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(encrypto(msg)[-<span class="number">48</span>:]))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">7247074606860797347397352236235906489165611013788020866468477972070266910937</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">b&#x27;PW7xp+ScMUPvssOTxynA0vmLSedY4wox/Xkr49uGmoxOmr/dKBoZ2REEimTv7v1A&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>hint xor key</strong>ç»“æœçš„<strong>é«˜åå…­å­—èŠ‚</strong>å¼‚æˆ–<strong>ä½åå…­å­—èŠ‚</strong>å³å¯æ¢å¤<code>key</code>ï¼ˆå¼‚æˆ–è¿ç®—çš„è§„åˆ™ä¸‹ï¼Œ<code>key</code>é«˜åå…­å­—èŠ‚ä¸º<strong>å…¨0</strong>ï¼‰<br />
é€šè¿‡å·²çŸ¥çš„<strong>å…¨éƒ¨æ˜æ–‡</strong>å’Œæœ€åçš„<strong>ä¸‰ä¸ªå¯†æ–‡å—</strong>ï¼Œç»“åˆ<strong>keyï¼ˆAES-ECB-decryptï¼‰<strong>å‘å‰</strong>æ¨å¯¼ï¼ˆxorï¼‰</strong>ï¼Œ<strong>æ¢å¤iv</strong><br />
<img src="https://picx.zhimg.com/80/v2-02cb496288e7eaa8013f7d6963ec8c92_1440w.png" alt="" /></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(x ^ y <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(a, b))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypto</span>(<span class="params">message</span>):</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv_bytes)</span><br><span class="line">    <span class="keyword">return</span> aes.encrypt(message)</span><br><span class="line"></span><br><span class="line">hint_xor_key = <span class="number">7247074606860797347397352236235906489165611013788020866468477972070266910937</span></span><br><span class="line">b64_ciphertext = <span class="string">b&#x27;PW7xp+ScMUPvssOTxynA0vmLSedY4wox/Xkr49uGmoxOmr/dKBoZ2REEimTv7v1A&#x27;</span></span><br><span class="line">msg = <span class="string">b&#x27;CNSS is a big happy family, and we hope you can successfully join us. CNSS-chan has been looking forward to your arrival :))))!!&#x27;</span></span><br><span class="line"></span><br><span class="line">hint_xor_key = long_to_bytes(hint_xor_key)</span><br><span class="line">key = xor(hint_xor_key[:<span class="number">16</span>], hint_xor_key[<span class="number">16</span>:])</span><br><span class="line"></span><br><span class="line">cipher_blocks = [base64.b64decode(b64_ciphertext)[i:i+<span class="number">16</span>]</span><br><span class="line">                 <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">48</span>, <span class="number">16</span>)]</span><br><span class="line">cipher_blocks = cipher_blocks[::-<span class="number">1</span>]</span><br><span class="line">msg_blocks = [msg[i:i+<span class="number">16</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg), <span class="number">16</span>)]</span><br><span class="line"></span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">    temp = aes.decrypt(cipher_blocks[-<span class="number">1</span>])</span><br><span class="line">    cipher_blocks.append(xor(temp, msg_blocks[i]))</span><br><span class="line"></span><br><span class="line">iv_bytes = cipher_blocks[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> base64.b64encode(encrypto(msg)[-<span class="number">48</span>:]) == b64_ciphertext</span><br><span class="line"></span><br><span class="line">iv = bytes_to_long(iv_bytes)</span><br><span class="line">flag = <span class="string">f&quot;cnss&#123;&#123;<span class="subst">&#123;iv&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># cnss&#123;259936502081082258767763063599318618259&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ever17"><a class="markdownIt-Anchor" href="#ever17"></a> ğŸ¡Ever17</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">flag1 = FLAG[:<span class="number">13</span>]</span><br><span class="line">flag2 = FLAG[<span class="number">13</span>:]</span><br><span class="line"><span class="comment">#FLAG = cnss&#123;xxx&#125;</span></span><br><span class="line"></span><br><span class="line">a = bytes_to_long(flag1)</span><br><span class="line">b = bytes_to_long(flag2)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="keyword">assert</span> a.bit_length() + b.bit_length() &lt;= <span class="number">230</span></span><br><span class="line"></span><br><span class="line">p = next_prime(a)</span><br><span class="line">q = next_prime(p)</span><br><span class="line">n = p * q</span><br><span class="line">e = p - a</span><br><span class="line"></span><br><span class="line">t = getPrime(<span class="number">127</span>)  </span><br><span class="line">pp = getPrime(<span class="number">128</span>)</span><br><span class="line">R = Integers(t)</span><br><span class="line">d = power_mod(<span class="number">13</span>, R(b**<span class="number">3</span>-b+<span class="number">1</span>), pp)</span><br><span class="line"><span class="built_in">print</span>(R(b**<span class="number">3</span> - b + <span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;pp = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(pp))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(d))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(t))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 62059276114488335404539537873896627084226282430239010310558911</span></span><br><span class="line"><span class="string">e = 39</span></span><br><span class="line"><span class="string">pp = 312259503360917714041582848661140302699</span></span><br><span class="line"><span class="string">d = 210422286411000941403494297143869304854</span></span><br><span class="line"><span class="string">t = 124465960300667960302951153129553600783</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ç›¸é‚»çš„ä¸¤ä¸ªç´ æ•°ï¼šå¼€å¹³æ–¹æ‰¾ä¸‹ä¸€ä¸ªç´ æ•°å³å¯ï¼Œæˆ–è€…è´¹é©¬åˆ†è§£æ³•</mtext></mrow><annotation encoding="application/x-tex">ç›¸é‚»çš„ä¸¤ä¸ªç´ æ•°ï¼šå¼€å¹³æ–¹æ‰¾ä¸‹ä¸€ä¸ªç´ æ•°å³å¯ï¼Œæˆ–è€…è´¹é©¬åˆ†è§£æ³•</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ç›¸</span><span class="mord cjk_fallback">é‚»</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ä¸¤</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç´ </span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ï¼š</span><span class="mord cjk_fallback">å¼€</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">æ–¹</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç´ </span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æˆ–</span><span class="mord cjk_fallback">è€…</span><span class="mord cjk_fallback">è´¹</span><span class="mord cjk_fallback">é©¬</span><span class="mord cjk_fallback">åˆ†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">æ³•</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>â‰¡</mo><mn>1</mn><msup><mn>3</mn><mrow><msup><mi>b</mi><mn>3</mn></msup><mo>âˆ’</mo><mi>b</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>â‰¡</mo><mn>1</mn><msup><mn>3</mn><mi>B</mi></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d\equiv 13^{b^3-b+1}\equiv 13^B\pmod {pp}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9869199999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9869199999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913142857142857em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mbin mtight">âˆ’</span><span class="mord mathnormal mtight">b</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">3</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi>L</mi><mi>P</mi><mtext>æ±‚è§£</mtext><mi>B</mi></mrow><annotation encoding="application/x-tex">DLPæ±‚è§£B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal">L</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">è§£</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>b</mi><mn>3</mn></msup><mo>âˆ’</mo><mi>b</mi><mo>+</mo><mn>1</mn><mo>=</mo><mi>B</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b^3-b+1=B\pmod t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>0</mn><mo>â‰¡</mo><msup><mi>b</mi><mn>3</mn></msup><mo>âˆ’</mo><mi>b</mi><mo>+</mo><mn>1</mn><mo>âˆ’</mo><mi>B</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(b)\equiv 0\equiv b^3-b+1-B\pmod t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>é€šè¿‡å¤šé¡¹å¼ç¯çš„æ ¹ï¼Œæ±‚è§£</mtext><mi>b</mi></mrow><annotation encoding="application/x-tex">é€šè¿‡å¤šé¡¹å¼ç¯çš„æ ¹ï¼Œæ±‚è§£b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">å¤š</span><span class="mord cjk_fallback">é¡¹</span><span class="mord cjk_fallback">å¼</span><span class="mord cjk_fallback">ç¯</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ ¹</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">è§£</span><span class="mord mathnormal">b</span></span></span></span></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> nextprime, prevprime</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">62059276114488335404539537873896627084226282430239010310558911</span></span><br><span class="line">pp = <span class="number">312259503360917714041582848661140302699</span></span><br><span class="line">d = <span class="number">210422286411000941403494297143869304854</span></span><br><span class="line">t = <span class="number">124465960300667960302951153129553600783</span></span><br><span class="line"></span><br><span class="line">n2 = sqrt(n)</span><br><span class="line">p = nextprime(n2)</span><br><span class="line">q = n//p</span><br><span class="line">flag1 = long_to_bytes(<span class="built_in">min</span>(p, q)-<span class="number">39</span>).decode()</span><br><span class="line"></span><br><span class="line">R = GF(pp)</span><br><span class="line">B = R(d).log(R(<span class="number">13</span>))</span><br><span class="line">PolyRing = PolynomialRing(Zmod(t), <span class="string">&#x27;b&#x27;</span>)</span><br><span class="line">b = PolyRing.gen()</span><br><span class="line">f = b^<span class="number">3</span> - b + <span class="number">1</span> - B</span><br><span class="line">roots = f.roots()</span><br><span class="line">flag2 = long_to_bytes(<span class="built_in">int</span>(roots[<span class="number">0</span>][<span class="number">0</span>])).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag1 + flag2)</span><br><span class="line"><span class="comment"># cnss&#123;Live1sSh0r7,Y0un33dSa9e&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="åæ‰çš„æ”¶éŸ³æœº"><a class="markdownIt-Anchor" href="#åæ‰çš„æ”¶éŸ³æœº"></a> ğŸ“»åæ‰çš„æ”¶éŸ³æœº</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG4</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(FLAG4)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)  </span><br><span class="line">N = p * q</span><br><span class="line">phi = (p-<span class="number">1</span>) * (q-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">d = getRandomNBitInteger(<span class="number">500</span>)  </span><br><span class="line"><span class="keyword">assert</span> GCD(d, phi) == <span class="number">1</span> </span><br><span class="line">e = inverse(d, phi)</span><br><span class="line">c = power_mod(m, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(N))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 8593625836367917764986091537862661394327845125958492795352878044172899648510875879133512661014999777302814930717163447720774860586907847681466581673038469991865927343725317629832933726187701382821083817561174786833492609115270480453109104538437515403110732126788196704586145936288552936640919531366811895714904827689397219311679095253607533956536809523167055725880185938101621676100671431648900864949379940933213077053652267092900963895945525437638158045737486550900359435298370224477273147512654096329734627945308150919670603172469135775474607423778358900151823484950999883188363171092959718200419629869054434944384</span></span><br><span class="line"><span class="string">e = 1442973038831134781460545372668079573791255089510655684278169469518912344749453458527088628470363767104256664623064615249201126365247301906994228337491351910766820781592919954944540203871005778312943861046561877144710178914425186934644106916241015271110026033506622787659963342121470374665194430565858920858930941905531265541417128036020226443397870780895679565107220766770064617603043374136075499771747782563506316373720220877801857709735087319543656430075257981135224646591210239275335059365770992064147754537760540339692837252836885650096625839221047936662519348425289556777515319440792080034245198540405529479523</span></span><br><span class="line"><span class="string">N = 10864811587894087046912389551445784477443478981530416841951072489270014664625868038611938460346743770608824515132925518342460413354827851767413150762025536287317538557271656618262172933337517229049499712951738056866379457624619837197764161456176413247466972758765501483282288192647013542746965392115684146291803209523100433142063984408890127553887512053367391034721571868380432612782024648063590732495824077292627245149142473617621479947679459677428299115294783881029177338636558399567530359530552401953931661755828342984316976497592368390287838236503122722531045894613429408246557048894016811755207012570359840134849</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>n</mi><mtext>å¤§å°è¿‘ä¼¼ï¼š</mtext><mi>W</mi><mi>i</mi><mi>n</mi><mi>n</mi><mi>e</mi><mi>r</mi><mtext>Â </mtext><mi>A</mi><mi>t</mi><mi>t</mi><mi>a</mi><mi>c</mi><mi>k</mi></mrow><annotation encoding="application/x-tex">enå¤§å°è¿‘ä¼¼ï¼šWinner\ Attack</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord cjk_fallback">å¤§</span><span class="mord cjk_fallback">å°</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">ä¼¼</span><span class="mord cjk_fallback">ï¼š</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">n</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace">Â </span><span class="mord mathnormal">A</span><span class="mord mathnormal">t</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å¥—æ¿å­å³å¯</mtext></mrow><annotation encoding="application/x-tex">å¥—æ¿å­å³å¯</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å¥—</span><span class="mord cjk_fallback">æ¿</span><span class="mord cjk_fallback">å­</span><span class="mord cjk_fallback">å³</span><span class="mord cjk_fallback">å¯</span></span></span></span></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">continuedFra</span>(<span class="params">x, y</span>):</span><br><span class="line">    cf = []</span><br><span class="line">    <span class="keyword">while</span> y:</span><br><span class="line">        cf.append(x // y)</span><br><span class="line">        x, y = y, x % y</span><br><span class="line">    <span class="keyword">return</span> cf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    numerator = <span class="number">0</span>  <span class="comment"># åˆ†å­</span></span><br><span class="line">    denominator = <span class="number">1</span>  <span class="comment"># åˆ†æ¯</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> cf[::-<span class="number">1</span>]:</span><br><span class="line">        numerator, denominator = denominator, x * denominator + numerator</span><br><span class="line">    <span class="keyword">return</span> numerator, denominator</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getGradualFra</span>(<span class="params">cf</span>):</span><br><span class="line">    gf = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(cf) + <span class="number">1</span>):</span><br><span class="line">        gf.append(gradualFra(cf[:i]))</span><br><span class="line">    <span class="keyword">return</span> gf</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">e, n</span>):</span><br><span class="line">    cf = continuedFra(e, n)</span><br><span class="line">    gf = getGradualFra(cf)</span><br><span class="line">    <span class="keyword">for</span> d, k <span class="keyword">in</span> gf:</span><br><span class="line">        <span class="keyword">if</span> d.bit_length() == <span class="number">500</span>:</span><br><span class="line">            <span class="keyword">return</span> d</span><br><span class="line"></span><br><span class="line">c = <span class="number">8593625836367917764986091537862661394327845125958492795352878044172899648510875879133512661014999777302814930717163447720774860586907847681466581673038469991865927343725317629832933726187701382821083817561174786833492609115270480453109104538437515403110732126788196704586145936288552936640919531366811895714904827689397219311679095253607533956536809523167055725880185938101621676100671431648900864949379940933213077053652267092900963895945525437638158045737486550900359435298370224477273147512654096329734627945308150919670603172469135775474607423778358900151823484950999883188363171092959718200419629869054434944384</span></span><br><span class="line">e = <span class="number">1442973038831134781460545372668079573791255089510655684278169469518912344749453458527088628470363767104256664623064615249201126365247301906994228337491351910766820781592919954944540203871005778312943861046561877144710178914425186934644106916241015271110026033506622787659963342121470374665194430565858920858930941905531265541417128036020226443397870780895679565107220766770064617603043374136075499771747782563506316373720220877801857709735087319543656430075257981135224646591210239275335059365770992064147754537760540339692837252836885650096625839221047936662519348425289556777515319440792080034245198540405529479523</span></span><br><span class="line">N = <span class="number">10864811587894087046912389551445784477443478981530416841951072489270014664625868038611938460346743770608824515132925518342460413354827851767413150762025536287317538557271656618262172933337517229049499712951738056866379457624619837197764161456176413247466972758765501483282288192647013542746965392115684146291803209523100433142063984408890127553887512053367391034721571868380432612782024648063590732495824077292627245149142473617621479947679459677428299115294783881029177338636558399567530359530552401953931661755828342984316976497592368390287838236503122722531045894613429408246557048894016811755207012570359840134849</span></span><br><span class="line">d = wienerAttack(e, N)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">pow</span>(c, d, N)).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># cnss&#123;R5A_4as_Many_D1fferent_attacks,and_w1ener_Attack_is_on3_0f_the_cla5s1c_0nes&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="é²œèŠ±ç››å¼€çš„æ£®æ—"><a class="markdownIt-Anchor" href="#é²œèŠ±ç››å¼€çš„æ£®æ—"></a> ğŸŒ¸é²œèŠ±ç››å¼€çš„æ£®æ—</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FlAG3</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_ecc_key</span>(<span class="params">nbits</span>):</span><br><span class="line">    p = getPrime(nbits)</span><br><span class="line">    q = getPrime(nbits)</span><br><span class="line">    r = getPrime(nbits)</span><br><span class="line">    n = p * q * r</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        a = getRandomInteger(nbits)</span><br><span class="line">        b = getRandomInteger(nbits)</span><br><span class="line">        <span class="keyword">if</span> gcd(<span class="number">4</span> * a ** <span class="number">3</span> + <span class="number">27</span> * b ** <span class="number">2</span>, n) == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">    e = getPrime(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">return</span> n, E, e, p, q, r, a, b</span><br><span class="line"></span><br><span class="line">x = bytes_to_long(FlAG3)</span><br><span class="line">n, E, e, p, q, r, a, b = gen_ecc_key(<span class="number">83</span>)</span><br><span class="line">pt = E.lift_x(Integer(x))</span><br><span class="line">ct = pt * e</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;p = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(p))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;q = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;r = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(r))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;a = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(a))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;b = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(b))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cc = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(Integer(ct[<span class="number">0</span>])))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p = 15078272222950150537</span></span><br><span class="line"><span class="string">q = 16351967803352092039</span></span><br><span class="line"><span class="string">r = 14892319684336011143</span></span><br><span class="line"><span class="string">a = 196082585826675836</span></span><br><span class="line"><span class="string">b = 17207772750460583034</span></span><br><span class="line"><span class="string">e = 719</span></span><br><span class="line"><span class="string">cc = 2733006338538398832311230797238861624963229236397553282448</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>è¿™é¢˜å°±æ˜¯<strong>ç®€å•çš„ECDLP+CRT</strong></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>t</mi><mo>=</mo><mi>e</mi><mo>âˆ—</mo><mi>p</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">ct=e*pt</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mord mathnormal">t</span></span></span></span></p>
<p>å·²çŸ¥çš„æ˜¯<code>ct</code>çš„æ¨ªåæ ‡<code>x</code>ï¼Œä½†<code>pt</code>ä¹Ÿæ°å¥½æ˜¯<strong>æ¨ªåæ ‡æ»¡è¶³flag</strong>çš„ç‚¹ï¼Œå› æ­¤åªéœ€è¦æ‰¾åˆ°<strong>é€†å…ƒ</strong>å³å¯æ¢å¤<code>pt</code></p>
<p>ä½†<strong>æ•´æ•°ç¯çš„é˜¶</strong>å¹¶ä¸æ–¹ä¾¿è®¡ç®—ï¼Œ<code>n</code>è¿˜ä¸æ˜¯<strong>ç´ æ•°</strong>ï¼Œ<code>E.order()</code> <code>sage</code>ä¼šç›´æ¥æŠ¥é”™ï¼Œå› æ­¤å¾—å€ŸåŠ©<code>n</code>çš„<strong>ä¸‰ä¸ªå°ç´ æ•°</strong><code>crt</code>æ¢å¤<code>flag</code></p>
<p>åœ¨<strong>ç´ æ•°åŸŸ</strong>ä¸‹<code>E.lift_x(cc)</code>ä¼šå¾—åˆ°<strong>ä¸¤ä¸ªç‚¹</strong>(åŠ å‚æ•°ï¼š<code>all=True</code>)ï¼Œä½†è¿™é“é¢˜ç›®åªéœ€è¦è€ƒè™‘<strong>æ¨ªåæ ‡x</strong>ï¼Œå› æ­¤<strong>ä»»æ„ä¸€ä¸ªç‚¹</strong>éƒ½å¯ä»¥æ¢å¤<code>flag</code>ï¼Œä¸ç”¨è¿™ä¹ˆéº»çƒ¦</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">15078272222950150537</span></span><br><span class="line">q = <span class="number">16351967803352092039</span></span><br><span class="line">r = <span class="number">14892319684336011143</span></span><br><span class="line">a = <span class="number">196082585826675836</span></span><br><span class="line">b = <span class="number">17207772750460583034</span></span><br><span class="line">e = <span class="number">719</span></span><br><span class="line">cc = <span class="number">2733006338538398832311230797238861624963229236397553282448</span></span><br><span class="line"></span><br><span class="line">E_p = EllipticCurve(GF(p), [a, b])</span><br><span class="line">E_q = EllipticCurve(GF(q), [a, b])</span><br><span class="line">E_r = EllipticCurve(GF(r), [a, b])</span><br><span class="line"></span><br><span class="line">cc_p = cc % p</span><br><span class="line">cc_q = cc % q</span><br><span class="line">cc_r = cc % r</span><br><span class="line"></span><br><span class="line">ct_p = E_p.lift_x(cc_p)</span><br><span class="line">ct_q = E_q.lift_x(cc_q)</span><br><span class="line">ct_r = E_r.lift_x(cc_r)</span><br><span class="line"></span><br><span class="line">ord_p = E_p.order()</span><br><span class="line">ord_q = E_q.order()</span><br><span class="line">ord_r = E_r.order()</span><br><span class="line"></span><br><span class="line">d_p = inverse(e, ord_p)</span><br><span class="line">d_q = inverse(e, ord_q)</span><br><span class="line">d_r = inverse(e, ord_r)</span><br><span class="line"></span><br><span class="line">pt_p = d_p * ct_p</span><br><span class="line">pt_q = d_q * ct_q</span><br><span class="line">pt_r = d_r * ct_r</span><br><span class="line"></span><br><span class="line">x_p = <span class="built_in">int</span>(pt_p[<span class="number">0</span>])</span><br><span class="line">x_q = <span class="built_in">int</span>(pt_q[<span class="number">0</span>])</span><br><span class="line">x_r = <span class="built_in">int</span>(pt_r[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">x = CRT([x_p, x_q, x_r], [p, q, r])</span><br><span class="line">flag = long_to_bytes(x).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># cnss&#123;ECC_is_1mp0r7ant!&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ï¸20ä¸–çºªå°‘å¹´"><a class="markdownIt-Anchor" href="#ï¸20ä¸–çºªå°‘å¹´"></a> â˜€ï¸20ä¸–çºªå°‘å¹´</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG2</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">1024</span>)</span><br><span class="line">e = inverse(p * q, (p - <span class="number">1</span>) * (q - <span class="number">1</span>) * (r - <span class="number">1</span>))</span><br><span class="line">n = p * q * r</span><br><span class="line">d = p + q</span><br><span class="line">m = bytes_to_long(FLAG2)</span><br><span class="line">s = power_mod(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(n))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(e))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;s = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(s))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;d = &#123;&#125;&quot;</span>.<span class="built_in">format</span>(d))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 15460604532082022434447863191746096818395661654297811880153990430863210612174052905555714015509847983227922731985805451566885438246073982317155764958607807463544152653155702577302575656182513381836991406523433266793119819185584376348037239549027416676171243322427349503055393544314474433946388808819598676724602650885133527239213413115146892925897991299204757484271877122801914656196861364799755269353045413845589939222288386263094455792083439269571935284462746834265445496565656118946138440230994554776548484087051061415867095941661099297732697948916320877191187214389659572458105131795310932003795716041528518251941</span></span><br><span class="line"><span class="string">e = 13940114669559785089994553152874911462940185353147358440009590357834922865336404876719637090024264992962184861192638247597372209967459869749194244465260953044000183317893672096208967428126445377096537005168617988464052526406368772412537919110909060208138238030652281948324581646558211129104247037132298412417172744788757010196622920732697739095428731091596465587412712381491216899946004892922552544731485012511684144239855310953043849248672859510381535454364398697606848031134430896051118472429827695939338707989876780783248817638991659244222120749409089321952224619559064398092617057670283889416528439717138717995857</span></span><br><span class="line"><span class="string">s = 14436062168996812757448978634831237229195135681077168433473497830888912794696005628949569566794349552002820680818345145826875735180690372095069427004291147123823010127757927789077150634742490721462494058656713817380439365831415732859543831260752645041568489636069163348097951597380179104599459542104274137394129695774232058230330143354788514163385430667854735092964129335328317784514975463904093605317949683146759250761012903992658965223491078918554276878242413994075346941061182583256569289854517558518297889654324509358209488417569632054635659293200983687292855929334851057163469447744217570357813831833471135699358</span></span><br><span class="line"><span class="string">d = 21350669355110305992341560079027226419143640868010921167513050762215638726238423136488099036393086297496778272900027817220956144964297086100210835932132994</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>å‡ºé¢˜äººè€åäº†ï¼Œç”¨äº†ä¸ª<strong>d=p+q</strong>æ¥è¿·æƒ‘æˆ‘ä»¬ï¼Œè®©æˆ‘ä»¬è§‰å¾—è¿™ç©æ„ä¸€å®šæœ‰ç”¨ï¼Œå®åˆ™ä¸€ç‚¹ç”¨éƒ½æ²¡æœ‰</p>
<p>çœŸæ­£çš„<strong>d=p*q</strong></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>âˆ—</mo><mi>n</mi><mo>â‰¡</mo><mi>e</mi><mo>âˆ—</mo><mi>p</mi><mo>âˆ—</mo><mi>q</mi><mo>âˆ—</mo><mi>r</mi><mo>â‰¡</mo><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>âˆ—</mo><mi>r</mi><mo>â‰¡</mo><mi>r</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">e*n\equiv e*p*q*r\equiv e*d*r\equiv r\pmod {\phi(n)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.6597200000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>e</mi><mo>âˆ—</mo><mi>n</mi></mrow></msup><mo>â‰¡</mo><msup><mn>2</mn><mi>r</mi></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>n</mi><mo stretchy="false">)</mo><mo>â‰¡</mo><mn>2</mn><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2^{e*n}\equiv 2^{r}\pmod n\equiv 2\pmod r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.688696em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>e</mi><mo>âˆ—</mo><mi>n</mi></mrow></msup><mo>âˆ’</mo><mn>2</mn><mo>â‰¡</mo><mn>0</mn><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2^{e*n}-2\equiv 0\pmod r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.772026em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mi>g</mi><mi>c</mi><mi>d</mi><mo stretchy="false">(</mo><msup><mn>2</mn><mrow><mi>e</mi><mo>âˆ—</mo><mi>n</mi></mrow></msup><mo>âˆ’</mo><mn>2</mn><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">r=gcd(2^{e*n}-2,n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">c</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.688696em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mbin mtight">âˆ—</span><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></p>
<p>è‡³äºä¸ºä»€ä¹ˆæœ‰è¿™æ ·çš„æƒ³æ³•ï¼Œè¯·è§<a href="https://hvang10.github.io/2024/09/07/CNSS-Summer-2024-WriteUp/">â›ï¸ é“œåŒ çš„è‰ºæœ¯â… d=p</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">15460604532082022434447863191746096818395661654297811880153990430863210612174052905555714015509847983227922731985805451566885438246073982317155764958607807463544152653155702577302575656182513381836991406523433266793119819185584376348037239549027416676171243322427349503055393544314474433946388808819598676724602650885133527239213413115146892925897991299204757484271877122801914656196861364799755269353045413845589939222288386263094455792083439269571935284462746834265445496565656118946138440230994554776548484087051061415867095941661099297732697948916320877191187214389659572458105131795310932003795716041528518251941</span></span><br><span class="line">e = <span class="number">13940114669559785089994553152874911462940185353147358440009590357834922865336404876719637090024264992962184861192638247597372209967459869749194244465260953044000183317893672096208967428126445377096537005168617988464052526406368772412537919110909060208138238030652281948324581646558211129104247037132298412417172744788757010196622920732697739095428731091596465587412712381491216899946004892922552544731485012511684144239855310953043849248672859510381535454364398697606848031134430896051118472429827695939338707989876780783248817638991659244222120749409089321952224619559064398092617057670283889416528439717138717995857</span></span><br><span class="line">s = <span class="number">14436062168996812757448978634831237229195135681077168433473497830888912794696005628949569566794349552002820680818345145826875735180690372095069427004291147123823010127757927789077150634742490721462494058656713817380439365831415732859543831260752645041568489636069163348097951597380179104599459542104274137394129695774232058230330143354788514163385430667854735092964129335328317784514975463904093605317949683146759250761012903992658965223491078918554276878242413994075346941061182583256569289854517558518297889654324509358209488417569632054635659293200983687292855929334851057163469447744217570357813831833471135699358</span></span><br><span class="line">d = <span class="number">21350669355110305992341560079027226419143640868010921167513050762215638726238423136488099036393086297496778272900027817220956144964297086100210835932132994</span></span><br><span class="line">r = GCD(<span class="built_in">pow</span>(<span class="number">2</span>, e*n, n) - <span class="number">2</span>, n)</span><br><span class="line">pq = n // r</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(s, pq, n)).decode())</span><br><span class="line"><span class="comment"># cnss&#123;Numb3r_the0ry_is_very_1mp0rtan7&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="ï¸æµªå®¢å‰‘å¿ƒ"><a class="markdownIt-Anchor" href="#ï¸æµªå®¢å‰‘å¿ƒ"></a> ğŸ—¡ï¸æµªå®¢å‰‘å¿ƒ</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG5</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(FLAG5)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_key</span>():</span><br><span class="line">    p = getPrime(<span class="number">350</span>)</span><br><span class="line">    q = getPrime(<span class="number">350</span>)</span><br><span class="line">    n = p * q</span><br><span class="line">    e = <span class="number">65537</span></span><br><span class="line">    c = power_mod(flag, e, n)</span><br><span class="line">    <span class="keyword">return</span> c, e, n, p, q</span><br><span class="line"></span><br><span class="line">c, e, n, p, q = get_key()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">cc</span>):</span><br><span class="line">    r = getPrime(<span class="number">1024</span>)</span><br><span class="line">    b = getPrime(<span class="number">1024</span>)</span><br><span class="line">    c = getPrime(<span class="number">400</span>)</span><br><span class="line">    a = (b * cc + c) % (r + <span class="number">114514</span>)</span><br><span class="line">    <span class="keyword">return</span> a, b, r</span><br><span class="line"></span><br><span class="line">a, b, r = encrypt(p)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;r = <span class="subst">&#123;r&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 2314232752348000703811317912334402763615478308933971928710910633640091497393933452660470400460670669229825820726684917641957868679591574569744319470988346467820849084043572349113116939127726604435635412508804749</span></span><br><span class="line"><span class="string">a = 162692322323586802074386952755522700717697316490871403094518723606942744838127063892213054703396812980166290765292703817217786974098504727770137328613222422574338067616547577184493251751000945269866089804886945110012659954353764032840846077267561151860254358914153128169553167447927935668393279891549921838912</span></span><br><span class="line"><span class="string">b = 174674697360208988817251037685496800037103378707423965562910954552671346989439923191189782561262195557901654530734008377543626433846127293265586040655464010300131022932041823292905983528587644255884548112625689263464131538814939442396914807219207412202291863568005684641978513851601172987052988719164013107171</span></span><br><span class="line"><span class="string">r = 178534190472770502696125197412294935081706601609513013480795382874074454502094081633534639367840273482000377953076377575521697726959431607766078248234666603928672996483452614347182842727817578761136718036543157023105731109960369588108444158349734477741554268025459673362430762378211703130821195121993016030039</span></span><br><span class="line"><span class="string">c = 2205748594770191270343865509517182739761150493011420819438179859733956601324122825198415775517884973774371846803243450746740088519056921297474783600678957159078914824495945802451555553013561689047402517932148973</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><code>a = (b * cc + c) % (r + 114514)</code></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å…¶å®æ˜¯ï¼Œ</mtext><mi>a</mi><mo>â‰¡</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mo>+</mo><mi>c</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mn>114514</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">å…¶å®æ˜¯ï¼Œa\equiv b*p+c\pmod{(r+114514)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å…¶</span><span class="mord cjk_fallback">å®</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mord">5</span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<p>è¿™é‡Œå°±<strong>ä¸¤ä¸ªæœªçŸ¥</strong>çš„å˜é‡<code>pc</code><br />
æ­£å¥½ï¼Œ<code>p</code>æ˜¯<code>350ä½</code>ï¼Œ<code>c</code>æ˜¯<code>400ä½</code>ï¼Œè¿˜ç­‰ä»€ä¹ˆå‘¢ï¼Œ<strong>äºŒå…ƒcopper</strong>ç«¯ä¸Šæ¥ï¼Œç›´æ¥ç§’äº†</p>
<p><code>cuso</code>åº”è¯¥ä¹Ÿèƒ½ç›´æ¥å‡º</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">        d = f.degree()</span><br><span class="line"></span><br><span class="line">    R = f.base_ring()</span><br><span class="line">    N = R.cardinality()</span><br><span class="line"></span><br><span class="line">    f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">    f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">    G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m + <span class="number">1</span>):</span><br><span class="line">        base = N ^ (m - i) * f ^ i</span><br><span class="line">        <span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">            g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">            G.append(g)</span><br><span class="line"></span><br><span class="line">    B, monomials = G.coefficient_matrix()</span><br><span class="line">    monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">    factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">    B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">    B = B.change_ring(QQ)</span><br><span class="line">    <span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">        B.rescale_col(i, <span class="number">1</span> / factor)</span><br><span class="line"></span><br><span class="line">    H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B * monomials):</span><br><span class="line">        H.append(h)</span><br><span class="line">        I = H.ideal()</span><br><span class="line">        <span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">            H.pop()</span><br><span class="line">        <span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">            roots = []</span><br><span class="line">            <span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">                root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">                roots.append(root)</span><br><span class="line">            <span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> []</span><br><span class="line"></span><br><span class="line">n = <span class="number">2314232752348000703811317912334402763615478308933971928710910633640091497393933452660470400460670669229825820726684917641957868679591574569744319470988346467820849084043572349113116939127726604435635412508804749</span></span><br><span class="line">a = <span class="number">162692322323586802074386952755522700717697316490871403094518723606942744838127063892213054703396812980166290765292703817217786974098504727770137328613222422574338067616547577184493251751000945269866089804886945110012659954353764032840846077267561151860254358914153128169553167447927935668393279891549921838912</span></span><br><span class="line">b = <span class="number">174674697360208988817251037685496800037103378707423965562910954552671346989439923191189782561262195557901654530734008377543626433846127293265586040655464010300131022932041823292905983528587644255884548112625689263464131538814939442396914807219207412202291863568005684641978513851601172987052988719164013107171</span></span><br><span class="line">r = <span class="number">178534190472770502696125197412294935081706601609513013480795382874074454502094081633534639367840273482000377953076377575521697726959431607766078248234666603928672996483452614347182842727817578761136718036543157023105731109960369588108444158349734477741554268025459673362430762378211703130821195121993016030039</span></span><br><span class="line">c = <span class="number">2205748594770191270343865509517182739761150493011420819438179859733956601324122825198415775517884973774371846803243450746740088519056921297474783600678957159078914824495945802451555553013561689047402517932148973</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">PR.&lt;x,y&gt;=PolynomialRing(Zmod(r + <span class="number">114514</span>))</span><br><span class="line">f = b*x + y - a</span><br><span class="line">res = small_roots(f, (<span class="number">2</span>^<span class="number">350</span>,<span class="number">2</span>^<span class="number">400</span>), m=<span class="number">2</span>, d=<span class="number">3</span>)</span><br><span class="line">p = <span class="built_in">int</span>(res[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">q = n // p</span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># cnss&#123;1at7icEs_1s_7he_f0undAti0n_0f_quan7um_CryPtogrAphy&#125;</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æ—¢ç„¶</mtext><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mtext>æåˆ°äº†æ ¼ï¼Œå°±å†å†™ä¸€ä¸ªæ ¼çš„åšæ³•å§ï¼Œæ­£å¸¸çš„æ ¼å¥½åƒè§„çº¦ä¸å‡ºæ¥ï¼Ÿ</mtext></mrow><annotation encoding="application/x-tex">æ—¢ç„¶flagæåˆ°äº†æ ¼ï¼Œå°±å†å†™ä¸€ä¸ªæ ¼çš„åšæ³•å§ï¼Œæ­£å¸¸çš„æ ¼å¥½åƒè§„çº¦ä¸å‡ºæ¥ï¼Ÿ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">æ—¢</span><span class="mord cjk_fallback">ç„¶</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord cjk_fallback">æ</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">å†</span><span class="mord cjk_fallback">å†™</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">åš</span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">å§</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ­£</span><span class="mord cjk_fallback">å¸¸</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">å¥½</span><span class="mord cjk_fallback">åƒ</span><span class="mord cjk_fallback">è§„</span><span class="mord cjk_fallback">çº¦</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">ï¼Ÿ</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mo>â‰¡</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mo>+</mo><mi>c</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mo stretchy="false">(</mo><mi>r</mi><mo>+</mo><mn>114514</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>ï¼Œè½¬åŒ–ä¸º</mtext><mi>C</mi><mi>V</mi><mi>P</mi><mtext>ï¼Œæœ€è¿‘å‘é‡é—®é¢˜</mtext></mrow><annotation encoding="application/x-tex">a\equiv b*p+c\pmod{(r+114514)}ï¼Œè½¬åŒ–ä¸ºCVPï¼Œæœ€è¿‘å‘é‡é—®é¢˜</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46375em;vertical-align:0em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">â‰¡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mord">5</span><span class="mord">1</span><span class="mord">4</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">è½¬</span><span class="mord cjk_fallback">åŒ–</span><span class="mord cjk_fallback">ä¸º</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">é—®</span><span class="mord cjk_fallback">é¢˜</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å¯ä»¥åˆ©ç”¨</mtext><mi>B</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>i</mi><mtext>æœ€è¿‘å¹³é¢ç®—æ³•ï¼Œæ±‚è§£</mtext><mi>C</mi><mi>V</mi><mi>P</mi></mrow><annotation encoding="application/x-tex">å¯ä»¥åˆ©ç”¨Babaiæœ€è¿‘å¹³é¢ç®—æ³•ï¼Œæ±‚è§£CVP</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">åˆ©</span><span class="mord cjk_fallback">ç”¨</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">a</span><span class="mord mathnormal">i</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">é¢</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">è§£</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä»¤</mtext><mi>m</mi><mo>=</mo><mi>r</mi><mo>+</mo><mn>114514</mn><mtext>ï¼Œæœ‰</mtext><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mi>a</mi><mo>âˆ’</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ä»¤m=r+114514ï¼Œæœ‰c&#x27;=a-b*p\pmod m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä»¤</span><span class="mord mathnormal">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">1</span><span class="mord">4</span><span class="mord">5</span><span class="mord">1</span><span class="mord">4</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æœ‰</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è€ƒè™‘æ‰€æœ‰æ»¡è¶³</mtext><mi>y</mi><mo>=</mo><mo>âˆ’</mo><mi>b</mi><mo>â‹…</mo><mi>x</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo><mtext>çš„æ•´æ•°ç‚¹</mtext><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mtext>åœ¨äºŒç»´å¹³é¢ä¸Šæ„æˆç‚¹é›†ï¼Œç§°ä¹‹ä¸ºæ ¼</mtext><mi>L</mi></mrow><annotation encoding="application/x-tex">è€ƒè™‘æ‰€æœ‰æ»¡è¶³y=-b\cdot x\pmod mçš„æ•´æ•°ç‚¹(x,y)åœ¨äºŒç»´å¹³é¢ä¸Šæ„æˆç‚¹é›†ï¼Œç§°ä¹‹ä¸ºæ ¼L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">è€ƒ</span><span class="mord cjk_fallback">è™‘</span><span class="mord cjk_fallback">æ‰€</span><span class="mord cjk_fallback">æœ‰</span><span class="mord cjk_fallback">æ»¡</span><span class="mord cjk_fallback">è¶³</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ•´</span><span class="mord cjk_fallback">æ•°</span><span class="mord cjk_fallback">ç‚¹</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord cjk_fallback">åœ¨</span><span class="mord cjk_fallback">äºŒ</span><span class="mord cjk_fallback">ç»´</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">é¢</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">æˆ</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç§°</span><span class="mord cjk_fallback">ä¹‹</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">æ ¼</span><span class="mord mathnormal">L</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ç›®æ ‡è§£</mtext><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">)</mo><mtext>æ»¡è¶³</mtext><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo>=</mo><mi>a</mi><mo>âˆ’</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ç›®æ ‡è§£(p,c&#x27;)æ»¡è¶³c&#x27;=a-b*p\pmod m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">ç›®</span><span class="mord cjk_fallback">æ ‡</span><span class="mord cjk_fallback">è§£</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord cjk_fallback">æ»¡</span><span class="mord cjk_fallback">è¶³</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æ»¡è¶³è¿™ä¸ªæ–¹ç¨‹çš„ç‚¹é›†å¯ä»¥ç†è§£ä¸ºï¼Œå°†æ•´ä¸ªæ ¼</mtext><mi>L</mi><mtext>è¿›è¡Œå¹³ç§»</mtext><mo stretchy="false">(</mo><mi>y</mi><mo>+</mo><mi>a</mi><mo stretchy="false">)</mo><mtext>åå¾—åˆ°çš„æ–°ç‚¹é›†</mtext></mrow><annotation encoding="application/x-tex">æ»¡è¶³è¿™ä¸ªæ–¹ç¨‹çš„ç‚¹é›†å¯ä»¥ç†è§£ä¸ºï¼Œå°†æ•´ä¸ªæ ¼Lè¿›è¡Œå¹³ç§»(y+a)åå¾—åˆ°çš„æ–°ç‚¹é›†</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">æ»¡</span><span class="mord cjk_fallback">è¶³</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ–¹</span><span class="mord cjk_fallback">ç¨‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">ç†</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å°†</span><span class="mord cjk_fallback">æ•´</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ ¼</span><span class="mord mathnormal">L</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">ç§»</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">é›†</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ç°åœ¨çš„å‡ ä½•é—®é¢˜è¢«è½¬æ¢ä¸ºï¼Œåœ¨è¿™ä¸ªæ–°ç‚¹é›†ä¸Šæ‰¾åˆ°ç¦»</mtext><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo><mtext>æœ€è¿‘çš„é‚£ä¸ªç‚¹</mtext><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ç°åœ¨çš„å‡ ä½•é—®é¢˜è¢«è½¬æ¢ä¸ºï¼Œåœ¨è¿™ä¸ªæ–°ç‚¹é›†ä¸Šæ‰¾åˆ°ç¦»(0,0)æœ€è¿‘çš„é‚£ä¸ªç‚¹(p,c&#x27;)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">ç°</span><span class="mord cjk_fallback">åœ¨</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å‡ </span><span class="mord cjk_fallback">ä½•</span><span class="mord cjk_fallback">é—®</span><span class="mord cjk_fallback">é¢˜</span><span class="mord cjk_fallback">è¢«</span><span class="mord cjk_fallback">è½¬</span><span class="mord cjk_fallback">æ¢</span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åœ¨</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">é›†</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ç¦»</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">é‚£</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç‚¹</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å…·ä½“ä¸€ç‚¹å°±æ˜¯ï¼Œåœ¨åŸå§‹çš„ã€æœªå¹³ç§»çš„æ ¼</mtext><mi>L</mi><mtext>ä¸­ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ ¼ç‚¹</mtext><mi>v</mi><mtext>ï¼Œä½¿å¾—å®ƒä¸ç›®æ ‡å‘é‡</mtext><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">)</mo><mtext>çš„è·ç¦»âˆ¥</mtext><mi>v</mi><mtext>âˆ’</mtext><mi>t</mi><mtext>âˆ¥æœ€è¿‘</mtext></mrow><annotation encoding="application/x-tex">å…·ä½“ä¸€ç‚¹å°±æ˜¯ï¼Œåœ¨åŸå§‹çš„ã€æœªå¹³ç§»çš„æ ¼Lä¸­ï¼Œæ‰¾åˆ°ä¸€ä¸ªæ ¼ç‚¹vï¼Œä½¿å¾—å®ƒä¸ç›®æ ‡å‘é‡t=(0,-a)çš„è·ç¦»âˆ¥vâˆ’tâˆ¥æœ€è¿‘</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">å…·</span><span class="mord cjk_fallback">ä½“</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">åœ¨</span><span class="mord cjk_fallback">åŸ</span><span class="mord cjk_fallback">å§‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ã€</span><span class="mord cjk_fallback">æœª</span><span class="mord cjk_fallback">å¹³</span><span class="mord cjk_fallback">ç§»</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ ¼</span><span class="mord mathnormal">L</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä½¿</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">å®ƒ</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">ç›®</span><span class="mord cjk_fallback">æ ‡</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è·</span><span class="mord cjk_fallback">ç¦»</span><span class="mord">âˆ¥</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">âˆ’</span><span class="mord mathnormal">t</span><span class="mord">âˆ¥</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">è¿‘</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æˆ‘ä»¬æœŸæœ›æ‰¾åˆ°çš„è¿™ä¸ªæœ€çŸ­çš„å‘é‡</mtext><mi>s</mi><mo>=</mo><mi>v</mi><mtext>âˆ’</mtext><mi>t</mi><mtext>ï¼Œå°±ç­‰äº</mtext><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>c</mi><mtext>â€²</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">æˆ‘ä»¬æœŸæœ›æ‰¾åˆ°çš„è¿™ä¸ªæœ€çŸ­çš„å‘é‡s=vâˆ’tï¼Œå°±ç­‰äº(p,câ€²)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æˆ‘</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">æœŸ</span><span class="mord cjk_fallback">æœ›</span><span class="mord cjk_fallback">æ‰¾</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æœ€</span><span class="mord cjk_fallback">çŸ­</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord">âˆ’</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å°±</span><span class="mord cjk_fallback">ç­‰</span><span class="mord cjk_fallback">äº</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">c</span><span class="mord">â€²</span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mo>âˆ’</mo><mi>b</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mtext>ï¼Œ</mtext><msub><mi>v</mi><mn>2</mn></msub><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v_{1}=(1,-b\pmod m)ï¼Œv_{2}=(0,m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span><span class="mclose">)</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¿™ä¸¤ä¸ªåŸºå‘é‡çº¿æ€§æ— å…³ï¼Œå¯ä»¥æ„é€ å‡ºåŸºçŸ©é˜µ</mtext><mi>M</mi></mrow><annotation encoding="application/x-tex">è¿™ä¸¤ä¸ªåŸºå‘é‡çº¿æ€§æ— å…³ï¼Œå¯ä»¥æ„é€ å‡ºåŸºçŸ©é˜µM</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸¤</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">åŸº</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">æ€§</span><span class="mord cjk_fallback">æ— </span><span class="mord cjk_fallback">å…³</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">é€ </span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">åŸº</span><span class="mord cjk_fallback">çŸ©</span><span class="mord cjk_fallback">é˜µ</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span></p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>M</mi><mtext>Â </mtext><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>âˆ’</mo><mi>b</mi><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>m</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">M
\ =
\left [ \begin{matrix}
1&amp;-b\pmod m\\
0&amp;m\\
\end{matrix} \right ],t=(0,-a)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mspace">Â </span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">âˆ’</span><span class="mord mathnormal">b</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">âˆ’</span><span class="mord mathnormal">a</span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä¸ºäº†å¾—åˆ°ä¸€ä¸ªæ›´ä¼˜çš„ï¼ˆå‘é‡æ›´çŸ­ã€æ›´æ¥è¿‘æ­£äº¤ï¼‰æ ¼åŸºï¼Œä»¤</mtext><mi>L</mi><mo>=</mo><mi>M</mi><mi mathvariant="normal">.</mi><mi>L</mi><mi>L</mi><mi>L</mi><mo stretchy="false">(</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ä¸ºäº†å¾—åˆ°ä¸€ä¸ªæ›´ä¼˜çš„ï¼ˆå‘é‡æ›´çŸ­ã€æ›´æ¥è¿‘æ­£äº¤ï¼‰æ ¼åŸºï¼Œä»¤L=M.LLL()</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä¸º</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">æ›´</span><span class="mord cjk_fallback">ä¼˜</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ï¼ˆ</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord cjk_fallback">æ›´</span><span class="mord cjk_fallback">çŸ­</span><span class="mord cjk_fallback">ã€</span><span class="mord cjk_fallback">æ›´</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">è¿‘</span><span class="mord cjk_fallback">æ­£</span><span class="mord cjk_fallback">äº¤</span><span class="mord cjk_fallback">ï¼‰</span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">åŸº</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä»¤</span><span class="mord mathnormal">L</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="mord">.</span><span class="mord mathnormal">L</span><span class="mord mathnormal">L</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä»¤</mtext><mi>t</mi><mo>=</mo><mi>C</mi><mo>â‹…</mo><mi>L</mi><mtext>ï¼Œç”¨æ¥æ±‚å‘é‡</mtext><mi>t</mi><mtext>åœ¨æ–°åŸº</mtext><mi>L</mi><mtext>ä¸‹çš„åæ ‡</mtext><mi>C</mi></mrow><annotation encoding="application/x-tex">ä»¤t=C\cdot Lï¼Œç”¨æ¥æ±‚å‘é‡tåœ¨æ–°åŸºLä¸‹çš„åæ ‡C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä»¤</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">å‘</span><span class="mord cjk_fallback">é‡</span><span class="mord mathnormal">t</span><span class="mord cjk_fallback">åœ¨</span><span class="mord cjk_fallback">æ–°</span><span class="mord cjk_fallback">åŸº</span><span class="mord mathnormal">L</span><span class="mord cjk_fallback">ä¸‹</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">æ ‡</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¿™ä¸€æ­¥æ˜¯ï¼Œ</mtext><mi>B</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>i</mi><mtext>ç®—æ³•ä¸­è¿›è¡Œåæ ‡ç³»è½¬æ¢çš„æ ¸å¿ƒ</mtext></mrow><annotation encoding="application/x-tex">è¿™ä¸€æ­¥æ˜¯ï¼ŒBabaiç®—æ³•ä¸­è¿›è¡Œåæ ‡ç³»è½¬æ¢çš„æ ¸å¿ƒ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">æ­¥</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mord mathnormal">a</span><span class="mord mathnormal">b</span><span class="mord mathnormal">a</span><span class="mord mathnormal">i</span><span class="mord cjk_fallback">ç®—</span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ä¸­</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">æ ‡</span><span class="mord cjk_fallback">ç³»</span><span class="mord cjk_fallback">è½¬</span><span class="mord cjk_fallback">æ¢</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ ¸</span><span class="mord cjk_fallback">å¿ƒ</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>åˆ™ï¼Œ</mtext><mi>C</mi><mo>=</mo><mi>t</mi><mo>â‹…</mo><msup><mi>L</mi><mrow><mo>âˆ’</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">åˆ™ï¼ŒC=t\cdot L^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">åˆ™</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>å¯¹</mtext><msub><mi>C</mi><mi>i</mi></msub><mtext>å››èˆäº”å…¥è¿›è¡Œå–æ•´å¾—åˆ°ï¼Œ</mtext><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">[</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">å¯¹C_{i}å››èˆäº”å…¥è¿›è¡Œå–æ•´å¾—åˆ°ï¼ŒZ_{i}=[C_{i}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">å¯¹</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">å››</span><span class="mord cjk_fallback">èˆ</span><span class="mord cjk_fallback">äº”</span><span class="mord cjk_fallback">å…¥</span><span class="mord cjk_fallback">è¿›</span><span class="mord cjk_fallback">è¡Œ</span><span class="mord cjk_fallback">å–</span><span class="mord cjk_fallback">æ•´</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>æ ¼ç‚¹</mtext><mi>v</mi><mo>=</mo><mi>Z</mi><mo>â‹…</mo><mi>L</mi></mrow><annotation encoding="application/x-tex">æ ¼ç‚¹v=Z\cdot L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">æ ¼</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">Z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">â‹…</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">L</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mo>=</mo><mi>v</mi><mo>âˆ’</mo><mi>t</mi><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo>âˆ’</mo><mn>0</mn><mo separator="true">,</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mo stretchy="false">)</mo><mo>âˆ’</mo><mo stretchy="false">(</mo><mo>âˆ’</mo><mi>a</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><mi>a</mi><mo>âˆ’</mo><mi>b</mi><mo>âˆ—</mo><mi>p</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>p</mi><mo separator="true">,</mo><msup><mi>c</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>m</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s=v-t=(p-0,(-b*p)-(-a))=(p,a-b*p)=(p,c&#x27;)\pmod m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">âˆ’</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">m</span><span class="mclose">)</span></span></span></span></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n = <span class="number">2314232752348000703811317912334402763615478308933971928710910633640091497393933452660470400460670669229825820726684917641957868679591574569744319470988346467820849084043572349113116939127726604435635412508804749</span></span><br><span class="line">a = <span class="number">162692322323586802074386952755522700717697316490871403094518723606942744838127063892213054703396812980166290765292703817217786974098504727770137328613222422574338067616547577184493251751000945269866089804886945110012659954353764032840846077267561151860254358914153128169553167447927935668393279891549921838912</span></span><br><span class="line">b = <span class="number">174674697360208988817251037685496800037103378707423965562910954552671346989439923191189782561262195557901654530734008377543626433846127293265586040655464010300131022932041823292905983528587644255884548112625689263464131538814939442396914807219207412202291863568005684641978513851601172987052988719164013107171</span></span><br><span class="line">r = <span class="number">178534190472770502696125197412294935081706601609513013480795382874074454502094081633534639367840273482000377953076377575521697726959431607766078248234666603928672996483452614347182842727817578761136718036543157023105731109960369588108444158349734477741554268025459673362430762378211703130821195121993016030039</span></span><br><span class="line">c = <span class="number">2205748594770191270343865509517182739761150493011420819438179859733956601324122825198415775517884973774371846803243450746740088519056921297474783600678957159078914824495945802451555553013561689047402517932148973</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = r + <span class="number">114514</span></span><br><span class="line">M = Matrix(ZZ, [[<span class="number">1</span>, -b % m], [<span class="number">0</span>, m]])</span><br><span class="line">L = M.LLL()</span><br><span class="line">t = vector(ZZ, [<span class="number">0</span>, -a])</span><br><span class="line">C = t * L.inverse()</span><br><span class="line">Z = vector([<span class="built_in">round</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> C])</span><br><span class="line">v = Z * L</span><br><span class="line">s = v - t</span><br><span class="line">p = s[<span class="number">0</span>]</span><br><span class="line">q = n // p</span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line">flag = long_to_bytes(<span class="built_in">int</span>(<span class="built_in">pow</span>(c, d, n))).decode()</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h2 id="æ£’çƒè‹±è±ª"><a class="markdownIt-Anchor" href="#æ£’çƒè‹±è±ª"></a> ğŸ§¢æ£’çƒè‹±è±ª</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag6, Curve</span><br><span class="line"></span><br><span class="line">c, d, p = Curve</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">P</span>):</span><br><span class="line">    u, v = P</span><br><span class="line">    <span class="keyword">return</span> (u**<span class="number">2</span> + v**<span class="number">2</span> - c**<span class="number">2</span> * (<span class="number">1</span> + d * u**<span class="number">2</span>*v**<span class="number">2</span>)) % p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">P, Q</span>):</span><br><span class="line">    u1, v1 = P</span><br><span class="line">    u2, v2 = Q</span><br><span class="line">    u3 = (u1 * v2 + v1 * u2) * inverse(c * (<span class="number">1</span> + d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    v3 = (v1 * v2 - u1 * u2) * inverse(c * (<span class="number">1</span> - d * u1 * u2 * v1 * v2), p) % p</span><br><span class="line">    <span class="keyword">return</span> (<span class="built_in">int</span>(u3), <span class="built_in">int</span>(v3))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mul</span>(<span class="params">m, P</span>):</span><br><span class="line">    x, y = P</span><br><span class="line">    PP = (-x, y)</span><br><span class="line">    O = add( P, PP)</span><br><span class="line">    <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> O</span><br><span class="line">    <span class="keyword">elif</span> m == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> P</span><br><span class="line">    Q = O</span><br><span class="line">    B = <span class="built_in">bin</span>(m)[<span class="number">2</span>:]</span><br><span class="line">    l = <span class="built_in">len</span>(B)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">        Q = add(Q, Q)</span><br><span class="line">        <span class="keyword">if</span> B[i] == <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">            Q = add(Q, P)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Q</span><br><span class="line"></span><br><span class="line">flag = flag6.lstrip(<span class="string">b&#x27;cnss&#123;&#x27;</span>).rstrip(<span class="string">b&#x27;&#125;&#x27;</span>)</span><br><span class="line">l = <span class="built_in">len</span>(flag)</span><br><span class="line">lef, rig = flag[:l // <span class="number">2</span>], flag[l // <span class="number">2</span>:]</span><br><span class="line">s, t = bytes_to_long(lef), bytes_to_long(rig)</span><br><span class="line"><span class="keyword">assert</span> s &lt; p <span class="keyword">and</span> t &lt; p</span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output6.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">f&#x27;P = <span class="subst">&#123;P&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;Q = <span class="subst">&#123;Q&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;verify(P) = <span class="subst">&#123;verify(P)&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;verify(Q) = <span class="subst">&#123;verify(Q)&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;s * P = <span class="subst">&#123;mul(s, P)&#125;</span>\n&#x27;</span>)</span><br><span class="line">    f.write(<span class="string">f&#x27;t * Q = <span class="subst">&#123;mul(t, Q)&#125;</span>\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">P = (398011447251267732058427934569710020713094, 548950454294712661054528329798266699762662)</span></span><br><span class="line"><span class="string">Q = (139255151342889674616838168412769112246165, 649791718379009629228240558980851356197207)</span></span><br><span class="line"><span class="string">verify(P) = True</span></span><br><span class="line"><span class="string">verify(Q) = True</span></span><br><span class="line"><span class="string">s * P = (298889479660508029507606377651920486175404, 410507058136886341368140950580892999564994)</span></span><br><span class="line"><span class="string">t * Q = (443179850165927025618537423492534098031604, 364123198944392695945329998024386893104420)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mn>2</mn></msup><mo>+</mo><msup><mi>v</mi><mn>2</mn></msup><mo>=</mo><msup><mi>c</mi><mn>2</mn></msup><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>d</mi><mo>âˆ—</mo><msup><mi>u</mi><mn>2</mn></msup><mo>âˆ—</mo><msup><mi>v</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">u^2+v^2=c^2(1+d*u^2*v^2)\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä¸¤è¾¹åŒæ—¶é™¤ä»¥</mtext><msup><mi>c</mi><mn>2</mn></msup><mtext>ï¼Œ</mtext><mi>u</mi><mo>=</mo><mi>c</mi><mo>âˆ—</mo><mi>x</mi><mtext>ï¼Œæ•´ç†å¾—åˆ°</mtext></mrow><annotation encoding="application/x-tex">ä¸¤è¾¹åŒæ—¶é™¤ä»¥c^2ï¼Œu=c*xï¼Œæ•´ç†å¾—åˆ°</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä¸¤</span><span class="mord cjk_fallback">è¾¹</span><span class="mord cjk_fallback">åŒ</span><span class="mord cjk_fallback">æ—¶</span><span class="mord cjk_fallback">é™¤</span><span class="mord cjk_fallback">ä»¥</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal">u</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ•´</span><span class="mord cjk_fallback">ç†</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>+</mo><mo stretchy="false">(</mo><mi>d</mi><msup><mi>c</mi><mn>4</mn></msup><mo stretchy="false">)</mo><mo>âˆ—</mo><msup><mi>x</mi><mn>2</mn></msup><mo>âˆ—</mo><msup><mi>y</mi><mn>2</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^2+y^2=1+(dc^4)*x^2*y^2\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">d</span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>+</mo><msup><mi>d</mi><mo mathvariant="normal" lspace="0em" rspace="0em">â€²</mo></msup><msup><mi>x</mi><mn>2</mn></msup><msup><mi>y</mi><mn>2</mn></msup><mspace></mspace><mspace width="0.4444444444444444em"/><mo stretchy="false">(</mo><mrow><mi mathvariant="normal">m</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">d</mi></mrow><mspace width="0.3333333333333333em"/><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x^2+y^2=1+d&#x27;x^2y^2\pmod p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">â€²</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace allowbreak"></span><span class="mspace" style="margin-right:0.4444444444444444em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord mathrm">m</span><span class="mord mathrm">o</span><span class="mord mathrm">d</span></span></span><span class="mspace" style="margin-right:0.3333333333333333em;"></span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>é€šè¿‡ç¼©æ”¾å¯ä»¥è½¬æ¢å¾—åˆ°ï¼Œæ ‡å‡†çš„æ‰­æ›²çˆ±å¾·åå…¹æ›²çº¿</mtext></mrow><annotation encoding="application/x-tex">é€šè¿‡ç¼©æ”¾å¯ä»¥è½¬æ¢å¾—åˆ°ï¼Œæ ‡å‡†çš„æ‰­æ›²çˆ±å¾·åå…¹æ›²çº¿</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">ç¼©</span><span class="mord cjk_fallback">æ”¾</span><span class="mord cjk_fallback">å¯</span><span class="mord cjk_fallback">ä»¥</span><span class="mord cjk_fallback">è½¬</span><span class="mord cjk_fallback">æ¢</span><span class="mord cjk_fallback">å¾—</span><span class="mord cjk_fallback">åˆ°</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ ‡</span><span class="mord cjk_fallback">å‡†</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ‰­</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çˆ±</span><span class="mord cjk_fallback">å¾·</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å…¹</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çº¿</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¿™é‡Œçš„åŠ æ³•å±äºæ‰­æ›²çˆ±å¾·åå…¹æ›²çº¿ä¸Šçš„åŠ æ³•ï¼Œä¸æ™®é€šçš„æ›²çº¿åŠ æ³•ç›¸æ¯”å¤šä¹˜äº†ä¸€ä¸ª</mtext><mi>c</mi></mrow><annotation encoding="application/x-tex">è¿™é‡Œçš„åŠ æ³•å±äºæ‰­æ›²çˆ±å¾·åå…¹æ›²çº¿ä¸Šçš„åŠ æ³•ï¼Œä¸æ™®é€šçš„æ›²çº¿åŠ æ³•ç›¸æ¯”å¤šä¹˜äº†ä¸€ä¸ªc</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é‡Œ</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">åŠ </span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">å±</span><span class="mord cjk_fallback">äº</span><span class="mord cjk_fallback">æ‰­</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çˆ±</span><span class="mord cjk_fallback">å¾·</span><span class="mord cjk_fallback">å</span><span class="mord cjk_fallback">å…¹</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">åŠ </span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">æ™®</span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">åŠ </span><span class="mord cjk_fallback">æ³•</span><span class="mord cjk_fallback">ç›¸</span><span class="mord cjk_fallback">æ¯”</span><span class="mord cjk_fallback">å¤š</span><span class="mord cjk_fallback">ä¹˜</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">ä¸€</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord mathnormal">c</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mtext>Â </mtext><mi>Q</mi><mtext>Â </mtext><mi>s</mi><mo>âˆ—</mo><mi>P</mi><mtext>Â </mtext><mi>t</mi><mo>âˆ—</mo><mi>Q</mi><mtext>éƒ½æ˜¯æ›²çº¿ä¸Šçš„ç‚¹ï¼Œé€šè¿‡è¿™å››ä¸ªç‚¹æ¢å¤</mtext><mo stretchy="false">(</mo><mi>p</mi><mtext>Â </mtext><mi>c</mi><mtext>Â </mtext><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P\ Q\ s*P\ t*Qéƒ½æ˜¯æ›²çº¿ä¸Šçš„ç‚¹ï¼Œé€šè¿‡è¿™å››ä¸ªç‚¹æ¢å¤(p\ c\ d)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace">Â </span><span class="mord mathnormal">Q</span><span class="mspace">Â </span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace">Â </span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Q</span><span class="mord cjk_fallback">éƒ½</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">æ›²</span><span class="mord cjk_fallback">çº¿</span><span class="mord cjk_fallback">ä¸Š</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">é€š</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">å››</span><span class="mord cjk_fallback">ä¸ª</span><span class="mord cjk_fallback">ç‚¹</span><span class="mord cjk_fallback">æ¢</span><span class="mord cjk_fallback">å¤</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace">Â </span><span class="mord mathnormal">c</span><span class="mspace">Â </span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></p>
<blockquote>
<p>å…·ä½“æ¨å¯¼åŸç†å‚è€ƒåšå®¢(é‡Œé¢å·²ç»å¾ˆè¯¦ç»†äº†)ï¼š<br />
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/mumuhhh/p/18019200">https://www.cnblogs.com/mumuhhh/p/18019200</a><br />
<a target="_blank" rel="noopener" href="https://tangcuxiaojikuai.xyz/post/678d5ec.html">https://tangcuxiaojikuai.xyz/post/678d5ec.html</a></p>
</blockquote>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¿™é‡Œæ±‚å‡ºæ¥çš„</mtext><mi>p</mi><mtext>éœ€è¦é™¤</mtext><mn>2</mn><mtext>æ‰èƒ½æ˜¯ç´ æ•°</mtext></mrow><annotation encoding="application/x-tex">è¿™é‡Œæ±‚å‡ºæ¥çš„péœ€è¦é™¤2æ‰èƒ½æ˜¯ç´ æ•°</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é‡Œ</span><span class="mord cjk_fallback">æ±‚</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">çš„</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">éœ€</span><span class="mord cjk_fallback">è¦</span><span class="mord cjk_fallback">é™¤</span><span class="mord">2</span><span class="mord cjk_fallback">æ‰</span><span class="mord cjk_fallback">èƒ½</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ç´ </span><span class="mord cjk_fallback">æ•°</span></span></span></span></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">happy</span>(<span class="params">C, P</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Verification points are on the curve</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    c, d, p = C</span><br><span class="line">    u, v = P</span><br><span class="line">    <span class="keyword">return</span> (u**<span class="number">2</span> + v**<span class="number">2</span> - cc * (<span class="number">1</span> + d * u**<span class="number">2</span>*v**<span class="number">2</span>)) % p == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">a_and_b</span>(<span class="params">u1,u2,v1,v2</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Helper function used to simplify calculations</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a12 = u1**<span class="number">2</span> - u2**<span class="number">2</span> + v1**<span class="number">2</span> - v2**<span class="number">2</span></span><br><span class="line">    b12 = u1**<span class="number">2</span> * v1**<span class="number">2</span> - u2**<span class="number">2</span> * v2**<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> a12, b12</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_modulus</span>(<span class="params">u1,u2,u3,u4,v1,v2,v3,v4</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Compute the modulus from four points</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a12, b12 = a_and_b(u1,u2,v1,v2)</span><br><span class="line">    a13, b13 = a_and_b(u1,u3,v1,v3)</span><br><span class="line">    a23, b23 = a_and_b(u2,u3,v2,v3)</span><br><span class="line">    a24, b24 = a_and_b(u2,u4,v2,v4)</span><br><span class="line"></span><br><span class="line">    p_almost = gcd(a12*b13 - a13*b12, a23*b24 - a24*b23)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">if</span> p_almost % i == <span class="number">0</span>:</span><br><span class="line">            p_almost = p_almost // i</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> p_almost</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">c_sq_d</span>(<span class="params">u1,u2,v1,v2,p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Helper function to computer c^2 d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    a1,b1 = a_and_b(u1,u2,v1,v2)</span><br><span class="line">    <span class="keyword">return</span> a1 * <span class="built_in">pow</span>(b1,-<span class="number">1</span>,p) % p</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">c</span>(<span class="params">u1,u2,v1,v2,p</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Compute c^2, d from two points and known modulus</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    ccd = c_sq_d(u1,u2,v1,v2,p)</span><br><span class="line">    cc = (u1**<span class="number">2</span> + v1**<span class="number">2</span> - ccd*u1**<span class="number">2</span>*v1**<span class="number">2</span>) % p</span><br><span class="line">    d = ccd * <span class="built_in">pow</span>(cc, -<span class="number">1</span>, p) % p</span><br><span class="line">    <span class="keyword">return</span> cc, d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">P = (<span class="number">398011447251267732058427934569710020713094</span>, <span class="number">548950454294712661054528329798266699762662</span>)</span><br><span class="line">Q = (<span class="number">139255151342889674616838168412769112246165</span>, <span class="number">649791718379009629228240558980851356197207</span>)</span><br><span class="line">sP = (<span class="number">298889479660508029507606377651920486175404</span>, <span class="number">410507058136886341368140950580892999564994</span>)</span><br><span class="line">tQ = (<span class="number">443179850165927025618537423492534098031604</span>, <span class="number">364123198944392695945329998024386893104420</span>)</span><br><span class="line"></span><br><span class="line">u1, v1 = P</span><br><span class="line">u2, v2 = Q</span><br><span class="line">u3, v3 = sP</span><br><span class="line">u4, v4 = tQ</span><br><span class="line"></span><br><span class="line">p = find_modulus(u1,u2,u3,u4,v1,v2,v3,v4) // <span class="number">2</span></span><br><span class="line">cc, d = c(u1,u2,v1,v2,p)</span><br><span class="line"></span><br><span class="line">C = cc, d, p</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> happy(C, P)</span><br><span class="line"><span class="keyword">assert</span> happy(C, Q)</span><br><span class="line"><span class="keyword">assert</span> happy(C, sP)</span><br><span class="line"><span class="keyword">assert</span> happy(C, tQ)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Found curve parameters&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c^2 = <span class="subst">&#123;cc&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;d = <span class="subst">&#123;d&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">F = GF(p)</span><br><span class="line">c = F(cc).sqrt()</span><br><span class="line"></span><br><span class="line">x1, y1 = P</span><br><span class="line">x2, y2 = Q</span><br><span class="line">x3, y3 = sP</span><br><span class="line">x4, y4 = tQ</span><br><span class="line"></span><br><span class="line">R.&lt;x,y&gt; = PolynomialRing(F)</span><br><span class="line">g = (x^<span class="number">2</span> + y^<span class="number">2</span> - cc * (<span class="number">1</span> + d * x^<span class="number">2</span>*y^<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check the mapping worked!</span></span><br><span class="line"><span class="keyword">assert</span> g(x=x1, y=y1) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> g(x=x2, y=y2) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> g(x=x3, y=y3) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> g(x=x4, y=y4) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Scale: x,y,d to remove c:</span></span><br><span class="line"><span class="comment"># x^2 + y^2 = c^2 * (1 + d * x^2*y^2)</span></span><br><span class="line"><span class="comment"># to:</span></span><br><span class="line"><span class="comment"># x^2 + y^2 = (1 + d * x^2*y^2)</span></span><br><span class="line"></span><br><span class="line">d = F(d) * F(cc)^<span class="number">2</span></span><br><span class="line">x1, y1 = F(x1) / F(c),  F(y1) / F(c)</span><br><span class="line">x2, y2 = F(x2) / F(c),  F(y2) / F(c)</span><br><span class="line">x3, y3 = F(x3) / F(c),  F(y3) / F(c)</span><br><span class="line">x4, y4 = F(x4) / F(c),  F(y4) / F(c)</span><br><span class="line"></span><br><span class="line">h = (x^<span class="number">2</span> + y^<span class="number">2</span> - (<span class="number">1</span> + d * x^<span class="number">2</span>*y^<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check the mapping worked!</span></span><br><span class="line"><span class="keyword">assert</span> h(x=x1, y=y1) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> h(x=x2, y=y2) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> h(x=x3, y=y3) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> h(x=x4, y=y4) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert from Edwards to Mont. </span></span><br><span class="line"><span class="comment"># https://safecurves.cr.yp.to/equation.html</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ed_to_mont</span>(<span class="params">x,y</span>):</span><br><span class="line">    u = F(<span class="number">1</span> + y) / F(<span class="number">1</span> - y)</span><br><span class="line">    v = <span class="number">2</span>*F(<span class="number">1</span> + y) / F(x*(<span class="number">1</span> - y))</span><br><span class="line">    <span class="keyword">return</span> u,v</span><br><span class="line"></span><br><span class="line">u1, v1 = ed_to_mont(x1, y1)</span><br><span class="line">u2, v2 = ed_to_mont(x2, y2)</span><br><span class="line">u3, v3 = ed_to_mont(x3, y3)</span><br><span class="line">u4, v4 = ed_to_mont(x4, y4)</span><br><span class="line"></span><br><span class="line">e_curve = <span class="number">1</span> - F(d)</span><br><span class="line">A = (<span class="number">4</span>/e_curve - <span class="number">2</span>)</span><br><span class="line">B = (<span class="number">1</span>/e_curve)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mont. curve: Bv^2 = u^3 + Au^2 + u</span></span><br><span class="line">R.&lt;u,v&gt; = PolynomialRing(ZZ)</span><br><span class="line">f = B*v^<span class="number">2</span> - u^<span class="number">3</span> - A* u^<span class="number">2</span> - u</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check the mapping worked!</span></span><br><span class="line"><span class="keyword">assert</span> f(u=u1, v=v1) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> f(u=u2, v=v2) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> f(u=u3, v=v3) == <span class="number">0</span></span><br><span class="line"><span class="keyword">assert</span> f(u=u4, v=v4) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert from Mont. to Weierstrass</span></span><br><span class="line"><span class="comment"># https://en.wikipedia.org/wiki/Montgomery_curve</span></span><br><span class="line">a = F(<span class="number">3</span> - A^<span class="number">2</span>) / F(<span class="number">3</span>*B^<span class="number">2</span>)</span><br><span class="line">b = (<span class="number">2</span>*A^<span class="number">3</span> - <span class="number">9</span>*A) / F(<span class="number">27</span>*B^<span class="number">3</span>)</span><br><span class="line">E = EllipticCurve(F, [a,b])</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://en.wikipedia.org/wiki/Montgomery_curve</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mont_to_wei</span>(<span class="params">u,v</span>):</span><br><span class="line">    t = (F(u) / F(B)) + (F(A) / F(<span class="number">3</span>*B))</span><br><span class="line">    s = (F(v) / F(B))</span><br><span class="line">    <span class="keyword">return</span> t,s</span><br><span class="line"></span><br><span class="line">X1, Y1 = mont_to_wei(u1, v1)</span><br><span class="line">X2, Y2 = mont_to_wei(u2, v2)</span><br><span class="line">X3, Y3 = mont_to_wei(u3, v3)</span><br><span class="line">X4, Y4 = mont_to_wei(u4, v4)</span><br><span class="line"></span><br><span class="line">P = E(X1, Y1)</span><br><span class="line">Q = E(X2, Y2)</span><br><span class="line">sP = E(X3, Y3)</span><br><span class="line">tQ = E(X4, Y4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Finally we can solve the dlog</span></span><br><span class="line">s = sP.log(P)</span><br><span class="line">t = tQ.log(Q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># We have to do this, as we picked the wrong square-root.</span></span><br><span class="line">flag1 = long_to_bytes(s % Q.order()).decode()</span><br><span class="line">flag2 = long_to_bytes(t).decode()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;cnss&#123;&quot;</span> + flag1 + flag2 + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"><span class="comment"># cnss&#123;CurVes_haS_many_u8u5ua1_F0rms&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="rewrite"><a class="markdownIt-Anchor" href="#rewrite"></a> ğŸŒRewrite*</h2>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">inf = -<span class="number">1</span></span><br><span class="line">Point = namedtuple(<span class="string">&#x27;Point&#x27;</span>, [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>])</span><br><span class="line">Pubkey = namedtuple(<span class="string">&#x27;Pubkey&#x27;</span>, [<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;r&#x27;</span>])</span><br><span class="line">Privkey = namedtuple(<span class="string">&#x27;Privkey&#x27;</span>, [<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;d&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Curve</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">genkey</span>(<span class="params">self, nbits, dbits</span>):</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            p = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">if</span>(p % <span class="number">3</span> == <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            q = getPrime(nbits // <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">if</span>(q % <span class="number">3</span> == <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        n = p * q</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            r = getRandomRange(<span class="number">1</span>,n)</span><br><span class="line">            <span class="keyword">if</span>((<span class="built_in">pow</span>(r, (p-<span class="number">1</span>)//<span class="number">3</span>, p) != <span class="number">1</span>) <span class="keyword">and</span> (<span class="built_in">pow</span>(r, (q-<span class="number">1</span>)//<span class="number">3</span>, q) != <span class="number">1</span>)):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        d = getPrime(dbits)</span><br><span class="line">        e = inverse(d, (p * p + p + <span class="number">1</span>) * (q * q + q + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> Pubkey(n, e, r), Privkey(p, q, d)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, nbits, dbits</span>):</span><br><span class="line">        self.Pubkey, self.Privkey = self.genkey(nbits, dbits)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">product</span>(<span class="params">self, a, b</span>):</span><br><span class="line">        n, _, r = self.Pubkey</span><br><span class="line">        <span class="keyword">if</span>(a == Point(inf, inf)):</span><br><span class="line">            <span class="keyword">return</span> b</span><br><span class="line">        <span class="keyword">if</span>(b == Point(inf, inf)):</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">if</span>(a.y == inf):</span><br><span class="line">            a, b = b, a</span><br><span class="line">        u, v = a</span><br><span class="line">        p, q = b</span><br><span class="line">        <span class="keyword">if</span>(q == inf):</span><br><span class="line">            <span class="keyword">if</span>(v == inf):</span><br><span class="line">                <span class="keyword">return</span> Point((u * p) % n, (u + p) % n)</span><br><span class="line">            <span class="keyword">elif</span>((v + p) % n):</span><br><span class="line">                iv = inverse(v + p, n)</span><br><span class="line">                <span class="keyword">return</span> Point((u * p + r) * iv % n, (u + v * p) * iv % n)</span><br><span class="line">            <span class="keyword">elif</span>((u - v * v) % n):</span><br><span class="line">                iv = inverse(u - v * v, n) </span><br><span class="line">                <span class="keyword">return</span> Point((u * p + r) * iv % n, inf)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> Point(inf, inf)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span>((u + p + v * q) % n):</span><br><span class="line">                iv = inverse(u + p + v * q, n)</span><br><span class="line">                <span class="keyword">return</span> Point((u * p + (v + q) * r) * iv % n, (v * p + u * q + r) * iv % n)</span><br><span class="line">            <span class="keyword">elif</span>((v * p + u * q + r) % n):</span><br><span class="line">                iv = inverse(v * p + u * q + r, n)</span><br><span class="line">                <span class="keyword">return</span> Point((u * p + (v + q) * r) * iv % n, inf)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> Point(inf, inf)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">self, a</span>):</span><br><span class="line">        k = self.Pubkey.e</span><br><span class="line">        res = Point(inf, inf)</span><br><span class="line">        <span class="keyword">while</span> k:</span><br><span class="line">            <span class="keyword">if</span>(k &amp; <span class="number">1</span>):</span><br><span class="line">                res = self.product(res, a)</span><br><span class="line">            a = self.product(a, a)</span><br><span class="line">            k &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">self, a</span>):</span><br><span class="line">        k = self.Privkey.d</span><br><span class="line">        res = Point(inf, inf)</span><br><span class="line">        <span class="keyword">while</span> k:</span><br><span class="line">            <span class="keyword">if</span>(k &amp; <span class="number">1</span>):</span><br><span class="line">                res = self.product(res, a)</span><br><span class="line">            a = self.product(a, a)</span><br><span class="line">            k &gt;&gt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line">SYS = Curve(<span class="number">512</span>, <span class="number">256</span>)</span><br><span class="line">msg = Point(bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]),bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]))</span><br><span class="line">enc = SYS.encrypt(msg)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;pubkey = <span class="subst">&#123;SYS.Pubkey&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;enc = <span class="subst">&#123;enc&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">pubkey = Pubkey(n=4873189510606632670051462507037860421077551672164701436608907002436560192840356016750494285565924106988544952397402675547921930867836902302893011890256779, e=13378485234962864327763969254924381829836619219064695812825856516258702951436596931331119028308233868359134774242758549790397497067433124687542530097719178781601238604579006713726763589993220493028013459103929256891706082648574000763659034977028816094438365563682368664776491208827662655323646975736791610283, r=12276290027089634179666721556762461660058574159904682072699747683370547320796053531346228587347389593630764829928291692127976550810879034430985232250912)</span></span><br><span class="line"><span class="string">enc = Point(x=2091733356436558288163136748650604712672684547651742349852169921359344595959145998331036292720052611932763413100160720842985758067666744134352011068441384, y=3606887286200111465466487525784448417643735862168228528263397534620187006806130329379762200338558634931139253300267143260393005244954232632353514520202318)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯è¿™é¢˜å•Š</mtext></mrow><annotation encoding="application/x-tex">ä¸æ˜¯å“¥ä»¬ï¼Œæ€ä¹ˆè¿˜æ˜¯è¿™é¢˜å•Š</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">å“¥</span><span class="mord cjk_fallback">ä»¬</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">æ€</span><span class="mord cjk_fallback">ä¹ˆ</span><span class="mord cjk_fallback">è¿˜</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">è¿™</span><span class="mord cjk_fallback">é¢˜</span><span class="mord cjk_fallback">å•Š</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Ï•</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msup><mi>p</mi><mn>2</mn></msup><mo>+</mo><mi>p</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ—</mo><mo stretchy="false">(</mo><msup><mi>q</mi><mn>2</mn></msup><mo>+</mo><mi>q</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\phi(n)=(p^2+p+1)*(q^2+q+1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">Ï•</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mtext>æ˜¯ç”¨æ¥æ„é€ ä¸‰æ¬¡æ‰©åŸŸçš„ï¼Œè²Œä¼¼ä¸éœ€è¦ä½¿ç”¨åˆ°</mtext><mo stretchy="false">(</mo><mo stretchy="false">?</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ræ˜¯ç”¨æ¥æ„é€ ä¸‰æ¬¡æ‰©åŸŸçš„ï¼Œè²Œä¼¼ä¸éœ€è¦ä½¿ç”¨åˆ°(?)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord cjk_fallback">æ˜¯</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">æ„</span><span class="mord cjk_fallback">é€ </span><span class="mord cjk_fallback">ä¸‰</span><span class="mord cjk_fallback">æ¬¡</span><span class="mord cjk_fallback">æ‰©</span><span class="mord cjk_fallback">åŸŸ</span><span class="mord cjk_fallback">çš„</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">è²Œ</span><span class="mord cjk_fallback">ä¼¼</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">éœ€</span><span class="mord cjk_fallback">è¦</span><span class="mord cjk_fallback">ä½¿</span><span class="mord cjk_fallback">ç”¨</span><span class="mord cjk_fallback">åˆ°</span><span class="mopen">(</span><span class="mclose">?</span><span class="mclose">)</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>ä»¤</mtext><mi>x</mi><mo>=</mo><mi>p</mi><mo>+</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">ä»¤x=p+q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">ä»¤</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mo>âˆ—</mo><mi>d</mi><mo>=</mo><mi>k</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mi>x</mi><mo>âˆ—</mo><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>âˆ’</mo><mi>n</mi><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e*d=k*(n^2+x*(x+n+1)-n+1)+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.46528em;vertical-align:0em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ—</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><msup><mn>2</mn><mn>250</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>256</mn></msup><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>x</mi><mo>âˆˆ</mo><mo stretchy="false">[</mo><msup><mn>2</mn><mn>256</mn></msup><mo separator="true">,</mo><msup><mn>2</mn><mn>257</mn></msup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">k\in [2^{250},2^{256}],x\in [2^{256},2^{257}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">5</span><span class="mord mtight">7</span></span></span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span><br />
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>è¯´å®è¯ï¼ŒäºŒå…ƒ</mtext><mi>c</mi><mi>o</mi><mi>p</mi><mi>p</mi><mi>e</mi><mi>r</mi><mtext>ä¹Ÿæ‰“äº†ï¼Œ</mtext><mi>c</mi><mi>u</mi><mi>s</mi><mi>o</mi><mtext>ä¹Ÿè¯•è¿‡äº†ï¼ŒçœŸè§£ä¸å‡ºæ¥å•Šã€‚ã€‚ã€‚</mtext></mrow><annotation encoding="application/x-tex">è¯´å®è¯ï¼ŒäºŒå…ƒcopperä¹Ÿæ‰“äº†ï¼Œcusoä¹Ÿè¯•è¿‡äº†ï¼ŒçœŸè§£ä¸å‡ºæ¥å•Šã€‚ã€‚ã€‚</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">è¯´</span><span class="mord cjk_fallback">å®</span><span class="mord cjk_fallback">è¯</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">äºŒ</span><span class="mord cjk_fallback">å…ƒ</span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">p</span><span class="mord mathnormal">p</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord cjk_fallback">ä¹Ÿ</span><span class="mord cjk_fallback">æ‰“</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord mathnormal">c</span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">o</span><span class="mord cjk_fallback">ä¹Ÿ</span><span class="mord cjk_fallback">è¯•</span><span class="mord cjk_fallback">è¿‡</span><span class="mord cjk_fallback">äº†</span><span class="mord cjk_fallback">ï¼Œ</span><span class="mord cjk_fallback">çœŸ</span><span class="mord cjk_fallback">è§£</span><span class="mord cjk_fallback">ä¸</span><span class="mord cjk_fallback">å‡º</span><span class="mord cjk_fallback">æ¥</span><span class="mord cjk_fallback">å•Š</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">ã€‚</span><span class="mord cjk_fallback">ã€‚</span></span></span></span><br />
è¿™ä¸‹æœªå®Œå¾…ç»­äº†â€¦â€¦</p>
<p>ä¸‹é¢å¼€å§‹å‚æ­»æŒ£æ‰ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/perfectblue/pbCTF-2021-challs/blob/27bda83033890b8f8a66ae3092565388c6c9aba7/crypto/yet-another-rsa/src/solver.sage">pbCTF2021-yet another rsa</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.maple3142.net/2021/10/11/pbctf-2021-writeups/#yet-another-rsa">maple3142â€™s wp</a></li>
<li><a target="_blank" rel="noopener" href="https://rkm0959.tistory.com/242">PBCTF 2nd place wp</a></li>
<li><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2021/1160.pdf">paper1-2021</a></li>
<li><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2022/1241.pdf">paper2-2022</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S030439752100445X">paper3</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0304397522003085">paper4</a></li>
<li><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S030439752100390X">paper5</a></li>
<li><a target="_blank" rel="noopener" href="https://ntmeeting.polito.it/content/download/214/1060/file/2_saettone_slides.pdf">A novel RSAâ€“like cryptosystem based on a product related to the cubic Pell equation and RÃ©dei rational functions</a></li>
</ul>
<p>å·²ç»å¾ˆå°½åŠ›è°ƒå‚äº†ï¼Œå¥ˆä½•å°±æ˜¯æ‰“ä¸å‡ºæ¥(å°è¯•äº†<strong>äºŒå…ƒcopperã€è¿åˆ†æ•°åˆ†è§£ã€è®ºæ–‡è„šæœ¬</strong>)ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><msup><mi>N</mi><mn>0.5</mn></msup></mrow><annotation encoding="application/x-tex">d=N^{0.5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span>ï¼Œä¹Ÿèƒ½æ»¡è¶³è®ºæ–‡çš„æ¡ä»¶(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&lt;</mo><msup><mi>N</mi><mn>0.569</mn></msup></mrow><annotation encoding="application/x-tex">d&lt;N^{0.569}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">d</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0</span><span class="mord mtight">.</span><span class="mord mtight">5</span><span class="mord mtight">6</span><span class="mord mtight">9</span></span></span></span></span></span></span></span></span></span></span></span>)å•Šï¼Œ<code>0.4</code>çš„æ—¶å€™å°±ç‰¹åˆ«å¥½æ‰“ã€‚ã€‚ã€‚ã€‚</p>
<p>å…¶å®é€šè¿‡æœç´¢<code>Murru-Saettone scheme</code> <code>cubic pell rsa</code>ï¼Œä½ ä¼šå‘ç°å¤§é‡ç›¸å…³çš„è®ºæ–‡ï¼Œå°±ä¸å…¨éƒ¨ç½—åˆ—å‡ºæ¥äº†</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/2081.pdf">paper1-2024</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/MengceZheng/GCPRSA/blob/main/attack.py">paper1â€™s attack.py</a></li>
<li><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2024/385.pdf">paper2-2024</a></li>
<li><a target="_blank" rel="noopener" href="https://eprint.iacr.org/2025/875.pdf">è¿˜æ‰¾åˆ°äº†æ–°ä½“ç³»æ”»å‡» paper3-2025 phi=(p-1)^n * (q-1)^n</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/mseckept/generalized-lattice-attack">check</a></li>
</ul>
<p>ä¹Ÿå°è¯•é€šè¿‡24å¹´çš„ç ”ç©¶ä¼˜åŒ–äº†22å¹´è„šæœ¬çš„ä¸€äº›å‚æ•°ï¼Œæ²¡å‡º<br />
ä¸Šé¢çš„è„šæœ¬ï¼Œä¹Ÿä»”ç»†è°ƒå‚æ•°äº†ï¼Œä¹Ÿæ²¡èƒ½å‡ºâ€¦â€¦<br />
What can I sayâ€¦â€¦</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/">https://hvang10.github.io/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/" title="ç¾ŠåŸæ¯2025-WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">ç¾ŠåŸæ¯2025-WriteUp</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">53</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">1.</span> <span class="toc-text"> Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%96%E5%B1%85%E4%BA%8E%E5%8F%AF%E8%83%BD%E6%80%A7%E4%B9%8B%E4%B8%AD"><span class="toc-number">1.1.</span> <span class="toc-text"> ğŸŒŸæ –å±…äºå¯èƒ½æ€§ä¹‹ä¸­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A2%E5%85%B0%E6%9D%A5%E5%AE%A2"><span class="toc-number">1.2.</span> <span class="toc-text"> ğŸæ³¢å…°æ¥å®¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%9D%E9%98%BF%E6%9C%B5%E8%8E%89%E5%88%87%E7%9A%84%E4%BC%A0%E8%AF%B4"><span class="toc-number">1.3.</span> <span class="toc-text"> ğŸª„è´é˜¿æœµè‰åˆ‡çš„ä¼ è¯´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%B8%8Fnovember-rain"><span class="toc-number">1.4.</span> <span class="toc-text"> ğŸŒ§ï¸November Rain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ever17"><span class="toc-number">1.5.</span> <span class="toc-text"> ğŸ¡Ever17</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9D%8F%E6%8E%89%E7%9A%84%E6%94%B6%E9%9F%B3%E6%9C%BA"><span class="toc-number">1.6.</span> <span class="toc-text"> ğŸ“»åæ‰çš„æ”¶éŸ³æœº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%B2%9C%E8%8A%B1%E7%9B%9B%E5%BC%80%E7%9A%84%E6%A3%AE%E6%9E%97"><span class="toc-number">1.7.</span> <span class="toc-text"> ğŸŒ¸é²œèŠ±ç››å¼€çš„æ£®æ—</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%B8%8F20%E4%B8%96%E7%BA%AA%E5%B0%91%E5%B9%B4"><span class="toc-number">1.8.</span> <span class="toc-text"> â˜€ï¸20ä¸–çºªå°‘å¹´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%B8%8F%E6%B5%AA%E5%AE%A2%E5%89%91%E5%BF%83"><span class="toc-number">1.9.</span> <span class="toc-text"> ğŸ—¡ï¸æµªå®¢å‰‘å¿ƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A3%92%E7%90%83%E8%8B%B1%E8%B1%AA"><span class="toc-number">1.10.</span> <span class="toc-text"> ğŸ§¢æ£’çƒè‹±è±ª</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rewrite"><span class="toc-number">1.11.</span> <span class="toc-text"> ğŸŒRewrite*</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/23/CNSS-Recruit2025-Crypto-WriteUp/" title="CNSS-Recruit2025-Crypto-WriteUp">CNSS-Recruit2025-Crypto-WriteUp</a><time datetime="2025-11-23T03:00:00.000Z" title="Created 2025-11-23 11:00:00">2025-11-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/" title="ç¾ŠåŸæ¯2025-WriteUp">ç¾ŠåŸæ¯2025-WriteUp</a><time datetime="2025-10-12T16:00:00.000Z" title="Created 2025-10-13 00:00:00">2025-10-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/WMCTF2025-WriteUp/" title="WMCTF2025-WriteUp">WMCTF2025-WriteUp</a><time datetime="2025-09-20T16:18:08.000Z" title="Created 2025-09-21 00:18:08">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/15/N1CTF-Junior-2025-2-2-WriteUp/" title="N1CTF Junior 2025 2/2 WriteUp">N1CTF Junior 2025 2/2 WriteUp</a><time datetime="2025-09-14T16:00:01.000Z" title="Created 2025-09-15 00:00:01">2025-09-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/08/26/CNSS-Summer2025-Crypto-WriteUp/" title="CNSS-Summer2025-Crypto-WriteUp">CNSS-Summer2025-Crypto-WriteUp</a><time datetime="2025-08-25T17:56:23.000Z" title="Created 2025-08-26 01:56:23">2025-08-26</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>